!function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="/",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=r(i),s=n(10),u=r(s);if(n(32),window){window.Climb=window.Climb||{};for(var c=document.querySelectorAll(".climb-wall"),a=0;a<c.length;++a){var l=c[a],p=l.dataset.collectionId,h=l.dataset.limit;o["default"].render(o["default"].createElement(u["default"],{collectionId:p,limit:h}),l)}}e["default"]=u["default"],t.exports=e["default"]},function(t,e){t.exports=React},function(t,e){"use strict";e.__esModule=!0,e["default"]={noWobble:[170,26],gentle:[120,14],wobbly:[180,12],stiff:[210,20]},t.exports=e["default"]},function(t,e,n){(function(e){(function(){var n,r,i;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(n()-i)/1e6},r=e.hrtime,n=function(){var t;return t=r(),1e9*t[0]+t[1]},i=n()):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(e,n(4))},function(t,e){function n(){a=!1,s.length?c=s.concat(c):l=-1,c.length&&r()}function r(){if(!a){var t=setTimeout(n);a=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,a=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function o(){}var s,u=t.exports={},c=[],a=!1,l=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new i(t,e)),1!==c.length||a||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=o,u.addListener=o,u.once=o,u.off=o,u.removeListener=o,u.removeAllListeners=o,u.emit=o,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"render",value:function(){return a["default"].createElement("a",{className:"climb__tile__author",href:this.props.link},a["default"].createElement("img",{src:this.props.picture,alt:"Profile pic of "+this.props.name}),a["default"].createElement("h4",{className:"climb__tile__author__username"},this.props.username))}}]),e}(a["default"].Component);l.propTypes={},e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"render",value:function(){return a["default"].createElement("img",{className:"climb__tile__image",src:this.props.src,"data-width":this.props.width,"data-height":this.props.height})}}]),e}(a["default"].Component);l.propTypes={src:a["default"].PropTypes.string.isRequired,width:a["default"].PropTypes.number,height:a["default"].PropTypes.number},e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"render",value:function(){return a["default"].createElement("div",{className:"climb__tile__message",dangerouslySetInnerHTML:{__html:this.props.body}})}}]),e}(a["default"].Component);l.propTypes={body:a["default"].PropTypes.string.isRequired},e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=n(6),p=r(l),h=n(7),f=r(h),d=n(5),v=r(d),b=function(t){function e(t){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return o(e,t),s(e,[{key:"createImage",value:function(){if(null!==this.props.image){var t=this.props.image,e=t.url,n=t.width,r=t.height;return a["default"].createElement(p["default"],{src:e,width:n,height:r})}return null}},{key:"createMessage",value:function(){return this.props.message?a["default"].createElement(f["default"],{body:this.props.message}):null}},{key:"createClassString",value:function(){var t="climb__tile climb__tile--"+this.props.source_type;return t+=this.props.image?" climb__tile--has-media climb__tile--has-image":" climb__tile--has-no-image",t+=this.props.video_url?" climb__tile--has-media climb__tile--has-video":" climb__tile--has-no-video"}},{key:"render",value:function(){var t=this.createImage(),e=this.createMessage(),n=this.createClassString(),r=this.props.author;return a["default"].createElement("div",{className:n,style:this.props.style},a["default"].createElement("a",{href:this.props.link},t),a["default"].createElement("div",{className:"climb__tile__content"},e,a["default"].createElement(v["default"],r)))}}]),e}(a["default"].Component);b.propTypes={link:a["default"].PropTypes.string.isRequired,source_type:a["default"].PropTypes.string.isRequired,timestamp:a["default"].PropTypes.number.isRequired,author:a["default"].PropTypes.shape({username:a["default"].PropTypes.string.isRequired,picture:a["default"].PropTypes.string.isRequired,link:a["default"].PropTypes.string.isRequired}),message:a["default"].PropTypes.string,video_src:a["default"].PropTypes.string,image:a["default"].PropTypes.shape({url:a["default"].PropTypes.string.isRequired,width:a["default"].PropTypes.number.isRequired,height:a["default"].PropTypes.number.isRequired})},e["default"]=b,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},l=n(1),p=r(l),h=n(8),f=r(h),d=n(23),v=function(t){function e(){o(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return s(e,t),c(e,[{key:"getStyles",value:function(){var t=this,e={};return Object.keys(this.props.items).map(function(n){e[n]={opacity:d.spring(1),width:d.spring(375),margin:d.spring(10),item:t.props.items[n]}}),e}},{key:"willEnter",value:function(t){return{opacity:d.spring(0),width:d.spring(0),margin:d.spring(0),item:this.props.items[t]}}},{key:"willLeave",value:function(t,e){return{opacity:d.spring(0),width:d.spring(0),margin:d.spring(0),item:e.item}}},{key:"renderTile",value:function(t,e){var n=e.item,r=i(e,["item"]),o=i(n,[]),s={opacity:r.opacity,width:r.width+"px","margin-left":r.margin,"margin-right":r.margin};return p["default"].createElement(f["default"],u({key:t,style:s},o))}},{key:"render",value:function(){var t=this;return p["default"].createElement(d.TransitionMotion,{styles:this.getStyles.bind(this)(),willEnter:this.willEnter.bind(this),willLeave:this.willLeave.bind(this)},function(e){return p["default"].createElement("div",{className:"climb__wall"},Object.keys(e).map(function(n){var r=e[n];return t.renderTile(n,r)}))})}}],[{key:"propTypes",value:{items:l.PropTypes.object.isRequired},enumerable:!0}]),e}(l.Component);e["default"]=v,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=n(11),p=r(l),h=n(9),f=r(h),d=function(t){function e(t){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={items:[]}}return o(e,t),s(e,[{key:"init",value:function(){var t=this;this.props.collectionId&&p["default"].getStream(this.props.collectionId).subscribe(function(e){var n=parseInt(t.props.limit,0),r={};e.splice(0,n).map(function(t){r[t.id]=t}),t.setState({items:r})})}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentDidUpdate",value:function(){var t=void 0;(t=window.Climb&&window.Climb.onUpdate?window.Climb.onUpdate:function(){})()}},{key:"render",value:function(){return a["default"].createElement(f["default"],{items:this.state.items})}}],[{key:"propTypes",value:{collectionId:c.PropTypes.string.isRequired,limit:c.PropTypes.oneOfType([c.PropTypes.number,c.PropTypes.string])},enumerable:!0},{key:"defaultProps",value:{collectionId:"561ba63445284e1740e016f7",limit:30},enumerable:!0}]),e}(c.Component);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(12),o=n(15),s=r(o),u=function(t){var e=5e3,n=i.Observable.just("http://app.climb.social/api/v1/collections/"+t),r=i.Observable.interval(e).startWith(null),o=r.combineLatest(n,function(t,e){return e}).flatMap(function(t){var e=""+t;return i.Observable.fromPromise(s["default"](e).then(function(t){return t.json()}))});return o};e["default"]={getStream:u},t.exports=e["default"]},function(t,e,n){var r;(function(t,i,o){(function(s){function u(t){return t&&t.Object===Object?t:null}function c(t){for(var e=t.length,n=new Array(e),r=0;e>r;r++)n[r]=t[r];return n}function a(t){return function(){try{return t.apply(this,arguments)}catch(e){return Dt.e=e,Dt}}}function l(t){throw t}function p(t,e){if(Nt&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(Tt)){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var i=n.join("\n"+Tt+"\n");t.stack=h(i)}}function h(t){for(var e=t.split("\n"),n=[],r=0,i=e.length;i>r;r++){var o=e[r];f(o)||d(o)||!o||n.push(o)}return n.join("\n")}function f(t){var e=b(t);if(!e)return!1;var n=e[0],r=e[1];return n===Pt&&r>=At&&ci>=r}function d(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function v(){if(Nt)try{throw new Error}catch(t){var e=t.stack.split("\n"),n=e[0].indexOf("@")>0?e[1]:e[2],r=b(n);if(!r)return;return Pt=r[0],r[1]}}function b(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function m(t){var e=[];if(!de(t))return e;fe.nonEnumArgs&&t.length&&ve(t)&&(t=me.call(t));var n=fe.enumPrototypes&&"function"==typeof t,r=fe.enumErrorProps&&(t===ue||t instanceof Error);for(var i in t)n&&"prototype"==i||r&&("message"==i||"name"==i)||e.push(i);if(fe.nonEnumShadows&&t!==ce){var o=t.constructor,s=-1,u=Qt;if(t===(o&&o.prototype))var c=t===ae?re:t===ue?Xt:ie.call(t),a=he[c];for(;++s<u;)i=Ht[s],a&&a[i]||!oe.call(t,i)||e.push(i)}return e}function y(t,e,n){for(var r=-1,i=n(t),o=i.length;++r<o;){var s=i[r];if(e(t[s],s,t)===!1)break}return t}function _(t,e){return y(t,e,m)}function g(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function w(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;var i=typeof t,o=typeof e;if(t===t&&(null==t||null==e||"function"!=i&&"object"!=i&&"function"!=o&&"object"!=o))return!1;var s=ie.call(t),u=ie.call(e);if(s==$t&&(s=ee),u==$t&&(u=ee),s!=u)return!1;switch(s){case Jt:case Gt:return+t==+e;case te:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case ne:case re:return t==String(e)}var c=s==Yt;if(!c){if(s!=ee||!fe.nodeClass&&(g(t)||g(e)))return!1;var a=!fe.argsObject&&ve(t)?Object:t.constructor,l=!fe.argsObject&&ve(e)?Object:e.constructor;if(!(a==l||oe.call(t,"constructor")&&oe.call(e,"constructor")||Ot(a)&&a instanceof a&&Ot(l)&&l instanceof l||!("constructor"in t&&"constructor"in e)))return!1}n||(n=[]),r||(r=[]);for(var p=n.length;p--;)if(n[p]==t)return r[p]==e;var h=0,f=!0;if(n.push(t),r.push(e),c){if(p=t.length,h=e.length,f=h==p)for(;h--;){var d=e[h];if(!(f=w(t[h],d,n,r)))break}}else _(e,function(e,i,o){return oe.call(o,i)?(h++,f=oe.call(t,i)&&w(t[i],e,n,r)):void 0}),f&&_(t,function(t,e,n){return oe.call(n,e)?f=--h>-1:void 0});return n.pop(),r.pop(),f}function x(t,e){for(var n=new Array(t),r=0;t>r;r++)n[r]=e();return n}function S(t,e){this.id=t,this.value=e}function E(t){this._s=t,this.isDisposed=!1}function C(t){this._s=t}function O(t){this._s=t,this._l=t.length,this._i=0}function D(t){this._a=t}function j(t){this._a=t,this._l=A(t),this._i=0}function N(t){return"number"==typeof t&&mt.isFinite(t)}function k(t){var e,n=t[It];if(!n&&"string"==typeof t)return e=new C(t),e[It]();if(!n&&t.length!==s)return e=new D(t),e[It]();if(!n)throw new TypeError("Object is not iterable");return t[It]()}function P(t){var e=+t;return 0===e?e:isNaN(e)?e:0>e?-1:1}function A(t){var e=+t.length;return isNaN(e)?0:0!==e&&N(e)?(e=P(e)*Math.floor(Math.abs(e)),0>=e?0:e>Dn?Dn:e):e}function T(t,e){this.observer=t,this.parent=e}function M(t,e){var n=t.length;return function(r,i){n>r?(e.onNext(t[r]),i(r+1)):e.onCompleted()}}function R(t,e){return Me(t)||(t=Ue),new Nn(e,t)}function L(t,e){this.observer=t,this.parent=e}function V(t,e){this.observer=t,this.parent=e}function F(){return!1}function I(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function F(){return!1}function I(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function F(){return!1}function U(){return[]}function F(){return!1}function U(){return[]}function I(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function z(t){return function(e){return t.subscribe(e)}}function W(t,e){return function(n){for(var r=n,i=0;e>i;i++){var o=r[t[i]];if("undefined"==typeof o)return s;r=o}return r}}function B(t,e,n,r){var i=new ii;return r.push(K(i,e,n)),t.apply(e,r),i.asObservable()}function K(t,e,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;r>o;o++)i[o]=arguments[o];if(Ot(n)){if(i=jt(n).apply(e,i),i===Dt)return t.onError(i.e);t.onNext(i)}else i.length<=1?t.onNext(i[0]):t.onNext(i);t.onCompleted()}}function H(t,e,n,r){var i=new ii;return r.push(Q(i,e,n)),t.apply(e,r),i.asObservable()}function Q(t,e,n){return function(){var r=arguments[0];if(r)return t.onError(r);for(var i=arguments.length,o=[],s=1;i>s;s++)o[s-1]=arguments[s];if(Ot(n)){var o=jt(n).apply(e,o);if(o===Dt)return t.onError(o.e);t.onNext(o)}else o.length<=1?t.onNext(o[0]):t.onNext(o);t.onCompleted()}}function $(t){return mt.StaticNodeList?t instanceof mt.StaticNodeList||t instanceof mt.NodeList:"[object NodeList]"===Object.prototype.toString.call(t)}function Y(t,e,n){this._e=t,this._n=e,this._fn=n,this._e.addEventListener(this._n,this._fn,!1),this.isDisposed=!1}function J(t,e,n){var r=new ge,i=Object.prototype.toString.call(t);if($(t)||"[object HTMLCollection]"===i)for(var o=0,s=t.length;s>o;o++)r.add(J(t.item(o),e,n));else t&&r.add(new Y(t,e,n));return r}function G(t,e){return new zr(t,e)}function X(t,e,n){return new ti(function(r){var i=t,o=qe(e);return n.scheduleRecursiveFuture(0,i,function(t,e){if(o>0){var s=n.now();i=new Date(i.getTime()+o),i.getTime()<=s&&(i=new Date(s+o))}r.onNext(t),e(t+1,new Date(i))})})}function Z(t,e,n){return t===e?new ti(function(t){return n.schedulePeriodic(0,e,function(e){return t.onNext(e),e+1})}):wn(function(){return X(new Date(n.now()+t),e,n)})}function tt(t,e,n){return new ti(function(r){var i,o=!1,s=new Ne,u=null,c=[],a=!1;return i=t.materialize().timestamp(n).subscribe(function(t){var i,l;"E"===t.value.kind?(c=[],c.push(t),u=t.value.error,l=!a):(c.push({value:t.value,timestamp:t.timestamp+e}),l=!o,o=!0),l&&(null!==u?r.onError(u):(i=new je,s.setDisposable(i),i.setDisposable(n.scheduleRecursiveFuture(null,e,function(t,e){var i,s,l,p;if(null===u){a=!0;do l=null,c.length>0&&c[0].timestamp-n.now()<=0&&(l=c.shift().value),null!==l&&l.accept(r);while(null!==l);p=!1,s=0,c.length>0?(p=!0,s=Math.max(0,c[0].timestamp-n.now())):o=!1,i=u,a=!1,null!==i?r.onError(i):p&&e(null,s)}}))))}),new ke(i,s)},t)}function et(t,e,n){return wn(function(){return tt(t,e-n.now(),n)})}function nt(t,e,n){var r,i;return Ot(e)?i=e:(r=e,i=n),new ti(function(e){function n(){c.setDisposable(t.subscribe(function(t){var n=jt(i)(t);if(n===Dt)return e.onError(n.e);var r=new je;s.add(r),r.setDisposable(n.subscribe(function(){e.onNext(t),s.remove(r),o()},function(t){e.onError(t)},function(){e.onNext(t),s.remove(r),o()}))},function(t){e.onError(t)},function(){u=!0,c.dispose(),o()}))}function o(){u&&0===s.length&&e.onCompleted()}var s=new ge,u=!1,c=new Ne;return r?c.setDisposable(r.subscribe(n,function(t){e.onError(t)},n)):n(),new ke(c,s)},this)}function rt(t,e){return new ti(function(n){var r,i=!1,o=new Ne,s=0,u=t.subscribe(function(t){var u=jt(e)(t);if(u===Dt)return n.onError(u.e);Ct(u)&&(u=Vr(u)),i=!0,r=t,s++;var c=s,a=new je;o.setDisposable(a),a.setDisposable(u.subscribe(function(){i&&s===c&&n.onNext(r),i=!1,a.dispose()},function(t){n.onError(t)},function(){i&&s===c&&n.onNext(r),i=!1,a.dispose()}))},function(t){o.dispose(),n.onError(t),i=!1,s++},function(){o.dispose(),i&&n.onNext(r),n.onCompleted(),i=!1,s++});return new ke(u,o)},t)}function it(t,e){return new ti(function(n){function r(){s&&(s=!1,n.onNext(i)),o&&n.onCompleted()}var i,o=!1,s=!1,u=new je;return u.setDisposable(t.subscribe(function(t){s=!0,i=t},function(t){n.onError(t)},function(){o=!0,u.dispose()})),new ke(u,e.subscribe(r,function(t){n.onError(t)},r))},t)}function ot(t,e,n,r){return Ot(e)&&(r=n,n=e,e=Tn()),r||(r=In(new $r)),new ti(function(i){function o(t){function e(){return p=n===l}var n=l,o=new je;c.setDisposable(o),o.setDisposable(t.subscribe(function(){e()&&u.setDisposable(r.subscribe(i)),o.dispose()},function(t){e()&&i.onError(t)},function(){e()&&u.setDisposable(r.subscribe(i))}))}function s(){var t=!p;return t&&l++,t}var u=new Ne,c=new Ne,a=new je;u.setDisposable(a);var l=0,p=!1;return o(e),a.setDisposable(t.subscribe(function(t){if(s()){i.onNext(t);var e=jt(n)(t);if(e===Dt)return i.onError(e.e);o(Ct(e)?Vr(e):e)}},function(t){s()&&i.onError(t)},function(){s()&&i.onCompleted()})),new ke(u,c)},t)}function st(t,e,n,r){return Me(n)&&(r=n,n=In(new $r)),n instanceof Error&&(n=In(n)),Me(r)||(r=He),new ti(function(i){function o(){var t=s;l.setDisposable(r.scheduleFuture(null,e,function(){a=s===t,a&&(Ct(n)&&(n=Vr(n)),c.setDisposable(n.subscribe(i)))}))}var s=0,u=new je,c=new Ne,a=!1,l=new Ne;return c.setDisposable(u),o(),u.setDisposable(t.subscribe(function(t){a||(s++,i.onNext(t),o())},function(t){a||(s++,i.onError(t))},function(){a||(s++,i.onCompleted())})),new ke(c,l)},t)}function ut(t,e,n){return new ti(function(r){function i(t,e){if(a[e]=t,s[e]=!0,u||(u=s.every(gt))){if(o)return r.onError(o);var i=jt(n).apply(null,a);if(i===Dt)return r.onError(i.e);r.onNext(i)}c&&a[1]&&r.onCompleted()}var o,s=[!1,!1],u=!1,c=!1,a=new Array(2);return new ke(t.subscribe(function(t){i(t,0)},function(t){a[1]?r.onError(t):o=t},function(){c=!0,a[1]&&r.onCompleted()}),e.subscribe(function(t){i(t,1)},function(t){r.onError(t)},function(){c=!0,i(!0,1)}))},t)}function ct(t){return{"@@transducer/init":function(){return t},"@@transducer/step":function(t,e){return t.onNext(e)},"@@transducer/result":function(t){return t.onCompleted()}}}var at={"function":!0,object:!0},lt=at[typeof e]&&e&&!e.nodeType?e:null,pt=at[typeof t]&&t&&!t.nodeType?t:null,ht=u(lt&&pt&&"object"==typeof i&&i),ft=u(at[typeof self]&&self),dt=u(at[typeof window]&&window),vt=pt&&pt.exports===lt?lt:null,bt=u(at[typeof this]&&this),mt=ht||dt!==(bt&&bt.window)&&dt||ft||bt||Function("return this")(),yt={internals:{},config:{Promise:mt.Promise},helpers:{}},_t=yt.helpers.noop=function(){},gt=yt.helpers.identity=function(t){return t},wt=yt.helpers.defaultNow=Date.now,xt=yt.helpers.defaultComparer=function(t,e){return be(t,e)},St=yt.helpers.defaultSubComparer=function(t,e){return t>e?1:e>t?-1:0},Et=(yt.helpers.defaultKeySerializer=function(t){return t.toString()},yt.helpers.defaultError=function(t){throw t}),Ct=yt.helpers.isPromise=function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then},Ot=yt.helpers.isFunction=function(){var t=function(t){return"function"==typeof t||!1};return t(/x/)&&(t=function(t){return"function"==typeof t&&"[object Function]"==ie.call(t)}),t}(),Dt={e:{}},jt=yt.internals.tryCatch=function(t){if(!Ot(t))throw new TypeError("fn must be a function");return a(t)};yt.config.longStackSupport=!1;var Nt=!1,kt=jt(function(){throw new Error})();Nt=!!kt.e&&!!kt.e.stack;var Pt,At=v(),Tt="From previous event:",qt=yt.EmptyError=function(){this.message="Sequence contains no elements.",Error.call(this)};qt.prototype=Object.create(Error.prototype),qt.prototype.name="EmptyError";var Mt=yt.ObjectDisposedError=function(){this.message="Object has been disposed",Error.call(this)};Mt.prototype=Object.create(Error.prototype),Mt.prototype.name="ObjectDisposedError";var Rt=yt.ArgumentOutOfRangeError=function(){this.message="Argument out of range",Error.call(this)};Rt.prototype=Object.create(Error.prototype),Rt.prototype.name="ArgumentOutOfRangeError";var Lt=yt.NotSupportedError=function(t){this.message=t||"This operation is not supported",Error.call(this)};Lt.prototype=Object.create(Error.prototype),Lt.prototype.name="NotSupportedError";var Vt=yt.NotImplementedError=function(t){this.message=t||"This operation is not implemented",Error.call(this)};Vt.prototype=Object.create(Error.prototype),Vt.prototype.name="NotImplementedError";var Ft=yt.helpers.notImplemented=function(){throw new Vt},It=(yt.helpers.notSupported=function(){throw new Lt},"function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_");mt.Set&&"function"==typeof(new mt.Set)["@@iterator"]&&(It="@@iterator");var Ut=yt.doneEnumerator={done:!0,value:s},zt=yt.helpers.isIterable=function(t){return t&&t[It]!==s},Wt=yt.helpers.isArrayLike=function(t){return t&&t.length!==s};yt.helpers.iterator=It;var Bt,Kt=yt.internals.bindCallback=function(t,e,n){if("undefined"==typeof e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},Ht=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Qt=Ht.length,$t="[object Arguments]",Yt="[object Array]",Jt="[object Boolean]",Gt="[object Date]",Xt="[object Error]",Zt="[object Function]",te="[object Number]",ee="[object Object]",ne="[object RegExp]",re="[object String]",ie=Object.prototype.toString,oe=Object.prototype.hasOwnProperty,se=ie.call(arguments)==$t,ue=Error.prototype,ce=Object.prototype,ae=String.prototype,le=ce.propertyIsEnumerable;try{Bt=!(ie.call(document)==ee&&!({toString:0}+""))}catch(pe){Bt=!0}var he={};he[Yt]=he[Gt]=he[te]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},he[Jt]=he[re]={constructor:!0,toString:!0,valueOf:!0},he[Xt]=he[Zt]=he[ne]={constructor:!0,toString:!0},he[ee]={constructor:!0};var fe={};!function(){var t=function(){this.x=1},e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments);fe.enumErrorProps=le.call(ue,"message")||le.call(ue,"name"),fe.enumPrototypes=le.call(t,"prototype"),fe.nonEnumArgs=0!=n,fe.nonEnumShadows=!/valueOf/.test(e)}(1);var de=yt.internals.isObject=function(t){var e=typeof t;return t&&("function"==e||"object"==e)||!1},ve=function(t){return t&&"object"==typeof t?ie.call(t)==$t:!1};se||(ve=function(t){return t&&"object"==typeof t?oe.call(t,"callee"):!1});var be=yt.internals.isEqual=function(t,e){return w(t,e,[],[])},me=({}.hasOwnProperty,Array.prototype.slice),ye=yt.internals.inherits=function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n},_e=yt.internals.addProperties=function(t){for(var e=[],n=1,r=arguments.length;r>n;n++)e.push(arguments[n]);for(var i=0,o=e.length;o>i;i++){var s=e[i];for(var u in s)t[u]=s[u]}},ge=(yt.internals.addRef=function(t,e){return new ti(function(n){return new ke(e.getDisposable(),t.subscribe(n))})},yt.CompositeDisposable=function(){var t,e,n=[];if(Array.isArray(arguments[0]))n=arguments[0],e=n.length;else for(e=arguments.length,n=new Array(e),t=0;e>t;t++)n[t]=arguments[t];this.disposables=n,this.isDisposed=!1,this.length=n.length}),we=ge.prototype;we.add=function(t){this.isDisposed?t.dispose():(this.disposables.push(t),this.length++)},we.remove=function(t){var e=!1;if(!this.isDisposed){var n=this.disposables.indexOf(t);-1!==n&&(e=!0,this.disposables.splice(n,1),this.length--,t.dispose())}return e},we.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=this.disposables.length,e=new Array(t),n=0;t>n;n++)e[n]=this.disposables[n];for(this.disposables=[],this.length=0,n=0;t>n;n++)e[n].dispose()}};var xe=yt.Disposable=function(t){this.isDisposed=!1,this.action=t||_t};xe.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var Se=xe.create=function(t){return new xe(t)},Ee=xe.empty={dispose:_t},Ce=xe.isDisposable=function(t){return t&&Ot(t.dispose)},Oe=xe.checkDisposed=function(t){if(t.isDisposed)throw new Mt},De=xe._fixup=function(t){return Ce(t)?t:Ee},je=yt.SingleAssignmentDisposable=function(){this.isDisposed=!1,this.current=null};je.prototype.getDisposable=function(){return this.current},je.prototype.setDisposable=function(t){if(this.current)throw new Error("Disposable has already been assigned");var e=this.isDisposed;!e&&(this.current=t),e&&t&&t.dispose()},je.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null,t&&t.dispose()}};var Ne=yt.SerialDisposable=function(){this.isDisposed=!1,this.current=null};Ne.prototype.getDisposable=function(){return this.current},Ne.prototype.setDisposable=function(t){var e=this.isDisposed;if(!e){var n=this.current;
this.current=t}n&&n.dispose(),e&&t&&t.dispose()},Ne.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null}t&&t.dispose()};var ke=yt.BinaryDisposable=function(t,e){this._first=t,this._second=e,this.isDisposed=!1};ke.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this._first;this._first=null,t&&t.dispose();var e=this._second;this._second=null,e&&e.dispose()}};var Pe=yt.NAryDisposable=function(t){this._disposables=t,this.isDisposed=!1};Pe.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=0,e=this._disposables.length;e>t;t++)this._disposables[t].dispose();this._disposables.length=0}};var Ae=(yt.RefCountDisposable=function(){function t(t){this.disposable=t,this.disposable.count++,this.isInnerDisposed=!1}function e(t){this.underlyingDisposable=t,this.isDisposed=!1,this.isPrimaryDisposed=!1,this.count=0}return t.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,0===this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))},e.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))},e.prototype.getDisposable=function(){return this.isDisposed?Ee:new t(this)},e}(),yt.internals.ScheduledItem=function(t,e,n,r,i){this.scheduler=t,this.state=e,this.action=n,this.dueTime=r,this.comparer=i||St,this.disposable=new je});Ae.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())},Ae.prototype.compareTo=function(t){return this.comparer(this.dueTime,t.dueTime)},Ae.prototype.isCancelled=function(){return this.disposable.isDisposed},Ae.prototype.invokeCore=function(){return De(this.action(this.scheduler,this.state))};var Te=yt.Scheduler=function(){function t(){}t.isScheduler=function(e){return e instanceof t};var e=t.prototype;return e.schedule=function(t,e){throw new Vt},e.scheduleFuture=function(e,n,r){var i=n;return i instanceof Date&&(i-=this.now()),i=t.normalize(i),0===i?this.schedule(e,r):this._scheduleFuture(e,i,r)},e._scheduleFuture=function(t,e,n){throw new Vt},t.now=wt,t.prototype.now=wt,t.normalize=function(t){return 0>t&&(t=0),t},t}(),qe=Te.normalize,Me=Te.isScheduler;!function(t){function e(t,e){function n(e){function r(t,e){return s?o.remove(c):u=!0,i(e,n),Ee}var s=!1,u=!1,c=t.schedule(e,r);u||(o.add(c),s=!0)}var r=e[0],i=e[1],o=new ge;return i(r,n),o}function n(t,e){function n(e,r){function s(t,e){return u?o.remove(a):c=!0,i(e,n),Ee}var u=!1,c=!1,a=t.scheduleFuture(e,r,s);c||(o.add(a),u=!0)}var r=e[0],i=e[1],o=new ge;return i(r,n),o}t.scheduleRecursive=function(t,n){return this.schedule([t,n],e)},t.scheduleRecursiveFuture=function(t,e,r){return this.scheduleFuture([t,r],e,n)}}(Te.prototype),function(t){Te.prototype.schedulePeriodic=function(t,e,n){if("undefined"==typeof mt.setInterval)throw new Lt;e=qe(e);var r=t,i=mt.setInterval(function(){r=n(r)},e);return Se(function(){mt.clearInterval(i)})}}(Te.prototype);var Re,Le,Ve=function(t){function e(){t.call(this)}return ye(e,t),e.prototype.schedule=function(t,e){return De(e(this,t))},e}(Te),Fe=Te.immediate=new Ve,Ie=function(t){function e(){for(;r.length>0;){var t=r.dequeue();!t.isCancelled()&&t.invoke()}}function n(){t.call(this)}var r;return ye(n,t),n.prototype.schedule=function(t,n){var i=new Ae(this,t,n,this.now());if(r)r.enqueue(i);else{r=new Qe(4),r.enqueue(i);var o=jt(e)();r=null,o===Dt&&l(o.e)}return i.disposable},n.prototype.scheduleRequired=function(){return!r},n}(Te),Ue=Te.currentThread=new Ie,ze=(yt.internals.SchedulePeriodicRecursive=function(){function t(t){return function(e,n){n(0,t._period);var r=jt(t._action)(t._state);r===Dt&&(t._cancel.dispose(),l(r.e)),t._state=r}}function e(t,e,n,r){this._scheduler=t,this._state=e,this._period=n,this._action=r}return e.prototype.start=function(){var e=new je;return this._cancel=e,e.setDisposable(this._scheduler.scheduleRecursiveFuture(0,this._period,t(this))),e},e}(),function(){var t,e=_t;if(mt.setTimeout)t=mt.setTimeout,e=mt.clearTimeout;else{if(!mt.WScript)throw new Lt;t=function(t,e){mt.WScript.Sleep(e),t()}}return{setTimeout:t,clearTimeout:e}}()),We=ze.setTimeout,Be=ze.clearTimeout;!function(){function t(e){if(i)We(function(){t(e)},0);else{var n=r[e];if(n){i=!0;var o=jt(n)();Le(e),i=!1,o===Dt&&l(o.e)}}}function e(){if(!mt.postMessage||mt.importScripts)return!1;var t=!1,e=mt.onmessage;return mt.onmessage=function(){t=!0},mt.postMessage("","*"),mt.onmessage=e,t}var n=1,r={},i=!1;Le=function(t){delete r[t]};var s=new RegExp("^"+String(ie).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),u="function"==typeof(u=ht&&vt&&ht.setImmediate)&&!s.test(u)&&u;if(Ot(u))Re=function(e){var i=n++;return r[i]=e,u(function(){t(i)}),i};else if("undefined"!=typeof o&&"[object process]"==={}.toString.call(o))Re=function(e){var i=n++;return r[i]=e,o.nextTick(function(){t(i)}),i};else if(e()){var c="ms.rx.schedule"+Math.random(),a=function(e){"string"==typeof e.data&&e.data.substring(0,c.length)===c&&t(e.data.substring(c.length))};mt.addEventListener("message",a,!1),Re=function(t){var e=n++;return r[e]=t,mt.postMessage(c+currentId,"*"),e}}else if(mt.MessageChannel){var p=new mt.MessageChannel;p.port1.onmessage=function(e){t(e.data)},Re=function(t){var e=n++;return r[e]=t,p.port2.postMessage(e),e}}else Re="document"in mt&&"onreadystatechange"in mt.document.createElement("script")?function(e){var i=mt.document.createElement("script"),o=n++;return r[o]=e,i.onreadystatechange=function(){t(o),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},mt.document.documentElement.appendChild(i),o}:function(e){var i=n++;return r[i]=e,We(function(){t(i)},0),i}}();var Ke=function(t){function e(){t.call(this)}function n(t,e,n,r){return function(){!t.isDisposed&&t.setDisposable(xe._fixup(e(n,r)))}}function r(t,e){this._id=e,this._method=t,this.isDisposed=!1}return ye(e,t),r.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._method.call(null,this._id))},e.prototype.schedule=function(t,e){var i=new je,o=Re(n(i,e,this,t));return new ke(i,new r(Le,o))},e.prototype._scheduleFuture=function(t,e,i){if(0===e)return this.schedule(t,i);var o=new je,s=We(n(o,i,this,t),e);return new ke(o,new r(Be,s))},e}(Te),He=Te["default"]=Te.async=new Ke;S.prototype.compareTo=function(t){var e=this.value.compareTo(t.value);return 0===e&&(e=this.id-t.id),e};var Qe=yt.internals.PriorityQueue=function(t){this.items=new Array(t),this.length=0},$e=Qe.prototype;$e.isHigherPriority=function(t,e){return this.items[t].compareTo(this.items[e])<0},$e.percolate=function(t){if(!(t>=this.length||0>t)){var e=t-1>>1;if(!(0>e||e===t)&&this.isHigherPriority(t,e)){var n=this.items[t];this.items[t]=this.items[e],this.items[e]=n,this.percolate(e)}}},$e.heapify=function(t){if(+t||(t=0),!(t>=this.length||0>t)){var e=2*t+1,n=2*t+2,r=t;if(e<this.length&&this.isHigherPriority(e,r)&&(r=e),n<this.length&&this.isHigherPriority(n,r)&&(r=n),r!==t){var i=this.items[t];this.items[t]=this.items[r],this.items[r]=i,this.heapify(r)}}},$e.peek=function(){return this.items[0].value},$e.removeAt=function(t){this.items[t]=this.items[--this.length],this.items[this.length]=s,this.heapify()},$e.dequeue=function(){var t=this.peek();return this.removeAt(0),t},$e.enqueue=function(t){var e=this.length++;this.items[e]=new S(Qe.count++,t),this.percolate(e)},$e.remove=function(t){for(var e=0;e<this.length;e++)if(this.items[e].value===t)return this.removeAt(e),!0;return!1},Qe.count=0;var Ye,Je=yt.Notification=function(){function t(){}return t.prototype._accept=function(t,e,n){throw new Vt},t.prototype._acceptObservable=function(t,e,n){throw new Vt},t.prototype.accept=function(t,e,n){return t&&"object"==typeof t?this._acceptObservable(t):this._accept(t,e,n)},t.prototype.toObservable=function(t){var e=this;return Me(t)||(t=Fe),new ti(function(n){return t.schedule(e,function(t,e){e._acceptObservable(n),"N"===e.kind&&n.onCompleted()})})},t}(),Ge=function(t){function e(t){this.value=t,this.kind="N"}return ye(e,t),e.prototype._accept=function(t){return t(this.value)},e.prototype._acceptObservable=function(t){return t.onNext(this.value)},e.prototype.toString=function(){return"OnNext("+this.value+")"},e}(Je),Xe=function(t){function e(t){this.error=t,this.kind="E"}return ye(e,t),e.prototype._accept=function(t,e){return e(this.error)},e.prototype._acceptObservable=function(t){return t.onError(this.error)},e.prototype.toString=function(){return"OnError("+this.error+")"},e}(Je),Ze=function(t){function e(){this.kind="C"}return ye(e,t),e.prototype._accept=function(t,e,n){return n()},e.prototype._acceptObservable=function(t){return t.onCompleted()},e.prototype.toString=function(){return"OnCompleted()"},e}(Je),tn=Je.createOnNext=function(t){return new Ge(t)},en=Je.createOnError=function(t){return new Xe(t)},nn=Je.createOnCompleted=function(){return new Ze},rn=yt.Observer=function(){},on=rn.create=function(t,e,n){return t||(t=_t),e||(e=Et),n||(n=_t),new un(t,e,n)},sn=yt.internals.AbstractObserver=function(t){function e(){this.isStopped=!1}return ye(e,t),e.prototype.next=Ft,e.prototype.error=Ft,e.prototype.completed=Ft,e.prototype.onNext=function(t){!this.isStopped&&this.next(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.error(t))},e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.error(t),!0)},e}(rn),un=yt.AnonymousObserver=function(t){function e(e,n,r){t.call(this),this._onNext=e,this._onError=n,this._onCompleted=r}return ye(e,t),e.prototype.next=function(t){this._onNext(t)},e.prototype.error=function(t){this._onError(t)},e.prototype.completed=function(){this._onCompleted()},e}(sn),cn=yt.Observable=function(){function t(t,e){return function(n){var r=n.onError;return n.onError=function(e){p(e,t),r.call(n,e)},e.call(t,n)}}function e(){if(yt.config.longStackSupport&&Nt){var e=this._subscribe,n=jt(l)(new Error).e;this.stack=n.stack.substring(n.stack.indexOf("\n")+1),this._subscribe=t(this,e)}}return Ye=e.prototype,e.isObservable=function(t){return t&&Ot(t.subscribe)},Ye.subscribe=Ye.forEach=function(t,e,n){return this._subscribe("object"==typeof t?t:on(t,e,n))},Ye.subscribeOnNext=function(t,e){return this._subscribe(on("undefined"!=typeof e?function(n){t.call(e,n)}:t))},Ye.subscribeOnError=function(t,e){return this._subscribe(on(null,"undefined"!=typeof e?function(n){t.call(e,n)}:t))},Ye.subscribeOnCompleted=function(t,e){return this._subscribe(on(null,null,"undefined"!=typeof e?function(){t.call(e)}:t))},e}(),an=yt.internals.ScheduledObserver=function(t){function e(e,n){t.call(this),this.scheduler=e,this.observer=n,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new Ne}return ye(e,t),e.prototype.next=function(t){var e=this;this.queue.push(function(){e.observer.onNext(t)})},e.prototype.error=function(t){var e=this;this.queue.push(function(){e.observer.onError(t)})},e.prototype.completed=function(){var t=this;this.queue.push(function(){t.observer.onCompleted()})},e.prototype.ensureActive=function(){var t=!1;!this.hasFaulted&&this.queue.length>0&&(t=!this.isAcquired,this.isAcquired=!0),t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(this,function(t,e){var n;if(!(t.queue.length>0))return void(t.isAcquired=!1);n=t.queue.shift();var r=jt(n)();return r===Dt?(t.queue=[],t.hasFaulted=!0,l(r.e)):void e(t)}))},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.disposable.dispose()},e}(sn),ln=yt.ObservableBase=function(t){function e(t){return t&&Ot(t.dispose)?t:Ot(t)?Se(t):Ee}function n(t,n){var r=n[0],i=n[1],o=jt(i.subscribeCore).call(i,r);o!==Dt||r.fail(Dt.e)||l(Dt.e),r.setDisposable(e(o))}function r(){t.call(this)}return ye(r,t),r.prototype._subscribe=function(t){var e=new ei(t),r=[e,this];return Ue.scheduleRequired()?Ue.schedule(r,n):n(null,r),e},r.prototype.subscribeCore=Ft,r}(cn),pn=yt.FlatMapObservable=function(t){function e(e,n,r,i){this.resultSelector=Ot(r)?r:null,this.selector=Kt(Ot(n)?n:function(){return n},i,3),this.source=e,t.call(this)}function n(t,e,n,r){this.i=0,this.selector=e,this.resultSelector=n,this.source=r,this.o=t,sn.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.selector,this.resultSelector,this))},ye(n,sn),n.prototype._wrapResult=function(t,e,n){return this.resultSelector?t.map(function(t,r){return this.resultSelector(e,t,n,r)},this):t},n.prototype.next=function(t){var e=this.i++,n=jt(this.selector)(t,e,this.source);return n===Dt?this.o.onError(n.e):(Ct(n)&&(n=Vr(n)),(Wt(n)||zt(n))&&(n=cn.from(n)),void this.o.onNext(this._wrapResult(n,t,e)))},n.prototype.error=function(t){this.o.onError(t)},n.prototype.onCompleted=function(){this.o.onCompleted()},e}(ln),hn=yt.internals.Enumerable=function(){};E.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.isDisposed=!0)};var fn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e,n){this._o=t,this._s=e,this._e=n,sn.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e={isDisposed:!1},r=new Ne,i=Ue.scheduleRecursive(this.sources[It](),function(i,o){if(!e.isDisposed){var s=jt(i.next).call(i);if(s===Dt)return t.onError(s.e);if(s.done)return t.onCompleted();var u=s.value;Ct(u)&&(u=Vr(u));var c=new je;r.setDisposable(c),c.setDisposable(u.subscribe(new n(t,o,i)))}});return new Pe([r,i,new E(e)])},ye(n,sn),n.prototype.onNext=function(t){this._o.onNext(t)},n.prototype.onError=function(t){this._o.onError(t)},n.prototype.onCompleted=function(){this._s(this._e)},e}(ln);hn.prototype.concat=function(){return new fn(this)};var dn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){this._o=t,this._recurse=e,sn.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=this.sources[It](),r={isDisposed:!1},i=new Ne,o=Ue.scheduleRecursive(null,function(o,s){if(!r.isDisposed){var u=jt(e.next).call(e);if(u===Dt)return t.onError(u.e);if(u.done)return null!==o?t.onError(o):t.onCompleted();var c=u.value;Ct(c)&&(c=Vr(c));var a=new je;i.setDisposable(a),a.setDisposable(c.subscribe(new n(t,s)))}});return new Pe([i,o,new E(r)])},ye(n,sn),n.prototype.next=function(t){this._o.onNext(t)},n.prototype.error=function(t){this._recurse(t)},n.prototype.completed=function(){this._o.onCompleted()},e}(ln);hn.prototype.catchError=function(){return new dn(this)},hn.prototype.catchErrorWhen=function(t){var e=this;return new ti(function(n){var r,i=new ri,o=new ri,s=t(i),u=s.subscribe(o),c=e[It](),a={isDisposed:!1},l=new Ne,p=Ue.scheduleRecursive(null,function(t,e){if(!a.isDisposed){var s=jt(c.next).call(c);if(s===Dt)return n.onError(s.e);if(s.done)return void(r?n.onError(r):n.onCompleted());var u=s.value;Ct(u)&&(u=Vr(u));var p=new je,h=new je;l.setDisposable(new ke(h,p)),p.setDisposable(u.subscribe(function(t){n.onNext(t)},function(t){h.setDisposable(o.subscribe(e,function(t){n.onError(t)},function(){n.onCompleted()})),i.onNext(t)},function(){n.onCompleted()}))}});return new Pe([u,l,p,new E(a)])})};var vn=function(t){function e(t,e){this.v=t,this.c=null==e?-1:e}function n(t){this.v=t.v,this.l=t.c}return ye(e,t),e.prototype[It]=function(){return new n(this)},n.prototype.next=function(){return 0===this.l?Ut:(this.l>0&&this.l--,{done:!1,value:this.v})},e}(hn),bn=hn.repeat=function(t,e){return new vn(t,e)},mn=function(t){function e(t,e,n){this.s=t,this.fn=e?Kt(e,n,3):null}function n(t){this.i=-1,this.s=t.s,this.l=this.s.length,this.fn=t.fn}return ye(e,t),e.prototype[It]=function(){return new n(this)},n.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:Ut},e}(hn),yn=hn.of=function(t,e,n){return new mn(t,e,n)},_n=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.a=[],sn.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},ye(n,sn),n.prototype.next=function(t){this.a.push(t)},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.o.onNext(this.a),this.o.onCompleted()},e}(ln);Ye.toArray=function(){return new _n(this)},cn.create=function(t,e){return new ti(t,e)};var gn=function(t){function e(e){this._f=e,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=jt(this._f)();return e===Dt?In(e.e).subscribe(t):(Ct(e)&&(e=Vr(e)),e.subscribe(t))},e}(ln),wn=cn.defer=function(t){return new gn(t)},xn=function(t){function e(e){this.scheduler=e,t.call(this)}function n(t,e){this.observer=t,this.scheduler=e}function r(t,e){return e.onCompleted(),Ee}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this.scheduler);return e.run()},n.prototype.run=function(){var t=this.observer;return this.scheduler===Fe?r(null,t):this.scheduler.schedule(t,r)},e}(ln),Sn=new xn(Fe),En=cn.empty=function(t){return Me(t)||(t=Fe),t===Fe?Sn:new xn(t)},Cn=function(t){function e(e,n,r){this.iterable=e,this.mapper=n,this.scheduler=r,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new On(t,this);return e.run()},e}(ln),On=function(){function t(t,e){this.o=t,this.parent=e}return t.prototype.run=function(){function t(t,e){var o=jt(n.next).call(n);if(o===Dt)return r.onError(o.e);if(o.done)return r.onCompleted();var s=o.value;return Ot(i)&&(s=jt(i)(s,t),s===Dt)?r.onError(s.e):(r.onNext(s),void e(t+1))}var e=Object(this.parent.iterable),n=k(e),r=this.o,i=this.parent.mapper;return this.parent.scheduler.scheduleRecursive(0,t)},t}(),Dn=Math.pow(2,53)-1;C.prototype[It]=function(){return new O(this._s)},O.prototype[It]=function(){return this},O.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:Ut},D.prototype[It]=function(){return new j(this._a)},j.prototype[It]=function(){return this},j.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:Ut};var jn=cn.from=function(t,e,n,r){if(null==t)throw new Error("iterable cannot be null.");if(e&&!Ot(e))throw new Error("mapFn when provided must be a function");if(e)var i=Kt(e,n,2);return Me(r)||(r=Ue),new Cn(t,i,r)},Nn=function(t){function e(e,n){this.args=e,this.scheduler=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new T(t,this);return e.run()},e}(ln);T.prototype.run=function(){return this.parent.scheduler.scheduleRecursive(0,M(this.parent.args,this.observer))};var kn=cn.fromArray=function(t,e){return Me(e)||(e=Ue),new Nn(t,e)},Pn=function(t){function e(){t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return Ee},e}(ln),An=new Pn,Tn=cn.never=function(){return An};cn.of=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return new Nn(e,Ue)},cn.ofWithScheduler=function(t){for(var e=arguments.length,n=new Array(e-1),r=1;e>r;r++)n[r-1]=arguments[r];return new Nn(n,t)};var qn=function(t){function e(e,n){this.obj=e,this.keys=Object.keys(e),this.scheduler=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new L(t,this);return e.run()},e}(ln);L.prototype.run=function(){function t(t,o){if(i>t){var s=r[t];e.onNext([s,n[s]]),o(t+1)}else e.onCompleted()}var e=this.observer,n=this.parent.obj,r=this.parent.keys,i=r.length;return this.parent.scheduler.scheduleRecursive(0,t)},cn.pairs=function(t,e){return e||(e=Ue),new qn(t,e)};var Mn=function(t){function e(e,n,r){this.start=e,this.rangeCount=n,this.scheduler=r,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new Rn(t,this);return e.run()},e}(ln),Rn=function(){function t(t,e){this.observer=t,this.parent=e}function e(t,e,n){return function(r,i){e>r?(n.onNext(t+r),i(r+1)):n.onCompleted()}}return t.prototype.run=function(){return this.parent.scheduler.scheduleRecursive(0,e(this.parent.start,this.parent.rangeCount,this.observer))},t}();cn.range=function(t,e,n){return Me(n)||(n=Ue),new Mn(t,e,n)};var Ln=function(t){function e(e,n,r){this.value=e,this.repeatCount=null==n?-1:n,this.scheduler=r,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new V(t,this);return e.run()},e}(ln);V.prototype.run=function(){function t(t,r){return(-1===t||t>0)&&(e.onNext(n),t>0&&t--),0===t?e.onCompleted():void r(t)}var e=this.observer,n=this.parent.value;return this.parent.scheduler.scheduleRecursive(this.parent.repeatCount,t)},cn.repeat=function(t,e,n){return Me(n)||(n=Ue),new Ln(t,e,n)};var Vn=function(t){function e(e,n){this.value=e,this.scheduler=n,t.call(this)}function n(t,e,n){this.observer=t,this.value=e,this.scheduler=n}function r(t,e){var n=e[0],r=e[1];return r.onNext(n),r.onCompleted(),Ee}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this.value,this.scheduler);return e.run()},n.prototype.run=function(){var t=[this.value,this.observer];return this.scheduler===Fe?r(null,t):this.scheduler.schedule(t,r)},e}(ln),Fn=(cn["return"]=cn.just=function(t,e){return Me(e)||(e=Fe),new Vn(t,e)},function(t){function e(e,n){this.error=e,this.scheduler=n,t.call(this)}function n(t,e){this.o=t,this.p=e}function r(t,e){var n=e[0],r=e[1];r.onError(n)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this);return e.run()},n.prototype.run=function(){return this.p.scheduler.schedule([this.p.error,this.o],r)},e}(ln)),In=cn["throw"]=function(t,e){return Me(e)||(e=Fe),new Fn(t,e)},Un=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new je,n=new Ne;return n.setDisposable(e),e.setDisposable(this.source.subscribe(new zn(t,n,this._fn))),n},e}(ln),zn=function(t){function e(e,n,r){this._o=e,this._s=n,this._fn=r,t.call(this)}return ye(e,t),e.prototype.next=function(t){this._o.onNext(t)},e.prototype.completed=function(){return this._o.onCompleted()},e.prototype.error=function(t){var e=jt(this._fn)(t);if(e===Dt)return this._o.onError(e.e);Ct(e)&&(e=Vr(e));var n=new je;this._s.setDisposable(n),n.setDisposable(e.subscribe(this._o))},e}(sn);Ye["catch"]=function(t){return Ot(t)?new Un(this,t):Wn([this,t])};var Wn=cn["catch"]=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;e>n;n++)t[n]=arguments[n]}return yn(t).catchError()};Ye.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return Array.isArray(e[0])?e[0].unshift(this):e.unshift(this),Hn.apply(this,e)};var Bn=function(t){function e(e,n){this._params=e,this._cb=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){for(var e=this._params.length,n=new Array(e),r={hasValue:x(e,F),hasValueAll:!1,isDone:x(e,F),values:new Array(e)},i=0;e>i;i++){var o=this._params[i],s=new je;n[i]=s,Ct(o)&&(o=Vr(o)),s.setDisposable(o.subscribe(new Kn(t,i,this._cb,r)))}return new Pe(n)},e}(ln),Kn=function(t){function e(e,n,r,i){this._o=e,this._i=n,this._cb=r,this._state=i,t.call(this)}function n(t){return function(e,n){return n!==t}}return ye(e,t),e.prototype.next=function(t){if(this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll||(this._state.hasValueAll=this._state.hasValue.every(gt))){var e=jt(this._cb).apply(null,this._state.values);if(e===Dt)return this._o.onError(e.e);this._o.onNext(e)}else this._state.isDone.filter(n(this._i)).every(gt)&&this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._state.isDone[this._i]=!0,this._state.isDone.every(gt)&&this._o.onCompleted()},e}(sn),Hn=cn.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():I;return Array.isArray(e[0])&&(e=e[0]),new Bn(e,r)};Ye.concat=function(){for(var t=[],e=0,n=arguments.length;n>e;e++)t.push(arguments[e]);return t.unshift(this),$n.apply(null,t)};var Qn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){this.sources=t,this.o=e}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new n(this.sources,t);return e.run()},n.prototype.run=function(){var t,e=new Ne,n=this.sources,r=n.length,i=this.o,o=Fe.scheduleRecursive(0,function(o,s){if(!t){if(o===r)return i.onCompleted();var u=n[o];Ct(u)&&(u=Vr(u));var c=new je;e.setDisposable(c),c.setDisposable(u.subscribe(function(t){i.onNext(t)},function(t){i.onError(t)},function(){s(o+1)}))}});return new ge(e,o,Se(function(){t=!0}))},e}(ln),$n=cn.concat=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(arguments.length);for(var e=0,n=arguments.length;n>e;e++)t[e]=arguments[e]}return new Qn(t)};Ye.concatAll=function(){return this.merge(1)};var Yn=function(t){function e(e,n){this.source=e,this.maxConcurrent=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new ge;return e.add(this.source.subscribe(new Jn(t,this.maxConcurrent,e))),e},e}(ln),Jn=function(){function t(t,e,n){this.o=t,this.max=e,this.g=n,this.done=!1,this.q=[],this.activeCount=0,this.isStopped=!1}function e(t,e){this.parent=t,this.sad=e,this.isStopped=!1}return t.prototype.handleSubscribe=function(t){var n=new je;this.g.add(n),Ct(t)&&(t=Vr(t)),n.setDisposable(t.subscribe(new e(this,n)))},t.prototype.onNext=function(t){this.isStopped||(this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(t)):this.q.push(t))},t.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},t.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.done=!0,0===this.activeCount&&this.o.onCompleted())},t.prototype.dispose=function(){this.isStopped=!0},t.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},e.prototype.onNext=function(t){this.isStopped||this.parent.o.onNext(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.o.onError(t))},e.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var t=this.parent;t.g.remove(this.sad),t.q.length>0?t.handleSubscribe(t.q.shift()):(t.activeCount--,t.done&&0===t.activeCount&&t.o.onCompleted())}},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(t),!0)},t}();Ye.merge=function(t){return"number"!=typeof t?Gn(this,t):new Yn(this,t)};var Gn=cn.merge=function(){var t,e,n=[],r=arguments.length;if(arguments[0])if(Me(arguments[0]))for(t=arguments[0],e=1;r>e;e++)n.push(arguments[e]);else for(t=Fe,e=0;r>e;e++)n.push(arguments[e]);else for(t=Fe,e=1;r>e;e++)n.push(arguments[e]);return Array.isArray(n[0])&&(n=n[0]),R(t,n).mergeAll()},Xn=yt.CompositeError=function(t){this.innerErrors=t,this.message="This contains multiple errors. Check the innerErrors",Error.call(this)};Xn.prototype=Object.create(Error.prototype),Xn.prototype.name="CompositeError";var Zn=function(t){function e(e){this.source=e,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new ge,n=new je,r={isStopped:!1,errors:[],o:t};return e.add(n),n.setDisposable(this.source.subscribe(new tr(e,r))),e},e}(ln),tr=function(t){function e(e,n){this._group=e,this._state=n,t.call(this)}function n(t,e){0===e.length?t.onCompleted():1===e.length?t.onError(e[0]):t.onError(new Xn(e))}function r(e,n,r){this._inner=e,this._group=n,this._state=r,t.call(this)}return ye(e,t),e.prototype.next=function(t){var e=new je;this._group.add(e),Ct(t)&&(t=Vr(t)),e.setDisposable(t.subscribe(new r(e,this._group,this._state)))},e.prototype.error=function(t){this._state.errors.push(t),this._state.isStopped=!0,1===this._group.length&&n(this._state.o,this._state.errors)},e.prototype.completed=function(){this._state.isStopped=!0,1===this._group.length&&n(this._state.o,this._state.errors)},ye(r,t),r.prototype.next=function(t){this._state.o.onNext(t)},r.prototype.error=function(t){this._state.errors.push(t),this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&n(this._state.o,this._state.errors)},r.prototype.completed=function(){this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&n(this._state.o,this._state.errors)},e}(sn);cn.mergeDelayError=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;e>n;n++)t[n]=arguments[n]}var r=R(null,t);return new Zn(r)};var er=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.g=e,this.isStopped=!1,this.done=!1}function r(t,e){this.parent=t,this.sad=e,this.isStopped=!1}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new ge,r=new je;return e.add(r),r.setDisposable(this.source.subscribe(new n(t,e))),e},n.prototype.onNext=function(t){if(!this.isStopped){var e=new je;this.g.add(e),Ct(t)&&(t=Vr(t)),e.setDisposable(t.subscribe(new r(this,e)))}},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.done=!0,1===this.g.length&&this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},r.prototype.onNext=function(t){this.isStopped||this.parent.o.onNext(t)},r.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.o.onError(t))},r.prototype.onCompleted=function(){if(!this.isStopped){var t=this.parent;this.isStopped=!0,t.g.remove(this.sad),t.done&&1===t.g.length&&t.o.onCompleted()}},r.prototype.dispose=function(){this.isStopped=!0},r.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(t),!0)},e}(ln);Ye.mergeAll=function(){return new er(this)};var nr=function(t){function e(e,n){this._s=e,this._o=Ct(n)?Vr(n):n,this._open=!1,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new je;e.setDisposable(this._s.subscribe(new rr(t,this))),Ct(this._o)&&(this._o=Vr(this._o));var n=new je;return n.setDisposable(this._o.subscribe(new ir(t,this,n))),new ke(e,n)},e}(ln),rr=function(t){function e(e,n){this._o=e,this._p=n,t.call(this)}return ye(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._p._open&&this._o.onCompleted()},e}(sn),ir=function(t){function e(e,n,r){this._o=e,this._p=n,this._r=r,t.call(this)}return ye(e,t),e.prototype.next=function(){this._p._open=!0,this._r.dispose()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._r.dispose()},e}(sn);Ye.skipUntil=function(t){return new nr(this,t)};var or=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.inner=e,this.stopped=!1,this.latest=0,this.hasLatest=!1,sn.call(this)}function r(t,e){this.parent=t,this.id=e,sn.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new Ne,r=this.source.subscribe(new n(t,e));return new ke(r,e)},ye(n,sn),n.prototype.next=function(t){var e=new je,n=++this.latest;this.hasLatest=!0,this.inner.setDisposable(e),Ct(t)&&(t=Vr(t)),e.setDisposable(t.subscribe(new r(this,n)))},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.stopped=!0,!this.hasLatest&&this.o.onCompleted()},ye(r,sn),r.prototype.next=function(t){this.parent.latest===this.id&&this.parent.o.onNext(t)},r.prototype.error=function(t){this.parent.latest===this.id&&this.parent.o.onError(t)},r.prototype.completed=function(){this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.isStopped&&this.parent.o.onCompleted())},e}(ln);Ye["switch"]=Ye.switchLatest=function(){return new or(this)};var sr=function(t){function e(e,n){this.source=e,this.other=Ct(n)?Vr(n):n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return new ke(this.source.subscribe(t),this.other.subscribe(new ur(t)));
},e}(ln),ur=function(t){function e(e){this._o=e,t.call(this)}return ye(e,t),e.prototype.next=function(){this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=_t,e}(sn);Ye.takeUntil=function(t){return new sr(this,t)};var cr=function(t){function e(e,n,r){this._s=e,this._ss=n,this._cb=r,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){for(var e=this._ss.length,n={hasValue:x(e,F),hasValueAll:!1,values:new Array(e)},r=this._ss.length,i=new Array(r+1),o=0;r>o;o++){var s=this._ss[o],u=new je;Ct(s)&&(s=Vr(s)),u.setDisposable(s.subscribe(new ar(t,o,n))),i[o]=u}var u=new je;return u.setDisposable(this._s.subscribe(new lr(t,this._cb,n))),i[r]=u,new Pe(i)},e}(ln),ar=function(t){function e(e,n,r){this._o=e,this._i=n,this._state=r,t.call(this)}return ye(e,t),e.prototype.next=function(t){this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll=this._state.hasValue.every(gt)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=_t,e}(sn),lr=function(t){function e(e,n,r){this._o=e,this._cb=n,this._state=r,t.call(this)}return ye(e,t),e.prototype.next=function(t){var e=[t].concat(this._state.values);if(this._state.hasValueAll){var n=jt(this._cb).apply(null,e);return n===Dt?this._o.onError(n.e):void this._o.onNext(n)}},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);Ye.withLatestFrom=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():I;return Array.isArray(e[0])&&(e=e[0]),new cr(this,e,r)};var pr=function(t){function e(e,n){this._s=e,this._cb=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=this._s.length,n=new Array(e);done=x(e,F),q=x(e,U);for(var r=0;e>r;r++){var i=this._s[r],o=new je;n[r]=o,Ct(i)&&(i=Vr(i)),o.setDisposable(i.subscribe(new hr(t,r,this,q,done)))}return new Pe(n)},e}(ln),hr=function(t){function e(e,n,r,i,o){this._o=e,this._i=n,this._p=r,this._q=i,this._d=o,t.call(this)}function n(t){return t.length>0}function r(t){return t.shift()}function i(t){return function(e,n){return n!==t}}return ye(e,t),e.prototype.next=function(t){if(this._q[this._i].push(t),this._q.every(n)){var e=this._q.map(r),o=jt(this._p._cb).apply(null,e);if(o===Dt)return this._o.onError(o.e);this._o.onNext(o)}else this._d.filter(i(this._i)).every(gt)&&this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._d[this._i]=!0,this._d.every(gt)&&this._o.onCompleted()},e}(sn);Ye.zip=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():I;Array.isArray(e[0])&&(e=e[0]);var i=this;return e.unshift(i),new pr(e,r)},cn.zip=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];Array.isArray(e[0])&&(e=Ot(e[1])?e[0].concat(e[1]):e[0]);var r=e.shift();return r.zip.apply(r,e)},Ye.zipIterable=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():I,i=this;return e.unshift(i),new ti(function(t){for(var n=e.length,o=x(n,U),s=x(n,F),u=new Array(n),c=0;n>c;c++)!function(n){var c=e[n],a=new je;(Wt(c)||zt(c))&&(c=jn(c)),a.setDisposable(c.subscribe(function(e){if(o[n].push(e),o.every(function(t){return t.length>0})){var u=o.map(function(t){return t.shift()}),c=jt(r).apply(i,u);if(c===Dt)return t.onError(c.e);t.onNext(c)}else s.filter(function(t,e){return e!==n}).every(gt)&&t.onCompleted()},function(e){t.onError(e)},function(){s[n]=!0,s.every(gt)&&t.onCompleted()})),u[n]=a}(c);return new ge(u)},i)},Ye.asObservable=function(){return new ti(z(this),this)};var fr=function(t){function e(e){this.source=e,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new dr(t))},e}(ln),dr=function(t){function e(e){this._o=e,t.call(this)}return ye(e,t),e.prototype.next=function(t){t.accept(this._o)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);Ye.dematerialize=function(){return new fr(this)};var vr=function(t){function e(e,n,r){this.source=e,this.keyFn=n,this.comparer=r,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new br(t,this.keyFn,this.comparer))},e}(ln),br=function(t){function e(e,n,r){this.o=e,this.keyFn=n,this.comparer=r,this.hasCurrentKey=!1,this.currentKey=null,t.call(this)}return ye(e,t),e.prototype.next=function(t){var e,n=t;return Ot(this.keyFn)&&(n=jt(this.keyFn)(t),n===Dt)?this.o.onError(n.e):this.hasCurrentKey&&(e=jt(this.comparer)(this.currentKey,n),e===Dt)?this.o.onError(e.e):void(this.hasCurrentKey&&e||(this.hasCurrentKey=!0,this.currentKey=n,this.o.onNext(t)))},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.o.onCompleted()},e}(sn);Ye.distinctUntilChanged=function(t,e){return e||(e=xt),new vr(this,t,e)};var mr=function(t){function e(e,n,r,i){this.source=e,this._oN=n,this._oE=r,this._oC=i,t.call(this)}function n(t,e){this.o=t,this.t=!e._oN||Ot(e._oN)?on(e._oN||_t,e._oE||_t,e._oC||_t):e._oN,this.isStopped=!1,sn.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this))},ye(n,sn),n.prototype.next=function(t){var e=jt(this.t.onNext).call(this.t,t);e===Dt&&this.o.onError(e.e),this.o.onNext(t)},n.prototype.error=function(t){var e=jt(this.t.onError).call(this.t,t);return e===Dt?this.o.onError(e.e):void this.o.onError(t)},n.prototype.completed=function(){var t=jt(this.t.onCompleted).call(this.t);return t===Dt?this.o.onError(t.e):void this.o.onCompleted()},e}(ln);Ye["do"]=Ye.tap=Ye.doAction=function(t,e,n){return new mr(this,t,e,n)},Ye.doOnNext=Ye.tapOnNext=function(t,e){return this.tap("undefined"!=typeof e?function(n){t.call(e,n)}:t)},Ye.doOnError=Ye.tapOnError=function(t,e){return this.tap(_t,"undefined"!=typeof e?function(n){t.call(e,n)}:t)},Ye.doOnCompleted=Ye.tapOnCompleted=function(t,e){return this.tap(_t,null,"undefined"!=typeof e?function(){t.call(e)}:t)},Ye["finally"]=function(t){var e=this;return new ti(function(n){var r=jt(e.subscribe).call(e,n);return r===Dt?(t(),l(r.e)):Se(function(){var e=jt(r.dispose).call(r);t(),e===Dt&&l(e.e)})},this)};var yr=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.isStopped=!1}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},n.prototype.onNext=_t,n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.observer.onError(t),!0)},e}(ln);Ye.ignoreElements=function(){return new yr(this)};var _r=function(t){function e(e,n){this.source=e,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new gr(t))},e}(ln),gr=function(t){function e(e){this._o=e,t.call(this)}return ye(e,t),e.prototype.next=function(t){this._o.onNext(tn(t))},e.prototype.error=function(t){this._o.onNext(en(t)),this._o.onCompleted()},e.prototype.completed=function(){this._o.onNext(nn()),this._o.onCompleted()},e}(sn);Ye.materialize=function(){return new _r(this)},Ye.repeat=function(t){return bn(this,t).concat()},Ye.retry=function(t){return bn(this,t).catchError()},Ye.retryWhen=function(t){return bn(this).catchErrorWhen(t)};var wr=function(t){function e(e,n,r,i){this.source=e,this.accumulator=n,this.hasSeed=r,this.seed=i,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new xr(t,this))},e}(ln),xr=function(t){function e(e,n){this._o=e,this._p=n,this._fn=n.accumulator,this._hs=n.hasSeed,this._s=n.seed,this._ha=!1,this._a=null,this._hv=!1,this._i=0,t.call(this)}return ye(e,t),e.prototype.next=function(t){return!this._hv&&(this._hv=!0),this._ha?this._a=jt(this._fn)(this._a,t,this._i,this._p):(this._a=this._hs?jt(this._fn)(this._s,t,this._i,this._p):t,this._ha=!0),this._a===Dt?this._o.onError(this._a.e):(this._o.onNext(this._a),void this._i++)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){!this._hv&&this._hs&&this._o.onNext(this._s),this._o.onCompleted()},e}(sn);Ye.scan=function(){var t,e=!1,n=arguments[0];return 2===arguments.length&&(e=!0,t=arguments[1]),new wr(this,n,e,t)};var Sr=function(t){function e(e,n){this.source=e,this._c=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Er(t,this._c))},e}(ln),Er=function(t){function e(e,n){this._o=e,this._c=n,this._q=[],t.call(this)}return ye(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._o.onNext(this._q.shift())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);Ye.skipLast=function(t){if(0>t)throw new Rt;return new Sr(this,t)},Ye.startWith=function(){var t,e=0;arguments.length&&Me(arguments[0])?(t=arguments[0],e=1):t=Fe;for(var n=[],r=e,i=arguments.length;i>r;r++)n.push(arguments[r]);return yn([kn(n,t),this]).concat()};var Cr=function(t){function e(e,n){this._o=e,this._c=n,this._q=[],t.call(this)}return ye(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(;this._q.length>0;)this._o.onNext(this._q.shift());this._o.onCompleted()},e}(sn);Ye.takeLast=function(t){if(0>t)throw new Rt;var e=this;return new ti(function(n){return e.subscribe(new Cr(n,t))},e)},Ye.flatMapConcat=Ye.concatMap=function(t,e,n){return new pn(this,t,e,n).merge(1)};var Or=function(t){function e(e,n,r){this.source=e,this.selector=Kt(n,r,3),t.call(this)}function n(t,e){return function(n,r,i){return t.call(this,e.selector(n,r,i),r,i)}}function r(t,e,n){this.o=t,this.selector=e,this.source=n,this.i=0,sn.call(this)}return ye(e,t),e.prototype.internalMap=function(t,r){return new e(this.source,n(t,this),r)},e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.selector,this))},ye(r,sn),r.prototype.next=function(t){var e=jt(this.selector)(t,this.i++,this.source);return e===Dt?this.o.onError(e.e):void this.o.onNext(e)},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(ln);Ye.map=Ye.select=function(t,e){var n="function"==typeof t?t:function(){return t};return this instanceof Or?this.internalMap(n,e):new Or(this,n,e)},Ye.pluck=function(){var t=arguments.length,e=new Array(t);if(0===t)throw new Error("List of properties cannot be empty.");for(var n=0;t>n;n++)e[n]=arguments[n];return this.map(W(e,t))},Ye.flatMap=Ye.selectMany=function(t,e,n){return new pn(this,t,e,n).mergeAll()},yt.Observable.prototype.flatMapLatest=function(t,e,n){return new pn(this,t,e,n).switchLatest()};var Dr=function(t){function e(e,n){this.source=e,this.skipCount=n,t.call(this)}function n(t,e){this.c=e,this.r=e,this.o=t,this.isStopped=!1}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.skipCount))},n.prototype.onNext=function(t){this.isStopped||(this.r<=0?this.o.onNext(t):this.r--)},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},e}(ln);Ye.skip=function(t){if(0>t)throw new Rt;return new Dr(this,t)};var jr=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Nr(t,this))},e}(ln),Nr=function(t){function e(e,n){this._o=e,this._p=n,this._i=0,this._r=!1,t.call(this)}return ye(e,t),e.prototype.next=function(t){if(!this._r){var e=jt(this._p._fn)(t,this._i++,this._p);if(e===Dt)return this._o.onError(e.e);this._r=!e}this._r&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);Ye.skipWhile=function(t,e){var n=Kt(t,e,3);return new jr(this,n)};var kr=function(t){function e(e,n){this.source=e,this.takeCount=n,t.call(this)}function n(t,e){this.o=t,this.c=e,this.r=e,this.isStopped=!1}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.takeCount))},n.prototype={onNext:function(t){this.isStopped||this.r-->0&&(this.o.onNext(t),this.r<=0&&this.o.onCompleted())},onError:function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},onCompleted:function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},dispose:function(){this.isStopped=!0},fail:function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)}},e}(ln);Ye.take=function(t,e){if(0>t)throw new Rt;return 0===t?En(e):new kr(this,t)};var Pr=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Ar(t,this))},e}(ln),Ar=function(t){function e(e,n){this._o=e,this._p=n,this._i=0,this._r=!0,t.call(this)}return ye(e,t),e.prototype.next=function(t){return this._r&&(this._r=jt(this._p._fn)(t,this._i++,this._p),this._r===Dt)?this._o.onError(this._r.e):void(this._r?this._o.onNext(t):this._o.onCompleted())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);Ye.takeWhile=function(t,e){var n=Kt(t,e,3);return new Pr(this,n)};var Tr=function(t){function e(e,n,r){this.source=e,this.predicate=Kt(n,r,3),t.call(this)}function n(t,e){return function(n,r,i){return e.predicate(n,r,i)&&t.call(this,n,r,i)}}function r(t,e,n){this.o=t,this.predicate=e,this.source=n,this.i=0,sn.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.predicate,this))},e.prototype.internalFilter=function(t,r){return new e(this.source,n(t,this),r)},ye(r,sn),r.prototype.next=function(t){var e=jt(this.predicate)(t,this.i++,this.source);return e===Dt?this.o.onError(e.e):void(e&&this.o.onNext(t))},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(ln);Ye.filter=Ye.where=function(t,e){return this instanceof Tr?this.internalFilter(t,e):new Tr(this,t,e)},cn.fromCallback=function(t,e,n){return function(){"undefined"==typeof e&&(e=this);for(var r=arguments.length,i=new Array(r),o=0;r>o;o++)i[o]=arguments[o];return B(t,e,n,i)}},cn.fromNodeCallback=function(t,e,n){return function(){"undefined"==typeof e&&(e=this);for(var r=arguments.length,i=new Array(r),o=0;r>o;o++)i[o]=arguments[o];return H(t,e,n,i)}},Y.prototype.dispose=function(){this.isDisposed||(this._e.removeEventListener(this._n,this._fn,!1),this.isDisposed=!0)},yt.config.useNativeEvents=!1;var qr=function(t){function e(e,n,r){this._el=e,this._n=n,this._fn=r,t.call(this)}function n(t,e){return function(){var n=arguments[0];return Ot(e)&&(n=jt(e).apply(null,arguments),n===Dt)?t.onError(n.e):void t.onNext(n)}}return ye(e,t),e.prototype.subscribeCore=function(t){return J(this._el,this._n,n(t,this._fn))},e}(ln);cn.fromEvent=function(t,e,n){return t.addListener?Rr(function(n){t.addListener(e,n)},function(n){t.removeListener(e,n)},n):yt.config.useNativeEvents||"function"!=typeof t.on||"function"!=typeof t.off?new qr(t,e,n).publish().refCount():Rr(function(n){t.on(e,n)},function(n){t.off(e,n)},n)};var Mr=function(t){function e(e,n,r){this._add=e,this._del=n,this._fn=r,t.call(this)}function n(t,e){return function(){var n=arguments[0];return Ot(e)&&(n=jt(e).apply(null,arguments),n===Dt)?t.onError(n.e):void t.onNext(n)}}function r(t,e,n){this._del=t,this._fn=e,this._ret=n,this.isDisposed=!1}return ye(e,t),e.prototype.subscribeCore=function(t){var e=n(t,this._fn),i=this._add(e);return new r(this._del,e,i)},r.prototype.dispose=function(){this.isDisposed||Ot(this._del)&&this._del(this._fn,this._ret)},e}(ln),Rr=cn.fromEventPattern=function(t,e,n){return new Mr(t,e,n).publish().refCount()},Lr=function(t){function e(e,n){this._p=e,this._s=n,t.call(this)}function n(t,e){var n=e[0],r=e[1];n.onNext(r),n.onCompleted()}function r(t,e){var n=e[0],r=e[1];n.onError(r)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new je,i=this;return this._p.then(function(r){e.setDisposable(i._s.schedule([t,r],n))},function(n){e.setDisposable(i._s.schedule([t,n],r))}),e},e}(ln),Vr=cn.fromPromise=function(t,e){return e||(e=He),new Lr(t,e)};Ye.toPromise=function(t){if(t||(t=yt.config.Promise),!t)throw new Lt("Promise type not provided nor in Rx.config.Promise");var e=this;return new t(function(t,n){var r;e.subscribe(function(t){r=t},n,function(){t(r)})})},cn.startAsync=function(t){var e=jt(t)();return e===Dt?In(e.e):Vr(e)};var Fr=function(t){function e(e,n,r){this.source=e,this._fn1=n,this._fn2=r,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=this.source.multicast(this._fn1());return new ke(this._fn2(e).subscribe(t),e.connect())},e}(ln);Ye.multicast=function(t,e){return Ot(t)?new Fr(this,t,e):new Ur(this,t)},Ye.publish=function(t){return t&&Ot(t)?this.multicast(function(){return new ri},t):this.multicast(new ri)},Ye.share=function(){return this.publish().refCount()},Ye.publishLast=function(t){return t&&Ot(t)?this.multicast(function(){return new ii},t):this.multicast(new ii)},Ye.publishValue=function(t,e){return 2===arguments.length?this.multicast(function(){return new si(e)},t):this.multicast(new si(t))},Ye.shareValue=function(t){return this.publishValue(t).refCount()},Ye.replay=function(t,e,n,r){return t&&Ot(t)?this.multicast(function(){return new ui(e,n,r)},t):this.multicast(new ui(e,n,r))},Ye.shareReplay=function(t,e,n){return this.replay(null,t,e,n).refCount()};var Ir=function(t){function e(e){this.source=e,this._count=0,this._connectableSubscription=null,t.call(this)}function n(t,e){this._p=t,this._s=e,this.isDisposed=!1}return ye(e,t),e.prototype.subscribeCore=function(t){var e=1===++this._count,r=this.source.subscribe(t);return e&&(this._connectableSubscription=this.source.connect()),new n(this,r)},n.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.dispose(),0===--this._p._count&&this._p._connectableSubscription.dispose())},e}(ln),Ur=yt.ConnectableObservable=function(t){function e(e,n){this.source=e,this._hasSubscription=!1,this._subscription=null,this._sourceObservable=e.asObservable(),this._subject=n,t.call(this)}function n(t){this._p=t,this.isDisposed=!1}return ye(e,t),n.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._p._hasSubscription=!1)},e.prototype.connect=function(){return this._hasSubscription||(this._hasSubscription=!0,this._subscription=new ke(this._sourceObservable.subscribe(this._subject),new n(this))),this._subscription},e.prototype._subscribe=function(t){return this._subject.subscribe(t)},e.prototype.refCount=function(){return new Ir(this)},e}(cn),zr=function(t){function e(e,n){this._dt=e,this._s=n,t.call(this)}function n(t,e){e.onNext(0),e.onCompleted()}return ye(e,t),e.prototype.subscribeCore=function(t){return this._s.scheduleFuture(t,this._dt,n)},e}(ln),Wr=cn.interval=function(t,e){return Z(t,t,Me(e)?e:He)};cn.timer=function(t,e,n){var r;return Me(n)||(n=He),null!=e&&"number"==typeof e?r=e:Me(e)&&(n=e),(t instanceof Date||"number"==typeof t)&&r===s?G(t,n):t instanceof Date&&r!==s?X(t.getTime(),e,n):Z(t,r,n)};Ye.delay=function(){var t=arguments[0];if("number"==typeof t||t instanceof Date){var e=t,n=arguments[1];return Me(n)||(n=He),e instanceof Date?et(this,e,n):tt(this,e,n)}if(cn.isObservable(t)||Ot(t))return nt(this,t,arguments[1]);throw new Error("Invalid arguments")};var Br=function(t){function e(e,n,r){Me(r)||(r=He),this.source=e,this._dt=n,this._s=r,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){var e=new Ne;return new ke(this.source.subscribe(new Kr(t,this.source,this._dt,this._s,e)),e)},e}(ln),Kr=function(t){function e(e,n,r,i,o){this._o=e,this._s=n,this._d=r,this._scheduler=i,this._c=o,this._v=null,this._hv=!1,this._id=0,t.call(this)}return ye(e,t),e.prototype.next=function(t){this._hv=!0,this._v=t;var e=++this._id,n=new je;this._c.setDisposable(n),n.setDisposable(this._scheduler.scheduleFuture(this,this._d,function(n,r){r._hv&&r._id===e&&r._o.onNext(t),r._hv=!1}))},e.prototype.error=function(t){this._c.dispose(),this._o.onError(t),this._hv=!1,this._id++},e.prototype.completed=function(){this._c.dispose(),this._hv&&this._o.onNext(this._v),this._o.onCompleted(),this._hv=!1,this._id++},e}(sn);Ye.debounce=function(){if(Ot(arguments[0]))return rt(this,arguments[0]);if("number"==typeof arguments[0])return new Br(this,arguments[0],arguments[1]);throw new Error("Invalid arguments")};var Hr=function(t){function e(e,n){this.source=e,this._s=n,t.call(this)}return ye(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Qr(t,this._s))},e}(ln),Qr=function(t){function e(e,n){this._o=e,this._s=n,t.call(this)}return ye(e,t),e.prototype.next=function(t){this._o.onNext({value:t,timestamp:this._s.now()})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);Ye.timestamp=function(t){return Me(t)||(t=He),new Hr(this,t)},Ye.sample=Ye.throttleLatest=function(t,e){return Me(e)||(e=He),"number"==typeof t?it(this,Wr(t,e)):it(this,t)};var $r=yt.TimeoutError=function(t){this.message=t||"Timeout has occurred",this.name="TimeoutError",Error.call(this)};$r.prototype=Object.create(Error.prototype),Ye.timeout=function(){var t=arguments[0];if(t instanceof Date||"number"==typeof t)return st(this,t,arguments[1],arguments[2]);if(cn.isObservable(t)||Ot(t))return ot(this,t,arguments[1],arguments[2]);throw new Error("Invalid arguments")},Ye.throttle=function(t,e){Me(e)||(e=He);var n=+t||0;if(0>=n)throw new RangeError("windowDuration cannot be less or equal zero.");var r=this;return new ti(function(t){var i=0;return r.subscribe(function(r){var o=e.now();(0===i||o-i>=n)&&(i=o,t.onNext(r))},function(e){t.onError(e)},function(){t.onCompleted()})},r)};var Yr=function(t){function e(e,n){this.source=e,this.controller=new ri,n&&n.subscribe?this.pauser=this.controller.merge(n):this.pauser=this.controller,t.call(this)}return ye(e,t),e.prototype._subscribe=function(t){var e=this.source.publish(),n=e.subscribe(t),r=Ee,i=this.pauser.distinctUntilChanged().subscribe(function(t){t?r=e.connect():(r.dispose(),r=Ee)});return new Pe([n,r,i])},e.prototype.pause=function(){this.controller.onNext(!1)},e.prototype.resume=function(){this.controller.onNext(!0)},e}(cn);Ye.pausable=function(t){return new Yr(this,t)};var Jr=function(t){function e(e,n){this.source=e,this.controller=new ri,n&&n.subscribe?this.pauser=this.controller.merge(n):this.pauser=this.controller,t.call(this)}return ye(e,t),e.prototype._subscribe=function(t){function e(){for(;r.length>0;)t.onNext(r.shift())}var n,r=[],i=ut(this.source,this.pauser.startWith(!1).distinctUntilChanged(),function(t,e){return{data:t,shouldFire:e}}).subscribe(function(i){n!==s&&i.shouldFire!==n?(n=i.shouldFire,i.shouldFire&&e()):(n=i.shouldFire,i.shouldFire?t.onNext(i.data):r.push(i.data))},function(n){e(),t.onError(n)},function(){e(),t.onCompleted()});return i},e.prototype.pause=function(){this.controller.onNext(!1)},e.prototype.resume=function(){this.controller.onNext(!0)},e}(cn);Ye.pausableBuffered=function(t){return new Jr(this,t)};var Gr=function(t){function e(e,n,r){t.call(this),this.subject=new Xr(n,r),this.source=e.multicast(this.subject).refCount()}return ye(e,t),e.prototype._subscribe=function(t){return this.source.subscribe(t)},e.prototype.request=function(t){return this.subject.request(null==t?-1:t)},e}(cn),Xr=function(t){function e(e,n){null==e&&(e=!0),t.call(this),this.subject=new ri,this.enableQueue=e,this.queue=e?[]:null,this.requestedCount=0,this.requestedDisposable=null,this.error=null,this.hasFailed=!1,this.hasCompleted=!1,this.scheduler=n||Ue}return ye(e,t),_e(e.prototype,rn,{_subscribe:function(t){return this.subject.subscribe(t)},onCompleted:function(){this.hasCompleted=!0,this.enableQueue&&0!==this.queue.length?this.queue.push(Je.createOnCompleted()):(this.subject.onCompleted(),this.disposeCurrentRequest())},onError:function(t){this.hasFailed=!0,this.error=t,this.enableQueue&&0!==this.queue.length?this.queue.push(Je.createOnError(t)):(this.subject.onError(t),this.disposeCurrentRequest())},onNext:function(t){this.requestedCount<=0?this.enableQueue&&this.queue.push(Je.createOnNext(t)):(0===this.requestedCount--&&this.disposeCurrentRequest(),this.subject.onNext(t))},_processRequest:function(t){if(this.enableQueue)for(;this.queue.length>0&&(t>0||"N"!==this.queue[0].kind);){var e=this.queue.shift();e.accept(this.subject),"N"===e.kind?t--:(this.disposeCurrentRequest(),this.queue=[])}return t},request:function(t){this.disposeCurrentRequest();var e=this;return this.requestedDisposable=this.scheduler.schedule(t,function(t,n){var r=e._processRequest(n),i=e.hasCompleted||e.hasFailed;return!i&&r>0?(e.requestedCount=r,Se(function(){e.requestedCount=0})):void 0}),this.requestedDisposable},disposeCurrentRequest:function(){this.requestedDisposable&&(this.requestedDisposable.dispose(),this.requestedDisposable=null)}}),e}(cn);Ye.controlled=function(t,e){return t&&Me(t)&&(e=t,t=!0),null==t&&(t=!0),new Gr(this,t,e)},Ye.pipe=function(t){function e(){n.resume()}var n=this.pausableBuffered();return t.addListener("drain",e),n.subscribe(function(e){!t.write(String(e))&&n.pause()},function(e){t.emit("error",e)},function(){!t._isStdio&&t.end(),t.removeListener("drain",e)}),n.resume(),t};var Zr=function(t){function e(e,n){this._o=e,this._xform=n,t.call(this)}return ye(e,t),e.prototype.next=function(t){var e=jt(this._xform["@@transducer/step"]).call(this._xform,this._o,t);e===Dt&&this._o.onError(e.e)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._xform["@@transducer/result"](this._o)},e}(sn);Ye.transduce=function(t){var e=this;return new ti(function(n){var r=t(ct(n));return e.subscribe(new Zr(n,r))},e)};var ti=yt.AnonymousObservable=function(t){function e(t){return t&&Ot(t.dispose)?t:Ot(t)?Se(t):Ee}function n(t,n){var r=n[0],i=n[1],o=jt(i.__subscribe).call(i,r);o!==Dt||r.fail(Dt.e)||l(Dt.e),r.setDisposable(e(o))}function r(e,n){this.source=n,this.__subscribe=e,t.call(this)}return ye(r,t),r.prototype._subscribe=function(t){var e=new ei(t),r=[e,this];return Ue.scheduleRequired()?Ue.schedule(r,n):n(null,r),e},r}(cn),ei=function(t){function e(e){t.call(this),this.observer=e,this.m=new je}ye(e,t);var n=e.prototype;return n.next=function(t){var e=jt(this.observer.onNext).call(this.observer,t);e===Dt&&(this.dispose(),l(e.e))},n.error=function(t){var e=jt(this.observer.onError).call(this.observer,t);this.dispose(),e===Dt&&l(e.e)},n.completed=function(){var t=jt(this.observer.onCompleted).call(this.observer);this.dispose(),t===Dt&&l(t.e)},n.setDisposable=function(t){this.m.setDisposable(t)},n.getDisposable=function(){return this.m.getDisposable()},n.dispose=function(){t.prototype.dispose.call(this),this.m.dispose()},e}(sn),ni=function(t,e){this._s=t,this._o=e};ni.prototype.dispose=function(){if(!this._s.isDisposed&&null!==this._o){var t=this._s.observers.indexOf(this._o);this._s.observers.splice(t,1),this._o=null}};var ri=yt.Subject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return ye(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?this.hasError?(t.onError(this.error),Ee):(t.onCompleted(),Ee):(this.observers.push(t),new ni(this,t))},hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=c(this.observers),n=e.length;n>t;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(Oe(this),!this.isStopped)for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onNext(t)},dispose:function(){this.isDisposed=!0,this.observers=null}}),e.create=function(t,e){return new oi(t,e)},e}(cn),ii=yt.AsyncSubject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return ye(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?(this.hasError?t.onError(this.error):this.hasValue?(t.onNext(this.value),t.onCompleted()):t.onCompleted(),Ee):(this.observers.push(t),new ni(this,t))},hasObservers:function(){return Oe(this),this.observers.length>0},onCompleted:function(){var t,e;if(Oe(this),!this.isStopped){this.isStopped=!0;var n=c(this.observers),e=n.length;if(this.hasValue)for(t=0;e>t;t++){var r=n[t];r.onNext(this.value),r.onCompleted()}else for(t=0;e>t;t++)n[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){Oe(this),this.isStopped||(this.value=t,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.error=null,this.value=null}}),e}(cn),oi=yt.AnonymousSubject=function(t){function e(e,n){this.observer=e,this.observable=n,t.call(this)}return ye(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return this.observable.subscribe(t)},onCompleted:function(){this.observer.onCompleted()},onError:function(t){this.observer.onError(t)},onNext:function(t){this.observer.onNext(t)}}),e}(cn),si=yt.BehaviorSubject=function(t){function e(e){t.call(this),this.value=e,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return ye(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?(this.hasError?t.onError(this.error):t.onCompleted(),Ee):(this.observers.push(t),t.onNext(this.value),new ni(this,t))},getValue:function(){if(Oe(this),this.hasError)throw this.error;return this.value},hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=c(this.observers),n=e.length;n>t;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(Oe(this),!this.isStopped){this.value=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onNext(t)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.error=null}}),e}(cn),ui=yt.ReplaySubject=function(t){function e(t,e){return Se(function(){e.dispose(),!t.isDisposed&&t.observers.splice(t.observers.indexOf(e),1)})}function n(e,n,i){this.bufferSize=null==e?r:e,this.windowSize=null==n?r:n,this.scheduler=i||Ue,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,t.call(this)}var r=Math.pow(2,53)-1;return ye(n,t),_e(n.prototype,rn.prototype,{_subscribe:function(t){Oe(this);var n=new an(this.scheduler,t),r=e(this,n);this._trim(this.scheduler.now()),this.observers.push(n);for(var i=0,o=this.q.length;o>i;i++)n.onNext(this.q[i].value);return this.hasError?n.onError(this.error):this.isStopped&&n.onCompleted(),n.ensureActive(),r},hasObservers:function(){return this.observers.length>0},_trim:function(t){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&t-this.q[0].interval>this.windowSize;)this.q.shift();
},onNext:function(t){if(Oe(this),!this.isStopped){var e=this.scheduler.now();this.q.push({interval:e,value:t}),this._trim(e);for(var n=0,r=c(this.observers),i=r.length;i>n;n++){var o=r[n];o.onNext(t),o.ensureActive()}}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;var e=this.scheduler.now();this._trim(e);for(var n=0,r=c(this.observers),i=r.length;i>n;n++){var o=r[n];o.onError(t),o.ensureActive()}this.observers.length=0}},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;var t=this.scheduler.now();this._trim(t);for(var e=0,n=c(this.observers),r=n.length;r>e;e++){var i=n[e];i.onCompleted(),i.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),n}(cn);yt.Pauser=function(t){function e(){t.call(this)}return ye(e,t),e.prototype.pause=function(){this.onNext(!1)},e.prototype.resume=function(){this.onNext(!0)},e}(ri),mt.Rx=yt,r=function(){return yt}.call(e,n,e,t),!(r!==s&&(t.exports=r));var ci=v()}).call(this)}).call(e,n(33)(t),function(){return this}(),n(4))},function(t,e,n){e=t.exports=n(14)(),e.push([t.id,".climb__wall{width:100%;padding:0;margin:0;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;font-size:100%}.climb__tile,.climb__wall{display:-webkit-flex;display:-ms-flexbox;display:flex}.climb__tile{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:425px;box-sizing:border-box;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;outline:1px solid transparent;margin-bottom:20px;overflow:hidden;text-align:left;border-radius:7px;background-color:#f6f6f6;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:1000px;perspective:1000px}.climb__tile__content{z-index:1;padding:26px;background-color:#f6f6f6}.climb__tile--has-no-image .climb__tile__content{height:100%;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;box-sizing:border-box}.climb__tile__image{max-width:100%;position:absolute;top:0;border-top-left-radius:7px;border-top-right-radius:7px}.climb__tile__message{z-index:1;margin-bottom:24px}.climb__tile__message>a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:260px;display:inline-block;vertical-align:bottom}.climb__tile--has-no-image .climb__tile__message{font-size:185%}.climb__tile__author{display:block;margin:-10px}.climb__tile__author img{border-radius:25px;width:34px}.climb__tile__author .climb__tile__author__username{display:inline-block;margin:0 0 0 10px;line-height:34px;vertical-align:top}.climb-badge{position:fixed;bottom:20px;right:20px;z-index:9;background:#a9cae2 url("+n(16)+") center center no-repeat;width:200px;height:80px;border-radius:5px}.climb-badge>span{position:absolute!important;top:-9999px!important;left:-9999px!important}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var s=e[i];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(t,e,n){var r,i,o;!function(n,s){i=[e,t],r=s,o="function"==typeof r?r.apply(e,i):r,!(void 0!==o&&(t.exports=o))}(this,function(t,e){"use strict";function n(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function r(t){try{delete window[t]}catch(e){window[t]=void 0}}function i(t){var e=document.getElementById(t);document.getElementsByTagName("head")[0].removeChild(e)}var o={timeout:5e3,jsonpCallback:"callback"},s=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=null!=e.timeout?e.timeout:o.timeout,u=null!=e.jsonpCallback?e.jsonpCallback:o.jsonpCallback,c=void 0;return new Promise(function(e,o){var a=n();window[a]=function(t){e({ok:!0,json:function(){return Promise.resolve(t)}}),c&&clearTimeout(c),i(u+"_"+a),r(a)},t+=-1===t.indexOf("?")?"?":"&";var l=document.createElement("script");l.setAttribute("src",t+u+"="+a),l.id=u+"_"+a,document.getElementsByTagName("head")[0].appendChild(l),c=setTimeout(function(){o(new Error("JSONP request to "+t+" timed out")),r(a),i(u+"_"+a)},s)})};e.exports=s})},function(t,e,n){t.exports=n.p+"ea94cbc37b70ee0fc232e6ab2fa00a02.png"},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(){function t(){var e=d(),n=e-m;m=e,y+=n*u,y>i*l&&(y=0);for(var r=Math.ceil(y/i),o=0;o<v.length;o++){var s=v[o],c=s.active,a=s.animationStep,p=s.prevState,f=v[o].nextState;if(c)if(0>=y)v[o].nextState=a(i/1e3,p);else for(var _=0;r>_;_++){v[o].nextState=a(i/1e3,f);var g=[f,v[o].nextState];v[o].prevState=g[0],f=g[1]}}y-=r*i;for(var w=1+y/i,o=0;o<v.length;o++){var x=v[o],S=x.animationRender,E=x.nextState,C=x.prevState;S(w,E,C)}v=v.filter(function(t){var e=t.active;return e}),0===v.length?b=!1:h(t)}function e(){b||(b=!0,m=d(),y=0,h(t))}var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=n.timeStep,i=void 0===r?1/60*1e3:r,o=n.timeScale,u=void 0===o?1:o,a=n.maxSteps,l=void 0===a?10:a,p=n.raf,h=void 0===p?c["default"]:p,f=n.now,d=void 0===f?s["default"]:f,v=[],b=!1,m=0,y=0;return function(t,n,r){for(var i=0;i<v.length;i++){var o=v[i];if(o.animationStep===n)return o.active=!0,o.prevState=t,e(),o.stop}var s={animationStep:n,animationRender:r,prevState:t,nextState:t,active:!0};return s.stop=function(){return s.active=!1},v.push(s),e(),s.stop}}e.__esModule=!0,e["default"]=i;var o=n(3),s=r(o),u=n(30),c=r(u);t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r));return n}function o(t,e){for(var n in e)if(e.hasOwnProperty(n)&&!t(e[n],n))return!1;return!0}function s(t){var e=t.PropTypes,n=t.createClass({displayName:"Motion",propTypes:{defaultValue:function(t,e){return t[e]?new Error("Spring's `defaultValue` has been changed to `defaultStyle`. Its format received a few (easy to update!) changes as well."):void 0},endValue:function(t,e){return t[e]?new Error("Spring's `endValue` has been changed to `style`. Its format received a few (easy to update!) changes as well."):void 0},defaultStyle:e.object,style:e.object.isRequired,children:e.func.isRequired},getInitialState:function(){var t=this.props,e=t.defaultStyle,n=t.style,r=e||n;return{currentStyle:r,currentVelocity:i(m["default"],r)}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyle,r=e.currentVelocity,i=this.props.style,o=y.updateCurrentStyle(t,n,r,i),s=y.updateCurrentVelocity(t,n,r,i);return a["default"](r,o)&&a["default"](s,o)&&this.stopAnimation(),{currentStyle:o,currentVelocity:s}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=S(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){this.hasUnmounted||this.setState({currentStyle:y.interpolateValue(t,e.currentStyle,n.currentStyle),currentVelocity:e.currentVelocity})},render:function(){var e=x["default"](this.state.currentStyle),n=this.props.children(e);return n&&t.Children.only(n)}}),r=t.createClass({displayName:"StaggeredMotion",propTypes:{defaultStyle:function(t,e){return t[e]?new Error('You forgot the "s" for `StaggeredMotion`\'s `defaultStyles`.'):void 0},style:function(t,e){return t[e]?new Error('You forgot the "s" for `StaggeredMotion`\'s `styles`.'):void 0},defaultStyles:e.arrayOf(e.object),styles:e.func.isRequired,children:e.func.isRequired},getInitialState:function(){var t=this.props,e=t.styles,n=t.defaultStyles,r=n?n:e();return{currentStyles:r,currentVelocities:r.map(function(t){return i(m["default"],t)})}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyles,r=e.currentVelocities,i=this.props.styles(n.map(x["default"])),o=n.map(function(e,n){return y.updateCurrentStyle(t,e,r[n],i[n])}),s=n.map(function(e,n){return y.updateCurrentVelocity(t,e,r[n],i[n])});return r.every(function(t,e){return a["default"](t,n[e])})&&s.every(function(t,e){return a["default"](t,o[e])})&&this.stopAnimation(),{currentStyles:o,currentVelocities:s}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=S(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){if(!this.hasUnmounted){var r=e.currentStyles.map(function(e,r){return y.interpolateValue(t,e,n.currentStyles[r])});this.setState({currentStyles:r,currentVelocities:e.currentVelocities})}},render:function(){var e=this.state.currentStyles.map(x["default"]),n=this.props.children(e);return n&&t.Children.only(n)}}),s=t.createClass({displayName:"TransitionMotion",propTypes:{defaultValue:function(t,e){return t[e]?new Error("TransitionSpring's `defaultValue` has been changed to `defaultStyles`. Its format received a few (easy to update!) changes as well."):void 0},endValue:function(t,e){return t[e]?new Error("TransitionSpring's `endValue` has been changed to `styles`. Its format received a few (easy to update!) changes as well."):void 0},defaultStyle:function(t,e){return t[e]?new Error('You forgot the "s" for `TransitionMotion`\'s `defaultStyles`.'):void 0},style:function(t,e){return t[e]?new Error('You forgot the "s" for `TransitionMotion`\'s `styles`.'):void 0},defaultStyles:e.objectOf(e.any),styles:e.oneOfType([e.func,e.objectOf(e.any.isRequired)]).isRequired,willLeave:e.oneOfType([e.func]),willEnter:e.oneOfType([e.func]),children:e.func.isRequired},getDefaultProps:function(){return{willEnter:function(t,e){return e},willLeave:function(){return null}}},getInitialState:function(){var t=this.props,e=t.styles,n=t.defaultStyles,r=void 0;return r=null==n?"function"==typeof e?e():e:n,{currentStyles:r,currentVelocities:i(function(t){return i(m["default"],t)},r)}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyles,r=e.currentVelocities,s=this.props,c=s.styles,l=s.willEnter,h=s.willLeave;"function"==typeof c&&(c=c(n));var d=c,v=!1;d=f["default"](n,c,function(t){var e=h(t,n[t],c,n,r);return null==e?null:a["default"](r[t],n[t])&&p["default"](n[t],e)?null:e}),Object.keys(d).filter(function(t){return!n.hasOwnProperty(t)}).forEach(function(t){var e,o;v=!0;var s=l(t,d[t],c,n,r);d[t]=s,n=u({},n,(e={},e[t]=s,e)),r=u({},r,(o={},o[t]=i(m["default"],s),o))});var b=i(function(e,i){return y.updateCurrentStyle(t,n[i],r[i],e)},d),_=i(function(e,i){return y.updateCurrentVelocity(t,n[i],r[i],e)},d);return!v&&o(function(t,e){return a["default"](t,n[e])},r)&&o(function(t,e){return a["default"](t,b[e])},_)&&this.stopAnimation(),{currentStyles:b,currentVelocities:_}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=S(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){if(!this.hasUnmounted){var r=i(function(e,r){return y.interpolateValue(t,e,n.currentStyles[r])},e.currentStyles);this.setState({currentStyles:r,currentVelocities:e.currentVelocities})}},render:function(){var e=i(x["default"],this.state.currentStyles),n=this.props.children(e);return n&&t.Children.only(n)}}),c=g["default"](t),l=c.Spring,h=c.TransitionSpring;return{Spring:l,TransitionSpring:h,Motion:n,StaggeredMotion:r,TransitionMotion:s}}e.__esModule=!0;var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e["default"]=s;var c=n(22),a=r(c),l=n(20),p=r(l),h=n(21),f=r(h),d=n(17),v=r(d),b=n(29),m=r(b),y=n(28),_=n(19),g=r(_),w=n(27),x=r(w),S=v["default"]();t.exports=e["default"]},function(t,e,n){"use strict";function r(t){var e=t.createClass({displayName:"Spring",componentWillMount:function(){},render:function(){return null}}),n=t.createClass({displayName:"TransitionSpring",componentWillMount:function(){},render:function(){return null}});return{Spring:e,TransitionSpring:n}}e.__esModule=!0,e["default"]=r;t.exports=e["default"]},function(t,e){"use strict";function n(t,e){for(var n in e)if(e.hasOwnProperty(n)){var r=t[n],i=e[n];if(i.config){if(r.config&&r.val!==i.val)return!1;if(!r.config&&r!==i.val)return!1}}return!0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e){"use strict";function n(t,e,n,r,i,o,s){for(var u=!0;u;){var c=t,a=e,l=n,p=r,h=i,f=o,d=s;v=b=m=y=_=_=void 0,u=!1;var v=p===c.length,b=h===a.length,m=c[p],y=a[h];if(v&&b)return null;if(v)d[y]=l[y],t=c,e=a,n=l,r=p,i=h+1,o=f,s=d,u=!0;else if(b){var _=f(m);null!=_&&(d[m]=_),t=c,e=a,n=l,r=p+1,i=h,o=f,s=d,u=!0}else if(m!==y)if(l.hasOwnProperty(m))t=c,e=a,n=l,r=p+1,i=h,o=f,s=d,u=!0;else{var _=f(m);null!=_&&(d[m]=_),t=c,e=a,n=l,r=p+1,i=h,o=f,s=d,u=!0}else d[m]=l[m],t=c,e=a,n=l,r=p+1,i=h+1,o=f,s=d,u=!0}}function r(t,e,r){var i={};return n(Object.keys(t),Object.keys(e),e,0,0,r,i),i}e.__esModule=!0,e["default"]=r,t.exports=e["default"]},function(t,e){"use strict";function n(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e[n].config&&0!==t[n])return!1;return!0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=n(1),o=r(i),s=n(18),u=r(s),c=n(24),a=r(c),l=u["default"](o["default"]),p=l.Spring,h=l.TransitionSpring,f=l.Motion,d=l.StaggeredMotion,v=l.TransitionMotion;e.Spring=p,e.TransitionSpring=h,e.Motion=f,e.StaggeredMotion=d,e.TransitionMotion=v;var b=n(25),m=r(b);e.spring=m["default"];var y=n(2),_=r(y);e.presets=_["default"];var g={reorderKeys:a["default"]};e.utils=g},function(t,e){"use strict";function n(t,e){for(var n=e(Object.keys(t)),r={},i=0;i<n.length;i++){var o=n[i];r[o]=t[o]}return r}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){var e=arguments.length<=1||void 0===arguments[1]?s["default"].noWobble:arguments[1];return{val:t,config:e}}e.__esModule=!0,e["default"]=i;var o=n(2),s=r(o);t.exports=e["default"]},function(t,e){"use strict";function n(t,e,n,i,o,s){var u=-o*(e-i),c=-s*n,a=u+c,l=n+a*t,p=e+l*t;return Math.abs(l-n)<r&&Math.abs(p-e)<r?[i,0]:[p,l]}e.__esModule=!0,e["default"]=n;var r=1e-4;t.exports=e["default"]},function(t,e){"use strict";function n(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=null==t[n].val?t[n]:t[n].val);return e}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e,n){if(!n)return e;var r={};for(var i in e)if(e.hasOwnProperty(i))if(e[i].config){var o=n[i].config?n[i].val:n[i];r[i]={val:e[i].val*t+o*(1-t),config:e[i].config}}else r[i]=e[i];return r}function o(t,e,n,r){var i={};for(var o in r)if(r.hasOwnProperty(o))if(r[o].config){var s=r[o].config,u=s[0],a=s[1],l=c["default"](t,null==e[o].val?e[o]:e[o].val,n[o],r[o].val,u,a)[0];i[o]={val:l,config:r[o].config}}else i[o]=r[o];return i}function s(t,e,n,r){var i={};for(var o in r)if(r.hasOwnProperty(o))if(r[o].config){var s=r[o].config,u=s[0],a=s[1],l=c["default"](t,null==e[o].val?e[o]:e[o].val,n[o],r[o].val,u,a)[1];i[o]=l}else i[o]=0;return i}e.__esModule=!0,e.interpolateValue=i,e.updateCurrentStyle=o,e.updateCurrentVelocity=s;var u=n(26),c=r(u)},function(t,e){"use strict";function n(){return 0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){for(var r=n(3),i="undefined"==typeof window?{}:window,o=["moz","webkit"],s="AnimationFrame",u=i["request"+s],c=i["cancel"+s]||i["cancelRequest"+s],a=0;a<o.length&&!u;a++)u=i[o[a]+"Request"+s],c=i[o[a]+"Cancel"+s]||i[o[a]+"CancelRequest"+s];if(!u||!c){var l=0,p=0,h=[],f=1e3/60;u=function(t){if(0===h.length){var e=r(),n=Math.max(0,f-(e-l));l=n+e,setTimeout(function(){var t=h.slice(0);h.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(l)}catch(n){setTimeout(function(){throw n},0)}},Math.round(n))}return h.push({handle:++p,callback:t,cancelled:!1}),p},c=function(t){for(var e=0;e<h.length;e++)h[e].handle===t&&(h[e].cancelled=!0)}}t.exports=function(t){return u.call(i,t)},t.exports.cancel=function(){c.apply(i,arguments)}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=p[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(u(r.parts[o],e))}else{for(var s=[],o=0;o<r.parts.length;o++)s.push(u(r.parts[o],e));p[r.id]={id:r.id,refs:1,parts:s}}}}function i(t){for(var e=[],n={},r=0;r<t.length;r++){var i=t[r],o=i[0],s=i[1],u=i[2],c=i[3],a={css:s,media:u,sourceMap:c};n[o]?n[o].parts.push(a):e.push(n[o]={id:o,parts:[a]})}return e}function o(){var t=document.createElement("style"),e=d();return t.type="text/css",e.appendChild(t),t}function s(){var t=document.createElement("link"),e=d();return t.rel="stylesheet",e.appendChild(t),t}function u(t,e){var n,r,i;if(e.singleton){var u=b++;n=v||(v=o()),r=c.bind(null,n,u,!1),i=c.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(),r=l.bind(null,n),i=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=o(),r=a.bind(null,n),i=function(){n.parentNode.removeChild(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}function c(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=m(e,i);else{var o=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function a(t,e){var n=e.css,r=e.media;e.sourceMap;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function l(t,e){var n=e.css,r=(e.media,e.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var p={},h=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},f=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),d=h(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,b=0;t.exports=function(t,e){if("object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},"undefined"==typeof e.singleton&&(e.singleton=f());var n=i(t);return r(n,e),function(t){for(var o=[],s=0;s<n.length;s++){var u=n[s],c=p[u.id];c.refs--,o.push(c)}if(t){var a=i(t);r(a,e)}for(var s=0;s<o.length;s++){var c=o[s];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete p[c.id]}}}};var m=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){var r=n(13);"string"==typeof r&&(r=[[t.id,r,""]]);n(31)(r,{});r.locals&&(t.exports=r.locals)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vcmVhY3QtY2xpbWItc29jaWFsLm1pbi5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgM2ZiZDQyNDBhOTdlNzI4MWQ4YzIiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcIlJlYWN0XCIiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL3ByZXNldHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vfi9wZXJmb3JtYW5jZS1ub3cvbGliL3BlcmZvcm1hbmNlLW5vdy5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL34vbm9kZS1saWJzLWJyb3dzZXIvfi9wcm9jZXNzL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvQXV0aG9yLmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9JbWFnZS5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvTWVzc2FnZS5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvVGlsZS5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvV2FsbC5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvV2FsbENvbnRhaW5lci5qc3giLCJ3ZWJwYWNrOi8vLy4vfi9jbGltYi1zb2NpYWwvZGlzdC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L2NsaW1iLXNvY2lhbC9+L3J4LWxpdGUvcngubGl0ZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3R5bGUvbWFpbi5zY3NzIiwid2VicGFjazovLy8uL34vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4vfi9mZXRjaC1qc29ucC9idWlsZC9mZXRjaC1qc29ucC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW1nL2NsaW1iLnNvY2lhbF9sb2dvLS1zbWFsbC5wbmciLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL2FuaW1hdGlvbkxvb3AuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL2NvbXBvbmVudHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL2RlcHJlY2F0ZWRTcHJpbmdzLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9oYXNSZWFjaGVkU3R5bGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL21lcmdlRGlmZi5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9saWIvbm9WZWxvY2l0eS5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9saWIvcmVhY3QtbW90aW9uLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9yZW9yZGVyS2V5cy5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9saWIvc3ByaW5nLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9zdGVwcGVyLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9zdHJpcFN0eWxlLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi91cGRhdGVUcmVlLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi96ZXJvLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL34vcmFmL2luZGV4LmpzIiwid2VicGFjazovLy8uL34vc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3R5bGUvbWFpbi5zY3NzPzNhZGIiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL21vZHVsZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImV4cG9ydHMiLCJtb2R1bGUiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiX3JlYWN0IiwiX3JlYWN0MiIsIl9jb21wb25lbnRzV2FsbENvbnRhaW5lciIsIl9jb21wb25lbnRzV2FsbENvbnRhaW5lcjIiLCJ3aW5kb3ciLCJDbGltYiIsIiR0YXJnZXRzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaSIsImxlbmd0aCIsIiRpdGVtIiwiY29sbGVjdGlvbklkIiwiZGF0YXNldCIsImxpbWl0IiwicmVuZGVyIiwiY3JlYXRlRWxlbWVudCIsIlJlYWN0Iiwibm9Xb2JibGUiLCJnZW50bGUiLCJ3b2JibHkiLCJzdGlmZiIsInByb2Nlc3MiLCJnZXROYW5vU2Vjb25kcyIsImhydGltZSIsImxvYWRUaW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJociIsIkRhdGUiLCJnZXRUaW1lIiwidGhpcyIsImNsZWFuVXBOZXh0VGljayIsImRyYWluaW5nIiwiY3VycmVudFF1ZXVlIiwicXVldWUiLCJjb25jYXQiLCJxdWV1ZUluZGV4IiwiZHJhaW5RdWV1ZSIsInRpbWVvdXQiLCJzZXRUaW1lb3V0IiwibGVuIiwicnVuIiwiY2xlYXJUaW1lb3V0IiwiSXRlbSIsImZ1biIsImFycmF5Iiwibm9vcCIsIm5leHRUaWNrIiwiYXJncyIsIkFycmF5IiwiYXJndW1lbnRzIiwicHVzaCIsInByb3RvdHlwZSIsImFwcGx5IiwidGl0bGUiLCJicm93c2VyIiwiZW52IiwiYXJndiIsInZlcnNpb24iLCJ2ZXJzaW9ucyIsIm9uIiwiYWRkTGlzdGVuZXIiLCJvbmNlIiwib2ZmIiwicmVtb3ZlTGlzdGVuZXIiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJlbWl0IiwiYmluZGluZyIsIm5hbWUiLCJFcnJvciIsImN3ZCIsImNoZGlyIiwiZGlyIiwidW1hc2siLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2luaGVyaXRzIiwic3ViQ2xhc3MiLCJzdXBlckNsYXNzIiwiY3JlYXRlIiwiY29uc3RydWN0b3IiLCJlbnVtZXJhYmxlIiwid3JpdGFibGUiLCJjb25maWd1cmFibGUiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfZ2V0IiwiX3giLCJfeDIiLCJfeDMiLCJfYWdhaW4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInJlY2VpdmVyIiwiZGVzYyIsInBhcmVudCIsImdldHRlciIsInVuZGVmaW5lZCIsIkZ1bmN0aW9uIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0IiwiZ2V0UHJvdG90eXBlT2YiLCJBdXRob3IiLCJfUmVhY3QkQ29tcG9uZW50IiwiY2xhc3NOYW1lIiwiaHJlZiIsImxpbmsiLCJzcmMiLCJwaWN0dXJlIiwiYWx0IiwidXNlcm5hbWUiLCJDb21wb25lbnQiLCJwcm9wVHlwZXMiLCJJbWFnZSIsImRhdGEtd2lkdGgiLCJ3aWR0aCIsImRhdGEtaGVpZ2h0IiwiaGVpZ2h0IiwiUHJvcFR5cGVzIiwic3RyaW5nIiwiaXNSZXF1aXJlZCIsIm51bWJlciIsIk1lc3NhZ2UiLCJkYW5nZXJvdXNseVNldElubmVySFRNTCIsIl9faHRtbCIsImJvZHkiLCJfSW1hZ2UiLCJfSW1hZ2UyIiwiX01lc3NhZ2UiLCJfTWVzc2FnZTIiLCJfQXV0aG9yIiwiX0F1dGhvcjIiLCJUaWxlIiwiaW1hZ2UiLCJfcHJvcHMkaW1hZ2UiLCJ1cmwiLCJtZXNzYWdlIiwiY2xhc3NTdHJpbmciLCJzb3VyY2VfdHlwZSIsInZpZGVvX3VybCIsImNyZWF0ZUltYWdlIiwiY3JlYXRlTWVzc2FnZSIsImNyZWF0ZUNsYXNzU3RyaW5nIiwiYXV0aG9yIiwic3R5bGUiLCJ0aW1lc3RhbXAiLCJzaGFwZSIsInZpZGVvX3NyYyIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllcyIsImtleXMiLCJpbmRleE9mIiwiaGFzT3duUHJvcGVydHkiLCJfZXh0ZW5kcyIsImFzc2lnbiIsInNvdXJjZSIsIl9UaWxlIiwiX1RpbGUyIiwiX3JlYWN0TW90aW9uIiwiV2FsbCIsIl9Db21wb25lbnQiLCJfdGhpcyIsImNvbmZpZ3MiLCJpdGVtcyIsIm1hcCIsIm9wYWNpdHkiLCJzcHJpbmciLCJtYXJnaW4iLCJpdGVtIiwiaXRlbVZhbHVlcyIsInN0eWxlQ29uZmlnIiwiaXRlbVByb3BzIiwibWFyZ2luLWxlZnQiLCJtYXJnaW4tcmlnaHQiLCJfdGhpczIiLCJUcmFuc2l0aW9uTW90aW9uIiwic3R5bGVzIiwiZ2V0U3R5bGVzIiwiYmluZCIsIndpbGxFbnRlciIsIndpbGxMZWF2ZSIsInZhbHVlcyIsInJlbmRlclRpbGUiLCJfY2xpbWJTb2NpYWwiLCJfY2xpbWJTb2NpYWwyIiwiX1dhbGwiLCJfV2FsbDIiLCJXYWxsQ29udGFpbmVyIiwic3RhdGUiLCJnZXRTdHJlYW0iLCJzdWJzY3JpYmUiLCJtYXhTaXplIiwicGFyc2VJbnQiLCJtYXBwZWRJdGVtcyIsInNwbGljZSIsInNldFN0YXRlIiwiaW5pdCIsImNiIiwib25VcGRhdGUiLCJvbmVPZlR5cGUiLCJfcnhMaXRlIiwiX2ZldGNoSnNvbnAiLCJfZmV0Y2hKc29ucDIiLCJwb2xsUmF0ZSIsInJlcXVlc3RTdHJlYW0iLCJPYnNlcnZhYmxlIiwianVzdCIsInVwZGF0ZVN0cmVhbSIsImludGVydmFsIiwic3RhcnRXaXRoIiwicmVzcG9uc2VTdHJlYW0iLCJjb21iaW5lTGF0ZXN0IiwidGljayIsImZsYXRNYXAiLCJiYXNlVXJsIiwicmVxdWVzdFVybCIsImZyb21Qcm9taXNlIiwidGhlbiIsInJlc3AiLCJqc29uIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18iLCJnbG9iYWwiLCJjaGVja0dsb2JhbCIsImNsb25lQXJyYXkiLCJhcnIiLCJhIiwidHJ5Q2F0Y2hlckdlbiIsInRyeUNhdGNoVGFyZ2V0IiwiZSIsImVycm9yT2JqIiwidGhyb3dlciIsIm1ha2VTdGFja1RyYWNlTG9uZyIsImVycm9yIiwib2JzZXJ2YWJsZSIsImhhc1N0YWNrcyIsInN0YWNrIiwiU1RBQ0tfSlVNUF9TRVBBUkFUT1IiLCJzdGFja3MiLCJvIiwidW5zaGlmdCIsImNvbmNhdGVkU3RhY2tzIiwiam9pbiIsImZpbHRlclN0YWNrU3RyaW5nIiwic3RhY2tTdHJpbmciLCJsaW5lcyIsInNwbGl0IiwiZGVzaXJlZExpbmVzIiwibGluZSIsImlzSW50ZXJuYWxGcmFtZSIsImlzTm9kZUZyYW1lIiwic3RhY2tMaW5lIiwiZmlsZU5hbWVBbmRMaW5lTnVtYmVyIiwiZ2V0RmlsZU5hbWVBbmRMaW5lTnVtYmVyIiwiZmlsZU5hbWUiLCJsaW5lTnVtYmVyIiwickZpbGVOYW1lIiwiclN0YXJ0aW5nTGluZSIsInJFbmRpbmdMaW5lIiwiY2FwdHVyZUxpbmUiLCJmaXJzdExpbmUiLCJhdHRlbXB0MSIsImV4ZWMiLCJOdW1iZXIiLCJhdHRlbXB0MiIsImF0dGVtcHQzIiwia2V5c0luIiwicmVzdWx0IiwiaXNPYmplY3QiLCJzdXBwb3J0Iiwibm9uRW51bUFyZ3MiLCJpc0FyZ3VtZW50cyIsInNsaWNlIiwic2tpcFByb3RvIiwiZW51bVByb3RvdHlwZXMiLCJza2lwRXJyb3JQcm9wcyIsImVudW1FcnJvclByb3BzIiwiZXJyb3JQcm90byIsIm5vbkVudW1TaGFkb3dzIiwib2JqZWN0UHJvdG8iLCJjdG9yIiwiaW5kZXgiLCJkb250RW51bXNMZW5ndGgiLCJzdHJpbmdQcm90byIsInN0cmluZ0NsYXNzIiwiZXJyb3JDbGFzcyIsInRvU3RyaW5nIiwibm9uRW51bSIsIm5vbkVudW1Qcm9wcyIsImRvbnRFbnVtcyIsImludGVybmFsRm9yIiwiY2FsbGJhY2siLCJrZXlzRnVuYyIsImludGVybmFsRm9ySW4iLCJpc05vZGUiLCJkZWVwRXF1YWxzIiwiYiIsInN0YWNrQSIsInN0YWNrQiIsInR5cGUiLCJvdGhlclR5cGUiLCJvdGhlckNsYXNzIiwiYXJnc0NsYXNzIiwib2JqZWN0Q2xhc3MiLCJib29sQ2xhc3MiLCJkYXRlQ2xhc3MiLCJudW1iZXJDbGFzcyIsInJlZ2V4cENsYXNzIiwiU3RyaW5nIiwiaXNBcnIiLCJhcnJheUNsYXNzIiwibm9kZUNsYXNzIiwiY3RvckEiLCJhcmdzT2JqZWN0IiwiY3RvckIiLCJpc0Z1bmN0aW9uIiwic2l6ZSIsInBvcCIsImFycmF5SW5pdGlhbGl6ZSIsImNvdW50IiwiZmFjdG9yeSIsIkluZGV4ZWRJdGVtIiwiSXNEaXNwb3NlZERpc3Bvc2FibGUiLCJfcyIsImlzRGlzcG9zZWQiLCJTdHJpbmdJdGVyYWJsZSIsInMiLCJTdHJpbmdJdGVyYXRvciIsIl9sIiwiX2kiLCJBcnJheUl0ZXJhYmxlIiwiX2EiLCJBcnJheUl0ZXJhdG9yIiwidG9MZW5ndGgiLCJudW1iZXJJc0Zpbml0ZSIsInJvb3QiLCJpc0Zpbml0ZSIsImdldEl0ZXJhYmxlIiwiaXQiLCIkaXRlcmF0b3IkIiwic2lnbiIsImlzTmFOIiwiTWF0aCIsImZsb29yIiwiYWJzIiwibWF4U2FmZUludGVnZXIiLCJGcm9tQXJyYXlTaW5rIiwib2JzZXJ2ZXIiLCJsb29wUmVjdXJzaXZlIiwicmVjdXJzZSIsIm9uTmV4dCIsIm9uQ29tcGxldGVkIiwib2JzZXJ2YWJsZU9mIiwic2NoZWR1bGVyIiwiaXNTY2hlZHVsZXIiLCJjdXJyZW50VGhyZWFkU2NoZWR1bGVyIiwiRnJvbUFycmF5T2JzZXJ2YWJsZSIsIlBhaXJzU2luayIsIlJlcGVhdFNpbmsiLCJmYWxzZUZhY3RvcnkiLCJhcmd1bWVudHNUb0FycmF5IiwiZW1wdHlBcnJheUZhY3RvcnkiLCJhc09ic2VydmFibGUiLCJwbHVja2VyIiwieCIsImN1cnJlbnRQcm9wIiwiY3JlYXRlQ2JPYnNlcnZhYmxlIiwiZm4iLCJjdHgiLCJzZWxlY3RvciIsIkFzeW5jU3ViamVjdCIsImNyZWF0ZUNiSGFuZGxlciIsInJlc3VsdHMiLCJ0cnlDYXRjaCIsIm9uRXJyb3IiLCJjcmVhdGVOb2RlT2JzZXJ2YWJsZSIsImNyZWF0ZU5vZGVIYW5kbGVyIiwiZXJyIiwiaXNOb2RlTGlzdCIsImVsIiwiU3RhdGljTm9kZUxpc3QiLCJOb2RlTGlzdCIsIkxpc3RlbkRpc3Bvc2FibGUiLCJuIiwiX2UiLCJfbiIsIl9mbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJjcmVhdGVFdmVudExpc3RlbmVyIiwiZXZlbnROYW1lIiwiaGFuZGxlciIsImRpc3Bvc2FibGVzIiwiQ29tcG9zaXRlRGlzcG9zYWJsZSIsImVsZW1Ub1N0cmluZyIsImFkZCIsIl9vYnNlcnZhYmxlVGltZXIiLCJkdWVUaW1lIiwiVGltZXJPYnNlcnZhYmxlIiwib2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZCIsInBlcmlvZCIsIkFub255bW91c09ic2VydmFibGUiLCJkIiwibm9ybWFsaXplVGltZSIsInNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlIiwic2VsZiIsIm9ic2VydmFibGVUaW1lclRpbWVTcGFuQW5kUGVyaW9kIiwic2NoZWR1bGVQZXJpb2RpYyIsIm9ic2VydmFibGVEZWZlciIsIm9ic2VydmFibGVEZWxheVJlbGF0aXZlIiwic3Vic2NyaXB0aW9uIiwiYWN0aXZlIiwiY2FuY2VsYWJsZSIsIlNlcmlhbERpc3Bvc2FibGUiLCJleGNlcHRpb24iLCJxIiwicnVubmluZyIsIm1hdGVyaWFsaXplIiwibm90aWZpY2F0aW9uIiwic2hvdWxkUnVuIiwia2luZCIsIlNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlIiwic2V0RGlzcG9zYWJsZSIsIl8iLCJyZWN1cnNlRHVlVGltZSIsInNob3VsZFJlY3Vyc2UiLCJzaGlmdCIsImFjY2VwdCIsIm1heCIsIkJpbmFyeURpc3Bvc2FibGUiLCJvYnNlcnZhYmxlRGVsYXlBYnNvbHV0ZSIsImRlbGF5V2l0aFNlbGVjdG9yIiwic3Vic2NyaXB0aW9uRGVsYXkiLCJkZWxheUR1cmF0aW9uU2VsZWN0b3IiLCJzdWJEZWxheSIsInN0YXJ0IiwiZGVsYXkiLCJkZWxheXMiLCJyZW1vdmUiLCJkb25lIiwiYXRFbmQiLCJkaXNwb3NlIiwiZGVib3VuY2VXaXRoU2VsZWN0b3IiLCJkdXJhdGlvblNlbGVjdG9yIiwiaGFzVmFsdWUiLCJ0aHJvdHRsZSIsImlzUHJvbWlzZSIsIm9ic2VydmFibGVGcm9tUHJvbWlzZSIsImN1cnJlbnRpZCIsInNhbXBsZU9ic2VydmFibGUiLCJzYW1wbGVyIiwic2FtcGxlU3Vic2NyaWJlIiwic291cmNlU3Vic2NyaXB0aW9uIiwibmV3VmFsdWUiLCJ0aW1lb3V0V2l0aFNlbGVjdG9yIiwiZmlyc3RUaW1lb3V0IiwidGltZW91dER1cmF0aW9uU2VsZWN0b3IiLCJvdGhlciIsIm9ic2VydmFibGVOZXZlciIsIm9ic2VydmFibGVUaHJvdyIsIlRpbWVvdXRFcnJvciIsInNldFRpbWVyIiwidGltZXJXaW5zIiwic3dpdGNoZWQiLCJteUlkIiwidGltZXIiLCJvV2lucyIsInJlcyIsIm9yaWdpbmFsIiwiZGVmYXVsdFNjaGVkdWxlciIsImNyZWF0ZVRpbWVyIiwic2NoZWR1bGVGdXR1cmUiLCJjb21iaW5lTGF0ZXN0U291cmNlIiwic3ViamVjdCIsInJlc3VsdFNlbGVjdG9yIiwibmV4dCIsImhhc1ZhbHVlQWxsIiwiZXZlcnkiLCJpZGVudGl0eSIsImlzRG9uZSIsInRyYW5zZm9ybUZvck9ic2VydmVyIiwiQEB0cmFuc2R1Y2VyL2luaXQiLCJAQHRyYW5zZHVjZXIvc3RlcCIsIm9icyIsImlucHV0IiwiQEB0cmFuc2R1Y2VyL3Jlc3VsdCIsIm9iamVjdFR5cGVzIiwiZnVuY3Rpb24iLCJmcmVlRXhwb3J0cyIsIm5vZGVUeXBlIiwiZnJlZU1vZHVsZSIsImZyZWVHbG9iYWwiLCJmcmVlU2VsZiIsImZyZWVXaW5kb3ciLCJtb2R1bGVFeHBvcnRzIiwidGhpc0dsb2JhbCIsIlJ4IiwiaW50ZXJuYWxzIiwiY29uZmlnIiwiUHJvbWlzZSIsImhlbHBlcnMiLCJkZWZhdWx0Tm93IiwiZGVmYXVsdENvbXBhcmVyIiwieSIsImlzRXF1YWwiLCJkZWZhdWx0U3ViQ29tcGFyZXIiLCJkZWZhdWx0RXJyb3IiLCJkZWZhdWx0S2V5U2VyaWFsaXplciIsImlzRm4iLCJsb25nU3RhY2tTdXBwb3J0IiwiRW1wdHlFcnJvciIsIk9iamVjdERpc3Bvc2VkRXJyb3IiLCJBcmd1bWVudE91dE9mUmFuZ2VFcnJvciIsIk5vdFN1cHBvcnRlZEVycm9yIiwiTm90SW1wbGVtZW50ZWRFcnJvciIsIm5vdEltcGxlbWVudGVkIiwibm90U3VwcG9ydGVkIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJTZXQiLCJkb25lRW51bWVyYXRvciIsImlzSXRlcmFibGUiLCJpc0FycmF5TGlrZSIsInN1cHBvcnROb2RlQ2xhc3MiLCJiaW5kQ2FsbGJhY2siLCJmdW5jIiwidGhpc0FyZyIsImFyZ0NvdW50IiwiYXJnIiwiY29sbGVjdGlvbiIsImZ1bmNDbGFzcyIsInN1cHBvcnRzQXJnc0NsYXNzIiwicHJvcGVydHlJc0VudW1lcmFibGUiLCJ0b0xvY2FsZVN0cmluZyIsInZhbHVlT2YiLCJ0ZXN0IiwiaW5oZXJpdHMiLCJjaGlsZCIsIl9fIiwiYWRkUHJvcGVydGllcyIsInNvdXJjZXMiLCJpZHgiLCJsbiIsInByb3AiLCJhZGRSZWYiLCJ4cyIsInIiLCJnZXREaXNwb3NhYmxlIiwiaXNBcnJheSIsIkNvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUiLCJzaG91bGREaXNwb3NlIiwiY3VycmVudERpc3Bvc2FibGVzIiwiRGlzcG9zYWJsZSIsImFjdGlvbiIsImRpc3Bvc2FibGVDcmVhdGUiLCJkaXNwb3NhYmxlRW1wdHkiLCJlbXB0eSIsImlzRGlzcG9zYWJsZSIsImNoZWNrRGlzcG9zZWQiLCJkaXNwb3NhYmxlIiwiZGlzcG9zYWJsZUZpeHVwIiwiX2ZpeHVwIiwiY3VycmVudCIsIm9sZCIsImZpcnN0Iiwic2Vjb25kIiwiX2ZpcnN0IiwiX3NlY29uZCIsIm9sZDEiLCJvbGQyIiwiTkFyeURpc3Bvc2FibGUiLCJfZGlzcG9zYWJsZXMiLCJTY2hlZHVsZWRJdGVtIiwiUmVmQ291bnREaXNwb3NhYmxlIiwiSW5uZXJEaXNwb3NhYmxlIiwiaXNJbm5lckRpc3Bvc2VkIiwidW5kZXJseWluZ0Rpc3Bvc2FibGUiLCJpc1ByaW1hcnlEaXNwb3NlZCIsImNvbXBhcmVyIiwiaW52b2tlIiwiaW52b2tlQ29yZSIsImNvbXBhcmVUbyIsImlzQ2FuY2VsbGVkIiwiU2NoZWR1bGVyIiwic2NoZWR1bGVyUHJvdG8iLCJzY2hlZHVsZSIsImR0Iiwibm9ybWFsaXplIiwiX3NjaGVkdWxlRnV0dXJlIiwidGltZVNwYW4iLCJpbnZva2VSZWNJbW1lZGlhdGUiLCJwYWlyIiwiaW5uZXJBY3Rpb24iLCJzdGF0ZTIiLCJzY2hlZHVsZVdvcmsiLCJzdGF0ZTMiLCJpc0FkZGVkIiwiZ3JvdXAiLCJpbnZva2VSZWNEYXRlIiwiZHVlVGltZTEiLCJzY2hlZHVsZVJlY3Vyc2l2ZSIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInNjaGVkdWxlTWV0aG9kIiwiY2xlYXJNZXRob2QiLCJJbW1lZGlhdGVTY2hlZHVsZXIiLCJfX3N1cGVyX18iLCJpbW1lZGlhdGVTY2hlZHVsZXIiLCJpbW1lZGlhdGUiLCJDdXJyZW50VGhyZWFkU2NoZWR1bGVyIiwicnVuVHJhbXBvbGluZSIsImRlcXVldWUiLCJzaSIsImVucXVldWUiLCJQcmlvcml0eVF1ZXVlIiwic2NoZWR1bGVSZXF1aXJlZCIsImN1cnJlbnRUaHJlYWQiLCJsb2NhbFRpbWVyIiwiU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZSIsImNyZWF0ZVRpY2siLCJjb21tYW5kIiwiX3BlcmlvZCIsIl9hY3Rpb24iLCJfc3RhdGUiLCJfY2FuY2VsIiwiX3NjaGVkdWxlciIsImxvY2FsU2V0VGltZW91dCIsImxvY2FsQ2xlYXJUaW1lb3V0IiwiV1NjcmlwdCIsInRpbWUiLCJTbGVlcCIsInJ1blRhc2siLCJoYW5kbGUiLCJjdXJyZW50bHlSdW5uaW5nIiwidGFzayIsInRhc2tzQnlIYW5kbGUiLCJwb3N0TWVzc2FnZVN1cHBvcnRlZCIsInBvc3RNZXNzYWdlIiwiaW1wb3J0U2NyaXB0cyIsImlzQXN5bmMiLCJvbGRIYW5kbGVyIiwib25tZXNzYWdlIiwibmV4dEhhbmRsZSIsInJlTmF0aXZlIiwiUmVnRXhwIiwicmVwbGFjZSIsInNldEltbWVkaWF0ZSIsIk1TR19QUkVGSVgiLCJyYW5kb20iLCJvbkdsb2JhbFBvc3RNZXNzYWdlIiwiZXZlbnQiLCJkYXRhIiwic3Vic3RyaW5nIiwiY3VycmVudElkIiwiTWVzc2FnZUNoYW5uZWwiLCJjaGFubmVsIiwicG9ydDEiLCJwb3J0MiIsInNjcmlwdEVsZW1lbnQiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJkb2N1bWVudEVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsIkRlZmF1bHRTY2hlZHVsZXIiLCJzY2hlZHVsZUFjdGlvbiIsIkNsZWFyRGlzcG9zYWJsZSIsIm1ldGhvZCIsIl9pZCIsIl9tZXRob2QiLCJhc3luYyIsImNhcGFjaXR5IiwicHJpb3JpdHlQcm90byIsImlzSGlnaGVyUHJpb3JpdHkiLCJsZWZ0IiwicmlnaHQiLCJwZXJjb2xhdGUiLCJ0ZW1wIiwiaGVhcGlmeSIsInBlZWsiLCJyZW1vdmVBdCIsIm9ic2VydmFibGVQcm90byIsIk5vdGlmaWNhdGlvbiIsIl9hY2NlcHQiLCJfYWNjZXB0T2JzZXJ2YWJsZSIsIm9ic2VydmVyT3JPbk5leHQiLCJ0b09ic2VydmFibGUiLCJPbk5leHROb3RpZmljYXRpb24iLCJPbkVycm9yTm90aWZpY2F0aW9uIiwiT25Db21wbGV0ZWROb3RpZmljYXRpb24iLCJub3RpZmljYXRpb25DcmVhdGVPbk5leHQiLCJjcmVhdGVPbk5leHQiLCJub3RpZmljYXRpb25DcmVhdGVPbkVycm9yIiwiY3JlYXRlT25FcnJvciIsIm5vdGlmaWNhdGlvbkNyZWF0ZU9uQ29tcGxldGVkIiwiY3JlYXRlT25Db21wbGV0ZWQiLCJPYnNlcnZlciIsIm9ic2VydmVyQ3JlYXRlIiwiQW5vbnltb3VzT2JzZXJ2ZXIiLCJBYnN0cmFjdE9ic2VydmVyIiwiaXNTdG9wcGVkIiwiY29tcGxldGVkIiwiZmFpbCIsIl9vbk5leHQiLCJfb25FcnJvciIsIl9vbkNvbXBsZXRlZCIsIm1ha2VTdWJzY3JpYmUiLCJvbGRPbkVycm9yIiwib2xkU3Vic2NyaWJlIiwiX3N1YnNjcmliZSIsImlzT2JzZXJ2YWJsZSIsImZvckVhY2giLCJvT3JPbk5leHQiLCJzdWJzY3JpYmVPbk5leHQiLCJzdWJzY3JpYmVPbkVycm9yIiwic3Vic2NyaWJlT25Db21wbGV0ZWQiLCJTY2hlZHVsZWRPYnNlcnZlciIsImlzQWNxdWlyZWQiLCJoYXNGYXVsdGVkIiwiZW5zdXJlQWN0aXZlIiwiaXNPd25lciIsIndvcmsiLCJPYnNlcnZhYmxlQmFzZSIsImZpeFN1YnNjcmliZXIiLCJzdWJzY3JpYmVyIiwiYWRvIiwic3ViIiwic3Vic2NyaWJlQ29yZSIsIkF1dG9EZXRhY2hPYnNlcnZlciIsIkZsYXRNYXBPYnNlcnZhYmxlIiwiSW5uZXJPYnNlcnZlciIsIl93cmFwUmVzdWx0IiwiaTIiLCJmcm9tIiwiRW51bWVyYWJsZSIsIkNvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlIiwiX28iLCJjdXJyZW50SXRlbSIsImN1cnJlbnRWYWx1ZSIsIkNhdGNoRXJyb3JPYnNlcnZhYmxlIiwiX3JlY3Vyc2UiLCJsYXN0RXhjZXB0aW9uIiwiY2F0Y2hFcnJvciIsImNhdGNoRXJyb3JXaGVuIiwibm90aWZpY2F0aW9uSGFuZGxlciIsImV4Y2VwdGlvbnMiLCJTdWJqZWN0Iiwibm90aWZpZXIiLCJoYW5kbGVkIiwibm90aWZpY2F0aW9uRGlzcG9zYWJsZSIsIm91dGVyIiwiaW5uZXIiLCJleG4iLCJleCIsIlJlcGVhdEVudW1lcmFibGUiLCJ2IiwiUmVwZWF0RW51bWVyYXRvciIsImwiLCJlbnVtZXJhYmxlUmVwZWF0IiwicmVwZWF0IiwicmVwZWF0Q291bnQiLCJPZkVudW1lcmFibGUiLCJPZkVudW1lcmF0b3IiLCJlbnVtZXJhYmxlT2YiLCJvZiIsIlRvQXJyYXlPYnNlcnZhYmxlIiwidG9BcnJheSIsIkRlZmVyIiwiX2YiLCJkZWZlciIsIm9ic2VydmFibGVGYWN0b3J5IiwiRW1wdHlPYnNlcnZhYmxlIiwiRW1wdHlTaW5rIiwic2NoZWR1bGVJdGVtIiwic2luayIsIkVNUFRZX09CU0VSVkFCTEUiLCJvYnNlcnZhYmxlRW1wdHkiLCJGcm9tT2JzZXJ2YWJsZSIsIml0ZXJhYmxlIiwibWFwcGVyIiwiRnJvbVNpbmsiLCJsaXN0IiwicG93IiwiY2hhckF0Iiwib2JzZXJ2YWJsZUZyb20iLCJtYXBGbiIsIm9ic2VydmFibGVGcm9tQXJyYXkiLCJmcm9tQXJyYXkiLCJOZXZlck9ic2VydmFibGUiLCJORVZFUl9PQlNFUlZBQkxFIiwibmV2ZXIiLCJvZldpdGhTY2hlZHVsZXIiLCJQYWlyc09ic2VydmFibGUiLCJwYWlycyIsIlJhbmdlT2JzZXJ2YWJsZSIsInJhbmdlQ291bnQiLCJSYW5nZVNpbmsiLCJyYW5nZSIsIlJlcGVhdE9ic2VydmFibGUiLCJKdXN0T2JzZXJ2YWJsZSIsIkp1c3RTaW5rIiwiVGhyb3dPYnNlcnZhYmxlIiwiVGhyb3dTaW5rIiwiQ2F0Y2hPYnNlcnZhYmxlIiwiZDEiLCJDYXRjaE9ic2VydmVyIiwiaGFuZGxlck9yU2Vjb25kIiwib2JzZXJ2YWJsZUNhdGNoIiwiQ29tYmluZUxhdGVzdE9ic2VydmFibGUiLCJwYXJhbXMiLCJfcGFyYW1zIiwiX2NiIiwic3Vic2NyaXB0aW9ucyIsInNhZCIsIkNvbWJpbmVMYXRlc3RPYnNlcnZlciIsIm5vdFRoZVNhbWUiLCJqIiwiZmlsdGVyIiwib2JzZXJ2YWJsZUNvbmNhdCIsIkNvbmNhdE9ic2VydmFibGUiLCJDb25jYXRTaW5rIiwiY29uY2F0QWxsIiwibWVyZ2UiLCJNZXJnZU9ic2VydmFibGUiLCJtYXhDb25jdXJyZW50IiwiZyIsIk1lcmdlT2JzZXJ2ZXIiLCJhY3RpdmVDb3VudCIsImhhbmRsZVN1YnNjcmliZSIsImlubmVyU291cmNlIiwibWF4Q29uY3VycmVudE9yT3RoZXIiLCJvYnNlcnZhYmxlTWVyZ2UiLCJtZXJnZUFsbCIsIkNvbXBvc2l0ZUVycm9yIiwiZXJyb3JzIiwiaW5uZXJFcnJvcnMiLCJNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlIiwiTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIiLCJfZ3JvdXAiLCJzZXRDb21wbGV0aW9uIiwiX2lubmVyIiwibWVyZ2VEZWxheUVycm9yIiwiTWVyZ2VBbGxPYnNlcnZhYmxlIiwiTWVyZ2VBbGxPYnNlcnZlciIsIlNraXBVbnRpbE9ic2VydmFibGUiLCJfb3BlbiIsImxlZnRTdWJzY3JpcHRpb24iLCJTa2lwVW50aWxTb3VyY2VPYnNlcnZlciIsInJpZ2h0U3Vic2NyaXB0aW9uIiwiU2tpcFVudGlsT3RoZXJPYnNlcnZlciIsIl9wIiwiX3IiLCJza2lwVW50aWwiLCJTd2l0Y2hPYnNlcnZhYmxlIiwiU3dpdGNoT2JzZXJ2ZXIiLCJzdG9wcGVkIiwibGF0ZXN0IiwiaGFzTGF0ZXN0Iiwic3dpdGNoTGF0ZXN0IiwiVGFrZVVudGlsT2JzZXJ2YWJsZSIsIlRha2VVbnRpbE9ic2VydmVyIiwidGFrZVVudGlsIiwiV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlIiwiX3NzIiwiV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyIiwiV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlciIsImFsbFZhbHVlcyIsIndpdGhMYXRlc3RGcm9tIiwiWmlwT2JzZXJ2YWJsZSIsIlppcE9ic2VydmVyIiwiX3EiLCJfZCIsIm5vdEVtcHR5Iiwic2hpZnRFYWNoIiwicXVldWVkVmFsdWVzIiwiemlwIiwiemlwSXRlcmFibGUiLCJxdWV1ZXMiLCJEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZSIsIkRlbWF0ZXJpYWxpemVPYnNlcnZlciIsImRlbWF0ZXJpYWxpemUiLCJEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUiLCJrZXlGbiIsIkRpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIiLCJoYXNDdXJyZW50S2V5IiwiY3VycmVudEtleSIsImNvbXBhcmVyRXF1YWxzIiwiZGlzdGluY3RVbnRpbENoYW5nZWQiLCJUYXBPYnNlcnZhYmxlIiwiX29OIiwiX29FIiwiX29DIiwidCIsInRhcCIsImRvQWN0aW9uIiwiZG9Pbk5leHQiLCJ0YXBPbk5leHQiLCJkb09uRXJyb3IiLCJ0YXBPbkVycm9yIiwiZG9PbkNvbXBsZXRlZCIsInRhcE9uQ29tcGxldGVkIiwiSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlIiwiaWdub3JlRWxlbWVudHMiLCJNYXRlcmlhbGl6ZU9ic2VydmFibGUiLCJNYXRlcmlhbGl6ZU9ic2VydmVyIiwicmV0cnkiLCJyZXRyeUNvdW50IiwicmV0cnlXaGVuIiwiU2Nhbk9ic2VydmFibGUiLCJhY2N1bXVsYXRvciIsImhhc1NlZWQiLCJzZWVkIiwiU2Nhbk9ic2VydmVyIiwiX2hzIiwiX2hhIiwiX2h2Iiwic2NhbiIsIlNraXBMYXN0T2JzZXJ2YWJsZSIsIl9jIiwiU2tpcExhc3RPYnNlcnZlciIsInNraXBMYXN0IiwiVGFrZUxhc3RPYnNlcnZlciIsInRha2VMYXN0IiwiZmxhdE1hcENvbmNhdCIsImNvbmNhdE1hcCIsIk1hcE9ic2VydmFibGUiLCJpbm5lck1hcCIsImludGVybmFsTWFwIiwic2VsZWN0Iiwic2VsZWN0b3JGbiIsInBsdWNrIiwic2VsZWN0TWFueSIsImZsYXRNYXBMYXRlc3QiLCJTa2lwT2JzZXJ2YWJsZSIsInNraXBDb3VudCIsInNraXAiLCJTa2lwV2hpbGVPYnNlcnZhYmxlIiwiU2tpcFdoaWxlT2JzZXJ2ZXIiLCJza2lwV2hpbGUiLCJwcmVkaWNhdGUiLCJUYWtlT2JzZXJ2YWJsZSIsInRha2VDb3VudCIsInRha2UiLCJUYWtlV2hpbGVPYnNlcnZhYmxlIiwiVGFrZVdoaWxlT2JzZXJ2ZXIiLCJ0YWtlV2hpbGUiLCJGaWx0ZXJPYnNlcnZhYmxlIiwiaW5uZXJQcmVkaWNhdGUiLCJpbnRlcm5hbEZpbHRlciIsInNob3VsZFlpZWxkIiwid2hlcmUiLCJmcm9tQ2FsbGJhY2siLCJmcm9tTm9kZUNhbGxiYWNrIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInVzZU5hdGl2ZUV2ZW50cyIsIkV2ZW50T2JzZXJ2YWJsZSIsIl9lbCIsImNyZWF0ZUhhbmRsZXIiLCJmcm9tRXZlbnQiLCJlbGVtZW50IiwiZnJvbUV2ZW50UGF0dGVybiIsImgiLCJwdWJsaXNoIiwicmVmQ291bnQiLCJFdmVudFBhdHRlcm5PYnNlcnZhYmxlIiwiZGVsIiwiX2FkZCIsIl9kZWwiLCJFdmVudFBhdHRlcm5EaXNwb3NhYmxlIiwicmV0IiwiX3JldCIsInJldHVyblZhbHVlIiwiYWRkSGFuZGxlciIsInJlbW92ZUhhbmRsZXIiLCJGcm9tUHJvbWlzZU9ic2VydmFibGUiLCJzY2hlZHVsZU5leHQiLCJzY2hlZHVsZUVycm9yIiwicHJvbWlzZSIsInRvUHJvbWlzZSIsInByb21pc2VDdG9yIiwicmVzb2x2ZSIsInJlamVjdCIsInN0YXJ0QXN5bmMiLCJmdW5jdGlvbkFzeW5jIiwiTXVsdGljYXN0T2JzZXJ2YWJsZSIsImZuMSIsImZuMiIsIl9mbjEiLCJfZm4yIiwiY29ubmVjdGFibGUiLCJtdWx0aWNhc3QiLCJjb25uZWN0Iiwic3ViamVjdE9yU3ViamVjdFNlbGVjdG9yIiwiQ29ubmVjdGFibGVPYnNlcnZhYmxlIiwic2hhcmUiLCJwdWJsaXNoTGFzdCIsInB1Ymxpc2hWYWx1ZSIsImluaXRpYWxWYWx1ZU9yU2VsZWN0b3IiLCJpbml0aWFsVmFsdWUiLCJCZWhhdmlvclN1YmplY3QiLCJzaGFyZVZhbHVlIiwicmVwbGF5IiwiYnVmZmVyU2l6ZSIsIndpbmRvd1NpemUiLCJSZXBsYXlTdWJqZWN0Iiwic2hhcmVSZXBsYXkiLCJSZWZDb3VudE9ic2VydmFibGUiLCJfY291bnQiLCJfY29ubmVjdGFibGVTdWJzY3JpcHRpb24iLCJzaG91bGRDb25uZWN0IiwiX2hhc1N1YnNjcmlwdGlvbiIsIl9zdWJzY3JpcHRpb24iLCJfc291cmNlT2JzZXJ2YWJsZSIsIl9zdWJqZWN0IiwiQ29ubmVjdERpc3Bvc2FibGUiLCJfZHQiLCJvYnNlcnZhYmxlaW50ZXJ2YWwiLCJwZXJpb2RPclNjaGVkdWxlciIsImZpcnN0QXJnIiwiRGVib3VuY2VPYnNlcnZhYmxlIiwiRGVib3VuY2VPYnNlcnZlciIsIl92IiwiZGVib3VuY2UiLCJUaW1lc3RhbXBPYnNlcnZhYmxlIiwiVGltZXN0YW1wT2JzZXJ2ZXIiLCJzYW1wbGUiLCJ0aHJvdHRsZUxhdGVzdCIsImludGVydmFsT3JTYW1wbGVyIiwid2luZG93RHVyYXRpb24iLCJkdXJhdGlvbiIsIlJhbmdlRXJyb3IiLCJsYXN0T25OZXh0IiwiUGF1c2FibGVPYnNlcnZhYmxlIiwicGF1c2VyIiwiY29udHJvbGxlciIsImNvbm4iLCJjb25uZWN0aW9uIiwicGF1c2FibGUiLCJwYXVzZSIsInJlc3VtZSIsIlBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlIiwicHJldmlvdXNTaG91bGRGaXJlIiwic2hvdWxkRmlyZSIsInBhdXNhYmxlQnVmZmVyZWQiLCJDb250cm9sbGVkT2JzZXJ2YWJsZSIsImVuYWJsZVF1ZXVlIiwiQ29udHJvbGxlZFN1YmplY3QiLCJyZXF1ZXN0IiwibnVtYmVyT2ZJdGVtcyIsInJlcXVlc3RlZENvdW50IiwicmVxdWVzdGVkRGlzcG9zYWJsZSIsImhhc0ZhaWxlZCIsImhhc0NvbXBsZXRlZCIsImRpc3Bvc2VDdXJyZW50UmVxdWVzdCIsIl9wcm9jZXNzUmVxdWVzdCIsInJlbWFpbmluZyIsImNvbnRyb2xsZWQiLCJwaXBlIiwiZGVzdCIsIm9uRHJhaW4iLCJ3cml0ZSIsIl9pc1N0ZGlvIiwiZW5kIiwiVHJhbnNkdWNlT2JzZXJ2ZXIiLCJ4Zm9ybSIsIl94Zm9ybSIsInRyYW5zZHVjZSIsInRyYW5zZHVjZXIiLCJfX3N1YnNjcmliZSIsIkF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZSIsIklubmVyU3Vic2NyaXB0aW9uIiwib2JzZXJ2ZXJzIiwiaGFzRXJyb3IiLCJoYXNPYnNlcnZlcnMiLCJvcyIsIkFub255bW91c1N1YmplY3QiLCJnZXRWYWx1ZSIsImNyZWF0ZVJlbW92YWJsZURpc3Bvc2FibGUiLCJzbyIsIl90cmltIiwiUGF1c2VyIiwibWVkaWFRdWVyeSIsImFscmVhZHlJbXBvcnRlZE1vZHVsZXMiLCJfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18iLCJfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fIiwiZ2VuZXJhdGVDYWxsYmFja0Z1bmN0aW9uIiwiY2VpbCIsImNsZWFyRnVuY3Rpb24iLCJmdW5jdGlvbk5hbWUiLCJyZW1vdmVTY3JpcHQiLCJzY3JpcHRJZCIsInNjcmlwdCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJkZWZhdWx0T3B0aW9ucyIsImpzb25wQ2FsbGJhY2siLCJmZXRjaEpzb25wIiwib3B0aW9ucyIsInRpbWVvdXRJZCIsImNhbGxiYWNrRnVuY3Rpb24iLCJyZXNwb25zZSIsIm9rIiwianNvbnBTY3JpcHQiLCJzZXRBdHRyaWJ1dGUiLCJjb25maWdBbmltYXRpb24iLCJsb29wIiwiY3VycmVudFRpbWUiLCJmcmFtZVRpbWUiLCJwcmV2VGltZSIsImFjY3VtdWxhdGVkVGltZSIsInRpbWVTY2FsZSIsInRpbWVTdGVwIiwibWF4U3RlcHMiLCJmcmFtZU51bWJlciIsImFuaW1SdW5uaW5nIiwiX2FuaW1SdW5uaW5nJGkiLCJhbmltYXRpb25TdGVwIiwicHJldlByZXZTdGF0ZSIsInByZXZTdGF0ZSIsInByZXZOZXh0U3RhdGUiLCJuZXh0U3RhdGUiLCJfcmVmIiwiYWxwaGEiLCJfYW5pbVJ1bm5pbmckaTIiLCJhbmltYXRpb25SZW5kZXIiLCJfcmVmMiIsInJhZiIsIl9jb25maWckdGltZVN0ZXAiLCJfY29uZmlnJHRpbWVTY2FsZSIsIl9jb25maWckbWF4U3RlcHMiLCJfY29uZmlnJHJhZiIsIl9yYWYyIiwiX2NvbmZpZyRub3ciLCJfcGVyZm9ybWFuY2VOb3cyIiwidmFsIiwic3RvcCIsIm5ld0FuaW0iLCJfcGVyZm9ybWFuY2VOb3ciLCJfcmFmIiwibWFwT2JqZWN0IiwiZiIsImV2ZXJ5T2JqIiwiY29tcG9uZW50cyIsIk1vdGlvbiIsImNyZWF0ZUNsYXNzIiwiZGlzcGxheU5hbWUiLCJkZWZhdWx0VmFsdWUiLCJwcm9wTmFtZSIsImVuZFZhbHVlIiwiZGVmYXVsdFN0eWxlIiwiY2hpbGRyZW4iLCJnZXRJbml0aWFsU3RhdGUiLCJfcHJvcHMiLCJjdXJyZW50U3R5bGUiLCJjdXJyZW50VmVsb2NpdHkiLCJfemVybzIiLCJjb21wb25lbnREaWRNb3VudCIsInN0YXJ0QW5pbWF0aW5nIiwiY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyIsInRpbWVzdGVwIiwibmV3Q3VycmVudFN0eWxlIiwiX3VwZGF0ZVRyZWUiLCJ1cGRhdGVDdXJyZW50U3R5bGUiLCJuZXdDdXJyZW50VmVsb2NpdHkiLCJ1cGRhdGVDdXJyZW50VmVsb2NpdHkiLCJfbm9WZWxvY2l0eTIiLCJzdG9wQW5pbWF0aW9uIiwiaGFzVW5tb3VudGVkIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJzdGFydEFuaW1hdGlvbiIsImludGVycG9sYXRlVmFsdWUiLCJzdHJpcHBlZFN0eWxlIiwiX3N0cmlwU3R5bGUyIiwicmVuZGVyZWRDaGlsZHJlbiIsIkNoaWxkcmVuIiwib25seSIsIlN0YWdnZXJlZE1vdGlvbiIsImRlZmF1bHRTdHlsZXMiLCJhcnJheU9mIiwiX3Byb3BzMiIsImN1cnJlbnRTdHlsZXMiLCJjdXJyZW50VmVsb2NpdGllcyIsIm5ld0N1cnJlbnRTdHlsZXMiLCJuZXdDdXJyZW50VmVsb2NpdGllcyIsImsiLCJvYmplY3RPZiIsImFueSIsImdldERlZmF1bHRQcm9wcyIsIl9wcm9wczMiLCJfcHJvcHM0IiwibWVyZ2VkU3R5bGVzIiwiaGFzTmV3S2V5IiwiX21lcmdlRGlmZjIiLCJfaGFzUmVhY2hlZFN0eWxlMiIsIl9leHRlbmRzMiIsIl9leHRlbmRzMyIsImVudGVyU3R5bGUiLCJtZXJnZWRTdHlsZSIsIl9kZXByZWNhdGVkU3ByaW5ncyIsIl9kZXByZWNhdGVkU3ByaW5nczMiLCJTcHJpbmciLCJUcmFuc2l0aW9uU3ByaW5nIiwiX25vVmVsb2NpdHkiLCJfaGFzUmVhY2hlZFN0eWxlIiwiX21lcmdlRGlmZiIsIl9hbmltYXRpb25Mb29wIiwiX2FuaW1hdGlvbkxvb3AyIiwiX3plcm8iLCJfZGVwcmVjYXRlZFNwcmluZ3MyIiwiX3N0cmlwU3R5bGUiLCJkZXByZWNhdGVkU3ByaW5ncyIsImNvbXBvbmVudFdpbGxNb3VudCIsImhhc1JlYWNoZWRTdHlsZSIsImRlc3RWYWx1ZSIsIm1lcmdlRGlmZkFyciIsIl94NCIsIl94NSIsIl94NiIsIl94NyIsImFyckEiLCJhcnJCIiwiY29sbEIiLCJpbmRleEEiLCJpbmRleEIiLCJvblJlbW92ZSIsImFjY3VtIiwiZW5kQSIsImVuZEIiLCJrZXlBIiwia2V5QiIsImZpbGwiLCJtZXJnZURpZmYiLCJub1ZlbG9jaXR5IiwiX2NvbXBvbmVudHMyIiwiX2NvbXBvbmVudHMzIiwiX3Jlb3JkZXJLZXlzIiwiX3Jlb3JkZXJLZXlzMiIsIl9jb21wb25lbnRzIiwiX3NwcmluZzIiLCJfc3ByaW5nMyIsIl9wcmVzZXRzMiIsIl9wcmVzZXRzMyIsInByZXNldHMiLCJ1dGlscyIsInJlb3JkZXJLZXlzIiwibmV3S2V5cyIsIl9wcmVzZXRzIiwic3RlcHBlciIsImZyYW1lUmF0ZSIsImRlc3RYIiwiRnNwcmluZyIsIkZkYW1wZXIiLCJuZXdWIiwibmV3WCIsImVycm9yTWFyZ2luIiwic3RyaXBTdHlsZSIsIm5leHRTdHlsZSIsInByZXZTdHlsZSIsInByZXZWYWx1ZSIsIl9zdHlsZSRrZXkkY29uZmlnIiwiX3N0ZXBwZXIyIiwiX3N0eWxlJGtleSRjb25maWcyIiwiX3N0ZXBwZXIiLCJ6ZXJvIiwidmVuZG9ycyIsInN1ZmZpeCIsImNhZiIsImxhc3QiLCJmcmFtZUR1cmF0aW9uIiwiX25vdyIsImNwIiwiY2FuY2VsbGVkIiwicm91bmQiLCJjYW5jZWwiLCJhZGRTdHlsZXNUb0RvbSIsImRvbVN0eWxlIiwic3R5bGVzSW5Eb20iLCJyZWZzIiwicGFydHMiLCJhZGRTdHlsZSIsImxpc3RUb1N0eWxlcyIsIm5ld1N0eWxlcyIsImNzcyIsIm1lZGlhIiwic291cmNlTWFwIiwicGFydCIsImNyZWF0ZVN0eWxlRWxlbWVudCIsInN0eWxlRWxlbWVudCIsImhlYWQiLCJnZXRIZWFkRWxlbWVudCIsImNyZWF0ZUxpbmtFbGVtZW50IiwibGlua0VsZW1lbnQiLCJyZWwiLCJ1cGRhdGUiLCJzaW5nbGV0b24iLCJzdHlsZUluZGV4Iiwic2luZ2xldG9uQ291bnRlciIsInNpbmdsZXRvbkVsZW1lbnQiLCJhcHBseVRvU2luZ2xldG9uVGFnIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwicmV2b2tlT2JqZWN0VVJMIiwiQmxvYiIsImJ0b2EiLCJ1cGRhdGVMaW5rIiwiYXBwbHlUb1RhZyIsIm5ld09iaiIsInN0eWxlU2hlZXQiLCJjc3NUZXh0IiwicmVwbGFjZVRleHQiLCJjc3NOb2RlIiwiY3JlYXRlVGV4dE5vZGUiLCJjaGlsZE5vZGVzIiwiaW5zZXJ0QmVmb3JlIiwiZmlyc3RDaGlsZCIsInVuZXNjYXBlIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsImJsb2IiLCJvbGRTcmMiLCJtZW1vaXplIiwibWVtbyIsImlzT2xkSUUiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b0xvd2VyQ2FzZSIsIm5ld0xpc3QiLCJtYXlSZW1vdmUiLCJ0ZXh0U3RvcmUiLCJyZXBsYWNlbWVudCIsIkJvb2xlYW4iLCJjb250ZW50IiwibG9jYWxzIiwid2VicGFja1BvbHlmaWxsIiwiZGVwcmVjYXRlIiwicGF0aHMiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FFLFdBQ0FFLEdBQUFKLEVBQ0FLLFFBQUEsRUFVQSxPQU5BUCxHQUFBRSxHQUFBTSxLQUFBSCxFQUFBRCxRQUFBQyxJQUFBRCxRQUFBSCxHQUdBSSxFQUFBRSxRQUFBLEVBR0FGLEVBQUFELFFBdkJBLEdBQUFELEtBcUNBLE9BVEFGLEdBQUFRLEVBQUFULEVBR0FDLEVBQUFTLEVBQUFQLEVBR0FGLEVBQUFVLEVBQUEsSUFHQVYsRUFBQSxLRE1NLFNBQVNJLEVBQVFELEVBQVNILEdB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QTV2QyxPQUEyQjh5QixJQUM3QzJjLEVBQUFHLE1BQUE5YyxXQUNBNGMsR0FBQUQsRUFBQWh4QyxPQXdHQSxJQUFBa3pDLEdBQUEsV0FDQSxHQUFBb0IsS0FFQSxpQkFBQXZoQyxFQUFBd2hDLEdBRUEsTUFEQUQsR0FBQXZoQyxHQUFBd2hDLEVBQ0FELEVBQUFoZ0IsT0FBQWtnQixTQUFBaGtDLEtBQUEsV2pDbWhTTSxTQUFTelEsRUFBUUQsRUFBU0gsR2tDaHJTaEMsR0FBQTgwQyxHQUFBOTBDLEVBQUEsR0FDQSxpQkFBQTgwQyxTQUFBMTBDLEVBQUFDLEdBQUF5MEMsRUFBQSxLQUVBOTBDLEdBQUEsSUFBQTgwQyxLQUNBQSxHQUFBQyxTQUFBMzBDLEVBQUFELFFBQUEyMEMsRUFBQUMsU2xDc3NTTSxTQUFTMzBDLEVBQVFELEdtQzdzU3ZCQyxFQUFBRCxRQUFBLFNBQUFDLEdBUUEsTUFQQUEsR0FBQTQwQyxrQkFDQTUwQyxFQUFBNjBDLFVBQUEsYUFDQTcwQyxFQUFBODBDLFNBRUE5MEMsRUFBQW9wQyxZQUNBcHBDLEVBQUE0MEMsZ0JBQUEsR0FFQTUwQyIsImZpbGUiOiJyZWFjdC1jbGltYi1zb2NpYWwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1wiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXHRcblx0dmFyIF9jb21wb25lbnRzV2FsbENvbnRhaW5lciA9IF9fd2VicGFja19yZXF1aXJlX18oMTApO1xuXHRcblx0dmFyIF9jb21wb25lbnRzV2FsbENvbnRhaW5lcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRzV2FsbENvbnRhaW5lcik7XG5cdFxuXHRfX3dlYnBhY2tfcmVxdWlyZV9fKDMyKTtcblx0XG5cdGlmICh3aW5kb3cpIHtcblx0ICAgIHdpbmRvdy5DbGltYiA9IHdpbmRvdy5DbGltYiB8fCB7fTtcblx0XG5cdCAgICB2YXIgJHRhcmdldHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2xpbWItd2FsbCcpO1xuXHRcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHRhcmdldHMubGVuZ3RoOyArK2kpIHtcblx0ICAgICAgICB2YXIgJGl0ZW0gPSAkdGFyZ2V0c1tpXTtcblx0ICAgICAgICB2YXIgY29sbGVjdGlvbklkID0gJGl0ZW0uZGF0YXNldC5jb2xsZWN0aW9uSWQ7XG5cdCAgICAgICAgdmFyIGxpbWl0ID0gJGl0ZW0uZGF0YXNldC5saW1pdDtcblx0XG5cdCAgICAgICAgX3JlYWN0MlsnZGVmYXVsdCddLnJlbmRlcihfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfY29tcG9uZW50c1dhbGxDb250YWluZXIyWydkZWZhdWx0J10sIHsgY29sbGVjdGlvbklkOiBjb2xsZWN0aW9uSWQsIGxpbWl0OiBsaW1pdCB9KSwgJGl0ZW0pO1xuXHQgICAgfVxuXHR9XG5cdFxuXHRleHBvcnRzWydkZWZhdWx0J10gPSBfY29tcG9uZW50c1dhbGxDb250YWluZXIyWydkZWZhdWx0J107XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBSZWFjdDtcblxuLyoqKi8gfSxcbi8qIDIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIFtzdGlmZm5lc3MsIGRhbXBpbmddXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB7XG5cdCAgbm9Xb2JibGU6IFsxNzAsIDI2XSwgLy8gdGhlIGRlZmF1bHRcblx0ICBnZW50bGU6IFsxMjAsIDE0XSxcblx0ICB3b2JibHk6IFsxODAsIDEyXSxcblx0ICBzdGlmZjogWzIxMCwgMjBdXG5cdH07XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2Vzcykgey8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS43LjFcblx0KGZ1bmN0aW9uKCkge1xuXHQgIHZhciBnZXROYW5vU2Vjb25kcywgaHJ0aW1lLCBsb2FkVGltZTtcblx0XG5cdCAgaWYgKCh0eXBlb2YgcGVyZm9ybWFuY2UgIT09IFwidW5kZWZpbmVkXCIgJiYgcGVyZm9ybWFuY2UgIT09IG51bGwpICYmIHBlcmZvcm1hbmNlLm5vdykge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIHBlcmZvcm1hbmNlLm5vdygpO1xuXHQgICAgfTtcblx0ICB9IGVsc2UgaWYgKCh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzICE9PSBudWxsKSAmJiBwcm9jZXNzLmhydGltZSkge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIChnZXROYW5vU2Vjb25kcygpIC0gbG9hZFRpbWUpIC8gMWU2O1xuXHQgICAgfTtcblx0ICAgIGhydGltZSA9IHByb2Nlc3MuaHJ0aW1lO1xuXHQgICAgZ2V0TmFub1NlY29uZHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgdmFyIGhyO1xuXHQgICAgICBociA9IGhydGltZSgpO1xuXHQgICAgICByZXR1cm4gaHJbMF0gKiAxZTkgKyBoclsxXTtcblx0ICAgIH07XG5cdCAgICBsb2FkVGltZSA9IGdldE5hbm9TZWNvbmRzKCk7XG5cdCAgfSBlbHNlIGlmIChEYXRlLm5vdykge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIERhdGUubm93KCkgLSBsb2FkVGltZTtcblx0ICAgIH07XG5cdCAgICBsb2FkVGltZSA9IERhdGUubm93KCk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIGxvYWRUaW1lO1xuXHQgICAgfTtcblx0ICAgIGxvYWRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdCAgfVxuXHRcblx0fSkuY2FsbCh0aGlzKTtcblx0XG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpKSlcblxuLyoqKi8gfSxcbi8qIDQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXHRcblx0dmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXHR2YXIgcXVldWUgPSBbXTtcblx0dmFyIGRyYWluaW5nID0gZmFsc2U7XG5cdHZhciBjdXJyZW50UXVldWU7XG5cdHZhciBxdWV1ZUluZGV4ID0gLTE7XG5cdFxuXHRmdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG5cdCAgICBkcmFpbmluZyA9IGZhbHNlO1xuXHQgICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcblx0ICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG5cdCAgICB9XG5cdCAgICBpZiAocXVldWUubGVuZ3RoKSB7XG5cdCAgICAgICAgZHJhaW5RdWV1ZSgpO1xuXHQgICAgfVxuXHR9XG5cdFxuXHRmdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuXHQgICAgaWYgKGRyYWluaW5nKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgICAgdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG5cdCAgICBkcmFpbmluZyA9IHRydWU7XG5cdFxuXHQgICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcblx0ICAgIHdoaWxlKGxlbikge1xuXHQgICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuXHQgICAgICAgIHF1ZXVlID0gW107XG5cdCAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuXHQgICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG5cdCAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuXHQgICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcblx0ICAgIH1cblx0ICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG5cdCAgICBkcmFpbmluZyA9IGZhbHNlO1xuXHQgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuXHR9XG5cdFxuXHRwcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuXHQgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuXHQgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHQgICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcblx0ICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG5cdCAgICAgICAgc2V0VGltZW91dChkcmFpblF1ZXVlLCAwKTtcblx0ICAgIH1cblx0fTtcblx0XG5cdC8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcblx0ZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG5cdCAgICB0aGlzLmZ1biA9IGZ1bjtcblx0ICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcblx0fVxuXHRJdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcblx0fTtcblx0cHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcblx0cHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcblx0cHJvY2Vzcy5lbnYgPSB7fTtcblx0cHJvY2Vzcy5hcmd2ID0gW107XG5cdHByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xuXHRwcm9jZXNzLnZlcnNpb25zID0ge307XG5cdFxuXHRmdW5jdGlvbiBub29wKCkge31cblx0XG5cdHByb2Nlc3Mub24gPSBub29wO1xuXHRwcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcblx0cHJvY2Vzcy5vbmNlID0gbm9vcDtcblx0cHJvY2Vzcy5vZmYgPSBub29wO1xuXHRwcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcblx0cHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xuXHRwcm9jZXNzLmVtaXQgPSBub29wO1xuXHRcblx0cHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcblx0ICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcblx0fTtcblx0XG5cdHByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5cdHByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG5cdCAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xuXHR9O1xuXHRwcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cbi8qKiovIH0sXG4vKiA1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IFwiZGVmYXVsdFwiOiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBBdXRob3IgPSAoZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhBdXRob3IsIF9SZWFjdCRDb21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIEF1dGhvcigpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXV0aG9yKTtcblx0XG5cdCAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoQXV0aG9yLnByb3RvdHlwZSksIFwiY29uc3RydWN0b3JcIiwgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoQXV0aG9yLCBbe1xuXHQgICAgICAgIGtleTogXCJyZW5kZXJcIixcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgICAgICAgICBcImFcIixcblx0ICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiBcImNsaW1iX190aWxlX19hdXRob3JcIixcblx0ICAgICAgICAgICAgICAgICAgICBocmVmOiB0aGlzLnByb3BzLmxpbmsgfSxcblx0ICAgICAgICAgICAgICAgIF9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgeyBzcmM6IHRoaXMucHJvcHMucGljdHVyZSxcblx0ICAgICAgICAgICAgICAgICAgICBhbHQ6IFwiUHJvZmlsZSBwaWMgb2YgXCIgKyB0aGlzLnByb3BzLm5hbWUgfSksXG5cdCAgICAgICAgICAgICAgICBfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgICAgIFwiaDRcIixcblx0ICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogXCJjbGltYl9fdGlsZV9fYXV0aG9yX191c2VybmFtZVwiIH0sXG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy51c2VybmFtZVxuXHQgICAgICAgICAgICAgICAgKVxuXHQgICAgICAgICAgICApO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gQXV0aG9yO1xuXHR9KShfcmVhY3QyW1wiZGVmYXVsdFwiXS5Db21wb25lbnQpO1xuXHRcblx0QXV0aG9yLnByb3BUeXBlcyA9IHt9O1xuXHRcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBBdXRob3I7XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiA2ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IFwiZGVmYXVsdFwiOiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBJbWFnZSA9IChmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKEltYWdlLCBfUmVhY3QkQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBJbWFnZSgpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW1hZ2UpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihJbWFnZS5wcm90b3R5cGUpLCBcImNvbnN0cnVjdG9yXCIsIHRoaXMpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKEltYWdlLCBbe1xuXHQgICAgICAgIGtleTogXCJyZW5kZXJcIixcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MltcImRlZmF1bHRcIl0uY3JlYXRlRWxlbWVudChcImltZ1wiLCB7IGNsYXNzTmFtZTogXCJjbGltYl9fdGlsZV9faW1hZ2VcIixcblx0ICAgICAgICAgICAgICAgIHNyYzogdGhpcy5wcm9wcy5zcmMsIFwiZGF0YS13aWR0aFwiOiB0aGlzLnByb3BzLndpZHRoLCBcImRhdGEtaGVpZ2h0XCI6IHRoaXMucHJvcHMuaGVpZ2h0IH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gSW1hZ2U7XG5cdH0pKF9yZWFjdDJbXCJkZWZhdWx0XCJdLkNvbXBvbmVudCk7XG5cdFxuXHRJbWFnZS5wcm9wVHlwZXMgPSB7XG5cdCAgICBzcmM6IF9yZWFjdDJbXCJkZWZhdWx0XCJdLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgIHdpZHRoOiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5Qcm9wVHlwZXMubnVtYmVyLFxuXHQgICAgaGVpZ2h0OiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5Qcm9wVHlwZXMubnVtYmVyXG5cdH07XG5cdFxuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IEltYWdlO1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogNyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBcImRlZmF1bHRcIjogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgTWVzc2FnZSA9IChmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKE1lc3NhZ2UsIF9SZWFjdCRDb21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIE1lc3NhZ2UoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lc3NhZ2UpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihNZXNzYWdlLnByb3RvdHlwZSksIFwiY29uc3RydWN0b3JcIiwgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoTWVzc2FnZSwgW3tcblx0ICAgICAgICBrZXk6IFwicmVuZGVyXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwiY2xpbWJfX3RpbGVfX21lc3NhZ2VcIixcblx0ICAgICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiB7IF9faHRtbDogdGhpcy5wcm9wcy5ib2R5IH0gfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBNZXNzYWdlO1xuXHR9KShfcmVhY3QyW1wiZGVmYXVsdFwiXS5Db21wb25lbnQpO1xuXHRcblx0TWVzc2FnZS5wcm9wVHlwZXMgPSB7XG5cdCAgICBib2R5OiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcblx0fTtcblx0XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gTWVzc2FnZTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDggKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgX0ltYWdlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTtcblx0XG5cdHZhciBfSW1hZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSW1hZ2UpO1xuXHRcblx0dmFyIF9NZXNzYWdlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblx0XG5cdHZhciBfTWVzc2FnZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9NZXNzYWdlKTtcblx0XG5cdHZhciBfQXV0aG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0XG5cdHZhciBfQXV0aG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0F1dGhvcik7XG5cdFxuXHR2YXIgVGlsZSA9IChmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKFRpbGUsIF9SZWFjdCRDb21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFRpbGUocHJvcHMpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGlsZSk7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFRpbGUucHJvdG90eXBlKSwgJ2NvbnN0cnVjdG9yJywgdGhpcykuY2FsbCh0aGlzLCBwcm9wcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFRpbGUsIFt7XG5cdCAgICAgICAga2V5OiAnY3JlYXRlSW1hZ2UnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVJbWFnZSgpIHtcblx0XG5cdCAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmltYWdlICE9PSBudWxsKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgX3Byb3BzJGltYWdlID0gdGhpcy5wcm9wcy5pbWFnZTtcblx0ICAgICAgICAgICAgICAgIHZhciBzcmMgPSBfcHJvcHMkaW1hZ2UudXJsO1xuXHQgICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gX3Byb3BzJGltYWdlLndpZHRoO1xuXHQgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IF9wcm9wcyRpbWFnZS5oZWlnaHQ7XG5cdFxuXHQgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9JbWFnZTJbJ2RlZmF1bHQnXSwgeyBzcmM6IHNyYyxcblx0ICAgICAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG5cdCAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQgfSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2NyZWF0ZU1lc3NhZ2UnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVNZXNzYWdlKCkge1xuXHRcblx0ICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMubWVzc2FnZSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9NZXNzYWdlMlsnZGVmYXVsdCddLCB7IGJvZHk6IHRoaXMucHJvcHMubWVzc2FnZSB9KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY3JlYXRlQ2xhc3NTdHJpbmcnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVDbGFzc1N0cmluZygpIHtcblx0XG5cdCAgICAgICAgICAgIHZhciBjbGFzc1N0cmluZyA9ICdjbGltYl9fdGlsZSBjbGltYl9fdGlsZS0tJyArIHRoaXMucHJvcHMuc291cmNlX3R5cGU7XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5pbWFnZSkge1xuXHQgICAgICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW1lZGlhIGNsaW1iX190aWxlLS1oYXMtaW1hZ2UnO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW5vLWltYWdlJztcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMudmlkZW9fdXJsKSB7XG5cdCAgICAgICAgICAgICAgICBjbGFzc1N0cmluZyArPSAnIGNsaW1iX190aWxlLS1oYXMtbWVkaWEgY2xpbWJfX3RpbGUtLWhhcy12aWRlbyc7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBjbGFzc1N0cmluZyArPSAnIGNsaW1iX190aWxlLS1oYXMtbm8tdmlkZW8nO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gY2xhc3NTdHJpbmc7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbmRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0XG5cdCAgICAgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuY3JlYXRlSW1hZ2UoKTtcblx0ICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSB0aGlzLmNyZWF0ZU1lc3NhZ2UoKTtcblx0ICAgICAgICAgICAgdmFyIGNsYXNzU3RyaW5nID0gdGhpcy5jcmVhdGVDbGFzc1N0cmluZygpO1xuXHQgICAgICAgICAgICB2YXIgYXV0aG9yID0gdGhpcy5wcm9wcy5hdXRob3I7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgICAgICAgICAnZGl2Jyxcblx0ICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiBjbGFzc1N0cmluZyxcblx0ICAgICAgICAgICAgICAgICAgICBzdHlsZTogdGhpcy5wcm9wcy5zdHlsZSB9LFxuXHQgICAgICAgICAgICAgICAgX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgICAgICAgICAgICAgJ2EnLFxuXHQgICAgICAgICAgICAgICAgICAgIHsgaHJlZjogdGhpcy5wcm9wcy5saW5rIH0sXG5cdCAgICAgICAgICAgICAgICAgICAgaW1hZ2Vcblx0ICAgICAgICAgICAgICAgICksXG5cdCAgICAgICAgICAgICAgICBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChcblx0ICAgICAgICAgICAgICAgICAgICAnZGl2Jyxcblx0ICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2NsaW1iX190aWxlX19jb250ZW50JyB9LFxuXHQgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsXG5cdCAgICAgICAgICAgICAgICAgICAgX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX0F1dGhvcjJbJ2RlZmF1bHQnXSwgYXV0aG9yKVxuXHQgICAgICAgICAgICAgICAgKVxuXHQgICAgICAgICAgICApO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gVGlsZTtcblx0fSkoX3JlYWN0MlsnZGVmYXVsdCddLkNvbXBvbmVudCk7XG5cdFxuXHRUaWxlLnByb3BUeXBlcyA9IHtcblx0XG5cdCAgICAvLyBSZXF1aXJlZCBhdHRyc1xuXHQgICAgbGluazogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgIHNvdXJjZV90eXBlOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuXHQgICAgdGltZXN0YW1wOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuXHQgICAgYXV0aG9yOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnNoYXBlKHtcblx0ICAgICAgICB1c2VybmFtZTogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgICAgICBwaWN0dXJlOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuXHQgICAgICAgIGxpbms6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcblx0ICAgIH0pLFxuXHRcblx0ICAgIC8vIE9wdGlvbmFsIGF0dHJzXG5cdCAgICBtZXNzYWdlOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnN0cmluZyxcblx0ICAgIHZpZGVvX3NyYzogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcsXG5cdCAgICBpbWFnZTogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zaGFwZSh7XG5cdCAgICAgICAgdXJsOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuXHQgICAgICAgIHdpZHRoOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuXHQgICAgICAgIGhlaWdodDogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZFxuXHQgICAgfSlcblx0XG5cdH07XG5cdFxuXHRleHBvcnRzWydkZWZhdWx0J10gPSBUaWxlO1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDkgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmICgndmFsdWUnIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMob2JqLCBrZXlzKSB7IHZhciB0YXJnZXQgPSB7fTsgZm9yICh2YXIgaSBpbiBvYmopIHsgaWYgKGtleXMuaW5kZXhPZihpKSA+PSAwKSBjb250aW51ZTsgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBpKSkgY29udGludWU7IHRhcmdldFtpXSA9IG9ialtpXTsgfSByZXR1cm4gdGFyZ2V0OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cdFxuXHR2YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXHRcblx0dmFyIF9UaWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0XG5cdHZhciBfVGlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9UaWxlKTtcblx0XG5cdHZhciBfcmVhY3RNb3Rpb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTtcblx0XG5cdHZhciBXYWxsID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7XG5cdCAgICBfaW5oZXJpdHMoV2FsbCwgX0NvbXBvbmVudCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gV2FsbCgpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV2FsbCk7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFdhbGwucHJvdG90eXBlKSwgJ2NvbnN0cnVjdG9yJywgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoV2FsbCwgW3tcblx0ICAgICAgICBrZXk6ICdnZXRTdHlsZXMnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdHlsZXMoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICB2YXIgY29uZmlncyA9IHt9O1xuXHQgICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnByb3BzLml0ZW1zKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuXHQgICAgICAgICAgICAgICAgY29uZmlnc1trZXldID0ge1xuXHQgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgxKSxcblx0ICAgICAgICAgICAgICAgICAgICB3aWR0aDogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDM3NSksXG5cdCAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMTApLFxuXHQgICAgICAgICAgICAgICAgICAgIGl0ZW06IF90aGlzLnByb3BzLml0ZW1zW2tleV1cblx0ICAgICAgICAgICAgICAgIH07XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICByZXR1cm4gY29uZmlncztcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnd2lsbEVudGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2lsbEVudGVyKGtleSkge1xuXHQgICAgICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICAgICAgb3BhY2l0eTogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgd2lkdGg6ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgwKSxcblx0ICAgICAgICAgICAgICAgIG1hcmdpbjogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3dpbGxMZWF2ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpbGxMZWF2ZShrZXksIHN0eWxlKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgICAgICBvcGFjaXR5OiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMCksXG5cdCAgICAgICAgICAgICAgICB3aWR0aDogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgbWFyZ2luOiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMCksXG5cdCAgICAgICAgICAgICAgICBpdGVtOiBzdHlsZS5pdGVtXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbmRlclRpbGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJUaWxlKGtleSwgaXRlbVZhbHVlcykge1xuXHQgICAgICAgICAgICB2YXIgaXRlbSA9IGl0ZW1WYWx1ZXMuaXRlbTtcblx0XG5cdCAgICAgICAgICAgIHZhciBzdHlsZUNvbmZpZyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhpdGVtVmFsdWVzLCBbJ2l0ZW0nXSk7XG5cdFxuXHQgICAgICAgICAgICB2YXIgaXRlbVByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKGl0ZW0sIFtdKTtcblx0XG5cdCAgICAgICAgICAgIHZhciBzdHlsZSA9IHtcblx0ICAgICAgICAgICAgICAgIG9wYWNpdHk6IHN0eWxlQ29uZmlnLm9wYWNpdHksXG5cdCAgICAgICAgICAgICAgICB3aWR0aDogc3R5bGVDb25maWcud2lkdGggKyAncHgnLFxuXHQgICAgICAgICAgICAgICAgJ21hcmdpbi1sZWZ0Jzogc3R5bGVDb25maWcubWFyZ2luLFxuXHQgICAgICAgICAgICAgICAgJ21hcmdpbi1yaWdodCc6IHN0eWxlQ29uZmlnLm1hcmdpblxuXHQgICAgICAgICAgICB9O1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9UaWxlMlsnZGVmYXVsdCddLCBfZXh0ZW5kcyh7IGtleToga2V5LFxuXHQgICAgICAgICAgICAgICAgc3R5bGU6IHN0eWxlXG5cdCAgICAgICAgICAgIH0sIGl0ZW1Qcm9wcykpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW5kZXInLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgX3JlYWN0TW90aW9uLlRyYW5zaXRpb25Nb3Rpb24sXG5cdCAgICAgICAgICAgICAgICB7XG5cdCAgICAgICAgICAgICAgICAgICAgc3R5bGVzOiB0aGlzLmdldFN0eWxlcy5iaW5kKHRoaXMpKCksXG5cdCAgICAgICAgICAgICAgICAgICAgd2lsbEVudGVyOiB0aGlzLndpbGxFbnRlci5iaW5kKHRoaXMpLFxuXHQgICAgICAgICAgICAgICAgICAgIHdpbGxMZWF2ZTogdGhpcy53aWxsTGVhdmUuYmluZCh0aGlzKSB9LFxuXHQgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHZhbHVlcykge1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChcblx0ICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnY2xpbWJfX3dhbGwnIH0sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHZhbHVlcykubWFwKGZ1bmN0aW9uIChrZXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWVzID0gdmFsdWVzW2tleV07XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLnJlbmRlclRpbGUoa2V5LCBpdGVtVmFsdWVzKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSlcblx0ICAgICAgICAgICAgICAgICAgICApO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICApO1xuXHQgICAgICAgIH1cblx0ICAgIH1dLCBbe1xuXHQgICAgICAgIGtleTogJ3Byb3BUeXBlcycsXG5cdCAgICAgICAgdmFsdWU6IHtcblx0ICAgICAgICAgICAgaXRlbXM6IF9yZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWRcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVudW1lcmFibGU6IHRydWVcblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gV2FsbDtcblx0fSkoX3JlYWN0LkNvbXBvbmVudCk7XG5cdFxuXHRleHBvcnRzWydkZWZhdWx0J10gPSBXYWxsO1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDEwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmICgndmFsdWUnIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cdFxuXHR2YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXHRcblx0dmFyIF9jbGltYlNvY2lhbCA9IF9fd2VicGFja19yZXF1aXJlX18oMTEpO1xuXHRcblx0dmFyIF9jbGltYlNvY2lhbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGltYlNvY2lhbCk7XG5cdFxuXHR2YXIgX1dhbGwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHRcblx0dmFyIF9XYWxsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1dhbGwpO1xuXHRcblx0dmFyIFdhbGxDb250YWluZXIgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhXYWxsQ29udGFpbmVyLCBfQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBXYWxsQ29udGFpbmVyKHByb3BzKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFdhbGxDb250YWluZXIpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihXYWxsQ29udGFpbmVyLnByb3RvdHlwZSksICdjb25zdHJ1Y3RvcicsIHRoaXMpLmNhbGwodGhpcywgcHJvcHMpO1xuXHQgICAgICAgIHRoaXMuc3RhdGUgPSB7XG5cdCAgICAgICAgICAgIGl0ZW1zOiBbXVxuXHQgICAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFdhbGxDb250YWluZXIsIFt7XG5cdCAgICAgICAga2V5OiAnaW5pdCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICBpZiAoIXRoaXMucHJvcHMuY29sbGVjdGlvbklkKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIF9jbGltYlNvY2lhbDJbJ2RlZmF1bHQnXS5nZXRTdHJlYW0odGhpcy5wcm9wcy5jb2xsZWN0aW9uSWQpLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbXMpIHtcblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgbWF4U2l6ZSA9IHBhcnNlSW50KF90aGlzLnByb3BzLmxpbWl0LCAwKTtcblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgbWFwcGVkSXRlbXMgPSB7fTtcblx0ICAgICAgICAgICAgICAgIGl0ZW1zLnNwbGljZSgwLCBtYXhTaXplKS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgICAgICAgICAgICAgICAgICBtYXBwZWRJdGVtc1tpdGVtLmlkXSA9IGl0ZW07XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7XG5cdCAgICAgICAgICAgICAgICAgICAgaXRlbXM6IG1hcHBlZEl0ZW1zXG5cdCAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2NvbXBvbmVudERpZE1vdW50Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG5cdCAgICAgICAgICAgIHRoaXMuaW5pdCgpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdjb21wb25lbnREaWRVcGRhdGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUoKSB7XG5cdCAgICAgICAgICAgIHZhciBjYiA9IHVuZGVmaW5lZDtcblx0ICAgICAgICAgICAgaWYgKHdpbmRvdy5DbGltYiAmJiB3aW5kb3cuQ2xpbWIub25VcGRhdGUpIHtcblx0ICAgICAgICAgICAgICAgIGNiID0gd2luZG93LkNsaW1iLm9uVXBkYXRlO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgLy8gbm9vcFxuXHQgICAgICAgICAgICAgICAgY2IgPSBmdW5jdGlvbiAoKSB7fTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBjYigpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW5kZXInLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfV2FsbDJbJ2RlZmF1bHQnXSwgeyBpdGVtczogdGhpcy5zdGF0ZS5pdGVtcyB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9XSwgW3tcblx0ICAgICAgICBrZXk6ICdwcm9wVHlwZXMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogX3JlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgICAgICAgICAgbGltaXQ6IF9yZWFjdC5Qcm9wVHlwZXMub25lT2ZUeXBlKFtfcmVhY3QuUHJvcFR5cGVzLm51bWJlciwgX3JlYWN0LlByb3BUeXBlcy5zdHJpbmddKVxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2RlZmF1bHRQcm9wcycsXG5cdCAgICAgICAgdmFsdWU6IHtcblx0ICAgICAgICAgICAgY29sbGVjdGlvbklkOiAnNTYxYmE2MzQ0NTI4NGUxNzQwZTAxNmY3Jyxcblx0ICAgICAgICAgICAgbGltaXQ6IDMwXG5cdCAgICAgICAgfSxcblx0ICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIFdhbGxDb250YWluZXI7XG5cdH0pKF9yZWFjdC5Db21wb25lbnQpO1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gV2FsbENvbnRhaW5lcjtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAxMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX3J4TGl0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTIpO1xuXHRcblx0dmFyIF9mZXRjaEpzb25wID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7XG5cdFxuXHR2YXIgX2ZldGNoSnNvbnAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmV0Y2hKc29ucCk7XG5cdFxuXHR2YXIgZ2V0U3RyZWFtID0gZnVuY3Rpb24gZ2V0U3RyZWFtKGNvbGxlY3Rpb25JZCkge1xuXHRcblx0ICAgIHZhciBwb2xsUmF0ZSA9IDUgKiAxMDAwO1xuXHRcblx0ICAgIHZhciByZXF1ZXN0U3RyZWFtID0gX3J4TGl0ZS5PYnNlcnZhYmxlLmp1c3QoJ2h0dHA6Ly9hcHAuY2xpbWIuc29jaWFsL2FwaS92MS9jb2xsZWN0aW9ucy8nICsgY29sbGVjdGlvbklkKTtcblx0XG5cdCAgICB2YXIgdXBkYXRlU3RyZWFtID0gX3J4TGl0ZS5PYnNlcnZhYmxlLmludGVydmFsKHBvbGxSYXRlKS5zdGFydFdpdGgobnVsbCk7XG5cdFxuXHQgICAgdmFyIHJlc3BvbnNlU3RyZWFtID0gdXBkYXRlU3RyZWFtLmNvbWJpbmVMYXRlc3QocmVxdWVzdFN0cmVhbSwgZnVuY3Rpb24gKHRpY2ssIHVybCkge1xuXHQgICAgICAgIHJldHVybiB1cmw7XG5cdCAgICB9KS5mbGF0TWFwKGZ1bmN0aW9uIChiYXNlVXJsKSB7XG5cdFxuXHQgICAgICAgIHZhciByZXF1ZXN0VXJsID0gJycgKyBiYXNlVXJsO1xuXHRcblx0ICAgICAgICByZXR1cm4gX3J4TGl0ZS5PYnNlcnZhYmxlLmZyb21Qcm9taXNlKCgwLCBfZmV0Y2hKc29ucDJbJ2RlZmF1bHQnXSkocmVxdWVzdFVybCkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuXHQgICAgICAgICAgICByZXR1cm4gcmVzcC5qc29uKCk7XG5cdCAgICAgICAgfSkpO1xuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIHJlc3BvbnNlU3RyZWFtO1xuXHR9O1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0ge1xuXHQgICAgZ2V0U3RyZWFtOiBnZXRTdHJlYW1cblx0fTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cblxuLyoqKi8gfSxcbi8qIDEyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovKGZ1bmN0aW9uKG1vZHVsZSwgZ2xvYmFsLCBwcm9jZXNzKSB7Ly8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQsIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuXHRcblx0OyhmdW5jdGlvbiAodW5kZWZpbmVkKSB7XG5cdFxuXHQgIHZhciBvYmplY3RUeXBlcyA9IHtcblx0ICAgICdmdW5jdGlvbic6IHRydWUsXG5cdCAgICAnb2JqZWN0JzogdHJ1ZVxuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGNoZWNrR2xvYmFsKHZhbHVlKSB7XG5cdCAgICByZXR1cm4gKHZhbHVlICYmIHZhbHVlLk9iamVjdCA9PT0gT2JqZWN0KSA/IHZhbHVlIDogbnVsbDtcblx0ICB9XG5cdFxuXHQgIHZhciBmcmVlRXhwb3J0cyA9IChvYmplY3RUeXBlc1t0eXBlb2YgZXhwb3J0c10gJiYgZXhwb3J0cyAmJiAhZXhwb3J0cy5ub2RlVHlwZSkgPyBleHBvcnRzIDogbnVsbDtcblx0ICB2YXIgZnJlZU1vZHVsZSA9IChvYmplY3RUeXBlc1t0eXBlb2YgbW9kdWxlXSAmJiBtb2R1bGUgJiYgIW1vZHVsZS5ub2RlVHlwZSkgPyBtb2R1bGUgOiBudWxsO1xuXHQgIHZhciBmcmVlR2xvYmFsID0gY2hlY2tHbG9iYWwoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSAmJiB0eXBlb2YgZ2xvYmFsID09PSAnb2JqZWN0JyAmJiBnbG9iYWwpO1xuXHQgIHZhciBmcmVlU2VsZiA9IGNoZWNrR2xvYmFsKG9iamVjdFR5cGVzW3R5cGVvZiBzZWxmXSAmJiBzZWxmKTtcblx0ICB2YXIgZnJlZVdpbmRvdyA9IGNoZWNrR2xvYmFsKG9iamVjdFR5cGVzW3R5cGVvZiB3aW5kb3ddICYmIHdpbmRvdyk7XG5cdCAgdmFyIG1vZHVsZUV4cG9ydHMgPSAoZnJlZU1vZHVsZSAmJiBmcmVlTW9kdWxlLmV4cG9ydHMgPT09IGZyZWVFeHBvcnRzKSA/IGZyZWVFeHBvcnRzIDogbnVsbDtcblx0ICB2YXIgdGhpc0dsb2JhbCA9IGNoZWNrR2xvYmFsKG9iamVjdFR5cGVzW3R5cGVvZiB0aGlzXSAmJiB0aGlzKTtcblx0ICB2YXIgcm9vdCA9IGZyZWVHbG9iYWwgfHwgKChmcmVlV2luZG93ICE9PSAodGhpc0dsb2JhbCAmJiB0aGlzR2xvYmFsLndpbmRvdykpICYmIGZyZWVXaW5kb3cpIHx8IGZyZWVTZWxmIHx8IHRoaXNHbG9iYWwgfHwgRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0XG5cdCAgdmFyIFJ4ID0ge1xuXHQgICAgaW50ZXJuYWxzOiB7fSxcblx0ICAgIGNvbmZpZzoge1xuXHQgICAgICBQcm9taXNlOiByb290LlByb21pc2Vcblx0ICAgIH0sXG5cdCAgICBoZWxwZXJzOiB7IH1cblx0ICB9O1xuXHRcblx0ICAvLyBEZWZhdWx0c1xuXHQgIHZhciBub29wID0gUnguaGVscGVycy5ub29wID0gZnVuY3Rpb24gKCkgeyB9LFxuXHQgICAgaWRlbnRpdHkgPSBSeC5oZWxwZXJzLmlkZW50aXR5ID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0sXG5cdCAgICBkZWZhdWx0Tm93ID0gUnguaGVscGVycy5kZWZhdWx0Tm93ID0gRGF0ZS5ub3csXG5cdCAgICBkZWZhdWx0Q29tcGFyZXIgPSBSeC5oZWxwZXJzLmRlZmF1bHRDb21wYXJlciA9IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBpc0VxdWFsKHgsIHkpOyB9LFxuXHQgICAgZGVmYXVsdFN1YkNvbXBhcmVyID0gUnguaGVscGVycy5kZWZhdWx0U3ViQ29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4geCA+IHkgPyAxIDogKHggPCB5ID8gLTEgOiAwKTsgfSxcblx0ICAgIGRlZmF1bHRLZXlTZXJpYWxpemVyID0gUnguaGVscGVycy5kZWZhdWx0S2V5U2VyaWFsaXplciA9IGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG5cdCAgICBkZWZhdWx0RXJyb3IgPSBSeC5oZWxwZXJzLmRlZmF1bHRFcnJvciA9IGZ1bmN0aW9uIChlcnIpIHsgdGhyb3cgZXJyOyB9LFxuXHQgICAgaXNQcm9taXNlID0gUnguaGVscGVycy5pc1Byb21pc2UgPSBmdW5jdGlvbiAocCkgeyByZXR1cm4gISFwICYmIHR5cGVvZiBwLnN1YnNjcmliZSAhPT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgcC50aGVuID09PSAnZnVuY3Rpb24nOyB9LFxuXHQgICAgaXNGdW5jdGlvbiA9IFJ4LmhlbHBlcnMuaXNGdW5jdGlvbiA9IChmdW5jdGlvbiAoKSB7XG5cdFxuXHQgICAgICB2YXIgaXNGbiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJyB8fCBmYWxzZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gZmFsbGJhY2sgZm9yIG9sZGVyIHZlcnNpb25zIG9mIENocm9tZSBhbmQgU2FmYXJpXG5cdCAgICAgIGlmIChpc0ZuKC94LykpIHtcblx0ICAgICAgICBpc0ZuID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJyAmJiB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBpc0ZuO1xuXHQgICAgfSgpKTtcblx0XG5cdCAgICBmdW5jdGlvbiBjbG9uZUFycmF5KGFycikge1xuXHQgICAgICB2YXIgbGVuID0gYXJyLmxlbmd0aCwgYSA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYVtpXSA9IGFycltpXTsgfVxuXHQgICAgICByZXR1cm4gYTtcblx0ICAgIH1cblx0XG5cdCAgdmFyIGVycm9yT2JqID0ge2U6IHt9fTtcblx0ICBcblx0ICBmdW5jdGlvbiB0cnlDYXRjaGVyR2VuKHRyeUNhdGNoVGFyZ2V0KSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24gdHJ5Q2F0Y2hlcigpIHtcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICByZXR1cm4gdHJ5Q2F0Y2hUYXJnZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0ICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgIGVycm9yT2JqLmUgPSBlO1xuXHQgICAgICAgIHJldHVybiBlcnJvck9iajtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIHZhciB0cnlDYXRjaCA9IFJ4LmludGVybmFscy50cnlDYXRjaCA9IGZ1bmN0aW9uIHRyeUNhdGNoKGZuKSB7XG5cdCAgICBpZiAoIWlzRnVuY3Rpb24oZm4pKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ2ZuIG11c3QgYmUgYSBmdW5jdGlvbicpOyB9XG5cdCAgICByZXR1cm4gdHJ5Q2F0Y2hlckdlbihmbik7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gdGhyb3dlcihlKSB7XG5cdCAgICB0aHJvdyBlO1xuXHQgIH1cblx0XG5cdCAgUnguY29uZmlnLmxvbmdTdGFja1N1cHBvcnQgPSBmYWxzZTtcblx0ICB2YXIgaGFzU3RhY2tzID0gZmFsc2UsIHN0YWNrcyA9IHRyeUNhdGNoKGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKCk7IH0pKCk7XG5cdCAgaGFzU3RhY2tzID0gISFzdGFja3MuZSAmJiAhIXN0YWNrcy5lLnN0YWNrO1xuXHRcblx0ICAvLyBBbGwgY29kZSBhZnRlciB0aGlzIHBvaW50IHdpbGwgYmUgZmlsdGVyZWQgZnJvbSBzdGFjayB0cmFjZXMgcmVwb3J0ZWQgYnkgUnhKU1xuXHQgIHZhciByU3RhcnRpbmdMaW5lID0gY2FwdHVyZUxpbmUoKSwgckZpbGVOYW1lO1xuXHRcblx0ICB2YXIgU1RBQ0tfSlVNUF9TRVBBUkFUT1IgPSAnRnJvbSBwcmV2aW91cyBldmVudDonO1xuXHRcblx0ICBmdW5jdGlvbiBtYWtlU3RhY2tUcmFjZUxvbmcoZXJyb3IsIG9ic2VydmFibGUpIHtcblx0ICAgIC8vIElmIHBvc3NpYmxlLCB0cmFuc2Zvcm0gdGhlIGVycm9yIHN0YWNrIHRyYWNlIGJ5IHJlbW92aW5nIE5vZGUgYW5kIFJ4SlNcblx0ICAgIC8vIGNydWZ0LCB0aGVuIGNvbmNhdGVuYXRpbmcgd2l0aCB0aGUgc3RhY2sgdHJhY2Ugb2YgYG9ic2VydmFibGVgLlxuXHQgICAgaWYgKGhhc1N0YWNrcyAmJlxuXHQgICAgICAgIG9ic2VydmFibGUuc3RhY2sgJiZcblx0ICAgICAgICB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnICYmXG5cdCAgICAgICAgZXJyb3IgIT09IG51bGwgJiZcblx0ICAgICAgICBlcnJvci5zdGFjayAmJlxuXHQgICAgICAgIGVycm9yLnN0YWNrLmluZGV4T2YoU1RBQ0tfSlVNUF9TRVBBUkFUT1IpID09PSAtMVxuXHQgICAgKSB7XG5cdCAgICAgIHZhciBzdGFja3MgPSBbXTtcblx0ICAgICAgZm9yICh2YXIgbyA9IG9ic2VydmFibGU7ICEhbzsgbyA9IG8uc291cmNlKSB7XG5cdCAgICAgICAgaWYgKG8uc3RhY2spIHtcblx0ICAgICAgICAgIHN0YWNrcy51bnNoaWZ0KG8uc3RhY2spO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICBzdGFja3MudW5zaGlmdChlcnJvci5zdGFjayk7XG5cdFxuXHQgICAgICB2YXIgY29uY2F0ZWRTdGFja3MgPSBzdGFja3Muam9pbignXFxuJyArIFNUQUNLX0pVTVBfU0VQQVJBVE9SICsgJ1xcbicpO1xuXHQgICAgICBlcnJvci5zdGFjayA9IGZpbHRlclN0YWNrU3RyaW5nKGNvbmNhdGVkU3RhY2tzKTtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGZpbHRlclN0YWNrU3RyaW5nKHN0YWNrU3RyaW5nKSB7XG5cdCAgICB2YXIgbGluZXMgPSBzdGFja1N0cmluZy5zcGxpdCgnXFxuJyksIGRlc2lyZWRMaW5lcyA9IFtdO1xuXHQgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpbmVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgIHZhciBsaW5lID0gbGluZXNbaV07XG5cdFxuXHQgICAgICBpZiAoIWlzSW50ZXJuYWxGcmFtZShsaW5lKSAmJiAhaXNOb2RlRnJhbWUobGluZSkgJiYgbGluZSkge1xuXHQgICAgICAgIGRlc2lyZWRMaW5lcy5wdXNoKGxpbmUpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gZGVzaXJlZExpbmVzLmpvaW4oJ1xcbicpO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gaXNJbnRlcm5hbEZyYW1lKHN0YWNrTGluZSkge1xuXHQgICAgdmFyIGZpbGVOYW1lQW5kTGluZU51bWJlciA9IGdldEZpbGVOYW1lQW5kTGluZU51bWJlcihzdGFja0xpbmUpO1xuXHQgICAgaWYgKCFmaWxlTmFtZUFuZExpbmVOdW1iZXIpIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHQgICAgdmFyIGZpbGVOYW1lID0gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzBdLCBsaW5lTnVtYmVyID0gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzFdO1xuXHRcblx0ICAgIHJldHVybiBmaWxlTmFtZSA9PT0gckZpbGVOYW1lICYmXG5cdCAgICAgIGxpbmVOdW1iZXIgPj0gclN0YXJ0aW5nTGluZSAmJlxuXHQgICAgICBsaW5lTnVtYmVyIDw9IHJFbmRpbmdMaW5lO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gaXNOb2RlRnJhbWUoc3RhY2tMaW5lKSB7XG5cdCAgICByZXR1cm4gc3RhY2tMaW5lLmluZGV4T2YoJyhtb2R1bGUuanM6JykgIT09IC0xIHx8XG5cdCAgICAgIHN0YWNrTGluZS5pbmRleE9mKCcobm9kZS5qczonKSAhPT0gLTE7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBjYXB0dXJlTGluZSgpIHtcblx0ICAgIGlmICghaGFzU3RhY2tzKSB7IHJldHVybjsgfVxuXHRcblx0ICAgIHRyeSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuXHQgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICB2YXIgbGluZXMgPSBlLnN0YWNrLnNwbGl0KCdcXG4nKTtcblx0ICAgICAgdmFyIGZpcnN0TGluZSA9IGxpbmVzWzBdLmluZGV4T2YoJ0AnKSA+IDAgPyBsaW5lc1sxXSA6IGxpbmVzWzJdO1xuXHQgICAgICB2YXIgZmlsZU5hbWVBbmRMaW5lTnVtYmVyID0gZ2V0RmlsZU5hbWVBbmRMaW5lTnVtYmVyKGZpcnN0TGluZSk7XG5cdCAgICAgIGlmICghZmlsZU5hbWVBbmRMaW5lTnVtYmVyKSB7IHJldHVybjsgfVxuXHRcblx0ICAgICAgckZpbGVOYW1lID0gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzBdO1xuXHQgICAgICByZXR1cm4gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzFdO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gZ2V0RmlsZU5hbWVBbmRMaW5lTnVtYmVyKHN0YWNrTGluZSkge1xuXHQgICAgLy8gTmFtZWQgZnVuY3Rpb25zOiAnYXQgZnVuY3Rpb25OYW1lIChmaWxlbmFtZTpsaW5lTnVtYmVyOmNvbHVtbk51bWJlciknXG5cdCAgICB2YXIgYXR0ZW1wdDEgPSAvYXQgLisgXFwoKC4rKTooXFxkKyk6KD86XFxkKylcXCkkLy5leGVjKHN0YWNrTGluZSk7XG5cdCAgICBpZiAoYXR0ZW1wdDEpIHsgcmV0dXJuIFthdHRlbXB0MVsxXSwgTnVtYmVyKGF0dGVtcHQxWzJdKV07IH1cblx0XG5cdCAgICAvLyBBbm9ueW1vdXMgZnVuY3Rpb25zOiAnYXQgZmlsZW5hbWU6bGluZU51bWJlcjpjb2x1bW5OdW1iZXInXG5cdCAgICB2YXIgYXR0ZW1wdDIgPSAvYXQgKFteIF0rKTooXFxkKyk6KD86XFxkKykkLy5leGVjKHN0YWNrTGluZSk7XG5cdCAgICBpZiAoYXR0ZW1wdDIpIHsgcmV0dXJuIFthdHRlbXB0MlsxXSwgTnVtYmVyKGF0dGVtcHQyWzJdKV07IH1cblx0XG5cdCAgICAvLyBGaXJlZm94IHN0eWxlOiAnZnVuY3Rpb25AZmlsZW5hbWU6bGluZU51bWJlciBvciBAZmlsZW5hbWU6bGluZU51bWJlcidcblx0ICAgIHZhciBhdHRlbXB0MyA9IC8uKkAoLispOihcXGQrKSQvLmV4ZWMoc3RhY2tMaW5lKTtcblx0ICAgIGlmIChhdHRlbXB0MykgeyByZXR1cm4gW2F0dGVtcHQzWzFdLCBOdW1iZXIoYXR0ZW1wdDNbMl0pXTsgfVxuXHQgIH1cblx0XG5cdCAgdmFyIEVtcHR5RXJyb3IgPSBSeC5FbXB0eUVycm9yID0gZnVuY3Rpb24oKSB7XG5cdCAgICB0aGlzLm1lc3NhZ2UgPSAnU2VxdWVuY2UgY29udGFpbnMgbm8gZWxlbWVudHMuJztcblx0ICAgIEVycm9yLmNhbGwodGhpcyk7XG5cdCAgfTtcblx0ICBFbXB0eUVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblx0ICBFbXB0eUVycm9yLnByb3RvdHlwZS5uYW1lID0gJ0VtcHR5RXJyb3InO1xuXHRcblx0ICB2YXIgT2JqZWN0RGlzcG9zZWRFcnJvciA9IFJ4Lk9iamVjdERpc3Bvc2VkRXJyb3IgPSBmdW5jdGlvbigpIHtcblx0ICAgIHRoaXMubWVzc2FnZSA9ICdPYmplY3QgaGFzIGJlZW4gZGlzcG9zZWQnO1xuXHQgICAgRXJyb3IuY2FsbCh0aGlzKTtcblx0ICB9O1xuXHQgIE9iamVjdERpc3Bvc2VkRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuXHQgIE9iamVjdERpc3Bvc2VkRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnT2JqZWN0RGlzcG9zZWRFcnJvcic7XG5cdFxuXHQgIHZhciBBcmd1bWVudE91dE9mUmFuZ2VFcnJvciA9IFJ4LkFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdGhpcy5tZXNzYWdlID0gJ0FyZ3VtZW50IG91dCBvZiByYW5nZSc7XG5cdCAgICBFcnJvci5jYWxsKHRoaXMpO1xuXHQgIH07XG5cdCAgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuXHQgIEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yLnByb3RvdHlwZS5uYW1lID0gJ0FyZ3VtZW50T3V0T2ZSYW5nZUVycm9yJztcblx0XG5cdCAgdmFyIE5vdFN1cHBvcnRlZEVycm9yID0gUnguTm90U3VwcG9ydGVkRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuXHQgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVGhpcyBvcGVyYXRpb24gaXMgbm90IHN1cHBvcnRlZCc7XG5cdCAgICBFcnJvci5jYWxsKHRoaXMpO1xuXHQgIH07XG5cdCAgTm90U3VwcG9ydGVkRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuXHQgIE5vdFN1cHBvcnRlZEVycm9yLnByb3RvdHlwZS5uYW1lID0gJ05vdFN1cHBvcnRlZEVycm9yJztcblx0XG5cdCAgdmFyIE5vdEltcGxlbWVudGVkRXJyb3IgPSBSeC5Ob3RJbXBsZW1lbnRlZEVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcblx0ICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgJ1RoaXMgb3BlcmF0aW9uIGlzIG5vdCBpbXBsZW1lbnRlZCc7XG5cdCAgICBFcnJvci5jYWxsKHRoaXMpO1xuXHQgIH07XG5cdCAgTm90SW1wbGVtZW50ZWRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cdCAgTm90SW1wbGVtZW50ZWRFcnJvci5wcm90b3R5cGUubmFtZSA9ICdOb3RJbXBsZW1lbnRlZEVycm9yJztcblx0XG5cdCAgdmFyIG5vdEltcGxlbWVudGVkID0gUnguaGVscGVycy5ub3RJbXBsZW1lbnRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIG5vdFN1cHBvcnRlZCA9IFJ4LmhlbHBlcnMubm90U3VwcG9ydGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdGhyb3cgbmV3IE5vdFN1cHBvcnRlZEVycm9yKCk7XG5cdCAgfTtcblx0XG5cdCAgLy8gU2hpbSBpbiBpdGVyYXRvciBzdXBwb3J0XG5cdCAgdmFyICRpdGVyYXRvciQgPSAodHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiBTeW1ib2wuaXRlcmF0b3IpIHx8XG5cdCAgICAnX2VzNnNoaW1faXRlcmF0b3JfJztcblx0ICAvLyBCdWcgZm9yIG1vemlsbGEgdmVyc2lvblxuXHQgIGlmIChyb290LlNldCAmJiB0eXBlb2YgbmV3IHJvb3QuU2V0KClbJ0BAaXRlcmF0b3InXSA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgJGl0ZXJhdG9yJCA9ICdAQGl0ZXJhdG9yJztcblx0ICB9XG5cdFxuXHQgIHZhciBkb25lRW51bWVyYXRvciA9IFJ4LmRvbmVFbnVtZXJhdG9yID0geyBkb25lOiB0cnVlLCB2YWx1ZTogdW5kZWZpbmVkIH07XG5cdFxuXHQgIHZhciBpc0l0ZXJhYmxlID0gUnguaGVscGVycy5pc0l0ZXJhYmxlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgIHJldHVybiBvICYmIG9bJGl0ZXJhdG9yJF0gIT09IHVuZGVmaW5lZDtcblx0ICB9O1xuXHRcblx0ICB2YXIgaXNBcnJheUxpa2UgPSBSeC5oZWxwZXJzLmlzQXJyYXlMaWtlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgIHJldHVybiBvICYmIG8ubGVuZ3RoICE9PSB1bmRlZmluZWQ7XG5cdCAgfTtcblx0XG5cdCAgUnguaGVscGVycy5pdGVyYXRvciA9ICRpdGVyYXRvciQ7XG5cdFxuXHQgIHZhciBiaW5kQ2FsbGJhY2sgPSBSeC5pbnRlcm5hbHMuYmluZENhbGxiYWNrID0gZnVuY3Rpb24gKGZ1bmMsIHRoaXNBcmcsIGFyZ0NvdW50KSB7XG5cdCAgICBpZiAodHlwZW9mIHRoaXNBcmcgPT09ICd1bmRlZmluZWQnKSB7IHJldHVybiBmdW5jOyB9XG5cdCAgICBzd2l0Y2goYXJnQ291bnQpIHtcblx0ICAgICAgY2FzZSAwOlxuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgIHJldHVybiBmdW5jLmNhbGwodGhpc0FyZylcblx0ICAgICAgICB9O1xuXHQgICAgICBjYXNlIDE6XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGFyZykge1xuXHQgICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCBhcmcpO1xuXHQgICAgICAgIH1cblx0ICAgICAgY2FzZSAyOlxuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcblx0ICAgICAgICAgIHJldHVybiBmdW5jLmNhbGwodGhpc0FyZywgdmFsdWUsIGluZGV4KTtcblx0ICAgICAgICB9O1xuXHQgICAgICBjYXNlIDM6XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuXHQgICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuXHQgICAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzQXJnLCBhcmd1bWVudHMpO1xuXHQgICAgfTtcblx0ICB9O1xuXHRcblx0ICAvKiogVXNlZCB0byBkZXRlcm1pbmUgaWYgdmFsdWVzIGFyZSBvZiB0aGUgbGFuZ3VhZ2UgdHlwZSBPYmplY3QgKi9cblx0ICB2YXIgZG9udEVudW1zID0gWyd0b1N0cmluZycsXG5cdCAgICAndG9Mb2NhbGVTdHJpbmcnLFxuXHQgICAgJ3ZhbHVlT2YnLFxuXHQgICAgJ2hhc093blByb3BlcnR5Jyxcblx0ICAgICdpc1Byb3RvdHlwZU9mJyxcblx0ICAgICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsXG5cdCAgICAnY29uc3RydWN0b3InXSxcblx0ICBkb250RW51bXNMZW5ndGggPSBkb250RW51bXMubGVuZ3RoO1xuXHRcblx0ICAvKiogYE9iamVjdCN0b1N0cmluZ2AgcmVzdWx0IHNob3J0Y3V0cyAqL1xuXHQgIHZhciBhcmdzQ2xhc3MgPSAnW29iamVjdCBBcmd1bWVudHNdJyxcblx0ICAgIGFycmF5Q2xhc3MgPSAnW29iamVjdCBBcnJheV0nLFxuXHQgICAgYm9vbENsYXNzID0gJ1tvYmplY3QgQm9vbGVhbl0nLFxuXHQgICAgZGF0ZUNsYXNzID0gJ1tvYmplY3QgRGF0ZV0nLFxuXHQgICAgZXJyb3JDbGFzcyA9ICdbb2JqZWN0IEVycm9yXScsXG5cdCAgICBmdW5jQ2xhc3MgPSAnW29iamVjdCBGdW5jdGlvbl0nLFxuXHQgICAgbnVtYmVyQ2xhc3MgPSAnW29iamVjdCBOdW1iZXJdJyxcblx0ICAgIG9iamVjdENsYXNzID0gJ1tvYmplY3QgT2JqZWN0XScsXG5cdCAgICByZWdleHBDbGFzcyA9ICdbb2JqZWN0IFJlZ0V4cF0nLFxuXHQgICAgc3RyaW5nQ2xhc3MgPSAnW29iamVjdCBTdHJpbmddJztcblx0XG5cdCAgdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxcblx0ICAgIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxcblx0ICAgIHN1cHBvcnRzQXJnc0NsYXNzID0gdG9TdHJpbmcuY2FsbChhcmd1bWVudHMpID09IGFyZ3NDbGFzcywgLy8gRm9yIGxlc3MgPElFOSAmJiBGRjw0XG5cdCAgICBzdXBwb3J0Tm9kZUNsYXNzLFxuXHQgICAgZXJyb3JQcm90byA9IEVycm9yLnByb3RvdHlwZSxcblx0ICAgIG9iamVjdFByb3RvID0gT2JqZWN0LnByb3RvdHlwZSxcblx0ICAgIHN0cmluZ1Byb3RvID0gU3RyaW5nLnByb3RvdHlwZSxcblx0ICAgIHByb3BlcnR5SXNFbnVtZXJhYmxlID0gb2JqZWN0UHJvdG8ucHJvcGVydHlJc0VudW1lcmFibGU7XG5cdFxuXHQgIHRyeSB7XG5cdCAgICBzdXBwb3J0Tm9kZUNsYXNzID0gISh0b1N0cmluZy5jYWxsKGRvY3VtZW50KSA9PSBvYmplY3RDbGFzcyAmJiAhKHsgJ3RvU3RyaW5nJzogMCB9ICsgJycpKTtcblx0ICB9IGNhdGNoIChlKSB7XG5cdCAgICBzdXBwb3J0Tm9kZUNsYXNzID0gdHJ1ZTtcblx0ICB9XG5cdFxuXHQgIHZhciBub25FbnVtUHJvcHMgPSB7fTtcblx0ICBub25FbnVtUHJvcHNbYXJyYXlDbGFzc10gPSBub25FbnVtUHJvcHNbZGF0ZUNsYXNzXSA9IG5vbkVudW1Qcm9wc1tudW1iZXJDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUsICd0b0xvY2FsZVN0cmluZyc6IHRydWUsICd0b1N0cmluZyc6IHRydWUsICd2YWx1ZU9mJzogdHJ1ZSB9O1xuXHQgIG5vbkVudW1Qcm9wc1tib29sQ2xhc3NdID0gbm9uRW51bVByb3BzW3N0cmluZ0NsYXNzXSA9IHsgJ2NvbnN0cnVjdG9yJzogdHJ1ZSwgJ3RvU3RyaW5nJzogdHJ1ZSwgJ3ZhbHVlT2YnOiB0cnVlIH07XG5cdCAgbm9uRW51bVByb3BzW2Vycm9yQ2xhc3NdID0gbm9uRW51bVByb3BzW2Z1bmNDbGFzc10gPSBub25FbnVtUHJvcHNbcmVnZXhwQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlIH07XG5cdCAgbm9uRW51bVByb3BzW29iamVjdENsYXNzXSA9IHsgJ2NvbnN0cnVjdG9yJzogdHJ1ZSB9O1xuXHRcblx0ICB2YXIgc3VwcG9ydCA9IHt9O1xuXHQgIChmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgY3RvciA9IGZ1bmN0aW9uKCkgeyB0aGlzLnggPSAxOyB9LFxuXHQgICAgICBwcm9wcyA9IFtdO1xuXHRcblx0ICAgIGN0b3IucHJvdG90eXBlID0geyAndmFsdWVPZic6IDEsICd5JzogMSB9O1xuXHQgICAgZm9yICh2YXIga2V5IGluIG5ldyBjdG9yKSB7IHByb3BzLnB1c2goa2V5KTsgfVxuXHQgICAgZm9yIChrZXkgaW4gYXJndW1lbnRzKSB7IH1cblx0XG5cdCAgICAvLyBEZXRlY3QgaWYgYG5hbWVgIG9yIGBtZXNzYWdlYCBwcm9wZXJ0aWVzIG9mIGBFcnJvci5wcm90b3R5cGVgIGFyZSBlbnVtZXJhYmxlIGJ5IGRlZmF1bHQuXG5cdCAgICBzdXBwb3J0LmVudW1FcnJvclByb3BzID0gcHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlcnJvclByb3RvLCAnbWVzc2FnZScpIHx8IHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZXJyb3JQcm90bywgJ25hbWUnKTtcblx0XG5cdCAgICAvLyBEZXRlY3QgaWYgYHByb3RvdHlwZWAgcHJvcGVydGllcyBhcmUgZW51bWVyYWJsZSBieSBkZWZhdWx0LlxuXHQgICAgc3VwcG9ydC5lbnVtUHJvdG90eXBlcyA9IHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoY3RvciwgJ3Byb3RvdHlwZScpO1xuXHRcblx0ICAgIC8vIERldGVjdCBpZiBgYXJndW1lbnRzYCBvYmplY3QgaW5kZXhlcyBhcmUgbm9uLWVudW1lcmFibGVcblx0ICAgIHN1cHBvcnQubm9uRW51bUFyZ3MgPSBrZXkgIT0gMDtcblx0XG5cdCAgICAvLyBEZXRlY3QgaWYgcHJvcGVydGllcyBzaGFkb3dpbmcgdGhvc2Ugb24gYE9iamVjdC5wcm90b3R5cGVgIGFyZSBub24tZW51bWVyYWJsZS5cblx0ICAgIHN1cHBvcnQubm9uRW51bVNoYWRvd3MgPSAhL3ZhbHVlT2YvLnRlc3QocHJvcHMpO1xuXHQgIH0oMSkpO1xuXHRcblx0ICB2YXIgaXNPYmplY3QgPSBSeC5pbnRlcm5hbHMuaXNPYmplY3QgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsdWU7XG5cdCAgICByZXR1cm4gdmFsdWUgJiYgKHR5cGUgPT0gJ2Z1bmN0aW9uJyB8fCB0eXBlID09ICdvYmplY3QnKSB8fCBmYWxzZTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBrZXlzSW4ob2JqZWN0KSB7XG5cdCAgICB2YXIgcmVzdWx0ID0gW107XG5cdCAgICBpZiAoIWlzT2JqZWN0KG9iamVjdCkpIHtcblx0ICAgICAgcmV0dXJuIHJlc3VsdDtcblx0ICAgIH1cblx0ICAgIGlmIChzdXBwb3J0Lm5vbkVudW1BcmdzICYmIG9iamVjdC5sZW5ndGggJiYgaXNBcmd1bWVudHMob2JqZWN0KSkge1xuXHQgICAgICBvYmplY3QgPSBzbGljZS5jYWxsKG9iamVjdCk7XG5cdCAgICB9XG5cdCAgICB2YXIgc2tpcFByb3RvID0gc3VwcG9ydC5lbnVtUHJvdG90eXBlcyAmJiB0eXBlb2Ygb2JqZWN0ID09ICdmdW5jdGlvbicsXG5cdCAgICAgICAgc2tpcEVycm9yUHJvcHMgPSBzdXBwb3J0LmVudW1FcnJvclByb3BzICYmIChvYmplY3QgPT09IGVycm9yUHJvdG8gfHwgb2JqZWN0IGluc3RhbmNlb2YgRXJyb3IpO1xuXHRcblx0ICAgIGZvciAodmFyIGtleSBpbiBvYmplY3QpIHtcblx0ICAgICAgaWYgKCEoc2tpcFByb3RvICYmIGtleSA9PSAncHJvdG90eXBlJykgJiZcblx0ICAgICAgICAgICEoc2tpcEVycm9yUHJvcHMgJiYgKGtleSA9PSAnbWVzc2FnZScgfHwga2V5ID09ICduYW1lJykpKSB7XG5cdCAgICAgICAgcmVzdWx0LnB1c2goa2V5KTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGlmIChzdXBwb3J0Lm5vbkVudW1TaGFkb3dzICYmIG9iamVjdCAhPT0gb2JqZWN0UHJvdG8pIHtcblx0ICAgICAgdmFyIGN0b3IgPSBvYmplY3QuY29uc3RydWN0b3IsXG5cdCAgICAgICAgICBpbmRleCA9IC0xLFxuXHQgICAgICAgICAgbGVuZ3RoID0gZG9udEVudW1zTGVuZ3RoO1xuXHRcblx0ICAgICAgaWYgKG9iamVjdCA9PT0gKGN0b3IgJiYgY3Rvci5wcm90b3R5cGUpKSB7XG5cdCAgICAgICAgdmFyIGNsYXNzTmFtZSA9IG9iamVjdCA9PT0gc3RyaW5nUHJvdG8gPyBzdHJpbmdDbGFzcyA6IG9iamVjdCA9PT0gZXJyb3JQcm90byA/IGVycm9yQ2xhc3MgOiB0b1N0cmluZy5jYWxsKG9iamVjdCksXG5cdCAgICAgICAgICAgIG5vbkVudW0gPSBub25FbnVtUHJvcHNbY2xhc3NOYW1lXTtcblx0ICAgICAgfVxuXHQgICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuXHQgICAgICAgIGtleSA9IGRvbnRFbnVtc1tpbmRleF07XG5cdCAgICAgICAgaWYgKCEobm9uRW51bSAmJiBub25FbnVtW2tleV0pICYmIGhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBrZXkpKSB7XG5cdCAgICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHJlc3VsdDtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGludGVybmFsRm9yKG9iamVjdCwgY2FsbGJhY2ssIGtleXNGdW5jKSB7XG5cdCAgICB2YXIgaW5kZXggPSAtMSxcblx0ICAgICAgcHJvcHMgPSBrZXlzRnVuYyhvYmplY3QpLFxuXHQgICAgICBsZW5ndGggPSBwcm9wcy5sZW5ndGg7XG5cdFxuXHQgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcblx0ICAgICAgdmFyIGtleSA9IHByb3BzW2luZGV4XTtcblx0ICAgICAgaWYgKGNhbGxiYWNrKG9iamVjdFtrZXldLCBrZXksIG9iamVjdCkgPT09IGZhbHNlKSB7XG5cdCAgICAgICAgYnJlYWs7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiBvYmplY3Q7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBpbnRlcm5hbEZvckluKG9iamVjdCwgY2FsbGJhY2spIHtcblx0ICAgIHJldHVybiBpbnRlcm5hbEZvcihvYmplY3QsIGNhbGxiYWNrLCBrZXlzSW4pO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gaXNOb2RlKHZhbHVlKSB7XG5cdCAgICAvLyBJRSA8IDkgcHJlc2VudHMgRE9NIG5vZGVzIGFzIGBPYmplY3RgIG9iamVjdHMgZXhjZXB0IHRoZXkgaGF2ZSBgdG9TdHJpbmdgXG5cdCAgICAvLyBtZXRob2RzIHRoYXQgYXJlIGB0eXBlb2ZgIFwic3RyaW5nXCIgYW5kIHN0aWxsIGNhbiBjb2VyY2Ugbm9kZXMgdG8gc3RyaW5nc1xuXHQgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZS50b1N0cmluZyAhPSAnZnVuY3Rpb24nICYmIHR5cGVvZiAodmFsdWUgKyAnJykgPT0gJ3N0cmluZyc7XG5cdCAgfVxuXHRcblx0ICB2YXIgaXNBcmd1bWVudHMgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgcmV0dXJuICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcpID8gdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gYXJnc0NsYXNzIDogZmFsc2U7XG5cdCAgfVxuXHRcblx0ICAvLyBmYWxsYmFjayBmb3IgYnJvd3NlcnMgdGhhdCBjYW4ndCBkZXRlY3QgYGFyZ3VtZW50c2Agb2JqZWN0cyBieSBbW0NsYXNzXV1cblx0ICBpZiAoIXN1cHBvcnRzQXJnc0NsYXNzKSB7XG5cdCAgICBpc0FyZ3VtZW50cyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgIHJldHVybiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnKSA/IGhhc093blByb3BlcnR5LmNhbGwodmFsdWUsICdjYWxsZWUnKSA6IGZhbHNlO1xuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIHZhciBpc0VxdWFsID0gUnguaW50ZXJuYWxzLmlzRXF1YWwgPSBmdW5jdGlvbiAoeCwgeSkge1xuXHQgICAgcmV0dXJuIGRlZXBFcXVhbHMoeCwgeSwgW10sIFtdKTtcblx0ICB9O1xuXHRcblx0ICAvKiogQHByaXZhdGVcblx0ICAgKiBVc2VkIGZvciBkZWVwIGNvbXBhcmlzb25cblx0ICAgKiovXG5cdCAgZnVuY3Rpb24gZGVlcEVxdWFscyhhLCBiLCBzdGFja0EsIHN0YWNrQikge1xuXHQgICAgLy8gZXhpdCBlYXJseSBmb3IgaWRlbnRpY2FsIHZhbHVlc1xuXHQgICAgaWYgKGEgPT09IGIpIHtcblx0ICAgICAgLy8gdHJlYXQgYCswYCB2cy4gYC0wYCBhcyBub3QgZXF1YWxcblx0ICAgICAgcmV0dXJuIGEgIT09IDAgfHwgKDEgLyBhID09IDEgLyBiKTtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgdHlwZSA9IHR5cGVvZiBhLFxuXHQgICAgICAgIG90aGVyVHlwZSA9IHR5cGVvZiBiO1xuXHRcblx0ICAgIC8vIGV4aXQgZWFybHkgZm9yIHVubGlrZSBwcmltaXRpdmUgdmFsdWVzXG5cdCAgICBpZiAoYSA9PT0gYSAmJiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCB8fFxuXHQgICAgICAgICh0eXBlICE9ICdmdW5jdGlvbicgJiYgdHlwZSAhPSAnb2JqZWN0JyAmJiBvdGhlclR5cGUgIT0gJ2Z1bmN0aW9uJyAmJiBvdGhlclR5cGUgIT0gJ29iamVjdCcpKSkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gY29tcGFyZSBbW0NsYXNzXV0gbmFtZXNcblx0ICAgIHZhciBjbGFzc05hbWUgPSB0b1N0cmluZy5jYWxsKGEpLFxuXHQgICAgICAgIG90aGVyQ2xhc3MgPSB0b1N0cmluZy5jYWxsKGIpO1xuXHRcblx0ICAgIGlmIChjbGFzc05hbWUgPT0gYXJnc0NsYXNzKSB7XG5cdCAgICAgIGNsYXNzTmFtZSA9IG9iamVjdENsYXNzO1xuXHQgICAgfVxuXHQgICAgaWYgKG90aGVyQ2xhc3MgPT0gYXJnc0NsYXNzKSB7XG5cdCAgICAgIG90aGVyQ2xhc3MgPSBvYmplY3RDbGFzcztcblx0ICAgIH1cblx0ICAgIGlmIChjbGFzc05hbWUgIT0gb3RoZXJDbGFzcykge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdCAgICBzd2l0Y2ggKGNsYXNzTmFtZSkge1xuXHQgICAgICBjYXNlIGJvb2xDbGFzczpcblx0ICAgICAgY2FzZSBkYXRlQ2xhc3M6XG5cdCAgICAgICAgLy8gY29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1iZXJzLCBkYXRlcyB0byBtaWxsaXNlY29uZHMgYW5kIGJvb2xlYW5zXG5cdCAgICAgICAgLy8gdG8gYDFgIG9yIGAwYCB0cmVhdGluZyBpbnZhbGlkIGRhdGVzIGNvZXJjZWQgdG8gYE5hTmAgYXMgbm90IGVxdWFsXG5cdCAgICAgICAgcmV0dXJuICthID09ICtiO1xuXHRcblx0ICAgICAgY2FzZSBudW1iZXJDbGFzczpcblx0ICAgICAgICAvLyB0cmVhdCBgTmFOYCB2cy4gYE5hTmAgYXMgZXF1YWxcblx0ICAgICAgICByZXR1cm4gKGEgIT0gK2EpID9cblx0ICAgICAgICAgIGIgIT0gK2IgOlxuXHQgICAgICAgICAgLy8gYnV0IHRyZWF0IGAtMGAgdnMuIGArMGAgYXMgbm90IGVxdWFsXG5cdCAgICAgICAgICAoYSA9PSAwID8gKDEgLyBhID09IDEgLyBiKSA6IGEgPT0gK2IpO1xuXHRcblx0ICAgICAgY2FzZSByZWdleHBDbGFzczpcblx0ICAgICAgY2FzZSBzdHJpbmdDbGFzczpcblx0ICAgICAgICAvLyBjb2VyY2UgcmVnZXhlcyB0byBzdHJpbmdzIChodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDE1LjEwLjYuNClcblx0ICAgICAgICAvLyB0cmVhdCBzdHJpbmcgcHJpbWl0aXZlcyBhbmQgdGhlaXIgY29ycmVzcG9uZGluZyBvYmplY3QgaW5zdGFuY2VzIGFzIGVxdWFsXG5cdCAgICAgICAgcmV0dXJuIGEgPT0gU3RyaW5nKGIpO1xuXHQgICAgfVxuXHQgICAgdmFyIGlzQXJyID0gY2xhc3NOYW1lID09IGFycmF5Q2xhc3M7XG5cdCAgICBpZiAoIWlzQXJyKSB7XG5cdFxuXHQgICAgICAvLyBleGl0IGZvciBmdW5jdGlvbnMgYW5kIERPTSBub2Rlc1xuXHQgICAgICBpZiAoY2xhc3NOYW1lICE9IG9iamVjdENsYXNzIHx8ICghc3VwcG9ydC5ub2RlQ2xhc3MgJiYgKGlzTm9kZShhKSB8fCBpc05vZGUoYikpKSkge1xuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfVxuXHQgICAgICAvLyBpbiBvbGRlciB2ZXJzaW9ucyBvZiBPcGVyYSwgYGFyZ3VtZW50c2Agb2JqZWN0cyBoYXZlIGBBcnJheWAgY29uc3RydWN0b3JzXG5cdCAgICAgIHZhciBjdG9yQSA9ICFzdXBwb3J0LmFyZ3NPYmplY3QgJiYgaXNBcmd1bWVudHMoYSkgPyBPYmplY3QgOiBhLmNvbnN0cnVjdG9yLFxuXHQgICAgICAgICAgY3RvckIgPSAhc3VwcG9ydC5hcmdzT2JqZWN0ICYmIGlzQXJndW1lbnRzKGIpID8gT2JqZWN0IDogYi5jb25zdHJ1Y3Rvcjtcblx0XG5cdCAgICAgIC8vIG5vbiBgT2JqZWN0YCBvYmplY3QgaW5zdGFuY2VzIHdpdGggZGlmZmVyZW50IGNvbnN0cnVjdG9ycyBhcmUgbm90IGVxdWFsXG5cdCAgICAgIGlmIChjdG9yQSAhPSBjdG9yQiAmJlxuXHQgICAgICAgICAgICAhKGhhc093blByb3BlcnR5LmNhbGwoYSwgJ2NvbnN0cnVjdG9yJykgJiYgaGFzT3duUHJvcGVydHkuY2FsbChiLCAnY29uc3RydWN0b3InKSkgJiZcblx0ICAgICAgICAgICAgIShpc0Z1bmN0aW9uKGN0b3JBKSAmJiBjdG9yQSBpbnN0YW5jZW9mIGN0b3JBICYmIGlzRnVuY3Rpb24oY3RvckIpICYmIGN0b3JCIGluc3RhbmNlb2YgY3RvckIpICYmXG5cdCAgICAgICAgICAgICgnY29uc3RydWN0b3InIGluIGEgJiYgJ2NvbnN0cnVjdG9yJyBpbiBiKVxuXHQgICAgICAgICAgKSB7XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICAvLyBhc3N1bWUgY3ljbGljIHN0cnVjdHVyZXMgYXJlIGVxdWFsXG5cdCAgICAvLyB0aGUgYWxnb3JpdGhtIGZvciBkZXRlY3RpbmcgY3ljbGljIHN0cnVjdHVyZXMgaXMgYWRhcHRlZCBmcm9tIEVTIDUuMVxuXHQgICAgLy8gc2VjdGlvbiAxNS4xMi4zLCBhYnN0cmFjdCBvcGVyYXRpb24gYEpPYCAoaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS4xMi4zKVxuXHQgICAgdmFyIGluaXRlZFN0YWNrID0gIXN0YWNrQTtcblx0ICAgIHN0YWNrQSB8fCAoc3RhY2tBID0gW10pO1xuXHQgICAgc3RhY2tCIHx8IChzdGFja0IgPSBbXSk7XG5cdFxuXHQgICAgdmFyIGxlbmd0aCA9IHN0YWNrQS5sZW5ndGg7XG5cdCAgICB3aGlsZSAobGVuZ3RoLS0pIHtcblx0ICAgICAgaWYgKHN0YWNrQVtsZW5ndGhdID09IGEpIHtcblx0ICAgICAgICByZXR1cm4gc3RhY2tCW2xlbmd0aF0gPT0gYjtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgdmFyIHNpemUgPSAwO1xuXHQgICAgdmFyIHJlc3VsdCA9IHRydWU7XG5cdFxuXHQgICAgLy8gYWRkIGBhYCBhbmQgYGJgIHRvIHRoZSBzdGFjayBvZiB0cmF2ZXJzZWQgb2JqZWN0c1xuXHQgICAgc3RhY2tBLnB1c2goYSk7XG5cdCAgICBzdGFja0IucHVzaChiKTtcblx0XG5cdCAgICAvLyByZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgYW5kIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG5cdCAgICBpZiAoaXNBcnIpIHtcblx0ICAgICAgLy8gY29tcGFyZSBsZW5ndGhzIHRvIGRldGVybWluZSBpZiBhIGRlZXAgY29tcGFyaXNvbiBpcyBuZWNlc3Nhcnlcblx0ICAgICAgbGVuZ3RoID0gYS5sZW5ndGg7XG5cdCAgICAgIHNpemUgPSBiLmxlbmd0aDtcblx0ICAgICAgcmVzdWx0ID0gc2l6ZSA9PSBsZW5ndGg7XG5cdFxuXHQgICAgICBpZiAocmVzdWx0KSB7XG5cdCAgICAgICAgLy8gZGVlcCBjb21wYXJlIHRoZSBjb250ZW50cywgaWdub3Jpbmcgbm9uLW51bWVyaWMgcHJvcGVydGllc1xuXHQgICAgICAgIHdoaWxlIChzaXplLS0pIHtcblx0ICAgICAgICAgIHZhciBpbmRleCA9IGxlbmd0aCxcblx0ICAgICAgICAgICAgICB2YWx1ZSA9IGJbc2l6ZV07XG5cdFxuXHQgICAgICAgICAgaWYgKCEocmVzdWx0ID0gZGVlcEVxdWFscyhhW3NpemVdLCB2YWx1ZSwgc3RhY2tBLCBzdGFja0IpKSkge1xuXHQgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIGVsc2Uge1xuXHQgICAgICAvLyBkZWVwIGNvbXBhcmUgb2JqZWN0cyB1c2luZyBgZm9ySW5gLCBpbnN0ZWFkIG9mIGBmb3JPd25gLCB0byBhdm9pZCBgT2JqZWN0LmtleXNgXG5cdCAgICAgIC8vIHdoaWNoLCBpbiB0aGlzIGNhc2UsIGlzIG1vcmUgY29zdGx5XG5cdCAgICAgIGludGVybmFsRm9ySW4oYiwgZnVuY3Rpb24odmFsdWUsIGtleSwgYikge1xuXHQgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIGtleSkpIHtcblx0ICAgICAgICAgIC8vIGNvdW50IHRoZSBudW1iZXIgb2YgcHJvcGVydGllcy5cblx0ICAgICAgICAgIHNpemUrKztcblx0ICAgICAgICAgIC8vIGRlZXAgY29tcGFyZSBlYWNoIHByb3BlcnR5IHZhbHVlLlxuXHQgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKGEsIGtleSkgJiYgZGVlcEVxdWFscyhhW2tleV0sIHZhbHVlLCBzdGFja0EsIHN0YWNrQikpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBpZiAocmVzdWx0KSB7XG5cdCAgICAgICAgLy8gZW5zdXJlIGJvdGggb2JqZWN0cyBoYXZlIHRoZSBzYW1lIG51bWJlciBvZiBwcm9wZXJ0aWVzXG5cdCAgICAgICAgaW50ZXJuYWxGb3JJbihhLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBhKSB7XG5cdCAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChhLCBrZXkpKSB7XG5cdCAgICAgICAgICAgIC8vIGBzaXplYCB3aWxsIGJlIGAtMWAgaWYgYGFgIGhhcyBtb3JlIHByb3BlcnRpZXMgdGhhbiBgYmBcblx0ICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSAtLXNpemUgPiAtMSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHN0YWNrQS5wb3AoKTtcblx0ICAgIHN0YWNrQi5wb3AoKTtcblx0XG5cdCAgICByZXR1cm4gcmVzdWx0O1xuXHQgIH1cblx0XG5cdCAgdmFyIGhhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSxcblx0ICAgICAgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cdFxuXHQgIHZhciBpbmhlcml0cyA9IFJ4LmludGVybmFscy5pbmhlcml0cyA9IGZ1bmN0aW9uIChjaGlsZCwgcGFyZW50KSB7XG5cdCAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9XG5cdCAgICBfXy5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlO1xuXHQgICAgY2hpbGQucHJvdG90eXBlID0gbmV3IF9fKCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIGFkZFByb3BlcnRpZXMgPSBSeC5pbnRlcm5hbHMuYWRkUHJvcGVydGllcyA9IGZ1bmN0aW9uIChvYmopIHtcblx0ICAgIGZvcih2YXIgc291cmNlcyA9IFtdLCBpID0gMSwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG5cdCAgICBmb3IgKHZhciBpZHggPSAwLCBsbiA9IHNvdXJjZXMubGVuZ3RoOyBpZHggPCBsbjsgaWR4KyspIHtcblx0ICAgICAgdmFyIHNvdXJjZSA9IHNvdXJjZXNbaWR4XTtcblx0ICAgICAgZm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpIHtcblx0ICAgICAgICBvYmpbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvLyBSeCBVdGlsc1xuXHQgIHZhciBhZGRSZWYgPSBSeC5pbnRlcm5hbHMuYWRkUmVmID0gZnVuY3Rpb24gKHhzLCByKSB7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShyLmdldERpc3Bvc2FibGUoKSwgeHMuc3Vic2NyaWJlKG9ic2VydmVyKSk7XG5cdCAgICB9KTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBhcnJheUluaXRpYWxpemUoY291bnQsIGZhY3RvcnkpIHtcblx0ICAgIHZhciBhID0gbmV3IEFycmF5KGNvdW50KTtcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuXHQgICAgICBhW2ldID0gZmFjdG9yeSgpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIGE7XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiBSZXByZXNlbnRzIGEgZ3JvdXAgb2YgZGlzcG9zYWJsZSByZXNvdXJjZXMgdGhhdCBhcmUgZGlzcG9zZWQgdG9nZXRoZXIuXG5cdCAgICogQGNvbnN0cnVjdG9yXG5cdCAgICovXG5cdCAgdmFyIENvbXBvc2l0ZURpc3Bvc2FibGUgPSBSeC5Db21wb3NpdGVEaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGFyZ3MgPSBbXSwgaSwgbGVuO1xuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuXHQgICAgICBhcmdzID0gYXJndW1lbnRzWzBdO1xuXHQgICAgICBsZW4gPSBhcmdzLmxlbmd0aDtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cdCAgICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgICAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgfVxuXHQgICAgdGhpcy5kaXNwb3NhYmxlcyA9IGFyZ3M7XG5cdCAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgIHRoaXMubGVuZ3RoID0gYXJncy5sZW5ndGg7XG5cdCAgfTtcblx0XG5cdCAgdmFyIENvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUgPSBDb21wb3NpdGVEaXNwb3NhYmxlLnByb3RvdHlwZTtcblx0XG5cdCAgLyoqXG5cdCAgICogQWRkcyBhIGRpc3Bvc2FibGUgdG8gdGhlIENvbXBvc2l0ZURpc3Bvc2FibGUgb3IgZGlzcG9zZXMgdGhlIGRpc3Bvc2FibGUgaWYgdGhlIENvbXBvc2l0ZURpc3Bvc2FibGUgaXMgZGlzcG9zZWQuXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gaXRlbSBEaXNwb3NhYmxlIHRvIGFkZC5cblx0ICAgKi9cblx0ICBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cdCAgICBpZiAodGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIGl0ZW0uZGlzcG9zZSgpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGhpcy5kaXNwb3NhYmxlcy5wdXNoKGl0ZW0pO1xuXHQgICAgICB0aGlzLmxlbmd0aCsrO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJlbW92ZXMgYW5kIGRpc3Bvc2VzIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGEgZGlzcG9zYWJsZSBmcm9tIHRoZSBDb21wb3NpdGVEaXNwb3NhYmxlLlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IGl0ZW0gRGlzcG9zYWJsZSB0byByZW1vdmUuXG5cdCAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgaWYgZm91bmQ7IGZhbHNlIG90aGVyd2lzZS5cblx0ICAgKi9cblx0ICBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cdCAgICB2YXIgc2hvdWxkRGlzcG9zZSA9IGZhbHNlO1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdmFyIGlkeCA9IHRoaXMuZGlzcG9zYWJsZXMuaW5kZXhPZihpdGVtKTtcblx0ICAgICAgaWYgKGlkeCAhPT0gLTEpIHtcblx0ICAgICAgICBzaG91bGREaXNwb3NlID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmRpc3Bvc2FibGVzLnNwbGljZShpZHgsIDEpO1xuXHQgICAgICAgIHRoaXMubGVuZ3RoLS07XG5cdCAgICAgICAgaXRlbS5kaXNwb3NlKCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiBzaG91bGREaXNwb3NlO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBEaXNwb3NlcyBhbGwgZGlzcG9zYWJsZXMgaW4gdGhlIGdyb3VwIGFuZCByZW1vdmVzIHRoZW0gZnJvbSB0aGUgZ3JvdXAuXG5cdCAgICovXG5cdCAgQ29tcG9zaXRlRGlzcG9zYWJsZVByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgdmFyIGxlbiA9IHRoaXMuZGlzcG9zYWJsZXMubGVuZ3RoLCBjdXJyZW50RGlzcG9zYWJsZXMgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGN1cnJlbnREaXNwb3NhYmxlc1tpXSA9IHRoaXMuZGlzcG9zYWJsZXNbaV07IH1cblx0ICAgICAgdGhpcy5kaXNwb3NhYmxlcyA9IFtdO1xuXHQgICAgICB0aGlzLmxlbmd0aCA9IDA7XG5cdFxuXHQgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICBjdXJyZW50RGlzcG9zYWJsZXNbaV0uZGlzcG9zZSgpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUHJvdmlkZXMgYSBzZXQgb2Ygc3RhdGljIG1ldGhvZHMgZm9yIGNyZWF0aW5nIERpc3Bvc2FibGVzLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IGRpc3Bvc2UgQWN0aW9uIHRvIHJ1biBkdXJpbmcgdGhlIGZpcnN0IGNhbGwgdG8gZGlzcG9zZS4gVGhlIGFjdGlvbiBpcyBndWFyYW50ZWVkIHRvIGJlIHJ1biBhdCBtb3N0IG9uY2UuXG5cdCAgICovXG5cdCAgdmFyIERpc3Bvc2FibGUgPSBSeC5EaXNwb3NhYmxlID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXHQgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbiB8fCBub29wO1xuXHQgIH07XG5cdFxuXHQgIC8qKiBQZXJmb3JtcyB0aGUgdGFzayBvZiBjbGVhbmluZyB1cCByZXNvdXJjZXMuICovXG5cdCAgRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHRoaXMuYWN0aW9uKCk7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ3JlYXRlcyBhIGRpc3Bvc2FibGUgb2JqZWN0IHRoYXQgaW52b2tlcyB0aGUgc3BlY2lmaWVkIGFjdGlvbiB3aGVuIGRpc3Bvc2VkLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IGRpc3Bvc2UgQWN0aW9uIHRvIHJ1biBkdXJpbmcgdGhlIGZpcnN0IGNhbGwgdG8gZGlzcG9zZS4gVGhlIGFjdGlvbiBpcyBndWFyYW50ZWVkIHRvIGJlIHJ1biBhdCBtb3N0IG9uY2UuXG5cdCAgICogQHJldHVybiB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHRoYXQgcnVucyB0aGUgZ2l2ZW4gYWN0aW9uIHVwb24gZGlzcG9zYWwuXG5cdCAgICovXG5cdCAgdmFyIGRpc3Bvc2FibGVDcmVhdGUgPSBEaXNwb3NhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChhY3Rpb24pIHsgcmV0dXJuIG5ldyBEaXNwb3NhYmxlKGFjdGlvbik7IH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEdldHMgdGhlIGRpc3Bvc2FibGUgdGhhdCBkb2VzIG5vdGhpbmcgd2hlbiBkaXNwb3NlZC5cblx0ICAgKi9cblx0ICB2YXIgZGlzcG9zYWJsZUVtcHR5ID0gRGlzcG9zYWJsZS5lbXB0eSA9IHsgZGlzcG9zZTogbm9vcCB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBWYWxpZGF0ZXMgd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgZGlzcG9zYWJsZVxuXHQgICAqIEBwYXJhbSB7T2JqZWN0fSBPYmplY3QgdG8gdGVzdCB3aGV0aGVyIGl0IGhhcyBhIGRpc3Bvc2UgbWV0aG9kXG5cdCAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgaWYgYSBkaXNwb3NhYmxlIG9iamVjdCwgZWxzZSBmYWxzZS5cblx0ICAgKi9cblx0ICB2YXIgaXNEaXNwb3NhYmxlID0gRGlzcG9zYWJsZS5pc0Rpc3Bvc2FibGUgPSBmdW5jdGlvbiAoZCkge1xuXHQgICAgcmV0dXJuIGQgJiYgaXNGdW5jdGlvbihkLmRpc3Bvc2UpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBjaGVja0Rpc3Bvc2VkID0gRGlzcG9zYWJsZS5jaGVja0Rpc3Bvc2VkID0gZnVuY3Rpb24gKGRpc3Bvc2FibGUpIHtcblx0ICAgIGlmIChkaXNwb3NhYmxlLmlzRGlzcG9zZWQpIHsgdGhyb3cgbmV3IE9iamVjdERpc3Bvc2VkRXJyb3IoKTsgfVxuXHQgIH07XG5cdFxuXHQgIHZhciBkaXNwb3NhYmxlRml4dXAgPSBEaXNwb3NhYmxlLl9maXh1cCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcblx0ICAgIHJldHVybiBpc0Rpc3Bvc2FibGUocmVzdWx0KSA/IHJlc3VsdCA6IGRpc3Bvc2FibGVFbXB0eTtcblx0ICB9O1xuXHRcblx0ICAvLyBTaW5nbGUgYXNzaWdubWVudFxuXHQgIHZhciBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSA9IFJ4LlNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuXHQgIH07XG5cdCAgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUucHJvdG90eXBlLmdldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcy5jdXJyZW50O1xuXHQgIH07XG5cdCAgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUucHJvdG90eXBlLnNldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgIGlmICh0aGlzLmN1cnJlbnQpIHsgdGhyb3cgbmV3IEVycm9yKCdEaXNwb3NhYmxlIGhhcyBhbHJlYWR5IGJlZW4gYXNzaWduZWQnKTsgfVxuXHQgICAgdmFyIHNob3VsZERpc3Bvc2UgPSB0aGlzLmlzRGlzcG9zZWQ7XG5cdCAgICAhc2hvdWxkRGlzcG9zZSAmJiAodGhpcy5jdXJyZW50ID0gdmFsdWUpO1xuXHQgICAgc2hvdWxkRGlzcG9zZSAmJiB2YWx1ZSAmJiB2YWx1ZS5kaXNwb3NlKCk7XG5cdCAgfTtcblx0ICBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgIHZhciBvbGQgPSB0aGlzLmN1cnJlbnQ7XG5cdCAgICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG5cdCAgICAgIG9sZCAmJiBvbGQuZGlzcG9zZSgpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8vIE11bHRpcGxlIGFzc2lnbm1lbnQgZGlzcG9zYWJsZVxuXHQgIHZhciBTZXJpYWxEaXNwb3NhYmxlID0gUnguU2VyaWFsRGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcblx0ICB9O1xuXHQgIFNlcmlhbERpc3Bvc2FibGUucHJvdG90eXBlLmdldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcy5jdXJyZW50O1xuXHQgIH07XG5cdCAgU2VyaWFsRGlzcG9zYWJsZS5wcm90b3R5cGUuc2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgdmFyIHNob3VsZERpc3Bvc2UgPSB0aGlzLmlzRGlzcG9zZWQ7XG5cdCAgICBpZiAoIXNob3VsZERpc3Bvc2UpIHtcblx0ICAgICAgdmFyIG9sZCA9IHRoaXMuY3VycmVudDtcblx0ICAgICAgdGhpcy5jdXJyZW50ID0gdmFsdWU7XG5cdCAgICB9XG5cdCAgICBvbGQgJiYgb2xkLmRpc3Bvc2UoKTtcblx0ICAgIHNob3VsZERpc3Bvc2UgJiYgdmFsdWUgJiYgdmFsdWUuZGlzcG9zZSgpO1xuXHQgIH07XG5cdCAgU2VyaWFsRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgIHZhciBvbGQgPSB0aGlzLmN1cnJlbnQ7XG5cdCAgICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG5cdCAgICB9XG5cdCAgICBvbGQgJiYgb2xkLmRpc3Bvc2UoKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgQmluYXJ5RGlzcG9zYWJsZSA9IFJ4LkJpbmFyeURpc3Bvc2FibGUgPSBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuXHQgICAgdGhpcy5fZmlyc3QgPSBmaXJzdDtcblx0ICAgIHRoaXMuX3NlY29uZCA9IHNlY29uZDtcblx0ICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgIH07XG5cdFxuXHQgIEJpbmFyeURpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICB2YXIgb2xkMSA9IHRoaXMuX2ZpcnN0O1xuXHQgICAgICB0aGlzLl9maXJzdCA9IG51bGw7XG5cdCAgICAgIG9sZDEgJiYgb2xkMS5kaXNwb3NlKCk7XG5cdCAgICAgIHZhciBvbGQyID0gdGhpcy5fc2Vjb25kO1xuXHQgICAgICB0aGlzLl9zZWNvbmQgPSBudWxsO1xuXHQgICAgICBvbGQyICYmIG9sZDIuZGlzcG9zZSgpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIHZhciBOQXJ5RGlzcG9zYWJsZSA9IFJ4Lk5BcnlEaXNwb3NhYmxlID0gZnVuY3Rpb24gKGRpc3Bvc2FibGVzKSB7XG5cdCAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IGRpc3Bvc2FibGVzO1xuXHQgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgfTtcblx0XG5cdCAgTkFyeURpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5fZGlzcG9zYWJsZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICB0aGlzLl9kaXNwb3NhYmxlc1tpXS5kaXNwb3NlKCk7XG5cdCAgICAgIH1cblx0ICAgICAgdGhpcy5fZGlzcG9zYWJsZXMubGVuZ3RoID0gMDtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXByZXNlbnRzIGEgZGlzcG9zYWJsZSByZXNvdXJjZSB0aGF0IG9ubHkgZGlzcG9zZXMgaXRzIHVuZGVybHlpbmcgZGlzcG9zYWJsZSByZXNvdXJjZSB3aGVuIGFsbCBkZXBlbmRlbnQgZGlzcG9zYWJsZSBvYmplY3RzIGhhdmUgYmVlbiBkaXNwb3NlZC5cblx0ICAgKi9cblx0ICB2YXIgUmVmQ291bnREaXNwb3NhYmxlID0gUnguUmVmQ291bnREaXNwb3NhYmxlID0gKGZ1bmN0aW9uICgpIHtcblx0XG5cdCAgICBmdW5jdGlvbiBJbm5lckRpc3Bvc2FibGUoZGlzcG9zYWJsZSkge1xuXHQgICAgICB0aGlzLmRpc3Bvc2FibGUgPSBkaXNwb3NhYmxlO1xuXHQgICAgICB0aGlzLmRpc3Bvc2FibGUuY291bnQrKztcblx0ICAgICAgdGhpcy5pc0lubmVyRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICBJbm5lckRpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmICghdGhpcy5kaXNwb3NhYmxlLmlzRGlzcG9zZWQgJiYgIXRoaXMuaXNJbm5lckRpc3Bvc2VkKSB7XG5cdCAgICAgICAgdGhpcy5pc0lubmVyRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZGlzcG9zYWJsZS5jb3VudC0tO1xuXHQgICAgICAgIGlmICh0aGlzLmRpc3Bvc2FibGUuY291bnQgPT09IDAgJiYgdGhpcy5kaXNwb3NhYmxlLmlzUHJpbWFyeURpc3Bvc2VkKSB7XG5cdCAgICAgICAgICB0aGlzLmRpc3Bvc2FibGUuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLmRpc3Bvc2FibGUudW5kZXJseWluZ0Rpc3Bvc2FibGUuZGlzcG9zZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBSZWZDb3VudERpc3Bvc2FibGUgd2l0aCB0aGUgc3BlY2lmaWVkIGRpc3Bvc2FibGUuXG5cdCAgICAgKiBAY29uc3RydWN0b3Jcblx0ICAgICAqIEBwYXJhbSB7RGlzcG9zYWJsZX0gZGlzcG9zYWJsZSBVbmRlcmx5aW5nIGRpc3Bvc2FibGUuXG5cdCAgICAgICovXG5cdCAgICBmdW5jdGlvbiBSZWZDb3VudERpc3Bvc2FibGUoZGlzcG9zYWJsZSkge1xuXHQgICAgICB0aGlzLnVuZGVybHlpbmdEaXNwb3NhYmxlID0gZGlzcG9zYWJsZTtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaXNQcmltYXJ5RGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5jb3VudCA9IDA7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBEaXNwb3NlcyB0aGUgdW5kZXJseWluZyBkaXNwb3NhYmxlIG9ubHkgd2hlbiBhbGwgZGVwZW5kZW50IGRpc3Bvc2FibGVzIGhhdmUgYmVlbiBkaXNwb3NlZFxuXHQgICAgICovXG5cdCAgICBSZWZDb3VudERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkICYmICF0aGlzLmlzUHJpbWFyeURpc3Bvc2VkKSB7XG5cdCAgICAgICAgdGhpcy5pc1ByaW1hcnlEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgaWYgKHRoaXMuY291bnQgPT09IDApIHtcblx0ICAgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLnVuZGVybHlpbmdEaXNwb3NhYmxlLmRpc3Bvc2UoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm5zIGEgZGVwZW5kZW50IGRpc3Bvc2FibGUgdGhhdCB3aGVuIGRpc3Bvc2VkIGRlY3JlYXNlcyB0aGUgcmVmY291bnQgb24gdGhlIHVuZGVybHlpbmcgZGlzcG9zYWJsZS5cblx0ICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBBIGRlcGVuZGVudCBkaXNwb3NhYmxlIGNvbnRyaWJ1dGluZyB0byB0aGUgcmVmZXJlbmNlIGNvdW50IHRoYXQgbWFuYWdlcyB0aGUgdW5kZXJseWluZyBkaXNwb3NhYmxlJ3MgbGlmZXRpbWUuXG5cdCAgICAgKi9cblx0ICAgIFJlZkNvdW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuaXNEaXNwb3NlZCA/IGRpc3Bvc2FibGVFbXB0eSA6IG5ldyBJbm5lckRpc3Bvc2FibGUodGhpcyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBSZWZDb3VudERpc3Bvc2FibGU7XG5cdCAgfSkoKTtcblx0XG5cdCAgdmFyIFNjaGVkdWxlZEl0ZW0gPSBSeC5pbnRlcm5hbHMuU2NoZWR1bGVkSXRlbSA9IGZ1bmN0aW9uIChzY2hlZHVsZXIsIHN0YXRlLCBhY3Rpb24sIGR1ZVRpbWUsIGNvbXBhcmVyKSB7XG5cdCAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcblx0ICAgIHRoaXMuYWN0aW9uID0gYWN0aW9uO1xuXHQgICAgdGhpcy5kdWVUaW1lID0gZHVlVGltZTtcblx0ICAgIHRoaXMuY29tcGFyZXIgPSBjb21wYXJlciB8fCBkZWZhdWx0U3ViQ29tcGFyZXI7XG5cdCAgICB0aGlzLmRpc3Bvc2FibGUgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICB9XG5cdFxuXHQgIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmludm9rZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHRoaXMuZGlzcG9zYWJsZS5zZXREaXNwb3NhYmxlKHRoaXMuaW52b2tlQ29yZSgpKTtcblx0ICB9O1xuXHRcblx0ICBTY2hlZHVsZWRJdGVtLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcblx0ICAgIHJldHVybiB0aGlzLmNvbXBhcmVyKHRoaXMuZHVlVGltZSwgb3RoZXIuZHVlVGltZSk7XG5cdCAgfTtcblx0XG5cdCAgU2NoZWR1bGVkSXRlbS5wcm90b3R5cGUuaXNDYW5jZWxsZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcy5kaXNwb3NhYmxlLmlzRGlzcG9zZWQ7XG5cdCAgfTtcblx0XG5cdCAgU2NoZWR1bGVkSXRlbS5wcm90b3R5cGUuaW52b2tlQ29yZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBkaXNwb3NhYmxlRml4dXAodGhpcy5hY3Rpb24odGhpcy5zY2hlZHVsZXIsIHRoaXMuc3RhdGUpKTtcblx0ICB9O1xuXHRcblx0ICAvKiogUHJvdmlkZXMgYSBzZXQgb2Ygc3RhdGljIHByb3BlcnRpZXMgdG8gYWNjZXNzIGNvbW1vbmx5IHVzZWQgc2NoZWR1bGVycy4gKi9cblx0ICB2YXIgU2NoZWR1bGVyID0gUnguU2NoZWR1bGVyID0gKGZ1bmN0aW9uICgpIHtcblx0XG5cdCAgICBmdW5jdGlvbiBTY2hlZHVsZXIoKSB7IH1cblx0XG5cdCAgICAvKiogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBnaXZlbiBvYmplY3QgaXMgYSBzY2hlZHVsZXIgKi9cblx0ICAgIFNjaGVkdWxlci5pc1NjaGVkdWxlciA9IGZ1bmN0aW9uIChzKSB7XG5cdCAgICAgIHJldHVybiBzIGluc3RhbmNlb2YgU2NoZWR1bGVyO1xuXHQgICAgfTtcblx0XG5cdCAgICB2YXIgc2NoZWR1bGVyUHJvdG8gPSBTY2hlZHVsZXIucHJvdG90eXBlO1xuXHRcblx0ICAgIC8qKlxuXHQgICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG5cdCAgICogQHBhcmFtIHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG5cdCAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuXHQgICAqL1xuXHQgICAgc2NoZWR1bGVyUHJvdG8uc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuXHQgICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuXHQgICAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogU2NoZWR1bGVzIGFuIGFjdGlvbiB0byBiZSBleGVjdXRlZCBhZnRlciBkdWVUaW1lLlxuXHQgICAqIEBwYXJhbSBzdGF0ZSBTdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBkdWVUaW1lIFJlbGF0aXZlIHRpbWUgYWZ0ZXIgd2hpY2ggdG8gZXhlY3V0ZSB0aGUgYWN0aW9uLlxuXHQgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCBhY3Rpb24gKGJlc3QgZWZmb3J0KS5cblx0ICAgKi9cblx0ICAgIHNjaGVkdWxlclByb3RvLnNjaGVkdWxlRnV0dXJlID0gZnVuY3Rpb24gKHN0YXRlLCBkdWVUaW1lLCBhY3Rpb24pIHtcblx0ICAgICAgdmFyIGR0ID0gZHVlVGltZTtcblx0ICAgICAgZHQgaW5zdGFuY2VvZiBEYXRlICYmIChkdCA9IGR0IC0gdGhpcy5ub3coKSk7XG5cdCAgICAgIGR0ID0gU2NoZWR1bGVyLm5vcm1hbGl6ZShkdCk7XG5cdFxuXHQgICAgICBpZiAoZHQgPT09IDApIHsgcmV0dXJuIHRoaXMuc2NoZWR1bGUoc3RhdGUsIGFjdGlvbik7IH1cblx0XG5cdCAgICAgIHJldHVybiB0aGlzLl9zY2hlZHVsZUZ1dHVyZShzdGF0ZSwgZHQsIGFjdGlvbik7XG5cdCAgICB9O1xuXHRcblx0ICAgIHNjaGVkdWxlclByb3RvLl9zY2hlZHVsZUZ1dHVyZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZHVlVGltZSwgYWN0aW9uKSB7XG5cdCAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKiBHZXRzIHRoZSBjdXJyZW50IHRpbWUgYWNjb3JkaW5nIHRvIHRoZSBsb2NhbCBtYWNoaW5lJ3Mgc3lzdGVtIGNsb2NrLiAqL1xuXHQgICAgU2NoZWR1bGVyLm5vdyA9IGRlZmF1bHROb3c7XG5cdFxuXHQgICAgLyoqIEdldHMgdGhlIGN1cnJlbnQgdGltZSBhY2NvcmRpbmcgdG8gdGhlIGxvY2FsIG1hY2hpbmUncyBzeXN0ZW0gY2xvY2suICovXG5cdCAgICBTY2hlZHVsZXIucHJvdG90eXBlLm5vdyA9IGRlZmF1bHROb3c7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBOb3JtYWxpemVzIHRoZSBzcGVjaWZpZWQgVGltZVNwYW4gdmFsdWUgdG8gYSBwb3NpdGl2ZSB2YWx1ZS5cblx0ICAgICAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lU3BhbiBUaGUgdGltZSBzcGFuIHZhbHVlIHRvIG5vcm1hbGl6ZS5cblx0ICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBzcGVjaWZpZWQgVGltZVNwYW4gdmFsdWUgaWYgaXQgaXMgemVybyBvciBwb3NpdGl2ZTsgb3RoZXJ3aXNlLCAwXG5cdCAgICAgKi9cblx0ICAgIFNjaGVkdWxlci5ub3JtYWxpemUgPSBmdW5jdGlvbiAodGltZVNwYW4pIHtcblx0ICAgICAgdGltZVNwYW4gPCAwICYmICh0aW1lU3BhbiA9IDApO1xuXHQgICAgICByZXR1cm4gdGltZVNwYW47XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTY2hlZHVsZXI7XG5cdCAgfSgpKTtcblx0XG5cdCAgdmFyIG5vcm1hbGl6ZVRpbWUgPSBTY2hlZHVsZXIubm9ybWFsaXplLCBpc1NjaGVkdWxlciA9IFNjaGVkdWxlci5pc1NjaGVkdWxlcjtcblx0XG5cdCAgKGZ1bmN0aW9uIChzY2hlZHVsZXJQcm90bykge1xuXHRcblx0ICAgIGZ1bmN0aW9uIGludm9rZVJlY0ltbWVkaWF0ZShzY2hlZHVsZXIsIHBhaXIpIHtcblx0ICAgICAgdmFyIHN0YXRlID0gcGFpclswXSwgYWN0aW9uID0gcGFpclsxXSwgZ3JvdXAgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuXHQgICAgICBhY3Rpb24oc3RhdGUsIGlubmVyQWN0aW9uKTtcblx0ICAgICAgcmV0dXJuIGdyb3VwO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gaW5uZXJBY3Rpb24oc3RhdGUyKSB7XG5cdCAgICAgICAgdmFyIGlzQWRkZWQgPSBmYWxzZSwgaXNEb25lID0gZmFsc2U7XG5cdFxuXHQgICAgICAgIHZhciBkID0gc2NoZWR1bGVyLnNjaGVkdWxlKHN0YXRlMiwgc2NoZWR1bGVXb3JrKTtcblx0ICAgICAgICBpZiAoIWlzRG9uZSkge1xuXHQgICAgICAgICAgZ3JvdXAuYWRkKGQpO1xuXHQgICAgICAgICAgaXNBZGRlZCA9IHRydWU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBmdW5jdGlvbiBzY2hlZHVsZVdvcmsoXywgc3RhdGUzKSB7XG5cdCAgICAgICAgICBpZiAoaXNBZGRlZCkge1xuXHQgICAgICAgICAgICBncm91cC5yZW1vdmUoZCk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBpc0RvbmUgPSB0cnVlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgYWN0aW9uKHN0YXRlMywgaW5uZXJBY3Rpb24pO1xuXHQgICAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBpbnZva2VSZWNEYXRlKHNjaGVkdWxlciwgcGFpcikge1xuXHQgICAgICB2YXIgc3RhdGUgPSBwYWlyWzBdLCBhY3Rpb24gPSBwYWlyWzFdLCBncm91cCA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG5cdCAgICAgIGFjdGlvbihzdGF0ZSwgaW5uZXJBY3Rpb24pO1xuXHQgICAgICByZXR1cm4gZ3JvdXA7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBpbm5lckFjdGlvbihzdGF0ZTIsIGR1ZVRpbWUxKSB7XG5cdCAgICAgICAgdmFyIGlzQWRkZWQgPSBmYWxzZSwgaXNEb25lID0gZmFsc2U7XG5cdFxuXHQgICAgICAgIHZhciBkID0gc2NoZWR1bGVyLnNjaGVkdWxlRnV0dXJlKHN0YXRlMiwgZHVlVGltZTEsIHNjaGVkdWxlV29yayk7XG5cdCAgICAgICAgaWYgKCFpc0RvbmUpIHtcblx0ICAgICAgICAgIGdyb3VwLmFkZChkKTtcblx0ICAgICAgICAgIGlzQWRkZWQgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZnVuY3Rpb24gc2NoZWR1bGVXb3JrKF8sIHN0YXRlMykge1xuXHQgICAgICAgICAgaWYgKGlzQWRkZWQpIHtcblx0ICAgICAgICAgICAgZ3JvdXAucmVtb3ZlKGQpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGFjdGlvbihzdGF0ZTMsIGlubmVyQWN0aW9uKTtcblx0ICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTY2hlZHVsZXMgYW4gYWN0aW9uIHRvIGJlIGV4ZWN1dGVkIHJlY3Vyc2l2ZWx5LlxuXHQgICAgICogQHBhcmFtIHtNaXhlZH0gc3RhdGUgU3RhdGUgcGFzc2VkIHRvIHRoZSBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG5cdCAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGV4ZWN1dGUgcmVjdXJzaXZlbHkuIFRoZSBsYXN0IHBhcmFtZXRlciBwYXNzZWQgdG8gdGhlIGFjdGlvbiBpcyB1c2VkIHRvIHRyaWdnZXIgcmVjdXJzaXZlIHNjaGVkdWxpbmcgb2YgdGhlIGFjdGlvbiwgcGFzc2luZyBpbiByZWN1cnNpdmUgaW52b2NhdGlvbiBzdGF0ZS5cblx0ICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCBhY3Rpb24gKGJlc3QgZWZmb3J0KS5cblx0ICAgICAqL1xuXHQgICAgc2NoZWR1bGVyUHJvdG8uc2NoZWR1bGVSZWN1cnNpdmUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuXHQgICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZShbc3RhdGUsIGFjdGlvbl0sIGludm9rZVJlY0ltbWVkaWF0ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2NoZWR1bGVzIGFuIGFjdGlvbiB0byBiZSBleGVjdXRlZCByZWN1cnNpdmVseSBhZnRlciBhIHNwZWNpZmllZCByZWxhdGl2ZSBvciBhYnNvbHV0ZSBkdWUgdGltZS5cblx0ICAgICAqIEBwYXJhbSB7TWl4ZWR9IHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBleGVjdXRlIHJlY3Vyc2l2ZWx5LiBUaGUgbGFzdCBwYXJhbWV0ZXIgcGFzc2VkIHRvIHRoZSBhY3Rpb24gaXMgdXNlZCB0byB0cmlnZ2VyIHJlY3Vyc2l2ZSBzY2hlZHVsaW5nIG9mIHRoZSBhY3Rpb24sIHBhc3NpbmcgaW4gdGhlIHJlY3Vyc2l2ZSBkdWUgdGltZSBhbmQgaW52b2NhdGlvbiBzdGF0ZS5cblx0ICAgICAqIEBwYXJhbSB7TnVtYmVyIHwgRGF0ZX0gZHVlVGltZSBSZWxhdGl2ZSBvciBhYnNvbHV0ZSB0aW1lIGFmdGVyIHdoaWNoIHRvIGV4ZWN1dGUgdGhlIGFjdGlvbiBmb3IgdGhlIGZpcnN0IHRpbWUuXG5cdCAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG5cdCAgICAgKi9cblx0ICAgIHNjaGVkdWxlclByb3RvLnNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlID0gZnVuY3Rpb24gKHN0YXRlLCBkdWVUaW1lLCBhY3Rpb24pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVGdXR1cmUoW3N0YXRlLCBhY3Rpb25dLCBkdWVUaW1lLCBpbnZva2VSZWNEYXRlKTtcblx0ICAgIH07XG5cdFxuXHQgIH0oU2NoZWR1bGVyLnByb3RvdHlwZSkpO1xuXHRcblx0ICAoZnVuY3Rpb24gKHNjaGVkdWxlclByb3RvKSB7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTY2hlZHVsZXMgYSBwZXJpb2RpYyBwaWVjZSBvZiB3b3JrIGJ5IGR5bmFtaWNhbGx5IGRpc2NvdmVyaW5nIHRoZSBzY2hlZHVsZXIncyBjYXBhYmlsaXRpZXMuIFRoZSBwZXJpb2RpYyB0YXNrIHdpbGwgYmUgc2NoZWR1bGVkIHVzaW5nIHdpbmRvdy5zZXRJbnRlcnZhbCBmb3IgdGhlIGJhc2UgaW1wbGVtZW50YXRpb24uXG5cdCAgICAgKiBAcGFyYW0ge01peGVkfSBzdGF0ZSBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHVwb24gdGhlIGZpcnN0IGl0ZXJhdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7TnVtYmVyfSBwZXJpb2QgUGVyaW9kIGZvciBydW5uaW5nIHRoZSB3b3JrIHBlcmlvZGljYWxseS5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gYmUgZXhlY3V0ZWQsIHBvdGVudGlhbGx5IHVwZGF0aW5nIHRoZSBzdGF0ZS5cblx0ICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCByZWN1cnJpbmcgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG5cdCAgICAgKi9cblx0ICAgIFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGVQZXJpb2RpYyA9IGZ1bmN0aW9uKHN0YXRlLCBwZXJpb2QsIGFjdGlvbikge1xuXHQgICAgICBpZiAodHlwZW9mIHJvb3Quc2V0SW50ZXJ2YWwgPT09ICd1bmRlZmluZWQnKSB7IHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcigpOyB9XG5cdCAgICAgIHBlcmlvZCA9IG5vcm1hbGl6ZVRpbWUocGVyaW9kKTtcblx0ICAgICAgdmFyIHMgPSBzdGF0ZSwgaWQgPSByb290LnNldEludGVydmFsKGZ1bmN0aW9uICgpIHsgcyA9IGFjdGlvbihzKTsgfSwgcGVyaW9kKTtcblx0ICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkgeyByb290LmNsZWFySW50ZXJ2YWwoaWQpOyB9KTtcblx0ICAgIH07XG5cdFxuXHQgIH0oU2NoZWR1bGVyLnByb3RvdHlwZSkpO1xuXHRcblx0ICAvKiogR2V0cyBhIHNjaGVkdWxlciB0aGF0IHNjaGVkdWxlcyB3b3JrIGltbWVkaWF0ZWx5IG9uIHRoZSBjdXJyZW50IHRocmVhZC4gKi9cblx0ICAgdmFyIEltbWVkaWF0ZVNjaGVkdWxlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhJbW1lZGlhdGVTY2hlZHVsZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBJbW1lZGlhdGVTY2hlZHVsZXIoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEltbWVkaWF0ZVNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuXHQgICAgICByZXR1cm4gZGlzcG9zYWJsZUZpeHVwKGFjdGlvbih0aGlzLCBzdGF0ZSkpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gSW1tZWRpYXRlU2NoZWR1bGVyO1xuXHQgIH0oU2NoZWR1bGVyKSk7XG5cdFxuXHQgIHZhciBpbW1lZGlhdGVTY2hlZHVsZXIgPSBTY2hlZHVsZXIuaW1tZWRpYXRlID0gbmV3IEltbWVkaWF0ZVNjaGVkdWxlcigpO1xuXHRcblx0ICAvKipcblx0ICAgKiBHZXRzIGEgc2NoZWR1bGVyIHRoYXQgc2NoZWR1bGVzIHdvcmsgYXMgc29vbiBhcyBwb3NzaWJsZSBvbiB0aGUgY3VycmVudCB0aHJlYWQuXG5cdCAgICovXG5cdCAgdmFyIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgdmFyIHF1ZXVlO1xuXHRcblx0ICAgIGZ1bmN0aW9uIHJ1blRyYW1wb2xpbmUgKCkge1xuXHQgICAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkge1xuXHQgICAgICAgIHZhciBpdGVtID0gcXVldWUuZGVxdWV1ZSgpO1xuXHQgICAgICAgICFpdGVtLmlzQ2FuY2VsbGVkKCkgJiYgaXRlbS5pbnZva2UoKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGluaGVyaXRzKEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDdXJyZW50VGhyZWFkU2NoZWR1bGVyKCkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBDdXJyZW50VGhyZWFkU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG5cdCAgICAgIHZhciBzaSA9IG5ldyBTY2hlZHVsZWRJdGVtKHRoaXMsIHN0YXRlLCBhY3Rpb24sIHRoaXMubm93KCkpO1xuXHRcblx0ICAgICAgaWYgKCFxdWV1ZSkge1xuXHQgICAgICAgIHF1ZXVlID0gbmV3IFByaW9yaXR5UXVldWUoNCk7XG5cdCAgICAgICAgcXVldWUuZW5xdWV1ZShzaSk7XG5cdFxuXHQgICAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaChydW5UcmFtcG9saW5lKSgpO1xuXHQgICAgICAgIHF1ZXVlID0gbnVsbDtcblx0ICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyB0aHJvd2VyKHJlc3VsdC5lKTsgfVxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHF1ZXVlLmVucXVldWUoc2kpO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBzaS5kaXNwb3NhYmxlO1xuXHQgICAgfTtcblx0XG5cdCAgICBDdXJyZW50VGhyZWFkU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZVJlcXVpcmVkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gIXF1ZXVlOyB9O1xuXHRcblx0ICAgIHJldHVybiBDdXJyZW50VGhyZWFkU2NoZWR1bGVyO1xuXHQgIH0oU2NoZWR1bGVyKSk7XG5cdFxuXHQgIHZhciBjdXJyZW50VGhyZWFkU2NoZWR1bGVyID0gU2NoZWR1bGVyLmN1cnJlbnRUaHJlYWQgPSBuZXcgQ3VycmVudFRocmVhZFNjaGVkdWxlcigpO1xuXHRcblx0ICB2YXIgU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZSA9IFJ4LmludGVybmFscy5TY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIGNyZWF0ZVRpY2soc2VsZikge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gdGljayhjb21tYW5kLCByZWN1cnNlKSB7XG5cdCAgICAgICAgcmVjdXJzZSgwLCBzZWxmLl9wZXJpb2QpO1xuXHQgICAgICAgIHZhciBzdGF0ZSA9IHRyeUNhdGNoKHNlbGYuX2FjdGlvbikoc2VsZi5fc3RhdGUpO1xuXHQgICAgICAgIGlmIChzdGF0ZSA9PT0gZXJyb3JPYmopIHtcblx0ICAgICAgICAgIHNlbGYuX2NhbmNlbC5kaXNwb3NlKCk7XG5cdCAgICAgICAgICB0aHJvd2VyKHN0YXRlLmUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBzZWxmLl9zdGF0ZSA9IHN0YXRlO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIFNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUoc2NoZWR1bGVyLCBzdGF0ZSwgcGVyaW9kLCBhY3Rpb24pIHtcblx0ICAgICAgdGhpcy5fc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuXHQgICAgICB0aGlzLl9wZXJpb2QgPSBwZXJpb2Q7XG5cdCAgICAgIHRoaXMuX2FjdGlvbiA9IGFjdGlvbjtcblx0ICAgIH1cblx0XG5cdCAgICBTY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgdGhpcy5fY2FuY2VsID0gZDtcblx0ICAgICAgZC5zZXREaXNwb3NhYmxlKHRoaXMuX3NjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZUZ1dHVyZSgwLCB0aGlzLl9wZXJpb2QsIGNyZWF0ZVRpY2sodGhpcykpKTtcblx0XG5cdCAgICAgIHJldHVybiBkO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZTtcblx0ICB9KCkpO1xuXHRcblx0ICB2YXIgc2NoZWR1bGVNZXRob2QsIGNsZWFyTWV0aG9kO1xuXHRcblx0ICB2YXIgbG9jYWxUaW1lciA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgbG9jYWxTZXRUaW1lb3V0LCBsb2NhbENsZWFyVGltZW91dCA9IG5vb3A7XG5cdCAgICBpZiAoISFyb290LnNldFRpbWVvdXQpIHtcblx0ICAgICAgbG9jYWxTZXRUaW1lb3V0ID0gcm9vdC5zZXRUaW1lb3V0O1xuXHQgICAgICBsb2NhbENsZWFyVGltZW91dCA9IHJvb3QuY2xlYXJUaW1lb3V0O1xuXHQgICAgfSBlbHNlIGlmICghIXJvb3QuV1NjcmlwdCkge1xuXHQgICAgICBsb2NhbFNldFRpbWVvdXQgPSBmdW5jdGlvbiAoZm4sIHRpbWUpIHtcblx0ICAgICAgICByb290LldTY3JpcHQuU2xlZXAodGltZSk7XG5cdCAgICAgICAgZm4oKTtcblx0ICAgICAgfTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcigpO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiB7XG5cdCAgICAgIHNldFRpbWVvdXQ6IGxvY2FsU2V0VGltZW91dCxcblx0ICAgICAgY2xlYXJUaW1lb3V0OiBsb2NhbENsZWFyVGltZW91dFxuXHQgICAgfTtcblx0ICB9KCkpO1xuXHQgIHZhciBsb2NhbFNldFRpbWVvdXQgPSBsb2NhbFRpbWVyLnNldFRpbWVvdXQsXG5cdCAgICBsb2NhbENsZWFyVGltZW91dCA9IGxvY2FsVGltZXIuY2xlYXJUaW1lb3V0O1xuXHRcblx0ICAoZnVuY3Rpb24gKCkge1xuXHRcblx0ICAgIHZhciBuZXh0SGFuZGxlID0gMSwgdGFza3NCeUhhbmRsZSA9IHt9LCBjdXJyZW50bHlSdW5uaW5nID0gZmFsc2U7XG5cdFxuXHQgICAgY2xlYXJNZXRob2QgPSBmdW5jdGlvbiAoaGFuZGxlKSB7XG5cdCAgICAgIGRlbGV0ZSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIHJ1blRhc2soaGFuZGxlKSB7XG5cdCAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nKSB7XG5cdCAgICAgICAgbG9jYWxTZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcnVuVGFzayhoYW5kbGUpOyB9LCAwKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB2YXIgdGFzayA9IHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcblx0ICAgICAgICBpZiAodGFzaykge1xuXHQgICAgICAgICAgY3VycmVudGx5UnVubmluZyA9IHRydWU7XG5cdCAgICAgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGFzaykoKTtcblx0ICAgICAgICAgIGNsZWFyTWV0aG9kKGhhbmRsZSk7XG5cdCAgICAgICAgICBjdXJyZW50bHlSdW5uaW5nID0gZmFsc2U7XG5cdCAgICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyB0aHJvd2VyKHJlc3VsdC5lKTsgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIHZhciByZU5hdGl2ZSA9IG5ldyBSZWdFeHAoJ14nICtcblx0ICAgICAgU3RyaW5nKHRvU3RyaW5nKVxuXHQgICAgICAgIC5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpXG5cdCAgICAgICAgLnJlcGxhY2UoL3RvU3RyaW5nfCBmb3IgW15cXF1dKy9nLCAnLio/JykgKyAnJCdcblx0ICAgICk7XG5cdFxuXHQgICAgdmFyIHNldEltbWVkaWF0ZSA9IHR5cGVvZiAoc2V0SW1tZWRpYXRlID0gZnJlZUdsb2JhbCAmJiBtb2R1bGVFeHBvcnRzICYmIGZyZWVHbG9iYWwuc2V0SW1tZWRpYXRlKSA9PSAnZnVuY3Rpb24nICYmXG5cdCAgICAgICFyZU5hdGl2ZS50ZXN0KHNldEltbWVkaWF0ZSkgJiYgc2V0SW1tZWRpYXRlO1xuXHRcblx0ICAgIGZ1bmN0aW9uIHBvc3RNZXNzYWdlU3VwcG9ydGVkICgpIHtcblx0ICAgICAgLy8gRW5zdXJlIG5vdCBpbiBhIHdvcmtlclxuXHQgICAgICBpZiAoIXJvb3QucG9zdE1lc3NhZ2UgfHwgcm9vdC5pbXBvcnRTY3JpcHRzKSB7IHJldHVybiBmYWxzZTsgfVxuXHQgICAgICB2YXIgaXNBc3luYyA9IGZhbHNlLCBvbGRIYW5kbGVyID0gcm9vdC5vbm1lc3NhZ2U7XG5cdCAgICAgIC8vIFRlc3QgZm9yIGFzeW5jXG5cdCAgICAgIHJvb3Qub25tZXNzYWdlID0gZnVuY3Rpb24gKCkgeyBpc0FzeW5jID0gdHJ1ZTsgfTtcblx0ICAgICAgcm9vdC5wb3N0TWVzc2FnZSgnJywgJyonKTtcblx0ICAgICAgcm9vdC5vbm1lc3NhZ2UgPSBvbGRIYW5kbGVyO1xuXHRcblx0ICAgICAgcmV0dXJuIGlzQXN5bmM7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gVXNlIGluIG9yZGVyLCBzZXRJbW1lZGlhdGUsIG5leHRUaWNrLCBwb3N0TWVzc2FnZSwgTWVzc2FnZUNoYW5uZWwsIHNjcmlwdCByZWFkeXN0YXRlY2hhbmdlZCwgc2V0VGltZW91dFxuXHQgICAgaWYgKGlzRnVuY3Rpb24oc2V0SW1tZWRpYXRlKSkge1xuXHQgICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcblx0ICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG5cdCAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG5cdCAgICAgICAgc2V0SW1tZWRpYXRlKGZ1bmN0aW9uICgpIHsgcnVuVGFzayhpZCk7IH0pO1xuXHRcblx0ICAgICAgICByZXR1cm4gaWQ7XG5cdCAgICAgIH07XG5cdCAgICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXScpIHtcblx0ICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG5cdCAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuXHQgICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuXHQgICAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkgeyBydW5UYXNrKGlkKTsgfSk7XG5cdFxuXHQgICAgICAgIHJldHVybiBpZDtcblx0ICAgICAgfTtcblx0ICAgIH0gZWxzZSBpZiAocG9zdE1lc3NhZ2VTdXBwb3J0ZWQoKSkge1xuXHQgICAgICB2YXIgTVNHX1BSRUZJWCA9ICdtcy5yeC5zY2hlZHVsZScgKyBNYXRoLnJhbmRvbSgpO1xuXHRcblx0ICAgICAgdmFyIG9uR2xvYmFsUG9zdE1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcblx0ICAgICAgICAvLyBPbmx5IGlmIHdlJ3JlIGEgbWF0Y2ggdG8gYXZvaWQgYW55IG90aGVyIGdsb2JhbCBldmVudHNcblx0ICAgICAgICBpZiAodHlwZW9mIGV2ZW50LmRhdGEgPT09ICdzdHJpbmcnICYmIGV2ZW50LmRhdGEuc3Vic3RyaW5nKDAsIE1TR19QUkVGSVgubGVuZ3RoKSA9PT0gTVNHX1BSRUZJWCkge1xuXHQgICAgICAgICAgcnVuVGFzayhldmVudC5kYXRhLnN1YnN0cmluZyhNU0dfUFJFRklYLmxlbmd0aCkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0XG5cdCAgICAgIHJvb3QuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIG9uR2xvYmFsUG9zdE1lc3NhZ2UsIGZhbHNlKTtcblx0XG5cdCAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXHQgICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcblx0ICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcblx0ICAgICAgICByb290LnBvc3RNZXNzYWdlKE1TR19QUkVGSVggKyBjdXJyZW50SWQsICcqJyk7XG5cdCAgICAgICAgcmV0dXJuIGlkO1xuXHQgICAgICB9O1xuXHQgICAgfSBlbHNlIGlmICghIXJvb3QuTWVzc2FnZUNoYW5uZWwpIHtcblx0ICAgICAgdmFyIGNoYW5uZWwgPSBuZXcgcm9vdC5NZXNzYWdlQ2hhbm5lbCgpO1xuXHRcblx0ICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkgeyBydW5UYXNrKGUuZGF0YSk7IH07XG5cdFxuXHQgICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcblx0ICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG5cdCAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG5cdCAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZShpZCk7XG5cdCAgICAgICAgcmV0dXJuIGlkO1xuXHQgICAgICB9O1xuXHQgICAgfSBlbHNlIGlmICgnZG9jdW1lbnQnIGluIHJvb3QgJiYgJ29ucmVhZHlzdGF0ZWNoYW5nZScgaW4gcm9vdC5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKSkge1xuXHRcblx0ICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG5cdCAgICAgICAgdmFyIHNjcmlwdEVsZW1lbnQgPSByb290LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuXHQgICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcblx0ICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcblx0XG5cdCAgICAgICAgc2NyaXB0RWxlbWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBydW5UYXNrKGlkKTtcblx0ICAgICAgICAgIHNjcmlwdEVsZW1lbnQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcblx0ICAgICAgICAgIHNjcmlwdEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHRFbGVtZW50KTtcblx0ICAgICAgICAgIHNjcmlwdEVsZW1lbnQgPSBudWxsO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgcm9vdC5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoc2NyaXB0RWxlbWVudCk7XG5cdCAgICAgICAgcmV0dXJuIGlkO1xuXHQgICAgICB9O1xuXHRcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXHQgICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcblx0ICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcblx0ICAgICAgICBsb2NhbFNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgcnVuVGFzayhpZCk7XG5cdCAgICAgICAgfSwgMCk7XG5cdFxuXHQgICAgICAgIHJldHVybiBpZDtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9KCkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBHZXRzIGEgc2NoZWR1bGVyIHRoYXQgc2NoZWR1bGVzIHdvcmsgdmlhIGEgdGltZWQgY2FsbGJhY2sgYmFzZWQgdXBvbiBwbGF0Zm9ybS5cblx0ICAgKi9cblx0ICAgdmFyIERlZmF1bHRTY2hlZHVsZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgIGluaGVyaXRzKERlZmF1bHRTY2hlZHVsZXIsIF9fc3VwZXJfXyk7XG5cdCAgICAgZnVuY3Rpb24gRGVmYXVsdFNjaGVkdWxlcigpIHtcblx0ICAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgIH1cblx0XG5cdCAgICAgZnVuY3Rpb24gc2NoZWR1bGVBY3Rpb24oZGlzcG9zYWJsZSwgYWN0aW9uLCBzY2hlZHVsZXIsIHN0YXRlKSB7XG5cdCAgICAgICByZXR1cm4gZnVuY3Rpb24gc2NoZWR1bGUoKSB7XG5cdCAgICAgICAgICFkaXNwb3NhYmxlLmlzRGlzcG9zZWQgJiYgZGlzcG9zYWJsZS5zZXREaXNwb3NhYmxlKERpc3Bvc2FibGUuX2ZpeHVwKGFjdGlvbihzY2hlZHVsZXIsIHN0YXRlKSkpO1xuXHQgICAgICAgfTtcblx0ICAgICB9XG5cdFxuXHQgICAgIGZ1bmN0aW9uIENsZWFyRGlzcG9zYWJsZShtZXRob2QsIGlkKSB7XG5cdCAgICAgICB0aGlzLl9pZCA9IGlkO1xuXHQgICAgICAgdGhpcy5fbWV0aG9kID0gbWV0aG9kO1xuXHQgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICAgfVxuXHRcblx0ICAgICBDbGVhckRpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgICB0aGlzLl9tZXRob2QuY2FsbChudWxsLCB0aGlzLl9pZCk7XG5cdCAgICAgICB9XG5cdCAgICAgfTtcblx0XG5cdCAgICBEZWZhdWx0U2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG5cdCAgICAgIHZhciBkaXNwb3NhYmxlID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksXG5cdCAgICAgICAgICBpZCA9IHNjaGVkdWxlTWV0aG9kKHNjaGVkdWxlQWN0aW9uKGRpc3Bvc2FibGUsIGFjdGlvbiwgdGhpcywgc3RhdGUpKTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKGRpc3Bvc2FibGUsIG5ldyBDbGVhckRpc3Bvc2FibGUoY2xlYXJNZXRob2QsIGlkKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIERlZmF1bHRTY2hlZHVsZXIucHJvdG90eXBlLl9zY2hlZHVsZUZ1dHVyZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZHVlVGltZSwgYWN0aW9uKSB7XG5cdCAgICAgIGlmIChkdWVUaW1lID09PSAwKSB7IHJldHVybiB0aGlzLnNjaGVkdWxlKHN0YXRlLCBhY3Rpb24pOyB9XG5cdCAgICAgIHZhciBkaXNwb3NhYmxlID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksXG5cdCAgICAgICAgICBpZCA9IGxvY2FsU2V0VGltZW91dChzY2hlZHVsZUFjdGlvbihkaXNwb3NhYmxlLCBhY3Rpb24sIHRoaXMsIHN0YXRlKSwgZHVlVGltZSk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShkaXNwb3NhYmxlLCBuZXcgQ2xlYXJEaXNwb3NhYmxlKGxvY2FsQ2xlYXJUaW1lb3V0LCBpZCkpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRGVmYXVsdFNjaGVkdWxlcjtcblx0ICB9KFNjaGVkdWxlcikpO1xuXHRcblx0ICB2YXIgZGVmYXVsdFNjaGVkdWxlciA9IFNjaGVkdWxlclsnZGVmYXVsdCddID0gU2NoZWR1bGVyLmFzeW5jID0gbmV3IERlZmF1bHRTY2hlZHVsZXIoKTtcblx0XG5cdCAgZnVuY3Rpb24gSW5kZXhlZEl0ZW0oaWQsIHZhbHVlKSB7XG5cdCAgICB0aGlzLmlkID0gaWQ7XG5cdCAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cdCAgfVxuXHRcblx0ICBJbmRleGVkSXRlbS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cdCAgICB2YXIgYyA9IHRoaXMudmFsdWUuY29tcGFyZVRvKG90aGVyLnZhbHVlKTtcblx0ICAgIGMgPT09IDAgJiYgKGMgPSB0aGlzLmlkIC0gb3RoZXIuaWQpO1xuXHQgICAgcmV0dXJuIGM7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFByaW9yaXR5UXVldWUgPSBSeC5pbnRlcm5hbHMuUHJpb3JpdHlRdWV1ZSA9IGZ1bmN0aW9uIChjYXBhY2l0eSkge1xuXHQgICAgdGhpcy5pdGVtcyA9IG5ldyBBcnJheShjYXBhY2l0eSk7XG5cdCAgICB0aGlzLmxlbmd0aCA9IDA7XG5cdCAgfTtcblx0XG5cdCAgdmFyIHByaW9yaXR5UHJvdG8gPSBQcmlvcml0eVF1ZXVlLnByb3RvdHlwZTtcblx0ICBwcmlvcml0eVByb3RvLmlzSGlnaGVyUHJpb3JpdHkgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcblx0ICAgIHJldHVybiB0aGlzLml0ZW1zW2xlZnRdLmNvbXBhcmVUbyh0aGlzLml0ZW1zW3JpZ2h0XSkgPCAwO1xuXHQgIH07XG5cdFxuXHQgIHByaW9yaXR5UHJvdG8ucGVyY29sYXRlID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdCAgICBpZiAoaW5kZXggPj0gdGhpcy5sZW5ndGggfHwgaW5kZXggPCAwKSB7IHJldHVybjsgfVxuXHQgICAgdmFyIHBhcmVudCA9IGluZGV4IC0gMSA+PiAxO1xuXHQgICAgaWYgKHBhcmVudCA8IDAgfHwgcGFyZW50ID09PSBpbmRleCkgeyByZXR1cm47IH1cblx0ICAgIGlmICh0aGlzLmlzSGlnaGVyUHJpb3JpdHkoaW5kZXgsIHBhcmVudCkpIHtcblx0ICAgICAgdmFyIHRlbXAgPSB0aGlzLml0ZW1zW2luZGV4XTtcblx0ICAgICAgdGhpcy5pdGVtc1tpbmRleF0gPSB0aGlzLml0ZW1zW3BhcmVudF07XG5cdCAgICAgIHRoaXMuaXRlbXNbcGFyZW50XSA9IHRlbXA7XG5cdCAgICAgIHRoaXMucGVyY29sYXRlKHBhcmVudCk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgcHJpb3JpdHlQcm90by5oZWFwaWZ5ID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdCAgICAraW5kZXggfHwgKGluZGV4ID0gMCk7XG5cdCAgICBpZiAoaW5kZXggPj0gdGhpcy5sZW5ndGggfHwgaW5kZXggPCAwKSB7IHJldHVybjsgfVxuXHQgICAgdmFyIGxlZnQgPSAyICogaW5kZXggKyAxLFxuXHQgICAgICAgIHJpZ2h0ID0gMiAqIGluZGV4ICsgMixcblx0ICAgICAgICBmaXJzdCA9IGluZGV4O1xuXHQgICAgaWYgKGxlZnQgPCB0aGlzLmxlbmd0aCAmJiB0aGlzLmlzSGlnaGVyUHJpb3JpdHkobGVmdCwgZmlyc3QpKSB7XG5cdCAgICAgIGZpcnN0ID0gbGVmdDtcblx0ICAgIH1cblx0ICAgIGlmIChyaWdodCA8IHRoaXMubGVuZ3RoICYmIHRoaXMuaXNIaWdoZXJQcmlvcml0eShyaWdodCwgZmlyc3QpKSB7XG5cdCAgICAgIGZpcnN0ID0gcmlnaHQ7XG5cdCAgICB9XG5cdCAgICBpZiAoZmlyc3QgIT09IGluZGV4KSB7XG5cdCAgICAgIHZhciB0ZW1wID0gdGhpcy5pdGVtc1tpbmRleF07XG5cdCAgICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gdGhpcy5pdGVtc1tmaXJzdF07XG5cdCAgICAgIHRoaXMuaXRlbXNbZmlyc3RdID0gdGVtcDtcblx0ICAgICAgdGhpcy5oZWFwaWZ5KGZpcnN0KTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICBwcmlvcml0eVByb3RvLnBlZWsgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLml0ZW1zWzBdLnZhbHVlOyB9O1xuXHRcblx0ICBwcmlvcml0eVByb3RvLnJlbW92ZUF0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdCAgICB0aGlzLml0ZW1zW2luZGV4XSA9IHRoaXMuaXRlbXNbLS10aGlzLmxlbmd0aF07XG5cdCAgICB0aGlzLml0ZW1zW3RoaXMubGVuZ3RoXSA9IHVuZGVmaW5lZDtcblx0ICAgIHRoaXMuaGVhcGlmeSgpO1xuXHQgIH07XG5cdFxuXHQgIHByaW9yaXR5UHJvdG8uZGVxdWV1ZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciByZXN1bHQgPSB0aGlzLnBlZWsoKTtcblx0ICAgIHRoaXMucmVtb3ZlQXQoMCk7XG5cdCAgICByZXR1cm4gcmVzdWx0O1xuXHQgIH07XG5cdFxuXHQgIHByaW9yaXR5UHJvdG8uZW5xdWV1ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cdCAgICB2YXIgaW5kZXggPSB0aGlzLmxlbmd0aCsrO1xuXHQgICAgdGhpcy5pdGVtc1tpbmRleF0gPSBuZXcgSW5kZXhlZEl0ZW0oUHJpb3JpdHlRdWV1ZS5jb3VudCsrLCBpdGVtKTtcblx0ICAgIHRoaXMucGVyY29sYXRlKGluZGV4KTtcblx0ICB9O1xuXHRcblx0ICBwcmlvcml0eVByb3RvLnJlbW92ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgaWYgKHRoaXMuaXRlbXNbaV0udmFsdWUgPT09IGl0ZW0pIHtcblx0ICAgICAgICB0aGlzLnJlbW92ZUF0KGkpO1xuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gZmFsc2U7XG5cdCAgfTtcblx0ICBQcmlvcml0eVF1ZXVlLmNvdW50ID0gMDtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJlcHJlc2VudHMgYSBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG5cdCAgICovXG5cdCAgdmFyIE5vdGlmaWNhdGlvbiA9IFJ4Lk5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBOb3RpZmljYXRpb24oKSB7XG5cdFxuXHQgICAgfVxuXHRcblx0ICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIEludm9rZXMgdGhlIGRlbGVnYXRlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIG5vdGlmaWNhdGlvbiBvciB0aGUgb2JzZXJ2ZXIncyBtZXRob2QgY29ycmVzcG9uZGluZyB0byB0aGUgbm90aWZpY2F0aW9uIGFuZCByZXR1cm5zIHRoZSBwcm9kdWNlZCByZXN1bHQuXG5cdCAgICAgKlxuXHQgICAgICogQG1lbWJlck9mIE5vdGlmaWNhdGlvblxuXHQgICAgICogQHBhcmFtIHtBbnl9IG9ic2VydmVyT3JPbk5leHQgRGVsZWdhdGUgdG8gaW52b2tlIGZvciBhbiBPbk5leHQgbm90aWZpY2F0aW9uIG9yIE9ic2VydmVyIHRvIGludm9rZSB0aGUgbm90aWZpY2F0aW9uIG9uLi5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRXJyb3IgRGVsZWdhdGUgdG8gaW52b2tlIGZvciBhbiBPbkVycm9yIG5vdGlmaWNhdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uQ29tcGxldGVkIERlbGVnYXRlIHRvIGludm9rZSBmb3IgYW4gT25Db21wbGV0ZWQgbm90aWZpY2F0aW9uLlxuXHQgICAgICogQHJldHVybnMge0FueX0gUmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBvYnNlcnZhdGlvbi5cblx0ICAgICAqL1xuXHQgICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbiAob2JzZXJ2ZXJPck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgICAgcmV0dXJuIG9ic2VydmVyT3JPbk5leHQgJiYgdHlwZW9mIG9ic2VydmVyT3JPbk5leHQgPT09ICdvYmplY3QnID9cblx0ICAgICAgICB0aGlzLl9hY2NlcHRPYnNlcnZhYmxlKG9ic2VydmVyT3JPbk5leHQpIDpcblx0ICAgICAgICB0aGlzLl9hY2NlcHQob2JzZXJ2ZXJPck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIGEgc2luZ2xlIG5vdGlmaWNhdGlvbi5cblx0ICAgICAqXG5cdCAgICAgKiBAbWVtYmVyT2YgTm90aWZpY2F0aW9uc1xuXHQgICAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBzZW5kIG91dCB0aGUgbm90aWZpY2F0aW9uIGNhbGxzIG9uLlxuXHQgICAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc3VyZmFjZXMgdGhlIGJlaGF2aW9yIG9mIHRoZSBub3RpZmljYXRpb24gdXBvbiBzdWJzY3JpcHRpb24uXG5cdCAgICAgKi9cblx0ICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9PYnNlcnZhYmxlID0gZnVuY3Rpb24gKHNjaGVkdWxlcikge1xuXHQgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcik7XG5cdCAgICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICAgIHJldHVybiBzY2hlZHVsZXIuc2NoZWR1bGUoc2VsZiwgZnVuY3Rpb24gKF8sIG5vdGlmaWNhdGlvbikge1xuXHQgICAgICAgICAgbm90aWZpY2F0aW9uLl9hY2NlcHRPYnNlcnZhYmxlKG8pO1xuXHQgICAgICAgICAgbm90aWZpY2F0aW9uLmtpbmQgPT09ICdOJyAmJiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTm90aWZpY2F0aW9uO1xuXHQgIH0pKCk7XG5cdFxuXHQgIHZhciBPbk5leHROb3RpZmljYXRpb24gPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoT25OZXh0Tm90aWZpY2F0aW9uLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gT25OZXh0Tm90aWZpY2F0aW9uKHZhbHVlKSB7XG5cdCAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0ICAgICAgdGhpcy5raW5kID0gJ04nO1xuXHQgICAgfVxuXHRcblx0ICAgIE9uTmV4dE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQpIHtcblx0ICAgICAgcmV0dXJuIG9uTmV4dCh0aGlzLnZhbHVlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgT25OZXh0Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgT25OZXh0Tm90aWZpY2F0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuICdPbk5leHQoJyArIHRoaXMudmFsdWUgKyAnKSc7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBPbk5leHROb3RpZmljYXRpb247XG5cdCAgfShOb3RpZmljYXRpb24pKTtcblx0XG5cdCAgdmFyIE9uRXJyb3JOb3RpZmljYXRpb24gPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoT25FcnJvck5vdGlmaWNhdGlvbiwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE9uRXJyb3JOb3RpZmljYXRpb24oZXJyb3IpIHtcblx0ICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXHQgICAgICB0aGlzLmtpbmQgPSAnRSc7XG5cdCAgICB9XG5cdFxuXHQgICAgT25FcnJvck5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IpIHtcblx0ICAgICAgcmV0dXJuIG9uRXJyb3IodGhpcy5lcnJvcik7XG5cdCAgICB9O1xuXHRcblx0ICAgIE9uRXJyb3JOb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHRPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIG8ub25FcnJvcih0aGlzLmVycm9yKTtcblx0ICAgIH07XG5cdFxuXHQgICAgT25FcnJvck5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiAnT25FcnJvcignICsgdGhpcy5lcnJvciArICcpJztcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE9uRXJyb3JOb3RpZmljYXRpb247XG5cdCAgfShOb3RpZmljYXRpb24pKTtcblx0XG5cdCAgdmFyIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE9uQ29tcGxldGVkTm90aWZpY2F0aW9uLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gT25Db21wbGV0ZWROb3RpZmljYXRpb24oKSB7XG5cdCAgICAgIHRoaXMua2luZCA9ICdDJztcblx0ICAgIH1cblx0XG5cdCAgICBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICAgIHJldHVybiBvbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiAnT25Db21wbGV0ZWQoKSc7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbjtcblx0ICB9KE5vdGlmaWNhdGlvbikpO1xuXHRcblx0ICAvKipcblx0ICAgKiBDcmVhdGVzIGFuIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgYW4gT25OZXh0IG5vdGlmaWNhdGlvbiB0byBhbiBvYnNlcnZlci5cblx0ICAgKiBAcGFyYW0ge0FueX0gdmFsdWUgVGhlIHZhbHVlIGNvbnRhaW5lZCBpbiB0aGUgbm90aWZpY2F0aW9uLlxuXHQgICAqIEByZXR1cm5zIHtOb3RpZmljYXRpb259IFRoZSBPbk5leHQgbm90aWZpY2F0aW9uIGNvbnRhaW5pbmcgdGhlIHZhbHVlLlxuXHQgICAqL1xuXHQgIHZhciBub3RpZmljYXRpb25DcmVhdGVPbk5leHQgPSBOb3RpZmljYXRpb24uY3JlYXRlT25OZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICByZXR1cm4gbmV3IE9uTmV4dE5vdGlmaWNhdGlvbih2YWx1ZSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ3JlYXRlcyBhbiBvYmplY3QgdGhhdCByZXByZXNlbnRzIGFuIE9uRXJyb3Igbm90aWZpY2F0aW9uIHRvIGFuIG9ic2VydmVyLlxuXHQgICAqIEBwYXJhbSB7QW55fSBlcnJvciBUaGUgZXhjZXB0aW9uIGNvbnRhaW5lZCBpbiB0aGUgbm90aWZpY2F0aW9uLlxuXHQgICAqIEByZXR1cm5zIHtOb3RpZmljYXRpb259IFRoZSBPbkVycm9yIG5vdGlmaWNhdGlvbiBjb250YWluaW5nIHRoZSBleGNlcHRpb24uXG5cdCAgICovXG5cdCAgdmFyIG5vdGlmaWNhdGlvbkNyZWF0ZU9uRXJyb3IgPSBOb3RpZmljYXRpb24uY3JlYXRlT25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgcmV0dXJuIG5ldyBPbkVycm9yTm90aWZpY2F0aW9uKGVycm9yKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBDcmVhdGVzIGFuIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgYW4gT25Db21wbGV0ZWQgbm90aWZpY2F0aW9uIHRvIGFuIG9ic2VydmVyLlxuXHQgICAqIEByZXR1cm5zIHtOb3RpZmljYXRpb259IFRoZSBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24uXG5cdCAgICovXG5cdCAgdmFyIG5vdGlmaWNhdGlvbkNyZWF0ZU9uQ29tcGxldGVkID0gTm90aWZpY2F0aW9uLmNyZWF0ZU9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbigpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFN1cHBvcnRzIHB1c2gtc3R5bGUgaXRlcmF0aW9uIG92ZXIgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICB2YXIgT2JzZXJ2ZXIgPSBSeC5PYnNlcnZlciA9IGZ1bmN0aW9uICgpIHsgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIENyZWF0ZXMgYW4gb2JzZXJ2ZXIgZnJvbSB0aGUgc3BlY2lmaWVkIE9uTmV4dCwgYWxvbmcgd2l0aCBvcHRpb25hbCBPbkVycm9yLCBhbmQgT25Db21wbGV0ZWQgYWN0aW9ucy5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25OZXh0XSBPYnNlcnZlcidzIE9uTmV4dCBhY3Rpb24gaW1wbGVtZW50YXRpb24uXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uRXJyb3JdIE9ic2VydmVyJ3MgT25FcnJvciBhY3Rpb24gaW1wbGVtZW50YXRpb24uXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uQ29tcGxldGVkXSBPYnNlcnZlcidzIE9uQ29tcGxldGVkIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2ZXJ9IFRoZSBvYnNlcnZlciBvYmplY3QgaW1wbGVtZW50ZWQgdXNpbmcgdGhlIGdpdmVuIGFjdGlvbnMuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmVyQ3JlYXRlID0gT2JzZXJ2ZXIuY3JlYXRlID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgIG9uTmV4dCB8fCAob25OZXh0ID0gbm9vcCk7XG5cdCAgICBvbkVycm9yIHx8IChvbkVycm9yID0gZGVmYXVsdEVycm9yKTtcblx0ICAgIG9uQ29tcGxldGVkIHx8IChvbkNvbXBsZXRlZCA9IG5vb3ApO1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZlcihvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBBYnN0cmFjdCBiYXNlIGNsYXNzIGZvciBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIE9ic2VydmVyIGNsYXNzLlxuXHQgICAqIFRoaXMgYmFzZSBjbGFzcyBlbmZvcmNlcyB0aGUgZ3JhbW1hciBvZiBvYnNlcnZlcnMgd2hlcmUgT25FcnJvciBhbmQgT25Db21wbGV0ZWQgYXJlIHRlcm1pbmFsIG1lc3NhZ2VzLlxuXHQgICAqL1xuXHQgIHZhciBBYnN0cmFjdE9ic2VydmVyID0gUnguaW50ZXJuYWxzLkFic3RyYWN0T2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQWJzdHJhY3RPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIENyZWF0ZXMgYSBuZXcgb2JzZXJ2ZXIgaW4gYSBub24tc3RvcHBlZCBzdGF0ZS5cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gQWJzdHJhY3RPYnNlcnZlcigpIHtcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBNdXN0IGJlIGltcGxlbWVudGVkIGJ5IG90aGVyIG9ic2VydmVyc1xuXHQgICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IG5vdEltcGxlbWVudGVkO1xuXHQgICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBub3RJbXBsZW1lbnRlZDtcblx0ICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IG5vdEltcGxlbWVudGVkO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTm90aWZpZXMgdGhlIG9ic2VydmVyIG9mIGEgbmV3IGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IHZhbHVlIE5leHQgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgKi9cblx0ICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAhdGhpcy5pc1N0b3BwZWQgJiYgdGhpcy5uZXh0KHZhbHVlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBOb3RpZmllcyB0aGUgb2JzZXJ2ZXIgdGhhdCBhbiBleGNlcHRpb24gaGFzIG9jY3VycmVkLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IGVycm9yIFRoZSBlcnJvciB0aGF0IGhhcyBvY2N1cnJlZC5cblx0ICAgICAqL1xuXHQgICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZXJyb3IoZXJyb3IpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTm90aWZpZXMgdGhlIG9ic2VydmVyIG9mIHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuXHQgICAgICovXG5cdCAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRGlzcG9zZXMgdGhlIG9ic2VydmVyLCBjYXVzaW5nIGl0IHRvIHRyYW5zaXRpb24gdG8gdGhlIHN0b3BwZWQgc3RhdGUuXG5cdCAgICAgKi9cblx0ICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcblx0XG5cdCAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmVycm9yKGUpO1xuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBBYnN0cmFjdE9ic2VydmVyO1xuXHQgIH0oT2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ2xhc3MgdG8gY3JlYXRlIGFuIE9ic2VydmVyIGluc3RhbmNlIGZyb20gZGVsZWdhdGUtYmFzZWQgaW1wbGVtZW50YXRpb25zIG9mIHRoZSBvbiogbWV0aG9kcy5cblx0ICAgKi9cblx0ICB2YXIgQW5vbnltb3VzT2JzZXJ2ZXIgPSBSeC5Bbm9ueW1vdXNPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhBbm9ueW1vdXNPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIENyZWF0ZXMgYW4gb2JzZXJ2ZXIgZnJvbSB0aGUgc3BlY2lmaWVkIE9uTmV4dCwgT25FcnJvciwgYW5kIE9uQ29tcGxldGVkIGFjdGlvbnMuXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gb25OZXh0IE9ic2VydmVyJ3MgT25OZXh0IGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7QW55fSBvbkVycm9yIE9ic2VydmVyJ3MgT25FcnJvciBhY3Rpb24gaW1wbGVtZW50YXRpb24uXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gb25Db21wbGV0ZWQgT2JzZXJ2ZXIncyBPbkNvbXBsZXRlZCBhY3Rpb24gaW1wbGVtZW50YXRpb24uXG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIEFub255bW91c09ic2VydmVyKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMuX29uTmV4dCA9IG9uTmV4dDtcblx0ICAgICAgdGhpcy5fb25FcnJvciA9IG9uRXJyb3I7XG5cdCAgICAgIHRoaXMuX29uQ29tcGxldGVkID0gb25Db21wbGV0ZWQ7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDYWxscyB0aGUgb25OZXh0IGFjdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7QW55fSB2YWx1ZSBOZXh0IGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuXHQgICAgICovXG5cdCAgICBBbm9ueW1vdXNPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICB0aGlzLl9vbk5leHQodmFsdWUpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIENhbGxzIHRoZSBvbkVycm9yIGFjdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7QW55fSBlcnJvciBUaGUgZXJyb3IgdGhhdCBoYXMgb2NjdXJyZWQuXG5cdCAgICAgKi9cblx0ICAgIEFub255bW91c09ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICB0aGlzLl9vbkVycm9yKGVycm9yKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiAgQ2FsbHMgdGhlIG9uQ29tcGxldGVkIGFjdGlvbi5cblx0ICAgICAqL1xuXHQgICAgQW5vbnltb3VzT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fb25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEFub255bW91c09ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICB2YXIgb2JzZXJ2YWJsZVByb3RvO1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXByZXNlbnRzIGEgcHVzaC1zdHlsZSBjb2xsZWN0aW9uLlxuXHQgICAqL1xuXHQgIHZhciBPYnNlcnZhYmxlID0gUnguT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoKSB7XG5cdFxuXHQgICAgZnVuY3Rpb24gbWFrZVN1YnNjcmliZShzZWxmLCBzdWJzY3JpYmUpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgdmFyIG9sZE9uRXJyb3IgPSBvLm9uRXJyb3I7XG5cdCAgICAgICAgby5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICAgIG1ha2VTdGFja1RyYWNlTG9uZyhlLCBzZWxmKTtcblx0ICAgICAgICAgIG9sZE9uRXJyb3IuY2FsbChvLCBlKTtcblx0ICAgICAgICB9O1xuXHRcblx0ICAgICAgICByZXR1cm4gc3Vic2NyaWJlLmNhbGwoc2VsZiwgbyk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gT2JzZXJ2YWJsZSgpIHtcblx0ICAgICAgaWYgKFJ4LmNvbmZpZy5sb25nU3RhY2tTdXBwb3J0ICYmIGhhc1N0YWNrcykge1xuXHQgICAgICAgIHZhciBvbGRTdWJzY3JpYmUgPSB0aGlzLl9zdWJzY3JpYmU7XG5cdCAgICAgICAgdmFyIGUgPSB0cnlDYXRjaCh0aHJvd2VyKShuZXcgRXJyb3IoKSkuZTtcblx0ICAgICAgICB0aGlzLnN0YWNrID0gZS5zdGFjay5zdWJzdHJpbmcoZS5zdGFjay5pbmRleE9mKCdcXG4nKSArIDEpO1xuXHQgICAgICAgIHRoaXMuX3N1YnNjcmliZSA9IG1ha2VTdWJzY3JpYmUodGhpcywgb2xkU3Vic2NyaWJlKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIG9ic2VydmFibGVQcm90byA9IE9ic2VydmFibGUucHJvdG90eXBlO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGdpdmVuIG9iamVjdCBpcyBhbiBPYnNlcnZhYmxlXG5cdCAgICAqIEBwYXJhbSB7QW55fSBBbiBvYmplY3QgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgaXQgaXMgYW4gT2JzZXJ2YWJsZVxuXHQgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gdHJ1ZSBpZiBhbiBPYnNlcnZhYmxlLCBlbHNlIGZhbHNlLlxuXHQgICAgKi9cblx0ICAgIE9ic2VydmFibGUuaXNPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIG8gJiYgaXNGdW5jdGlvbihvLnN1YnNjcmliZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogIFN1YnNjcmliZXMgYW4gbyB0byB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgICAqICBAcGFyYW0ge01peGVkfSBbb09yT25OZXh0XSBUaGUgb2JqZWN0IHRoYXQgaXMgdG8gcmVjZWl2ZSBub3RpZmljYXRpb25zIG9yIGFuIGFjdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgICAqICBAcGFyYW0ge0Z1bmN0aW9ufSBbb25FcnJvcl0gQWN0aW9uIHRvIGludm9rZSB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAgICogIEBwYXJhbSB7RnVuY3Rpb259IFtvbkNvbXBsZXRlZF0gQWN0aW9uIHRvIGludm9rZSB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAgICogIEByZXR1cm5zIHtEaXBvc2FibGV9IEEgZGlzcG9zYWJsZSBoYW5kbGluZyB0aGUgc3Vic2NyaXB0aW9ucyBhbmQgdW5zdWJzY3JpcHRpb25zLlxuXHQgICAgICovXG5cdCAgICBvYnNlcnZhYmxlUHJvdG8uc3Vic2NyaWJlID0gb2JzZXJ2YWJsZVByb3RvLmZvckVhY2ggPSBmdW5jdGlvbiAob09yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKHR5cGVvZiBvT3JPbk5leHQgPT09ICdvYmplY3QnID9cblx0ICAgICAgICBvT3JPbk5leHQgOlxuXHQgICAgICAgIG9ic2VydmVyQ3JlYXRlKG9Pck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTdWJzY3JpYmVzIHRvIHRoZSBuZXh0IHZhbHVlIGluIHRoZSBzZXF1ZW5jZSB3aXRoIGFuIG9wdGlvbmFsIFwidGhpc1wiIGFyZ3VtZW50LlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25OZXh0IFRoZSBmdW5jdGlvbiB0byBpbnZva2Ugb24gZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG5cdCAgICAgKi9cblx0ICAgIG9ic2VydmFibGVQcm90by5zdWJzY3JpYmVPbk5leHQgPSBmdW5jdGlvbiAob25OZXh0LCB0aGlzQXJnKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUob2JzZXJ2ZXJDcmVhdGUodHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24oeCkgeyBvbk5leHQuY2FsbCh0aGlzQXJnLCB4KTsgfSA6IG9uTmV4dCkpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFN1YnNjcmliZXMgdG8gYW4gZXhjZXB0aW9uYWwgY29uZGl0aW9uIGluIHRoZSBzZXF1ZW5jZSB3aXRoIGFuIG9wdGlvbmFsIFwidGhpc1wiIGFyZ3VtZW50LlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25FcnJvciBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIHVwb24gZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBBIGRpc3Bvc2FibGUgaGFuZGxpbmcgdGhlIHN1YnNjcmlwdGlvbnMgYW5kIHVuc3Vic2NyaXB0aW9ucy5cblx0ICAgICAqL1xuXHQgICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZU9uRXJyb3IgPSBmdW5jdGlvbiAob25FcnJvciwgdGhpc0FyZykge1xuXHQgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKG9ic2VydmVyQ3JlYXRlKG51bGwsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uKGUpIHsgb25FcnJvci5jYWxsKHRoaXNBcmcsIGUpOyB9IDogb25FcnJvcikpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFN1YnNjcmliZXMgdG8gdGhlIG5leHQgdmFsdWUgaW4gdGhlIHNlcXVlbmNlIHdpdGggYW4gb3B0aW9uYWwgXCJ0aGlzXCIgYXJndW1lbnQuXG5cdCAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkNvbXBsZXRlZCBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBBIGRpc3Bvc2FibGUgaGFuZGxpbmcgdGhlIHN1YnNjcmlwdGlvbnMgYW5kIHVuc3Vic2NyaXB0aW9ucy5cblx0ICAgICAqL1xuXHQgICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZU9uQ29tcGxldGVkID0gZnVuY3Rpb24gKG9uQ29tcGxldGVkLCB0aGlzQXJnKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUob2JzZXJ2ZXJDcmVhdGUobnVsbCwgbnVsbCwgdHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24oKSB7IG9uQ29tcGxldGVkLmNhbGwodGhpc0FyZyk7IH0gOiBvbkNvbXBsZXRlZCkpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gT2JzZXJ2YWJsZTtcblx0ICB9KSgpO1xuXHRcblx0ICB2YXIgU2NoZWR1bGVkT2JzZXJ2ZXIgPSBSeC5pbnRlcm5hbHMuU2NoZWR1bGVkT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2NoZWR1bGVkT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gU2NoZWR1bGVkT2JzZXJ2ZXIoc2NoZWR1bGVyLCBvYnNlcnZlcikge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgICAgdGhpcy5pc0FjcXVpcmVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaGFzRmF1bHRlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLnF1ZXVlID0gW107XG5cdCAgICAgIHRoaXMuZGlzcG9zYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICB0aGlzLnF1ZXVlLnB1c2goZnVuY3Rpb24gKCkgeyBzZWxmLm9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7IH0pO1xuXHQgICAgfTtcblx0XG5cdCAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgIHRoaXMucXVldWUucHVzaChmdW5jdGlvbiAoKSB7IHNlbGYub2JzZXJ2ZXIub25FcnJvcihlKTsgfSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgdGhpcy5xdWV1ZS5wdXNoKGZ1bmN0aW9uICgpIHsgc2VsZi5vYnNlcnZlci5vbkNvbXBsZXRlZCgpOyB9KTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLmVuc3VyZUFjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIGlzT3duZXIgPSBmYWxzZTtcblx0ICAgICAgaWYgKCF0aGlzLmhhc0ZhdWx0ZWQgJiYgdGhpcy5xdWV1ZS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgaXNPd25lciA9ICF0aGlzLmlzQWNxdWlyZWQ7XG5cdCAgICAgICAgdGhpcy5pc0FjcXVpcmVkID0gdHJ1ZTtcblx0ICAgICAgfVxuXHQgICAgICBpZiAoaXNPd25lcikge1xuXHQgICAgICAgIHRoaXMuZGlzcG9zYWJsZS5zZXREaXNwb3NhYmxlKHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKHRoaXMsIGZ1bmN0aW9uIChwYXJlbnQsIHNlbGYpIHtcblx0ICAgICAgICAgIHZhciB3b3JrO1xuXHQgICAgICAgICAgaWYgKHBhcmVudC5xdWV1ZS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgIHdvcmsgPSBwYXJlbnQucXVldWUuc2hpZnQoKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHBhcmVudC5pc0FjcXVpcmVkID0gZmFsc2U7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh3b3JrKSgpO1xuXHQgICAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHtcblx0ICAgICAgICAgICAgcGFyZW50LnF1ZXVlID0gW107XG5cdCAgICAgICAgICAgIHBhcmVudC5oYXNGYXVsdGVkID0gdHJ1ZTtcblx0ICAgICAgICAgICAgcmV0dXJuIHRocm93ZXIocmVzLmUpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgc2VsZihwYXJlbnQpO1xuXHQgICAgICAgIH0pKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgX19zdXBlcl9fLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMuZGlzcG9zYWJsZS5kaXNwb3NlKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTY2hlZHVsZWRPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgdmFyIE9ic2VydmFibGVCYXNlID0gUnguT2JzZXJ2YWJsZUJhc2UgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoT2JzZXJ2YWJsZUJhc2UsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gZml4U3Vic2NyaWJlcihzdWJzY3JpYmVyKSB7XG5cdCAgICAgIHJldHVybiBzdWJzY3JpYmVyICYmIGlzRnVuY3Rpb24oc3Vic2NyaWJlci5kaXNwb3NlKSA/IHN1YnNjcmliZXIgOlxuXHQgICAgICAgIGlzRnVuY3Rpb24oc3Vic2NyaWJlcikgPyBkaXNwb3NhYmxlQ3JlYXRlKHN1YnNjcmliZXIpIDogZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNldERpc3Bvc2FibGUocywgc3RhdGUpIHtcblx0ICAgICAgdmFyIGFkbyA9IHN0YXRlWzBdLCBzZWxmID0gc3RhdGVbMV07XG5cdCAgICAgIHZhciBzdWIgPSB0cnlDYXRjaChzZWxmLnN1YnNjcmliZUNvcmUpLmNhbGwoc2VsZiwgYWRvKTtcblx0ICAgICAgaWYgKHN1YiA9PT0gZXJyb3JPYmogJiYgIWFkby5mYWlsKGVycm9yT2JqLmUpKSB7IHRocm93ZXIoZXJyb3JPYmouZSk7IH1cblx0ICAgICAgYWRvLnNldERpc3Bvc2FibGUoZml4U3Vic2NyaWJlcihzdWIpKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBPYnNlcnZhYmxlQmFzZSgpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgT2JzZXJ2YWJsZUJhc2UucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgYWRvID0gbmV3IEF1dG9EZXRhY2hPYnNlcnZlcihvKSwgc3RhdGUgPSBbYWRvLCB0aGlzXTtcblx0XG5cdCAgICAgIGlmIChjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVxdWlyZWQoKSkge1xuXHQgICAgICAgIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNldERpc3Bvc2FibGUpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHNldERpc3Bvc2FibGUobnVsbCwgc3RhdGUpO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBhZG87XG5cdCAgICB9O1xuXHRcblx0ICAgIE9ic2VydmFibGVCYXNlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gbm90SW1wbGVtZW50ZWQ7XG5cdFxuXHQgICAgcmV0dXJuIE9ic2VydmFibGVCYXNlO1xuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0dmFyIEZsYXRNYXBPYnNlcnZhYmxlID0gUnguRmxhdE1hcE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdFxuXHQgICAgaW5oZXJpdHMoRmxhdE1hcE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gRmxhdE1hcE9ic2VydmFibGUoc291cmNlLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0ICAgICAgdGhpcy5yZXN1bHRTZWxlY3RvciA9IGlzRnVuY3Rpb24ocmVzdWx0U2VsZWN0b3IpID8gcmVzdWx0U2VsZWN0b3IgOiBudWxsO1xuXHQgICAgICB0aGlzLnNlbGVjdG9yID0gYmluZENhbGxiYWNrKGlzRnVuY3Rpb24oc2VsZWN0b3IpID8gc2VsZWN0b3IgOiBmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGVjdG9yOyB9LCB0aGlzQXJnLCAzKTtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEZsYXRNYXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMuc2VsZWN0b3IsIHRoaXMucmVzdWx0U2VsZWN0b3IsIHRoaXMpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG9ic2VydmVyLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHNvdXJjZSkge1xuXHQgICAgICB0aGlzLmkgPSAwO1xuXHQgICAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG5cdCAgICAgIHRoaXMucmVzdWx0U2VsZWN0b3IgPSByZXN1bHRTZWxlY3Rvcjtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMubyA9IG9ic2VydmVyO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuX3dyYXBSZXN1bHQgPSBmdW5jdGlvbihyZXN1bHQsIHgsIGkpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMucmVzdWx0U2VsZWN0b3IgP1xuXHQgICAgICAgIHJlc3VsdC5tYXAoZnVuY3Rpb24oeSwgaTIpIHsgcmV0dXJuIHRoaXMucmVzdWx0U2VsZWN0b3IoeCwgeSwgaSwgaTIpOyB9LCB0aGlzKSA6XG5cdCAgICAgICAgcmVzdWx0O1xuXHQgICAgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuXHQgICAgICB2YXIgaSA9IHRoaXMuaSsrO1xuXHQgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5zZWxlY3RvcikoeCwgaSwgdGhpcy5zb3VyY2UpO1xuXHQgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzdWx0LmUpOyB9XG5cdFxuXHQgICAgICBpc1Byb21pc2UocmVzdWx0KSAmJiAocmVzdWx0ID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHJlc3VsdCkpO1xuXHQgICAgICAoaXNBcnJheUxpa2UocmVzdWx0KSB8fCBpc0l0ZXJhYmxlKHJlc3VsdCkpICYmIChyZXN1bHQgPSBPYnNlcnZhYmxlLmZyb20ocmVzdWx0KSk7XG5cdCAgICAgIHRoaXMuby5vbk5leHQodGhpcy5fd3JhcFJlc3VsdChyZXN1bHQsIHgsIGkpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihlKSB7IHRoaXMuby5vbkVycm9yKGUpOyB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24oKSB7IHRoaXMuby5vbkNvbXBsZXRlZCgpOyB9O1xuXHRcblx0ICAgIHJldHVybiBGbGF0TWFwT2JzZXJ2YWJsZTtcblx0XG5cdH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIEVudW1lcmFibGUgPSBSeC5pbnRlcm5hbHMuRW51bWVyYWJsZSA9IGZ1bmN0aW9uICgpIHsgfTtcblx0XG5cdCAgZnVuY3Rpb24gSXNEaXNwb3NlZERpc3Bvc2FibGUoc3RhdGUpIHtcblx0ICAgIHRoaXMuX3MgPSBzdGF0ZTtcblx0ICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgIH1cblx0XG5cdCAgSXNEaXNwb3NlZERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICB0aGlzLl9zLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIHZhciBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUoc291cmNlcykge1xuXHQgICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBzdGF0ZSA9IHsgaXNEaXNwb3NlZDogZmFsc2UgfSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblx0ICAgICAgdmFyIGNhbmNlbGFibGUgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKHRoaXMuc291cmNlc1skaXRlcmF0b3IkXSgpLCBmdW5jdGlvbiAoZSwgc2VsZikge1xuXHQgICAgICAgIGlmIChzdGF0ZS5pc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHZhciBjdXJyZW50SXRlbSA9IHRyeUNhdGNoKGUubmV4dCkuY2FsbChlKTtcblx0ICAgICAgICBpZiAoY3VycmVudEl0ZW0gPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IoY3VycmVudEl0ZW0uZSk7IH1cblx0XG5cdCAgICAgICAgaWYgKGN1cnJlbnRJdGVtLmRvbmUpIHtcblx0ICAgICAgICAgIHJldHVybiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG5cdCAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGN1cnJlbnRJdGVtLnZhbHVlO1xuXHQgICAgICAgIGlzUHJvbWlzZShjdXJyZW50VmFsdWUpICYmIChjdXJyZW50VmFsdWUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoY3VycmVudFZhbHVlKSk7XG5cdFxuXHQgICAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgICAgZC5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgc2VsZiwgZSkpKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIG5ldyBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSldKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHMsIGUpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgICB0aGlzLl9lID0gZTtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fby5vbk5leHQoeCk7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fby5vbkVycm9yKGUpOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX3ModGhpcy5fZSk7IH07XG5cdFxuXHQgICAgcmV0dXJuIENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgRW51bWVyYWJsZS5wcm90b3R5cGUuY29uY2F0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSh0aGlzKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgQ2F0Y2hFcnJvck9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDYXRjaEVycm9yT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENhdGNoRXJyb3JPYnNlcnZhYmxlKHNvdXJjZXMpIHtcblx0ICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlcztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgQ2F0Y2hFcnJvck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgZSA9IHRoaXMuc291cmNlc1skaXRlcmF0b3IkXSgpO1xuXHRcblx0ICAgICAgdmFyIHN0YXRlID0geyBpc0Rpc3Bvc2VkOiBmYWxzZSB9LCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXHQgICAgICB2YXIgY2FuY2VsYWJsZSA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUobnVsbCwgZnVuY3Rpb24gKGxhc3RFeGNlcHRpb24sIHNlbGYpIHtcblx0ICAgICAgICBpZiAoc3RhdGUuaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSB0cnlDYXRjaChlLm5leHQpLmNhbGwoZSk7XG5cdCAgICAgICAgaWYgKGN1cnJlbnRJdGVtID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKGN1cnJlbnRJdGVtLmUpOyB9XG5cdFxuXHQgICAgICAgIGlmIChjdXJyZW50SXRlbS5kb25lKSB7XG5cdCAgICAgICAgICByZXR1cm4gbGFzdEV4Y2VwdGlvbiAhPT0gbnVsbCA/IG8ub25FcnJvcihsYXN0RXhjZXB0aW9uKSA6IG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIENoZWNrIGlmIHByb21pc2Vcblx0ICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gY3VycmVudEl0ZW0udmFsdWU7XG5cdCAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblx0XG5cdCAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgICBkLnNldERpc3Bvc2FibGUoY3VycmVudFZhbHVlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCBzZWxmKSkpO1xuXHQgICAgICB9KTtcblx0ICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShbc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlLCBuZXcgSXNEaXNwb3NlZERpc3Bvc2FibGUoc3RhdGUpXSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCByZWN1cnNlKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9yZWN1cnNlID0gcmVjdXJzZTtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLl9vLm9uTmV4dCh4KTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fcmVjdXJzZShlKTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXHRcblx0ICAgIHJldHVybiBDYXRjaEVycm9yT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIEVudW1lcmFibGUucHJvdG90eXBlLmNhdGNoRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IENhdGNoRXJyb3JPYnNlcnZhYmxlKHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIEVudW1lcmFibGUucHJvdG90eXBlLmNhdGNoRXJyb3JXaGVuID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbkhhbmRsZXIpIHtcblx0ICAgIHZhciBzb3VyY2VzID0gdGhpcztcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgZXhjZXB0aW9ucyA9IG5ldyBTdWJqZWN0KCksXG5cdCAgICAgICAgbm90aWZpZXIgPSBuZXcgU3ViamVjdCgpLFxuXHQgICAgICAgIGhhbmRsZWQgPSBub3RpZmljYXRpb25IYW5kbGVyKGV4Y2VwdGlvbnMpLFxuXHQgICAgICAgIG5vdGlmaWNhdGlvbkRpc3Bvc2FibGUgPSBoYW5kbGVkLnN1YnNjcmliZShub3RpZmllcik7XG5cdFxuXHQgICAgICB2YXIgZSA9IHNvdXJjZXNbJGl0ZXJhdG9yJF0oKTtcblx0XG5cdCAgICAgIHZhciBzdGF0ZSA9IHsgaXNEaXNwb3NlZDogZmFsc2UgfSxcblx0ICAgICAgICBsYXN0RXhjZXB0aW9uLFxuXHQgICAgICAgIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cdCAgICAgIHZhciBjYW5jZWxhYmxlID0gY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZShudWxsLCBmdW5jdGlvbiAoXywgc2VsZikge1xuXHQgICAgICAgIGlmIChzdGF0ZS5pc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHZhciBjdXJyZW50SXRlbSA9IHRyeUNhdGNoKGUubmV4dCkuY2FsbChlKTtcblx0ICAgICAgICBpZiAoY3VycmVudEl0ZW0gPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IoY3VycmVudEl0ZW0uZSk7IH1cblx0XG5cdCAgICAgICAgaWYgKGN1cnJlbnRJdGVtLmRvbmUpIHtcblx0ICAgICAgICAgIGlmIChsYXN0RXhjZXB0aW9uKSB7XG5cdCAgICAgICAgICAgIG8ub25FcnJvcihsYXN0RXhjZXB0aW9uKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIENoZWNrIGlmIHByb21pc2Vcblx0ICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gY3VycmVudEl0ZW0udmFsdWU7XG5cdCAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblx0XG5cdCAgICAgICAgdmFyIG91dGVyID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgdmFyIGlubmVyID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUobmV3IEJpbmFyeURpc3Bvc2FibGUoaW5uZXIsIG91dGVyKSk7XG5cdCAgICAgICAgb3V0ZXIuc2V0RGlzcG9zYWJsZShjdXJyZW50VmFsdWUuc3Vic2NyaWJlKFxuXHQgICAgICAgICAgZnVuY3Rpb24oeCkgeyBvLm9uTmV4dCh4KTsgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uIChleG4pIHtcblx0ICAgICAgICAgICAgaW5uZXIuc2V0RGlzcG9zYWJsZShub3RpZmllci5zdWJzY3JpYmUoc2VsZiwgZnVuY3Rpb24oZXgpIHtcblx0ICAgICAgICAgICAgICBvLm9uRXJyb3IoZXgpO1xuXHQgICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcblx0ICAgICAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICAgIH0pKTtcblx0XG5cdCAgICAgICAgICAgIGV4Y2VwdGlvbnMub25OZXh0KGV4bik7XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24oKSB7IG8ub25Db21wbGV0ZWQoKTsgfSkpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoW25vdGlmaWNhdGlvbkRpc3Bvc2FibGUsIHN1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSwgbmV3IElzRGlzcG9zZWREaXNwb3NhYmxlKHN0YXRlKV0pO1xuXHQgICAgfSk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFJlcGVhdEVudW1lcmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoUmVwZWF0RW51bWVyYWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBSZXBlYXRFbnVtZXJhYmxlKHYsIGMpIHtcblx0ICAgICAgdGhpcy52ID0gdjtcblx0ICAgICAgdGhpcy5jID0gYyA9PSBudWxsID8gLTEgOiBjO1xuXHQgICAgfVxuXHQgICAgUmVwZWF0RW51bWVyYWJsZS5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBuZXcgUmVwZWF0RW51bWVyYXRvcih0aGlzKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gUmVwZWF0RW51bWVyYXRvcihwKSB7XG5cdCAgICAgIHRoaXMudiA9IHAudjtcblx0ICAgICAgdGhpcy5sID0gcC5jO1xuXHQgICAgfVxuXHQgICAgUmVwZWF0RW51bWVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKHRoaXMubCA9PT0gMCkgeyByZXR1cm4gZG9uZUVudW1lcmF0b3I7IH1cblx0ICAgICAgaWYgKHRoaXMubCA+IDApIHsgdGhpcy5sLS07IH1cblx0ICAgICAgcmV0dXJuIHsgZG9uZTogZmFsc2UsIHZhbHVlOiB0aGlzLnYgfTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFJlcGVhdEVudW1lcmFibGU7XG5cdCAgfShFbnVtZXJhYmxlKSk7XG5cdFxuXHQgIHZhciBlbnVtZXJhYmxlUmVwZWF0ID0gRW51bWVyYWJsZS5yZXBlYXQgPSBmdW5jdGlvbiAodmFsdWUsIHJlcGVhdENvdW50KSB7XG5cdCAgICByZXR1cm4gbmV3IFJlcGVhdEVudW1lcmFibGUodmFsdWUsIHJlcGVhdENvdW50KTtcblx0ICB9O1xuXHRcblx0ICB2YXIgT2ZFbnVtZXJhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoT2ZFbnVtZXJhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gT2ZFbnVtZXJhYmxlKHMsIGZuLCB0aGlzQXJnKSB7XG5cdCAgICAgIHRoaXMucyA9IHM7XG5cdCAgICAgIHRoaXMuZm4gPSBmbiA/IGJpbmRDYWxsYmFjayhmbiwgdGhpc0FyZywgMykgOiBudWxsO1xuXHQgICAgfVxuXHQgICAgT2ZFbnVtZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBPZkVudW1lcmF0b3IodGhpcyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIE9mRW51bWVyYXRvcihwKSB7XG5cdCAgICAgIHRoaXMuaSA9IC0xO1xuXHQgICAgICB0aGlzLnMgPSBwLnM7XG5cdCAgICAgIHRoaXMubCA9IHRoaXMucy5sZW5ndGg7XG5cdCAgICAgIHRoaXMuZm4gPSBwLmZuO1xuXHQgICAgfVxuXHQgICAgT2ZFbnVtZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgIHJldHVybiArK3RoaXMuaSA8IHRoaXMubCA/XG5cdCAgICAgICB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogIXRoaXMuZm4gPyB0aGlzLnNbdGhpcy5pXSA6IHRoaXMuZm4odGhpcy5zW3RoaXMuaV0sIHRoaXMuaSwgdGhpcy5zKSB9IDpcblx0ICAgICAgIGRvbmVFbnVtZXJhdG9yO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gT2ZFbnVtZXJhYmxlO1xuXHQgIH0oRW51bWVyYWJsZSkpO1xuXHRcblx0ICB2YXIgZW51bWVyYWJsZU9mID0gRW51bWVyYWJsZS5vZiA9IGZ1bmN0aW9uIChzb3VyY2UsIHNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdCAgICByZXR1cm4gbmV3IE9mRW51bWVyYWJsZShzb3VyY2UsIHNlbGVjdG9yLCB0aGlzQXJnKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgVG9BcnJheU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUb0FycmF5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRvQXJyYXlPYnNlcnZhYmxlKHNvdXJjZSkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVG9BcnJheU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobykpO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobykge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLmEgPSBbXTtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHQgICAgXG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5hLnB1c2goeCk7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuby5vbkVycm9yKGUpOyAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5vLm9uTmV4dCh0aGlzLmEpOyB0aGlzLm8ub25Db21wbGV0ZWQoKTsgfTtcblx0XG5cdCAgICByZXR1cm4gVG9BcnJheU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAqIENyZWF0ZXMgYW4gYXJyYXkgZnJvbSBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyBhIHNpbmdsZSBlbGVtZW50IHdpdGggYSBsaXN0IGNvbnRhaW5pbmcgYWxsIHRoZSBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRvQXJyYXkgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IFRvQXJyYXlPYnNlcnZhYmxlKHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBDcmVhdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgZnJvbSBhIHNwZWNpZmllZCBzdWJzY3JpYmUgbWV0aG9kIGltcGxlbWVudGF0aW9uLlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmNyZWF0ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgfSApO1xuXHQgICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBSeC5EaXNwb3NhYmxlLmVtcHR5OyB9ICk7XG5cdCAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmNyZWF0ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgfSApO1xuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IHN1YnNjcmliZSBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgcmVzdWx0aW5nIG9ic2VydmFibGUgc2VxdWVuY2UncyBzdWJzY3JpYmUgbWV0aG9kLCByZXR1cm5pbmcgYSBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgd3JhcHBlZCBpbiBhIERpc3Bvc2FibGUuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGhlIHNwZWNpZmllZCBpbXBsZW1lbnRhdGlvbiBmb3IgdGhlIFN1YnNjcmliZSBtZXRob2QuXG5cdCAgICovXG5cdCAgT2JzZXJ2YWJsZS5jcmVhdGUgPSBmdW5jdGlvbiAoc3Vic2NyaWJlLCBwYXJlbnQpIHtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShzdWJzY3JpYmUsIHBhcmVudCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIERlZmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRGVmZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBEZWZlcihmYWN0b3J5KSB7XG5cdCAgICAgIHRoaXMuX2YgPSBmYWN0b3J5O1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBEZWZlci5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLl9mKSgpO1xuXHQgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gb2JzZXJ2YWJsZVRocm93KHJlc3VsdC5lKS5zdWJzY3JpYmUobyk7fVxuXHQgICAgICBpc1Byb21pc2UocmVzdWx0KSAmJiAocmVzdWx0ID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHJlc3VsdCkpO1xuXHQgICAgICByZXR1cm4gcmVzdWx0LnN1YnNjcmliZShvKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIERlZmVyO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGludm9rZXMgdGhlIHNwZWNpZmllZCBmYWN0b3J5IGZ1bmN0aW9uIHdoZW5ldmVyIGEgbmV3IG9ic2VydmVyIHN1YnNjcmliZXMuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5kZWZlcihmdW5jdGlvbiAoKSB7IHJldHVybiBSeC5PYnNlcnZhYmxlLmZyb21BcnJheShbMSwyLDNdKTsgfSk7XG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gb2JzZXJ2YWJsZUZhY3RvcnkgT2JzZXJ2YWJsZSBmYWN0b3J5IGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBvYnNlcnZlciB0aGF0IHN1YnNjcmliZXMgdG8gdGhlIHJlc3VsdGluZyBzZXF1ZW5jZSBvciBQcm9taXNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIG9ic2VydmVycyB0cmlnZ2VyIGFuIGludm9jYXRpb24gb2YgdGhlIGdpdmVuIG9ic2VydmFibGUgZmFjdG9yeSBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZURlZmVyID0gT2JzZXJ2YWJsZS5kZWZlciA9IGZ1bmN0aW9uIChvYnNlcnZhYmxlRmFjdG9yeSkge1xuXHQgICAgcmV0dXJuIG5ldyBEZWZlcihvYnNlcnZhYmxlRmFjdG9yeSk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIEVtcHR5T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEVtcHR5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEVtcHR5T2JzZXJ2YWJsZShzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEVtcHR5T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBFbXB0eVNpbmsob2JzZXJ2ZXIsIHRoaXMuc2NoZWR1bGVyKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIEVtcHR5U2luayhvYnNlcnZlciwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2NoZWR1bGVJdGVtKHMsIHN0YXRlKSB7XG5cdCAgICAgIHN0YXRlLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICB9XG5cdFxuXHQgICAgRW1wdHlTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciBzdGF0ZSA9IHRoaXMub2JzZXJ2ZXI7XG5cdCAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlciA9PT0gaW1tZWRpYXRlU2NoZWR1bGVyID9cblx0ICAgICAgICBzY2hlZHVsZUl0ZW0obnVsbCwgc3RhdGUpIDpcblx0ICAgICAgICB0aGlzLnNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZSwgc2NoZWR1bGVJdGVtKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEVtcHR5T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBFTVBUWV9PQlNFUlZBQkxFID0gbmV3IEVtcHR5T2JzZXJ2YWJsZShpbW1lZGlhdGVTY2hlZHVsZXIpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBhbiBlbXB0eSBvYnNlcnZhYmxlIHNlcXVlbmNlLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCB0aGUgc2luZ2xlIE9uQ29tcGxldGVkIG1lc3NhZ2UuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5lbXB0eSgpO1xuXHQgICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5lbXB0eShSeC5TY2hlZHVsZXIudGltZW91dCk7XG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBzZW5kIHRoZSB0ZXJtaW5hdGlvbiBjYWxsIG9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggbm8gZWxlbWVudHMuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVFbXB0eSA9IE9ic2VydmFibGUuZW1wdHkgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIHNjaGVkdWxlciA9PT0gaW1tZWRpYXRlU2NoZWR1bGVyID8gRU1QVFlfT0JTRVJWQUJMRSA6IG5ldyBFbXB0eU9ic2VydmFibGUoc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgRnJvbU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhGcm9tT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEZyb21PYnNlcnZhYmxlKGl0ZXJhYmxlLCBtYXBwZXIsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLml0ZXJhYmxlID0gaXRlcmFibGU7XG5cdCAgICAgIHRoaXMubWFwcGVyID0gbWFwcGVyO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRnJvbU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBGcm9tU2luayhvLCB0aGlzKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBGcm9tT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBGcm9tU2luayA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBGcm9tU2luayhvLCBwYXJlbnQpIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgICB9XG5cdFxuXHQgICAgRnJvbVNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIGxpc3QgPSBPYmplY3QodGhpcy5wYXJlbnQuaXRlcmFibGUpLFxuXHQgICAgICAgICAgaXQgPSBnZXRJdGVyYWJsZShsaXN0KSxcblx0ICAgICAgICAgIG8gPSB0aGlzLm8sXG5cdCAgICAgICAgICBtYXBwZXIgPSB0aGlzLnBhcmVudC5tYXBwZXI7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGksIHJlY3Vyc2UpIHtcblx0ICAgICAgICB2YXIgbmV4dCA9IHRyeUNhdGNoKGl0Lm5leHQpLmNhbGwoaXQpO1xuXHQgICAgICAgIGlmIChuZXh0ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKG5leHQuZSk7IH1cblx0ICAgICAgICBpZiAobmV4dC5kb25lKSB7IHJldHVybiBvLm9uQ29tcGxldGVkKCk7IH1cblx0XG5cdCAgICAgICAgdmFyIHJlc3VsdCA9IG5leHQudmFsdWU7XG5cdFxuXHQgICAgICAgIGlmIChpc0Z1bmN0aW9uKG1hcHBlcikpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IHRyeUNhdGNoKG1hcHBlcikocmVzdWx0LCBpKTtcblx0ICAgICAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0LmUpOyB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBvLm9uTmV4dChyZXN1bHQpO1xuXHQgICAgICAgIHJlY3Vyc2UoaSArIDEpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKDAsIGxvb3BSZWN1cnNpdmUpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRnJvbVNpbms7XG5cdCAgfSgpKTtcblx0XG5cdCAgdmFyIG1heFNhZmVJbnRlZ2VyID0gTWF0aC5wb3coMiwgNTMpIC0gMTtcblx0XG5cdCAgZnVuY3Rpb24gU3RyaW5nSXRlcmFibGUocykge1xuXHQgICAgdGhpcy5fcyA9IHM7XG5cdCAgfVxuXHRcblx0ICBTdHJpbmdJdGVyYWJsZS5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IFN0cmluZ0l0ZXJhdG9yKHRoaXMuX3MpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIFN0cmluZ0l0ZXJhdG9yKHMpIHtcblx0ICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgdGhpcy5fbCA9IHMubGVuZ3RoO1xuXHQgICAgdGhpcy5faSA9IDA7XG5cdCAgfVxuXHRcblx0ICBTdHJpbmdJdGVyYXRvci5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcztcblx0ICB9O1xuXHRcblx0ICBTdHJpbmdJdGVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzLl9pIDwgdGhpcy5fbCA/IHsgZG9uZTogZmFsc2UsIHZhbHVlOiB0aGlzLl9zLmNoYXJBdCh0aGlzLl9pKyspIH0gOiBkb25lRW51bWVyYXRvcjtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBBcnJheUl0ZXJhYmxlKGEpIHtcblx0ICAgIHRoaXMuX2EgPSBhO1xuXHQgIH1cblx0XG5cdCAgQXJyYXlJdGVyYWJsZS5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IEFycmF5SXRlcmF0b3IodGhpcy5fYSk7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gQXJyYXlJdGVyYXRvcihhKSB7XG5cdCAgICB0aGlzLl9hID0gYTtcblx0ICAgIHRoaXMuX2wgPSB0b0xlbmd0aChhKTtcblx0ICAgIHRoaXMuX2kgPSAwO1xuXHQgIH1cblx0XG5cdCAgQXJyYXlJdGVyYXRvci5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcztcblx0ICB9O1xuXHRcblx0ICBBcnJheUl0ZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXMuX2kgPCB0aGlzLl9sID8geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMuX2FbdGhpcy5faSsrXSB9IDogZG9uZUVudW1lcmF0b3I7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gbnVtYmVySXNGaW5pdGUodmFsdWUpIHtcblx0ICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIHJvb3QuaXNGaW5pdGUodmFsdWUpO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gaXNOYW4obikge1xuXHQgICAgcmV0dXJuIG4gIT09IG47XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBnZXRJdGVyYWJsZShvKSB7XG5cdCAgICB2YXIgaSA9IG9bJGl0ZXJhdG9yJF0sIGl0O1xuXHQgICAgaWYgKCFpICYmIHR5cGVvZiBvID09PSAnc3RyaW5nJykge1xuXHQgICAgICBpdCA9IG5ldyBTdHJpbmdJdGVyYWJsZShvKTtcblx0ICAgICAgcmV0dXJuIGl0WyRpdGVyYXRvciRdKCk7XG5cdCAgICB9XG5cdCAgICBpZiAoIWkgJiYgby5sZW5ndGggIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICBpdCA9IG5ldyBBcnJheUl0ZXJhYmxlKG8pO1xuXHQgICAgICByZXR1cm4gaXRbJGl0ZXJhdG9yJF0oKTtcblx0ICAgIH1cblx0ICAgIGlmICghaSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdPYmplY3QgaXMgbm90IGl0ZXJhYmxlJyk7IH1cblx0ICAgIHJldHVybiBvWyRpdGVyYXRvciRdKCk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBzaWduKHZhbHVlKSB7XG5cdCAgICB2YXIgbnVtYmVyID0gK3ZhbHVlO1xuXHQgICAgaWYgKG51bWJlciA9PT0gMCkgeyByZXR1cm4gbnVtYmVyOyB9XG5cdCAgICBpZiAoaXNOYU4obnVtYmVyKSkgeyByZXR1cm4gbnVtYmVyOyB9XG5cdCAgICByZXR1cm4gbnVtYmVyIDwgMCA/IC0xIDogMTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHRvTGVuZ3RoKG8pIHtcblx0ICAgIHZhciBsZW4gPSArby5sZW5ndGg7XG5cdCAgICBpZiAoaXNOYU4obGVuKSkgeyByZXR1cm4gMDsgfVxuXHQgICAgaWYgKGxlbiA9PT0gMCB8fCAhbnVtYmVySXNGaW5pdGUobGVuKSkgeyByZXR1cm4gbGVuOyB9XG5cdCAgICBsZW4gPSBzaWduKGxlbikgKiBNYXRoLmZsb29yKE1hdGguYWJzKGxlbikpO1xuXHQgICAgaWYgKGxlbiA8PSAwKSB7IHJldHVybiAwOyB9XG5cdCAgICBpZiAobGVuID4gbWF4U2FmZUludGVnZXIpIHsgcmV0dXJuIG1heFNhZmVJbnRlZ2VyOyB9XG5cdCAgICByZXR1cm4gbGVuO1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgKiBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgbmV3IE9ic2VydmFibGUgc2VxdWVuY2UgZnJvbSBhbiBhcnJheS1saWtlIG9yIGl0ZXJhYmxlIG9iamVjdC5cblx0ICAqIEBwYXJhbSB7QW55fSBhcnJheUxpa2UgQW4gYXJyYXktbGlrZSBvciBpdGVyYWJsZSBvYmplY3QgdG8gY29udmVydCB0byBhbiBPYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gW21hcEZuXSBNYXAgZnVuY3Rpb24gdG8gY2FsbCBvbiBldmVyeSBlbGVtZW50IG9mIHRoZSBhcnJheS5cblx0ICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gVGhlIGNvbnRleHQgdG8gdXNlIGNhbGxpbmcgdGhlIG1hcEZuIGlmIHByb3ZpZGVkLlxuXHQgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIE9wdGlvbmFsIHNjaGVkdWxlciB0byB1c2UgZm9yIHNjaGVkdWxpbmcuICBJZiBub3QgcHJvdmlkZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5jdXJyZW50VGhyZWFkLlxuXHQgICovXG5cdCAgdmFyIG9ic2VydmFibGVGcm9tID0gT2JzZXJ2YWJsZS5mcm9tID0gZnVuY3Rpb24gKGl0ZXJhYmxlLCBtYXBGbiwgdGhpc0FyZywgc2NoZWR1bGVyKSB7XG5cdCAgICBpZiAoaXRlcmFibGUgPT0gbnVsbCkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2l0ZXJhYmxlIGNhbm5vdCBiZSBudWxsLicpXG5cdCAgICB9XG5cdCAgICBpZiAobWFwRm4gJiYgIWlzRnVuY3Rpb24obWFwRm4pKSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcignbWFwRm4gd2hlbiBwcm92aWRlZCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblx0ICAgIH1cblx0ICAgIGlmIChtYXBGbikge1xuXHQgICAgICB2YXIgbWFwcGVyID0gYmluZENhbGxiYWNrKG1hcEZuLCB0aGlzQXJnLCAyKTtcblx0ICAgIH1cblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBGcm9tT2JzZXJ2YWJsZShpdGVyYWJsZSwgbWFwcGVyLCBzY2hlZHVsZXIpO1xuXHQgIH1cblx0XG5cdCAgdmFyIEZyb21BcnJheU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhGcm9tQXJyYXlPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRnJvbUFycmF5T2JzZXJ2YWJsZShhcmdzLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5hcmdzID0gYXJncztcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEZyb21BcnJheU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgRnJvbUFycmF5U2luayhvYnNlcnZlciwgdGhpcyk7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRnJvbUFycmF5T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIGZ1bmN0aW9uIEZyb21BcnJheVNpbmsob2JzZXJ2ZXIsIHBhcmVudCkge1xuXHQgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGFyZ3MsIG9ic2VydmVyKSB7XG5cdCAgICB2YXIgbGVuID0gYXJncy5sZW5ndGg7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24gbG9vcCAoaSwgcmVjdXJzZSkge1xuXHQgICAgICBpZiAoaSA8IGxlbikge1xuXHQgICAgICAgIG9ic2VydmVyLm9uTmV4dChhcmdzW2ldKTtcblx0ICAgICAgICByZWN1cnNlKGkgKyAxKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgRnJvbUFycmF5U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBsb29wUmVjdXJzaXZlKHRoaXMucGFyZW50LmFyZ3MsIHRoaXMub2JzZXJ2ZXIpKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAqICBDb252ZXJ0cyBhbiBhcnJheSB0byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLCB1c2luZyBhbiBvcHRpb25hbCBzY2hlZHVsZXIgdG8gZW51bWVyYXRlIHRoZSBhcnJheS5cblx0ICAqIEBkZXByZWNhdGVkIHVzZSBPYnNlcnZhYmxlLmZyb20gb3IgT2JzZXJ2YWJsZS5vZlxuXHQgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIGVudW1lcmF0aW9uIG9mIHRoZSBpbnB1dCBzZXF1ZW5jZSBvbi5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgcHVsbGVkIGZyb20gdGhlIGdpdmVuIGVudW1lcmFibGUgc2VxdWVuY2UuXG5cdCAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZUZyb21BcnJheSA9IE9ic2VydmFibGUuZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFycmF5LCBzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpXG5cdCAgfTtcblx0XG5cdCAgdmFyIE5ldmVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE5ldmVyT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE5ldmVyT2JzZXJ2YWJsZSgpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgTmV2ZXJPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBOZXZlck9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgTkVWRVJfT0JTRVJWQUJMRSA9IG5ldyBOZXZlck9ic2VydmFibGUoKTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhIG5vbi10ZXJtaW5hdGluZyBvYnNlcnZhYmxlIHNlcXVlbmNlLCB3aGljaCBjYW4gYmUgdXNlZCB0byBkZW5vdGUgYW4gaW5maW5pdGUgZHVyYXRpb24gKGUuZy4gd2hlbiB1c2luZyByZWFjdGl2ZSBqb2lucykuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2Ugb2JzZXJ2ZXJzIHdpbGwgbmV2ZXIgZ2V0IGNhbGxlZC5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZU5ldmVyID0gT2JzZXJ2YWJsZS5uZXZlciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBORVZFUl9PQlNFUlZBQkxFO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIG9ic2VydmFibGVPZiAoc2NoZWR1bGVyLCBhcnJheSkge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IEZyb21BcnJheU9ic2VydmFibGUoYXJyYXksIHNjaGVkdWxlcik7XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAqICBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgbmV3IE9ic2VydmFibGUgaW5zdGFuY2Ugd2l0aCBhIHZhcmlhYmxlIG51bWJlciBvZiBhcmd1bWVudHMsIHJlZ2FyZGxlc3Mgb2YgbnVtYmVyIG9yIHR5cGUgb2YgdGhlIGFyZ3VtZW50cy5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgcHVsbGVkIGZyb20gdGhlIGdpdmVuIGFyZ3VtZW50cy5cblx0ICAqL1xuXHQgIE9ic2VydmFibGUub2YgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHJldHVybiBuZXcgRnJvbUFycmF5T2JzZXJ2YWJsZShhcmdzLCBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAqICBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgbmV3IE9ic2VydmFibGUgaW5zdGFuY2Ugd2l0aCBhIHZhcmlhYmxlIG51bWJlciBvZiBhcmd1bWVudHMsIHJlZ2FyZGxlc3Mgb2YgbnVtYmVyIG9yIHR5cGUgb2YgdGhlIGFyZ3VtZW50cy5cblx0ICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBzY2hlZHVsZXIgQSBzY2hlZHVsZXIgdG8gdXNlIGZvciBzY2hlZHVsaW5nIHRoZSBhcmd1bWVudHMuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2UgZWxlbWVudHMgYXJlIHB1bGxlZCBmcm9tIHRoZSBnaXZlbiBhcmd1bWVudHMuXG5cdCAgKi9cblx0ICBPYnNlcnZhYmxlLm9mV2l0aFNjaGVkdWxlciA9IGZ1bmN0aW9uIChzY2hlZHVsZXIpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbiAtIDEpO1xuXHQgICAgZm9yKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICByZXR1cm4gbmV3IEZyb21BcnJheU9ic2VydmFibGUoYXJncywgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgUGFpcnNPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoUGFpcnNPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gUGFpcnNPYnNlcnZhYmxlKG9iaiwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMub2JqID0gb2JqO1xuXHQgICAgICB0aGlzLmtleXMgPSBPYmplY3Qua2V5cyhvYmopO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgUGFpcnNPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IFBhaXJzU2luayhvYnNlcnZlciwgdGhpcyk7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUGFpcnNPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgZnVuY3Rpb24gUGFpcnNTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcblx0ICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgIH1cblx0XG5cdCAgUGFpcnNTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgb2JzZXJ2ZXIgPSB0aGlzLm9ic2VydmVyLCBvYmogPSB0aGlzLnBhcmVudC5vYmosIGtleXMgPSB0aGlzLnBhcmVudC5rZXlzLCBsZW4gPSBrZXlzLmxlbmd0aDtcblx0ICAgIGZ1bmN0aW9uIGxvb3BSZWN1cnNpdmUoaSwgcmVjdXJzZSkge1xuXHQgICAgICBpZiAoaSA8IGxlbikge1xuXHQgICAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuXHQgICAgICAgIG9ic2VydmVyLm9uTmV4dChba2V5LCBvYmpba2V5XV0pO1xuXHQgICAgICAgIHJlY3Vyc2UoaSArIDEpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gdGhpcy5wYXJlbnQuc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKDAsIGxvb3BSZWN1cnNpdmUpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIENvbnZlcnQgYW4gb2JqZWN0IGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBba2V5LCB2YWx1ZV0gcGFpcnMuXG5cdCAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIGVudW1lcmF0aW9uIG9mIHRoZSBpbnB1dCBzZXF1ZW5jZSBvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBba2V5LCB2YWx1ZV0gcGFpcnMgZnJvbSB0aGUgb2JqZWN0LlxuXHQgICAqL1xuXHQgIE9ic2VydmFibGUucGFpcnMgPSBmdW5jdGlvbiAob2JqLCBzY2hlZHVsZXIpIHtcblx0ICAgIHNjaGVkdWxlciB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IFBhaXJzT2JzZXJ2YWJsZShvYmosIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgICB2YXIgUmFuZ2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoUmFuZ2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gUmFuZ2VPYnNlcnZhYmxlKHN0YXJ0LCBjb3VudCwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMuc3RhcnQgPSBzdGFydDtcblx0ICAgICAgdGhpcy5yYW5nZUNvdW50ID0gY291bnQ7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBSYW5nZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgUmFuZ2VTaW5rKG9ic2VydmVyLCB0aGlzKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBSYW5nZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgUmFuZ2VTaW5rID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIFJhbmdlU2luayhvYnNlcnZlciwgcGFyZW50KSB7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShzdGFydCwgY291bnQsIG9ic2VydmVyKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiBsb29wIChpLCByZWN1cnNlKSB7XG5cdCAgICAgICAgaWYgKGkgPCBjb3VudCkge1xuXHQgICAgICAgICAgb2JzZXJ2ZXIub25OZXh0KHN0YXJ0ICsgaSk7XG5cdCAgICAgICAgICByZWN1cnNlKGkgKyAxKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgUmFuZ2VTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoXG5cdCAgICAgICAgMCxcblx0ICAgICAgICBsb29wUmVjdXJzaXZlKHRoaXMucGFyZW50LnN0YXJ0LCB0aGlzLnBhcmVudC5yYW5nZUNvdW50LCB0aGlzLm9ic2VydmVyKVxuXHQgICAgICApO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUmFuZ2VTaW5rO1xuXHQgIH0oKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogIEdlbmVyYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIGludGVncmFsIG51bWJlcnMgd2l0aGluIGEgc3BlY2lmaWVkIHJhbmdlLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCBvYnNlcnZlciBtZXNzYWdlcy5cblx0ICAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydCBUaGUgdmFsdWUgb2YgdGhlIGZpcnN0IGludGVnZXIgaW4gdGhlIHNlcXVlbmNlLlxuXHQgICogQHBhcmFtIHtOdW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2Ygc2VxdWVudGlhbCBpbnRlZ2VycyB0byBnZW5lcmF0ZS5cblx0ICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSBnZW5lcmF0b3IgbG9vcCBvbi4gSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmN1cnJlbnRUaHJlYWQuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIGEgcmFuZ2Ugb2Ygc2VxdWVudGlhbCBpbnRlZ3JhbCBudW1iZXJzLlxuXHQgICovXG5cdCAgT2JzZXJ2YWJsZS5yYW5nZSA9IGZ1bmN0aW9uIChzdGFydCwgY291bnQsIHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IFJhbmdlT2JzZXJ2YWJsZShzdGFydCwgY291bnQsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFJlcGVhdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhSZXBlYXRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gUmVwZWF0T2JzZXJ2YWJsZSh2YWx1ZSwgcmVwZWF0Q291bnQsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cdCAgICAgIHRoaXMucmVwZWF0Q291bnQgPSByZXBlYXRDb3VudCA9PSBudWxsID8gLTEgOiByZXBlYXRDb3VudDtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFJlcGVhdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgUmVwZWF0U2luayhvYnNlcnZlciwgdGhpcyk7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUmVwZWF0T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIGZ1bmN0aW9uIFJlcGVhdFNpbmsob2JzZXJ2ZXIsIHBhcmVudCkge1xuXHQgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgfVxuXHRcblx0ICBSZXBlYXRTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgb2JzZXJ2ZXIgPSB0aGlzLm9ic2VydmVyLCB2YWx1ZSA9IHRoaXMucGFyZW50LnZhbHVlO1xuXHQgICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShpLCByZWN1cnNlKSB7XG5cdCAgICAgIGlmIChpID09PSAtMSB8fCBpID4gMCkge1xuXHQgICAgICAgIG9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgaSA+IDAgJiYgaS0tO1xuXHQgICAgICB9XG5cdCAgICAgIGlmIChpID09PSAwKSB7IHJldHVybiBvYnNlcnZlci5vbkNvbXBsZXRlZCgpOyB9XG5cdCAgICAgIHJlY3Vyc2UoaSk7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSh0aGlzLnBhcmVudC5yZXBlYXRDb3VudCwgbG9vcFJlY3Vyc2l2ZSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIEdlbmVyYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcmVwZWF0cyB0aGUgZ2l2ZW4gZWxlbWVudCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcywgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgb2JzZXJ2ZXIgbWVzc2FnZXMuXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgRWxlbWVudCB0byByZXBlYXQuXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IHJlcGVhdENvdW50IFtPcHRpb25hXSBOdW1iZXIgb2YgdGltZXMgdG8gcmVwZWF0IHRoZSBlbGVtZW50LiBJZiBub3Qgc3BlY2lmaWVkLCByZXBlYXRzIGluZGVmaW5pdGVseS5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIFNjaGVkdWxlciB0byBydW4gdGhlIHByb2R1Y2VyIGxvb3Agb24uIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5pbW1lZGlhdGUuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCByZXBlYXRzIHRoZSBnaXZlbiBlbGVtZW50IHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLlxuXHQgICAqL1xuXHQgIE9ic2VydmFibGUucmVwZWF0ID0gZnVuY3Rpb24gKHZhbHVlLCByZXBlYXRDb3VudCwgc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgUmVwZWF0T2JzZXJ2YWJsZSh2YWx1ZSwgcmVwZWF0Q291bnQsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIEp1c3RPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoSnVzdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBKdXN0T2JzZXJ2YWJsZSh2YWx1ZSwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEp1c3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IEp1c3RTaW5rKG9ic2VydmVyLCB0aGlzLnZhbHVlLCB0aGlzLnNjaGVkdWxlcik7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBKdXN0U2luayhvYnNlcnZlciwgdmFsdWUsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2NoZWR1bGVJdGVtKHMsIHN0YXRlKSB7XG5cdCAgICAgIHZhciB2YWx1ZSA9IHN0YXRlWzBdLCBvYnNlcnZlciA9IHN0YXRlWzFdO1xuXHQgICAgICBvYnNlcnZlci5vbk5leHQodmFsdWUpO1xuXHQgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgfVxuXHRcblx0ICAgIEp1c3RTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciBzdGF0ZSA9IFt0aGlzLnZhbHVlLCB0aGlzLm9ic2VydmVyXTtcblx0ICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVyID09PSBpbW1lZGlhdGVTY2hlZHVsZXIgP1xuXHQgICAgICAgIHNjaGVkdWxlSXRlbShudWxsLCBzdGF0ZSkgOlxuXHQgICAgICAgIHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKHN0YXRlLCBzY2hlZHVsZUl0ZW0pO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gSnVzdE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgYSBzaW5nbGUgZWxlbWVudCwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgb2JzZXJ2ZXIgbWVzc2FnZXMuXG5cdCAgICogIFRoZXJlIGlzIGFuIGFsaWFzIGNhbGxlZCAnanVzdCcgb3IgYnJvd3NlcnMgPElFOS5cblx0ICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBTaW5nbGUgZWxlbWVudCBpbiB0aGUgcmVzdWx0aW5nIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBTY2hlZHVsZXIgdG8gc2VuZCB0aGUgc2luZ2xlIGVsZW1lbnQgb24uIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5pbW1lZGlhdGUuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgc2luZ2xlIHNwZWNpZmllZCBlbGVtZW50LlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlUmV0dXJuID0gT2JzZXJ2YWJsZVsncmV0dXJuJ10gPSBPYnNlcnZhYmxlLmp1c3QgPSBmdW5jdGlvbiAodmFsdWUsIHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgSnVzdE9ic2VydmFibGUodmFsdWUsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRocm93T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRocm93T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRocm93T2JzZXJ2YWJsZShlcnJvciwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRocm93T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IFRocm93U2luayhvLCB0aGlzKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIFRocm93U2luayhvLCBwKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMucCA9IHA7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2NoZWR1bGVJdGVtKHMsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBlID0gc3RhdGVbMF0sIG8gPSBzdGF0ZVsxXTtcblx0ICAgICAgby5vbkVycm9yKGUpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRocm93U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5wLnNjaGVkdWxlci5zY2hlZHVsZShbdGhpcy5wLmVycm9yLCB0aGlzLm9dLCBzY2hlZHVsZUl0ZW0pO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gVGhyb3dPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHRlcm1pbmF0ZXMgd2l0aCBhbiBleGNlcHRpb24sIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IHRoZSBzaW5nbGUgb25FcnJvciBtZXNzYWdlLlxuXHQgICAqICBUaGVyZSBpcyBhbiBhbGlhcyB0byB0aGlzIG1ldGhvZCBjYWxsZWQgJ3Rocm93RXJyb3InIGZvciBicm93c2VycyA8SUU5LlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIEFuIG9iamVjdCB1c2VkIGZvciB0aGUgc2VxdWVuY2UncyB0ZXJtaW5hdGlvbi5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIFNjaGVkdWxlciB0byBzZW5kIHRoZSBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBjYWxsIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuaW1tZWRpYXRlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHRlcm1pbmF0ZXMgZXhjZXB0aW9uYWxseSB3aXRoIHRoZSBzcGVjaWZpZWQgZXhjZXB0aW9uIG9iamVjdC5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZVRocm93ID0gT2JzZXJ2YWJsZVsndGhyb3cnXSA9IGZ1bmN0aW9uIChlcnJvciwgc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBUaHJvd09ic2VydmFibGUoZXJyb3IsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIENhdGNoT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDYXRjaE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDYXRjaE9ic2VydmFibGUoc291cmNlLCBmbikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fZm4gPSBmbjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgQ2F0Y2hPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGQxID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cdCAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKGQxKTtcblx0ICAgICAgZDEuc2V0RGlzcG9zYWJsZSh0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IENhdGNoT2JzZXJ2ZXIobywgc3Vic2NyaXB0aW9uLCB0aGlzLl9mbikpKTtcblx0ICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIENhdGNoT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBDYXRjaE9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ2F0Y2hPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENhdGNoT2JzZXJ2ZXIobywgcywgZm4pIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgICB0aGlzLl9mbiA9IGZuO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBDYXRjaE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fby5vbk5leHQoeCk7IH07XG5cdCAgICBDYXRjaE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cdCAgICBDYXRjaE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLl9mbikoZSk7XG5cdCAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzdWx0LmUpOyB9XG5cdCAgICAgIGlzUHJvbWlzZShyZXN1bHQpICYmIChyZXN1bHQgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UocmVzdWx0KSk7XG5cdFxuXHQgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICB0aGlzLl9zLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgIGQuc2V0RGlzcG9zYWJsZShyZXN1bHQuc3Vic2NyaWJlKHRoaXMuX28pKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIENhdGNoT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIENvbnRpbnVlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGVybWluYXRlZCBieSBhbiBleGNlcHRpb24gd2l0aCB0aGUgbmV4dCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IGhhbmRsZXJPclNlY29uZCBFeGNlcHRpb24gaGFuZGxlciBmdW5jdGlvbiB0aGF0IHJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBnaXZlbiB0aGUgZXJyb3IgdGhhdCBvY2N1cnJlZCBpbiB0aGUgZmlyc3Qgc2VxdWVuY2UsIG9yIGEgc2Vjb25kIG9ic2VydmFibGUgc2VxdWVuY2UgdXNlZCB0byBwcm9kdWNlIHJlc3VsdHMgd2hlbiBhbiBlcnJvciBvY2N1cnJlZCBpbiB0aGUgZmlyc3Qgc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgZmlyc3Qgc2VxdWVuY2UncyBlbGVtZW50cywgZm9sbG93ZWQgYnkgdGhlIGVsZW1lbnRzIG9mIHRoZSBoYW5kbGVyIHNlcXVlbmNlIGluIGNhc2UgYW4gZXhjZXB0aW9uIG9jY3VycmVkLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90b1snY2F0Y2gnXSA9IGZ1bmN0aW9uIChoYW5kbGVyT3JTZWNvbmQpIHtcblx0ICAgIHJldHVybiBpc0Z1bmN0aW9uKGhhbmRsZXJPclNlY29uZCkgPyBuZXcgQ2F0Y2hPYnNlcnZhYmxlKHRoaXMsIGhhbmRsZXJPclNlY29uZCkgOiBvYnNlcnZhYmxlQ2F0Y2goW3RoaXMsIGhhbmRsZXJPclNlY29uZF0pO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIENvbnRpbnVlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGVybWluYXRlZCBieSBhbiBleGNlcHRpb24gd2l0aCB0aGUgbmV4dCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBwYXJhbSB7QXJyYXkgfCBBcmd1bWVudHN9IGFyZ3MgQXJndW1lbnRzIG9yIGFuIGFycmF5IHRvIHVzZSBhcyB0aGUgbmV4dCBzZXF1ZW5jZSBpZiBhbiBlcnJvciBvY2N1cnMuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyBlbGVtZW50cyBmcm9tIGNvbnNlY3V0aXZlIHNvdXJjZSBzZXF1ZW5jZXMgdW50aWwgYSBzb3VyY2Ugc2VxdWVuY2UgdGVybWluYXRlcyBzdWNjZXNzZnVsbHkuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVDYXRjaCA9IE9ic2VydmFibGVbJ2NhdGNoJ10gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgaXRlbXM7XG5cdCAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG5cdCAgICAgIGl0ZW1zID0gYXJndW1lbnRzWzBdO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cdCAgICAgIGl0ZW1zID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBpdGVtc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIGVudW1lcmFibGVPZihpdGVtcykuY2F0Y2hFcnJvcigpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFueSBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgb3IgUHJvbWlzZXMgcHJvZHVjZXMgYW4gZWxlbWVudC5cblx0ICAgKiBUaGlzIGNhbiBiZSBpbiB0aGUgZm9ybSBvZiBhbiBhcmd1bWVudCBsaXN0IG9mIG9ic2VydmFibGVzIG9yIGFuIGFycmF5LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAxIC0gb2JzID0gb2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0KG9iczEsIG9iczIsIG9iczMsIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuXHQgICAqIDIgLSBvYnMgPSBvYnNlcnZhYmxlLmNvbWJpbmVMYXRlc3QoW29iczEsIG9iczIsIG9iczNdLCBmdW5jdGlvbiAobzEsIG8yLCBvMykgeyByZXR1cm4gbzEgKyBvMiArIG8zOyB9KTtcblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5jb21iaW5lTGF0ZXN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICBpZiAoQXJyYXkuaXNBcnJheShhcmdzWzBdKSkge1xuXHQgICAgICBhcmdzWzBdLnVuc2hpZnQodGhpcyk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBhcmdzLnVuc2hpZnQodGhpcyk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gY29tYmluZUxhdGVzdC5hcHBseSh0aGlzLCBhcmdzKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuXHQgIGZ1bmN0aW9uIGFyZ3VtZW50c1RvQXJyYXkoKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHJldHVybiBhcmdzO1xuXHQgIH1cblx0XG5cdCAgdmFyIENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ29tYmluZUxhdGVzdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZShwYXJhbXMsIGNiKSB7XG5cdCAgICAgIHRoaXMuX3BhcmFtcyA9IHBhcmFtcztcblx0ICAgICAgdGhpcy5fY2IgPSBjYjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgQ29tYmluZUxhdGVzdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvYnNlcnZlcikge1xuXHQgICAgICB2YXIgbGVuID0gdGhpcy5fcGFyYW1zLmxlbmd0aCxcblx0ICAgICAgICAgIHN1YnNjcmlwdGlvbnMgPSBuZXcgQXJyYXkobGVuKTtcblx0XG5cdCAgICAgIHZhciBzdGF0ZSA9IHtcblx0ICAgICAgICBoYXNWYWx1ZTogYXJyYXlJbml0aWFsaXplKGxlbiwgZmFsc2VGYWN0b3J5KSxcblx0ICAgICAgICBoYXNWYWx1ZUFsbDogZmFsc2UsXG5cdCAgICAgICAgaXNEb25lOiBhcnJheUluaXRpYWxpemUobGVuLCBmYWxzZUZhY3RvcnkpLFxuXHQgICAgICAgIHZhbHVlczogbmV3IEFycmF5KGxlbilcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICB2YXIgc291cmNlID0gdGhpcy5fcGFyYW1zW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICBzdWJzY3JpcHRpb25zW2ldID0gc2FkO1xuXHQgICAgICAgIGlzUHJvbWlzZShzb3VyY2UpICYmIChzb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uoc291cmNlKSk7XG5cdCAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShuZXcgQ29tYmluZUxhdGVzdE9ic2VydmVyKG9ic2VydmVyLCBpLCB0aGlzLl9jYiwgc3RhdGUpKSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ29tYmluZUxhdGVzdE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ29tYmluZUxhdGVzdE9ic2VydmVyKG8sIGksIGNiLCBzdGF0ZSkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5faSA9IGk7XG5cdCAgICAgIHRoaXMuX2NiID0gY2I7XG5cdCAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIG5vdFRoZVNhbWUoaSkge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gKHgsIGopIHtcblx0ICAgICAgICByZXR1cm4gaiAhPT0gaTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLl9zdGF0ZS52YWx1ZXNbdGhpcy5faV0gPSB4O1xuXHQgICAgICB0aGlzLl9zdGF0ZS5oYXNWYWx1ZVt0aGlzLl9pXSA9IHRydWU7XG5cdCAgICAgIGlmICh0aGlzLl9zdGF0ZS5oYXNWYWx1ZUFsbCB8fCAodGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwgPSB0aGlzLl9zdGF0ZS5oYXNWYWx1ZS5ldmVyeShpZGVudGl0eSkpKSB7XG5cdCAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX2NiKS5hcHBseShudWxsLCB0aGlzLl9zdGF0ZS52YWx1ZXMpO1xuXHQgICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgICAgdGhpcy5fby5vbk5leHQocmVzKTtcblx0ICAgICAgfSBlbHNlIGlmICh0aGlzLl9zdGF0ZS5pc0RvbmUuZmlsdGVyKG5vdFRoZVNhbWUodGhpcy5faSkpLmV2ZXJ5KGlkZW50aXR5KSkge1xuXHQgICAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fc3RhdGUuaXNEb25lW3RoaXMuX2ldID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5fc3RhdGUuaXNEb25lLmV2ZXJ5KGlkZW50aXR5KSAmJiB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYW55IG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBQcm9taXNlcyBwcm9kdWNlcyBhbiBlbGVtZW50LlxuXHQgICpcblx0ICAqIEBleGFtcGxlXG5cdCAgKiAxIC0gb2JzID0gUnguT2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0KG9iczEsIG9iczIsIG9iczMsIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuXHQgICogMiAtIG9icyA9IFJ4Lk9ic2VydmFibGUuY29tYmluZUxhdGVzdChbb2JzMSwgb2JzMiwgb2JzM10sIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgc291cmNlcyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAqL1xuXHQgIHZhciBjb21iaW5lTGF0ZXN0ID0gT2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKGFyZ3NbbGVuIC0gMV0pID8gYXJncy5wb3AoKSA6IGFyZ3VtZW50c1RvQXJyYXk7XG5cdCAgICBBcnJheS5pc0FycmF5KGFyZ3NbMF0pICYmIChhcmdzID0gYXJnc1swXSk7XG5cdCAgICByZXR1cm4gbmV3IENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlKGFyZ3MsIHJlc3VsdFNlbGVjdG9yKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBDb25jYXRlbmF0ZXMgYWxsIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcy4gIFRoaXMgdGFrZXMgaW4gZWl0aGVyIGFuIGFycmF5IG9yIHZhcmlhYmxlIGFyZ3VtZW50cyB0byBjb25jYXRlbmF0ZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBlYWNoIGdpdmVuIHNlcXVlbmNlLCBpbiBzZXF1ZW50aWFsIG9yZGVyLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBmb3IodmFyIGFyZ3MgPSBbXSwgaSA9IDAsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuXHQgICAgYXJncy51bnNoaWZ0KHRoaXMpO1xuXHQgICAgcmV0dXJuIG9ic2VydmFibGVDb25jYXQuYXBwbHkobnVsbCwgYXJncyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIENvbmNhdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDb25jYXRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ29uY2F0T2JzZXJ2YWJsZShzb3VyY2VzKSB7XG5cdCAgICAgIHRoaXMuc291cmNlcyA9IHNvdXJjZXM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIENvbmNhdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IENvbmNhdFNpbmsodGhpcy5zb3VyY2VzLCBvKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIENvbmNhdFNpbmsoc291cmNlcywgbykge1xuXHQgICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgfVxuXHQgICAgQ29uY2F0U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgaXNEaXNwb3NlZCwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSwgc291cmNlcyA9IHRoaXMuc291cmNlcywgbGVuZ3RoID0gc291cmNlcy5sZW5ndGgsIG8gPSB0aGlzLm87XG5cdCAgICAgIHZhciBjYW5jZWxhYmxlID0gaW1tZWRpYXRlU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKDAsIGZ1bmN0aW9uIChpLCBzZWxmKSB7XG5cdCAgICAgICAgaWYgKGlzRGlzcG9zZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgaWYgKGkgPT09IGxlbmd0aCkge1xuXHQgICAgICAgICAgcmV0dXJuIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIENoZWNrIGlmIHByb21pc2Vcblx0ICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gc291cmNlc1tpXTtcblx0ICAgICAgICBpc1Byb21pc2UoY3VycmVudFZhbHVlKSAmJiAoY3VycmVudFZhbHVlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGN1cnJlbnRWYWx1ZSkpO1xuXHRcblx0ICAgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICAgIGQuc2V0RGlzcG9zYWJsZShjdXJyZW50VmFsdWUuc3Vic2NyaWJlKFxuXHQgICAgICAgICAgZnVuY3Rpb24gKHgpIHsgby5vbk5leHQoeCk7IH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoKSB7IHNlbGYoaSArIDEpOyB9XG5cdCAgICAgICAgKSk7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSwgZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgIH0pKTtcblx0ICAgIH07XG5cdFxuXHRcblx0ICAgIHJldHVybiBDb25jYXRPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ29uY2F0ZW5hdGVzIGFsbCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG5cdCAgICogQHBhcmFtIHtBcnJheSB8IEFyZ3VtZW50c30gYXJncyBBcmd1bWVudHMgb3IgYW4gYXJyYXkgdG8gY29uY2F0IHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGVhY2ggZ2l2ZW4gc2VxdWVuY2UsIGluIHNlcXVlbnRpYWwgb3JkZXIuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVDb25jYXQgPSBPYnNlcnZhYmxlLmNvbmNhdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBhcmdzO1xuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuXHQgICAgICBhcmdzID0gYXJndW1lbnRzWzBdO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKTtcblx0ICAgICAgZm9yKHZhciBpID0gMCwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIH1cblx0ICAgIHJldHVybiBuZXcgQ29uY2F0T2JzZXJ2YWJsZShhcmdzKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBDb25jYXRlbmF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBvYnNlcnZhYmxlIHNlcXVlbmNlcy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBlYWNoIG9ic2VydmVkIGlubmVyIHNlcXVlbmNlLCBpbiBzZXF1ZW50aWFsIG9yZGVyLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5jb25jYXRBbGwgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcy5tZXJnZSgxKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgTWVyZ2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE1lcmdlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBNZXJnZU9ic2VydmFibGUoc291cmNlLCBtYXhDb25jdXJyZW50KSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLm1heENvbmN1cnJlbnQgPSBtYXhDb25jdXJyZW50O1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBNZXJnZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvYnNlcnZlcikge1xuXHQgICAgICB2YXIgZyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG5cdCAgICAgIGcuYWRkKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgTWVyZ2VPYnNlcnZlcihvYnNlcnZlciwgdGhpcy5tYXhDb25jdXJyZW50LCBnKSkpO1xuXHQgICAgICByZXR1cm4gZztcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE1lcmdlT2JzZXJ2YWJsZTtcblx0XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgTWVyZ2VPYnNlcnZlciA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBNZXJnZU9ic2VydmVyKG8sIG1heCwgZykge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLm1heCA9IG1heDtcblx0ICAgICAgdGhpcy5nID0gZztcblx0ICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG5cdCAgICAgIHRoaXMucSA9IFtdO1xuXHQgICAgICB0aGlzLmFjdGl2ZUNvdW50ID0gMDtcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0ICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLmhhbmRsZVN1YnNjcmliZSA9IGZ1bmN0aW9uICh4cykge1xuXHQgICAgICB2YXIgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHRoaXMuZy5hZGQoc2FkKTtcblx0ICAgICAgaXNQcm9taXNlKHhzKSAmJiAoeHMgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoeHMpKTtcblx0ICAgICAgc2FkLnNldERpc3Bvc2FibGUoeHMuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKHRoaXMsIHNhZCkpKTtcblx0ICAgIH07XG5cdCAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoaW5uZXJTb3VyY2UpIHtcblx0ICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIGlmKHRoaXMuYWN0aXZlQ291bnQgPCB0aGlzLm1heCkge1xuXHQgICAgICAgICAgdGhpcy5hY3RpdmVDb3VudCsrO1xuXHQgICAgICAgICAgdGhpcy5oYW5kbGVTdWJzY3JpYmUoaW5uZXJTb3VyY2UpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGlzLnEucHVzaChpbm5lclNvdXJjZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLmFjdGl2ZUNvdW50ID09PSAwICYmIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cdCAgICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKHBhcmVudCwgc2FkKSB7XG5cdCAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgICAgICAgdGhpcy5zYWQgPSBzYWQ7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgICAgfVxuXHQgICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoeCkgeyBpZighdGhpcy5pc1N0b3BwZWQpIHsgdGhpcy5wYXJlbnQuby5vbk5leHQoeCk7IH0gfTtcblx0ICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG5cdCAgICAgICAgICBwYXJlbnQuZy5yZW1vdmUodGhpcy5zYWQpO1xuXHQgICAgICAgICAgaWYgKHBhcmVudC5xLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICAgICAgcGFyZW50LmhhbmRsZVN1YnNjcmliZShwYXJlbnQucS5zaGlmdCgpKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHBhcmVudC5hY3RpdmVDb3VudC0tO1xuXHQgICAgICAgICAgICBwYXJlbnQuZG9uZSAmJiBwYXJlbnQuYWN0aXZlQ291bnQgPT09IDAgJiYgcGFyZW50Lm8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuXHQgICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLnBhcmVudC5vLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIHJldHVybiBNZXJnZU9ic2VydmVyO1xuXHQgIH0oKSk7XG5cdFxuXHRcblx0XG5cdFxuXHRcblx0ICAvKipcblx0ICAqIE1lcmdlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgbGltaXRpbmcgdGhlIG51bWJlciBvZiBjb25jdXJyZW50IHN1YnNjcmlwdGlvbnMgdG8gaW5uZXIgc2VxdWVuY2VzLlxuXHQgICogT3IgbWVyZ2VzIHR3byBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIGEgc2luZ2xlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKlxuXHQgICogQGV4YW1wbGVcblx0ICAqIDEgLSBtZXJnZWQgPSBzb3VyY2VzLm1lcmdlKDEpO1xuXHQgICogMiAtIG1lcmdlZCA9IHNvdXJjZS5tZXJnZShvdGhlclNvdXJjZSk7XG5cdCAgKiBAcGFyYW0ge01peGVkfSBbbWF4Q29uY3VycmVudE9yT3RoZXJdIE1heGltdW0gbnVtYmVyIG9mIGlubmVyIG9ic2VydmFibGUgc2VxdWVuY2VzIGJlaW5nIHN1YnNjcmliZWQgdG8gY29uY3VycmVudGx5IG9yIHRoZSBzZWNvbmQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IG1lcmdlcyB0aGUgZWxlbWVudHMgb2YgdGhlIGlubmVyIHNlcXVlbmNlcy5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5tZXJnZSA9IGZ1bmN0aW9uIChtYXhDb25jdXJyZW50T3JPdGhlcikge1xuXHQgICAgcmV0dXJuIHR5cGVvZiBtYXhDb25jdXJyZW50T3JPdGhlciAhPT0gJ251bWJlcicgP1xuXHQgICAgICBvYnNlcnZhYmxlTWVyZ2UodGhpcywgbWF4Q29uY3VycmVudE9yT3RoZXIpIDpcblx0ICAgICAgbmV3IE1lcmdlT2JzZXJ2YWJsZSh0aGlzLCBtYXhDb25jdXJyZW50T3JPdGhlcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogTWVyZ2VzIGFsbCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhIHNpbmdsZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIFRoZSBzY2hlZHVsZXIgaXMgb3B0aW9uYWwgYW5kIGlmIG5vdCBzcGVjaWZpZWQsIHRoZSBpbW1lZGlhdGUgc2NoZWR1bGVyIGlzIHVzZWQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgbWVyZ2VzIHRoZSBlbGVtZW50cyBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVNZXJnZSA9IE9ic2VydmFibGUubWVyZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgc2NoZWR1bGVyLCBzb3VyY2VzID0gW10sIGksIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cdCAgICBpZiAoIWFyZ3VtZW50c1swXSkge1xuXHQgICAgICBzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXI7XG5cdCAgICAgIGZvcihpID0gMTsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG5cdCAgICB9IGVsc2UgaWYgKGlzU2NoZWR1bGVyKGFyZ3VtZW50c1swXSkpIHtcblx0ICAgICAgc2NoZWR1bGVyID0gYXJndW1lbnRzWzBdO1xuXHQgICAgICBmb3IoaSA9IDE7IGkgPCBsZW47IGkrKykgeyBzb3VyY2VzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyO1xuXHQgICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgeyBzb3VyY2VzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuXHQgICAgfVxuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkoc291cmNlc1swXSkpIHtcblx0ICAgICAgc291cmNlcyA9IHNvdXJjZXNbMF07XG5cdCAgICB9XG5cdCAgICByZXR1cm4gb2JzZXJ2YWJsZU9mKHNjaGVkdWxlciwgc291cmNlcykubWVyZ2VBbGwoKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgQ29tcG9zaXRlRXJyb3IgPSBSeC5Db21wb3NpdGVFcnJvciA9IGZ1bmN0aW9uKGVycm9ycykge1xuXHQgICAgdGhpcy5pbm5lckVycm9ycyA9IGVycm9ycztcblx0ICAgIHRoaXMubWVzc2FnZSA9ICdUaGlzIGNvbnRhaW5zIG11bHRpcGxlIGVycm9ycy4gQ2hlY2sgdGhlIGlubmVyRXJyb3JzJztcblx0ICAgIEVycm9yLmNhbGwodGhpcyk7XG5cdCAgfTtcblx0ICBDb21wb3NpdGVFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cdCAgQ29tcG9zaXRlRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnQ29tcG9zaXRlRXJyb3InO1xuXHRcblx0ICB2YXIgTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlKHNvdXJjZSkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBncm91cCA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCksXG5cdCAgICAgICAgbSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLFxuXHQgICAgICAgIHN0YXRlID0geyBpc1N0b3BwZWQ6IGZhbHNlLCBlcnJvcnM6IFtdLCBvOiBvIH07XG5cdFxuXHQgICAgICBncm91cC5hZGQobSk7XG5cdCAgICAgIG0uc2V0RGlzcG9zYWJsZSh0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IE1lcmdlRGVsYXlFcnJvck9ic2VydmVyKGdyb3VwLCBzdGF0ZSkpKTtcblx0XG5cdCAgICAgIHJldHVybiBncm91cDtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhNZXJnZURlbGF5RXJyb3JPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyKGdyb3VwLCBzdGF0ZSkge1xuXHQgICAgICB0aGlzLl9ncm91cCA9IGdyb3VwO1xuXHQgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzZXRDb21wbGV0aW9uKG8sIGVycm9ycykge1xuXHQgICAgICBpZiAoZXJyb3JzLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfSBlbHNlIGlmIChlcnJvcnMubGVuZ3RoID09PSAxKSB7XG5cdCAgICAgICAgby5vbkVycm9yKGVycm9yc1swXSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgby5vbkVycm9yKG5ldyBDb21wb3NpdGVFcnJvcihlcnJvcnMpKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdmFyIGlubmVyID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHRoaXMuX2dyb3VwLmFkZChpbm5lcik7XG5cdFxuXHQgICAgICAvLyBDaGVjayBmb3IgcHJvbWlzZXMgc3VwcG9ydFxuXHQgICAgICBpc1Byb21pc2UoeCkgJiYgKHggPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoeCkpO1xuXHQgICAgICBpbm5lci5zZXREaXNwb3NhYmxlKHguc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKGlubmVyLCB0aGlzLl9ncm91cCwgdGhpcy5fc3RhdGUpKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmVycm9ycy5wdXNoKGUpO1xuXHQgICAgICB0aGlzLl9zdGF0ZS5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuXHQgICAgfTtcblx0XG5cdCAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9zdGF0ZS5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihpbm5lciwgZ3JvdXAsIHN0YXRlKSB7XG5cdCAgICAgIHRoaXMuX2lubmVyID0gaW5uZXI7XG5cdCAgICAgIHRoaXMuX2dyb3VwID0gZ3JvdXA7XG5cdCAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLl9zdGF0ZS5vLm9uTmV4dCh4KTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fc3RhdGUuZXJyb3JzLnB1c2goZSk7XG5cdCAgICAgIHRoaXMuX2dyb3VwLnJlbW92ZSh0aGlzLl9pbm5lcik7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCAmJiB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fZ3JvdXAucmVtb3ZlKHRoaXMuX2lubmVyKTtcblx0ICAgICAgdGhpcy5fc3RhdGUuaXNTdG9wcGVkICYmIHRoaXMuX2dyb3VwLmxlbmd0aCA9PT0gMSAmJiBzZXRDb21wbGV0aW9uKHRoaXMuX3N0YXRlLm8sIHRoaXMuX3N0YXRlLmVycm9ycyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBNZXJnZURlbGF5RXJyb3JPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiBGbGF0dGVucyBhbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgT2JzZXJ2YWJsZXMgaW50byBvbmUgT2JzZXJ2YWJsZSwgaW4gYSB3YXkgdGhhdCBhbGxvd3MgYW4gT2JzZXJ2ZXIgdG9cblx0ICAqIHJlY2VpdmUgYWxsIHN1Y2Nlc3NmdWxseSBlbWl0dGVkIGl0ZW1zIGZyb20gYWxsIG9mIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZXMgd2l0aG91dCBiZWluZyBpbnRlcnJ1cHRlZCBieVxuXHQgICogYW4gZXJyb3Igbm90aWZpY2F0aW9uIGZyb20gb25lIG9mIHRoZW0uXG5cdCAgKlxuXHQgICogVGhpcyBiZWhhdmVzIGxpa2UgT2JzZXJ2YWJsZS5wcm90b3R5cGUubWVyZ2VBbGwgZXhjZXB0IHRoYXQgaWYgYW55IG9mIHRoZSBtZXJnZWQgT2JzZXJ2YWJsZXMgbm90aWZ5IG9mIGFuXG5cdCAgKiBlcnJvciB2aWEgdGhlIE9ic2VydmVyJ3Mgb25FcnJvciwgbWVyZ2VEZWxheUVycm9yIHdpbGwgcmVmcmFpbiBmcm9tIHByb3BhZ2F0aW5nIHRoYXRcblx0ICAqIGVycm9yIG5vdGlmaWNhdGlvbiB1bnRpbCBhbGwgb2YgdGhlIG1lcmdlZCBPYnNlcnZhYmxlcyBoYXZlIGZpbmlzaGVkIGVtaXR0aW5nIGl0ZW1zLlxuXHQgICogQHBhcmFtIHtBcnJheSB8IEFyZ3VtZW50c30gYXJncyBBcmd1bWVudHMgb3IgYW4gYXJyYXkgdG8gbWVyZ2UuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIGFsbCBvZiB0aGUgaXRlbXMgZW1pdHRlZCBieSB0aGUgT2JzZXJ2YWJsZXMgZW1pdHRlZCBieSB0aGUgT2JzZXJ2YWJsZVxuXHQgICovXG5cdCAgT2JzZXJ2YWJsZS5tZXJnZURlbGF5RXJyb3IgPSBmdW5jdGlvbigpIHtcblx0ICAgIHZhciBhcmdzO1xuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuXHQgICAgICBhcmdzID0gYXJndW1lbnRzWzBdO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cdCAgICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIH1cblx0ICAgIHZhciBzb3VyY2UgPSBvYnNlcnZhYmxlT2YobnVsbCwgYXJncyk7XG5cdCAgICByZXR1cm4gbmV3IE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUoc291cmNlKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgTWVyZ2VBbGxPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE1lcmdlQWxsT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBNZXJnZUFsbE9ic2VydmFibGUoc291cmNlKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBNZXJnZUFsbE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIGcgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpLCBtID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIGcuYWRkKG0pO1xuXHQgICAgICBtLnNldERpc3Bvc2FibGUodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNZXJnZUFsbE9ic2VydmVyKG9ic2VydmVyLCBnKSkpO1xuXHQgICAgICByZXR1cm4gZztcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gTWVyZ2VBbGxPYnNlcnZlcihvLCBnKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMuZyA9IGc7XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuXHQgICAgfVxuXHQgICAgTWVyZ2VBbGxPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24oaW5uZXJTb3VyY2UpIHtcblx0ICAgICAgaWYodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgdGhpcy5nLmFkZChzYWQpO1xuXHRcblx0ICAgICAgaXNQcm9taXNlKGlubmVyU291cmNlKSAmJiAoaW5uZXJTb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoaW5uZXJTb3VyY2UpKTtcblx0XG5cdCAgICAgIHNhZC5zZXREaXNwb3NhYmxlKGlubmVyU291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcih0aGlzLCBzYWQpKSk7XG5cdCAgICB9O1xuXHQgICAgTWVyZ2VBbGxPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmcubGVuZ3RoID09PSAxICYmIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgTWVyZ2VBbGxPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cdCAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKHBhcmVudCwgc2FkKSB7XG5cdCAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgICAgICB0aGlzLnNhZCA9IHNhZDtcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7IGlmICghdGhpcy5pc1N0b3BwZWQpIHsgdGhpcy5wYXJlbnQuby5vbk5leHQoeCk7IH0gfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgcGFyZW50LmcucmVtb3ZlKHRoaXMuc2FkKTtcblx0ICAgICAgICBwYXJlbnQuZG9uZSAmJiBwYXJlbnQuZy5sZW5ndGggPT09IDEgJiYgcGFyZW50Lm8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBNZXJnZUFsbE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAqIE1lcmdlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IG1lcmdlcyB0aGUgZWxlbWVudHMgb2YgdGhlIGlubmVyIHNlcXVlbmNlcy5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5tZXJnZUFsbCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgTWVyZ2VBbGxPYnNlcnZhYmxlKHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBTa2lwVW50aWxPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2tpcFVudGlsT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBTa2lwVW50aWxPYnNlcnZhYmxlKHNvdXJjZSwgb3RoZXIpIHtcblx0ICAgICAgdGhpcy5fcyA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fbyA9IGlzUHJvbWlzZShvdGhlcikgPyBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpIDogb3RoZXI7XG5cdCAgICAgIHRoaXMuX29wZW4gPSBmYWxzZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2tpcFVudGlsT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgdmFyIGxlZnRTdWJzY3JpcHRpb24gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgbGVmdFN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHRoaXMuX3Muc3Vic2NyaWJlKG5ldyBTa2lwVW50aWxTb3VyY2VPYnNlcnZlcihvLCB0aGlzKSkpO1xuXHRcblx0ICAgICAgaXNQcm9taXNlKHRoaXMuX28pICYmICh0aGlzLl9vID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHRoaXMuX28pKTtcblx0XG5cdCAgICAgIHZhciByaWdodFN1YnNjcmlwdGlvbiA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICByaWdodFN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHRoaXMuX28uc3Vic2NyaWJlKG5ldyBTa2lwVW50aWxPdGhlck9ic2VydmVyKG8sIHRoaXMsIHJpZ2h0U3Vic2NyaXB0aW9uKSkpO1xuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKGxlZnRTdWJzY3JpcHRpb24sIHJpZ2h0U3Vic2NyaXB0aW9uKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNraXBVbnRpbE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTa2lwVW50aWxTb3VyY2VPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyKG8sIHApIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3AgPSBwO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTa2lwVW50aWxTb3VyY2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMuX3AuX29wZW4gJiYgdGhpcy5fby5vbk5leHQoeCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGVycik7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fcC5fb3BlbiAmJiB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTa2lwVW50aWxTb3VyY2VPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgdmFyIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTa2lwVW50aWxPdGhlck9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU2tpcFVudGlsT3RoZXJPYnNlcnZlcihvLCBwLCByKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9wID0gcDtcblx0ICAgICAgdGhpcy5fciA9IHI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX3AuX29wZW4gPSB0cnVlO1xuXHQgICAgICB0aGlzLl9yLmRpc3Bvc2UoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2tpcFVudGlsT3RoZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlcnIpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTa2lwVW50aWxPdGhlck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fci5kaXNwb3NlKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTa2lwVW50aWxPdGhlck9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIHRoZSB2YWx1ZXMgZnJvbSB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2Ugb25seSBhZnRlciB0aGUgb3RoZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNlcyBhIHZhbHVlLlxuXHQgICAqIEBwYXJhbSB7T2JzZXJ2YWJsZSB8IFByb21pc2V9IG90aGVyIFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIG9yIFByb21pc2UgdGhhdCB0cmlnZ2VycyBwcm9wYWdhdGlvbiBvZiBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugc3RhcnRpbmcgZnJvbSB0aGUgcG9pbnQgdGhlIG90aGVyIHNlcXVlbmNlIHRyaWdnZXJlZCBwcm9wYWdhdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2tpcFVudGlsID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cdCAgICByZXR1cm4gbmV3IFNraXBVbnRpbE9ic2VydmFibGUodGhpcywgb3RoZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBTd2l0Y2hPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU3dpdGNoT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFN3aXRjaE9ic2VydmFibGUoc291cmNlKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTd2l0Y2hPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGlubmVyID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSwgcyA9IHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgU3dpdGNoT2JzZXJ2ZXIobywgaW5uZXIpKTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHMsIGlubmVyKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoU3dpdGNoT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gU3dpdGNoT2JzZXJ2ZXIobywgaW5uZXIpIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5pbm5lciA9IGlubmVyO1xuXHQgICAgICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5sYXRlc3QgPSAwO1xuXHQgICAgICB0aGlzLmhhc0xhdGVzdCA9IGZhbHNlO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU3dpdGNoT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaW5uZXJTb3VyY2UpIHtcblx0ICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSwgaWQgPSArK3RoaXMubGF0ZXN0O1xuXHQgICAgICB0aGlzLmhhc0xhdGVzdCA9IHRydWU7XG5cdCAgICAgIHRoaXMuaW5uZXIuc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgaXNQcm9taXNlKGlubmVyU291cmNlKSAmJiAoaW5uZXJTb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoaW5uZXJTb3VyY2UpKTtcblx0ICAgICAgZC5zZXREaXNwb3NhYmxlKGlubmVyU291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcih0aGlzLCBpZCkpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgU3dpdGNoT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFN3aXRjaE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuc3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICF0aGlzLmhhc0xhdGVzdCAmJiB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKHBhcmVudCwgaWQpIHtcblx0ICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgICAgIHRoaXMuaWQgPSBpZDtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMucGFyZW50LmxhdGVzdCA9PT0gdGhpcy5pZCAmJiB0aGlzLnBhcmVudC5vLm9uTmV4dCh4KTtcblx0ICAgIH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLnBhcmVudC5sYXRlc3QgPT09IHRoaXMuaWQgJiYgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmICh0aGlzLnBhcmVudC5sYXRlc3QgPT09IHRoaXMuaWQpIHtcblx0ICAgICAgICB0aGlzLnBhcmVudC5oYXNMYXRlc3QgPSBmYWxzZTtcblx0ICAgICAgICB0aGlzLnBhcmVudC5pc1N0b3BwZWQgJiYgdGhpcy5wYXJlbnQuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTd2l0Y2hPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiBUcmFuc2Zvcm1zIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2luZyB2YWx1ZXMgb25seSBmcm9tIHRoZSBtb3N0IHJlY2VudCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgYXQgYW55IHBvaW50IGluIHRpbWUgcHJvZHVjZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBtb3N0IHJlY2VudCBpbm5lciBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaGFzIGJlZW4gcmVjZWl2ZWQuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG9bJ3N3aXRjaCddID0gb2JzZXJ2YWJsZVByb3RvLnN3aXRjaExhdGVzdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgU3dpdGNoT2JzZXJ2YWJsZSh0aGlzKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgVGFrZVVudGlsT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRha2VVbnRpbE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gVGFrZVVudGlsT2JzZXJ2YWJsZShzb3VyY2UsIG90aGVyKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLm90aGVyID0gaXNQcm9taXNlKG90aGVyKSA/IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikgOiBvdGhlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGFrZVVudGlsT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuXHQgICAgICAgIHRoaXMuc291cmNlLnN1YnNjcmliZShvKSxcblx0ICAgICAgICB0aGlzLm90aGVyLnN1YnNjcmliZShuZXcgVGFrZVVudGlsT2JzZXJ2ZXIobykpXG5cdCAgICAgICk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBUYWtlVW50aWxPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFRha2VVbnRpbE9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGFrZVVudGlsT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUYWtlVW50aWxPYnNlcnZlcihvKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUYWtlVW50aWxPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBUYWtlVW50aWxPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlcnIpO1xuXHQgICAgfTtcblx0XG5cdCAgICBUYWtlVW50aWxPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBub29wO1xuXHRcblx0ICAgIHJldHVybiBUYWtlVW50aWxPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyB0aGUgdmFsdWVzIGZyb20gdGhlIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHVudGlsIHRoZSBvdGhlciBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2VzIGEgdmFsdWUuXG5cdCAgICogQHBhcmFtIHtPYnNlcnZhYmxlIHwgUHJvbWlzZX0gb3RoZXIgT2JzZXJ2YWJsZSBzZXF1ZW5jZSBvciBQcm9taXNlIHRoYXQgdGVybWluYXRlcyBwcm9wYWdhdGlvbiBvZiBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UgdXAgdG8gdGhlIHBvaW50IHRoZSBvdGhlciBzZXF1ZW5jZSBpbnRlcnJ1cHRlZCBmdXJ0aGVyIHByb3BhZ2F0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50YWtlVW50aWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcblx0ICAgIHJldHVybiBuZXcgVGFrZVVudGlsT2JzZXJ2YWJsZSh0aGlzLCBvdGhlcik7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gZmFsc2VGYWN0b3J5KCkgeyByZXR1cm4gZmFsc2U7IH1cblx0ICBmdW5jdGlvbiBhcmd1bWVudHNUb0FycmF5KCkge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICByZXR1cm4gYXJncztcblx0ICB9XG5cdFxuXHQgIHZhciBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUoc291cmNlLCBzb3VyY2VzLCByZXN1bHRTZWxlY3Rvcikge1xuXHQgICAgICB0aGlzLl9zID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9zcyA9IHNvdXJjZXM7XG5cdCAgICAgIHRoaXMuX2NiID0gcmVzdWx0U2VsZWN0b3I7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBsZW4gPSB0aGlzLl9zcy5sZW5ndGg7XG5cdCAgICAgIHZhciBzdGF0ZSA9IHtcblx0ICAgICAgICBoYXNWYWx1ZTogYXJyYXlJbml0aWFsaXplKGxlbiwgZmFsc2VGYWN0b3J5KSxcblx0ICAgICAgICBoYXNWYWx1ZUFsbDogZmFsc2UsXG5cdCAgICAgICAgdmFsdWVzOiBuZXcgQXJyYXkobGVuKVxuXHQgICAgICB9O1xuXHRcblx0ICAgICAgdmFyIG4gPSB0aGlzLl9zcy5sZW5ndGgsIHN1YnNjcmlwdGlvbnMgPSBuZXcgQXJyYXkobiArIDEpO1xuXHQgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykge1xuXHQgICAgICAgIHZhciBvdGhlciA9IHRoaXMuX3NzW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICBpc1Byb21pc2Uob3RoZXIpICYmIChvdGhlciA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikpO1xuXHQgICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKG90aGVyLnN1YnNjcmliZShuZXcgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyKG8sIGksIHN0YXRlKSkpO1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbnNbaV0gPSBzYWQ7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgc2FkLnNldERpc3Bvc2FibGUodGhpcy5fcy5zdWJzY3JpYmUobmV3IFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIobywgdGhpcy5fY2IsIHN0YXRlKSkpO1xuXHQgICAgICBzdWJzY3JpcHRpb25zW25dID0gc2FkO1xuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb25zKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyKG8sIGksIHN0YXRlKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9pID0gaTtcblx0ICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5fc3RhdGUudmFsdWVzW3RoaXMuX2ldID0geDtcblx0ICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVbdGhpcy5faV0gPSB0cnVlO1xuXHQgICAgICB0aGlzLl9zdGF0ZS5oYXNWYWx1ZUFsbCA9IHRoaXMuX3N0YXRlLmhhc1ZhbHVlLmV2ZXJ5KGlkZW50aXR5KTtcblx0ICAgIH07XG5cdFxuXHQgICAgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBub29wO1xuXHRcblx0ICAgIHJldHVybiBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIHZhciBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyKG8sIGNiLCBzdGF0ZSkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fY2IgPSBjYjtcblx0ICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHZhciBhbGxWYWx1ZXMgPSBbeF0uY29uY2F0KHRoaXMuX3N0YXRlLnZhbHVlcyk7XG5cdCAgICAgIGlmICghdGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwpIHsgcmV0dXJuOyB9XG5cdCAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl9jYikuYXBwbHkobnVsbCwgYWxsVmFsdWVzKTtcblx0ICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgdGhpcy5fby5vbk5leHQocmVzKTtcblx0ICAgIH07XG5cdFxuXHQgICAgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gb25seSB3aGVuIHRoZSAoZmlyc3QpIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2VzIGFuIGVsZW1lbnQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgc291cmNlcyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ud2l0aExhdGVzdEZyb20gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgYXJndW1lbnRzJyk7IH1cblx0XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHZhciByZXN1bHRTZWxlY3RvciA9IGlzRnVuY3Rpb24oYXJnc1tsZW4gLSAxXSkgPyBhcmdzLnBvcCgpIDogYXJndW1lbnRzVG9BcnJheTtcblx0ICAgIEFycmF5LmlzQXJyYXkoYXJnc1swXSkgJiYgKGFyZ3MgPSBhcmdzWzBdKTtcblx0XG5cdCAgICByZXR1cm4gbmV3IFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZSh0aGlzLCBhcmdzLCByZXN1bHRTZWxlY3Rvcik7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gZmFsc2VGYWN0b3J5KCkgeyByZXR1cm4gZmFsc2U7IH1cblx0ICBmdW5jdGlvbiBlbXB0eUFycmF5RmFjdG9yeSgpIHsgcmV0dXJuIFtdOyB9XG5cdFxuXHQgIHZhciBaaXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoWmlwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFppcE9ic2VydmFibGUoc291cmNlcywgcmVzdWx0U2VsZWN0b3IpIHtcblx0ICAgICAgdGhpcy5fcyA9IHNvdXJjZXM7XG5cdCAgICAgIHRoaXMuX2NiID0gcmVzdWx0U2VsZWN0b3I7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFppcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvYnNlcnZlcikge1xuXHQgICAgICB2YXIgbiA9IHRoaXMuX3MubGVuZ3RoLFxuXHQgICAgICAgICAgc3Vic2NyaXB0aW9ucyA9IG5ldyBBcnJheShuKTtcblx0ICAgICAgICAgIGRvbmUgPSBhcnJheUluaXRpYWxpemUobiwgZmFsc2VGYWN0b3J5KSxcblx0ICAgICAgICAgIHEgPSBhcnJheUluaXRpYWxpemUobiwgZW1wdHlBcnJheUZhY3RvcnkpO1xuXHRcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHtcblx0ICAgICAgICB2YXIgc291cmNlID0gdGhpcy5fc1tpXSwgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcblx0ICAgICAgICBpc1Byb21pc2Uoc291cmNlKSAmJiAoc291cmNlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHNvdXJjZSkpO1xuXHQgICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUobmV3IFppcE9ic2VydmVyKG9ic2VydmVyLCBpLCB0aGlzLCBxLCBkb25lKSkpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbnMpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gWmlwT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBaaXBPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhaaXBPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFppcE9ic2VydmVyKG8sIGksIHAsIHEsIGQpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX2kgPSBpO1xuXHQgICAgICB0aGlzLl9wID0gcDtcblx0ICAgICAgdGhpcy5fcSA9IHE7XG5cdCAgICAgIHRoaXMuX2QgPSBkO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBub3RFbXB0eSh4KSB7IHJldHVybiB4Lmxlbmd0aCA+IDA7IH1cblx0ICAgIGZ1bmN0aW9uIHNoaWZ0RWFjaCh4KSB7IHJldHVybiB4LnNoaWZ0KCk7IH1cblx0ICAgIGZ1bmN0aW9uIG5vdFRoZVNhbWUoaSkge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gKHgsIGopIHtcblx0ICAgICAgICByZXR1cm4gaiAhPT0gaTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBaaXBPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMuX3FbdGhpcy5faV0ucHVzaCh4KTtcblx0ICAgICAgaWYgKHRoaXMuX3EuZXZlcnkobm90RW1wdHkpKSB7XG5cdCAgICAgICAgdmFyIHF1ZXVlZFZhbHVlcyA9IHRoaXMuX3EubWFwKHNoaWZ0RWFjaCk7XG5cdCAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX3AuX2NiKS5hcHBseShudWxsLCBxdWV1ZWRWYWx1ZXMpO1xuXHQgICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgICAgdGhpcy5fby5vbk5leHQocmVzKTtcblx0ICAgICAgfSBlbHNlIGlmICh0aGlzLl9kLmZpbHRlcihub3RUaGVTYW1lKHRoaXMuX2kpKS5ldmVyeShpZGVudGl0eSkpIHtcblx0ICAgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgWmlwT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBaaXBPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9kW3RoaXMuX2ldID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5fZC5ldmVyeShpZGVudGl0eSkgJiYgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gWmlwT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFsbCBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgb3IgYW4gYXJyYXkgaGF2ZSBwcm9kdWNlZCBhbiBlbGVtZW50IGF0IGEgY29ycmVzcG9uZGluZyBpbmRleC5cblx0ICAgKiBUaGUgbGFzdCBlbGVtZW50IGluIHRoZSBhcmd1bWVudHMgbXVzdCBiZSBhIGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBzZXJpZXMgb2YgZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzIGluIHRoZSBhcmdzLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIGFyZ3MgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnppcCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7IHRocm93IG5ldyBFcnJvcignaW52YWxpZCBhcmd1bWVudHMnKTsgfVxuXHRcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuXHQgICAgQXJyYXkuaXNBcnJheShhcmdzWzBdKSAmJiAoYXJncyA9IGFyZ3NbMF0pO1xuXHRcblx0ICAgIHZhciBwYXJlbnQgPSB0aGlzO1xuXHQgICAgYXJncy51bnNoaWZ0KHBhcmVudCk7XG5cdFxuXHQgICAgcmV0dXJuIG5ldyBaaXBPYnNlcnZhYmxlKGFyZ3MsIHJlc3VsdFNlbGVjdG9yKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbGwgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIGhhdmUgcHJvZHVjZWQgYW4gZWxlbWVudCBhdCBhIGNvcnJlc3BvbmRpbmcgaW5kZXguXG5cdCAgICogQHBhcmFtIGFyZ3VtZW50cyBPYnNlcnZhYmxlIHNvdXJjZXMuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gcmVzdWx0U2VsZWN0b3IgRnVuY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIHNlcmllcyBvZiBlbGVtZW50cyBhdCBjb3JyZXNwb25kaW5nIGluZGV4ZXMgaW4gdGhlIHNvdXJjZXMuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgc291cmNlcyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBPYnNlcnZhYmxlLnppcCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJnc1swXSkpIHtcblx0ICAgICAgYXJncyA9IGlzRnVuY3Rpb24oYXJnc1sxXSkgPyBhcmdzWzBdLmNvbmNhdChhcmdzWzFdKSA6IGFyZ3NbMF07XG5cdCAgICB9XG5cdCAgICB2YXIgZmlyc3QgPSBhcmdzLnNoaWZ0KCk7XG5cdCAgICByZXR1cm4gZmlyc3QuemlwLmFwcGx5KGZpcnN0LCBhcmdzKTtcblx0ICB9O1xuXHRcblx0ZnVuY3Rpb24gZmFsc2VGYWN0b3J5KCkgeyByZXR1cm4gZmFsc2U7IH1cblx0ZnVuY3Rpb24gZW1wdHlBcnJheUZhY3RvcnkoKSB7IHJldHVybiBbXTsgfVxuXHRmdW5jdGlvbiBhcmd1bWVudHNUb0FycmF5KCkge1xuXHQgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICByZXR1cm4gYXJncztcblx0fVxuXHRcblx0LyoqXG5cdCAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFsbCBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgb3IgYW4gYXJyYXkgaGF2ZSBwcm9kdWNlZCBhbiBlbGVtZW50IGF0IGEgY29ycmVzcG9uZGluZyBpbmRleC5cblx0ICogVGhlIGxhc3QgZWxlbWVudCBpbiB0aGUgYXJndW1lbnRzIG11c3QgYmUgYSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggc2VyaWVzIG9mIGVsZW1lbnRzIGF0IGNvcnJlc3BvbmRpbmcgaW5kZXhlcyBpbiB0aGUgYXJncy5cblx0ICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgYXJncyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICovXG5cdG9ic2VydmFibGVQcm90by56aXBJdGVyYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0ICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgYXJndW1lbnRzJyk7IH1cblx0XG5cdCAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgIHZhciByZXN1bHRTZWxlY3RvciA9IGlzRnVuY3Rpb24oYXJnc1tsZW4gLSAxXSkgPyBhcmdzLnBvcCgpIDogYXJndW1lbnRzVG9BcnJheTtcblx0XG5cdCAgdmFyIHBhcmVudCA9IHRoaXM7XG5cdCAgYXJncy51bnNoaWZ0KHBhcmVudCk7XG5cdCAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICB2YXIgbiA9IGFyZ3MubGVuZ3RoLFxuXHQgICAgICBxdWV1ZXMgPSBhcnJheUluaXRpYWxpemUobiwgZW1wdHlBcnJheUZhY3RvcnkpLFxuXHQgICAgICBpc0RvbmUgPSBhcnJheUluaXRpYWxpemUobiwgZmFsc2VGYWN0b3J5KTtcblx0XG5cdCAgICB2YXIgc3Vic2NyaXB0aW9ucyA9IG5ldyBBcnJheShuKTtcblx0ICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IG47IGlkeCsrKSB7XG5cdCAgICAgIChmdW5jdGlvbiAoaSkge1xuXHQgICAgICAgIHZhciBzb3VyY2UgPSBhcmdzW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0XG5cdCAgICAgICAgKGlzQXJyYXlMaWtlKHNvdXJjZSkgfHwgaXNJdGVyYWJsZShzb3VyY2UpKSAmJiAoc291cmNlID0gb2JzZXJ2YWJsZUZyb20oc291cmNlKSk7XG5cdFxuXHQgICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICAgIHF1ZXVlc1tpXS5wdXNoKHgpO1xuXHQgICAgICAgICAgaWYgKHF1ZXVlcy5ldmVyeShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5sZW5ndGggPiAwOyB9KSkge1xuXHQgICAgICAgICAgICB2YXIgcXVldWVkVmFsdWVzID0gcXVldWVzLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5zaGlmdCgpOyB9KSxcblx0ICAgICAgICAgICAgICAgIHJlcyA9IHRyeUNhdGNoKHJlc3VsdFNlbGVjdG9yKS5hcHBseShwYXJlbnQsIHF1ZXVlZFZhbHVlcyk7XG5cdCAgICAgICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgICAgICAgIG8ub25OZXh0KHJlcyk7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKGlzRG9uZS5maWx0ZXIoZnVuY3Rpb24gKHgsIGopIHsgcmV0dXJuIGogIT09IGk7IH0pLmV2ZXJ5KGlkZW50aXR5KSkge1xuXHQgICAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBpc0RvbmVbaV0gPSB0cnVlO1xuXHQgICAgICAgICAgaXNEb25lLmV2ZXJ5KGlkZW50aXR5KSAmJiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfSkpO1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbnNbaV0gPSBzYWQ7XG5cdCAgICAgIH0pKGlkeCk7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbnMpO1xuXHQgIH0sIHBhcmVudCk7XG5cdH07XG5cdFxuXHQgIGZ1bmN0aW9uIGFzT2JzZXJ2YWJsZShzb3VyY2UpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbiBzdWJzY3JpYmUobykgeyByZXR1cm4gc291cmNlLnN1YnNjcmliZShvKTsgfTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqICBIaWRlcyB0aGUgaWRlbnRpdHkgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGhpZGVzIHRoZSBpZGVudGl0eSBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5hc09ic2VydmFibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoYXNPYnNlcnZhYmxlKHRoaXMpLCB0aGlzKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZShzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgRGVtYXRlcmlhbGl6ZU9ic2VydmVyKG8pKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIERlbWF0ZXJpYWxpemVPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhEZW1hdGVyaWFsaXplT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gRGVtYXRlcmlhbGl6ZU9ic2VydmVyKG8pIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIERlbWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHguYWNjZXB0KHRoaXMuX28pOyB9O1xuXHQgICAgRGVtYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcblx0ICAgIERlbWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cdFxuXHQgICAgcmV0dXJuIERlbWF0ZXJpYWxpemVPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogRGVtYXRlcmlhbGl6ZXMgdGhlIGV4cGxpY2l0IG5vdGlmaWNhdGlvbiB2YWx1ZXMgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyBpbXBsaWNpdCBub3RpZmljYXRpb25zLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGV4aGliaXRpbmcgdGhlIGJlaGF2aW9yIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHNvdXJjZSBzZXF1ZW5jZSdzIG5vdGlmaWNhdGlvbiB2YWx1ZXMuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmRlbWF0ZXJpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlKHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUoc291cmNlLCBrZXlGbiwgY29tcGFyZXIpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMua2V5Rm4gPSBrZXlGbjtcblx0ICAgICAgdGhpcy5jb21wYXJlciA9IGNvbXBhcmVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyKG8sIHRoaXMua2V5Rm4sIHRoaXMuY29tcGFyZXIpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIobywga2V5Rm4sIGNvbXBhcmVyKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMua2V5Rm4gPSBrZXlGbjtcblx0ICAgICAgdGhpcy5jb21wYXJlciA9IGNvbXBhcmVyO1xuXHQgICAgICB0aGlzLmhhc0N1cnJlbnRLZXkgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5jdXJyZW50S2V5ID0gbnVsbDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHZhciBrZXkgPSB4LCBjb21wYXJlckVxdWFscztcblx0ICAgICAgaWYgKGlzRnVuY3Rpb24odGhpcy5rZXlGbikpIHtcblx0ICAgICAgICBrZXkgPSB0cnlDYXRjaCh0aGlzLmtleUZuKSh4KTtcblx0ICAgICAgICBpZiAoa2V5ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3Ioa2V5LmUpOyB9XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKHRoaXMuaGFzQ3VycmVudEtleSkge1xuXHQgICAgICAgIGNvbXBhcmVyRXF1YWxzID0gdHJ5Q2F0Y2godGhpcy5jb21wYXJlcikodGhpcy5jdXJyZW50S2V5LCBrZXkpO1xuXHQgICAgICAgIGlmIChjb21wYXJlckVxdWFscyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKGNvbXBhcmVyRXF1YWxzLmUpOyB9XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKCF0aGlzLmhhc0N1cnJlbnRLZXkgfHwgIWNvbXBhcmVyRXF1YWxzKSB7XG5cdCAgICAgICAgdGhpcy5oYXNDdXJyZW50S2V5ID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmN1cnJlbnRLZXkgPSBrZXk7XG5cdCAgICAgICAgdGhpcy5vLm9uTmV4dCh4KTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdCAgICBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgb25seSBkaXN0aW5jdCBjb250aWd1b3VzIGVsZW1lbnRzIGFjY29yZGluZyB0byB0aGUga2V5Rm4gYW5kIHRoZSBjb21wYXJlci5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IFtrZXlGbl0gQSBmdW5jdGlvbiB0byBjb21wdXRlIHRoZSBjb21wYXJpc29uIGtleSBmb3IgZWFjaCBlbGVtZW50LiBJZiBub3QgcHJvdmlkZWQsIGl0IHByb2plY3RzIHRoZSB2YWx1ZS5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wYXJlcl0gRXF1YWxpdHkgY29tcGFyZXIgZm9yIGNvbXB1dGVkIGtleSB2YWx1ZXMuIElmIG5vdCBwcm92aWRlZCwgZGVmYXVsdHMgdG8gYW4gZXF1YWxpdHkgY29tcGFyZXIgZnVuY3Rpb24uXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvbmx5IGNvbnRhaW5pbmcgdGhlIGRpc3RpbmN0IGNvbnRpZ3VvdXMgZWxlbWVudHMsIGJhc2VkIG9uIGEgY29tcHV0ZWQga2V5IHZhbHVlLCBmcm9tIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uZGlzdGluY3RVbnRpbENoYW5nZWQgPSBmdW5jdGlvbiAoa2V5Rm4sIGNvbXBhcmVyKSB7XG5cdCAgICBjb21wYXJlciB8fCAoY29tcGFyZXIgPSBkZWZhdWx0Q29tcGFyZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUodGhpcywga2V5Rm4sIGNvbXBhcmVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgVGFwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRhcE9ic2VydmFibGUsX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRhcE9ic2VydmFibGUoc291cmNlLCBvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fb04gPSBvYnNlcnZlck9yT25OZXh0O1xuXHQgICAgICB0aGlzLl9vRSA9IG9uRXJyb3I7XG5cdCAgICAgIHRoaXMuX29DID0gb25Db21wbGV0ZWQ7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRhcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgdGhpcykpO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgcCkge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLnQgPSAhcC5fb04gfHwgaXNGdW5jdGlvbihwLl9vTikgP1xuXHQgICAgICAgIG9ic2VydmVyQ3JlYXRlKHAuX29OIHx8IG5vb3AsIHAuX29FIHx8IG5vb3AsIHAuX29DIHx8IG5vb3ApIDpcblx0ICAgICAgICBwLl9vTjtcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHgpIHtcblx0ICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMudC5vbk5leHQpLmNhbGwodGhpcy50LCB4KTtcblx0ICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgdGhpcy5vLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgIHRoaXMuby5vbk5leHQoeCk7XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihlcnIpIHtcblx0ICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMudC5vbkVycm9yKS5jYWxsKHRoaXMudCwgZXJyKTtcblx0ICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICB0aGlzLm8ub25FcnJvcihlcnIpO1xuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy50Lm9uQ29tcGxldGVkKS5jYWxsKHRoaXMudCk7XG5cdCAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBUYXBPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgSW52b2tlcyBhbiBhY3Rpb24gZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhbmQgaW52b2tlcyBhbiBhY3Rpb24gdXBvbiBncmFjZWZ1bCBvciBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqICBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBmb3IgZGVidWdnaW5nLCBsb2dnaW5nLCBldGMuIG9mIHF1ZXJ5IGJlaGF2aW9yIGJ5IGludGVyY2VwdGluZyB0aGUgbWVzc2FnZSBzdHJlYW0gdG8gcnVuIGFyYml0cmFyeSBhY3Rpb25zIGZvciBtZXNzYWdlcyBvbiB0aGUgcGlwZWxpbmUuXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9uIHwgT2JzZXJ2ZXJ9IG9ic2VydmVyT3JPbk5leHQgQWN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIG9yIGFuIG8uXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25FcnJvcl0gIEFjdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS4gVXNlZCBpZiBvbmx5IHRoZSBvYnNlcnZlck9yT25OZXh0IHBhcmFtZXRlciBpcyBhbHNvIGEgZnVuY3Rpb24uXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25Db21wbGV0ZWRdICBBY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuIFVzZWQgaWYgb25seSB0aGUgb2JzZXJ2ZXJPck9uTmV4dCBwYXJhbWV0ZXIgaXMgYWxzbyBhIGZ1bmN0aW9uLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90b1snZG8nXSA9IG9ic2VydmFibGVQcm90by50YXAgPSBvYnNlcnZhYmxlUHJvdG8uZG9BY3Rpb24gPSBmdW5jdGlvbiAob2JzZXJ2ZXJPck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgIHJldHVybiBuZXcgVGFwT2JzZXJ2YWJsZSh0aGlzLCBvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgSW52b2tlcyBhbiBhY3Rpb24gZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqICBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBmb3IgZGVidWdnaW5nLCBsb2dnaW5nLCBldGMuIG9mIHF1ZXJ5IGJlaGF2aW9yIGJ5IGludGVyY2VwdGluZyB0aGUgbWVzc2FnZSBzdHJlYW0gdG8gcnVuIGFyYml0cmFyeSBhY3Rpb25zIGZvciBtZXNzYWdlcyBvbiB0aGUgcGlwZWxpbmUuXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbk5leHQgQWN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoIHRoZSBzaWRlLWVmZmVjdGluZyBiZWhhdmlvciBhcHBsaWVkLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmRvT25OZXh0ID0gb2JzZXJ2YWJsZVByb3RvLnRhcE9uTmV4dCA9IGZ1bmN0aW9uIChvbk5leHQsIHRoaXNBcmcpIHtcblx0ICAgIHJldHVybiB0aGlzLnRhcCh0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbiAoeCkgeyBvbk5leHQuY2FsbCh0aGlzQXJnLCB4KTsgfSA6IG9uTmV4dCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgSW52b2tlcyBhbiBhY3Rpb24gdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqICBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBmb3IgZGVidWdnaW5nLCBsb2dnaW5nLCBldGMuIG9mIHF1ZXJ5IGJlaGF2aW9yIGJ5IGludGVyY2VwdGluZyB0aGUgbWVzc2FnZSBzdHJlYW0gdG8gcnVuIGFyYml0cmFyeSBhY3Rpb25zIGZvciBtZXNzYWdlcyBvbiB0aGUgcGlwZWxpbmUuXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkVycm9yIEFjdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5kb09uRXJyb3IgPSBvYnNlcnZhYmxlUHJvdG8udGFwT25FcnJvciA9IGZ1bmN0aW9uIChvbkVycm9yLCB0aGlzQXJnKSB7XG5cdCAgICByZXR1cm4gdGhpcy50YXAobm9vcCwgdHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24gKGUpIHsgb25FcnJvci5jYWxsKHRoaXNBcmcsIGUpOyB9IDogb25FcnJvcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgSW52b2tlcyBhbiBhY3Rpb24gdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqICBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBmb3IgZGVidWdnaW5nLCBsb2dnaW5nLCBldGMuIG9mIHF1ZXJ5IGJlaGF2aW9yIGJ5IGludGVyY2VwdGluZyB0aGUgbWVzc2FnZSBzdHJlYW0gdG8gcnVuIGFyYml0cmFyeSBhY3Rpb25zIGZvciBtZXNzYWdlcyBvbiB0aGUgcGlwZWxpbmUuXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkNvbXBsZXRlZCBBY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uZG9PbkNvbXBsZXRlZCA9IG9ic2VydmFibGVQcm90by50YXBPbkNvbXBsZXRlZCA9IGZ1bmN0aW9uIChvbkNvbXBsZXRlZCwgdGhpc0FyZykge1xuXHQgICAgcmV0dXJuIHRoaXMudGFwKG5vb3AsIG51bGwsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uICgpIHsgb25Db21wbGV0ZWQuY2FsbCh0aGlzQXJnKTsgfSA6IG9uQ29tcGxldGVkKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgSW52b2tlcyBhIHNwZWNpZmllZCBhY3Rpb24gYWZ0ZXIgdGhlIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRlcm1pbmF0ZXMgZ3JhY2VmdWxseSBvciBleGNlcHRpb25hbGx5LlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZpbmFsbHlBY3Rpb24gQWN0aW9uIHRvIGludm9rZSBhZnRlciB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdGVybWluYXRlcy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gU291cmNlIHNlcXVlbmNlIHdpdGggdGhlIGFjdGlvbi1pbnZva2luZyB0ZXJtaW5hdGlvbiBiZWhhdmlvciBhcHBsaWVkLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90b1snZmluYWxseSddID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXHQgICAgdmFyIHNvdXJjZSA9IHRoaXM7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBzdWJzY3JpcHRpb24gPSB0cnlDYXRjaChzb3VyY2Uuc3Vic2NyaWJlKS5jYWxsKHNvdXJjZSwgb2JzZXJ2ZXIpO1xuXHQgICAgICBpZiAoc3Vic2NyaXB0aW9uID09PSBlcnJvck9iaikge1xuXHQgICAgICAgIGFjdGlvbigpO1xuXHQgICAgICAgIHJldHVybiB0aHJvd2VyKHN1YnNjcmlwdGlvbi5lKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIHIgPSB0cnlDYXRjaChzdWJzY3JpcHRpb24uZGlzcG9zZSkuY2FsbChzdWJzY3JpcHRpb24pO1xuXHQgICAgICAgIGFjdGlvbigpO1xuXHQgICAgICAgIHIgPT09IGVycm9yT2JqICYmIHRocm93ZXIoci5lKTtcblx0ICAgICAgfSk7XG5cdCAgICB9LCB0aGlzKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZShzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobykpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8pIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IG5vb3A7XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGVycikge1xuXHQgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vLm9uRXJyb3IoZXJyKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXIub25FcnJvcihlKTtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIElnbm9yZXMgYWxsIGVsZW1lbnRzIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgbGVhdmluZyBvbmx5IHRoZSB0ZXJtaW5hdGlvbiBtZXNzYWdlcy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gZW1wdHkgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNpZ25hbHMgdGVybWluYXRpb24sIHN1Y2Nlc3NmdWwgb3IgZXhjZXB0aW9uYWwsIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmlnbm9yZUVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBJZ25vcmVFbGVtZW50c09ic2VydmFibGUodGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIE1hdGVyaWFsaXplT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhNYXRlcmlhbGl6ZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBNYXRlcmlhbGl6ZU9ic2VydmFibGUoc291cmNlLCBmbikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgTWF0ZXJpYWxpemVPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgTWF0ZXJpYWxpemVPYnNlcnZlcihvKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBNYXRlcmlhbGl6ZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgTWF0ZXJpYWxpemVPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhNYXRlcmlhbGl6ZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIE1hdGVyaWFsaXplT2JzZXJ2ZXIobykge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgTWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KG5vdGlmaWNhdGlvbkNyZWF0ZU9uTmV4dCh4KSkgfTtcblx0ICAgIE1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fby5vbk5leHQobm90aWZpY2F0aW9uQ3JlYXRlT25FcnJvcihlKSk7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblx0ICAgIE1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbk5leHQobm90aWZpY2F0aW9uQ3JlYXRlT25Db21wbGV0ZWQoKSk7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblx0XG5cdCAgICByZXR1cm4gTWF0ZXJpYWxpemVPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIE1hdGVyaWFsaXplcyB0aGUgaW1wbGljaXQgbm90aWZpY2F0aW9ucyBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIGV4cGxpY2l0IG5vdGlmaWNhdGlvbiB2YWx1ZXMuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgbWF0ZXJpYWxpemVkIG5vdGlmaWNhdGlvbiB2YWx1ZXMgZnJvbSB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5tYXRlcmlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgTWF0ZXJpYWxpemVPYnNlcnZhYmxlKHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXBlYXRzIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGEgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy4gSWYgdGhlIHJlcGVhdCBjb3VudCBpcyBub3Qgc3BlY2lmaWVkLCB0aGUgc2VxdWVuY2UgcmVwZWF0cyBpbmRlZmluaXRlbHkuXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IFtyZXBlYXRDb3VudF0gIE51bWJlciBvZiB0aW1lcyB0byByZXBlYXQgdGhlIHNlcXVlbmNlLiBJZiBub3QgcHJvdmlkZWQsIHJlcGVhdHMgdGhlIHNlcXVlbmNlIGluZGVmaW5pdGVseS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2VxdWVuY2UgcmVwZWF0ZWRseS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucmVwZWF0ID0gZnVuY3Rpb24gKHJlcGVhdENvdW50KSB7XG5cdCAgICByZXR1cm4gZW51bWVyYWJsZVJlcGVhdCh0aGlzLCByZXBlYXRDb3VudCkuY29uY2F0KCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJlcGVhdHMgdGhlIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzIG9yIHVudGlsIGl0IHN1Y2Nlc3NmdWxseSB0ZXJtaW5hdGVzLiBJZiB0aGUgcmV0cnkgY291bnQgaXMgbm90IHNwZWNpZmllZCwgaXQgcmV0cmllcyBpbmRlZmluaXRlbHkuXG5cdCAgICogIE5vdGUgaWYgeW91IGVuY291bnRlciBhbiBlcnJvciBhbmQgd2FudCBpdCB0byByZXRyeSBvbmNlLCB0aGVuIHlvdSBtdXN0IHVzZSAucmV0cnkoMik7XG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqICB2YXIgcmVzID0gcmV0cmllZCA9IHJldHJ5LnJlcGVhdCgpO1xuXHQgICAqICB2YXIgcmVzID0gcmV0cmllZCA9IHJldHJ5LnJlcGVhdCgyKTtcblx0ICAgKiBAcGFyYW0ge051bWJlcn0gW3JldHJ5Q291bnRdICBOdW1iZXIgb2YgdGltZXMgdG8gcmV0cnkgdGhlIHNlcXVlbmNlLiBJZiBub3QgcHJvdmlkZWQsIHJldHJ5IHRoZSBzZXF1ZW5jZSBpbmRlZmluaXRlbHkuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2VxdWVuY2UgcmVwZWF0ZWRseSB1bnRpbCBpdCB0ZXJtaW5hdGVzIHN1Y2Nlc3NmdWxseS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucmV0cnkgPSBmdW5jdGlvbiAocmV0cnlDb3VudCkge1xuXHQgICAgcmV0dXJuIGVudW1lcmFibGVSZXBlYXQodGhpcywgcmV0cnlDb3VudCkuY2F0Y2hFcnJvcigpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXBlYXRzIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1cG9uIGVycm9yIGVhY2ggdGltZSB0aGUgbm90aWZpZXIgZW1pdHMgb3IgdW50aWwgaXQgc3VjY2Vzc2Z1bGx5IHRlcm1pbmF0ZXMuIFxuXHQgICAqICBpZiB0aGUgbm90aWZpZXIgY29tcGxldGVzLCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb21wbGV0ZXMuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqICB2YXIgdGltZXIgPSBPYnNlcnZhYmxlLnRpbWVyKDUwMCk7XG5cdCAgICogIHZhciBzb3VyY2UgPSBvYnNlcnZhYmxlLnJldHJ5V2hlbih0aW1lcik7XG5cdCAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBbbm90aWZpZXJdIEFuIG9ic2VydmFibGUgdGhhdCB0cmlnZ2VycyB0aGUgcmV0cmllcyBvciBjb21wbGV0ZXMgdGhlIG9ic2VydmFibGUgd2l0aCBvbk5leHQgb3Igb25Db21wbGV0ZWQgcmVzcGVjdGl2ZWx5LlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2luZyB0aGUgZWxlbWVudHMgb2YgdGhlIGdpdmVuIHNlcXVlbmNlIHJlcGVhdGVkbHkgdW50aWwgaXQgdGVybWluYXRlcyBzdWNjZXNzZnVsbHkuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnJldHJ5V2hlbiA9IGZ1bmN0aW9uIChub3RpZmllcikge1xuXHQgICAgcmV0dXJuIGVudW1lcmFibGVSZXBlYXQodGhpcykuY2F0Y2hFcnJvcldoZW4obm90aWZpZXIpO1xuXHQgIH07XG5cdCAgdmFyIFNjYW5PYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2Nhbk9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTY2FuT2JzZXJ2YWJsZShzb3VyY2UsIGFjY3VtdWxhdG9yLCBoYXNTZWVkLCBzZWVkKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLmFjY3VtdWxhdG9yID0gYWNjdW11bGF0b3I7XG5cdCAgICAgIHRoaXMuaGFzU2VlZCA9IGhhc1NlZWQ7XG5cdCAgICAgIHRoaXMuc2VlZCA9IHNlZWQ7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNjYW5PYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBTY2FuT2JzZXJ2ZXIobyx0aGlzKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTY2FuT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBTY2FuT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2Nhbk9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU2Nhbk9ic2VydmVyKG8sIHBhcmVudCkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcCA9IHBhcmVudDtcblx0ICAgICAgdGhpcy5fZm4gPSBwYXJlbnQuYWNjdW11bGF0b3I7XG5cdCAgICAgIHRoaXMuX2hzID0gcGFyZW50Lmhhc1NlZWQ7XG5cdCAgICAgIHRoaXMuX3MgPSBwYXJlbnQuc2VlZDtcblx0ICAgICAgdGhpcy5faGEgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5fYSA9IG51bGw7XG5cdCAgICAgIHRoaXMuX2h2ID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuX2kgPSAwO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTY2FuT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAhdGhpcy5faHYgJiYgKHRoaXMuX2h2ID0gdHJ1ZSk7XG5cdCAgICAgIGlmICh0aGlzLl9oYSkge1xuXHQgICAgICAgIHRoaXMuX2EgPSB0cnlDYXRjaCh0aGlzLl9mbikodGhpcy5fYSwgeCwgdGhpcy5faSwgdGhpcy5fcCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdGhpcy5fYSA9IHRoaXMuX2hzID8gdHJ5Q2F0Y2godGhpcy5fZm4pKHRoaXMuX3MsIHgsIHRoaXMuX2ksIHRoaXMuX3ApIDogeDtcblx0ICAgICAgICB0aGlzLl9oYSA9IHRydWU7XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKHRoaXMuX2EgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IodGhpcy5fYS5lKTsgfVxuXHQgICAgICB0aGlzLl9vLm9uTmV4dCh0aGlzLl9hKTtcblx0ICAgICAgdGhpcy5faSsrO1xuXHQgICAgfTtcblx0XG5cdCAgICBTY2FuT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTY2FuT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgIXRoaXMuX2h2ICYmIHRoaXMuX2hzICYmIHRoaXMuX28ub25OZXh0KHRoaXMuX3MpO1xuXHQgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTY2FuT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogIEFwcGxpZXMgYW4gYWNjdW11bGF0b3IgZnVuY3Rpb24gb3ZlciBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFuZCByZXR1cm5zIGVhY2ggaW50ZXJtZWRpYXRlIHJlc3VsdC4gVGhlIG9wdGlvbmFsIHNlZWQgdmFsdWUgaXMgdXNlZCBhcyB0aGUgaW5pdGlhbCBhY2N1bXVsYXRvciB2YWx1ZS5cblx0ICAqICBGb3IgYWdncmVnYXRpb24gYmVoYXZpb3Igd2l0aCBubyBpbnRlcm1lZGlhdGUgcmVzdWx0cywgc2VlIE9ic2VydmFibGUuYWdncmVnYXRlLlxuXHQgICogQHBhcmFtIHtNaXhlZH0gW3NlZWRdIFRoZSBpbml0aWFsIGFjY3VtdWxhdG9yIHZhbHVlLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gYWNjdW11bGF0b3IgQW4gYWNjdW11bGF0b3IgZnVuY3Rpb24gdG8gYmUgaW52b2tlZCBvbiBlYWNoIGVsZW1lbnQuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBhY2N1bXVsYXRlZCB2YWx1ZXMuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2NhbiA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBoYXNTZWVkID0gZmFsc2UsIHNlZWQsIGFjY3VtdWxhdG9yID0gYXJndW1lbnRzWzBdO1xuXHQgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcblx0ICAgICAgaGFzU2VlZCA9IHRydWU7XG5cdCAgICAgIHNlZWQgPSBhcmd1bWVudHNbMV07XG5cdCAgICB9XG5cdCAgICByZXR1cm4gbmV3IFNjYW5PYnNlcnZhYmxlKHRoaXMsIGFjY3VtdWxhdG9yLCBoYXNTZWVkLCBzZWVkKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgU2tpcExhc3RPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNraXBMYXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFNraXBMYXN0T2JzZXJ2YWJsZShzb3VyY2UsIGMpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2MgPSBjO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTa2lwTGFzdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBTa2lwTGFzdE9ic2VydmVyKG8sIHRoaXMuX2MpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNraXBMYXN0T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBTa2lwTGFzdE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNraXBMYXN0T2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTa2lwTGFzdE9ic2VydmVyKG8sIGMpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX2MgPSBjO1xuXHQgICAgICB0aGlzLl9xID0gW107XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNraXBMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLl9xLnB1c2goeCk7XG5cdCAgICAgIHRoaXMuX3EubGVuZ3RoID4gdGhpcy5fYyAmJiB0aGlzLl9vLm9uTmV4dCh0aGlzLl9xLnNoaWZ0KCkpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTa2lwTGFzdE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2tpcExhc3RPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTa2lwTGFzdE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgQnlwYXNzZXMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGF0IHRoZSBlbmQgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiAgVGhpcyBvcGVyYXRvciBhY2N1bXVsYXRlcyBhIHF1ZXVlIHdpdGggYSBsZW5ndGggZW5vdWdoIHRvIHN0b3JlIHRoZSBmaXJzdCBgY291bnRgIGVsZW1lbnRzLiBBcyBtb3JlIGVsZW1lbnRzIGFyZVxuXHQgICAqICByZWNlaXZlZCwgZWxlbWVudHMgYXJlIHRha2VuIGZyb20gdGhlIGZyb250IG9mIHRoZSBxdWV1ZSBhbmQgcHJvZHVjZWQgb24gdGhlIHJlc3VsdCBzZXF1ZW5jZS4gVGhpcyBjYXVzZXMgZWxlbWVudHMgdG8gYmUgZGVsYXllZC5cblx0ICAgKiBAcGFyYW0gY291bnQgTnVtYmVyIG9mIGVsZW1lbnRzIHRvIGJ5cGFzcyBhdCB0aGUgZW5kIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgc291cmNlIHNlcXVlbmNlIGVsZW1lbnRzIGV4Y2VwdCBmb3IgdGhlIGJ5cGFzc2VkIG9uZXMgYXQgdGhlIGVuZC5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2tpcExhc3QgPSBmdW5jdGlvbiAoY291bnQpIHtcblx0ICAgIGlmIChjb3VudCA8IDApIHsgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yKCk7IH1cblx0ICAgIHJldHVybiBuZXcgU2tpcExhc3RPYnNlcnZhYmxlKHRoaXMsIGNvdW50KTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgUHJlcGVuZHMgYSBzZXF1ZW5jZSBvZiB2YWx1ZXMgdG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIGFuIG9wdGlvbmFsIHNjaGVkdWxlciBhbmQgYW4gYXJndW1lbnQgbGlzdCBvZiB2YWx1ZXMgdG8gcHJlcGVuZC5cblx0ICAgKiAgQGV4YW1wbGVcblx0ICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5zdGFydFdpdGgoMSwgMiwgMyk7XG5cdCAgICogIHZhciByZXMgPSBzb3VyY2Uuc3RhcnRXaXRoKFJ4LlNjaGVkdWxlci50aW1lb3V0LCAxLCAyLCAzKTtcblx0ICAgKiBAcGFyYW0ge0FyZ3VtZW50c30gYXJncyBUaGUgc3BlY2lmaWVkIHZhbHVlcyB0byBwcmVwZW5kIHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2UgcHJlcGVuZGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZXMuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnN0YXJ0V2l0aCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciB2YWx1ZXMsIHNjaGVkdWxlciwgc3RhcnQgPSAwO1xuXHQgICAgaWYgKCEhYXJndW1lbnRzLmxlbmd0aCAmJiBpc1NjaGVkdWxlcihhcmd1bWVudHNbMF0pKSB7XG5cdCAgICAgIHNjaGVkdWxlciA9IGFyZ3VtZW50c1swXTtcblx0ICAgICAgc3RhcnQgPSAxO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyO1xuXHQgICAgfVxuXHQgICAgZm9yKHZhciBhcmdzID0gW10sIGkgPSBzdGFydCwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3MucHVzaChhcmd1bWVudHNbaV0pOyB9XG5cdCAgICByZXR1cm4gZW51bWVyYWJsZU9mKFtvYnNlcnZhYmxlRnJvbUFycmF5KGFyZ3MsIHNjaGVkdWxlciksIHRoaXNdKS5jb25jYXQoKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgVGFrZUxhc3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUYWtlTGFzdE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVGFrZUxhc3RPYnNlcnZlcihvLCBjKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9jID0gYztcblx0ICAgICAgdGhpcy5fcSA9IFtdO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUYWtlTGFzdE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5fcS5wdXNoKHgpO1xuXHQgICAgICB0aGlzLl9xLmxlbmd0aCA+IHRoaXMuX2MgJiYgdGhpcy5fcS5zaGlmdCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBUYWtlTGFzdE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgVGFrZUxhc3RPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB3aGlsZSAodGhpcy5fcS5sZW5ndGggPiAwKSB7IHRoaXMuX28ub25OZXh0KHRoaXMuX3Euc2hpZnQoKSk7IH1cblx0ICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gVGFrZUxhc3RPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGNvbnRpZ3VvdXMgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogIFRoaXMgb3BlcmF0b3IgYWNjdW11bGF0ZXMgYSBidWZmZXIgd2l0aCBhIGxlbmd0aCBlbm91Z2ggdG8gc3RvcmUgZWxlbWVudHMgY291bnQgZWxlbWVudHMuIFVwb24gY29tcGxldGlvbiBvZlxuXHQgICAqICB0aGUgc291cmNlIHNlcXVlbmNlLCB0aGlzIGJ1ZmZlciBpcyBkcmFpbmVkIG9uIHRoZSByZXN1bHQgc2VxdWVuY2UuIFRoaXMgY2F1c2VzIHRoZSBlbGVtZW50cyB0byBiZSBkZWxheWVkLlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCBOdW1iZXIgb2YgZWxlbWVudHMgdG8gdGFrZSBmcm9tIHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50YWtlTGFzdCA9IGZ1bmN0aW9uIChjb3VudCkge1xuXHQgICAgaWYgKGNvdW50IDwgMCkgeyB0aHJvdyBuZXcgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IoKTsgfVxuXHQgICAgdmFyIHNvdXJjZSA9IHRoaXM7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IFRha2VMYXN0T2JzZXJ2ZXIobywgY291bnQpKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfTtcblx0XG5cdG9ic2VydmFibGVQcm90by5mbGF0TWFwQ29uY2F0ID0gb2JzZXJ2YWJsZVByb3RvLmNvbmNhdE1hcCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuXHQgICAgcmV0dXJuIG5ldyBGbGF0TWFwT2JzZXJ2YWJsZSh0aGlzLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpLm1lcmdlKDEpO1xuXHR9O1xuXHQgIHZhciBNYXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE1hcE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gTWFwT2JzZXJ2YWJsZShzb3VyY2UsIHNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLnNlbGVjdG9yID0gYmluZENhbGxiYWNrKHNlbGVjdG9yLCB0aGlzQXJnLCAzKTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gaW5uZXJNYXAoc2VsZWN0b3IsIHNlbGYpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uICh4LCBpLCBvKSB7IHJldHVybiBzZWxlY3Rvci5jYWxsKHRoaXMsIHNlbGYuc2VsZWN0b3IoeCwgaSwgbyksIGksIG8pOyB9XG5cdCAgICB9XG5cdFxuXHQgICAgTWFwT2JzZXJ2YWJsZS5wcm90b3R5cGUuaW50ZXJuYWxNYXAgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBNYXBPYnNlcnZhYmxlKHRoaXMuc291cmNlLCBpbm5lck1hcChzZWxlY3RvciwgdGhpcyksIHRoaXNBcmcpO1xuXHQgICAgfTtcblx0XG5cdCAgICBNYXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnNlbGVjdG9yLCB0aGlzKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBzZWxlY3Rvciwgc291cmNlKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3Rvcjtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuaSA9IDA7XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuXHQgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5zZWxlY3RvcikoeCwgdGhpcy5pKyssIHRoaXMuc291cmNlKTtcblx0ICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuXHQgICAgICB0aGlzLm8ub25OZXh0KHJlc3VsdCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBNYXBPYnNlcnZhYmxlO1xuXHRcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogUHJvamVjdHMgZWFjaCBlbGVtZW50IG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgaW50byBhIG5ldyBmb3JtIGJ5IGluY29ycG9yYXRpbmcgdGhlIGVsZW1lbnQncyBpbmRleC5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IHNlbGVjdG9yIEEgdHJhbnNmb3JtIGZ1bmN0aW9uIHRvIGFwcGx5IHRvIGVhY2ggc291cmNlIGVsZW1lbnQ7IHRoZSBzZWNvbmQgcGFyYW1ldGVyIG9mIHRoZSBmdW5jdGlvbiByZXByZXNlbnRzIHRoZSBpbmRleCBvZiB0aGUgc291cmNlIGVsZW1lbnQuXG5cdCAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSB0cmFuc2Zvcm0gZnVuY3Rpb24gb24gZWFjaCBlbGVtZW50IG9mIHNvdXJjZS5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5tYXAgPSBvYnNlcnZhYmxlUHJvdG8uc2VsZWN0ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdCAgICB2YXIgc2VsZWN0b3JGbiA9IHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJyA/IHNlbGVjdG9yIDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZWN0b3I7IH07XG5cdCAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIE1hcE9ic2VydmFibGUgP1xuXHQgICAgICB0aGlzLmludGVybmFsTWFwKHNlbGVjdG9yRm4sIHRoaXNBcmcpIDpcblx0ICAgICAgbmV3IE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3JGbiwgdGhpc0FyZyk7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gcGx1Y2tlcihhcmdzLCBsZW4pIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbiBtYXBwZXIoeCkge1xuXHQgICAgICB2YXIgY3VycmVudFByb3AgPSB4O1xuXHQgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgdmFyIHAgPSBjdXJyZW50UHJvcFthcmdzW2ldXTtcblx0ICAgICAgICBpZiAodHlwZW9mIHAgIT09ICd1bmRlZmluZWQnKSB7XG5cdCAgICAgICAgICBjdXJyZW50UHJvcCA9IHA7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBjdXJyZW50UHJvcDtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHJpZXZlcyB0aGUgdmFsdWUgb2YgYSBzcGVjaWZpZWQgbmVzdGVkIHByb3BlcnR5IGZyb20gYWxsIGVsZW1lbnRzIGluXG5cdCAgICogdGhlIE9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHBhcmFtIHtBcmd1bWVudHN9IGFyZ3VtZW50cyBUaGUgbmVzdGVkIHByb3BlcnRpZXMgdG8gcGx1Y2suXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFJldHVybnMgYSBuZXcgT2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBwcm9wZXJ0eSB2YWx1ZXMuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnBsdWNrID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGlmIChsZW4gPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdMaXN0IG9mIHByb3BlcnRpZXMgY2Fubm90IGJlIGVtcHR5LicpOyB9XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgcmV0dXJuIHRoaXMubWFwKHBsdWNrZXIoYXJncywgbGVuKSk7XG5cdCAgfTtcblx0XG5cdG9ic2VydmFibGVQcm90by5mbGF0TWFwID0gb2JzZXJ2YWJsZVByb3RvLnNlbGVjdE1hbnkgPSBmdW5jdGlvbihzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0ICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5tZXJnZUFsbCgpO1xuXHR9O1xuXHRcblx0XG5cdC8vXG5cdC8vUnguT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcFdpdGhNYXhDb25jdXJyZW50ID0gZnVuY3Rpb24obGltaXQsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuXHQvLyAgICByZXR1cm4gbmV3IEZsYXRNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykubWVyZ2UobGltaXQpO1xuXHQvL307XG5cdC8vXG5cdFxuXHRSeC5PYnNlcnZhYmxlLnByb3RvdHlwZS5mbGF0TWFwTGF0ZXN0ID0gZnVuY3Rpb24oc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdCAgICByZXR1cm4gbmV3IEZsYXRNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykuc3dpdGNoTGF0ZXN0KCk7XG5cdH07XG5cdCAgdmFyIFNraXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2tpcE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTa2lwT2JzZXJ2YWJsZShzb3VyY2UsIGNvdW50KSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLnNraXBDb3VudCA9IGNvdW50O1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0ICAgIFxuXHQgICAgU2tpcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMuc2tpcENvdW50KSk7XG5cdCAgICB9O1xuXHQgICAgXG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIGMpIHtcblx0ICAgICAgdGhpcy5jID0gYztcblx0ICAgICAgdGhpcy5yID0gYztcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgaWYgKHRoaXMuciA8PSAwKSB7IFxuXHQgICAgICAgIHRoaXMuby5vbk5leHQoeCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdGhpcy5yLS07XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgdGhpcy5vLm9uRXJyb3IoZSk7IH1cblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgdGhpcy5vLm9uQ29tcGxldGVkKCk7IH1cblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfTtcblx0ICAgIFxuXHQgICAgcmV0dXJuIFNraXBPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTsgIFxuXHQgIFxuXHQgIC8qKlxuXHQgICAqIEJ5cGFzc2VzIGEgc3BlY2lmaWVkIG51bWJlciBvZiBlbGVtZW50cyBpbiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFuZCB0aGVuIHJldHVybnMgdGhlIHJlbWFpbmluZyBlbGVtZW50cy5cblx0ICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byBza2lwIGJlZm9yZSByZXR1cm5pbmcgdGhlIHJlbWFpbmluZyBlbGVtZW50cy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyB0aGF0IG9jY3VyIGFmdGVyIHRoZSBzcGVjaWZpZWQgaW5kZXggaW4gdGhlIGlucHV0IHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5za2lwID0gZnVuY3Rpb24gKGNvdW50KSB7XG5cdCAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG5cdCAgICByZXR1cm4gbmV3IFNraXBPYnNlcnZhYmxlKHRoaXMsIGNvdW50KTtcblx0ICB9O1xuXHQgIHZhciBTa2lwV2hpbGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNraXBXaGlsZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTa2lwV2hpbGVPYnNlcnZhYmxlKHNvdXJjZSwgZm4pIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2ZuID0gZm47XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNraXBXaGlsZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBTa2lwV2hpbGVPYnNlcnZlcihvLCB0aGlzKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTa2lwV2hpbGVPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFNraXBXaGlsZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNraXBXaGlsZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFNraXBXaGlsZU9ic2VydmVyKG8sIHApIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3AgPSBwO1xuXHQgICAgICB0aGlzLl9pID0gMDtcblx0ICAgICAgdGhpcy5fciA9IGZhbHNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTa2lwV2hpbGVPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIGlmICghdGhpcy5fcikge1xuXHQgICAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl9wLl9mbikoeCwgdGhpcy5faSsrLCB0aGlzLl9wKTtcblx0ICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICAgIHRoaXMuX3IgPSAhcmVzO1xuXHQgICAgICB9XG5cdCAgICAgIHRoaXMuX3IgJiYgdGhpcy5fby5vbk5leHQoeCk7XG5cdCAgICB9O1xuXHQgICAgU2tpcFdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fby5vbkVycm9yKGUpOyB9O1xuXHQgICAgU2tpcFdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXHRcblx0ICAgIHJldHVybiBTa2lwV2hpbGVPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIEJ5cGFzc2VzIGVsZW1lbnRzIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgbG9uZyBhcyBhIHNwZWNpZmllZCBjb25kaXRpb24gaXMgdHJ1ZSBhbmQgdGhlbiByZXR1cm5zIHRoZSByZW1haW5pbmcgZWxlbWVudHMuXG5cdCAgICogIFRoZSBlbGVtZW50J3MgaW5kZXggaXMgdXNlZCBpbiB0aGUgbG9naWMgb2YgdGhlIHByZWRpY2F0ZSBmdW5jdGlvbi5cblx0ICAgKlxuXHQgICAqICB2YXIgcmVzID0gc291cmNlLnNraXBXaGlsZShmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHZhbHVlIDwgMTA7IH0pO1xuXHQgICAqICB2YXIgcmVzID0gc291cmNlLnNraXBXaGlsZShmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7IHJldHVybiB2YWx1ZSA8IDEwIHx8IGluZGV4IDwgMTA7IH0pO1xuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWRpY2F0ZSBBIGZ1bmN0aW9uIHRvIHRlc3QgZWFjaCBlbGVtZW50IGZvciBhIGNvbmRpdGlvbjsgdGhlIHNlY29uZCBwYXJhbWV0ZXIgb2YgdGhlIGZ1bmN0aW9uIHJlcHJlc2VudHMgdGhlIGluZGV4IG9mIHRoZSBzb3VyY2UgZWxlbWVudC5cblx0ICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBmcm9tIHRoZSBpbnB1dCBzZXF1ZW5jZSBzdGFydGluZyBhdCB0aGUgZmlyc3QgZWxlbWVudCBpbiB0aGUgbGluZWFyIHNlcmllcyB0aGF0IGRvZXMgbm90IHBhc3MgdGhlIHRlc3Qgc3BlY2lmaWVkIGJ5IHByZWRpY2F0ZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2tpcFdoaWxlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhpc0FyZykge1xuXHQgICAgdmFyIGZuID0gYmluZENhbGxiYWNrKHByZWRpY2F0ZSwgdGhpc0FyZywgMyk7XG5cdCAgICByZXR1cm4gbmV3IFNraXBXaGlsZU9ic2VydmFibGUodGhpcywgZm4pO1xuXHQgIH07XG5cdFxuXHQgIHZhciBUYWtlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRha2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgXG5cdCAgICBmdW5jdGlvbiBUYWtlT2JzZXJ2YWJsZShzb3VyY2UsIGNvdW50KSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLnRha2VDb3VudCA9IGNvdW50O1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0ICAgIFxuXHQgICAgVGFrZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMudGFrZUNvdW50KSk7XG5cdCAgICB9O1xuXHQgICAgXG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIGMpIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5jID0gYztcblx0ICAgICAgdGhpcy5yID0gYztcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlID0ge1xuXHQgICAgICBvbk5leHQ6IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIGlmICh0aGlzLnItLSA+IDApIHtcblx0ICAgICAgICAgIHRoaXMuby5vbk5leHQoeCk7XG5cdCAgICAgICAgICB0aGlzLnIgPD0gMCAmJiB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLm8ub25FcnJvcihlcnIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9LFxuXHQgICAgICBmYWlsOiBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIFxuXHQgICAgcmV0dXJuIFRha2VPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTsgIFxuXHQgIFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGEgc3BlY2lmaWVkIG51bWJlciBvZiBjb250aWd1b3VzIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIGZvciB0aGUgZWRnZSBjYXNlIG9mIHRha2UoMCkuXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gcmV0dXJuLlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdXNlZCB0byBwcm9kdWNlIGFuIE9uQ29tcGxldGVkIG1lc3NhZ2UgaW4gY2FzZSA8cGFyYW1yZWYgbmFtZT1cImNvdW50IGNvdW50PC9wYXJhbXJlZj4gaXMgc2V0IHRvIDAuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiB0aGUgaW5wdXQgc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRha2UgPSBmdW5jdGlvbiAoY291bnQsIHNjaGVkdWxlcikge1xuXHQgICAgaWYgKGNvdW50IDwgMCkgeyB0aHJvdyBuZXcgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IoKTsgfVxuXHQgICAgaWYgKGNvdW50ID09PSAwKSB7IHJldHVybiBvYnNlcnZhYmxlRW1wdHkoc2NoZWR1bGVyKTsgfVxuXHQgICAgcmV0dXJuIG5ldyBUYWtlT2JzZXJ2YWJsZSh0aGlzLCBjb3VudCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRha2VXaGlsZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGFrZVdoaWxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRha2VXaGlsZU9ic2VydmFibGUoc291cmNlLCBmbikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fZm4gPSBmbjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGFrZVdoaWxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFRha2VXaGlsZU9ic2VydmVyKG8sIHRoaXMpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFRha2VXaGlsZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgVGFrZVdoaWxlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGFrZVdoaWxlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gVGFrZVdoaWxlT2JzZXJ2ZXIobywgcCkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcCA9IHA7XG5cdCAgICAgIHRoaXMuX2kgPSAwO1xuXHQgICAgICB0aGlzLl9yID0gdHJ1ZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGFrZVdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICBpZiAodGhpcy5fcikge1xuXHQgICAgICAgIHRoaXMuX3IgPSB0cnlDYXRjaCh0aGlzLl9wLl9mbikoeCwgdGhpcy5faSsrLCB0aGlzLl9wKTtcblx0ICAgICAgICBpZiAodGhpcy5fciA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcih0aGlzLl9yLmUpOyB9XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKHRoaXMuX3IpIHtcblx0ICAgICAgICB0aGlzLl9vLm9uTmV4dCh4KTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBUYWtlV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG5cdCAgICBUYWtlV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cdFxuXHQgICAgcmV0dXJuIFRha2VXaGlsZU9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBlbGVtZW50cyBmcm9tIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgbG9uZyBhcyBhIHNwZWNpZmllZCBjb25kaXRpb24gaXMgdHJ1ZS5cblx0ICAgKiAgVGhlIGVsZW1lbnQncyBpbmRleCBpcyB1c2VkIGluIHRoZSBsb2dpYyBvZiB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWRpY2F0ZSBBIGZ1bmN0aW9uIHRvIHRlc3QgZWFjaCBlbGVtZW50IGZvciBhIGNvbmRpdGlvbjsgdGhlIHNlY29uZCBwYXJhbWV0ZXIgb2YgdGhlIGZ1bmN0aW9uIHJlcHJlc2VudHMgdGhlIGluZGV4IG9mIHRoZSBzb3VyY2UgZWxlbWVudC5cblx0ICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBmcm9tIHRoZSBpbnB1dCBzZXF1ZW5jZSB0aGF0IG9jY3VyIGJlZm9yZSB0aGUgZWxlbWVudCBhdCB3aGljaCB0aGUgdGVzdCBubyBsb25nZXIgcGFzc2VzLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50YWtlV2hpbGUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB0aGlzQXJnKSB7XG5cdCAgICB2YXIgZm4gPSBiaW5kQ2FsbGJhY2socHJlZGljYXRlLCB0aGlzQXJnLCAzKTtcblx0ICAgIHJldHVybiBuZXcgVGFrZVdoaWxlT2JzZXJ2YWJsZSh0aGlzLCBmbik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIEZpbHRlck9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRmlsdGVyT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBGaWx0ZXJPYnNlcnZhYmxlKHNvdXJjZSwgcHJlZGljYXRlLCB0aGlzQXJnKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLnByZWRpY2F0ZSA9IGJpbmRDYWxsYmFjayhwcmVkaWNhdGUsIHRoaXNBcmcsIDMpO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBGaWx0ZXJPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnByZWRpY2F0ZSwgdGhpcykpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBpbm5lclByZWRpY2F0ZShwcmVkaWNhdGUsIHNlbGYpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uKHgsIGksIG8pIHsgcmV0dXJuIHNlbGYucHJlZGljYXRlKHgsIGksIG8pICYmIHByZWRpY2F0ZS5jYWxsKHRoaXMsIHgsIGksIG8pOyB9XG5cdCAgICB9XG5cdFxuXHQgICAgRmlsdGVyT2JzZXJ2YWJsZS5wcm90b3R5cGUuaW50ZXJuYWxGaWx0ZXIgPSBmdW5jdGlvbihwcmVkaWNhdGUsIHRoaXNBcmcpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBGaWx0ZXJPYnNlcnZhYmxlKHRoaXMuc291cmNlLCBpbm5lclByZWRpY2F0ZShwcmVkaWNhdGUsIHRoaXMpLCB0aGlzQXJnKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHByZWRpY2F0ZSwgc291cmNlKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMucHJlZGljYXRlID0gcHJlZGljYXRlO1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5pID0gMDtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbih4KSB7XG5cdCAgICAgIHZhciBzaG91bGRZaWVsZCA9IHRyeUNhdGNoKHRoaXMucHJlZGljYXRlKSh4LCB0aGlzLmkrKywgdGhpcy5zb3VyY2UpO1xuXHQgICAgICBpZiAoc2hvdWxkWWllbGQgPT09IGVycm9yT2JqKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuby5vbkVycm9yKHNob3VsZFlpZWxkLmUpO1xuXHQgICAgICB9XG5cdCAgICAgIHNob3VsZFlpZWxkICYmIHRoaXMuby5vbk5leHQoeCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBGaWx0ZXJPYnNlcnZhYmxlO1xuXHRcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogIEZpbHRlcnMgdGhlIGVsZW1lbnRzIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYmFzZWQgb24gYSBwcmVkaWNhdGUgYnkgaW5jb3Jwb3JhdGluZyB0aGUgZWxlbWVudCdzIGluZGV4LlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIHNvdXJjZSBlbGVtZW50IGZvciBhIGNvbmRpdGlvbjsgdGhlIHNlY29uZCBwYXJhbWV0ZXIgb2YgdGhlIGZ1bmN0aW9uIHJlcHJlc2VudHMgdGhlIGluZGV4IG9mIHRoZSBzb3VyY2UgZWxlbWVudC5cblx0ICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyBlbGVtZW50cyBmcm9tIHRoZSBpbnB1dCBzZXF1ZW5jZSB0aGF0IHNhdGlzZnkgdGhlIGNvbmRpdGlvbi5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5maWx0ZXIgPSBvYnNlcnZhYmxlUHJvdG8ud2hlcmUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB0aGlzQXJnKSB7XG5cdCAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIEZpbHRlck9ic2VydmFibGUgPyB0aGlzLmludGVybmFsRmlsdGVyKHByZWRpY2F0ZSwgdGhpc0FyZykgOlxuXHQgICAgICBuZXcgRmlsdGVyT2JzZXJ2YWJsZSh0aGlzLCBwcmVkaWNhdGUsIHRoaXNBcmcpO1xuXHQgIH07XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVDYk9ic2VydmFibGUoZm4sIGN0eCwgc2VsZWN0b3IsIGFyZ3MpIHtcblx0ICB2YXIgbyA9IG5ldyBBc3luY1N1YmplY3QoKTtcblx0XG5cdCAgYXJncy5wdXNoKGNyZWF0ZUNiSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSk7XG5cdCAgZm4uYXBwbHkoY3R4LCBhcmdzKTtcblx0XG5cdCAgcmV0dXJuIG8uYXNPYnNlcnZhYmxlKCk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGNyZWF0ZUNiSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlc3VsdHMgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyByZXN1bHRzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdFxuXHQgICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpKSB7XG5cdCAgICAgIHJlc3VsdHMgPSB0cnlDYXRjaChzZWxlY3RvcikuYXBwbHkoY3R4LCByZXN1bHRzKTtcblx0ICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuXHQgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA8PSAxKSB7XG5cdCAgICAgICAgby5vbk5leHQocmVzdWx0c1swXSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgby5vbk5leHQocmVzdWx0cyk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgfTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICpcblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gRnVuY3Rpb24gd2l0aCBhIGNhbGxiYWNrIGFzIHRoZSBsYXN0IHBhcmFtZXRlciB0byBjb252ZXJ0IHRvIGFuIE9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAqIEBwYXJhbSB7TWl4ZWR9IFtjdHhdIFRoZSBjb250ZXh0IGZvciB0aGUgZnVuYyBwYXJhbWV0ZXIgdG8gYmUgZXhlY3V0ZWQuICBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byB1bmRlZmluZWQuXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gQSBzZWxlY3RvciB3aGljaCB0YWtlcyB0aGUgYXJndW1lbnRzIGZyb20gdGhlIGNhbGxiYWNrIHRvIHByb2R1Y2UgYSBzaW5nbGUgaXRlbSB0byB5aWVsZCBvbiBuZXh0LlxuXHQgKiBAcmV0dXJucyB7RnVuY3Rpb259IEEgZnVuY3Rpb24sIHdoZW4gZXhlY3V0ZWQgd2l0aCB0aGUgcmVxdWlyZWQgcGFyYW1ldGVycyBtaW51cyB0aGUgY2FsbGJhY2ssIHByb2R1Y2VzIGFuIE9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCBhIHNpbmdsZSB2YWx1ZSBvZiB0aGUgYXJndW1lbnRzIHRvIHRoZSBjYWxsYmFjayBhcyBhbiBhcnJheS5cblx0ICovXG5cdE9ic2VydmFibGUuZnJvbUNhbGxiYWNrID0gZnVuY3Rpb24gKGZuLCBjdHgsIHNlbGVjdG9yKSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgIHR5cGVvZiBjdHggPT09ICd1bmRlZmluZWQnICYmIChjdHggPSB0aGlzKTsgXG5cdFxuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKVxuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHJldHVybiBjcmVhdGVDYk9ic2VydmFibGUoZm4sIGN0eCwgc2VsZWN0b3IsIGFyZ3MpO1xuXHQgIH07XG5cdH07XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVOb2RlT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncykge1xuXHQgIHZhciBvID0gbmV3IEFzeW5jU3ViamVjdCgpO1xuXHRcblx0ICBhcmdzLnB1c2goY3JlYXRlTm9kZUhhbmRsZXIobywgY3R4LCBzZWxlY3RvcikpO1xuXHQgIGZuLmFwcGx5KGN0eCwgYXJncyk7XG5cdFxuXHQgIHJldHVybiBvLmFzT2JzZXJ2YWJsZSgpO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVOb2RlSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuXHQgICAgdmFyIGVyciA9IGFyZ3VtZW50c1swXTtcblx0ICAgIGlmIChlcnIpIHsgcmV0dXJuIG8ub25FcnJvcihlcnIpOyB9XG5cdFxuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIHJlc3VsdHMgPSBbXTtcblx0ICAgIGZvcih2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykgeyByZXN1bHRzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHRcblx0ICAgIGlmIChpc0Z1bmN0aW9uKHNlbGVjdG9yKSkge1xuXHQgICAgICB2YXIgcmVzdWx0cyA9IHRyeUNhdGNoKHNlbGVjdG9yKS5hcHBseShjdHgsIHJlc3VsdHMpO1xuXHQgICAgICBpZiAocmVzdWx0cyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXN1bHRzLmUpOyB9XG5cdCAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoIDw9IDEpIHtcblx0ICAgICAgICBvLm9uTmV4dChyZXN1bHRzWzBdKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICB9O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ29udmVydHMgYSBOb2RlLmpzIGNhbGxiYWNrIHN0eWxlIGZ1bmN0aW9uIHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuICBUaGlzIG11c3QgYmUgaW4gZnVuY3Rpb24gKGVyciwgLi4uKSBmb3JtYXQuXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBjYWxsXG5cdCAqIEBwYXJhbSB7TWl4ZWR9IFtjdHhdIFRoZSBjb250ZXh0IGZvciB0aGUgZnVuYyBwYXJhbWV0ZXIgdG8gYmUgZXhlY3V0ZWQuICBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byB1bmRlZmluZWQuXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gQSBzZWxlY3RvciB3aGljaCB0YWtlcyB0aGUgYXJndW1lbnRzIGZyb20gdGhlIGNhbGxiYWNrIG1pbnVzIHRoZSBlcnJvciB0byBwcm9kdWNlIGEgc2luZ2xlIGl0ZW0gdG8geWllbGQgb24gbmV4dC5cblx0ICogQHJldHVybnMge0Z1bmN0aW9ufSBBbiBhc3luYyBmdW5jdGlvbiB3aGljaCB3aGVuIGFwcGxpZWQsIHJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIHRoZSBjYWxsYmFjayBhcmd1bWVudHMgYXMgYW4gYXJyYXkuXG5cdCAqL1xuXHRPYnNlcnZhYmxlLmZyb21Ob2RlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZm4sIGN0eCwgc2VsZWN0b3IpIHtcblx0ICByZXR1cm4gZnVuY3Rpb24gKCkge1xuXHQgICAgdHlwZW9mIGN0eCA9PT0gJ3VuZGVmaW5lZCcgJiYgKGN0eCA9IHRoaXMpOyBcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgcmV0dXJuIGNyZWF0ZU5vZGVPYnNlcnZhYmxlKGZuLCBjdHgsIHNlbGVjdG9yLCBhcmdzKTtcblx0ICB9O1xuXHR9O1xuXHRcblx0ICBmdW5jdGlvbiBpc05vZGVMaXN0KGVsKSB7XG5cdCAgICBpZiAocm9vdC5TdGF0aWNOb2RlTGlzdCkge1xuXHQgICAgICAvLyBJRTggU3BlY2lmaWNcblx0ICAgICAgLy8gaW5zdGFuY2VvZiBpcyBzbG93ZXIgdGhhbiBPYmplY3QjdG9TdHJpbmcsIGJ1dCBPYmplY3QjdG9TdHJpbmcgd2lsbCBub3Qgd29yayBhcyBpbnRlbmRlZCBpbiBJRThcblx0ICAgICAgcmV0dXJuIGVsIGluc3RhbmNlb2Ygcm9vdC5TdGF0aWNOb2RlTGlzdCB8fCBlbCBpbnN0YW5jZW9mIHJvb3QuTm9kZUxpc3Q7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGVsKSA9PT0gJ1tvYmplY3QgTm9kZUxpc3RdJztcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIExpc3RlbkRpc3Bvc2FibGUoZSwgbiwgZm4pIHtcblx0ICAgIHRoaXMuX2UgPSBlO1xuXHQgICAgdGhpcy5fbiA9IG47XG5cdCAgICB0aGlzLl9mbiA9IGZuO1xuXHQgICAgdGhpcy5fZS5hZGRFdmVudExpc3RlbmVyKHRoaXMuX24sIHRoaXMuX2ZuLCBmYWxzZSk7XG5cdCAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICB9XG5cdCAgTGlzdGVuRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHRoaXMuX2UucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl9uLCB0aGlzLl9mbiwgZmFsc2UpO1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGNyZWF0ZUV2ZW50TGlzdGVuZXIgKGVsLCBldmVudE5hbWUsIGhhbmRsZXIpIHtcblx0ICAgIHZhciBkaXNwb3NhYmxlcyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG5cdFxuXHQgICAgLy8gQXN1bWUgTm9kZUxpc3Qgb3IgSFRNTENvbGxlY3Rpb25cblx0ICAgIHZhciBlbGVtVG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZWwpO1xuXHQgICAgaWYgKGlzTm9kZUxpc3QoZWwpIHx8IGVsZW1Ub1N0cmluZyA9PT0gJ1tvYmplY3QgSFRNTENvbGxlY3Rpb25dJykge1xuXHQgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gZWwubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICBkaXNwb3NhYmxlcy5hZGQoY3JlYXRlRXZlbnRMaXN0ZW5lcihlbC5pdGVtKGkpLCBldmVudE5hbWUsIGhhbmRsZXIpKTtcblx0ICAgICAgfVxuXHQgICAgfSBlbHNlIGlmIChlbCkge1xuXHQgICAgICBkaXNwb3NhYmxlcy5hZGQobmV3IExpc3RlbkRpc3Bvc2FibGUoZWwsIGV2ZW50TmFtZSwgaGFuZGxlcikpO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiBkaXNwb3NhYmxlcztcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqIENvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRldGVybWluZSB3aGV0aGVyIHRvIHVzZSBuYXRpdmUgZXZlbnRzIG9ubHlcblx0ICAgKi9cblx0ICBSeC5jb25maWcudXNlTmF0aXZlRXZlbnRzID0gZmFsc2U7XG5cdFxuXHQgIHZhciBFdmVudE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhFdmVudE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBFdmVudE9ic2VydmFibGUoZWwsIG5hbWUsIGZuKSB7XG5cdCAgICAgIHRoaXMuX2VsID0gZWw7XG5cdCAgICAgIHRoaXMuX24gPSBuYW1lO1xuXHQgICAgICB0aGlzLl9mbiA9IGZuO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBjcmVhdGVIYW5kbGVyKG8sIGZuKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyICgpIHtcblx0ICAgICAgICB2YXIgcmVzdWx0cyA9IGFyZ3VtZW50c1swXTtcblx0ICAgICAgICBpZiAoaXNGdW5jdGlvbihmbikpIHtcblx0ICAgICAgICAgIHJlc3VsdHMgPSB0cnlDYXRjaChmbikuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcblx0ICAgICAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgby5vbk5leHQocmVzdWx0cyk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgRXZlbnRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIGNyZWF0ZUV2ZW50TGlzdGVuZXIoXG5cdCAgICAgICAgdGhpcy5fZWwsXG5cdCAgICAgICAgdGhpcy5fbixcblx0ICAgICAgICBjcmVhdGVIYW5kbGVyKG8sIHRoaXMuX2ZuKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBFdmVudE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBDcmVhdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgYWRkaW5nIGFuIGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBtYXRjaGluZyBET01FbGVtZW50IG9yIGVhY2ggaXRlbSBpbiB0aGUgTm9kZUxpc3QuXG5cdCAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQgVGhlIERPTUVsZW1lbnQgb3IgTm9kZUxpc3QgdG8gYXR0YWNoIGEgbGlzdGVuZXIuXG5cdCAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSBUaGUgZXZlbnQgbmFtZSB0byBhdHRhY2ggdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBBIHNlbGVjdG9yIHdoaWNoIHRha2VzIHRoZSBhcmd1bWVudHMgZnJvbSB0aGUgZXZlbnQgaGFuZGxlciB0byBwcm9kdWNlIGEgc2luZ2xlIGl0ZW0gdG8geWllbGQgb24gbmV4dC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBldmVudHMgZnJvbSB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgYW5kIHRoZSBzcGVjaWZpZWQgZXZlbnQuXG5cdCAgICovXG5cdCAgT2JzZXJ2YWJsZS5mcm9tRXZlbnQgPSBmdW5jdGlvbiAoZWxlbWVudCwgZXZlbnROYW1lLCBzZWxlY3Rvcikge1xuXHQgICAgLy8gTm9kZS5qcyBzcGVjaWZpY1xuXHQgICAgaWYgKGVsZW1lbnQuYWRkTGlzdGVuZXIpIHtcblx0ICAgICAgcmV0dXJuIGZyb21FdmVudFBhdHRlcm4oXG5cdCAgICAgICAgZnVuY3Rpb24gKGgpIHsgZWxlbWVudC5hZGRMaXN0ZW5lcihldmVudE5hbWUsIGgpOyB9LFxuXHQgICAgICAgIGZ1bmN0aW9uIChoKSB7IGVsZW1lbnQucmVtb3ZlTGlzdGVuZXIoZXZlbnROYW1lLCBoKTsgfSxcblx0ICAgICAgICBzZWxlY3Rvcik7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gVXNlIG9ubHkgaWYgbm9uLW5hdGl2ZSBldmVudHMgYXJlIGFsbG93ZWRcblx0ICAgIGlmICghUnguY29uZmlnLnVzZU5hdGl2ZUV2ZW50cykge1xuXHQgICAgICAvLyBIYW5kbGVzIGpxLCBBbmd1bGFyLmpzLCBaZXB0bywgTWFyaW9uZXR0ZSwgRW1iZXIuanNcblx0ICAgICAgaWYgKHR5cGVvZiBlbGVtZW50Lm9uID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBlbGVtZW50Lm9mZiA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgICAgIHJldHVybiBmcm9tRXZlbnRQYXR0ZXJuKFxuXHQgICAgICAgICAgZnVuY3Rpb24gKGgpIHsgZWxlbWVudC5vbihldmVudE5hbWUsIGgpOyB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKGgpIHsgZWxlbWVudC5vZmYoZXZlbnROYW1lLCBoKTsgfSxcblx0ICAgICAgICAgIHNlbGVjdG9yKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiBuZXcgRXZlbnRPYnNlcnZhYmxlKGVsZW1lbnQsIGV2ZW50TmFtZSwgc2VsZWN0b3IpLnB1Ymxpc2goKS5yZWZDb3VudCgpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBFdmVudFBhdHRlcm5PYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEV2ZW50UGF0dGVybk9ic2VydmFibGUoYWRkLCBkZWwsIGZuKSB7XG5cdCAgICAgIHRoaXMuX2FkZCA9IGFkZDtcblx0ICAgICAgdGhpcy5fZGVsID0gZGVsO1xuXHQgICAgICB0aGlzLl9mbiA9IGZuO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBjcmVhdGVIYW5kbGVyKG8sIGZuKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyICgpIHtcblx0ICAgICAgICB2YXIgcmVzdWx0cyA9IGFyZ3VtZW50c1swXTtcblx0ICAgICAgICBpZiAoaXNGdW5jdGlvbihmbikpIHtcblx0ICAgICAgICAgIHJlc3VsdHMgPSB0cnlDYXRjaChmbikuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcblx0ICAgICAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgby5vbk5leHQocmVzdWx0cyk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBmbiA9IGNyZWF0ZUhhbmRsZXIobywgdGhpcy5fZm4pO1xuXHQgICAgICB2YXIgcmV0dXJuVmFsdWUgPSB0aGlzLl9hZGQoZm4pO1xuXHQgICAgICByZXR1cm4gbmV3IEV2ZW50UGF0dGVybkRpc3Bvc2FibGUodGhpcy5fZGVsLCBmbiwgcmV0dXJuVmFsdWUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBFdmVudFBhdHRlcm5EaXNwb3NhYmxlKGRlbCwgZm4sIHJldCkge1xuXHQgICAgICB0aGlzLl9kZWwgPSBkZWw7XG5cdCAgICAgIHRoaXMuX2ZuID0gZm47XG5cdCAgICAgIHRoaXMuX3JldCA9IHJldDtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgRXZlbnRQYXR0ZXJuRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICAgIGlzRnVuY3Rpb24odGhpcy5fZGVsKSAmJiB0aGlzLl9kZWwodGhpcy5fZm4sIHRoaXMuX3JldCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEV2ZW50UGF0dGVybk9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBDcmVhdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgZnJvbSBhbiBldmVudCBlbWl0dGVyIHZpYSBhbiBhZGRIYW5kbGVyL3JlbW92ZUhhbmRsZXIgcGFpci5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhZGRIYW5kbGVyIFRoZSBmdW5jdGlvbiB0byBhZGQgYSBoYW5kbGVyIHRvIHRoZSBlbWl0dGVyLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtyZW1vdmVIYW5kbGVyXSBUaGUgb3B0aW9uYWwgZnVuY3Rpb24gdG8gcmVtb3ZlIGEgaGFuZGxlciBmcm9tIGFuIGVtaXR0ZXIuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBBIHNlbGVjdG9yIHdoaWNoIHRha2VzIHRoZSBhcmd1bWVudHMgZnJvbSB0aGUgZXZlbnQgaGFuZGxlciB0byBwcm9kdWNlIGEgc2luZ2xlIGl0ZW0gdG8geWllbGQgb24gbmV4dC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB3cmFwcyBhbiBldmVudCBmcm9tIGFuIGV2ZW50IGVtaXR0ZXJcblx0ICAgKi9cblx0ICB2YXIgZnJvbUV2ZW50UGF0dGVybiA9IE9ic2VydmFibGUuZnJvbUV2ZW50UGF0dGVybiA9IGZ1bmN0aW9uIChhZGRIYW5kbGVyLCByZW1vdmVIYW5kbGVyLCBzZWxlY3Rvcikge1xuXHQgICAgcmV0dXJuIG5ldyBFdmVudFBhdHRlcm5PYnNlcnZhYmxlKGFkZEhhbmRsZXIsIHJlbW92ZUhhbmRsZXIsIHNlbGVjdG9yKS5wdWJsaXNoKCkucmVmQ291bnQoKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgRnJvbVByb21pc2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRnJvbVByb21pc2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRnJvbVByb21pc2VPYnNlcnZhYmxlKHAsIHMpIHtcblx0ICAgICAgdGhpcy5fcCA9IHA7XG5cdCAgICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzY2hlZHVsZU5leHQocywgc3RhdGUpIHtcblx0ICAgICAgdmFyIG8gPSBzdGF0ZVswXSwgZGF0YSA9IHN0YXRlWzFdO1xuXHQgICAgICBvLm9uTmV4dChkYXRhKTtcblx0ICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNjaGVkdWxlRXJyb3Iocywgc3RhdGUpIHtcblx0ICAgICAgdmFyIG8gPSBzdGF0ZVswXSwgZXJyID0gc3RhdGVbMV07XG5cdCAgICAgIG8ub25FcnJvcihlcnIpO1xuXHQgICAgfVxuXHRcblx0ICAgIEZyb21Qcm9taXNlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgdmFyIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLCBzZWxmID0gdGhpcztcblx0XG5cdCAgICAgIHRoaXMuX3Bcblx0ICAgICAgICAudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXHQgICAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc2VsZi5fcy5zY2hlZHVsZShbbywgZGF0YV0sIHNjaGVkdWxlTmV4dCkpO1xuXHQgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNlbGYuX3Muc2NoZWR1bGUoW28sIGVycl0sIHNjaGVkdWxlRXJyb3IpKTtcblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgIHJldHVybiBzYWQ7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBGcm9tUHJvbWlzZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAqIENvbnZlcnRzIGEgUHJvbWlzZSB0byBhbiBPYnNlcnZhYmxlIHNlcXVlbmNlXG5cdCAgKiBAcGFyYW0ge1Byb21pc2V9IEFuIEVTNiBDb21wbGlhbnQgcHJvbWlzZS5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIHdyYXBzIHRoZSBleGlzdGluZyBwcm9taXNlIHN1Y2Nlc3MgYW5kIGZhaWx1cmUuXG5cdCAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZUZyb21Qcm9taXNlID0gT2JzZXJ2YWJsZS5mcm9tUHJvbWlzZSA9IGZ1bmN0aW9uIChwcm9taXNlLCBzY2hlZHVsZXIpIHtcblx0ICAgIHNjaGVkdWxlciB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IEZyb21Qcm9taXNlT2JzZXJ2YWJsZShwcm9taXNlLCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIC8qXG5cdCAgICogQ29udmVydHMgYW4gZXhpc3Rpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0byBhbiBFUzYgQ29tcGF0aWJsZSBQcm9taXNlXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgcHJvbWlzZSA9IFJ4Lk9ic2VydmFibGUucmV0dXJuKDQyKS50b1Byb21pc2UoUlNWUC5Qcm9taXNlKTtcblx0ICAgKlxuXHQgICAqIC8vIFdpdGggY29uZmlnXG5cdCAgICogUnguY29uZmlnLlByb21pc2UgPSBSU1ZQLlByb21pc2U7XG5cdCAgICogdmFyIHByb21pc2UgPSBSeC5PYnNlcnZhYmxlLnJldHVybig0MikudG9Qcm9taXNlKCk7XG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3Byb21pc2VDdG9yXSBUaGUgY29uc3RydWN0b3Igb2YgdGhlIHByb21pc2UuIElmIG5vdCBwcm92aWRlZCwgaXQgbG9va3MgZm9yIGl0IGluIFJ4LmNvbmZpZy5Qcm9taXNlLlxuXHQgICAqIEByZXR1cm5zIHtQcm9taXNlfSBBbiBFUzYgY29tcGF0aWJsZSBwcm9taXNlIHdpdGggdGhlIGxhc3QgdmFsdWUgZnJvbSB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udG9Qcm9taXNlID0gZnVuY3Rpb24gKHByb21pc2VDdG9yKSB7XG5cdCAgICBwcm9taXNlQ3RvciB8fCAocHJvbWlzZUN0b3IgPSBSeC5jb25maWcuUHJvbWlzZSk7XG5cdCAgICBpZiAoIXByb21pc2VDdG9yKSB7IHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcignUHJvbWlzZSB0eXBlIG5vdCBwcm92aWRlZCBub3IgaW4gUnguY29uZmlnLlByb21pc2UnKTsgfVxuXHQgICAgdmFyIHNvdXJjZSA9IHRoaXM7XG5cdCAgICByZXR1cm4gbmV3IHByb21pc2VDdG9yKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgLy8gTm8gY2FuY2VsbGF0aW9uIGNhbiBiZSBkb25lXG5cdCAgICAgIHZhciB2YWx1ZTtcblx0ICAgICAgc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAodikge1xuXHQgICAgICAgIHZhbHVlID0gdjtcblx0ICAgICAgfSwgcmVqZWN0LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogSW52b2tlcyB0aGUgYXN5bmNocm9ub3VzIGZ1bmN0aW9uLCBzdXJmYWNpbmcgdGhlIHJlc3VsdCB0aHJvdWdoIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuY3Rpb25Bc3luYyBBc3luY2hyb25vdXMgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UgdG8gcnVuLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGV4cG9zaW5nIHRoZSBmdW5jdGlvbidzIHJlc3VsdCB2YWx1ZSwgb3IgYW4gZXhjZXB0aW9uLlxuXHQgICAqL1xuXHQgIE9ic2VydmFibGUuc3RhcnRBc3luYyA9IGZ1bmN0aW9uIChmdW5jdGlvbkFzeW5jKSB7XG5cdCAgICB2YXIgcHJvbWlzZSA9IHRyeUNhdGNoKGZ1bmN0aW9uQXN5bmMpKCk7XG5cdCAgICBpZiAocHJvbWlzZSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG9ic2VydmFibGVUaHJvdyhwcm9taXNlLmUpOyB9XG5cdCAgICByZXR1cm4gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHByb21pc2UpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBNdWx0aWNhc3RPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE11bHRpY2FzdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBNdWx0aWNhc3RPYnNlcnZhYmxlKHNvdXJjZSwgZm4xLCBmbjIpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2ZuMSA9IGZuMTtcblx0ICAgICAgdGhpcy5fZm4yID0gZm4yO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBNdWx0aWNhc3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGNvbm5lY3RhYmxlID0gdGhpcy5zb3VyY2UubXVsdGljYXN0KHRoaXMuX2ZuMSgpKTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHRoaXMuX2ZuMihjb25uZWN0YWJsZSkuc3Vic2NyaWJlKG8pLCBjb25uZWN0YWJsZS5jb25uZWN0KCkpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTXVsdGljYXN0T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIE11bHRpY2FzdHMgdGhlIHNvdXJjZSBzZXF1ZW5jZSBub3RpZmljYXRpb25zIHRocm91Z2ggYW4gaW5zdGFudGlhdGVkIHN1YmplY3QgaW50byBhbGwgdXNlcyBvZiB0aGUgc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uIEVhY2hcblx0ICAgKiBzdWJzY3JpcHRpb24gdG8gdGhlIHJlc3VsdGluZyBzZXF1ZW5jZSBjYXVzZXMgYSBzZXBhcmF0ZSBtdWx0aWNhc3QgaW52b2NhdGlvbiwgZXhwb3NpbmcgdGhlIHNlcXVlbmNlIHJlc3VsdGluZyBmcm9tIHRoZSBzZWxlY3RvciBmdW5jdGlvbidzXG5cdCAgICogaW52b2NhdGlvbi4gRm9yIHNwZWNpYWxpemF0aW9ucyB3aXRoIGZpeGVkIHN1YmplY3QgdHlwZXMsIHNlZSBQdWJsaXNoLCBQdWJsaXNoTGFzdCwgYW5kIFJlcGxheS5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogMSAtIHJlcyA9IHNvdXJjZS5tdWx0aWNhc3Qob2JzZXJ2YWJsZSk7XG5cdCAgICogMiAtIHJlcyA9IHNvdXJjZS5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFN1YmplY3QoKTsgfSwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuXHQgICAqXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbnxTdWJqZWN0fSBzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3Jcblx0ICAgKiBGYWN0b3J5IGZ1bmN0aW9uIHRvIGNyZWF0ZSBhbiBpbnRlcm1lZGlhdGUgc3ViamVjdCB0aHJvdWdoIHdoaWNoIHRoZSBzb3VyY2Ugc2VxdWVuY2UncyBlbGVtZW50cyB3aWxsIGJlIG11bHRpY2FzdCB0byB0aGUgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICogT3I6XG5cdCAgICogU3ViamVjdCB0byBwdXNoIHNvdXJjZSBlbGVtZW50cyBpbnRvLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBPcHRpb25hbCBzZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2Ugc3ViamVjdCB0byB0aGUgcG9saWNpZXMgZW5mb3JjZWQgYnkgdGhlIGNyZWF0ZWQgc3ViamVjdC4gU3BlY2lmaWVkIG9ubHkgaWYgPHBhcmFtcmVmIG5hbWU9XCJzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3JcIiBpcyBhIGZhY3RvcnkgZnVuY3Rpb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ubXVsdGljYXN0ID0gZnVuY3Rpb24gKHN1YmplY3RPclN1YmplY3RTZWxlY3Rvciwgc2VsZWN0b3IpIHtcblx0ICAgIHJldHVybiBpc0Z1bmN0aW9uKHN1YmplY3RPclN1YmplY3RTZWxlY3RvcikgP1xuXHQgICAgICBuZXcgTXVsdGljYXN0T2JzZXJ2YWJsZSh0aGlzLCBzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IsIHNlbGVjdG9yKSA6XG5cdCAgICAgIG5ldyBDb25uZWN0YWJsZU9ic2VydmFibGUodGhpcywgc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSBzZWxlY3RvciBvbiBhIGNvbm5lY3RhYmxlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuXHQgICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBNdWx0aWNhc3QgdXNpbmcgYSByZWd1bGFyIFN1YmplY3QuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciByZXNyZXMgPSBzb3VyY2UucHVibGlzaCgpO1xuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucHVibGlzaChmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSk7XG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIFNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBhcyBtYW55IHRpbWVzIGFzIG5lZWRlZCwgd2l0aG91dCBjYXVzaW5nIG11bHRpcGxlIHN1YnNjcmlwdGlvbnMgdG8gdGhlIHNvdXJjZSBzZXF1ZW5jZS4gU3Vic2NyaWJlcnMgdG8gdGhlIGdpdmVuIHNvdXJjZSB3aWxsIHJlY2VpdmUgYWxsIG5vdGlmaWNhdGlvbnMgb2YgdGhlIHNvdXJjZSBmcm9tIHRoZSB0aW1lIG9mIHRoZSBzdWJzY3JpcHRpb24gb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucHVibGlzaCA9IGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuXHQgICAgcmV0dXJuIHNlbGVjdG9yICYmIGlzRnVuY3Rpb24oc2VsZWN0b3IpID9cblx0ICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFN1YmplY3QoKTsgfSwgc2VsZWN0b3IpIDpcblx0ICAgICAgdGhpcy5tdWx0aWNhc3QobmV3IFN1YmplY3QoKSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cblx0ICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgcHVibGlzaCB3aGljaCBjcmVhdGVzIGEgc3Vic2NyaXB0aW9uIHdoZW4gdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgZ29lcyBmcm9tIHplcm8gdG8gb25lLCB0aGVuIHNoYXJlcyB0aGF0IHN1YnNjcmlwdGlvbiB3aXRoIGFsbCBzdWJzZXF1ZW50IG9ic2VydmVycyB1bnRpbCB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyByZXR1cm5zIHRvIHplcm8sIGF0IHdoaWNoIHBvaW50IHRoZSBzdWJzY3JpcHRpb24gaXMgZGlzcG9zZWQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2hhcmUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcy5wdWJsaXNoKCkucmVmQ291bnQoKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSBzZWxlY3RvciBvbiBhIGNvbm5lY3RhYmxlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIGNvbnRhaW5pbmcgb25seSB0aGUgbGFzdCBub3RpZmljYXRpb24uXG5cdCAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIEFzeW5jU3ViamVjdC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoTGFzdCgpO1xuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucHVibGlzaExhc3QoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuXHQgICAqXG5cdCAgICogQHBhcmFtIHNlbGVjdG9yIFtPcHRpb25hbF0gU2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgb25seSByZWNlaXZlIHRoZSBsYXN0IG5vdGlmaWNhdGlvbiBvZiB0aGUgc291cmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2hMYXN0ID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG5cdCAgICByZXR1cm4gc2VsZWN0b3IgJiYgaXNGdW5jdGlvbihzZWxlY3RvcikgP1xuXHQgICAgICB0aGlzLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgQXN5bmNTdWJqZWN0KCk7IH0sIHNlbGVjdG9yKSA6XG5cdCAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBBc3luY1N1YmplY3QoKSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgc2VsZWN0b3Igb24gYSBjb25uZWN0YWJsZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSBhbmQgc3RhcnRzIHdpdGggaW5pdGlhbFZhbHVlLlxuXHQgICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBNdWx0aWNhc3QgdXNpbmcgYSBCZWhhdmlvclN1YmplY3QuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucHVibGlzaFZhbHVlKDQyKTtcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hWYWx1ZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5zZWxlY3QoZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkgKiB5OyB9KSB9LCA0Mik7XG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIE9wdGlvbmFsIHNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBhcyBtYW55IHRpbWVzIGFzIG5lZWRlZCwgd2l0aG91dCBjYXVzaW5nIG11bHRpcGxlIHN1YnNjcmlwdGlvbnMgdG8gdGhlIHNvdXJjZSBzZXF1ZW5jZS4gU3Vic2NyaWJlcnMgdG8gdGhlIGdpdmVuIHNvdXJjZSB3aWxsIHJlY2VpdmUgaW1tZWRpYXRlbHkgcmVjZWl2ZSB0aGUgaW5pdGlhbCB2YWx1ZSwgZm9sbG93ZWQgYnkgYWxsIG5vdGlmaWNhdGlvbnMgb2YgdGhlIHNvdXJjZSBmcm9tIHRoZSB0aW1lIG9mIHRoZSBzdWJzY3JpcHRpb24gb24uXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gaW5pdGlhbFZhbHVlIEluaXRpYWwgdmFsdWUgcmVjZWl2ZWQgYnkgb2JzZXJ2ZXJzIHVwb24gc3Vic2NyaXB0aW9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2hWYWx1ZSA9IGZ1bmN0aW9uIChpbml0aWFsVmFsdWVPclNlbGVjdG9yLCBpbml0aWFsVmFsdWUpIHtcblx0ICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAyID9cblx0ICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiBuZXcgQmVoYXZpb3JTdWJqZWN0KGluaXRpYWxWYWx1ZSk7XG5cdCAgICAgIH0sIGluaXRpYWxWYWx1ZU9yU2VsZWN0b3IpIDpcblx0ICAgICAgdGhpcy5tdWx0aWNhc3QobmV3IEJlaGF2aW9yU3ViamVjdChpbml0aWFsVmFsdWVPclNlbGVjdG9yKSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSBhbmQgc3RhcnRzIHdpdGggYW4gaW5pdGlhbFZhbHVlLlxuXHQgICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBwdWJsaXNoVmFsdWUgd2hpY2ggY3JlYXRlcyBhIHN1YnNjcmlwdGlvbiB3aGVuIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIGdvZXMgZnJvbSB6ZXJvIHRvIG9uZSwgdGhlbiBzaGFyZXMgdGhhdCBzdWJzY3JpcHRpb24gd2l0aCBhbGwgc3Vic2VxdWVudCBvYnNlcnZlcnMgdW50aWwgdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgcmV0dXJucyB0byB6ZXJvLCBhdCB3aGljaCBwb2ludCB0aGUgc3Vic2NyaXB0aW9uIGlzIGRpc3Bvc2VkLlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IGluaXRpYWxWYWx1ZSBJbml0aWFsIHZhbHVlIHJlY2VpdmVkIGJ5IG9ic2VydmVycyB1cG9uIHN1YnNjcmlwdGlvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5zaGFyZVZhbHVlID0gZnVuY3Rpb24gKGluaXRpYWxWYWx1ZSkge1xuXHQgICAgcmV0dXJuIHRoaXMucHVibGlzaFZhbHVlKGluaXRpYWxWYWx1ZSkucmVmQ291bnQoKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSBzZWxlY3RvciBvbiBhIGNvbm5lY3RhYmxlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIHJlcGxheWluZyBub3RpZmljYXRpb25zIHN1YmplY3QgdG8gYSBtYXhpbXVtIHRpbWUgbGVuZ3RoIGZvciB0aGUgcmVwbGF5IGJ1ZmZlci5cblx0ICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgTXVsdGljYXN0IHVzaW5nIGEgUmVwbGF5U3ViamVjdC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5yZXBsYXkobnVsbCwgMyk7XG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5yZXBsYXkobnVsbCwgMywgNTAwKTtcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShudWxsLCAzLCA1MDAsIHNjaGVkdWxlcik7XG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5yZXBsYXkoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgudGFrZSg2KS5yZXBlYXQoKTsgfSwgMywgNTAwLCBzY2hlZHVsZXIpO1xuXHQgICAqXG5cdCAgICogQHBhcmFtIHNlbGVjdG9yIFtPcHRpb25hbF0gU2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgcmVjZWl2ZSBhbGwgdGhlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIHNvdXJjZSBzdWJqZWN0IHRvIHRoZSBzcGVjaWZpZWQgcmVwbGF5IGJ1ZmZlciB0cmltbWluZyBwb2xpY3kuXG5cdCAgICogQHBhcmFtIGJ1ZmZlclNpemUgW09wdGlvbmFsXSBNYXhpbXVtIGVsZW1lbnQgY291bnQgb2YgdGhlIHJlcGxheSBidWZmZXIuXG5cdCAgICogQHBhcmFtIHdpbmRvd1NpemUgW09wdGlvbmFsXSBNYXhpbXVtIHRpbWUgbGVuZ3RoIG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuXHQgICAqIEBwYXJhbSBzY2hlZHVsZXIgW09wdGlvbmFsXSBTY2hlZHVsZXIgd2hlcmUgY29ubmVjdGVkIG9ic2VydmVycyB3aXRoaW4gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCBvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5yZXBsYXkgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikge1xuXHQgICAgcmV0dXJuIHNlbGVjdG9yICYmIGlzRnVuY3Rpb24oc2VsZWN0b3IpID9cblx0ICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKTsgfSwgc2VsZWN0b3IpIDpcblx0ICAgICAgdGhpcy5tdWx0aWNhc3QobmV3IFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSByZXBsYXlpbmcgbm90aWZpY2F0aW9ucyBzdWJqZWN0IHRvIGEgbWF4aW11bSB0aW1lIGxlbmd0aCBmb3IgdGhlIHJlcGxheSBidWZmZXIuXG5cdCAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIHJlcGxheSB3aGljaCBjcmVhdGVzIGEgc3Vic2NyaXB0aW9uIHdoZW4gdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgZ29lcyBmcm9tIHplcm8gdG8gb25lLCB0aGVuIHNoYXJlcyB0aGF0IHN1YnNjcmlwdGlvbiB3aXRoIGFsbCBzdWJzZXF1ZW50IG9ic2VydmVycyB1bnRpbCB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyByZXR1cm5zIHRvIHplcm8sIGF0IHdoaWNoIHBvaW50IHRoZSBzdWJzY3JpcHRpb24gaXMgZGlzcG9zZWQuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciByZXMgPSBzb3VyY2Uuc2hhcmVSZXBsYXkoMyk7XG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5zaGFyZVJlcGxheSgzLCA1MDApO1xuXHQgICAqIHZhciByZXMgPSBzb3VyY2Uuc2hhcmVSZXBsYXkoMywgNTAwLCBzY2hlZHVsZXIpO1xuXHQgICAqXG5cdFxuXHQgICAqIEBwYXJhbSBidWZmZXJTaXplIFtPcHRpb25hbF0gTWF4aW11bSBlbGVtZW50IGNvdW50IG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuXHQgICAqIEBwYXJhbSB3aW5kb3cgW09wdGlvbmFsXSBNYXhpbXVtIHRpbWUgbGVuZ3RoIG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuXHQgICAqIEBwYXJhbSBzY2hlZHVsZXIgW09wdGlvbmFsXSBTY2hlZHVsZXIgd2hlcmUgY29ubmVjdGVkIG9ic2VydmVycyB3aXRoaW4gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCBvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5zaGFyZVJlcGxheSA9IGZ1bmN0aW9uIChidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpIHtcblx0ICAgIHJldHVybiB0aGlzLnJlcGxheShudWxsLCBidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpLnJlZkNvdW50KCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFJlZkNvdW50T2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhSZWZDb3VudE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBSZWZDb3VudE9ic2VydmFibGUoc291cmNlKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9jb3VudCA9IDA7XG5cdCAgICAgIHRoaXMuX2Nvbm5lY3RhYmxlU3Vic2NyaXB0aW9uID0gbnVsbDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgUmVmQ291bnRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIHNob3VsZENvbm5lY3QgPSArK3RoaXMuX2NvdW50ID09PSAxLCBzdWJzY3JpcHRpb24gPSB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobyk7XG5cdCAgICAgIHNob3VsZENvbm5lY3QgJiYgKHRoaXMuX2Nvbm5lY3RhYmxlU3Vic2NyaXB0aW9uID0gdGhpcy5zb3VyY2UuY29ubmVjdCgpKTtcblx0ICAgICAgcmV0dXJuIG5ldyBSZWZDb3VudERpc3Bvc2FibGUodGhpcywgc3Vic2NyaXB0aW9uKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gUmVmQ291bnREaXNwb3NhYmxlKHAsIHMpIHtcblx0ICAgICAgdGhpcy5fcCA9IHA7XG5cdCAgICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICBSZWZDb3VudERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLl9zLmRpc3Bvc2UoKTtcblx0ICAgICAgICAtLXRoaXMuX3AuX2NvdW50ID09PSAwICYmIHRoaXMuX3AuX2Nvbm5lY3RhYmxlU3Vic2NyaXB0aW9uLmRpc3Bvc2UoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUmVmQ291bnRPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIENvbm5lY3RhYmxlT2JzZXJ2YWJsZSA9IFJ4LkNvbm5lY3RhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDb25uZWN0YWJsZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDb25uZWN0YWJsZU9ic2VydmFibGUoc291cmNlLCBzdWJqZWN0KSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9oYXNTdWJzY3JpcHRpb24gID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IG51bGw7XG5cdCAgICAgIHRoaXMuX3NvdXJjZU9ic2VydmFibGUgPSBzb3VyY2UuYXNPYnNlcnZhYmxlKCk7XG5cdCAgICAgIHRoaXMuX3N1YmplY3QgPSBzdWJqZWN0O1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBDb25uZWN0RGlzcG9zYWJsZShwYXJlbnQpIHtcblx0ICAgICAgdGhpcy5fcCA9IHBhcmVudDtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgQ29ubmVjdERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLl9wLl9oYXNTdWJzY3JpcHRpb24gPSBmYWxzZTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBDb25uZWN0YWJsZU9ic2VydmFibGUucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmICghdGhpcy5faGFzU3Vic2NyaXB0aW9uKSB7XG5cdCAgICAgICAgdGhpcy5faGFzU3Vic2NyaXB0aW9uID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb24gPSBuZXcgQmluYXJ5RGlzcG9zYWJsZShcblx0ICAgICAgICAgIHRoaXMuX3NvdXJjZU9ic2VydmFibGUuc3Vic2NyaWJlKHRoaXMuX3N1YmplY3QpLFxuXHQgICAgICAgICAgbmV3IENvbm5lY3REaXNwb3NhYmxlKHRoaXMpXG5cdCAgICAgICAgKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaXB0aW9uO1xuXHQgICAgfTtcblx0XG5cdCAgICBDb25uZWN0YWJsZU9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5fc3ViamVjdC5zdWJzY3JpYmUobyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVmQ291bnQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBuZXcgUmVmQ291bnRPYnNlcnZhYmxlKHRoaXMpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQ29ubmVjdGFibGVPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICB2YXIgVGltZXJPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGltZXJPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVGltZXJPYnNlcnZhYmxlKGR0LCBzKSB7XG5cdCAgICAgIHRoaXMuX2R0ID0gZHQ7XG5cdCAgICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUaW1lck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5fcy5zY2hlZHVsZUZ1dHVyZShvLCB0aGlzLl9kdCwgc2NoZWR1bGVNZXRob2QpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBzY2hlZHVsZU1ldGhvZChzLCBvKSB7XG5cdCAgICAgIG8ub25OZXh0KDApO1xuXHQgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIFRpbWVyT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIGZ1bmN0aW9uIF9vYnNlcnZhYmxlVGltZXIoZHVlVGltZSwgc2NoZWR1bGVyKSB7XG5cdCAgICByZXR1cm4gbmV3IFRpbWVyT2JzZXJ2YWJsZShkdWVUaW1lLCBzY2hlZHVsZXIpO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gb2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZChkdWVUaW1lLCBwZXJpb2QsIHNjaGVkdWxlcikge1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgZCA9IGR1ZVRpbWUsIHAgPSBub3JtYWxpemVUaW1lKHBlcmlvZCk7XG5cdCAgICAgIHJldHVybiBzY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUoMCwgZCwgZnVuY3Rpb24gKGNvdW50LCBzZWxmKSB7XG5cdCAgICAgICAgaWYgKHAgPiAwKSB7XG5cdCAgICAgICAgICB2YXIgbm93ID0gc2NoZWR1bGVyLm5vdygpO1xuXHQgICAgICAgICAgZCA9IG5ldyBEYXRlKGQuZ2V0VGltZSgpICsgcCk7XG5cdCAgICAgICAgICBkLmdldFRpbWUoKSA8PSBub3cgJiYgKGQgPSBuZXcgRGF0ZShub3cgKyBwKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIG9ic2VydmVyLm9uTmV4dChjb3VudCk7XG5cdCAgICAgICAgc2VsZihjb3VudCArIDEsIG5ldyBEYXRlKGQpKTtcblx0ICAgICAgfSk7XG5cdCAgICB9KTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIG9ic2VydmFibGVUaW1lclRpbWVTcGFuQW5kUGVyaW9kKGR1ZVRpbWUsIHBlcmlvZCwgc2NoZWR1bGVyKSB7XG5cdCAgICByZXR1cm4gZHVlVGltZSA9PT0gcGVyaW9kID9cblx0ICAgICAgbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZVBlcmlvZGljKDAsIHBlcmlvZCwgZnVuY3Rpb24gKGNvdW50KSB7XG5cdCAgICAgICAgICBvYnNlcnZlci5vbk5leHQoY291bnQpO1xuXHQgICAgICAgICAgcmV0dXJuIGNvdW50ICsgMTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSkgOlxuXHQgICAgICBvYnNlcnZhYmxlRGVmZXIoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJEYXRlQW5kUGVyaW9kKG5ldyBEYXRlKHNjaGVkdWxlci5ub3coKSArIGR1ZVRpbWUpLCBwZXJpb2QsIHNjaGVkdWxlcik7XG5cdCAgICAgIH0pO1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZWFjaCBwZXJpb2QuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqICAxIC0gcmVzID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDAwKTtcblx0ICAgKiAgMiAtIHJlcyA9IFJ4Lk9ic2VydmFibGUuaW50ZXJ2YWwoMTAwMCwgUnguU2NoZWR1bGVyLnRpbWVvdXQpO1xuXHQgICAqXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IHBlcmlvZCBQZXJpb2QgZm9yIHByb2R1Y2luZyB0aGUgdmFsdWVzIGluIHRoZSByZXN1bHRpbmcgc2VxdWVuY2UgKHNwZWNpZmllZCBhcyBhbiBpbnRlZ2VyIGRlbm90aW5nIG1pbGxpc2Vjb25kcykuXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIHRpbWVyIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBSeC5TY2hlZHVsZXIudGltZW91dCBpcyB1c2VkLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcHJvZHVjZXMgYSB2YWx1ZSBhZnRlciBlYWNoIHBlcmlvZC5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZWludGVydmFsID0gT2JzZXJ2YWJsZS5pbnRlcnZhbCA9IGZ1bmN0aW9uIChwZXJpb2QsIHNjaGVkdWxlcikge1xuXHQgICAgcmV0dXJuIG9ic2VydmFibGVUaW1lclRpbWVTcGFuQW5kUGVyaW9kKHBlcmlvZCwgcGVyaW9kLCBpc1NjaGVkdWxlcihzY2hlZHVsZXIpID8gc2NoZWR1bGVyIDogZGVmYXVsdFNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZHVlVGltZSBoYXMgZWxhcHNlZCBhbmQgdGhlbiBhZnRlciBlYWNoIHBlcmlvZC5cblx0ICAgKiBAcGFyYW0ge051bWJlcn0gZHVlVGltZSBBYnNvbHV0ZSAoc3BlY2lmaWVkIGFzIGEgRGF0ZSBvYmplY3QpIG9yIHJlbGF0aXZlIHRpbWUgKHNwZWNpZmllZCBhcyBhbiBpbnRlZ2VyIGRlbm90aW5nIG1pbGxpc2Vjb25kcykgYXQgd2hpY2ggdG8gcHJvZHVjZSB0aGUgZmlyc3QgdmFsdWUuXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gW3BlcmlvZE9yU2NoZWR1bGVyXSAgUGVyaW9kIHRvIHByb2R1Y2Ugc3Vic2VxdWVudCB2YWx1ZXMgKHNwZWNpZmllZCBhcyBhbiBpbnRlZ2VyIGRlbm90aW5nIG1pbGxpc2Vjb25kcyksIG9yIHRoZSBzY2hlZHVsZXIgdG8gcnVuIHRoZSB0aW1lciBvbi4gSWYgbm90IHNwZWNpZmllZCwgdGhlIHJlc3VsdGluZyB0aW1lciBpcyBub3QgcmVjdXJyaW5nLlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHRvIHJ1biB0aGUgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB0aW1lb3V0IHNjaGVkdWxlciBpcyB1c2VkLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcHJvZHVjZXMgYSB2YWx1ZSBhZnRlciBkdWUgdGltZSBoYXMgZWxhcHNlZCBhbmQgdGhlbiBlYWNoIHBlcmlvZC5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZVRpbWVyID0gT2JzZXJ2YWJsZS50aW1lciA9IGZ1bmN0aW9uIChkdWVUaW1lLCBwZXJpb2RPclNjaGVkdWxlciwgc2NoZWR1bGVyKSB7XG5cdCAgICB2YXIgcGVyaW9kO1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cdCAgICBpZiAocGVyaW9kT3JTY2hlZHVsZXIgIT0gbnVsbCAmJiB0eXBlb2YgcGVyaW9kT3JTY2hlZHVsZXIgPT09ICdudW1iZXInKSB7XG5cdCAgICAgIHBlcmlvZCA9IHBlcmlvZE9yU2NoZWR1bGVyO1xuXHQgICAgfSBlbHNlIGlmIChpc1NjaGVkdWxlcihwZXJpb2RPclNjaGVkdWxlcikpIHtcblx0ICAgICAgc2NoZWR1bGVyID0gcGVyaW9kT3JTY2hlZHVsZXI7XG5cdCAgICB9XG5cdCAgICBpZiAoKGR1ZVRpbWUgaW5zdGFuY2VvZiBEYXRlIHx8IHR5cGVvZiBkdWVUaW1lID09PSAnbnVtYmVyJykgJiYgcGVyaW9kID09PSB1bmRlZmluZWQpIHtcblx0ICAgICAgcmV0dXJuIF9vYnNlcnZhYmxlVGltZXIoZHVlVGltZSwgc2NoZWR1bGVyKTtcblx0ICAgIH1cblx0ICAgIGlmIChkdWVUaW1lIGluc3RhbmNlb2YgRGF0ZSAmJiBwZXJpb2QgIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZChkdWVUaW1lLmdldFRpbWUoKSwgcGVyaW9kT3JTY2hlZHVsZXIsIHNjaGVkdWxlcik7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyVGltZVNwYW5BbmRQZXJpb2QoZHVlVGltZSwgcGVyaW9kLCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIG9ic2VydmFibGVEZWxheVJlbGF0aXZlKHNvdXJjZSwgZHVlVGltZSwgc2NoZWR1bGVyKSB7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGFjdGl2ZSA9IGZhbHNlLFxuXHQgICAgICAgIGNhbmNlbGFibGUgPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLFxuXHQgICAgICAgIGV4Y2VwdGlvbiA9IG51bGwsXG5cdCAgICAgICAgcSA9IFtdLFxuXHQgICAgICAgIHJ1bm5pbmcgPSBmYWxzZSxcblx0ICAgICAgICBzdWJzY3JpcHRpb247XG5cdCAgICAgIHN1YnNjcmlwdGlvbiA9IHNvdXJjZS5tYXRlcmlhbGl6ZSgpLnRpbWVzdGFtcChzY2hlZHVsZXIpLnN1YnNjcmliZShmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG5cdCAgICAgICAgdmFyIGQsIHNob3VsZFJ1bjtcblx0ICAgICAgICBpZiAobm90aWZpY2F0aW9uLnZhbHVlLmtpbmQgPT09ICdFJykge1xuXHQgICAgICAgICAgcSA9IFtdO1xuXHQgICAgICAgICAgcS5wdXNoKG5vdGlmaWNhdGlvbik7XG5cdCAgICAgICAgICBleGNlcHRpb24gPSBub3RpZmljYXRpb24udmFsdWUuZXJyb3I7XG5cdCAgICAgICAgICBzaG91bGRSdW4gPSAhcnVubmluZztcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgcS5wdXNoKHsgdmFsdWU6IG5vdGlmaWNhdGlvbi52YWx1ZSwgdGltZXN0YW1wOiBub3RpZmljYXRpb24udGltZXN0YW1wICsgZHVlVGltZSB9KTtcblx0ICAgICAgICAgIHNob3VsZFJ1biA9ICFhY3RpdmU7XG5cdCAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAoc2hvdWxkUnVuKSB7XG5cdCAgICAgICAgICBpZiAoZXhjZXB0aW9uICE9PSBudWxsKSB7XG5cdCAgICAgICAgICAgIG8ub25FcnJvcihleGNlcHRpb24pO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgICAgICBjYW5jZWxhYmxlLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgICAgICAgIGQuc2V0RGlzcG9zYWJsZShzY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUobnVsbCwgZHVlVGltZSwgZnVuY3Rpb24gKF8sIHNlbGYpIHtcblx0ICAgICAgICAgICAgICB2YXIgZSwgcmVjdXJzZUR1ZVRpbWUsIHJlc3VsdCwgc2hvdWxkUmVjdXJzZTtcblx0ICAgICAgICAgICAgICBpZiAoZXhjZXB0aW9uICE9PSBudWxsKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuXHQgICAgICAgICAgICAgIGRvIHtcblx0ICAgICAgICAgICAgICAgIHJlc3VsdCA9IG51bGw7XG5cdCAgICAgICAgICAgICAgICBpZiAocS5sZW5ndGggPiAwICYmIHFbMF0udGltZXN0YW1wIC0gc2NoZWR1bGVyLm5vdygpIDw9IDApIHtcblx0ICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcS5zaGlmdCgpLnZhbHVlO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgICAgICByZXN1bHQuYWNjZXB0KG8pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH0gd2hpbGUgKHJlc3VsdCAhPT0gbnVsbCk7XG5cdCAgICAgICAgICAgICAgc2hvdWxkUmVjdXJzZSA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIHJlY3Vyc2VEdWVUaW1lID0gMDtcblx0ICAgICAgICAgICAgICBpZiAocS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgICAgICBzaG91bGRSZWN1cnNlID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgIHJlY3Vyc2VEdWVUaW1lID0gTWF0aC5tYXgoMCwgcVswXS50aW1lc3RhbXAgLSBzY2hlZHVsZXIubm93KCkpO1xuXHQgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBhY3RpdmUgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgZSA9IGV4Y2VwdGlvbjtcblx0ICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgaWYgKGUgIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgICAgIG8ub25FcnJvcihlKTtcblx0ICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZFJlY3Vyc2UpIHtcblx0ICAgICAgICAgICAgICAgIHNlbGYobnVsbCwgcmVjdXJzZUR1ZVRpbWUpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSkpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUpO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIG9ic2VydmFibGVEZWxheUFic29sdXRlKHNvdXJjZSwgZHVlVGltZSwgc2NoZWR1bGVyKSB7XG5cdCAgICByZXR1cm4gb2JzZXJ2YWJsZURlZmVyKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIG9ic2VydmFibGVEZWxheVJlbGF0aXZlKHNvdXJjZSwgZHVlVGltZSAtIHNjaGVkdWxlci5ub3coKSwgc2NoZWR1bGVyKTtcblx0ICAgIH0pO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gZGVsYXlXaXRoU2VsZWN0b3Ioc291cmNlLCBzdWJzY3JpcHRpb25EZWxheSwgZGVsYXlEdXJhdGlvblNlbGVjdG9yKSB7XG5cdCAgICB2YXIgc3ViRGVsYXksIHNlbGVjdG9yO1xuXHQgICAgaWYgKGlzRnVuY3Rpb24oc3Vic2NyaXB0aW9uRGVsYXkpKSB7XG5cdCAgICAgIHNlbGVjdG9yID0gc3Vic2NyaXB0aW9uRGVsYXk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBzdWJEZWxheSA9IHN1YnNjcmlwdGlvbkRlbGF5O1xuXHQgICAgICBzZWxlY3RvciA9IGRlbGF5RHVyYXRpb25TZWxlY3Rvcjtcblx0ICAgIH1cblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgZGVsYXlzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKSwgYXRFbmQgPSBmYWxzZSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIHN0YXJ0KCkge1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoXG5cdCAgICAgICAgICBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgICAgICB2YXIgZGVsYXkgPSB0cnlDYXRjaChzZWxlY3RvcikoeCk7XG5cdCAgICAgICAgICAgIGlmIChkZWxheSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihkZWxheS5lKTsgfVxuXHQgICAgICAgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgICAgICBkZWxheXMuYWRkKGQpO1xuXHQgICAgICAgICAgICBkLnNldERpc3Bvc2FibGUoZGVsYXkuc3Vic2NyaWJlKFxuXHQgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIG8ub25OZXh0KHgpO1xuXHQgICAgICAgICAgICAgICAgZGVsYXlzLnJlbW92ZShkKTtcblx0ICAgICAgICAgICAgICAgIGRvbmUoKTtcblx0ICAgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcblx0ICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBvLm9uTmV4dCh4KTtcblx0ICAgICAgICAgICAgICAgIGRlbGF5cy5yZW1vdmUoZCk7XG5cdCAgICAgICAgICAgICAgICBkb25lKCk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICApKTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIGF0RW5kID0gdHJ1ZTtcblx0ICAgICAgICAgICAgc3Vic2NyaXB0aW9uLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgICAgZG9uZSgpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICkpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBmdW5jdGlvbiBkb25lICgpIHtcblx0ICAgICAgICBhdEVuZCAmJiBkZWxheXMubGVuZ3RoID09PSAwICYmIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgaWYgKCFzdWJEZWxheSkge1xuXHQgICAgICAgIHN0YXJ0KCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoc3ViRGVsYXkuc3Vic2NyaWJlKHN0YXJ0LCBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIHN0YXJ0KSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGRlbGF5cyk7XG5cdCAgICB9LCB0aGlzKTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqICBUaW1lIHNoaWZ0cyB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSBkdWVUaW1lLlxuXHQgICAqICBUaGUgcmVsYXRpdmUgdGltZSBpbnRlcnZhbHMgYmV0d2VlbiB0aGUgdmFsdWVzIGFyZSBwcmVzZXJ2ZWQuXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge051bWJlcn0gZHVlVGltZSBBYnNvbHV0ZSAoc3BlY2lmaWVkIGFzIGEgRGF0ZSBvYmplY3QpIG9yIHJlbGF0aXZlIHRpbWUgKHNwZWNpZmllZCBhcyBhbiBpbnRlZ2VyIGRlbm90aW5nIG1pbGxpc2Vjb25kcykgYnkgd2hpY2ggdG8gc2hpZnQgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIGRlbGF5IHRpbWVycyBvbi4gSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWVvdXQgc2NoZWR1bGVyIGlzIHVzZWQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRpbWUtc2hpZnRlZCBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uZGVsYXkgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgZmlyc3RBcmcgPSBhcmd1bWVudHNbMF07XG5cdCAgICBpZiAodHlwZW9mIGZpcnN0QXJnID09PSAnbnVtYmVyJyB8fCBmaXJzdEFyZyBpbnN0YW5jZW9mIERhdGUpIHtcblx0ICAgICAgdmFyIGR1ZVRpbWUgPSBmaXJzdEFyZywgc2NoZWR1bGVyID0gYXJndW1lbnRzWzFdO1xuXHQgICAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcblx0ICAgICAgcmV0dXJuIGR1ZVRpbWUgaW5zdGFuY2VvZiBEYXRlID9cblx0ICAgICAgICBvYnNlcnZhYmxlRGVsYXlBYnNvbHV0ZSh0aGlzLCBkdWVUaW1lLCBzY2hlZHVsZXIpIDpcblx0ICAgICAgICBvYnNlcnZhYmxlRGVsYXlSZWxhdGl2ZSh0aGlzLCBkdWVUaW1lLCBzY2hlZHVsZXIpO1xuXHQgICAgfSBlbHNlIGlmIChPYnNlcnZhYmxlLmlzT2JzZXJ2YWJsZShmaXJzdEFyZykgfHwgaXNGdW5jdGlvbihmaXJzdEFyZykpIHtcblx0ICAgICAgcmV0dXJuIGRlbGF5V2l0aFNlbGVjdG9yKHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0pO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50cycpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIHZhciBEZWJvdW5jZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRGVib3VuY2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRGVib3VuY2VPYnNlcnZhYmxlKHNvdXJjZSwgZHQsIHMpIHtcblx0ICAgICAgaXNTY2hlZHVsZXIocykgfHwgKHMgPSBkZWZhdWx0U2NoZWR1bGVyKTtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2R0ID0gZHQ7XG5cdCAgICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBEZWJvdW5jZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgY2FuY2VsYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShcblx0ICAgICAgICB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IERlYm91bmNlT2JzZXJ2ZXIobywgdGhpcy5zb3VyY2UsIHRoaXMuX2R0LCB0aGlzLl9zLCBjYW5jZWxhYmxlKSksXG5cdCAgICAgICAgY2FuY2VsYWJsZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBEZWJvdW5jZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgRGVib3VuY2VPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhEZWJvdW5jZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRGVib3VuY2VPYnNlcnZlcihvYnNlcnZlciwgc291cmNlLCBkdWVUaW1lLCBzY2hlZHVsZXIsIGNhbmNlbGFibGUpIHtcblx0ICAgICAgdGhpcy5fbyA9IG9ic2VydmVyO1xuXHQgICAgICB0aGlzLl9zID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9kID0gZHVlVGltZTtcblx0ICAgICAgdGhpcy5fc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICB0aGlzLl9jID0gY2FuY2VsYWJsZTtcblx0ICAgICAgdGhpcy5fdiA9IG51bGw7XG5cdCAgICAgIHRoaXMuX2h2ID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuX2lkID0gMDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRGVib3VuY2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMuX2h2ID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5fdiA9IHg7XG5cdCAgICAgIHZhciBjdXJyZW50SWQgPSArK3RoaXMuX2lkLCBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHRoaXMuX2Muc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgZC5zZXREaXNwb3NhYmxlKHRoaXMuX3NjaGVkdWxlci5zY2hlZHVsZUZ1dHVyZSh0aGlzLCB0aGlzLl9kLCBmdW5jdGlvbiAoXywgc2VsZikge1xuXHQgICAgICAgIHNlbGYuX2h2ICYmIHNlbGYuX2lkID09PSBjdXJyZW50SWQgJiYgc2VsZi5fby5vbk5leHQoeCk7XG5cdCAgICAgICAgc2VsZi5faHYgPSBmYWxzZTtcblx0ICAgICAgfSkpO1xuXHQgICAgfTtcblx0XG5cdCAgICBEZWJvdW5jZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX2MuZGlzcG9zZSgpO1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICAgIHRoaXMuX2h2ID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuX2lkKys7XG5cdCAgICB9O1xuXHRcblx0ICAgIERlYm91bmNlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fYy5kaXNwb3NlKCk7XG5cdCAgICAgIHRoaXMuX2h2ICYmIHRoaXMuX28ub25OZXh0KHRoaXMuX3YpO1xuXHQgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIHRoaXMuX2h2ID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuX2lkKys7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBEZWJvdW5jZU9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICBmdW5jdGlvbiBkZWJvdW5jZVdpdGhTZWxlY3Rvcihzb3VyY2UsIGR1cmF0aW9uU2VsZWN0b3IpIHtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgdmFsdWUsIGhhc1ZhbHVlID0gZmFsc2UsIGNhbmNlbGFibGUgPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLCBpZCA9IDA7XG5cdCAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBzb3VyY2Uuc3Vic2NyaWJlKFxuXHQgICAgICAgIGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgICB2YXIgdGhyb3R0bGUgPSB0cnlDYXRjaChkdXJhdGlvblNlbGVjdG9yKSh4KTtcblx0ICAgICAgICAgIGlmICh0aHJvdHRsZSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcih0aHJvdHRsZS5lKTsgfVxuXHRcblx0ICAgICAgICAgIGlzUHJvbWlzZSh0aHJvdHRsZSkgJiYgKHRocm90dGxlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHRocm90dGxlKSk7XG5cdFxuXHQgICAgICAgICAgaGFzVmFsdWUgPSB0cnVlO1xuXHQgICAgICAgICAgdmFsdWUgPSB4O1xuXHQgICAgICAgICAgaWQrKztcblx0ICAgICAgICAgIHZhciBjdXJyZW50aWQgPSBpZCwgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgICAgY2FuY2VsYWJsZS5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICAgICAgZC5zZXREaXNwb3NhYmxlKHRocm90dGxlLnN1YnNjcmliZShcblx0ICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgIGhhc1ZhbHVlICYmIGlkID09PSBjdXJyZW50aWQgJiYgby5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgZC5kaXNwb3NlKCk7XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcblx0ICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgIGhhc1ZhbHVlICYmIGlkID09PSBjdXJyZW50aWQgJiYgby5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgZC5kaXNwb3NlKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICkpO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICAgIGNhbmNlbGFibGUuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgby5vbkVycm9yKGUpO1xuXHQgICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcblx0ICAgICAgICAgIGlkKys7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBjYW5jZWxhYmxlLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgIGhhc1ZhbHVlICYmIG8ub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG5cdCAgICAgICAgICBpZCsrO1xuXHQgICAgICAgIH1cblx0ICAgICAgKTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSk7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH1cblx0XG5cdCAgb2JzZXJ2YWJsZVByb3RvLmRlYm91bmNlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKGlzRnVuY3Rpb24gKGFyZ3VtZW50c1swXSkpIHtcblx0ICAgICAgcmV0dXJuIGRlYm91bmNlV2l0aFNlbGVjdG9yKHRoaXMsIGFyZ3VtZW50c1swXSk7XG5cdCAgICB9IGVsc2UgaWYgKHR5cGVvZiBhcmd1bWVudHNbMF0gPT09ICdudW1iZXInKSB7XG5cdCAgICAgIHJldHVybiBuZXcgRGVib3VuY2VPYnNlcnZhYmxlKHRoaXMsIGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhcmd1bWVudHMnKTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICB2YXIgVGltZXN0YW1wT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUaW1lc3RhbXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVGltZXN0YW1wT2JzZXJ2YWJsZShzb3VyY2UsIHMpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUaW1lc3RhbXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgVGltZXN0YW1wT2JzZXJ2ZXIobywgdGhpcy5fcykpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gVGltZXN0YW1wT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBUaW1lc3RhbXBPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUaW1lc3RhbXBPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRpbWVzdGFtcE9ic2VydmVyKG8sIHMpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUaW1lc3RhbXBPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMuX28ub25OZXh0KHsgdmFsdWU6IHgsIHRpbWVzdGFtcDogdGhpcy5fcy5ub3coKSB9KTtcblx0ICAgIH07XG5cdFxuXHQgICAgVGltZXN0YW1wT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBUaW1lc3RhbXBPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBUaW1lc3RhbXBPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJlY29yZHMgdGhlIHRpbWVzdGFtcCBmb3IgZWFjaCB2YWx1ZSBpbiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAgMSAtIHJlcyA9IHNvdXJjZS50aW1lc3RhbXAoKTsgLy8gcHJvZHVjZXMgeyB2YWx1ZTogeCwgdGltZXN0YW1wOiB0cyB9XG5cdCAgICogIDIgLSByZXMgPSBzb3VyY2UudGltZXN0YW1wKFJ4LlNjaGVkdWxlci5kZWZhdWx0KTtcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHVzZWQgdG8gY29tcHV0ZSB0aW1lc3RhbXBzLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgZGVmYXVsdCBzY2hlZHVsZXIgaXMgdXNlZC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIHRpbWVzdGFtcCBpbmZvcm1hdGlvbiBvbiB2YWx1ZXMuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRpbWVzdGFtcCA9IGZ1bmN0aW9uIChzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBUaW1lc3RhbXBPYnNlcnZhYmxlKHRoaXMsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gc2FtcGxlT2JzZXJ2YWJsZShzb3VyY2UsIHNhbXBsZXIpIHtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgYXRFbmQgPSBmYWxzZSwgdmFsdWUsIGhhc1ZhbHVlID0gZmFsc2U7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBzYW1wbGVTdWJzY3JpYmUoKSB7XG5cdCAgICAgICAgaWYgKGhhc1ZhbHVlKSB7XG5cdCAgICAgICAgICBoYXNWYWx1ZSA9IGZhbHNlO1xuXHQgICAgICAgICAgby5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBhdEVuZCAmJiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHZhciBzb3VyY2VTdWJzY3JpcHRpb24gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgc291cmNlU3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShcblx0ICAgICAgICBmdW5jdGlvbiAobmV3VmFsdWUpIHtcblx0ICAgICAgICAgIGhhc1ZhbHVlID0gdHJ1ZTtcblx0ICAgICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG5cdCAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgYXRFbmQgPSB0cnVlO1xuXHQgICAgICAgICAgc291cmNlU3Vic2NyaXB0aW9uLmRpc3Bvc2UoKTtcblx0ICAgICAgICB9XG5cdCAgICAgICkpO1xuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuXHQgICAgICAgIHNvdXJjZVN1YnNjcmlwdGlvbixcblx0ICAgICAgICBzYW1wbGVyLnN1YnNjcmliZShzYW1wbGVTdWJzY3JpYmUsIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSwgc2FtcGxlU3Vic2NyaWJlKVxuXHQgICAgICApO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqICBTYW1wbGVzIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGF0IGVhY2ggaW50ZXJ2YWwuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqICAxIC0gcmVzID0gc291cmNlLnNhbXBsZShzYW1wbGVPYnNlcnZhYmxlKTsgLy8gU2FtcGxlciB0aWNrIHNlcXVlbmNlXG5cdCAgICogIDIgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKDUwMDApOyAvLyA1IHNlY29uZHNcblx0ICAgKiAgMiAtIHJlcyA9IHNvdXJjZS5zYW1wbGUoNTAwMCwgUnguU2NoZWR1bGVyLnRpbWVvdXQpOyAvLyA1IHNlY29uZHNcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IGludGVydmFsT3JTYW1wbGVyIEludGVydmFsIGF0IHdoaWNoIHRvIHNhbXBsZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSBvciBTYW1wbGVyIE9ic2VydmFibGUuXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdICBTY2hlZHVsZXIgdG8gcnVuIHRoZSBzYW1wbGluZyB0aW1lciBvbi4gSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWVvdXQgc2NoZWR1bGVyIGlzIHVzZWQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFNhbXBsZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2FtcGxlID0gb2JzZXJ2YWJsZVByb3RvLnRocm90dGxlTGF0ZXN0ID0gZnVuY3Rpb24gKGludGVydmFsT3JTYW1wbGVyLCBzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIHR5cGVvZiBpbnRlcnZhbE9yU2FtcGxlciA9PT0gJ251bWJlcicgP1xuXHQgICAgICBzYW1wbGVPYnNlcnZhYmxlKHRoaXMsIG9ic2VydmFibGVpbnRlcnZhbChpbnRlcnZhbE9yU2FtcGxlciwgc2NoZWR1bGVyKSkgOlxuXHQgICAgICBzYW1wbGVPYnNlcnZhYmxlKHRoaXMsIGludGVydmFsT3JTYW1wbGVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgVGltZW91dEVycm9yID0gUnguVGltZW91dEVycm9yID0gZnVuY3Rpb24obWVzc2FnZSkge1xuXHQgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVGltZW91dCBoYXMgb2NjdXJyZWQnO1xuXHQgICAgdGhpcy5uYW1lID0gJ1RpbWVvdXRFcnJvcic7XG5cdCAgICBFcnJvci5jYWxsKHRoaXMpO1xuXHQgIH07XG5cdCAgVGltZW91dEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblx0XG5cdCAgZnVuY3Rpb24gdGltZW91dFdpdGhTZWxlY3Rvcihzb3VyY2UsIGZpcnN0VGltZW91dCwgdGltZW91dER1cmF0aW9uU2VsZWN0b3IsIG90aGVyKSB7XG5cdCAgICBpZiAoaXNGdW5jdGlvbihmaXJzdFRpbWVvdXQpKSB7XG5cdCAgICAgIG90aGVyID0gdGltZW91dER1cmF0aW9uU2VsZWN0b3I7XG5cdCAgICAgIHRpbWVvdXREdXJhdGlvblNlbGVjdG9yID0gZmlyc3RUaW1lb3V0O1xuXHQgICAgICBmaXJzdFRpbWVvdXQgPSBvYnNlcnZhYmxlTmV2ZXIoKTtcblx0ICAgIH1cblx0ICAgIG90aGVyIHx8IChvdGhlciA9IG9ic2VydmFibGVUaHJvdyhuZXcgVGltZW91dEVycm9yKCkpKTtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSxcblx0ICAgICAgICB0aW1lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG5cdCAgICAgICAgb3JpZ2luYWwgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0XG5cdCAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG9yaWdpbmFsKTtcblx0XG5cdCAgICAgIHZhciBpZCA9IDAsIHN3aXRjaGVkID0gZmFsc2U7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBzZXRUaW1lcih0aW1lb3V0KSB7XG5cdCAgICAgICAgdmFyIG15SWQgPSBpZCwgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHRcblx0ICAgICAgICBmdW5jdGlvbiB0aW1lcldpbnMoKSB7XG5cdCAgICAgICAgICBzd2l0Y2hlZCA9IChteUlkID09PSBpZCk7XG5cdCAgICAgICAgICByZXR1cm4gc3dpdGNoZWQ7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aW1lci5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICAgIGQuc2V0RGlzcG9zYWJsZSh0aW1lb3V0LnN1YnNjcmliZShmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICB0aW1lcldpbnMoKSAmJiBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShvdGhlci5zdWJzY3JpYmUobykpO1xuXHQgICAgICAgICAgZC5kaXNwb3NlKCk7XG5cdCAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICAgIHRpbWVyV2lucygpICYmIG8ub25FcnJvcihlKTtcblx0ICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICB0aW1lcldpbnMoKSAmJiBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShvdGhlci5zdWJzY3JpYmUobykpO1xuXHQgICAgICAgIH0pKTtcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIHNldFRpbWVyKGZpcnN0VGltZW91dCk7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBvV2lucygpIHtcblx0ICAgICAgICB2YXIgcmVzID0gIXN3aXRjaGVkO1xuXHQgICAgICAgIGlmIChyZXMpIHsgaWQrKzsgfVxuXHQgICAgICAgIHJldHVybiByZXM7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIG9yaWdpbmFsLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgIGlmIChvV2lucygpKSB7XG5cdCAgICAgICAgICBvLm9uTmV4dCh4KTtcblx0ICAgICAgICAgIHZhciB0aW1lb3V0ID0gdHJ5Q2F0Y2godGltZW91dER1cmF0aW9uU2VsZWN0b3IpKHgpO1xuXHQgICAgICAgICAgaWYgKHRpbWVvdXQgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IodGltZW91dC5lKTsgfVxuXHQgICAgICAgICAgc2V0VGltZXIoaXNQcm9taXNlKHRpbWVvdXQpID8gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHRpbWVvdXQpIDogdGltZW91dCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIG9XaW5zKCkgJiYgby5vbkVycm9yKGUpO1xuXHQgICAgICB9LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgb1dpbnMoKSAmJiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH0pKTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgdGltZXIpO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHRpbWVvdXQoc291cmNlLCBkdWVUaW1lLCBvdGhlciwgc2NoZWR1bGVyKSB7XG5cdCAgICBpZiAoaXNTY2hlZHVsZXIob3RoZXIpKSB7XG5cdCAgICAgIHNjaGVkdWxlciA9IG90aGVyO1xuXHQgICAgICBvdGhlciA9IG9ic2VydmFibGVUaHJvdyhuZXcgVGltZW91dEVycm9yKCkpO1xuXHQgICAgfVxuXHQgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgRXJyb3IpIHsgb3RoZXIgPSBvYnNlcnZhYmxlVGhyb3cob3RoZXIpOyB9XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcblx0XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGlkID0gMCxcblx0ICAgICAgICBvcmlnaW5hbCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLFxuXHQgICAgICAgIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG5cdCAgICAgICAgc3dpdGNoZWQgPSBmYWxzZSxcblx0ICAgICAgICB0aW1lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cdFxuXHQgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShvcmlnaW5hbCk7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBjcmVhdGVUaW1lcigpIHtcblx0ICAgICAgICB2YXIgbXlJZCA9IGlkO1xuXHQgICAgICAgIHRpbWVyLnNldERpc3Bvc2FibGUoc2NoZWR1bGVyLnNjaGVkdWxlRnV0dXJlKG51bGwsIGR1ZVRpbWUsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIHN3aXRjaGVkID0gaWQgPT09IG15SWQ7XG5cdCAgICAgICAgICBpZiAoc3dpdGNoZWQpIHtcblx0ICAgICAgICAgICAgaXNQcm9taXNlKG90aGVyKSAmJiAob3RoZXIgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpKTtcblx0ICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG8pKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGNyZWF0ZVRpbWVyKCk7XG5cdFxuXHQgICAgICBvcmlnaW5hbC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICBpZiAoIXN3aXRjaGVkKSB7XG5cdCAgICAgICAgICBpZCsrO1xuXHQgICAgICAgICAgby5vbk5leHQoeCk7XG5cdCAgICAgICAgICBjcmVhdGVUaW1lcigpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBpZiAoIXN3aXRjaGVkKSB7XG5cdCAgICAgICAgICBpZCsrO1xuXHQgICAgICAgICAgby5vbkVycm9yKGUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICghc3dpdGNoZWQpIHtcblx0ICAgICAgICAgIGlkKys7XG5cdCAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KSk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIHRpbWVyKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfVxuXHRcblx0ICBvYnNlcnZhYmxlUHJvdG8udGltZW91dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBmaXJzdEFyZyA9IGFyZ3VtZW50c1swXTtcblx0ICAgIGlmIChmaXJzdEFyZyBpbnN0YW5jZW9mIERhdGUgfHwgdHlwZW9mIGZpcnN0QXJnID09PSAnbnVtYmVyJykge1xuXHQgICAgICByZXR1cm4gdGltZW91dCh0aGlzLCBmaXJzdEFyZywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pO1xuXHQgICAgfSBlbHNlIGlmIChPYnNlcnZhYmxlLmlzT2JzZXJ2YWJsZShmaXJzdEFyZykgfHwgaXNGdW5jdGlvbihmaXJzdEFyZykpIHtcblx0ICAgICAgcmV0dXJuIHRpbWVvdXRXaXRoU2VsZWN0b3IodGhpcywgZmlyc3RBcmcsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhcmd1bWVudHMnKTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBvbmx5IHRoZSBmaXJzdCBpdGVtIGVtaXR0ZWQgYnkgdGhlIHNvdXJjZSBPYnNlcnZhYmxlIGR1cmluZyBzZXF1ZW50aWFsIHRpbWUgd2luZG93cyBvZiBhIHNwZWNpZmllZCBkdXJhdGlvbi5cblx0ICAgKiBAcGFyYW0ge051bWJlcn0gd2luZG93RHVyYXRpb24gdGltZSB0byB3YWl0IGJlZm9yZSBlbWl0dGluZyBhbm90aGVyIGl0ZW0gYWZ0ZXIgZW1pdHRpbmcgdGhlIGxhc3QgaXRlbVxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSB0aGUgU2NoZWR1bGVyIHRvIHVzZSBpbnRlcm5hbGx5IHRvIG1hbmFnZSB0aGUgdGltZXJzIHRoYXQgaGFuZGxlIHRpbWVvdXQgZm9yIGVhY2ggaXRlbS4gSWYgbm90IHByb3ZpZGVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIudGltZW91dC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gT2JzZXJ2YWJsZSB0aGF0IHBlcmZvcm1zIHRoZSB0aHJvdHRsZSBvcGVyYXRpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRocm90dGxlID0gZnVuY3Rpb24gKHdpbmRvd0R1cmF0aW9uLCBzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHQgICAgdmFyIGR1cmF0aW9uID0gK3dpbmRvd0R1cmF0aW9uIHx8IDA7XG5cdCAgICBpZiAoZHVyYXRpb24gPD0gMCkgeyB0aHJvdyBuZXcgUmFuZ2VFcnJvcignd2luZG93RHVyYXRpb24gY2Fubm90IGJlIGxlc3Mgb3IgZXF1YWwgemVyby4nKTsgfVxuXHQgICAgdmFyIHNvdXJjZSA9IHRoaXM7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGxhc3RPbk5leHQgPSAwO1xuXHQgICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShcblx0ICAgICAgICBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgICAgdmFyIG5vdyA9IHNjaGVkdWxlci5ub3coKTtcblx0ICAgICAgICAgIGlmIChsYXN0T25OZXh0ID09PSAwIHx8IG5vdyAtIGxhc3RPbk5leHQgPj0gZHVyYXRpb24pIHtcblx0ICAgICAgICAgICAgbGFzdE9uTmV4dCA9IG5vdztcblx0ICAgICAgICAgICAgby5vbk5leHQoeCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSxmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIGZ1bmN0aW9uICgpIHsgby5vbkNvbXBsZXRlZCgpOyB9XG5cdCAgICAgICk7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBQYXVzYWJsZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoUGF1c2FibGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gUGF1c2FibGVPYnNlcnZhYmxlKHNvdXJjZSwgcGF1c2VyKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgU3ViamVjdCgpO1xuXHRcblx0ICAgICAgaWYgKHBhdXNlciAmJiBwYXVzZXIuc3Vic2NyaWJlKSB7XG5cdCAgICAgICAgdGhpcy5wYXVzZXIgPSB0aGlzLmNvbnRyb2xsZXIubWVyZ2UocGF1c2VyKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLnBhdXNlciA9IHRoaXMuY29udHJvbGxlcjtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgUGF1c2FibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGNvbm4gPSB0aGlzLnNvdXJjZS5wdWJsaXNoKCksXG5cdCAgICAgICAgc3Vic2NyaXB0aW9uID0gY29ubi5zdWJzY3JpYmUobyksXG5cdCAgICAgICAgY29ubmVjdGlvbiA9IGRpc3Bvc2FibGVFbXB0eTtcblx0XG5cdCAgICAgIHZhciBwYXVzYWJsZSA9IHRoaXMucGF1c2VyLmRpc3RpbmN0VW50aWxDaGFuZ2VkKCkuc3Vic2NyaWJlKGZ1bmN0aW9uIChiKSB7XG5cdCAgICAgICAgaWYgKGIpIHtcblx0ICAgICAgICAgIGNvbm5lY3Rpb24gPSBjb25uLmNvbm5lY3QoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgY29ubmVjdGlvbi5kaXNwb3NlKCk7XG5cdCAgICAgICAgICBjb25uZWN0aW9uID0gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtzdWJzY3JpcHRpb24sIGNvbm5lY3Rpb24sIHBhdXNhYmxlXSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFBhdXNhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuY29udHJvbGxlci5vbk5leHQoZmFsc2UpO1xuXHQgICAgfTtcblx0XG5cdCAgICBQYXVzYWJsZU9ic2VydmFibGUucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dCh0cnVlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFBhdXNhYmxlT2JzZXJ2YWJsZTtcblx0XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIFBhdXNlcyB0aGUgdW5kZXJseWluZyBvYnNlcnZhYmxlIHNlcXVlbmNlIGJhc2VkIHVwb24gdGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggeWllbGRzIHRydWUvZmFsc2UuXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgcGF1c2VyID0gbmV3IFJ4LlN1YmplY3QoKTtcblx0ICAgKiB2YXIgc291cmNlID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDApLnBhdXNhYmxlKHBhdXNlcik7XG5cdCAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBwYXVzZXIgVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdXNlZCB0byBwYXVzZSB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggaXMgcGF1c2VkIGJhc2VkIHVwb24gdGhlIHBhdXNlci5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucGF1c2FibGUgPSBmdW5jdGlvbiAocGF1c2VyKSB7XG5cdCAgICByZXR1cm4gbmV3IFBhdXNhYmxlT2JzZXJ2YWJsZSh0aGlzLCBwYXVzZXIpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGNvbWJpbmVMYXRlc3RTb3VyY2Uoc291cmNlLCBzdWJqZWN0LCByZXN1bHRTZWxlY3Rvcikge1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBoYXNWYWx1ZSA9IFtmYWxzZSwgZmFsc2VdLFxuXHQgICAgICAgIGhhc1ZhbHVlQWxsID0gZmFsc2UsXG5cdCAgICAgICAgaXNEb25lID0gZmFsc2UsXG5cdCAgICAgICAgdmFsdWVzID0gbmV3IEFycmF5KDIpLFxuXHQgICAgICAgIGVycjtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIG5leHQoeCwgaSkge1xuXHQgICAgICAgIHZhbHVlc1tpXSA9IHg7XG5cdCAgICAgICAgaGFzVmFsdWVbaV0gPSB0cnVlO1xuXHQgICAgICAgIGlmIChoYXNWYWx1ZUFsbCB8fCAoaGFzVmFsdWVBbGwgPSBoYXNWYWx1ZS5ldmVyeShpZGVudGl0eSkpKSB7XG5cdCAgICAgICAgICBpZiAoZXJyKSB7IHJldHVybiBvLm9uRXJyb3IoZXJyKTsgfVxuXHQgICAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHJlc3VsdFNlbGVjdG9yKS5hcHBseShudWxsLCB2YWx1ZXMpO1xuXHQgICAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgICAgIG8ub25OZXh0KHJlcyk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlzRG9uZSAmJiB2YWx1ZXNbMV0gJiYgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG5cdCAgICAgICAgc291cmNlLnN1YnNjcmliZShcblx0ICAgICAgICAgIGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgICAgIG5leHQoeCwgMCk7XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICAgICAgaWYgKHZhbHVlc1sxXSkge1xuXHQgICAgICAgICAgICAgIG8ub25FcnJvcihlKTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBlcnIgPSBlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICBpc0RvbmUgPSB0cnVlO1xuXHQgICAgICAgICAgICB2YWx1ZXNbMV0gJiYgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgfSksXG5cdCAgICAgICAgc3ViamVjdC5zdWJzY3JpYmUoXG5cdCAgICAgICAgICBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgICAgICBuZXh0KHgsIDEpO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcblx0ICAgICAgICAgICAgbmV4dCh0cnVlLCAxKTtcblx0ICAgICAgICAgIH0pXG5cdCAgICAgICAgKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfVxuXHRcblx0ICB2YXIgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZShzb3VyY2UsIHBhdXNlcikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5jb250cm9sbGVyID0gbmV3IFN1YmplY3QoKTtcblx0XG5cdCAgICAgIGlmIChwYXVzZXIgJiYgcGF1c2VyLnN1YnNjcmliZSkge1xuXHQgICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyLm1lcmdlKHBhdXNlcik7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdGhpcy5wYXVzZXIgPSB0aGlzLmNvbnRyb2xsZXI7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIHEgPSBbXSwgcHJldmlvdXNTaG91bGRGaXJlO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHsgd2hpbGUgKHEubGVuZ3RoID4gMCkgeyBvLm9uTmV4dChxLnNoaWZ0KCkpOyB9IH1cblx0XG5cdCAgICAgIHZhciBzdWJzY3JpcHRpb24gPVxuXHQgICAgICAgIGNvbWJpbmVMYXRlc3RTb3VyY2UoXG5cdCAgICAgICAgICB0aGlzLnNvdXJjZSxcblx0ICAgICAgICAgIHRoaXMucGF1c2VyLnN0YXJ0V2l0aChmYWxzZSkuZGlzdGluY3RVbnRpbENoYW5nZWQoKSxcblx0ICAgICAgICAgIGZ1bmN0aW9uIChkYXRhLCBzaG91bGRGaXJlKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IGRhdGEsIHNob3VsZEZpcmU6IHNob3VsZEZpcmUgfTtcblx0ICAgICAgICAgIH0pXG5cdCAgICAgICAgICAuc3Vic2NyaWJlKFxuXHQgICAgICAgICAgICBmdW5jdGlvbiAocmVzdWx0cykge1xuXHQgICAgICAgICAgICAgIGlmIChwcmV2aW91c1Nob3VsZEZpcmUgIT09IHVuZGVmaW5lZCAmJiByZXN1bHRzLnNob3VsZEZpcmUgIT09IHByZXZpb3VzU2hvdWxkRmlyZSkge1xuXHQgICAgICAgICAgICAgICAgcHJldmlvdXNTaG91bGRGaXJlID0gcmVzdWx0cy5zaG91bGRGaXJlO1xuXHQgICAgICAgICAgICAgICAgLy8gY2hhbmdlIGluIHNob3VsZEZpcmVcblx0ICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLnNob3VsZEZpcmUpIHsgZHJhaW5RdWV1ZSgpOyB9XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIHByZXZpb3VzU2hvdWxkRmlyZSA9IHJlc3VsdHMuc2hvdWxkRmlyZTtcblx0ICAgICAgICAgICAgICAgIC8vIG5ldyBkYXRhXG5cdCAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5zaG91bGRGaXJlKSB7XG5cdCAgICAgICAgICAgICAgICAgIG8ub25OZXh0KHJlc3VsdHMuZGF0YSk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICBxLnB1c2gocmVzdWx0cy5kYXRhKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgICAgICAgICBkcmFpblF1ZXVlKCk7XG5cdCAgICAgICAgICAgICAgby5vbkVycm9yKGVycik7XG5cdCAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICBkcmFpblF1ZXVlKCk7XG5cdCAgICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICApO1xuXHQgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uOyAgICAgIFxuXHQgICAgfTtcblx0XG5cdCAgICBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuY29udHJvbGxlci5vbk5leHQoZmFsc2UpO1xuXHQgICAgfTtcblx0XG5cdCAgICBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLmNvbnRyb2xsZXIub25OZXh0KHRydWUpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGU7XG5cdFxuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBQYXVzZXMgdGhlIHVuZGVybHlpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBiYXNlZCB1cG9uIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIHlpZWxkcyB0cnVlL2ZhbHNlLFxuXHQgICAqIGFuZCB5aWVsZHMgdGhlIHZhbHVlcyB0aGF0IHdlcmUgYnVmZmVyZWQgd2hpbGUgcGF1c2VkLlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHBhdXNlciA9IG5ldyBSeC5TdWJqZWN0KCk7XG5cdCAgICogdmFyIHNvdXJjZSA9IFJ4Lk9ic2VydmFibGUuaW50ZXJ2YWwoMTAwKS5wYXVzYWJsZUJ1ZmZlcmVkKHBhdXNlcik7XG5cdCAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBwYXVzZXIgVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdXNlZCB0byBwYXVzZSB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggaXMgcGF1c2VkIGJhc2VkIHVwb24gdGhlIHBhdXNlci5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucGF1c2FibGVCdWZmZXJlZCA9IGZ1bmN0aW9uIChzdWJqZWN0KSB7XG5cdCAgICByZXR1cm4gbmV3IFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlKHRoaXMsIHN1YmplY3QpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBDb250cm9sbGVkT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDb250cm9sbGVkT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENvbnRyb2xsZWRPYnNlcnZhYmxlIChzb3VyY2UsIGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMuc3ViamVjdCA9IG5ldyBDb250cm9sbGVkU3ViamVjdChlbmFibGVRdWV1ZSwgc2NoZWR1bGVyKTtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2UubXVsdGljYXN0KHRoaXMuc3ViamVjdCkucmVmQ291bnQoKTtcblx0ICAgIH1cblx0XG5cdCAgICBDb250cm9sbGVkT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIENvbnRyb2xsZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gKG51bWJlck9mSXRlbXMpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc3ViamVjdC5yZXF1ZXN0KG51bWJlck9mSXRlbXMgPT0gbnVsbCA/IC0xIDogbnVtYmVyT2ZJdGVtcyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBDb250cm9sbGVkT2JzZXJ2YWJsZTtcblx0XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIHZhciBDb250cm9sbGVkU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDb250cm9sbGVkU3ViamVjdCwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENvbnRyb2xsZWRTdWJqZWN0KGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgZW5hYmxlUXVldWUgPT0gbnVsbCAmJiAoZW5hYmxlUXVldWUgPSB0cnVlKTtcblx0XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLnN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xuXHQgICAgICB0aGlzLmVuYWJsZVF1ZXVlID0gZW5hYmxlUXVldWU7XG5cdCAgICAgIHRoaXMucXVldWUgPSBlbmFibGVRdWV1ZSA/IFtdIDogbnVsbDtcblx0ICAgICAgdGhpcy5yZXF1ZXN0ZWRDb3VudCA9IDA7XG5cdCAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSA9IG51bGw7XG5cdCAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xuXHQgICAgICB0aGlzLmhhc0ZhaWxlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlciB8fCBjdXJyZW50VGhyZWFkU2NoZWR1bGVyO1xuXHQgICAgfVxuXHRcblx0ICAgIGFkZFByb3BlcnRpZXMoQ29udHJvbGxlZFN1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlciwge1xuXHQgICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuXHQgICAgICAgIHJldHVybiB0aGlzLnN1YmplY3Quc3Vic2NyaWJlKG8pO1xuXHQgICAgICB9LFxuXHQgICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMuaGFzQ29tcGxldGVkID0gdHJ1ZTtcblx0ICAgICAgICBpZiAoIXRoaXMuZW5hYmxlUXVldWUgfHwgdGhpcy5xdWV1ZS5sZW5ndGggPT09IDApIHtcblx0ICAgICAgICAgIHRoaXMuc3ViamVjdC5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgdGhpcy5xdWV1ZS5wdXNoKE5vdGlmaWNhdGlvbi5jcmVhdGVPbkNvbXBsZXRlZCgpKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICAgIHRoaXMuaGFzRmFpbGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG5cdCAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVF1ZXVlIHx8IHRoaXMucXVldWUubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgICAgICB0aGlzLnN1YmplY3Qub25FcnJvcihlcnJvcik7XG5cdCAgICAgICAgICB0aGlzLmRpc3Bvc2VDdXJyZW50UmVxdWVzdCgpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGlzLnF1ZXVlLnB1c2goTm90aWZpY2F0aW9uLmNyZWF0ZU9uRXJyb3IoZXJyb3IpKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgaWYgKHRoaXMucmVxdWVzdGVkQ291bnQgPD0gMCkge1xuXHQgICAgICAgICAgdGhpcy5lbmFibGVRdWV1ZSAmJiB0aGlzLnF1ZXVlLnB1c2goTm90aWZpY2F0aW9uLmNyZWF0ZU9uTmV4dCh2YWx1ZSkpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAodGhpcy5yZXF1ZXN0ZWRDb3VudC0tID09PSAwKSAmJiB0aGlzLmRpc3Bvc2VDdXJyZW50UmVxdWVzdCgpO1xuXHQgICAgICAgICAgdGhpcy5zdWJqZWN0Lm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBfcHJvY2Vzc1JlcXVlc3Q6IGZ1bmN0aW9uIChudW1iZXJPZkl0ZW1zKSB7XG5cdCAgICAgICAgaWYgKHRoaXMuZW5hYmxlUXVldWUpIHtcblx0ICAgICAgICAgIHdoaWxlICh0aGlzLnF1ZXVlLmxlbmd0aCA+IDAgJiYgKG51bWJlck9mSXRlbXMgPiAwIHx8IHRoaXMucXVldWVbMF0ua2luZCAhPT0gJ04nKSkge1xuXHQgICAgICAgICAgICB2YXIgZmlyc3QgPSB0aGlzLnF1ZXVlLnNoaWZ0KCk7XG5cdCAgICAgICAgICAgIGZpcnN0LmFjY2VwdCh0aGlzLnN1YmplY3QpO1xuXHQgICAgICAgICAgICBpZiAoZmlyc3Qua2luZCA9PT0gJ04nKSB7XG5cdCAgICAgICAgICAgICAgbnVtYmVyT2ZJdGVtcy0tO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG5cdCAgICAgICAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gbnVtYmVyT2ZJdGVtcztcblx0ICAgICAgfSxcblx0ICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKG51bWJlcikge1xuXHQgICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG5cdCAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHRcblx0ICAgICAgICB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUgPSB0aGlzLnNjaGVkdWxlci5zY2hlZHVsZShudW1iZXIsXG5cdCAgICAgICAgZnVuY3Rpb24ocywgaSkge1xuXHQgICAgICAgICAgdmFyIHJlbWFpbmluZyA9IHNlbGYuX3Byb2Nlc3NSZXF1ZXN0KGkpO1xuXHQgICAgICAgICAgdmFyIHN0b3BwZWQgPSBzZWxmLmhhc0NvbXBsZXRlZCB8fCBzZWxmLmhhc0ZhaWxlZDtcblx0ICAgICAgICAgIGlmICghc3RvcHBlZCAmJiByZW1haW5pbmcgPiAwKSB7XG5cdCAgICAgICAgICAgIHNlbGYucmVxdWVzdGVkQ291bnQgPSByZW1haW5pbmc7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgc2VsZi5yZXF1ZXN0ZWRDb3VudCA9IDA7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgIC8vIFNjaGVkdWxlZCBpdGVtIGlzIHN0aWxsIGluIHByb2dyZXNzLiBSZXR1cm4gYSBuZXdcblx0ICAgICAgICAgICAgICAvLyBkaXNwb3NhYmxlIHRvIGFsbG93IHRoZSByZXF1ZXN0IHRvIGJlIGludGVycnVwdGVkXG5cdCAgICAgICAgICAgICAgLy8gdmlhIGRpc3Bvc2UuXG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGU7XG5cdCAgICAgIH0sXG5cdCAgICAgIGRpc3Bvc2VDdXJyZW50UmVxdWVzdDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICh0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUpIHtcblx0ICAgICAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZS5kaXNwb3NlKCk7XG5cdCAgICAgICAgICB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUgPSBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIENvbnRyb2xsZWRTdWJqZWN0O1xuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBBdHRhY2hlcyBhIGNvbnRyb2xsZXIgdG8gdGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCB0aGUgYWJpbGl0eSB0byBxdWV1ZS5cblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciBzb3VyY2UgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMCkuY29udHJvbGxlZCgpO1xuXHQgICAqIHNvdXJjZS5yZXF1ZXN0KDMpOyAvLyBSZWFkcyAzIHZhbHVlc1xuXHQgICAqIEBwYXJhbSB7Ym9vbH0gZW5hYmxlUXVldWUgdHJ1dGh5IHZhbHVlIHRvIGRldGVybWluZSBpZiB2YWx1ZXMgc2hvdWxkIGJlIHF1ZXVlZCBwZW5kaW5nIHRoZSBuZXh0IHJlcXVlc3Rcblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIGRldGVybWluZXMgaG93IHRoZSByZXF1ZXN0cyB3aWxsIGJlIHNjaGVkdWxlZFxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCBvbmx5IHByb3BhZ2F0ZXMgdmFsdWVzIG9uIHJlcXVlc3QuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmNvbnRyb2xsZWQgPSBmdW5jdGlvbiAoZW5hYmxlUXVldWUsIHNjaGVkdWxlcikge1xuXHRcblx0ICAgIGlmIChlbmFibGVRdWV1ZSAmJiBpc1NjaGVkdWxlcihlbmFibGVRdWV1ZSkpIHtcblx0ICAgICAgc2NoZWR1bGVyID0gZW5hYmxlUXVldWU7XG5cdCAgICAgIGVuYWJsZVF1ZXVlID0gdHJ1ZTtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoZW5hYmxlUXVldWUgPT0gbnVsbCkgeyAgZW5hYmxlUXVldWUgPSB0cnVlOyB9XG5cdCAgICByZXR1cm4gbmV3IENvbnRyb2xsZWRPYnNlcnZhYmxlKHRoaXMsIGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFBpcGVzIHRoZSBleGlzdGluZyBPYnNlcnZhYmxlIHNlcXVlbmNlIGludG8gYSBOb2RlLmpzIFN0cmVhbS5cblx0ICAgKiBAcGFyYW0ge1N0cmVhbX0gZGVzdCBUaGUgZGVzdGluYXRpb24gTm9kZS5qcyBzdHJlYW0uXG5cdCAgICogQHJldHVybnMge1N0cmVhbX0gVGhlIGRlc3RpbmF0aW9uIHN0cmVhbS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucGlwZSA9IGZ1bmN0aW9uIChkZXN0KSB7XG5cdCAgICB2YXIgc291cmNlID0gdGhpcy5wYXVzYWJsZUJ1ZmZlcmVkKCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gb25EcmFpbigpIHtcblx0ICAgICAgc291cmNlLnJlc3VtZSgpO1xuXHQgICAgfVxuXHRcblx0ICAgIGRlc3QuYWRkTGlzdGVuZXIoJ2RyYWluJywgb25EcmFpbik7XG5cdFxuXHQgICAgc291cmNlLnN1YnNjcmliZShcblx0ICAgICAgZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICAhZGVzdC53cml0ZShTdHJpbmcoeCkpICYmIHNvdXJjZS5wYXVzZSgpO1xuXHQgICAgICB9LFxuXHQgICAgICBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgICAgZGVzdC5lbWl0KCdlcnJvcicsIGVycik7XG5cdCAgICAgIH0sXG5cdCAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAvLyBIYWNrIGNoZWNrIGJlY2F1c2UgU1RESU8gaXMgbm90IGNsb3NhYmxlXG5cdCAgICAgICAgIWRlc3QuX2lzU3RkaW8gJiYgZGVzdC5lbmQoKTtcblx0ICAgICAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdkcmFpbicsIG9uRHJhaW4pO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICBzb3VyY2UucmVzdW1lKCk7XG5cdFxuXHQgICAgcmV0dXJuIGRlc3Q7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRyYW5zZHVjZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRyYW5zZHVjZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVHJhbnNkdWNlT2JzZXJ2ZXIobywgeGZvcm0pIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3hmb3JtID0geGZvcm07XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRyYW5zZHVjZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX3hmb3JtWydAQHRyYW5zZHVjZXIvc3RlcCddKS5jYWxsKHRoaXMuX3hmb3JtLCB0aGlzLl9vLCB4KTtcblx0ICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgfTtcblx0XG5cdCAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG5cdFxuXHQgICAgVHJhbnNkdWNlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5feGZvcm1bJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSh0aGlzLl9vKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFRyYW5zZHVjZU9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICBmdW5jdGlvbiB0cmFuc2Zvcm1Gb3JPYnNlcnZlcihvKSB7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICAnQEB0cmFuc2R1Y2VyL2luaXQnOiBmdW5jdGlvbigpIHtcblx0ICAgICAgICByZXR1cm4gbztcblx0ICAgICAgfSxcblx0ICAgICAgJ0BAdHJhbnNkdWNlci9zdGVwJzogZnVuY3Rpb24ob2JzLCBpbnB1dCkge1xuXHQgICAgICAgIHJldHVybiBvYnMub25OZXh0KGlucHV0KTtcblx0ICAgICAgfSxcblx0ICAgICAgJ0BAdHJhbnNkdWNlci9yZXN1bHQnOiBmdW5jdGlvbihvYnMpIHtcblx0ICAgICAgICByZXR1cm4gb2JzLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiBFeGVjdXRlcyBhIHRyYW5zZHVjZXIgdG8gdHJhbnNmb3JtIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlXG5cdCAgICogQHBhcmFtIHtUcmFuc2R1Y2VyfSB0cmFuc2R1Y2VyIEEgdHJhbnNkdWNlciB0byBleGVjdXRlXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIE9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0cyBmcm9tIHRoZSB0cmFuc2R1Y2VyLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50cmFuc2R1Y2UgPSBmdW5jdGlvbih0cmFuc2R1Y2VyKSB7XG5cdCAgICB2YXIgc291cmNlID0gdGhpcztcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbihvKSB7XG5cdCAgICAgIHZhciB4Zm9ybSA9IHRyYW5zZHVjZXIodHJhbnNmb3JtRm9yT2JzZXJ2ZXIobykpO1xuXHQgICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShuZXcgVHJhbnNkdWNlT2JzZXJ2ZXIobywgeGZvcm0pKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIEFub255bW91c09ic2VydmFibGUgPSBSeC5Bbm9ueW1vdXNPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEFub255bW91c09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgLy8gRml4IHN1YnNjcmliZXIgdG8gY2hlY2sgZm9yIHVuZGVmaW5lZCBvciBmdW5jdGlvbiByZXR1cm5lZCB0byBkZWNvcmF0ZSBhcyBEaXNwb3NhYmxlXG5cdCAgICBmdW5jdGlvbiBmaXhTdWJzY3JpYmVyKHN1YnNjcmliZXIpIHtcblx0ICAgICAgcmV0dXJuIHN1YnNjcmliZXIgJiYgaXNGdW5jdGlvbihzdWJzY3JpYmVyLmRpc3Bvc2UpID8gc3Vic2NyaWJlciA6XG5cdCAgICAgICAgaXNGdW5jdGlvbihzdWJzY3JpYmVyKSA/IGRpc3Bvc2FibGVDcmVhdGUoc3Vic2NyaWJlcikgOiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2V0RGlzcG9zYWJsZShzLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgYWRvID0gc3RhdGVbMF0sIHNlbGYgPSBzdGF0ZVsxXTtcblx0ICAgICAgdmFyIHN1YiA9IHRyeUNhdGNoKHNlbGYuX19zdWJzY3JpYmUpLmNhbGwoc2VsZiwgYWRvKTtcblx0ICAgICAgaWYgKHN1YiA9PT0gZXJyb3JPYmogJiYgIWFkby5mYWlsKGVycm9yT2JqLmUpKSB7IHRocm93ZXIoZXJyb3JPYmouZSk7IH1cblx0ICAgICAgYWRvLnNldERpc3Bvc2FibGUoZml4U3Vic2NyaWJlcihzdWIpKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBBbm9ueW1vdXNPYnNlcnZhYmxlKHN1YnNjcmliZSwgcGFyZW50KSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gcGFyZW50O1xuXHQgICAgICB0aGlzLl9fc3Vic2NyaWJlID0gc3Vic2NyaWJlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBBbm9ueW1vdXNPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGFkbyA9IG5ldyBBdXRvRGV0YWNoT2JzZXJ2ZXIobyksIHN0YXRlID0gW2FkbywgdGhpc107XG5cdFxuXHQgICAgICBpZiAoY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlcXVpcmVkKCkpIHtcblx0ICAgICAgICBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlKHN0YXRlLCBzZXREaXNwb3NhYmxlKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBzZXREaXNwb3NhYmxlKG51bGwsIHN0YXRlKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gYWRvO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQW5vbnltb3VzT2JzZXJ2YWJsZTtcblx0XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIHZhciBBdXRvRGV0YWNoT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQXV0b0RldGFjaE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIEF1dG9EZXRhY2hPYnNlcnZlcihvYnNlcnZlcikge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgICB0aGlzLm0gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlID0gQXV0b0RldGFjaE9ic2VydmVyLnByb3RvdHlwZTtcblx0XG5cdCAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5vYnNlcnZlci5vbk5leHQpLmNhbGwodGhpcy5vYnNlcnZlciwgdmFsdWUpO1xuXHQgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikge1xuXHQgICAgICAgIHRoaXMuZGlzcG9zZSgpO1xuXHQgICAgICAgIHRocm93ZXIocmVzdWx0LmUpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25FcnJvcikuY2FsbCh0aGlzLm9ic2VydmVyLCBlcnIpO1xuXHQgICAgICB0aGlzLmRpc3Bvc2UoKTtcblx0ICAgICAgcmVzdWx0ID09PSBlcnJvck9iaiAmJiB0aHJvd2VyKHJlc3VsdC5lKTtcblx0ICAgIH07XG5cdFxuXHQgICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25Db21wbGV0ZWQpLmNhbGwodGhpcy5vYnNlcnZlcik7XG5cdCAgICAgIHRoaXMuZGlzcG9zZSgpO1xuXHQgICAgICByZXN1bHQgPT09IGVycm9yT2JqICYmIHRocm93ZXIocmVzdWx0LmUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuc2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICh2YWx1ZSkgeyB0aGlzLm0uc2V0RGlzcG9zYWJsZSh2YWx1ZSk7IH07XG5cdCAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMubS5nZXREaXNwb3NhYmxlKCk7IH07XG5cdFxuXHQgICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLm0uZGlzcG9zZSgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQXV0b0RldGFjaE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICB2YXIgSW5uZXJTdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAocywgbykge1xuXHQgICAgdGhpcy5fcyA9IHM7XG5cdCAgICB0aGlzLl9vID0gbztcblx0ICB9O1xuXHRcblx0ICBJbm5lclN1YnNjcmlwdGlvbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5fcy5pc0Rpc3Bvc2VkICYmIHRoaXMuX28gIT09IG51bGwpIHtcblx0ICAgICAgdmFyIGlkeCA9IHRoaXMuX3Mub2JzZXJ2ZXJzLmluZGV4T2YodGhpcy5fbyk7XG5cdCAgICAgIHRoaXMuX3Mub2JzZXJ2ZXJzLnNwbGljZShpZHgsIDEpO1xuXHQgICAgICB0aGlzLl9vID0gbnVsbDtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmVwcmVzZW50cyBhbiBvYmplY3QgdGhhdCBpcyBib3RoIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgd2VsbCBhcyBhbiBvYnNlcnZlci5cblx0ICAgKiAgRWFjaCBub3RpZmljYXRpb24gaXMgYnJvYWRjYXN0ZWQgdG8gYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzLlxuXHQgICAqL1xuXHQgIHZhciBTdWJqZWN0ID0gUnguU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTdWJqZWN0LCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU3ViamVjdCgpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuXHQgICAgICB0aGlzLmhhc0Vycm9yID0gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgYWRkUHJvcGVydGllcyhTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG5cdCAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG8pO1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBJbm5lclN1YnNjcmlwdGlvbih0aGlzLCBvKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3IpIHtcblx0ICAgICAgICAgIG8ub25FcnJvcih0aGlzLmVycm9yKTtcblx0ICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuXHQgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuXHQgICAgICAgKi9cblx0ICAgICAgaGFzT2JzZXJ2ZXJzOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm9ic2VydmVycy5sZW5ndGggPiAwOyB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgICBvc1tpXS5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBleGNlcHRpb24uXG5cdCAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIFRoZSBleGNlcHRpb24gdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG5cdCAgICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgYXJyaXZhbCBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuXHQgICAgICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgICBvc1tpXS5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuXHQgICAgICAgKi9cblx0ICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBudWxsO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIENyZWF0ZXMgYSBzdWJqZWN0IGZyb20gdGhlIHNwZWNpZmllZCBvYnNlcnZlciBhbmQgb2JzZXJ2YWJsZS5cblx0ICAgICAqIEBwYXJhbSB7T2JzZXJ2ZXJ9IG9ic2VydmVyIFRoZSBvYnNlcnZlciB1c2VkIHRvIHNlbmQgbWVzc2FnZXMgdG8gdGhlIHN1YmplY3QuXG5cdCAgICAgKiBAcGFyYW0ge09ic2VydmFibGV9IG9ic2VydmFibGUgVGhlIG9ic2VydmFibGUgdXNlZCB0byBzdWJzY3JpYmUgdG8gbWVzc2FnZXMgc2VudCBmcm9tIHRoZSBzdWJqZWN0LlxuXHQgICAgICogQHJldHVybnMge1N1YmplY3R9IFN1YmplY3QgaW1wbGVtZW50ZWQgdXNpbmcgdGhlIGdpdmVuIG9ic2VydmVyIGFuZCBvYnNlcnZhYmxlLlxuXHQgICAgICovXG5cdCAgICBTdWJqZWN0LmNyZWF0ZSA9IGZ1bmN0aW9uIChvYnNlcnZlciwgb2JzZXJ2YWJsZSkge1xuXHQgICAgICByZXR1cm4gbmV3IEFub255bW91c1N1YmplY3Qob2JzZXJ2ZXIsIG9ic2VydmFibGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU3ViamVjdDtcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJlcHJlc2VudHMgdGhlIHJlc3VsdCBvZiBhbiBhc3luY2hyb25vdXMgb3BlcmF0aW9uLlxuXHQgICAqICBUaGUgbGFzdCB2YWx1ZSBiZWZvcmUgdGhlIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbiwgb3IgdGhlIGVycm9yIHJlY2VpdmVkIHRocm91Z2ggT25FcnJvciwgaXMgc2VudCB0byBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMuXG5cdCAgICovXG5cdCAgdmFyIEFzeW5jU3ViamVjdCA9IFJ4LkFzeW5jU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhBc3luY1N1YmplY3QsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDcmVhdGVzIGEgc3ViamVjdCB0aGF0IGNhbiBvbmx5IHJlY2VpdmUgb25lIHZhbHVlIGFuZCB0aGF0IHZhbHVlIGlzIGNhY2hlZCBmb3IgYWxsIGZ1dHVyZSBvYnNlcnZhdGlvbnMuXG5cdCAgICAgKiBAY29uc3RydWN0b3Jcblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gQXN5bmNTdWJqZWN0KCkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaGFzVmFsdWUgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcblx0ICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIGFkZFByb3BlcnRpZXMoQXN5bmNTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG5cdCAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvKTtcblx0ICAgICAgICAgIHJldHVybiBuZXcgSW5uZXJTdWJzY3JpcHRpb24odGhpcywgbyk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuXHQgICAgICAgICAgby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAodGhpcy5oYXNWYWx1ZSkge1xuXHQgICAgICAgICAgby5vbk5leHQodGhpcy52YWx1ZSk7XG5cdCAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG5cdCAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG5cdCAgICAgICAqL1xuXHQgICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIHJldHVybiB0aGlzLm9ic2VydmVycy5sZW5ndGggPiAwO1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLCBhbHNvIGNhdXNpbmcgdGhlIGxhc3QgcmVjZWl2ZWQgdmFsdWUgdG8gYmUgc2VudCBvdXQgKGlmIGFueSkuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciBpLCBsZW47XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB2YXIgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoO1xuXHRcblx0ICAgICAgICAgIGlmICh0aGlzLmhhc1ZhbHVlKSB7XG5cdCAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgICAgIHZhciBvID0gb3NbaV07XG5cdCAgICAgICAgICAgICAgby5vbk5leHQodGhpcy52YWx1ZSk7XG5cdCAgICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgICAgICBvc1tpXS5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVycm9yLlxuXHQgICAgICAgKiBAcGFyYW0ge01peGVkfSBlcnJvciBUaGUgRXJyb3IgdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblx0XG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgICAgb3NbaV0ub25FcnJvcihlcnJvcik7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBTZW5kcyBhIHZhbHVlIHRvIHRoZSBzdWJqZWN0LiBUaGUgbGFzdCB2YWx1ZSByZWNlaXZlZCBiZWZvcmUgc3VjY2Vzc2Z1bCB0ZXJtaW5hdGlvbiB3aWxsIGJlIHNlbnQgdG8gYWxsIHN1YnNjcmliZWQgYW5kIGZ1dHVyZSBvYnNlcnZlcnMuXG5cdCAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzdG9yZSBpbiB0aGUgc3ViamVjdC5cblx0ICAgICAgICovXG5cdCAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXHQgICAgICAgIHRoaXMuaGFzVmFsdWUgPSB0cnVlO1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogVW5zdWJzY3JpYmUgYWxsIG9ic2VydmVycyBhbmQgcmVsZWFzZSByZXNvdXJjZXMuXG5cdCAgICAgICAqL1xuXHQgICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm9ic2VydmVycyA9IG51bGw7XG5cdCAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG5cdCAgICAgICAgdGhpcy52YWx1ZSA9IG51bGw7XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHRcblx0ICAgIHJldHVybiBBc3luY1N1YmplY3Q7XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIHZhciBBbm9ueW1vdXNTdWJqZWN0ID0gUnguQW5vbnltb3VzU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhBbm9ueW1vdXNTdWJqZWN0LCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQW5vbnltb3VzU3ViamVjdChvYnNlcnZlciwgb2JzZXJ2YWJsZSkge1xuXHQgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICAgIHRoaXMub2JzZXJ2YWJsZSA9IG9ic2VydmFibGU7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGFkZFByb3BlcnRpZXMoQW5vbnltb3VzU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuXHQgICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuXHQgICAgICAgIHJldHVybiB0aGlzLm9ic2VydmFibGUuc3Vic2NyaWJlKG8pO1xuXHQgICAgICB9LFxuXHQgICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfSxcblx0ICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlci5vbkVycm9yKGVycm9yKTtcblx0ICAgICAgfSxcblx0ICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICB0aGlzLm9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHRcblx0ICAgIHJldHVybiBBbm9ueW1vdXNTdWJqZWN0O1xuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmVwcmVzZW50cyBhIHZhbHVlIHRoYXQgY2hhbmdlcyBvdmVyIHRpbWUuXG5cdCAgICogIE9ic2VydmVycyBjYW4gc3Vic2NyaWJlIHRvIHRoZSBzdWJqZWN0IHRvIHJlY2VpdmUgdGhlIGxhc3QgKG9yIGluaXRpYWwpIHZhbHVlIGFuZCBhbGwgc3Vic2VxdWVudCBub3RpZmljYXRpb25zLlxuXHQgICAqL1xuXHQgIHZhciBCZWhhdmlvclN1YmplY3QgPSBSeC5CZWhhdmlvclN1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQmVoYXZpb3JTdWJqZWN0LCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQmVoYXZpb3JTdWJqZWN0KHZhbHVlKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmhhc0Vycm9yID0gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgYWRkUHJvcGVydGllcyhCZWhhdmlvclN1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcblx0ICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gobyk7XG5cdCAgICAgICAgICBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcblx0ICAgICAgICAgIHJldHVybiBuZXcgSW5uZXJTdWJzY3JpcHRpb24odGhpcywgbyk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG5cdCAgICAgICAgICBvLm9uRXJyb3IodGhpcy5lcnJvcik7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEdldHMgdGhlIGN1cnJlbnQgdmFsdWUgb3IgdGhyb3dzIGFuIGV4Y2VwdGlvbi5cblx0ICAgICAgICogVmFsdWUgaXMgZnJvemVuIGFmdGVyIG9uQ29tcGxldGVkIGlzIGNhbGxlZC5cblx0ICAgICAgICogQWZ0ZXIgb25FcnJvciBpcyBjYWxsZWQgYWx3YXlzIHRocm93cyB0aGUgc3BlY2lmaWVkIGV4Y2VwdGlvbi5cblx0ICAgICAgICogQW4gZXhjZXB0aW9uIGlzIGFsd2F5cyB0aHJvd24gYWZ0ZXIgZGlzcG9zZSBpcyBjYWxsZWQuXG5cdCAgICAgICAqIEByZXR1cm5zIHtNaXhlZH0gVGhlIGluaXRpYWwgdmFsdWUgcGFzc2VkIHRvIHRoZSBjb25zdHJ1Y3RvciB1bnRpbCBvbk5leHQgaXMgY2FsbGVkOyBhZnRlciB3aGljaCwgdGhlIGxhc3QgdmFsdWUgcGFzc2VkIHRvIG9uTmV4dC5cblx0ICAgICAgICovXG5cdCAgICAgIGdldFZhbHVlOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3IpIHtcblx0ICAgICAgICAgICAgICB0aHJvdyB0aGlzLmVycm9yO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG5cdCAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG5cdCAgICAgICAqL1xuXHQgICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7IH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgIG9zW2ldLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBleGNlcHRpb24uXG5cdCAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIFRoZSBleGNlcHRpb24gdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuaGFzRXJyb3IgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblx0XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGFycml2YWwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cblx0ICAgICAgICovXG5cdCAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgb3NbaV0ub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBVbnN1YnNjcmliZSBhbGwgb2JzZXJ2ZXJzIGFuZCByZWxlYXNlIHJlc291cmNlcy5cblx0ICAgICAgICovXG5cdCAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcblx0ICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcblx0ICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIEJlaGF2aW9yU3ViamVjdDtcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmVwcmVzZW50cyBhbiBvYmplY3QgdGhhdCBpcyBib3RoIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgd2VsbCBhcyBhbiBvYnNlcnZlci5cblx0ICAgKiBFYWNoIG5vdGlmaWNhdGlvbiBpcyBicm9hZGNhc3RlZCB0byBhbGwgc3Vic2NyaWJlZCBhbmQgZnV0dXJlIG9ic2VydmVycywgc3ViamVjdCB0byBidWZmZXIgdHJpbW1pbmcgcG9saWNpZXMuXG5cdCAgICovXG5cdCAgdmFyIFJlcGxheVN1YmplY3QgPSBSeC5SZXBsYXlTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0XG5cdCAgICB2YXIgbWF4U2FmZUludGVnZXIgPSBNYXRoLnBvdygyLCA1MykgLSAxO1xuXHRcblx0ICAgIGZ1bmN0aW9uIGNyZWF0ZVJlbW92YWJsZURpc3Bvc2FibGUoc3ViamVjdCwgb2JzZXJ2ZXIpIHtcblx0ICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIG9ic2VydmVyLmRpc3Bvc2UoKTtcblx0ICAgICAgICAhc3ViamVjdC5pc0Rpc3Bvc2VkICYmIHN1YmplY3Qub2JzZXJ2ZXJzLnNwbGljZShzdWJqZWN0Lm9ic2VydmVycy5pbmRleE9mKG9ic2VydmVyKSwgMSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHRcblx0ICAgIGluaGVyaXRzKFJlcGxheVN1YmplY3QsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiAgSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIFJlcGxheVN1YmplY3QgY2xhc3Mgd2l0aCB0aGUgc3BlY2lmaWVkIGJ1ZmZlciBzaXplLCB3aW5kb3cgc2l6ZSBhbmQgc2NoZWR1bGVyLlxuXHQgICAgICogIEBwYXJhbSB7TnVtYmVyfSBbYnVmZmVyU2l6ZV0gTWF4aW11bSBlbGVtZW50IGNvdW50IG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuXHQgICAgICogIEBwYXJhbSB7TnVtYmVyfSBbd2luZG93U2l6ZV0gTWF4aW11bSB0aW1lIGxlbmd0aCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cblx0ICAgICAqICBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRoZSBvYnNlcnZlcnMgYXJlIGludm9rZWQgb24uXG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMuYnVmZmVyU2l6ZSA9IGJ1ZmZlclNpemUgPT0gbnVsbCA/IG1heFNhZmVJbnRlZ2VyIDogYnVmZmVyU2l6ZTtcblx0ICAgICAgdGhpcy53aW5kb3dTaXplID0gd2luZG93U2l6ZSA9PSBudWxsID8gbWF4U2FmZUludGVnZXIgOiB3aW5kb3dTaXplO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlciB8fCBjdXJyZW50VGhyZWFkU2NoZWR1bGVyO1xuXHQgICAgICB0aGlzLnEgPSBbXTtcblx0ICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaGFzRXJyb3IgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGFkZFByb3BlcnRpZXMoUmVwbGF5U3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuXHQgICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgdmFyIHNvID0gbmV3IFNjaGVkdWxlZE9ic2VydmVyKHRoaXMuc2NoZWR1bGVyLCBvKSwgc3Vic2NyaXB0aW9uID0gY3JlYXRlUmVtb3ZhYmxlRGlzcG9zYWJsZSh0aGlzLCBzbyk7XG5cdFxuXHQgICAgICAgIHRoaXMuX3RyaW0odGhpcy5zY2hlZHVsZXIubm93KCkpO1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2goc28pO1xuXHRcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5xLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICBzby5vbk5leHQodGhpcy5xW2ldLnZhbHVlKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG5cdCAgICAgICAgICBzby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHNvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBzby5lbnN1cmVBY3RpdmUoKTtcblx0ICAgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuXHQgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuXHQgICAgICAgKi9cblx0ICAgICAgaGFzT2JzZXJ2ZXJzOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG5cdCAgICAgIH0sXG5cdCAgICAgIF90cmltOiBmdW5jdGlvbiAobm93KSB7XG5cdCAgICAgICAgd2hpbGUgKHRoaXMucS5sZW5ndGggPiB0aGlzLmJ1ZmZlclNpemUpIHtcblx0ICAgICAgICAgIHRoaXMucS5zaGlmdCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB3aGlsZSAodGhpcy5xLmxlbmd0aCA+IDAgJiYgKG5vdyAtIHRoaXMucVswXS5pbnRlcnZhbCkgPiB0aGlzLndpbmRvd1NpemUpIHtcblx0ICAgICAgICAgIHRoaXMucS5zaGlmdCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgYXJyaXZhbCBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuXHQgICAgICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB2YXIgbm93ID0gdGhpcy5zY2hlZHVsZXIubm93KCk7XG5cdCAgICAgICAgdGhpcy5xLnB1c2goeyBpbnRlcnZhbDogbm93LCB2YWx1ZTogdmFsdWUgfSk7XG5cdCAgICAgICAgdGhpcy5fdHJpbShub3cpO1xuXHRcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgIHZhciBvYnNlcnZlciA9IG9zW2ldO1xuXHQgICAgICAgICAgb2JzZXJ2ZXIub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICAgIG9ic2VydmVyLmVuc3VyZUFjdGl2ZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXhjZXB0aW9uLlxuXHQgICAgICAgKiBAcGFyYW0ge01peGVkfSBlcnJvciBUaGUgZXhjZXB0aW9uIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cblx0ICAgICAgICovXG5cdCAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG5cdCAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG5cdCAgICAgICAgdmFyIG5vdyA9IHRoaXMuc2NoZWR1bGVyLm5vdygpO1xuXHQgICAgICAgIHRoaXMuX3RyaW0obm93KTtcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgIHZhciBvYnNlcnZlciA9IG9zW2ldO1xuXHQgICAgICAgICAgb2JzZXJ2ZXIub25FcnJvcihlcnJvcik7XG5cdCAgICAgICAgICBvYnNlcnZlci5lbnN1cmVBY3RpdmUoKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAgICovXG5cdCAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHZhciBub3cgPSB0aGlzLnNjaGVkdWxlci5ub3coKTtcblx0ICAgICAgICB0aGlzLl90cmltKG5vdyk7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBvc1tpXTtcblx0ICAgICAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICBvYnNlcnZlci5lbnN1cmVBY3RpdmUoKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuXHQgICAgICAgKi9cblx0ICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBudWxsO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICByZXR1cm4gUmVwbGF5U3ViamVjdDtcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiBVc2VkIHRvIHBhdXNlIGFuZCByZXN1bWUgc3RyZWFtcy5cblx0ICAqL1xuXHQgIFJ4LlBhdXNlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhQYXVzZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBQYXVzZXIoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuXHQgICAgICovXG5cdCAgICBQYXVzZXIucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkgeyB0aGlzLm9uTmV4dChmYWxzZSk7IH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAqIFJlc3VtZXMgdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG5cdCAgICAqL1xuXHQgICAgUGF1c2VyLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7IHRoaXMub25OZXh0KHRydWUpOyB9O1xuXHRcblx0ICAgIHJldHVybiBQYXVzZXI7XG5cdCAgfShTdWJqZWN0KSk7XG5cdFxuXHQgIGlmICh0cnVlKSB7XG5cdCAgICByb290LlJ4ID0gUng7XG5cdFxuXHQgICAgIShfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gUng7XG5cdCAgICB9LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXywgZXhwb3J0cywgbW9kdWxlKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXHQgIH0gZWxzZSBpZiAoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSkge1xuXHQgICAgLy8gaW4gTm9kZS5qcyBvciBSaW5nb0pTXG5cdCAgICBpZiAobW9kdWxlRXhwb3J0cykge1xuXHQgICAgICAoZnJlZU1vZHVsZS5leHBvcnRzID0gUngpLlJ4ID0gUng7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBmcmVlRXhwb3J0cy5SeCA9IFJ4O1xuXHQgICAgfVxuXHQgIH0gZWxzZSB7XG5cdCAgICAvLyBpbiBhIGJyb3dzZXIgb3IgUmhpbm9cblx0ICAgIHJvb3QuUnggPSBSeDtcblx0ICB9XG5cdFxuXHQgIC8vIEFsbCBjb2RlIGJlZm9yZSB0aGlzIHBvaW50IHdpbGwgYmUgZmlsdGVyZWQgZnJvbSBzdGFjayB0cmFjZXMuXG5cdCAgdmFyIHJFbmRpbmdMaW5lID0gY2FwdHVyZUxpbmUoKTtcblx0XG5cdH0uY2FsbCh0aGlzKSk7XG5cdFxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi99LmNhbGwoZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXygzMykobW9kdWxlKSwgKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSwgX193ZWJwYWNrX3JlcXVpcmVfXyg0KSkpXG5cbi8qKiovIH0sXG4vKiAxMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0ZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCkoKTtcblx0Ly8gaW1wb3J0c1xuXHRcblx0XG5cdC8vIG1vZHVsZVxuXHRleHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIuY2xpbWJfX3dhbGx7d2lkdGg6MTAwJTtwYWRkaW5nOjA7bWFyZ2luOjA7LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOy1tcy1mbGV4LXBhY2s6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpyb3c7LW1zLWZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LWRpcmVjdGlvbjpyb3c7LXdlYmtpdC1mbGV4LXdyYXA6d3JhcDstbXMtZmxleC13cmFwOndyYXA7ZmxleC13cmFwOndyYXA7Zm9udC1zaXplOjEwMCV9LmNsaW1iX190aWxlLC5jbGltYl9fd2FsbHtkaXNwbGF5Oi13ZWJraXQtZmxleDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleH0uY2xpbWJfX3RpbGV7LXdlYmtpdC1mbGV4LXNocmluazowOy1tcy1mbGV4LW5lZ2F0aXZlOjA7ZmxleC1zaHJpbms6MDtoZWlnaHQ6NDI1cHg7Ym94LXNpemluZzpib3JkZXItYm94Oy13ZWJraXQtanVzdGlmeS1jb250ZW50OmZsZXgtZW5kOy1tcy1mbGV4LXBhY2s6ZW5kO2p1c3RpZnktY29udGVudDpmbGV4LWVuZDstd2Via2l0LWZsZXgtZGlyZWN0aW9uOmNvbHVtbjstbXMtZmxleC1kaXJlY3Rpb246Y29sdW1uO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtvdXRsaW5lOjFweCBzb2xpZCB0cmFuc3BhcmVudDttYXJnaW4tYm90dG9tOjIwcHg7b3ZlcmZsb3c6aGlkZGVuO3RleHQtYWxpZ246bGVmdDtib3JkZXItcmFkaXVzOjdweDtiYWNrZ3JvdW5kLWNvbG9yOiNmNmY2ZjY7LXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbjtiYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbjstd2Via2l0LXBlcnNwZWN0aXZlOjEwMDBweDtwZXJzcGVjdGl2ZToxMDAwcHh9LmNsaW1iX190aWxlX19jb250ZW50e3otaW5kZXg6MTtwYWRkaW5nOjI2cHg7YmFja2dyb3VuZC1jb2xvcjojZjZmNmY2fS5jbGltYl9fdGlsZS0taGFzLW5vLWltYWdlIC5jbGltYl9fdGlsZV9fY29udGVudHtoZWlnaHQ6MTAwJTtkaXNwbGF5Oi13ZWJraXQtZmxleDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstd2Via2l0LWZsZXgtZGlyZWN0aW9uOmNvbHVtbjstbXMtZmxleC1kaXJlY3Rpb246Y29sdW1uO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjstd2Via2l0LWp1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOy1tcy1mbGV4LXBhY2s6anVzdGlmeTtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2Vlbjtib3gtc2l6aW5nOmJvcmRlci1ib3h9LmNsaW1iX190aWxlX19pbWFnZXttYXgtd2lkdGg6MTAwJTtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjdweDtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czo3cHh9LmNsaW1iX190aWxlX19tZXNzYWdle3otaW5kZXg6MTttYXJnaW4tYm90dG9tOjI0cHh9LmNsaW1iX190aWxlX19tZXNzYWdlPmF7d2hpdGUtc3BhY2U6bm93cmFwO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzO21heC13aWR0aDoyNjBweDtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjpib3R0b219LmNsaW1iX190aWxlLS1oYXMtbm8taW1hZ2UgLmNsaW1iX190aWxlX19tZXNzYWdle2ZvbnQtc2l6ZToxODUlfS5jbGltYl9fdGlsZV9fYXV0aG9ye2Rpc3BsYXk6YmxvY2s7bWFyZ2luOi0xMHB4fS5jbGltYl9fdGlsZV9fYXV0aG9yIGltZ3tib3JkZXItcmFkaXVzOjI1cHg7d2lkdGg6MzRweH0uY2xpbWJfX3RpbGVfX2F1dGhvciAuY2xpbWJfX3RpbGVfX2F1dGhvcl9fdXNlcm5hbWV7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luOjAgMCAwIDEwcHg7bGluZS1oZWlnaHQ6MzRweDt2ZXJ0aWNhbC1hbGlnbjp0b3B9LmNsaW1iLWJhZGdle3Bvc2l0aW9uOmZpeGVkO2JvdHRvbToyMHB4O3JpZ2h0OjIwcHg7ei1pbmRleDo5O2JhY2tncm91bmQ6I2E5Y2FlMiB1cmwoXCIgKyBfX3dlYnBhY2tfcmVxdWlyZV9fKDE2KSArIFwiKSBjZW50ZXIgY2VudGVyIG5vLXJlcGVhdDt3aWR0aDoyMDBweDtoZWlnaHQ6ODBweDtib3JkZXItcmFkaXVzOjVweH0uY2xpbWItYmFkZ2U+c3Bhbntwb3NpdGlvbjphYnNvbHV0ZSFpbXBvcnRhbnQ7dG9wOi05OTk5cHghaW1wb3J0YW50O2xlZnQ6LTk5OTlweCFpbXBvcnRhbnR9XCIsIFwiXCJdKTtcblx0XG5cdC8vIGV4cG9ydHNcblxuXG4vKioqLyB9LFxuLyogMTQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8qXHJcblx0XHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxyXG5cdFx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxyXG5cdCovXHJcblx0Ly8gY3NzIGJhc2UgY29kZSwgaW5qZWN0ZWQgYnkgdGhlIGNzcy1sb2FkZXJcclxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGxpc3QgPSBbXTtcclxuXHRcclxuXHRcdC8vIHJldHVybiB0aGUgbGlzdCBvZiBtb2R1bGVzIGFzIGNzcyBzdHJpbmdcclxuXHRcdGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcclxuXHRcdFx0dmFyIHJlc3VsdCA9IFtdO1xyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHZhciBpdGVtID0gdGhpc1tpXTtcclxuXHRcdFx0XHRpZihpdGVtWzJdKSB7XHJcblx0XHRcdFx0XHRyZXN1bHQucHVzaChcIkBtZWRpYSBcIiArIGl0ZW1bMl0gKyBcIntcIiArIGl0ZW1bMV0gKyBcIn1cIik7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHJlc3VsdC5wdXNoKGl0ZW1bMV0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gcmVzdWx0LmpvaW4oXCJcIik7XHJcblx0XHR9O1xyXG5cdFxyXG5cdFx0Ly8gaW1wb3J0IGEgbGlzdCBvZiBtb2R1bGVzIGludG8gdGhlIGxpc3RcclxuXHRcdGxpc3QuaSA9IGZ1bmN0aW9uKG1vZHVsZXMsIG1lZGlhUXVlcnkpIHtcclxuXHRcdFx0aWYodHlwZW9mIG1vZHVsZXMgPT09IFwic3RyaW5nXCIpXHJcblx0XHRcdFx0bW9kdWxlcyA9IFtbbnVsbCwgbW9kdWxlcywgXCJcIl1dO1xyXG5cdFx0XHR2YXIgYWxyZWFkeUltcG9ydGVkTW9kdWxlcyA9IHt9O1xyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHZhciBpZCA9IHRoaXNbaV1bMF07XHJcblx0XHRcdFx0aWYodHlwZW9mIGlkID09PSBcIm51bWJlclwiKVxyXG5cdFx0XHRcdFx0YWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZvcihpID0gMDsgaSA8IG1vZHVsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgaXRlbSA9IG1vZHVsZXNbaV07XHJcblx0XHRcdFx0Ly8gc2tpcCBhbHJlYWR5IGltcG9ydGVkIG1vZHVsZVxyXG5cdFx0XHRcdC8vIHRoaXMgaW1wbGVtZW50YXRpb24gaXMgbm90IDEwMCUgcGVyZmVjdCBmb3Igd2VpcmQgbWVkaWEgcXVlcnkgY29tYmluYXRpb25zXHJcblx0XHRcdFx0Ly8gIHdoZW4gYSBtb2R1bGUgaXMgaW1wb3J0ZWQgbXVsdGlwbGUgdGltZXMgd2l0aCBkaWZmZXJlbnQgbWVkaWEgcXVlcmllcy5cclxuXHRcdFx0XHQvLyAgSSBob3BlIHRoaXMgd2lsbCBuZXZlciBvY2N1ciAoSGV5IHRoaXMgd2F5IHdlIGhhdmUgc21hbGxlciBidW5kbGVzKVxyXG5cdFx0XHRcdGlmKHR5cGVvZiBpdGVtWzBdICE9PSBcIm51bWJlclwiIHx8ICFhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7XHJcblx0XHRcdFx0XHRpZihtZWRpYVF1ZXJ5ICYmICFpdGVtWzJdKSB7XHJcblx0XHRcdFx0XHRcdGl0ZW1bMl0gPSBtZWRpYVF1ZXJ5O1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmKG1lZGlhUXVlcnkpIHtcclxuXHRcdFx0XHRcdFx0aXRlbVsyXSA9IFwiKFwiICsgaXRlbVsyXSArIFwiKSBhbmQgKFwiICsgbWVkaWFRdWVyeSArIFwiKVwiO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0bGlzdC5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHRcdHJldHVybiBsaXN0O1xyXG5cdH07XHJcblxuXG4vKioqLyB9LFxuLyogMTUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOyhmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG5cdCAgaWYgKHRydWUpIHtcblx0ICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtleHBvcnRzLCBtb2R1bGVdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18gPSAoZmFjdG9yeSksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gKHR5cGVvZiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18gPT09ICdmdW5jdGlvbicgPyAoX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pKSA6IF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuXHQgICAgZmFjdG9yeShleHBvcnRzLCBtb2R1bGUpO1xuXHQgIH0gZWxzZSB7XG5cdCAgICB2YXIgbW9kID0ge1xuXHQgICAgICBleHBvcnRzOiB7fVxuXHQgICAgfTtcblx0ICAgIGZhY3RvcnkobW9kLmV4cG9ydHMsIG1vZCk7XG5cdCAgICBnbG9iYWwuZmV0Y2hKc29ucCA9IG1vZC5leHBvcnRzO1xuXHQgIH1cblx0fSkodGhpcywgZnVuY3Rpb24gKGV4cG9ydHMsIG1vZHVsZSkge1xuXHQgICd1c2Ugc3RyaWN0Jztcblx0XG5cdCAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuXHQgICAgdGltZW91dDogNTAwMCxcblx0ICAgIGpzb25wQ2FsbGJhY2s6ICdjYWxsYmFjaydcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBnZW5lcmF0ZUNhbGxiYWNrRnVuY3Rpb24oKSB7XG5cdCAgICByZXR1cm4gJ2pzb25wXycgKyBEYXRlLm5vdygpICsgJ18nICsgTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkgKiAxMDAwMDApO1xuXHQgIH1cblx0XG5cdCAgLy8gS25vd24gaXNzdWU6IFdpbGwgdGhyb3cgJ1VuY2F1Z2h0IFJlZmVyZW5jZUVycm9yOiBjYWxsYmFja18qKiogaXMgbm90IGRlZmluZWQnIGVycm9yIGlmIHJlcXVlc3QgdGltZW91dFxuXHQgIGZ1bmN0aW9uIGNsZWFyRnVuY3Rpb24oZnVuY3Rpb25OYW1lKSB7XG5cdCAgICAvLyBJRTggdGhyb3dzIGFuIGV4Y2VwdGlvbiB3aGVuIHlvdSB0cnkgdG8gZGVsZXRlIGEgcHJvcGVydHkgb24gd2luZG93XG5cdCAgICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xODI0MjI4Lzc1MTA4OVxuXHQgICAgdHJ5IHtcblx0ICAgICAgZGVsZXRlIHdpbmRvd1tmdW5jdGlvbk5hbWVdO1xuXHQgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICB3aW5kb3dbZnVuY3Rpb25OYW1lXSA9IHVuZGVmaW5lZDtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHJlbW92ZVNjcmlwdChzY3JpcHRJZCkge1xuXHQgICAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNjcmlwdElkKTtcblx0ICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuXHQgIH1cblx0XG5cdCAgdmFyIGZldGNoSnNvbnAgPSBmdW5jdGlvbiBmZXRjaEpzb25wKHVybCkge1xuXHQgICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTtcblx0XG5cdCAgICB2YXIgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCAhPSBudWxsID8gb3B0aW9ucy50aW1lb3V0IDogZGVmYXVsdE9wdGlvbnMudGltZW91dDtcblx0ICAgIHZhciBqc29ucENhbGxiYWNrID0gb3B0aW9ucy5qc29ucENhbGxiYWNrICE9IG51bGwgPyBvcHRpb25zLmpzb25wQ2FsbGJhY2sgOiBkZWZhdWx0T3B0aW9ucy5qc29ucENhbGxiYWNrO1xuXHRcblx0ICAgIHZhciB0aW1lb3V0SWQgPSB1bmRlZmluZWQ7XG5cdFxuXHQgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgdmFyIGNhbGxiYWNrRnVuY3Rpb24gPSBnZW5lcmF0ZUNhbGxiYWNrRnVuY3Rpb24oKTtcblx0XG5cdCAgICAgIHdpbmRvd1tjYWxsYmFja0Z1bmN0aW9uXSA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXHQgICAgICAgIHJlc29sdmUoe1xuXHQgICAgICAgICAgb2s6IHRydWUsXG5cdCAgICAgICAgICAvLyBrZWVwIGNvbnNpc3RlbnQgd2l0aCBmZXRjaCBBUElcblx0ICAgICAgICAgIGpzb246IGZ1bmN0aW9uIGpzb24oKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzcG9uc2UpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICBpZiAodGltZW91dElkKSBjbGVhclRpbWVvdXQodGltZW91dElkKTtcblx0XG5cdCAgICAgICAgcmVtb3ZlU2NyaXB0KGpzb25wQ2FsbGJhY2sgKyAnXycgKyBjYWxsYmFja0Z1bmN0aW9uKTtcblx0XG5cdCAgICAgICAgY2xlYXJGdW5jdGlvbihjYWxsYmFja0Z1bmN0aW9uKTtcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIC8vIENoZWNrIGlmIHRoZSB1c2VyIHNldCB0aGVpciBvd24gcGFyYW1zLCBhbmQgaWYgbm90IGFkZCBhID8gdG8gc3RhcnQgYSBsaXN0IG9mIHBhcmFtc1xuXHQgICAgICB1cmwgKz0gdXJsLmluZGV4T2YoJz8nKSA9PT0gLTEgPyAnPycgOiAnJic7XG5cdFxuXHQgICAgICB2YXIganNvbnBTY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcblx0ICAgICAganNvbnBTY3JpcHQuc2V0QXR0cmlidXRlKFwic3JjXCIsIHVybCArIGpzb25wQ2FsbGJhY2sgKyAnPScgKyBjYWxsYmFja0Z1bmN0aW9uKTtcblx0ICAgICAganNvbnBTY3JpcHQuaWQgPSBqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbjtcblx0ICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLmFwcGVuZENoaWxkKGpzb25wU2NyaXB0KTtcblx0XG5cdCAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0pTT05QIHJlcXVlc3QgdG8gJyArIHVybCArICcgdGltZWQgb3V0JykpO1xuXHRcblx0ICAgICAgICBjbGVhckZ1bmN0aW9uKGNhbGxiYWNrRnVuY3Rpb24pO1xuXHQgICAgICAgIHJlbW92ZVNjcmlwdChqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbik7XG5cdCAgICAgIH0sIHRpbWVvdXQpO1xuXHQgICAgfSk7XG5cdCAgfTtcblx0XG5cdCAgLy8gZXhwb3J0IGFzIGdsb2JhbCBmdW5jdGlvblxuXHQgIC8qXG5cdCAgbGV0IGxvY2FsO1xuXHQgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuXHQgICAgbG9jYWwgPSBnbG9iYWw7XG5cdCAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgIGxvY2FsID0gc2VsZjtcblx0ICB9IGVsc2Uge1xuXHQgICAgdHJ5IHtcblx0ICAgICAgbG9jYWwgPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHQgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BvbHlmaWxsIGZhaWxlZCBiZWNhdXNlIGdsb2JhbCBvYmplY3QgaXMgdW5hdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpO1xuXHQgICAgfVxuXHQgIH1cblx0ICBcblx0ICBsb2NhbC5mZXRjaEpzb25wID0gZmV0Y2hKc29ucDtcblx0ICAqL1xuXHRcblx0ICBtb2R1bGUuZXhwb3J0cyA9IGZldGNoSnNvbnA7XG5cdH0pO1xuXG4vKioqLyB9LFxuLyogMTYgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXy5wICsgXCJlYTk0Y2JjMzdiNzBlZTBmYzIzMmU2YWIyZmEwMGEwMi5wbmdcIlxuXG4vKioqLyB9LFxuLyogMTcgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IGNvbmZpZ0FuaW1hdGlvbjtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdHZhciBfcGVyZm9ybWFuY2VOb3cgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHRcblx0dmFyIF9wZXJmb3JtYW5jZU5vdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wZXJmb3JtYW5jZU5vdyk7XG5cdFxuXHR2YXIgX3JhZiA9IF9fd2VicGFja19yZXF1aXJlX18oMzApO1xuXHRcblx0dmFyIF9yYWYyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmFmKTtcblx0XG5cdGZ1bmN0aW9uIGNvbmZpZ0FuaW1hdGlvbigpIHtcblx0ICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMF07XG5cdCAgdmFyIF9jb25maWckdGltZVN0ZXAgPSBjb25maWcudGltZVN0ZXA7XG5cdCAgdmFyIHRpbWVTdGVwID0gX2NvbmZpZyR0aW1lU3RlcCA9PT0gdW5kZWZpbmVkID8gMSAvIDYwICogMTAwMCA6IF9jb25maWckdGltZVN0ZXA7XG5cdCAgdmFyIF9jb25maWckdGltZVNjYWxlID0gY29uZmlnLnRpbWVTY2FsZTtcblx0ICB2YXIgdGltZVNjYWxlID0gX2NvbmZpZyR0aW1lU2NhbGUgPT09IHVuZGVmaW5lZCA/IDEgOiBfY29uZmlnJHRpbWVTY2FsZTtcblx0ICB2YXIgX2NvbmZpZyRtYXhTdGVwcyA9IGNvbmZpZy5tYXhTdGVwcztcblx0ICB2YXIgbWF4U3RlcHMgPSBfY29uZmlnJG1heFN0ZXBzID09PSB1bmRlZmluZWQgPyAxMCA6IF9jb25maWckbWF4U3RlcHM7XG5cdCAgdmFyIF9jb25maWckcmFmID0gY29uZmlnLnJhZjtcblx0ICB2YXIgcmFmID0gX2NvbmZpZyRyYWYgPT09IHVuZGVmaW5lZCA/IF9yYWYyWydkZWZhdWx0J10gOiBfY29uZmlnJHJhZjtcblx0ICB2YXIgX2NvbmZpZyRub3cgPSBjb25maWcubm93O1xuXHQgIHZhciBub3cgPSBfY29uZmlnJG5vdyA9PT0gdW5kZWZpbmVkID8gX3BlcmZvcm1hbmNlTm93MlsnZGVmYXVsdCddIDogX2NvbmZpZyRub3c7XG5cdFxuXHQgIHZhciBhbmltUnVubmluZyA9IFtdO1xuXHQgIHZhciBydW5uaW5nID0gZmFsc2U7XG5cdCAgdmFyIHByZXZUaW1lID0gMDtcblx0ICB2YXIgYWNjdW11bGF0ZWRUaW1lID0gMDtcblx0XG5cdCAgZnVuY3Rpb24gbG9vcCgpIHtcblx0ICAgIHZhciBjdXJyZW50VGltZSA9IG5vdygpO1xuXHQgICAgdmFyIGZyYW1lVGltZSA9IGN1cnJlbnRUaW1lIC0gcHJldlRpbWU7IC8vIGRlbHRhXG5cdFxuXHQgICAgcHJldlRpbWUgPSBjdXJyZW50VGltZTtcblx0ICAgIGFjY3VtdWxhdGVkVGltZSArPSBmcmFtZVRpbWUgKiB0aW1lU2NhbGU7XG5cdFxuXHQgICAgaWYgKGFjY3VtdWxhdGVkVGltZSA+IHRpbWVTdGVwICogbWF4U3RlcHMpIHtcblx0ICAgICAgYWNjdW11bGF0ZWRUaW1lID0gMDtcblx0ICAgIH1cblx0XG5cdCAgICB2YXIgZnJhbWVOdW1iZXIgPSBNYXRoLmNlaWwoYWNjdW11bGF0ZWRUaW1lIC8gdGltZVN0ZXApO1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbmltUnVubmluZy5sZW5ndGg7IGkrKykge1xuXHQgICAgICB2YXIgX2FuaW1SdW5uaW5nJGkgPSBhbmltUnVubmluZ1tpXTtcblx0ICAgICAgdmFyIGFjdGl2ZSA9IF9hbmltUnVubmluZyRpLmFjdGl2ZTtcblx0ICAgICAgdmFyIGFuaW1hdGlvblN0ZXAgPSBfYW5pbVJ1bm5pbmckaS5hbmltYXRpb25TdGVwO1xuXHQgICAgICB2YXIgcHJldlByZXZTdGF0ZSA9IF9hbmltUnVubmluZyRpLnByZXZTdGF0ZTtcblx0ICAgICAgdmFyIHByZXZOZXh0U3RhdGUgPSBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGU7XG5cdFxuXHQgICAgICBpZiAoIWFjdGl2ZSkge1xuXHQgICAgICAgIGNvbnRpbnVlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBTZWVtcyBsaWtlIGJlY2F1c2UgdGhlIFRTIHNldHMgZGVzdFZhbHMgYXMgZW50ZXJWYWxzIGZvciB0aGUgZmlyc3Rcblx0ICAgICAgLy8gdGljaywgd2UgbWlnaHQgcmVuZGVyIHRoYXQgdmFsdWUgdHdpY2UuIFdlIHJlbmRlciBpdCBvbmNlLCBjdXJyVmFsdWUgaXNcblx0ICAgICAgLy8gZW50ZXJWYWwgYW5kIGRlc3RWYWwgaXMgZW50ZXJWYWwuIFRoZSBuZXh0IHRpY2sgaXMgZmFzdGVyIHRoYW4gMTZtcyxcblx0ICAgICAgLy8gc28gYWNjdW11bGF0ZWRUaW1lICh3aGljaCB3b3VsZCBiZSBhYm91dCAtMTZtcyBmcm9tIHRoZSBwcmV2aW91cyB0aWNrKVxuXHQgICAgICAvLyBpcyBuZWdhdGl2ZSAoLTE2bXMgKyBhbnkgbnVtYmVyIGxlc3MgdGhhbiAxNm1zIDwgMCkuIFNvIHdlIGp1c3QgcmVuZGVyXG5cdCAgICAgIC8vIHBhcnQgd2F5cyB0b3dhcmRzIHRoZSBuZXh0U3RhdGUsIGJ1dCB0aGF0J3MgZW50ZXJWYWwgc3RpbGwuIFdlIHJlbmRlclxuXHQgICAgICAvLyBzYXkgNzUlIGJldHdlZW4gY3VyclZhbHVlICg9PT0gZW50ZXJWYWwpIGFuZCBkZXN0VmFsdWUgKD09PSBlbnRlclZhbCkuXG5cdCAgICAgIC8vIFNvIHdlIHJlbmRlciB0aGUgc2FtZSB2YWx1ZSBhIHNlY29uZCB0aW1lLlxuXHQgICAgICAvLyBUaGUgc29sdXRpb24gYmVsb3cgaXMgdG8gcmVjYWxjdWxhdGUgdGhlIGRlc3RpbmF0aW9uIHN0YXRlIGV2ZW4gd2hlblxuXHQgICAgICAvLyB5b3UncmUgbW92aW5nIHBhcnRpYWxseSB0b3dhcmRzIGl0LlxuXHQgICAgICBpZiAoYWNjdW11bGF0ZWRUaW1lIDw9IDApIHtcblx0ICAgICAgICBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGUgPSBhbmltYXRpb25TdGVwKHRpbWVTdGVwIC8gMTAwMCwgcHJldlByZXZTdGF0ZSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBmcmFtZU51bWJlcjsgaisrKSB7XG5cdCAgICAgICAgICBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGUgPSBhbmltYXRpb25TdGVwKHRpbWVTdGVwIC8gMTAwMCwgcHJldk5leHRTdGF0ZSk7XG5cdCAgICAgICAgICB2YXIgX3JlZiA9IFtwcmV2TmV4dFN0YXRlLCBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGVdO1xuXHQgICAgICAgICAgYW5pbVJ1bm5pbmdbaV0ucHJldlN0YXRlID0gX3JlZlswXTtcblx0ICAgICAgICAgIHByZXZOZXh0U3RhdGUgPSBfcmVmWzFdO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGFjY3VtdWxhdGVkVGltZSA9IGFjY3VtdWxhdGVkVGltZSAtIGZyYW1lTnVtYmVyICogdGltZVN0ZXA7XG5cdFxuXHQgICAgLy8gUmVuZGVyIGFuZCBmaWx0ZXIgaW4gb25lIGl0ZXJhdGlvbi5cblx0ICAgIHZhciBhbHBoYSA9IDEgKyBhY2N1bXVsYXRlZFRpbWUgLyB0aW1lU3RlcDtcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbVJ1bm5pbmcubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgdmFyIF9hbmltUnVubmluZyRpMiA9IGFuaW1SdW5uaW5nW2ldO1xuXHQgICAgICB2YXIgYW5pbWF0aW9uUmVuZGVyID0gX2FuaW1SdW5uaW5nJGkyLmFuaW1hdGlvblJlbmRlcjtcblx0ICAgICAgdmFyIG5leHRTdGF0ZSA9IF9hbmltUnVubmluZyRpMi5uZXh0U3RhdGU7XG5cdCAgICAgIHZhciBwcmV2U3RhdGUgPSBfYW5pbVJ1bm5pbmckaTIucHJldlN0YXRlO1xuXHRcblx0ICAgICAgLy8gTWlnaHQgbXV0YXRlIGFuaW1SdW5uaW5nLi4uLi4uLi5cblx0ICAgICAgYW5pbWF0aW9uUmVuZGVyKGFscGhhLCBuZXh0U3RhdGUsIHByZXZTdGF0ZSk7XG5cdCAgICB9XG5cdFxuXHQgICAgYW5pbVJ1bm5pbmcgPSBhbmltUnVubmluZy5maWx0ZXIoZnVuY3Rpb24gKF9yZWYyKSB7XG5cdCAgICAgIHZhciBhY3RpdmUgPSBfcmVmMi5hY3RpdmU7XG5cdCAgICAgIHJldHVybiBhY3RpdmU7XG5cdCAgICB9KTtcblx0XG5cdCAgICBpZiAoYW5pbVJ1bm5pbmcubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJhZihsb29wKTtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHN0YXJ0KCkge1xuXHQgICAgaWYgKCFydW5uaW5nKSB7XG5cdCAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuXHQgICAgICBwcmV2VGltZSA9IG5vdygpO1xuXHQgICAgICBhY2N1bXVsYXRlZFRpbWUgPSAwO1xuXHQgICAgICByYWYobG9vcCk7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gZnVuY3Rpb24gc3RhcnRBbmltYXRpb24oc3RhdGUsIGFuaW1hdGlvblN0ZXAsIGFuaW1hdGlvblJlbmRlcikge1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbmltUnVubmluZy5sZW5ndGg7IGkrKykge1xuXHQgICAgICB2YXIgdmFsID0gYW5pbVJ1bm5pbmdbaV07XG5cdCAgICAgIGlmICh2YWwuYW5pbWF0aW9uU3RlcCA9PT0gYW5pbWF0aW9uU3RlcCkge1xuXHQgICAgICAgIHZhbC5hY3RpdmUgPSB0cnVlO1xuXHQgICAgICAgIHZhbC5wcmV2U3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgICBzdGFydCgpO1xuXHQgICAgICAgIHJldHVybiB2YWwuc3RvcDtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIHZhciBuZXdBbmltID0ge1xuXHQgICAgICBhbmltYXRpb25TdGVwOiBhbmltYXRpb25TdGVwLFxuXHQgICAgICBhbmltYXRpb25SZW5kZXI6IGFuaW1hdGlvblJlbmRlcixcblx0ICAgICAgcHJldlN0YXRlOiBzdGF0ZSxcblx0ICAgICAgbmV4dFN0YXRlOiBzdGF0ZSxcblx0ICAgICAgYWN0aXZlOiB0cnVlXG5cdCAgICB9O1xuXHRcblx0ICAgIG5ld0FuaW0uc3RvcCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIG5ld0FuaW0uYWN0aXZlID0gZmFsc2U7XG5cdCAgICB9O1xuXHQgICAgYW5pbVJ1bm5pbmcucHVzaChuZXdBbmltKTtcblx0XG5cdCAgICBzdGFydCgpO1xuXHRcblx0ICAgIHJldHVybiBuZXdBbmltLnN0b3A7XG5cdCAgfTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAxOCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0XG5cdHZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cdFxuXHRleHBvcnRzWydkZWZhdWx0J10gPSBjb21wb25lbnRzO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0dmFyIF9ub1ZlbG9jaXR5ID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMik7XG5cdFxuXHR2YXIgX25vVmVsb2NpdHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbm9WZWxvY2l0eSk7XG5cdFxuXHR2YXIgX2hhc1JlYWNoZWRTdHlsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjApO1xuXHRcblx0dmFyIF9oYXNSZWFjaGVkU3R5bGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFzUmVhY2hlZFN0eWxlKTtcblx0XG5cdHZhciBfbWVyZ2VEaWZmID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7XG5cdFxuXHR2YXIgX21lcmdlRGlmZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZXJnZURpZmYpO1xuXHRcblx0dmFyIF9hbmltYXRpb25Mb29wID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNyk7XG5cdFxuXHR2YXIgX2FuaW1hdGlvbkxvb3AyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYW5pbWF0aW9uTG9vcCk7XG5cdFxuXHR2YXIgX3plcm8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI5KTtcblx0XG5cdHZhciBfemVybzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF96ZXJvKTtcblx0XG5cdHZhciBfdXBkYXRlVHJlZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjgpO1xuXHRcblx0dmFyIF9kZXByZWNhdGVkU3ByaW5nczIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KTtcblx0XG5cdHZhciBfZGVwcmVjYXRlZFNwcmluZ3MzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVwcmVjYXRlZFNwcmluZ3MyKTtcblx0XG5cdHZhciBfc3RyaXBTdHlsZSA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpO1xuXHRcblx0dmFyIF9zdHJpcFN0eWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmlwU3R5bGUpO1xuXHRcblx0dmFyIHN0YXJ0QW5pbWF0aW9uID0gX2FuaW1hdGlvbkxvb3AyWydkZWZhdWx0J10oKTtcblx0XG5cdGZ1bmN0aW9uIG1hcE9iamVjdChmLCBvYmopIHtcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgZm9yICh2YXIga2V5IGluIG9iaikge1xuXHQgICAgaWYgKCFvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIHJldFtrZXldID0gZihvYmpba2V5XSwga2V5KTtcblx0ICB9XG5cdCAgcmV0dXJuIHJldDtcblx0fVxuXHRcblx0ZnVuY3Rpb24gZXZlcnlPYmooZiwgb2JqKSB7XG5cdCAgZm9yICh2YXIga2V5IGluIG9iaikge1xuXHQgICAgaWYgKCFvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIGlmICghZihvYmpba2V5XSwga2V5KSkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdCAgfVxuXHQgIHJldHVybiB0cnVlO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjb21wb25lbnRzKFJlYWN0KSB7XG5cdCAgdmFyIFByb3BUeXBlcyA9IFJlYWN0LlByb3BUeXBlcztcblx0XG5cdCAgdmFyIE1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0ICAgIGRpc3BsYXlOYW1lOiAnTW90aW9uJyxcblx0XG5cdCAgICBwcm9wVHlwZXM6IHtcblx0ICAgICAgLy8gVE9PRDogd2FybiBhZ2FpbnN0IHB1dHRpbmcgYSBjb25maWcgaW4gaGVyZVxuXHQgICAgICBkZWZhdWx0VmFsdWU6IGZ1bmN0aW9uIGRlZmF1bHRWYWx1ZShwcm9wLCBwcm9wTmFtZSkge1xuXHQgICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignU3ByaW5nXFwncyBgZGVmYXVsdFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBkZWZhdWx0U3R5bGVgLiAnICsgJ0l0cyBmb3JtYXQgcmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgY2hhbmdlcyBhcyB3ZWxsLicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZW5kVmFsdWU6IGZ1bmN0aW9uIGVuZFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG5cdCAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdTcHJpbmdcXCdzIGBlbmRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgc3R5bGVgLiBJdHMgZm9ybWF0ICcgKyAncmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgY2hhbmdlcyBhcyB3ZWxsLicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZGVmYXVsdFN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LFxuXHQgICAgICBzdHlsZTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuXHQgICAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxuXHQgICAgfSxcblx0XG5cdCAgICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcblx0ICAgICAgdmFyIF9wcm9wcyA9IHRoaXMucHJvcHM7XG5cdCAgICAgIHZhciBkZWZhdWx0U3R5bGUgPSBfcHJvcHMuZGVmYXVsdFN0eWxlO1xuXHQgICAgICB2YXIgc3R5bGUgPSBfcHJvcHMuc3R5bGU7XG5cdFxuXHQgICAgICB2YXIgY3VycmVudFN0eWxlID0gZGVmYXVsdFN0eWxlIHx8IHN0eWxlO1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIGN1cnJlbnRTdHlsZTogY3VycmVudFN0eWxlLFxuXHQgICAgICAgIGN1cnJlbnRWZWxvY2l0eTogbWFwT2JqZWN0KF96ZXJvMlsnZGVmYXVsdCddLCBjdXJyZW50U3R5bGUpXG5cdCAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcblx0ICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuXHQgICAgfSxcblx0XG5cdCAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKCkge1xuXHQgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIGFuaW1hdGlvblN0ZXA6IGZ1bmN0aW9uIGFuaW1hdGlvblN0ZXAodGltZXN0ZXAsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBjdXJyZW50U3R5bGUgPSBzdGF0ZS5jdXJyZW50U3R5bGU7XG5cdCAgICAgIHZhciBjdXJyZW50VmVsb2NpdHkgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdHk7XG5cdCAgICAgIHZhciBzdHlsZSA9IHRoaXMucHJvcHMuc3R5bGU7XG5cdFxuXHQgICAgICB2YXIgbmV3Q3VycmVudFN0eWxlID0gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFN0eWxlKHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpO1xuXHQgICAgICB2YXIgbmV3Q3VycmVudFZlbG9jaXR5ID0gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFZlbG9jaXR5KHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpO1xuXHRcblx0ICAgICAgLy8gVE9PRDogdGhpcyBpc24ndCBuZWNlc3NhcnkgYW55bW9yZS4gSXQgd2FzIHVzZWQgb25seSBhZ2FpbnN0IGVuZFZhbHVlIGZ1bmNcblx0ICAgICAgaWYgKF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKGN1cnJlbnRWZWxvY2l0eSwgbmV3Q3VycmVudFN0eWxlKSAmJiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXShuZXdDdXJyZW50VmVsb2NpdHksIG5ld0N1cnJlbnRTdHlsZSkpIHtcblx0ICAgICAgICAvLyBjaGVjayBleHBsYW5hdGlvbiBpbiBgTW90aW9uLmFuaW1hdGlvblJlbmRlcmBcblx0ICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTsgLy8gTmFzdHkgc2lkZSBlZmZlY3RzLi4uLlxuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIGN1cnJlbnRTdHlsZTogbmV3Q3VycmVudFN0eWxlLFxuXHQgICAgICAgIGN1cnJlbnRWZWxvY2l0eTogbmV3Q3VycmVudFZlbG9jaXR5XG5cdCAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIHN0b3BBbmltYXRpb246IG51bGwsXG5cdFxuXHQgICAgLy8gdXNlZCBpbiBhbmltYXRpb25SZW5kZXJcblx0ICAgIGhhc1VubW91bnRlZDogZmFsc2UsXG5cdFxuXHQgICAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuXHQgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcblx0ICAgICAgdGhpcy5oYXNVbm1vdW50ZWQgPSB0cnVlO1xuXHQgICAgfSxcblx0XG5cdCAgICBzdGFydEFuaW1hdGluZzogZnVuY3Rpb24gc3RhcnRBbmltYXRpbmcoKSB7XG5cdCAgICAgIC8vIElzIHNtYXJ0IGVub3VnaCB0byBub3Qgc3RhcnQgaXQgdHdpY2Vcblx0ICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uID0gc3RhcnRBbmltYXRpb24odGhpcy5zdGF0ZSwgdGhpcy5hbmltYXRpb25TdGVwLCB0aGlzLmFuaW1hdGlvblJlbmRlcik7XG5cdCAgICB9LFxuXHRcblx0ICAgIGFuaW1hdGlvblJlbmRlcjogZnVuY3Rpb24gYW5pbWF0aW9uUmVuZGVyKGFscGhhLCBuZXh0U3RhdGUsIHByZXZTdGF0ZSkge1xuXHQgICAgICAvLyBgdGhpcy5oYXNVbm1vdW50ZWRgIG1pZ2h0IGJlIHRydWUgaW4gdGhlIGZvbGxvd2luZyBjb25kaXRpb246XG5cdCAgICAgIC8vIHVzZXIgZG9lcyBzb21lIGNoZWNrcyBpbiBgc3R5bGVgIGFuZCBjYWxscyBhbiBvd25lciBoYW5kbGVyXG5cdCAgICAgIC8vIG93bmVyIHNldHMgc3RhdGUgaW4gdGhlIGNhbGxiYWNrLCB0cmlnZ2VyaW5nIGEgcmUtcmVuZGVyXG5cdCAgICAgIC8vIHVubW91bnRzIE1vdGlvblxuXHQgICAgICBpZiAoIXRoaXMuaGFzVW5tb3VudGVkKSB7XG5cdCAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG5cdCAgICAgICAgICBjdXJyZW50U3R5bGU6IF91cGRhdGVUcmVlLmludGVycG9sYXRlVmFsdWUoYWxwaGEsIG5leHRTdGF0ZS5jdXJyZW50U3R5bGUsIHByZXZTdGF0ZS5jdXJyZW50U3R5bGUpLFxuXHQgICAgICAgICAgY3VycmVudFZlbG9jaXR5OiBuZXh0U3RhdGUuY3VycmVudFZlbG9jaXR5XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgIHZhciBzdHJpcHBlZFN0eWxlID0gX3N0cmlwU3R5bGUyWydkZWZhdWx0J10odGhpcy5zdGF0ZS5jdXJyZW50U3R5bGUpO1xuXHQgICAgICB2YXIgcmVuZGVyZWRDaGlsZHJlbiA9IHRoaXMucHJvcHMuY2hpbGRyZW4oc3RyaXBwZWRTdHlsZSk7XG5cdCAgICAgIHJldHVybiByZW5kZXJlZENoaWxkcmVuICYmIFJlYWN0LkNoaWxkcmVuLm9ubHkocmVuZGVyZWRDaGlsZHJlbik7XG5cdCAgICB9XG5cdCAgfSk7XG5cdFxuXHQgIHZhciBTdGFnZ2VyZWRNb3Rpb24gPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgICBkaXNwbGF5TmFtZTogJ1N0YWdnZXJlZE1vdGlvbicsXG5cdFxuXHQgICAgcHJvcFR5cGVzOiB7XG5cdCAgICAgIGRlZmF1bHRTdHlsZTogZnVuY3Rpb24gZGVmYXVsdFN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG5cdCAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdZb3UgZm9yZ290IHRoZSBcInNcIiBmb3IgYFN0YWdnZXJlZE1vdGlvbmBcXCdzIGBkZWZhdWx0U3R5bGVzYC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShwcm9wLCBwcm9wTmFtZSkge1xuXHQgICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignWW91IGZvcmdvdCB0aGUgXCJzXCIgZm9yIGBTdGFnZ2VyZWRNb3Rpb25gXFwncyBgc3R5bGVzYC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGNvbmZpZ3MgaW4gaGVyZVxuXHQgICAgICBkZWZhdWx0U3R5bGVzOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMub2JqZWN0KSxcblx0ICAgICAgc3R5bGVzOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuXHQgICAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxuXHQgICAgfSxcblx0XG5cdCAgICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcblx0ICAgICAgdmFyIF9wcm9wczIgPSB0aGlzLnByb3BzO1xuXHQgICAgICB2YXIgc3R5bGVzID0gX3Byb3BzMi5zdHlsZXM7XG5cdCAgICAgIHZhciBkZWZhdWx0U3R5bGVzID0gX3Byb3BzMi5kZWZhdWx0U3R5bGVzO1xuXHRcblx0ICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBkZWZhdWx0U3R5bGVzID8gZGVmYXVsdFN0eWxlcyA6IHN0eWxlcygpO1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIGN1cnJlbnRTdHlsZXM6IGN1cnJlbnRTdHlsZXMsXG5cdCAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IGN1cnJlbnRTdHlsZXMubWFwKGZ1bmN0aW9uIChzKSB7XG5cdCAgICAgICAgICByZXR1cm4gbWFwT2JqZWN0KF96ZXJvMlsnZGVmYXVsdCddLCBzKTtcblx0ICAgICAgICB9KVxuXHQgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG5cdCAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcygpIHtcblx0ICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuXHQgICAgfSxcblx0XG5cdCAgICBhbmltYXRpb25TdGVwOiBmdW5jdGlvbiBhbmltYXRpb25TdGVwKHRpbWVzdGVwLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHN0YXRlLmN1cnJlbnRTdHlsZXM7XG5cdCAgICAgIHZhciBjdXJyZW50VmVsb2NpdGllcyA9IHN0YXRlLmN1cnJlbnRWZWxvY2l0aWVzO1xuXHRcblx0ICAgICAgdmFyIHN0eWxlcyA9IHRoaXMucHJvcHMuc3R5bGVzKGN1cnJlbnRTdHlsZXMubWFwKF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddKSk7XG5cdFxuXHQgICAgICB2YXIgbmV3Q3VycmVudFN0eWxlcyA9IGN1cnJlbnRTdHlsZXMubWFwKGZ1bmN0aW9uIChjdXJyZW50U3R5bGUsIGkpIHtcblx0ICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFN0eWxlKHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0aWVzW2ldLCBzdHlsZXNbaV0pO1xuXHQgICAgICB9KTtcblx0ICAgICAgdmFyIG5ld0N1cnJlbnRWZWxvY2l0aWVzID0gY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKGN1cnJlbnRTdHlsZSwgaSkge1xuXHQgICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50VmVsb2NpdHkodGltZXN0ZXAsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXRpZXNbaV0sIHN0eWxlc1tpXSk7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgLy8gVE9ETzogaXMgdGhpcyByaWdodD9cblx0ICAgICAgaWYgKGN1cnJlbnRWZWxvY2l0aWVzLmV2ZXJ5KGZ1bmN0aW9uICh2LCBrKSB7XG5cdCAgICAgICAgcmV0dXJuIF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKHYsIGN1cnJlbnRTdHlsZXNba10pO1xuXHQgICAgICB9KSAmJiBuZXdDdXJyZW50VmVsb2NpdGllcy5ldmVyeShmdW5jdGlvbiAodiwgaykge1xuXHQgICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBuZXdDdXJyZW50U3R5bGVzW2tdKTtcblx0ICAgICAgfSkpIHtcblx0ICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBjdXJyZW50U3R5bGVzOiBuZXdDdXJyZW50U3R5bGVzLFxuXHQgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXdDdXJyZW50VmVsb2NpdGllc1xuXHQgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICBzdG9wQW5pbWF0aW9uOiBudWxsLFxuXHRcblx0ICAgIC8vIHVzZWQgaW4gYW5pbWF0aW9uUmVuZGVyXG5cdCAgICBoYXNVbm1vdW50ZWQ6IGZhbHNlLFxuXHRcblx0ICAgIGNvbXBvbmVudFdpbGxVbm1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcblx0ICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG5cdCAgICAgIHRoaXMuaGFzVW5tb3VudGVkID0gdHJ1ZTtcblx0ICAgIH0sXG5cdFxuXHQgICAgc3RhcnRBbmltYXRpbmc6IGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW5nKCkge1xuXHQgICAgICB0aGlzLnN0b3BBbmltYXRpb24gPSBzdGFydEFuaW1hdGlvbih0aGlzLnN0YXRlLCB0aGlzLmFuaW1hdGlvblN0ZXAsIHRoaXMuYW5pbWF0aW9uUmVuZGVyKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgYW5pbWF0aW9uUmVuZGVyOiBmdW5jdGlvbiBhbmltYXRpb25SZW5kZXIoYWxwaGEsIG5leHRTdGF0ZSwgcHJldlN0YXRlKSB7XG5cdCAgICAgIC8vIFNlZSBjb21tZW50IGluIE1vdGlvbi5cblx0ICAgICAgaWYgKCF0aGlzLmhhc1VubW91bnRlZCkge1xuXHQgICAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gbmV4dFN0YXRlLmN1cnJlbnRTdHlsZXMubWFwKGZ1bmN0aW9uIChzdHlsZSwgaSkge1xuXHQgICAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLmludGVycG9sYXRlVmFsdWUoYWxwaGEsIHN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlc1tpXSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG5cdCAgICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuXHQgICAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5leHRTdGF0ZS5jdXJyZW50VmVsb2NpdGllc1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgICB2YXIgc3RyaXBwZWRTdHlsZSA9IHRoaXMuc3RhdGUuY3VycmVudFN0eWxlcy5tYXAoX3N0cmlwU3R5bGUyWydkZWZhdWx0J10pO1xuXHQgICAgICB2YXIgcmVuZGVyZWRDaGlsZHJlbiA9IHRoaXMucHJvcHMuY2hpbGRyZW4oc3RyaXBwZWRTdHlsZSk7XG5cdCAgICAgIHJldHVybiByZW5kZXJlZENoaWxkcmVuICYmIFJlYWN0LkNoaWxkcmVuLm9ubHkocmVuZGVyZWRDaGlsZHJlbik7XG5cdCAgICB9XG5cdCAgfSk7XG5cdFxuXHQgIHZhciBUcmFuc2l0aW9uTW90aW9uID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXHQgICAgZGlzcGxheU5hbWU6ICdUcmFuc2l0aW9uTW90aW9uJyxcblx0XG5cdCAgICBwcm9wVHlwZXM6IHtcblx0ICAgICAgZGVmYXVsdFZhbHVlOiBmdW5jdGlvbiBkZWZhdWx0VmFsdWUocHJvcCwgcHJvcE5hbWUpIHtcblx0ICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcblx0ICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1RyYW5zaXRpb25TcHJpbmdcXCdzIGBkZWZhdWx0VmFsdWVgIGhhcyBiZWVuIGNoYW5nZWQgdG8gJyArICdgZGVmYXVsdFN0eWxlc2AuIEl0cyBmb3JtYXQgcmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgJyArICdjaGFuZ2VzIGFzIHdlbGwuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBlbmRWYWx1ZTogZnVuY3Rpb24gZW5kVmFsdWUocHJvcCwgcHJvcE5hbWUpIHtcblx0ICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcblx0ICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1RyYW5zaXRpb25TcHJpbmdcXCdzIGBlbmRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgc3R5bGVzYC4gJyArICdJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpIGNoYW5nZXMgYXMgd2VsbC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGRlZmF1bHRTdHlsZTogZnVuY3Rpb24gZGVmYXVsdFN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG5cdCAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdZb3UgZm9yZ290IHRoZSBcInNcIiBmb3IgYFRyYW5zaXRpb25Nb3Rpb25gXFwncyBgZGVmYXVsdFN0eWxlc2AuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBzdHlsZTogZnVuY3Rpb24gc3R5bGUocHJvcCwgcHJvcE5hbWUpIHtcblx0ICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcblx0ICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgVHJhbnNpdGlvbk1vdGlvbmBcXCdzIGBzdHlsZXNgLicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLy8gVE9PRDogd2FybiBhZ2FpbnN0IHB1dHRpbmcgY29uZmlncyBpbiBoZXJlXG5cdCAgICAgIGRlZmF1bHRTdHlsZXM6IFByb3BUeXBlcy5vYmplY3RPZihQcm9wVHlwZXMuYW55KSxcblx0ICAgICAgc3R5bGVzOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuYywgUHJvcFR5cGVzLm9iamVjdE9mKFByb3BUeXBlcy5hbnkuaXNSZXF1aXJlZCldKS5pc1JlcXVpcmVkLFxuXHQgICAgICB3aWxsTGVhdmU6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5mdW5jXSksXG5cdCAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGNvbmZpZ3MgaW4gaGVyZVxuXHQgICAgICB3aWxsRW50ZXI6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5mdW5jXSksXG5cdCAgICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG5cdCAgICB9LFxuXHRcblx0ICAgIGdldERlZmF1bHRQcm9wczogZnVuY3Rpb24gZ2V0RGVmYXVsdFByb3BzKCkge1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIHdpbGxFbnRlcjogZnVuY3Rpb24gd2lsbEVudGVyKGtleSwgdmFsdWUpIHtcblx0ICAgICAgICAgIHJldHVybiB2YWx1ZTtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIHdpbGxMZWF2ZTogZnVuY3Rpb24gd2lsbExlYXZlKCkge1xuXHQgICAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcblx0ICAgICAgdmFyIF9wcm9wczMgPSB0aGlzLnByb3BzO1xuXHQgICAgICB2YXIgc3R5bGVzID0gX3Byb3BzMy5zdHlsZXM7XG5cdCAgICAgIHZhciBkZWZhdWx0U3R5bGVzID0gX3Byb3BzMy5kZWZhdWx0U3R5bGVzO1xuXHRcblx0ICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSB1bmRlZmluZWQ7XG5cdCAgICAgIGlmIChkZWZhdWx0U3R5bGVzID09IG51bGwpIHtcblx0ICAgICAgICBpZiAodHlwZW9mIHN0eWxlcyA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgICAgICAgY3VycmVudFN0eWxlcyA9IHN0eWxlcygpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBjdXJyZW50U3R5bGVzID0gc3R5bGVzO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBjdXJyZW50U3R5bGVzID0gZGVmYXVsdFN0eWxlcztcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIGN1cnJlbnRTdHlsZXM6IGN1cnJlbnRTdHlsZXMsXG5cdCAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG1hcE9iamVjdChmdW5jdGlvbiAocykge1xuXHQgICAgICAgICAgcmV0dXJuIG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgcyk7XG5cdCAgICAgICAgfSwgY3VycmVudFN0eWxlcylcblx0ICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuXHQgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKSB7XG5cdCAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgYW5pbWF0aW9uU3RlcDogZnVuY3Rpb24gYW5pbWF0aW9uU3RlcCh0aW1lc3RlcCwgc3RhdGUpIHtcblx0ICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBzdGF0ZS5jdXJyZW50U3R5bGVzO1xuXHQgICAgICB2YXIgY3VycmVudFZlbG9jaXRpZXMgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdGllcztcblx0ICAgICAgdmFyIF9wcm9wczQgPSB0aGlzLnByb3BzO1xuXHQgICAgICB2YXIgc3R5bGVzID0gX3Byb3BzNC5zdHlsZXM7XG5cdCAgICAgIHZhciB3aWxsRW50ZXIgPSBfcHJvcHM0LndpbGxFbnRlcjtcblx0ICAgICAgdmFyIHdpbGxMZWF2ZSA9IF9wcm9wczQud2lsbExlYXZlO1xuXHRcblx0ICAgICAgaWYgKHR5cGVvZiBzdHlsZXMgPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICBzdHlsZXMgPSBzdHlsZXMoY3VycmVudFN0eWxlcyk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIFRPRE86IGh1aD9cblx0ICAgICAgdmFyIG1lcmdlZFN0eWxlcyA9IHN0eWxlczsgLy8gc2V0IG1lcmdlZFN0eWxlcyB0byBzdHlsZXMgYXMgdGhlIGRlZmF1bHRcblx0ICAgICAgdmFyIGhhc05ld0tleSA9IGZhbHNlO1xuXHRcblx0ICAgICAgbWVyZ2VkU3R5bGVzID0gX21lcmdlRGlmZjJbJ2RlZmF1bHQnXShjdXJyZW50U3R5bGVzLCBzdHlsZXMsXG5cdCAgICAgIC8vIFRPRE86IHN0b3AgYWxsb2NhdGluZyBsaWtlIGNyYXp5IGluIHRoaXMgd2hvbGUgY29kZSBwYXRoXG5cdCAgICAgIGZ1bmN0aW9uIChrZXkpIHtcblx0ICAgICAgICB2YXIgcmVzID0gd2lsbExlYXZlKGtleSwgY3VycmVudFN0eWxlc1trZXldLCBzdHlsZXMsIGN1cnJlbnRTdHlsZXMsIGN1cnJlbnRWZWxvY2l0aWVzKTtcblx0ICAgICAgICBpZiAocmVzID09IG51bGwpIHtcblx0ICAgICAgICAgIC8vIEZvciBsZWdhY3kgcmVhc29uLiBXZSB3b24ndCBhbGxvdyByZXR1cm5pbmcgbnVsbCBzb29uXG5cdCAgICAgICAgICAvLyBUT0RPOiByZW1vdmUsIGFmdGVyIG5leHQgcmVsZWFzZVxuXHQgICAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAoX25vVmVsb2NpdHkyWydkZWZhdWx0J10oY3VycmVudFZlbG9jaXRpZXNba2V5XSwgY3VycmVudFN0eWxlc1trZXldKSAmJiBfaGFzUmVhY2hlZFN0eWxlMlsnZGVmYXVsdCddKGN1cnJlbnRTdHlsZXNba2V5XSwgcmVzKSkge1xuXHQgICAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiByZXM7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgT2JqZWN0LmtleXMobWVyZ2VkU3R5bGVzKS5maWx0ZXIoZnVuY3Rpb24gKGtleSkge1xuXHQgICAgICAgIHJldHVybiAhY3VycmVudFN0eWxlcy5oYXNPd25Qcm9wZXJ0eShrZXkpO1xuXHQgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcblx0ICAgICAgICB2YXIgX2V4dGVuZHMyLCBfZXh0ZW5kczM7XG5cdFxuXHQgICAgICAgIGhhc05ld0tleSA9IHRydWU7XG5cdCAgICAgICAgdmFyIGVudGVyU3R5bGUgPSB3aWxsRW50ZXIoa2V5LCBtZXJnZWRTdHlsZXNba2V5XSwgc3R5bGVzLCBjdXJyZW50U3R5bGVzLCBjdXJyZW50VmVsb2NpdGllcyk7XG5cdFxuXHQgICAgICAgIC8vIFdlIGNhbiBtdXRhdGUgdGhpcyBoZXJlIGJlY2F1c2UgbWVyZ2VEaWZmIHJldHVybnMgYSBuZXcgT2JqXG5cdCAgICAgICAgbWVyZ2VkU3R5bGVzW2tleV0gPSBlbnRlclN0eWxlO1xuXHRcblx0ICAgICAgICBjdXJyZW50U3R5bGVzID0gX2V4dGVuZHMoe30sIGN1cnJlbnRTdHlsZXMsIChfZXh0ZW5kczIgPSB7fSwgX2V4dGVuZHMyW2tleV0gPSBlbnRlclN0eWxlLCBfZXh0ZW5kczIpKTtcblx0ICAgICAgICBjdXJyZW50VmVsb2NpdGllcyA9IF9leHRlbmRzKHt9LCBjdXJyZW50VmVsb2NpdGllcywgKF9leHRlbmRzMyA9IHt9LCBfZXh0ZW5kczNba2V5XSA9IG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgZW50ZXJTdHlsZSksIF9leHRlbmRzMykpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHZhciBuZXdDdXJyZW50U3R5bGVzID0gbWFwT2JqZWN0KGZ1bmN0aW9uIChtZXJnZWRTdHlsZSwga2V5KSB7XG5cdCAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRTdHlsZSh0aW1lc3RlcCwgY3VycmVudFN0eWxlc1trZXldLCBjdXJyZW50VmVsb2NpdGllc1trZXldLCBtZXJnZWRTdHlsZSk7XG5cdCAgICAgIH0sIG1lcmdlZFN0eWxlcyk7XG5cdCAgICAgIHZhciBuZXdDdXJyZW50VmVsb2NpdGllcyA9IG1hcE9iamVjdChmdW5jdGlvbiAobWVyZ2VkU3R5bGUsIGtleSkge1xuXHQgICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50VmVsb2NpdHkodGltZXN0ZXAsIGN1cnJlbnRTdHlsZXNba2V5XSwgY3VycmVudFZlbG9jaXRpZXNba2V5XSwgbWVyZ2VkU3R5bGUpO1xuXHQgICAgICB9LCBtZXJnZWRTdHlsZXMpO1xuXHRcblx0ICAgICAgaWYgKCFoYXNOZXdLZXkgJiYgZXZlcnlPYmooZnVuY3Rpb24gKHYsIGspIHtcblx0ICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgY3VycmVudFN0eWxlc1trXSk7XG5cdCAgICAgIH0sIGN1cnJlbnRWZWxvY2l0aWVzKSAmJiBldmVyeU9iaihmdW5jdGlvbiAodiwgaykge1xuXHQgICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBuZXdDdXJyZW50U3R5bGVzW2tdKTtcblx0ICAgICAgfSwgbmV3Q3VycmVudFZlbG9jaXRpZXMpKSB7XG5cdCAgICAgICAgLy8gY2hlY2sgZXhwbGFuYXRpb24gaW4gYE1vdGlvbi5hbmltYXRpb25SZW5kZXJgXG5cdCAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7IC8vIE5hc3R5IHNpZGUgZWZmZWN0cy4uLi5cblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBjdXJyZW50U3R5bGVzOiBuZXdDdXJyZW50U3R5bGVzLFxuXHQgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXdDdXJyZW50VmVsb2NpdGllc1xuXHQgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICBzdG9wQW5pbWF0aW9uOiBudWxsLFxuXHRcblx0ICAgIC8vIHVzZWQgaW4gYW5pbWF0aW9uUmVuZGVyXG5cdCAgICBoYXNVbm1vdW50ZWQ6IGZhbHNlLFxuXHRcblx0ICAgIGNvbXBvbmVudFdpbGxVbm1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcblx0ICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG5cdCAgICAgIHRoaXMuaGFzVW5tb3VudGVkID0gdHJ1ZTtcblx0ICAgIH0sXG5cdFxuXHQgICAgc3RhcnRBbmltYXRpbmc6IGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW5nKCkge1xuXHQgICAgICB0aGlzLnN0b3BBbmltYXRpb24gPSBzdGFydEFuaW1hdGlvbih0aGlzLnN0YXRlLCB0aGlzLmFuaW1hdGlvblN0ZXAsIHRoaXMuYW5pbWF0aW9uUmVuZGVyKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgYW5pbWF0aW9uUmVuZGVyOiBmdW5jdGlvbiBhbmltYXRpb25SZW5kZXIoYWxwaGEsIG5leHRTdGF0ZSwgcHJldlN0YXRlKSB7XG5cdCAgICAgIC8vIFNlZSBjb21tZW50IGluIE1vdGlvbi5cblx0ICAgICAgaWYgKCF0aGlzLmhhc1VubW91bnRlZCkge1xuXHQgICAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gbWFwT2JqZWN0KGZ1bmN0aW9uIChzdHlsZSwga2V5KSB7XG5cdCAgICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUuaW50ZXJwb2xhdGVWYWx1ZShhbHBoYSwgc3R5bGUsIHByZXZTdGF0ZS5jdXJyZW50U3R5bGVzW2tleV0pO1xuXHQgICAgICAgIH0sIG5leHRTdGF0ZS5jdXJyZW50U3R5bGVzKTtcblx0ICAgICAgICB0aGlzLnNldFN0YXRlKHtcblx0ICAgICAgICAgIGN1cnJlbnRTdHlsZXM6IGN1cnJlbnRTdHlsZXMsXG5cdCAgICAgICAgICBjdXJyZW50VmVsb2NpdGllczogbmV4dFN0YXRlLmN1cnJlbnRWZWxvY2l0aWVzXG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgIHZhciBzdHJpcHBlZFN0eWxlID0gbWFwT2JqZWN0KF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddLCB0aGlzLnN0YXRlLmN1cnJlbnRTdHlsZXMpO1xuXHQgICAgICB2YXIgcmVuZGVyZWRDaGlsZHJlbiA9IHRoaXMucHJvcHMuY2hpbGRyZW4oc3RyaXBwZWRTdHlsZSk7XG5cdCAgICAgIHJldHVybiByZW5kZXJlZENoaWxkcmVuICYmIFJlYWN0LkNoaWxkcmVuLm9ubHkocmVuZGVyZWRDaGlsZHJlbik7XG5cdCAgICB9XG5cdCAgfSk7XG5cdFxuXHQgIHZhciBfZGVwcmVjYXRlZFNwcmluZ3MgPSBfZGVwcmVjYXRlZFNwcmluZ3MzWydkZWZhdWx0J10oUmVhY3QpO1xuXHRcblx0ICB2YXIgU3ByaW5nID0gX2RlcHJlY2F0ZWRTcHJpbmdzLlNwcmluZztcblx0ICB2YXIgVHJhbnNpdGlvblNwcmluZyA9IF9kZXByZWNhdGVkU3ByaW5ncy5UcmFuc2l0aW9uU3ByaW5nO1xuXHRcblx0ICByZXR1cm4geyBTcHJpbmc6IFNwcmluZywgVHJhbnNpdGlvblNwcmluZzogVHJhbnNpdGlvblNwcmluZywgTW90aW9uOiBNb3Rpb24sIFN0YWdnZXJlZE1vdGlvbjogU3RhZ2dlcmVkTW90aW9uLCBUcmFuc2l0aW9uTW90aW9uOiBUcmFuc2l0aW9uTW90aW9uIH07XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogMTkgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IGRlcHJlY2F0ZWRTcHJpbmdzO1xuXHR2YXIgaGFzV2FybmVkRm9yU3ByaW5nID0ge307XG5cdHZhciBoYXNXYXJuZWRGb3JUcmFuc2l0aW9uU3ByaW5nID0ge307XG5cdFxuXHRmdW5jdGlvbiBkZXByZWNhdGVkU3ByaW5ncyhSZWFjdCkge1xuXHQgIHZhciBTcHJpbmcgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgICBkaXNwbGF5TmFtZTogJ1NwcmluZycsXG5cdFxuXHQgICAgY29tcG9uZW50V2lsbE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQoKSB7XG5cdCAgICAgIGlmIChmYWxzZSkge1xuXHQgICAgICAgIHZhciBvd25lck5hbWUgPSB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lciAmJiB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lci5nZXROYW1lKCk7XG5cdCAgICAgICAgaWYgKCFoYXNXYXJuZWRGb3JTcHJpbmdbb3duZXJOYW1lXSkge1xuXHQgICAgICAgICAgaGFzV2FybmVkRm9yU3ByaW5nW293bmVyTmFtZV0gPSB0cnVlO1xuXHQgICAgICAgICAgY29uc29sZS5lcnJvcignU3ByaW5nICh1c2VkIGluICVzcmVuZGVyKSBoYXMgbm93IGJlZW4gcmVuYW1lZCB0byBNb3Rpb24uICcgKyAnUGxlYXNlIHNlZSB0aGUgcmVsZWFzZSBub3RlIGZvciB0aGUgdXBncmFkZSBwYXRoLiBUaGFuayB5b3UhJywgb3duZXJOYW1lID8gb3duZXJOYW1lICsgJ1xcJ3MgJyA6ICdSZWFjdC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgIHJldHVybiBudWxsO1xuXHQgICAgfVxuXHQgIH0pO1xuXHRcblx0ICB2YXIgVHJhbnNpdGlvblNwcmluZyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0ICAgIGRpc3BsYXlOYW1lOiAnVHJhbnNpdGlvblNwcmluZycsXG5cdFxuXHQgICAgY29tcG9uZW50V2lsbE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQoKSB7XG5cdCAgICAgIGlmIChmYWxzZSkge1xuXHQgICAgICAgIHZhciBvd25lck5hbWUgPSB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lciAmJiB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lci5nZXROYW1lKCk7XG5cdCAgICAgICAgaWYgKCFoYXNXYXJuZWRGb3JUcmFuc2l0aW9uU3ByaW5nW293bmVyTmFtZV0pIHtcblx0ICAgICAgICAgIGhhc1dhcm5lZEZvclRyYW5zaXRpb25TcHJpbmdbb3duZXJOYW1lXSA9IHRydWU7XG5cdCAgICAgICAgICBjb25zb2xlLmVycm9yKCdUcmFuc2l0aW9uU3ByaW5nICh1c2VkIGluICVzcmVuZGVyKSBoYXMgbm93IGJlZW4gcmVuYW1lZCB0byAnICsgJ1RyYW5zaXRpb25Nb3Rpb24uIFBsZWFzZSBzZWUgdGhlIHJlbGVhc2Ugbm90ZSBmb3IgdGhlIHVwZ3JhZGUgJyArICdwYXRoLiBUaGFuayB5b3UhJywgb3duZXJOYW1lID8gb3duZXJOYW1lICsgJ1xcJ3MgJyA6ICdSZWFjdC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgIHJldHVybiBudWxsO1xuXHQgICAgfVxuXHQgIH0pO1xuXHRcblx0ICByZXR1cm4geyBTcHJpbmc6IFNwcmluZywgVHJhbnNpdGlvblNwcmluZzogVHJhbnNpdGlvblNwcmluZyB9O1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDIwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gaGFzUmVhY2hlZFN0eWxlO1xuXHRcblx0ZnVuY3Rpb24gaGFzUmVhY2hlZFN0eWxlKGN1cnJlbnRTdHlsZSwgc3R5bGUpIHtcblx0ICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcblx0ICAgIGlmICghc3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50U3R5bGVba2V5XTtcblx0ICAgIHZhciBkZXN0VmFsdWUgPSBzdHlsZVtrZXldO1xuXHQgICAgaWYgKCFkZXN0VmFsdWUuY29uZmlnKSB7XG5cdCAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWdcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICBpZiAoY3VycmVudFZhbHVlLmNvbmZpZyAmJiBjdXJyZW50VmFsdWUudmFsICE9PSBkZXN0VmFsdWUudmFsKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0ICAgIGlmICghY3VycmVudFZhbHVlLmNvbmZpZyAmJiBjdXJyZW50VmFsdWUgIT09IGRlc3RWYWx1ZS52YWwpIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHRydWU7XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiAyMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0Ly8gdGhpcyBmdW5jdGlvbiBpcyBhbGxvY2F0aW9uLWxlc3MgdGhhbmtzIHRvIGJhYmVsLCB3aGljaCB0cmFuc2Zvcm1zIHRoZSB0YWlsXG5cdC8vIGNhbGxzIGludG8gbG9vcHNcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IG1lcmdlRGlmZjtcblx0ZnVuY3Rpb24gbWVyZ2VEaWZmQXJyKF94LCBfeDIsIF94MywgX3g0LCBfeDUsIF94NiwgX3g3KSB7XG5cdCAgdmFyIF9hZ2FpbiA9IHRydWU7XG5cdFxuXHQgIF9mdW5jdGlvbjogd2hpbGUgKF9hZ2Fpbikge1xuXHQgICAgdmFyIGFyckEgPSBfeCxcblx0ICAgICAgICBhcnJCID0gX3gyLFxuXHQgICAgICAgIGNvbGxCID0gX3gzLFxuXHQgICAgICAgIGluZGV4QSA9IF94NCxcblx0ICAgICAgICBpbmRleEIgPSBfeDUsXG5cdCAgICAgICAgb25SZW1vdmUgPSBfeDYsXG5cdCAgICAgICAgYWNjdW0gPSBfeDc7XG5cdCAgICBlbmRBID0gZW5kQiA9IGtleUEgPSBrZXlCID0gZmlsbCA9IGZpbGwgPSB1bmRlZmluZWQ7XG5cdCAgICBfYWdhaW4gPSBmYWxzZTtcblx0XG5cdCAgICB2YXIgZW5kQSA9IGluZGV4QSA9PT0gYXJyQS5sZW5ndGg7XG5cdCAgICB2YXIgZW5kQiA9IGluZGV4QiA9PT0gYXJyQi5sZW5ndGg7XG5cdCAgICB2YXIga2V5QSA9IGFyckFbaW5kZXhBXTtcblx0ICAgIHZhciBrZXlCID0gYXJyQltpbmRleEJdO1xuXHQgICAgaWYgKGVuZEEgJiYgZW5kQikge1xuXHQgICAgICAvLyByZXR1cm5pbmcgbnVsbCBoZXJlLCBvdGhlcndpc2UgbGludCBjb21wbGFpbnMgdGhhdCB3ZSdyZSBub3QgZXhwZWN0aW5nXG5cdCAgICAgIC8vIGEgcmV0dXJuIHZhbHVlIGluIHN1YnNlcXVlbnQgY2FsbHMuIFdlIGtub3cgd2hhdCB3ZSdyZSBkb2luZy5cblx0ICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKGVuZEEpIHtcblx0ICAgICAgYWNjdW1ba2V5Ql0gPSBjb2xsQltrZXlCXTtcblx0ICAgICAgX3ggPSBhcnJBO1xuXHQgICAgICBfeDIgPSBhcnJCO1xuXHQgICAgICBfeDMgPSBjb2xsQjtcblx0ICAgICAgX3g0ID0gaW5kZXhBO1xuXHQgICAgICBfeDUgPSBpbmRleEIgKyAxO1xuXHQgICAgICBfeDYgPSBvblJlbW92ZTtcblx0ICAgICAgX3g3ID0gYWNjdW07XG5cdCAgICAgIF9hZ2FpbiA9IHRydWU7XG5cdCAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoZW5kQikge1xuXHQgICAgICB2YXIgZmlsbCA9IG9uUmVtb3ZlKGtleUEpO1xuXHQgICAgICBpZiAoZmlsbCAhPSBudWxsKSB7XG5cdCAgICAgICAgYWNjdW1ba2V5QV0gPSBmaWxsO1xuXHQgICAgICB9XG5cdCAgICAgIF94ID0gYXJyQTtcblx0ICAgICAgX3gyID0gYXJyQjtcblx0ICAgICAgX3gzID0gY29sbEI7XG5cdCAgICAgIF94NCA9IGluZGV4QSArIDE7XG5cdCAgICAgIF94NSA9IGluZGV4Qjtcblx0ICAgICAgX3g2ID0gb25SZW1vdmU7XG5cdCAgICAgIF94NyA9IGFjY3VtO1xuXHQgICAgICBfYWdhaW4gPSB0cnVlO1xuXHQgICAgICBjb250aW51ZSBfZnVuY3Rpb247XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKGtleUEgPT09IGtleUIpIHtcblx0ICAgICAgYWNjdW1ba2V5QV0gPSBjb2xsQltrZXlBXTtcblx0ICAgICAgX3ggPSBhcnJBO1xuXHQgICAgICBfeDIgPSBhcnJCO1xuXHQgICAgICBfeDMgPSBjb2xsQjtcblx0ICAgICAgX3g0ID0gaW5kZXhBICsgMTtcblx0ICAgICAgX3g1ID0gaW5kZXhCICsgMTtcblx0ICAgICAgX3g2ID0gb25SZW1vdmU7XG5cdCAgICAgIF94NyA9IGFjY3VtO1xuXHQgICAgICBfYWdhaW4gPSB0cnVlO1xuXHQgICAgICBjb250aW51ZSBfZnVuY3Rpb247XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKCFjb2xsQi5oYXNPd25Qcm9wZXJ0eShrZXlBKSkge1xuXHQgICAgICB2YXIgZmlsbCA9IG9uUmVtb3ZlKGtleUEpO1xuXHQgICAgICBpZiAoZmlsbCAhPSBudWxsKSB7XG5cdCAgICAgICAgYWNjdW1ba2V5QV0gPSBmaWxsO1xuXHQgICAgICB9XG5cdCAgICAgIF94ID0gYXJyQTtcblx0ICAgICAgX3gyID0gYXJyQjtcblx0ICAgICAgX3gzID0gY29sbEI7XG5cdCAgICAgIF94NCA9IGluZGV4QSArIDE7XG5cdCAgICAgIF94NSA9IGluZGV4Qjtcblx0ICAgICAgX3g2ID0gb25SZW1vdmU7XG5cdCAgICAgIF94NyA9IGFjY3VtO1xuXHQgICAgICBfYWdhaW4gPSB0cnVlO1xuXHQgICAgICBjb250aW51ZSBfZnVuY3Rpb247XG5cdCAgICB9XG5cdFxuXHQgICAgX3ggPSBhcnJBO1xuXHQgICAgX3gyID0gYXJyQjtcblx0ICAgIF94MyA9IGNvbGxCO1xuXHQgICAgX3g0ID0gaW5kZXhBICsgMTtcblx0ICAgIF94NSA9IGluZGV4Qjtcblx0ICAgIF94NiA9IG9uUmVtb3ZlO1xuXHQgICAgX3g3ID0gYWNjdW07XG5cdCAgICBfYWdhaW4gPSB0cnVlO1xuXHQgICAgY29udGludWUgX2Z1bmN0aW9uO1xuXHQgIH1cblx0fVxuXHRcblx0ZnVuY3Rpb24gbWVyZ2VEaWZmKGEsIGIsIG9uUmVtb3ZlKSB7XG5cdCAgdmFyIHJldCA9IHt9O1xuXHQgIC8vIGlmIGFueW9uZSBjYW4gbWFrZSB0aGlzIHdvcmsgd2l0aG91dCBhbGxvY2F0aW5nIHRoZSBhcnJheXMgaGVyZSwgd2UnbGxcblx0ICAvLyBnaXZlIHlvdSBhIG1lZGFsXG5cdCAgbWVyZ2VEaWZmQXJyKE9iamVjdC5rZXlzKGEpLCBPYmplY3Qua2V5cyhiKSwgYiwgMCwgMCwgb25SZW1vdmUsIHJldCk7XG5cdCAgcmV0dXJuIHJldDtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDIyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvLyBjdXJyZW50U3R5bGUga2VlcHMgdGhlIGluZm8gYWJvdXQgd2hldGhlciBhIHByb3AgaXMgY29uZmlndXJlZCBhcyBhIHNwcmluZ1xuXHQvLyBvciBpZiBpdCdzIGp1c3QgYSByYW5kb20gcHJvcCB0aGF0IGhhcHBlbnMgdG8gYmUgcHJlc2VudCBvbiB0aGUgc3R5bGVcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IG5vVmVsb2NpdHk7XG5cdFxuXHRmdW5jdGlvbiBub1ZlbG9jaXR5KGN1cnJlbnRWZWxvY2l0eSwgY3VycmVudFN0eWxlKSB7XG5cdCAgZm9yICh2YXIga2V5IGluIGN1cnJlbnRWZWxvY2l0eSkge1xuXHQgICAgaWYgKCFjdXJyZW50VmVsb2NpdHkuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIGlmIChjdXJyZW50U3R5bGVba2V5XS5jb25maWcgJiYgY3VycmVudFZlbG9jaXR5W2tleV0gIT09IDApIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHQgIH1cblx0ICByZXR1cm4gdHJ1ZTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDIzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBfY29tcG9uZW50czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTtcblx0XG5cdHZhciBfY29tcG9uZW50czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRzMik7XG5cdFxuXHR2YXIgX3Jlb3JkZXJLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNCk7XG5cdFxuXHR2YXIgX3Jlb3JkZXJLZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Jlb3JkZXJLZXlzKTtcblx0XG5cdHZhciBfY29tcG9uZW50cyA9IF9jb21wb25lbnRzM1snZGVmYXVsdCddKF9yZWFjdDJbJ2RlZmF1bHQnXSk7XG5cdFxuXHR2YXIgU3ByaW5nID0gX2NvbXBvbmVudHMuU3ByaW5nO1xuXHR2YXIgVHJhbnNpdGlvblNwcmluZyA9IF9jb21wb25lbnRzLlRyYW5zaXRpb25TcHJpbmc7XG5cdHZhciBNb3Rpb24gPSBfY29tcG9uZW50cy5Nb3Rpb247XG5cdHZhciBTdGFnZ2VyZWRNb3Rpb24gPSBfY29tcG9uZW50cy5TdGFnZ2VyZWRNb3Rpb247XG5cdHZhciBUcmFuc2l0aW9uTW90aW9uID0gX2NvbXBvbmVudHMuVHJhbnNpdGlvbk1vdGlvbjtcblx0ZXhwb3J0cy5TcHJpbmcgPSBTcHJpbmc7XG5cdGV4cG9ydHMuVHJhbnNpdGlvblNwcmluZyA9IFRyYW5zaXRpb25TcHJpbmc7XG5cdGV4cG9ydHMuTW90aW9uID0gTW90aW9uO1xuXHRleHBvcnRzLlN0YWdnZXJlZE1vdGlvbiA9IFN0YWdnZXJlZE1vdGlvbjtcblx0ZXhwb3J0cy5UcmFuc2l0aW9uTW90aW9uID0gVHJhbnNpdGlvbk1vdGlvbjtcblx0XG5cdHZhciBfc3ByaW5nMiA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpO1xuXHRcblx0dmFyIF9zcHJpbmczID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ByaW5nMik7XG5cdFxuXHRleHBvcnRzLnNwcmluZyA9IF9zcHJpbmczWydkZWZhdWx0J107XG5cdFxuXHR2YXIgX3ByZXNldHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdHZhciBfcHJlc2V0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcmVzZXRzMik7XG5cdFxuXHRleHBvcnRzLnByZXNldHMgPSBfcHJlc2V0czNbJ2RlZmF1bHQnXTtcblx0dmFyIHV0aWxzID0ge1xuXHQgIHJlb3JkZXJLZXlzOiBfcmVvcmRlcktleXMyWydkZWZhdWx0J11cblx0fTtcblx0ZXhwb3J0cy51dGlscyA9IHV0aWxzO1xuXG4vKioqLyB9LFxuLyogMjQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSByZW9yZGVyS2V5cztcblx0XG5cdGZ1bmN0aW9uIHJlb3JkZXJLZXlzKG9iaiwgZikge1xuXHQgIHZhciBuZXdLZXlzID0gZihPYmplY3Qua2V5cyhvYmopKTtcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgZm9yICh2YXIgaSA9IDA7IGkgPCBuZXdLZXlzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICB2YXIga2V5ID0gbmV3S2V5c1tpXTtcblx0ICAgIHJldFtrZXldID0gb2JqW2tleV07XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gcmV0O1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogMjUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IHNwcmluZztcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdHZhciBfcHJlc2V0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR2YXIgX3ByZXNldHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJlc2V0cyk7XG5cdFxuXHQvLyBpbnN0ZWFkIG9mIGV4cG9zaW5nIHt2YWw6IGJsYSwgY29uZmlnOiBibGF9LCB1c2UgYSBoZWxwZXJcblx0XG5cdGZ1bmN0aW9uIHNwcmluZyh2YWwpIHtcblx0ICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gX3ByZXNldHMyWydkZWZhdWx0J10ubm9Xb2JibGUgOiBhcmd1bWVudHNbMV07XG5cdFxuXHQgIHJldHVybiB7IHZhbDogdmFsLCBjb25maWc6IGNvbmZpZyB9O1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDI2ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gc3RlcHBlcjtcblx0dmFyIGVycm9yTWFyZ2luID0gMC4wMDAxO1xuXHRcblx0ZnVuY3Rpb24gc3RlcHBlcihmcmFtZVJhdGUsIHgsIHYsIGRlc3RYLCBrLCBiKSB7XG5cdCAgLy8gU3ByaW5nIHN0aWZmbmVzcywgaW4ga2cgLyBzXjJcblx0XG5cdCAgLy8gZm9yIGFuaW1hdGlvbnMsIGRlc3RYIGlzIHJlYWxseSBzcHJpbmcgbGVuZ3RoIChzcHJpbmcgYXQgcmVzdCkuIGluaXRpYWxcblx0ICAvLyBwb3NpdGlvbiBpcyBjb25zaWRlcmVkIGFzIHRoZSBzdHJldGNoZWQvY29tcHJlc3NlZCBwb3NpdGlvbiBvZiBhIHNwcmluZ1xuXHQgIHZhciBGc3ByaW5nID0gLWsgKiAoeCAtIGRlc3RYKTtcblx0XG5cdCAgLy8gRGFtcGluZywgaW4ga2cgLyBzXG5cdCAgdmFyIEZkYW1wZXIgPSAtYiAqIHY7XG5cdFxuXHQgIC8vIHVzdWFsbHkgd2UgcHV0IG1hc3MgaGVyZSwgYnV0IGZvciBhbmltYXRpb24gcHVycG9zZXMsIHNwZWNpZnlpbmcgbWFzcyBpcyBhXG5cdCAgLy8gYml0IHJlZHVuZGFudC4geW91IGNvdWxkIHNpbXBseSBhZGp1c3QgayBhbmQgYiBhY2NvcmRpbmdseVxuXHQgIC8vIGxldCBhID0gKEZzcHJpbmcgKyBGZGFtcGVyKSAvIG1hc3M7XG5cdCAgdmFyIGEgPSBGc3ByaW5nICsgRmRhbXBlcjtcblx0XG5cdCAgdmFyIG5ld1YgPSB2ICsgYSAqIGZyYW1lUmF0ZTtcblx0ICB2YXIgbmV3WCA9IHggKyBuZXdWICogZnJhbWVSYXRlO1xuXHRcblx0ICBpZiAoTWF0aC5hYnMobmV3ViAtIHYpIDwgZXJyb3JNYXJnaW4gJiYgTWF0aC5hYnMobmV3WCAtIHgpIDwgZXJyb3JNYXJnaW4pIHtcblx0ICAgIHJldHVybiBbZGVzdFgsIDBdO1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIFtuZXdYLCBuZXdWXTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDI3ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvLyB0dXJuIHt4OiB7dmFsOiAxLCBjb25maWc6IFsxLCAyXX0sIHk6IDJ9IGludG8ge3g6IDEsIHk6IDJ9XG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBzdHJpcFN0eWxlO1xuXHRcblx0ZnVuY3Rpb24gc3RyaXBTdHlsZShzdHlsZSkge1xuXHQgIHZhciByZXQgPSB7fTtcblx0ICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcblx0ICAgIGlmICghc3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIHJldFtrZXldID0gc3R5bGVba2V5XS52YWwgPT0gbnVsbCA/IHN0eWxlW2tleV0gOiBzdHlsZVtrZXldLnZhbDtcblx0ICB9XG5cdCAgcmV0dXJuIHJldDtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDI4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzLmludGVycG9sYXRlVmFsdWUgPSBpbnRlcnBvbGF0ZVZhbHVlO1xuXHRleHBvcnRzLnVwZGF0ZUN1cnJlbnRTdHlsZSA9IHVwZGF0ZUN1cnJlbnRTdHlsZTtcblx0ZXhwb3J0cy51cGRhdGVDdXJyZW50VmVsb2NpdHkgPSB1cGRhdGVDdXJyZW50VmVsb2NpdHk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX3N0ZXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTtcblx0XG5cdHZhciBfc3RlcHBlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGVwcGVyKTtcblx0XG5cdC8vIFRPRE86IHJlZmFjdG9yIGNvbW1vbiBsb2dpYyB3aXRoIHVwZGF0ZUN1cnJWYWx1ZSBhbmQgdXBkYXRlQ3VyclZlbG9jaXR5XG5cdFxuXHRmdW5jdGlvbiBpbnRlcnBvbGF0ZVZhbHVlKGFscGhhLCBuZXh0U3R5bGUsIHByZXZTdHlsZSkge1xuXHQgIC8vIG1pZ2h0IGJlIHVzZWQgYnkgYSBUcmFuc2l0aW9uTW90aW9uLCB3aGVyZSBwcmV2U3R5bGUgbWlnaHQgbm90IGV4aXN0IGFueW1vcmVcblx0ICBpZiAoIXByZXZTdHlsZSkge1xuXHQgICAgcmV0dXJuIG5leHRTdHlsZTtcblx0ICB9XG5cdFxuXHQgIHZhciByZXQgPSB7fTtcblx0ICBmb3IgKHZhciBrZXkgaW4gbmV4dFN0eWxlKSB7XG5cdCAgICBpZiAoIW5leHRTdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmICghbmV4dFN0eWxlW2tleV0uY29uZmlnKSB7XG5cdCAgICAgIHJldFtrZXldID0gbmV4dFN0eWxlW2tleV07XG5cdCAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWcsIG5vdCBzb21ldGhpbmcgd2Ugd2FudCB0byBpbnRlcnBvbGF0ZVxuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIHZhciBwcmV2VmFsdWUgPSBwcmV2U3R5bGVba2V5XS5jb25maWcgPyBwcmV2U3R5bGVba2V5XS52YWwgOiBwcmV2U3R5bGVba2V5XTtcblx0ICAgIHJldFtrZXldID0ge1xuXHQgICAgICB2YWw6IG5leHRTdHlsZVtrZXldLnZhbCAqIGFscGhhICsgcHJldlZhbHVlICogKDEgLSBhbHBoYSksXG5cdCAgICAgIGNvbmZpZzogbmV4dFN0eWxlW2tleV0uY29uZmlnXG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHJldDtcblx0fVxuXHRcblx0Ly8gVE9ETzogcmVmYWN0b3IgY29tbW9uIGxvZ2ljIHdpdGggdXBkYXRlQ3VycmVudFZlbG9jaXR5XG5cdFxuXHRmdW5jdGlvbiB1cGRhdGVDdXJyZW50U3R5bGUoZnJhbWVSYXRlLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpIHtcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgZm9yICh2YXIga2V5IGluIHN0eWxlKSB7XG5cdCAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICBpZiAoIXN0eWxlW2tleV0uY29uZmlnKSB7XG5cdCAgICAgIHJldFtrZXldID0gc3R5bGVba2V5XTtcblx0ICAgICAgLy8gbm90IGEgc3ByaW5nIGNvbmZpZywgbm90IHNvbWV0aGluZyB3ZSB3YW50IHRvIGludGVycG9sYXRlXG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgdmFyIF9zdHlsZSRrZXkkY29uZmlnID0gc3R5bGVba2V5XS5jb25maWc7XG5cdCAgICB2YXIgayA9IF9zdHlsZSRrZXkkY29uZmlnWzBdO1xuXHQgICAgdmFyIGIgPSBfc3R5bGUka2V5JGNvbmZpZ1sxXTtcblx0XG5cdCAgICB2YXIgdmFsID0gX3N0ZXBwZXIyWydkZWZhdWx0J10oZnJhbWVSYXRlLFxuXHQgICAgLy8gbWlnaHQgaGF2ZSBiZWVuIGEgbm9uLXNwcmluZ2VkIHByb3AgdGhhdCBqdXN0IGJlY2FtZSBvbmVcblx0ICAgIGN1cnJlbnRTdHlsZVtrZXldLnZhbCA9PSBudWxsID8gY3VycmVudFN0eWxlW2tleV0gOiBjdXJyZW50U3R5bGVba2V5XS52YWwsIGN1cnJlbnRWZWxvY2l0eVtrZXldLCBzdHlsZVtrZXldLnZhbCwgaywgYilbMF07XG5cdCAgICByZXRba2V5XSA9IHtcblx0ICAgICAgdmFsOiB2YWwsXG5cdCAgICAgIGNvbmZpZzogc3R5bGVba2V5XS5jb25maWdcblx0ICAgIH07XG5cdCAgfVxuXHQgIHJldHVybiByZXQ7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRWZWxvY2l0eShmcmFtZVJhdGUsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXR5LCBzdHlsZSkge1xuXHQgIHZhciByZXQgPSB7fTtcblx0ICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcblx0ICAgIGlmICghc3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIGlmICghc3R5bGVba2V5XS5jb25maWcpIHtcblx0ICAgICAgLy8gbm90IGEgc3ByaW5nIGNvbmZpZywgbm90IHNvbWV0aGluZyB3ZSB3YW50IHRvIGludGVycG9sYXRlXG5cdCAgICAgIHJldFtrZXldID0gMDtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICB2YXIgX3N0eWxlJGtleSRjb25maWcyID0gc3R5bGVba2V5XS5jb25maWc7XG5cdCAgICB2YXIgayA9IF9zdHlsZSRrZXkkY29uZmlnMlswXTtcblx0ICAgIHZhciBiID0gX3N0eWxlJGtleSRjb25maWcyWzFdO1xuXHRcblx0ICAgIHZhciB2YWwgPSBfc3RlcHBlcjJbJ2RlZmF1bHQnXShmcmFtZVJhdGUsXG5cdCAgICAvLyBtaWdodCBoYXZlIGJlZW4gYSBub24tc3ByaW5nZWQgcHJvcCB0aGF0IGp1c3QgYmVjYW1lIG9uZVxuXHQgICAgY3VycmVudFN0eWxlW2tleV0udmFsID09IG51bGwgPyBjdXJyZW50U3R5bGVba2V5XSA6IGN1cnJlbnRTdHlsZVtrZXldLnZhbCwgY3VycmVudFZlbG9jaXR5W2tleV0sIHN0eWxlW2tleV0udmFsLCBrLCBiKVsxXTtcblx0ICAgIHJldFtrZXldID0gdmFsO1xuXHQgIH1cblx0ICByZXR1cm4gcmV0O1xuXHR9XG5cbi8qKiovIH0sXG4vKiAyOSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0Ly8gdXNlZCBieSB0aGUgdHJlZS13YWxraW5nIHVwZGF0ZXMgYW5kIHNwcmluZ3MuIEF2b2lkcyBzb21lIGFsbG9jYXRpb25zXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB6ZXJvO1xuXHRcblx0ZnVuY3Rpb24gemVybygpIHtcblx0ICByZXR1cm4gMDtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDMwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgbm93ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKVxuXHQgICwgZ2xvYmFsID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IHdpbmRvd1xuXHQgICwgdmVuZG9ycyA9IFsnbW96JywgJ3dlYmtpdCddXG5cdCAgLCBzdWZmaXggPSAnQW5pbWF0aW9uRnJhbWUnXG5cdCAgLCByYWYgPSBnbG9iYWxbJ3JlcXVlc3QnICsgc3VmZml4XVxuXHQgICwgY2FmID0gZ2xvYmFsWydjYW5jZWwnICsgc3VmZml4XSB8fCBnbG9iYWxbJ2NhbmNlbFJlcXVlc3QnICsgc3VmZml4XVxuXHRcblx0Zm9yKHZhciBpID0gMDsgaSA8IHZlbmRvcnMubGVuZ3RoICYmICFyYWY7IGkrKykge1xuXHQgIHJhZiA9IGdsb2JhbFt2ZW5kb3JzW2ldICsgJ1JlcXVlc3QnICsgc3VmZml4XVxuXHQgIGNhZiA9IGdsb2JhbFt2ZW5kb3JzW2ldICsgJ0NhbmNlbCcgKyBzdWZmaXhdXG5cdCAgICAgIHx8IGdsb2JhbFt2ZW5kb3JzW2ldICsgJ0NhbmNlbFJlcXVlc3QnICsgc3VmZml4XVxuXHR9XG5cdFxuXHQvLyBTb21lIHZlcnNpb25zIG9mIEZGIGhhdmUgckFGIGJ1dCBub3QgY0FGXG5cdGlmKCFyYWYgfHwgIWNhZikge1xuXHQgIHZhciBsYXN0ID0gMFxuXHQgICAgLCBpZCA9IDBcblx0ICAgICwgcXVldWUgPSBbXVxuXHQgICAgLCBmcmFtZUR1cmF0aW9uID0gMTAwMCAvIDYwXG5cdFxuXHQgIHJhZiA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdCAgICBpZihxdWV1ZS5sZW5ndGggPT09IDApIHtcblx0ICAgICAgdmFyIF9ub3cgPSBub3coKVxuXHQgICAgICAgICwgbmV4dCA9IE1hdGgubWF4KDAsIGZyYW1lRHVyYXRpb24gLSAoX25vdyAtIGxhc3QpKVxuXHQgICAgICBsYXN0ID0gbmV4dCArIF9ub3dcblx0ICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICAgICB2YXIgY3AgPSBxdWV1ZS5zbGljZSgwKVxuXHQgICAgICAgIC8vIENsZWFyIHF1ZXVlIGhlcmUgdG8gcHJldmVudFxuXHQgICAgICAgIC8vIGNhbGxiYWNrcyBmcm9tIGFwcGVuZGluZyBsaXN0ZW5lcnNcblx0ICAgICAgICAvLyB0byB0aGUgY3VycmVudCBmcmFtZSdzIHF1ZXVlXG5cdCAgICAgICAgcXVldWUubGVuZ3RoID0gMFxuXHQgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBjcC5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgaWYoIWNwW2ldLmNhbmNlbGxlZCkge1xuXHQgICAgICAgICAgICB0cnl7XG5cdCAgICAgICAgICAgICAgY3BbaV0uY2FsbGJhY2sobGFzdClcblx0ICAgICAgICAgICAgfSBjYXRjaChlKSB7XG5cdCAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgdGhyb3cgZSB9LCAwKVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCBNYXRoLnJvdW5kKG5leHQpKVxuXHQgICAgfVxuXHQgICAgcXVldWUucHVzaCh7XG5cdCAgICAgIGhhbmRsZTogKytpZCxcblx0ICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuXHQgICAgICBjYW5jZWxsZWQ6IGZhbHNlXG5cdCAgICB9KVxuXHQgICAgcmV0dXJuIGlkXG5cdCAgfVxuXHRcblx0ICBjYWYgPSBmdW5jdGlvbihoYW5kbGUpIHtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuXHQgICAgICBpZihxdWV1ZVtpXS5oYW5kbGUgPT09IGhhbmRsZSkge1xuXHQgICAgICAgIHF1ZXVlW2ldLmNhbmNlbGxlZCA9IHRydWVcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1cblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbikge1xuXHQgIC8vIFdyYXAgaW4gYSBuZXcgZnVuY3Rpb24gdG8gcHJldmVudFxuXHQgIC8vIGBjYW5jZWxgIHBvdGVudGlhbGx5IGJlaW5nIGFzc2lnbmVkXG5cdCAgLy8gdG8gdGhlIG5hdGl2ZSByQUYgZnVuY3Rpb25cblx0ICByZXR1cm4gcmFmLmNhbGwoZ2xvYmFsLCBmbilcblx0fVxuXHRtb2R1bGUuZXhwb3J0cy5jYW5jZWwgPSBmdW5jdGlvbigpIHtcblx0ICBjYWYuYXBwbHkoZ2xvYmFsLCBhcmd1bWVudHMpXG5cdH1cblxuXG4vKioqLyB9LFxuLyogMzEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8qXHJcblx0XHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxyXG5cdFx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxyXG5cdCovXHJcblx0dmFyIHN0eWxlc0luRG9tID0ge30sXHJcblx0XHRtZW1vaXplID0gZnVuY3Rpb24oZm4pIHtcclxuXHRcdFx0dmFyIG1lbW87XHJcblx0XHRcdHJldHVybiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0aWYgKHR5cGVvZiBtZW1vID09PSBcInVuZGVmaW5lZFwiKSBtZW1vID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHRcdFx0XHRyZXR1cm4gbWVtbztcclxuXHRcdFx0fTtcclxuXHRcdH0sXHJcblx0XHRpc09sZElFID0gbWVtb2l6ZShmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIC9tc2llIFs2LTldXFxiLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpO1xyXG5cdFx0fSksXHJcblx0XHRnZXRIZWFkRWxlbWVudCA9IG1lbW9pemUoZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRyZXR1cm4gZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF07XHJcblx0XHR9KSxcclxuXHRcdHNpbmdsZXRvbkVsZW1lbnQgPSBudWxsLFxyXG5cdFx0c2luZ2xldG9uQ291bnRlciA9IDA7XHJcblx0XHJcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihsaXN0LCBvcHRpb25zKSB7XHJcblx0XHRpZih0cnVlKSB7XHJcblx0XHRcdGlmKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50XCIpO1xyXG5cdFx0fVxyXG5cdFxyXG5cdFx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcblx0XHQvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT5cclxuXHRcdC8vIHRhZ3MgaXQgd2lsbCBhbGxvdyBvbiBhIHBhZ2VcclxuXHRcdGlmICh0eXBlb2Ygb3B0aW9ucy5zaW5nbGV0b24gPT09IFwidW5kZWZpbmVkXCIpIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xyXG5cdFxyXG5cdFx0dmFyIHN0eWxlcyA9IGxpc3RUb1N0eWxlcyhsaXN0KTtcclxuXHRcdGFkZFN0eWxlc1RvRG9tKHN0eWxlcywgb3B0aW9ucyk7XHJcblx0XHJcblx0XHRyZXR1cm4gZnVuY3Rpb24gdXBkYXRlKG5ld0xpc3QpIHtcclxuXHRcdFx0dmFyIG1heVJlbW92ZSA9IFtdO1xyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XHJcblx0XHRcdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XHJcblx0XHRcdFx0ZG9tU3R5bGUucmVmcy0tO1xyXG5cdFx0XHRcdG1heVJlbW92ZS5wdXNoKGRvbVN0eWxlKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihuZXdMaXN0KSB7XHJcblx0XHRcdFx0dmFyIG5ld1N0eWxlcyA9IGxpc3RUb1N0eWxlcyhuZXdMaXN0KTtcclxuXHRcdFx0XHRhZGRTdHlsZXNUb0RvbShuZXdTdHlsZXMsIG9wdGlvbnMpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZvcih2YXIgaSA9IDA7IGkgPCBtYXlSZW1vdmUubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgZG9tU3R5bGUgPSBtYXlSZW1vdmVbaV07XHJcblx0XHRcdFx0aWYoZG9tU3R5bGUucmVmcyA9PT0gMCkge1xyXG5cdFx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGRvbVN0eWxlLnBhcnRzLmxlbmd0aDsgaisrKVxyXG5cdFx0XHRcdFx0XHRkb21TdHlsZS5wYXJ0c1tqXSgpO1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHN0eWxlc0luRG9tW2RvbVN0eWxlLmlkXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIGFkZFN0eWxlc1RvRG9tKHN0eWxlcywgb3B0aW9ucykge1xyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaXRlbSA9IHN0eWxlc1tpXTtcclxuXHRcdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XHJcblx0XHRcdGlmKGRvbVN0eWxlKSB7XHJcblx0XHRcdFx0ZG9tU3R5bGUucmVmcysrO1xyXG5cdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0ZG9tU3R5bGUucGFydHNbal0oaXRlbS5wYXJ0c1tqXSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGZvcig7IGogPCBpdGVtLnBhcnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRkb21TdHlsZS5wYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dmFyIHBhcnRzID0gW107XHJcblx0XHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdHBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSwgb3B0aW9ucykpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRzdHlsZXNJbkRvbVtpdGVtLmlkXSA9IHtpZDogaXRlbS5pZCwgcmVmczogMSwgcGFydHM6IHBhcnRzfTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBsaXN0VG9TdHlsZXMobGlzdCkge1xyXG5cdFx0dmFyIHN0eWxlcyA9IFtdO1xyXG5cdFx0dmFyIG5ld1N0eWxlcyA9IHt9O1xyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGl0ZW0gPSBsaXN0W2ldO1xyXG5cdFx0XHR2YXIgaWQgPSBpdGVtWzBdO1xyXG5cdFx0XHR2YXIgY3NzID0gaXRlbVsxXTtcclxuXHRcdFx0dmFyIG1lZGlhID0gaXRlbVsyXTtcclxuXHRcdFx0dmFyIHNvdXJjZU1hcCA9IGl0ZW1bM107XHJcblx0XHRcdHZhciBwYXJ0ID0ge2NzczogY3NzLCBtZWRpYTogbWVkaWEsIHNvdXJjZU1hcDogc291cmNlTWFwfTtcclxuXHRcdFx0aWYoIW5ld1N0eWxlc1tpZF0pXHJcblx0XHRcdFx0c3R5bGVzLnB1c2gobmV3U3R5bGVzW2lkXSA9IHtpZDogaWQsIHBhcnRzOiBbcGFydF19KTtcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdG5ld1N0eWxlc1tpZF0ucGFydHMucHVzaChwYXJ0KTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBzdHlsZXM7XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIGNyZWF0ZVN0eWxlRWxlbWVudCgpIHtcclxuXHRcdHZhciBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XHJcblx0XHR2YXIgaGVhZCA9IGdldEhlYWRFbGVtZW50KCk7XHJcblx0XHRzdHlsZUVsZW1lbnQudHlwZSA9IFwidGV4dC9jc3NcIjtcclxuXHRcdGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGVFbGVtZW50KTtcclxuXHRcdHJldHVybiBzdHlsZUVsZW1lbnQ7XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIGNyZWF0ZUxpbmtFbGVtZW50KCkge1xyXG5cdFx0dmFyIGxpbmtFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XHJcblx0XHR2YXIgaGVhZCA9IGdldEhlYWRFbGVtZW50KCk7XHJcblx0XHRsaW5rRWxlbWVudC5yZWwgPSBcInN0eWxlc2hlZXRcIjtcclxuXHRcdGhlYWQuYXBwZW5kQ2hpbGQobGlua0VsZW1lbnQpO1xyXG5cdFx0cmV0dXJuIGxpbmtFbGVtZW50O1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBhZGRTdHlsZShvYmosIG9wdGlvbnMpIHtcclxuXHRcdHZhciBzdHlsZUVsZW1lbnQsIHVwZGF0ZSwgcmVtb3ZlO1xyXG5cdFxyXG5cdFx0aWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XHJcblx0XHRcdHZhciBzdHlsZUluZGV4ID0gc2luZ2xldG9uQ291bnRlcisrO1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQgPSBzaW5nbGV0b25FbGVtZW50IHx8IChzaW5nbGV0b25FbGVtZW50ID0gY3JlYXRlU3R5bGVFbGVtZW50KCkpO1xyXG5cdFx0XHR1cGRhdGUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50LCBzdHlsZUluZGV4LCBmYWxzZSk7XHJcblx0XHRcdHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIHRydWUpO1xyXG5cdFx0fSBlbHNlIGlmKG9iai5zb3VyY2VNYXAgJiZcclxuXHRcdFx0dHlwZW9mIFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHRcdHR5cGVvZiBVUkwuY3JlYXRlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdFx0dHlwZW9mIFVSTC5yZXZva2VPYmplY3RVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxyXG5cdFx0XHR0eXBlb2YgQmxvYiA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHRcdHR5cGVvZiBidG9hID09PSBcImZ1bmN0aW9uXCIpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50ID0gY3JlYXRlTGlua0VsZW1lbnQoKTtcclxuXHRcdFx0dXBkYXRlID0gdXBkYXRlTGluay5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRcdHJlbW92ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHN0eWxlRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0XHRcdFx0aWYoc3R5bGVFbGVtZW50LmhyZWYpXHJcblx0XHRcdFx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKHN0eWxlRWxlbWVudC5ocmVmKTtcclxuXHRcdFx0fTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudCgpO1xyXG5cdFx0XHR1cGRhdGUgPSBhcHBseVRvVGFnLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50KTtcclxuXHRcdFx0cmVtb3ZlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0c3R5bGVFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50KTtcclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHRcclxuXHRcdHVwZGF0ZShvYmopO1xyXG5cdFxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVN0eWxlKG5ld09iaikge1xyXG5cdFx0XHRpZihuZXdPYmopIHtcclxuXHRcdFx0XHRpZihuZXdPYmouY3NzID09PSBvYmouY3NzICYmIG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmIG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXApXHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0dXBkYXRlKG9iaiA9IG5ld09iaik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmVtb3ZlKCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0fVxyXG5cdFxyXG5cdHZhciByZXBsYWNlVGV4dCA9IChmdW5jdGlvbiAoKSB7XHJcblx0XHR2YXIgdGV4dFN0b3JlID0gW107XHJcblx0XHJcblx0XHRyZXR1cm4gZnVuY3Rpb24gKGluZGV4LCByZXBsYWNlbWVudCkge1xyXG5cdFx0XHR0ZXh0U3RvcmVbaW5kZXhdID0gcmVwbGFjZW1lbnQ7XHJcblx0XHRcdHJldHVybiB0ZXh0U3RvcmUuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJ1xcbicpO1xyXG5cdFx0fTtcclxuXHR9KSgpO1xyXG5cdFxyXG5cdGZ1bmN0aW9uIGFwcGx5VG9TaW5nbGV0b25UYWcoc3R5bGVFbGVtZW50LCBpbmRleCwgcmVtb3ZlLCBvYmopIHtcclxuXHRcdHZhciBjc3MgPSByZW1vdmUgPyBcIlwiIDogb2JqLmNzcztcclxuXHRcclxuXHRcdGlmIChzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gcmVwbGFjZVRleHQoaW5kZXgsIGNzcyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XHJcblx0XHRcdHZhciBjaGlsZE5vZGVzID0gc3R5bGVFbGVtZW50LmNoaWxkTm9kZXM7XHJcblx0XHRcdGlmIChjaGlsZE5vZGVzW2luZGV4XSkgc3R5bGVFbGVtZW50LnJlbW92ZUNoaWxkKGNoaWxkTm9kZXNbaW5kZXhdKTtcclxuXHRcdFx0aWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XHJcblx0XHRcdFx0c3R5bGVFbGVtZW50Lmluc2VydEJlZm9yZShjc3NOb2RlLCBjaGlsZE5vZGVzW2luZGV4XSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGNzc05vZGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIGFwcGx5VG9UYWcoc3R5bGVFbGVtZW50LCBvYmopIHtcclxuXHRcdHZhciBjc3MgPSBvYmouY3NzO1xyXG5cdFx0dmFyIG1lZGlhID0gb2JqLm1lZGlhO1xyXG5cdFx0dmFyIHNvdXJjZU1hcCA9IG9iai5zb3VyY2VNYXA7XHJcblx0XHJcblx0XHRpZihtZWRpYSkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwibWVkaWFcIiwgbWVkaWEpXHJcblx0XHR9XHJcblx0XHJcblx0XHRpZihzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0d2hpbGUoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpIHtcclxuXHRcdFx0XHRzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHN0eWxlRWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gdXBkYXRlTGluayhsaW5rRWxlbWVudCwgb2JqKSB7XHJcblx0XHR2YXIgY3NzID0gb2JqLmNzcztcclxuXHRcdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcclxuXHRcdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xyXG5cdFxyXG5cdFx0aWYoc291cmNlTWFwKSB7XHJcblx0XHRcdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI2NjAzODc1XHJcblx0XHRcdGNzcyArPSBcIlxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsXCIgKyBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpICsgXCIgKi9cIjtcclxuXHRcdH1cclxuXHRcclxuXHRcdHZhciBibG9iID0gbmV3IEJsb2IoW2Nzc10sIHsgdHlwZTogXCJ0ZXh0L2Nzc1wiIH0pO1xyXG5cdFxyXG5cdFx0dmFyIG9sZFNyYyA9IGxpbmtFbGVtZW50LmhyZWY7XHJcblx0XHJcblx0XHRsaW5rRWxlbWVudC5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuXHRcclxuXHRcdGlmKG9sZFNyYylcclxuXHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChvbGRTcmMpO1xyXG5cdH1cclxuXG5cbi8qKiovIH0sXG4vKiAzMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0Ly8gc3R5bGUtbG9hZGVyOiBBZGRzIHNvbWUgY3NzIHRvIHRoZSBET00gYnkgYWRkaW5nIGEgPHN0eWxlPiB0YWdcblx0XG5cdC8vIGxvYWQgdGhlIHN0eWxlc1xuXHR2YXIgY29udGVudCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpO1xuXHRpZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcblx0Ly8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxuXHR2YXIgdXBkYXRlID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSkoY29udGVudCwge30pO1xuXHRpZihjb250ZW50LmxvY2FscykgbW9kdWxlLmV4cG9ydHMgPSBjb250ZW50LmxvY2Fscztcblx0Ly8gSG90IE1vZHVsZSBSZXBsYWNlbWVudFxuXHRpZihmYWxzZSkge1xuXHRcdC8vIFdoZW4gdGhlIHN0eWxlcyBjaGFuZ2UsIHVwZGF0ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdFx0aWYoIWNvbnRlbnQubG9jYWxzKSB7XG5cdFx0XHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuLy4uLy4uL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzP2Jyb3dzZXJzPWxhc3QgMiB2ZXJzaW9uIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2luZGV4LmpzIS4vbWFpbi5zY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhLi8uLi8uLi9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcz9icm93c2Vycz1sYXN0IDIgdmVyc2lvbiEuLy4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9pbmRleC5qcyEuL21haW4uc2Nzc1wiKTtcblx0XHRcdFx0aWYodHlwZW9mIG5ld0NvbnRlbnQgPT09ICdzdHJpbmcnKSBuZXdDb250ZW50ID0gW1ttb2R1bGUuaWQsIG5ld0NvbnRlbnQsICcnXV07XG5cdFx0XHRcdHVwZGF0ZShuZXdDb250ZW50KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHQvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdFx0bW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uKCkgeyB1cGRhdGUoKTsgfSk7XG5cdH1cblxuLyoqKi8gfSxcbi8qIDMzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xyXG5cdFx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XHJcblx0XHRcdG1vZHVsZS5wYXRocyA9IFtdO1xyXG5cdFx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdFx0bW9kdWxlLmNoaWxkcmVuID0gW107XHJcblx0XHRcdG1vZHVsZS53ZWJwYWNrUG9seWZpbGwgPSAxO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIG1vZHVsZTtcclxuXHR9XHJcblxuXG4vKioqLyB9XG4vKioqKioqLyBdKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiByZWFjdC1jbGltYi1zb2NpYWwubWluLmpzXG4gKiovIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1wiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgM2ZiZDQyNDBhOTdlNzI4MWQ4YzJcbiAqKi8iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFdhbGxDb250YWluZXIgZnJvbSAnLi9jb21wb25lbnRzL1dhbGxDb250YWluZXInO1xuXG5pbXBvcnQgJy4vc3R5bGUvbWFpbi5zY3NzJztcblxuaWYgKHdpbmRvdykge1xuICAgIHdpbmRvdy5DbGltYiA9IHdpbmRvdy5DbGltYiB8fCB7fTtcblxuICAgIGNvbnN0ICR0YXJnZXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNsaW1iLXdhbGwnKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgJHRhcmdldHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgY29uc3QgJGl0ZW0gPSAkdGFyZ2V0c1tpXTtcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbklkID0gJGl0ZW0uZGF0YXNldC5jb2xsZWN0aW9uSWQ7XG4gICAgICAgIGNvbnN0IGxpbWl0ID0gJGl0ZW0uZGF0YXNldC5saW1pdDtcblxuICAgICAgICBSZWFjdC5yZW5kZXIoXG4gICAgICAgICAgICBSZWFjdC5jcmVhdGVFbGVtZW50KFdhbGxDb250YWluZXIsIHtjb2xsZWN0aW9uSWQsIGxpbWl0fSksXG4gICAgICAgICAgICAkaXRlbVxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgV2FsbENvbnRhaW5lcjtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2luZGV4LmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBSZWFjdDtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIFwiUmVhY3RcIlxuICoqIG1vZHVsZSBpZCA9IDFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIFtzdGlmZm5lc3MsIGRhbXBpbmddXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0ge1xuICBub1dvYmJsZTogWzE3MCwgMjZdLCAvLyB0aGUgZGVmYXVsdFxuICBnZW50bGU6IFsxMjAsIDE0XSxcbiAgd29iYmx5OiBbMTgwLCAxMl0sXG4gIHN0aWZmOiBbMjEwLCAyMF1cbn07XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvcHJlc2V0cy5qc1xuICoqIG1vZHVsZSBpZCA9IDJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS43LjFcbihmdW5jdGlvbigpIHtcbiAgdmFyIGdldE5hbm9TZWNvbmRzLCBocnRpbWUsIGxvYWRUaW1lO1xuXG4gIGlmICgodHlwZW9mIHBlcmZvcm1hbmNlICE9PSBcInVuZGVmaW5lZFwiICYmIHBlcmZvcm1hbmNlICE9PSBudWxsKSAmJiBwZXJmb3JtYW5jZS5ub3cpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIH07XG4gIH0gZWxzZSBpZiAoKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MgIT09IG51bGwpICYmIHByb2Nlc3MuaHJ0aW1lKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiAoZ2V0TmFub1NlY29uZHMoKSAtIGxvYWRUaW1lKSAvIDFlNjtcbiAgICB9O1xuICAgIGhydGltZSA9IHByb2Nlc3MuaHJ0aW1lO1xuICAgIGdldE5hbm9TZWNvbmRzID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaHI7XG4gICAgICBociA9IGhydGltZSgpO1xuICAgICAgcmV0dXJuIGhyWzBdICogMWU5ICsgaHJbMV07XG4gICAgfTtcbiAgICBsb2FkVGltZSA9IGdldE5hbm9TZWNvbmRzKCk7XG4gIH0gZWxzZSBpZiAoRGF0ZS5ub3cpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIERhdGUubm93KCkgLSBsb2FkVGltZTtcbiAgICB9O1xuICAgIGxvYWRUaW1lID0gRGF0ZS5ub3coKTtcbiAgfSBlbHNlIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gbG9hZFRpbWU7XG4gICAgfTtcbiAgICBsb2FkVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICB9XG5cbn0pLmNhbGwodGhpcyk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vfi9wZXJmb3JtYW5jZS1ub3cvbGliL3BlcmZvcm1hbmNlLW5vdy5qc1xuICoqIG1vZHVsZSBpZCA9IDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBzZXRUaW1lb3V0KGRyYWluUXVldWUsIDApO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAod2VicGFjaykvfi9ub2RlLWxpYnMtYnJvd3Nlci9+L3Byb2Nlc3MvYnJvd3Nlci5qc1xuICoqIG1vZHVsZSBpZCA9IDRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cblxuY2xhc3MgQXV0aG9yIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcblxuICAgIHJlbmRlcigpIHtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGEgY2xhc3NOYW1lPVwiY2xpbWJfX3RpbGVfX2F1dGhvclwiXG4gICAgICAgICAgICAgICBocmVmPXsgdGhpcy5wcm9wcy5saW5rIH0+XG5cbiAgICAgICAgICAgICAgICA8aW1nIHNyYz17IHRoaXMucHJvcHMucGljdHVyZX1cbiAgICAgICAgICAgICAgICAgICAgIGFsdD17IGBQcm9maWxlIHBpYyBvZiAke3RoaXMucHJvcHMubmFtZX1gIH0vPlxuXG4gICAgICAgICAgICAgICAgPGg0IGNsYXNzTmFtZT1cImNsaW1iX190aWxlX19hdXRob3JfX3VzZXJuYW1lXCI+XG4gICAgICAgICAgICAgICAgICAgIHsgdGhpcy5wcm9wcy51c2VybmFtZSB9XG4gICAgICAgICAgICAgICAgPC9oND5cbiAgICAgICAgICAgIDwvYT5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbkF1dGhvci5wcm9wVHlwZXMgPSB7fTtcblxuZXhwb3J0IGRlZmF1bHQgQXV0aG9yO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9BdXRob3IuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuXG5jbGFzcyBJbWFnZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8aW1nIGNsYXNzTmFtZT1cImNsaW1iX190aWxlX19pbWFnZVwiXG4gICAgICAgICAgICAgICAgIHNyYz17IHRoaXMucHJvcHMuc3JjIH0gZGF0YS13aWR0aD17IHRoaXMucHJvcHMud2lkdGggfSBkYXRhLWhlaWdodD17IHRoaXMucHJvcHMuaGVpZ2h0IH0vPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuSW1hZ2UucHJvcFR5cGVzID0ge1xuICAgIHNyYzogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIHdpZHRoOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLFxuICAgIGhlaWdodDogUmVhY3QuUHJvcFR5cGVzLm51bWJlclxufTtcblxuZXhwb3J0IGRlZmF1bHQgSW1hZ2U7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL0ltYWdlLmpzeFxuICoqLyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5cblxuY2xhc3MgTWVzc2FnZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNsaW1iX190aWxlX19tZXNzYWdlXCJcbiAgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw9e3tfX2h0bWw6IHRoaXMucHJvcHMuYm9keX19PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5NZXNzYWdlLnByb3BUeXBlcyA9IHtcbiAgICBib2R5OiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcbn07XG5cbmV4cG9ydCBkZWZhdWx0IE1lc3NhZ2U7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL01lc3NhZ2UuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBJbWFnZSBmcm9tICcuL0ltYWdlJztcbmltcG9ydCBNZXNzYWdlIGZyb20gJy4vTWVzc2FnZSc7XG5pbXBvcnQgQXV0aG9yIGZyb20gJy4vQXV0aG9yJztcblxuXG5jbGFzcyBUaWxlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG5cbiAgICBjcmVhdGVJbWFnZSgpIHtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pbWFnZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3Qge3VybDogc3JjLCB3aWR0aCwgaGVpZ2h0fSA9IHRoaXMucHJvcHMuaW1hZ2U7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxJbWFnZSBzcmM9eyBzcmMgfVxuICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD17IHdpZHRoIH1cbiAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXsgaGVpZ2h0IH0vPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjcmVhdGVNZXNzYWdlKCkge1xuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPE1lc3NhZ2UgYm9keT17IHRoaXMucHJvcHMubWVzc2FnZSB9Lz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY3JlYXRlQ2xhc3NTdHJpbmcoKSB7XG5cbiAgICAgICAgbGV0IGNsYXNzU3RyaW5nID0gYGNsaW1iX190aWxlIGNsaW1iX190aWxlLS0ke3RoaXMucHJvcHMuc291cmNlX3R5cGV9YDtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pbWFnZSkge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW1lZGlhIGNsaW1iX190aWxlLS1oYXMtaW1hZ2UnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW5vLWltYWdlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLnZpZGVvX3VybCkge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW1lZGlhIGNsaW1iX190aWxlLS1oYXMtdmlkZW8nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW5vLXZpZGVvJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGFzc1N0cmluZztcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG5cbiAgICAgICAgY29uc3QgaW1hZ2UgPSB0aGlzLmNyZWF0ZUltYWdlKCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmNyZWF0ZU1lc3NhZ2UoKTtcbiAgICAgICAgY29uc3QgY2xhc3NTdHJpbmcgPSB0aGlzLmNyZWF0ZUNsYXNzU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IHthdXRob3J9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9eyBjbGFzc1N0cmluZyB9XG4gICAgICAgICAgICAgICAgIHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfT5cblxuICAgICAgICAgICAgICAgIDxhIGhyZWY9eyB0aGlzLnByb3BzLmxpbmsgfT5cbiAgICAgICAgICAgICAgICAgICAgeyBpbWFnZSB9XG4gICAgICAgICAgICAgICAgPC9hPlxuXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjbGltYl9fdGlsZV9fY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICB7IG1lc3NhZ2UgfVxuXG4gICAgICAgICAgICAgICAgICAgIDxBdXRob3Igey4uLmF1dGhvcn0gLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuXG5UaWxlLnByb3BUeXBlcyA9IHtcblxuICAgIC8vIFJlcXVpcmVkIGF0dHJzXG4gICAgbGluazogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIHNvdXJjZV90eXBlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgdGltZXN0YW1wOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgYXV0aG9yOiBSZWFjdC5Qcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICB1c2VybmFtZTogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgICBwaWN0dXJlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIGxpbms6IFJlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuICAgIH0pLFxuXG4gICAgLy8gT3B0aW9uYWwgYXR0cnNcbiAgICBtZXNzYWdlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLFxuICAgIHZpZGVvX3NyYzogUmVhY3QuUHJvcFR5cGVzLnN0cmluZyxcbiAgICBpbWFnZTogUmVhY3QuUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgdXJsOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIHdpZHRoOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgICAgIGhlaWdodDogUmVhY3QuUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkXG4gICAgfSlcblxufTtcblxuZXhwb3J0IGRlZmF1bHQgVGlsZTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvVGlsZS5qc3hcbiAqKi8iLCJpbXBvcnQgUmVhY3QsIHtDb21wb25lbnQsIFByb3BUeXBlc30gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFRpbGUgZnJvbSAnLi9UaWxlJztcbmltcG9ydCB7VHJhbnNpdGlvbk1vdGlvbiwgc3ByaW5nfSBmcm9tICdyZWFjdC1tb3Rpb24nO1xuXG5cbmNsYXNzIFdhbGwgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgaXRlbXM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZFxuICAgIH07XG5cbiAgICBnZXRTdHlsZXMoKSB7XG4gICAgICAgIGNvbnN0IGNvbmZpZ3MgPSB7fTtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5wcm9wcy5pdGVtcykubWFwKGtleSA9PiB7XG4gICAgICAgICAgICBjb25maWdzW2tleV0gPSB7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogc3ByaW5nKDEpLFxuICAgICAgICAgICAgICAgIHdpZHRoOiBzcHJpbmcoMzc1KSxcbiAgICAgICAgICAgICAgICBtYXJnaW46IHNwcmluZygxMCksXG4gICAgICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvbmZpZ3M7XG4gICAgfVxuXG4gICAgd2lsbEVudGVyKGtleSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgb3BhY2l0eTogc3ByaW5nKDApLFxuICAgICAgICAgICAgd2lkdGg6IHNwcmluZygwKSxcbiAgICAgICAgICAgIG1hcmdpbjogc3ByaW5nKDApLFxuICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgd2lsbExlYXZlKGtleSwgc3R5bGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IHNwcmluZygwKSxcbiAgICAgICAgICAgIHdpZHRoOiBzcHJpbmcoMCksXG4gICAgICAgICAgICBtYXJnaW46IHNwcmluZygwKSxcbiAgICAgICAgICAgIGl0ZW06IHN0eWxlLml0ZW1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZW5kZXJUaWxlKGtleSwgaXRlbVZhbHVlcykge1xuXG4gICAgICAgIGNvbnN0IHtpdGVtLCAuLi5zdHlsZUNvbmZpZ30gPSBpdGVtVmFsdWVzO1xuICAgICAgICBjb25zdCB7Li4uaXRlbVByb3BzfSA9IGl0ZW07XG5cbiAgICAgICAgY29uc3Qgc3R5bGUgPSB7XG4gICAgICAgICAgICBvcGFjaXR5OiBzdHlsZUNvbmZpZy5vcGFjaXR5LFxuICAgICAgICAgICAgd2lkdGg6IGAke3N0eWxlQ29uZmlnLndpZHRofXB4YCxcbiAgICAgICAgICAgICdtYXJnaW4tbGVmdCc6IHN0eWxlQ29uZmlnLm1hcmdpbixcbiAgICAgICAgICAgICdtYXJnaW4tcmlnaHQnOiBzdHlsZUNvbmZpZy5tYXJnaW5cbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFRpbGUga2V5PXtrZXl9XG4gICAgICAgICAgICAgICAgICBzdHlsZT17c3R5bGV9XG4gICAgICAgICAgICAgICAgey4uLml0ZW1Qcm9wcyB9IC8+XG4gICAgICAgICk7XG5cbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8VHJhbnNpdGlvbk1vdGlvblxuICAgICAgICAgICAgICAgIHN0eWxlcz17dGhpcy5nZXRTdHlsZXMuYmluZCh0aGlzKSgpfVxuICAgICAgICAgICAgICAgIHdpbGxFbnRlcj17dGhpcy53aWxsRW50ZXIuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICB3aWxsTGVhdmU9e3RoaXMud2lsbExlYXZlLmJpbmQodGhpcyl9PlxuICAgICAgICAgICAgICAgIHt2YWx1ZXMgPT5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjbGltYl9fd2FsbFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAge09iamVjdC5rZXlzKHZhbHVlcykubWFwKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbVZhbHVlcyA9IHZhbHVlc1trZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlclRpbGUoa2V5LCBpdGVtVmFsdWVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICA8L1RyYW5zaXRpb25Nb3Rpb24+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBXYWxsO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9XYWxsLmpzeFxuICoqLyIsImltcG9ydCBSZWFjdCwge0NvbXBvbmVudCwgUHJvcFR5cGVzfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY2xpbWIgZnJvbSAnY2xpbWItc29jaWFsJztcbmltcG9ydCBXYWxsIGZyb20gJy4vV2FsbCc7XG5cblxuY2xhc3MgV2FsbENvbnRhaW5lciBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgfVxuXG4gICAgc3RhdGUgPSB7XG4gICAgICAgIGl0ZW1zOiBbXVxuICAgIH07XG5cbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBjb2xsZWN0aW9uSWQ6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgICAgbGltaXQ6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1xuICAgICAgICAgICAgUHJvcFR5cGVzLm51bWJlcixcbiAgICAgICAgICAgIFByb3BUeXBlcy5zdHJpbmdcbiAgICAgICAgXSlcbiAgICB9O1xuXG4gICAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICAgICAgY29sbGVjdGlvbklkOiAnNTYxYmE2MzQ0NTI4NGUxNzQwZTAxNmY3JyxcbiAgICAgICAgbGltaXQ6IDMwXG4gICAgfTtcblxuICAgIGluaXQoKSB7XG5cbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmNvbGxlY3Rpb25JZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xpbWJcbiAgICAgICAgICAgIC5nZXRTdHJlYW0odGhpcy5wcm9wcy5jb2xsZWN0aW9uSWQpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKGl0ZW1zID0+IHtcblxuICAgICAgICAgICAgICAgIGNvbnN0IG1heFNpemUgPSBwYXJzZUludCh0aGlzLnByb3BzLmxpbWl0LCAwKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IG1hcHBlZEl0ZW1zID0ge307XG4gICAgICAgICAgICAgICAgaXRlbXMuc3BsaWNlKDAsIG1heFNpemUpLm1hcChpdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbWFwcGVkSXRlbXNbaXRlbS5pZF0gPSBpdGVtO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBtYXBwZWRJdGVtc1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgICAgICBsZXQgY2I7XG4gICAgICAgIGlmICh3aW5kb3cuQ2xpbWIgJiYgd2luZG93LkNsaW1iLm9uVXBkYXRlKSB7XG4gICAgICAgICAgICBjYiA9IHdpbmRvdy5DbGltYi5vblVwZGF0ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIG5vb3BcbiAgICAgICAgICAgIGNiID0gKCkgPT4ge1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjYigpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxXYWxsIGl0ZW1zPXt0aGlzLnN0YXRlLml0ZW1zfS8+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBXYWxsQ29udGFpbmVyO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9XYWxsQ29udGFpbmVyLmpzeFxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3J4TGl0ZSA9IHJlcXVpcmUoJ3J4LWxpdGUnKTtcblxudmFyIF9mZXRjaEpzb25wID0gcmVxdWlyZSgnZmV0Y2gtanNvbnAnKTtcblxudmFyIF9mZXRjaEpzb25wMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZldGNoSnNvbnApO1xuXG52YXIgZ2V0U3RyZWFtID0gZnVuY3Rpb24gZ2V0U3RyZWFtKGNvbGxlY3Rpb25JZCkge1xuXG4gICAgdmFyIHBvbGxSYXRlID0gNSAqIDEwMDA7XG5cbiAgICB2YXIgcmVxdWVzdFN0cmVhbSA9IF9yeExpdGUuT2JzZXJ2YWJsZS5qdXN0KCdodHRwOi8vYXBwLmNsaW1iLnNvY2lhbC9hcGkvdjEvY29sbGVjdGlvbnMvJyArIGNvbGxlY3Rpb25JZCk7XG5cbiAgICB2YXIgdXBkYXRlU3RyZWFtID0gX3J4TGl0ZS5PYnNlcnZhYmxlLmludGVydmFsKHBvbGxSYXRlKS5zdGFydFdpdGgobnVsbCk7XG5cbiAgICB2YXIgcmVzcG9uc2VTdHJlYW0gPSB1cGRhdGVTdHJlYW0uY29tYmluZUxhdGVzdChyZXF1ZXN0U3RyZWFtLCBmdW5jdGlvbiAodGljaywgdXJsKSB7XG4gICAgICAgIHJldHVybiB1cmw7XG4gICAgfSkuZmxhdE1hcChmdW5jdGlvbiAoYmFzZVVybCkge1xuXG4gICAgICAgIHZhciByZXF1ZXN0VXJsID0gJycgKyBiYXNlVXJsO1xuXG4gICAgICAgIHJldHVybiBfcnhMaXRlLk9ic2VydmFibGUuZnJvbVByb21pc2UoKDAsIF9mZXRjaEpzb25wMlsnZGVmYXVsdCddKShyZXF1ZXN0VXJsKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzcC5qc29uKCk7XG4gICAgICAgIH0pKTtcbiAgICB9KTtcblxuICAgIHJldHVybiByZXNwb25zZVN0cmVhbTtcbn07XG5cbmV4cG9ydHNbJ2RlZmF1bHQnXSA9IHtcbiAgICBnZXRTdHJlYW06IGdldFN0cmVhbVxufTtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vY2xpbWItc29jaWFsL2Rpc3QvaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAxMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQsIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuXG47KGZ1bmN0aW9uICh1bmRlZmluZWQpIHtcblxuICB2YXIgb2JqZWN0VHlwZXMgPSB7XG4gICAgJ2Z1bmN0aW9uJzogdHJ1ZSxcbiAgICAnb2JqZWN0JzogdHJ1ZVxuICB9O1xuXG4gIGZ1bmN0aW9uIGNoZWNrR2xvYmFsKHZhbHVlKSB7XG4gICAgcmV0dXJuICh2YWx1ZSAmJiB2YWx1ZS5PYmplY3QgPT09IE9iamVjdCkgPyB2YWx1ZSA6IG51bGw7XG4gIH1cblxuICB2YXIgZnJlZUV4cG9ydHMgPSAob2JqZWN0VHlwZXNbdHlwZW9mIGV4cG9ydHNdICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUpID8gZXhwb3J0cyA6IG51bGw7XG4gIHZhciBmcmVlTW9kdWxlID0gKG9iamVjdFR5cGVzW3R5cGVvZiBtb2R1bGVdICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlKSA/IG1vZHVsZSA6IG51bGw7XG4gIHZhciBmcmVlR2xvYmFsID0gY2hlY2tHbG9iYWwoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSAmJiB0eXBlb2YgZ2xvYmFsID09PSAnb2JqZWN0JyAmJiBnbG9iYWwpO1xuICB2YXIgZnJlZVNlbGYgPSBjaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2Ygc2VsZl0gJiYgc2VsZik7XG4gIHZhciBmcmVlV2luZG93ID0gY2hlY2tHbG9iYWwob2JqZWN0VHlwZXNbdHlwZW9mIHdpbmRvd10gJiYgd2luZG93KTtcbiAgdmFyIG1vZHVsZUV4cG9ydHMgPSAoZnJlZU1vZHVsZSAmJiBmcmVlTW9kdWxlLmV4cG9ydHMgPT09IGZyZWVFeHBvcnRzKSA/IGZyZWVFeHBvcnRzIDogbnVsbDtcbiAgdmFyIHRoaXNHbG9iYWwgPSBjaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2YgdGhpc10gJiYgdGhpcyk7XG4gIHZhciByb290ID0gZnJlZUdsb2JhbCB8fCAoKGZyZWVXaW5kb3cgIT09ICh0aGlzR2xvYmFsICYmIHRoaXNHbG9iYWwud2luZG93KSkgJiYgZnJlZVdpbmRvdykgfHwgZnJlZVNlbGYgfHwgdGhpc0dsb2JhbCB8fCBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXG4gIHZhciBSeCA9IHtcbiAgICBpbnRlcm5hbHM6IHt9LFxuICAgIGNvbmZpZzoge1xuICAgICAgUHJvbWlzZTogcm9vdC5Qcm9taXNlXG4gICAgfSxcbiAgICBoZWxwZXJzOiB7IH1cbiAgfTtcblxuICAvLyBEZWZhdWx0c1xuICB2YXIgbm9vcCA9IFJ4LmhlbHBlcnMubm9vcCA9IGZ1bmN0aW9uICgpIHsgfSxcbiAgICBpZGVudGl0eSA9IFJ4LmhlbHBlcnMuaWRlbnRpdHkgPSBmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSxcbiAgICBkZWZhdWx0Tm93ID0gUnguaGVscGVycy5kZWZhdWx0Tm93ID0gRGF0ZS5ub3csXG4gICAgZGVmYXVsdENvbXBhcmVyID0gUnguaGVscGVycy5kZWZhdWx0Q29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gaXNFcXVhbCh4LCB5KTsgfSxcbiAgICBkZWZhdWx0U3ViQ29tcGFyZXIgPSBSeC5oZWxwZXJzLmRlZmF1bHRTdWJDb21wYXJlciA9IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ID4geSA/IDEgOiAoeCA8IHkgPyAtMSA6IDApOyB9LFxuICAgIGRlZmF1bHRLZXlTZXJpYWxpemVyID0gUnguaGVscGVycy5kZWZhdWx0S2V5U2VyaWFsaXplciA9IGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG4gICAgZGVmYXVsdEVycm9yID0gUnguaGVscGVycy5kZWZhdWx0RXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7IHRocm93IGVycjsgfSxcbiAgICBpc1Byb21pc2UgPSBSeC5oZWxwZXJzLmlzUHJvbWlzZSA9IGZ1bmN0aW9uIChwKSB7IHJldHVybiAhIXAgJiYgdHlwZW9mIHAuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBwLnRoZW4gPT09ICdmdW5jdGlvbic7IH0sXG4gICAgaXNGdW5jdGlvbiA9IFJ4LmhlbHBlcnMuaXNGdW5jdGlvbiA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAgIHZhciBpc0ZuID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJyB8fCBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gZmFsbGJhY2sgZm9yIG9sZGVyIHZlcnNpb25zIG9mIENocm9tZSBhbmQgU2FmYXJpXG4gICAgICBpZiAoaXNGbigveC8pKSB7XG4gICAgICAgIGlzRm4gPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJyAmJiB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaXNGbjtcbiAgICB9KCkpO1xuXG4gICAgZnVuY3Rpb24gY2xvbmVBcnJheShhcnIpIHtcbiAgICAgIHZhciBsZW4gPSBhcnIubGVuZ3RoLCBhID0gbmV3IEFycmF5KGxlbik7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYVtpXSA9IGFycltpXTsgfVxuICAgICAgcmV0dXJuIGE7XG4gICAgfVxuXG4gIHZhciBlcnJvck9iaiA9IHtlOiB7fX07XG4gIFxuICBmdW5jdGlvbiB0cnlDYXRjaGVyR2VuKHRyeUNhdGNoVGFyZ2V0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIHRyeUNhdGNoZXIoKSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gdHJ5Q2F0Y2hUYXJnZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgdmFyIHRyeUNhdGNoID0gUnguaW50ZXJuYWxzLnRyeUNhdGNoID0gZnVuY3Rpb24gdHJ5Q2F0Y2goZm4pIHtcbiAgICBpZiAoIWlzRnVuY3Rpb24oZm4pKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ2ZuIG11c3QgYmUgYSBmdW5jdGlvbicpOyB9XG4gICAgcmV0dXJuIHRyeUNhdGNoZXJHZW4oZm4pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHRocm93ZXIoZSkge1xuICAgIHRocm93IGU7XG4gIH1cblxuICBSeC5jb25maWcubG9uZ1N0YWNrU3VwcG9ydCA9IGZhbHNlO1xuICB2YXIgaGFzU3RhY2tzID0gZmFsc2UsIHN0YWNrcyA9IHRyeUNhdGNoKGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKCk7IH0pKCk7XG4gIGhhc1N0YWNrcyA9ICEhc3RhY2tzLmUgJiYgISFzdGFja3MuZS5zdGFjaztcblxuICAvLyBBbGwgY29kZSBhZnRlciB0aGlzIHBvaW50IHdpbGwgYmUgZmlsdGVyZWQgZnJvbSBzdGFjayB0cmFjZXMgcmVwb3J0ZWQgYnkgUnhKU1xuICB2YXIgclN0YXJ0aW5nTGluZSA9IGNhcHR1cmVMaW5lKCksIHJGaWxlTmFtZTtcblxuICB2YXIgU1RBQ0tfSlVNUF9TRVBBUkFUT1IgPSAnRnJvbSBwcmV2aW91cyBldmVudDonO1xuXG4gIGZ1bmN0aW9uIG1ha2VTdGFja1RyYWNlTG9uZyhlcnJvciwgb2JzZXJ2YWJsZSkge1xuICAgIC8vIElmIHBvc3NpYmxlLCB0cmFuc2Zvcm0gdGhlIGVycm9yIHN0YWNrIHRyYWNlIGJ5IHJlbW92aW5nIE5vZGUgYW5kIFJ4SlNcbiAgICAvLyBjcnVmdCwgdGhlbiBjb25jYXRlbmF0aW5nIHdpdGggdGhlIHN0YWNrIHRyYWNlIG9mIGBvYnNlcnZhYmxlYC5cbiAgICBpZiAoaGFzU3RhY2tzICYmXG4gICAgICAgIG9ic2VydmFibGUuc3RhY2sgJiZcbiAgICAgICAgdHlwZW9mIGVycm9yID09PSAnb2JqZWN0JyAmJlxuICAgICAgICBlcnJvciAhPT0gbnVsbCAmJlxuICAgICAgICBlcnJvci5zdGFjayAmJlxuICAgICAgICBlcnJvci5zdGFjay5pbmRleE9mKFNUQUNLX0pVTVBfU0VQQVJBVE9SKSA9PT0gLTFcbiAgICApIHtcbiAgICAgIHZhciBzdGFja3MgPSBbXTtcbiAgICAgIGZvciAodmFyIG8gPSBvYnNlcnZhYmxlOyAhIW87IG8gPSBvLnNvdXJjZSkge1xuICAgICAgICBpZiAoby5zdGFjaykge1xuICAgICAgICAgIHN0YWNrcy51bnNoaWZ0KG8uc3RhY2spO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzdGFja3MudW5zaGlmdChlcnJvci5zdGFjayk7XG5cbiAgICAgIHZhciBjb25jYXRlZFN0YWNrcyA9IHN0YWNrcy5qb2luKCdcXG4nICsgU1RBQ0tfSlVNUF9TRVBBUkFUT1IgKyAnXFxuJyk7XG4gICAgICBlcnJvci5zdGFjayA9IGZpbHRlclN0YWNrU3RyaW5nKGNvbmNhdGVkU3RhY2tzKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBmaWx0ZXJTdGFja1N0cmluZyhzdGFja1N0cmluZykge1xuICAgIHZhciBsaW5lcyA9IHN0YWNrU3RyaW5nLnNwbGl0KCdcXG4nKSwgZGVzaXJlZExpbmVzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpbmVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICB2YXIgbGluZSA9IGxpbmVzW2ldO1xuXG4gICAgICBpZiAoIWlzSW50ZXJuYWxGcmFtZShsaW5lKSAmJiAhaXNOb2RlRnJhbWUobGluZSkgJiYgbGluZSkge1xuICAgICAgICBkZXNpcmVkTGluZXMucHVzaChsaW5lKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRlc2lyZWRMaW5lcy5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzSW50ZXJuYWxGcmFtZShzdGFja0xpbmUpIHtcbiAgICB2YXIgZmlsZU5hbWVBbmRMaW5lTnVtYmVyID0gZ2V0RmlsZU5hbWVBbmRMaW5lTnVtYmVyKHN0YWNrTGluZSk7XG4gICAgaWYgKCFmaWxlTmFtZUFuZExpbmVOdW1iZXIpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGZpbGVOYW1lID0gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzBdLCBsaW5lTnVtYmVyID0gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzFdO1xuXG4gICAgcmV0dXJuIGZpbGVOYW1lID09PSByRmlsZU5hbWUgJiZcbiAgICAgIGxpbmVOdW1iZXIgPj0gclN0YXJ0aW5nTGluZSAmJlxuICAgICAgbGluZU51bWJlciA8PSByRW5kaW5nTGluZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzTm9kZUZyYW1lKHN0YWNrTGluZSkge1xuICAgIHJldHVybiBzdGFja0xpbmUuaW5kZXhPZignKG1vZHVsZS5qczonKSAhPT0gLTEgfHxcbiAgICAgIHN0YWNrTGluZS5pbmRleE9mKCcobm9kZS5qczonKSAhPT0gLTE7XG4gIH1cblxuICBmdW5jdGlvbiBjYXB0dXJlTGluZSgpIHtcbiAgICBpZiAoIWhhc1N0YWNrcykgeyByZXR1cm47IH1cblxuICAgIHRyeSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB2YXIgbGluZXMgPSBlLnN0YWNrLnNwbGl0KCdcXG4nKTtcbiAgICAgIHZhciBmaXJzdExpbmUgPSBsaW5lc1swXS5pbmRleE9mKCdAJykgPiAwID8gbGluZXNbMV0gOiBsaW5lc1syXTtcbiAgICAgIHZhciBmaWxlTmFtZUFuZExpbmVOdW1iZXIgPSBnZXRGaWxlTmFtZUFuZExpbmVOdW1iZXIoZmlyc3RMaW5lKTtcbiAgICAgIGlmICghZmlsZU5hbWVBbmRMaW5lTnVtYmVyKSB7IHJldHVybjsgfVxuXG4gICAgICByRmlsZU5hbWUgPSBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMF07XG4gICAgICByZXR1cm4gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzFdO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEZpbGVOYW1lQW5kTGluZU51bWJlcihzdGFja0xpbmUpIHtcbiAgICAvLyBOYW1lZCBmdW5jdGlvbnM6ICdhdCBmdW5jdGlvbk5hbWUgKGZpbGVuYW1lOmxpbmVOdW1iZXI6Y29sdW1uTnVtYmVyKSdcbiAgICB2YXIgYXR0ZW1wdDEgPSAvYXQgLisgXFwoKC4rKTooXFxkKyk6KD86XFxkKylcXCkkLy5leGVjKHN0YWNrTGluZSk7XG4gICAgaWYgKGF0dGVtcHQxKSB7IHJldHVybiBbYXR0ZW1wdDFbMV0sIE51bWJlcihhdHRlbXB0MVsyXSldOyB9XG5cbiAgICAvLyBBbm9ueW1vdXMgZnVuY3Rpb25zOiAnYXQgZmlsZW5hbWU6bGluZU51bWJlcjpjb2x1bW5OdW1iZXInXG4gICAgdmFyIGF0dGVtcHQyID0gL2F0IChbXiBdKyk6KFxcZCspOig/OlxcZCspJC8uZXhlYyhzdGFja0xpbmUpO1xuICAgIGlmIChhdHRlbXB0MikgeyByZXR1cm4gW2F0dGVtcHQyWzFdLCBOdW1iZXIoYXR0ZW1wdDJbMl0pXTsgfVxuXG4gICAgLy8gRmlyZWZveCBzdHlsZTogJ2Z1bmN0aW9uQGZpbGVuYW1lOmxpbmVOdW1iZXIgb3IgQGZpbGVuYW1lOmxpbmVOdW1iZXInXG4gICAgdmFyIGF0dGVtcHQzID0gLy4qQCguKyk6KFxcZCspJC8uZXhlYyhzdGFja0xpbmUpO1xuICAgIGlmIChhdHRlbXB0MykgeyByZXR1cm4gW2F0dGVtcHQzWzFdLCBOdW1iZXIoYXR0ZW1wdDNbMl0pXTsgfVxuICB9XG5cbiAgdmFyIEVtcHR5RXJyb3IgPSBSeC5FbXB0eUVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gJ1NlcXVlbmNlIGNvbnRhaW5zIG5vIGVsZW1lbnRzLic7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgRW1wdHlFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG4gIEVtcHR5RXJyb3IucHJvdG90eXBlLm5hbWUgPSAnRW1wdHlFcnJvcic7XG5cbiAgdmFyIE9iamVjdERpc3Bvc2VkRXJyb3IgPSBSeC5PYmplY3REaXNwb3NlZEVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gJ09iamVjdCBoYXMgYmVlbiBkaXNwb3NlZCc7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgT2JqZWN0RGlzcG9zZWRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG4gIE9iamVjdERpc3Bvc2VkRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnT2JqZWN0RGlzcG9zZWRFcnJvcic7XG5cbiAgdmFyIEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yID0gUnguQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gJ0FyZ3VtZW50IG91dCBvZiByYW5nZSc7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuICBBcmd1bWVudE91dE9mUmFuZ2VFcnJvci5wcm90b3R5cGUubmFtZSA9ICdBcmd1bWVudE91dE9mUmFuZ2VFcnJvcic7XG5cbiAgdmFyIE5vdFN1cHBvcnRlZEVycm9yID0gUnguTm90U3VwcG9ydGVkRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgJ1RoaXMgb3BlcmF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQnO1xuICAgIEVycm9yLmNhbGwodGhpcyk7XG4gIH07XG4gIE5vdFN1cHBvcnRlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgTm90U3VwcG9ydGVkRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnTm90U3VwcG9ydGVkRXJyb3InO1xuXG4gIHZhciBOb3RJbXBsZW1lbnRlZEVycm9yID0gUnguTm90SW1wbGVtZW50ZWRFcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVGhpcyBvcGVyYXRpb24gaXMgbm90IGltcGxlbWVudGVkJztcbiAgICBFcnJvci5jYWxsKHRoaXMpO1xuICB9O1xuICBOb3RJbXBsZW1lbnRlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgTm90SW1wbGVtZW50ZWRFcnJvci5wcm90b3R5cGUubmFtZSA9ICdOb3RJbXBsZW1lbnRlZEVycm9yJztcblxuICB2YXIgbm90SW1wbGVtZW50ZWQgPSBSeC5oZWxwZXJzLm5vdEltcGxlbWVudGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gIH07XG5cbiAgdmFyIG5vdFN1cHBvcnRlZCA9IFJ4LmhlbHBlcnMubm90U3VwcG9ydGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcigpO1xuICB9O1xuXG4gIC8vIFNoaW0gaW4gaXRlcmF0b3Igc3VwcG9ydFxuICB2YXIgJGl0ZXJhdG9yJCA9ICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIFN5bWJvbC5pdGVyYXRvcikgfHxcbiAgICAnX2VzNnNoaW1faXRlcmF0b3JfJztcbiAgLy8gQnVnIGZvciBtb3ppbGxhIHZlcnNpb25cbiAgaWYgKHJvb3QuU2V0ICYmIHR5cGVvZiBuZXcgcm9vdC5TZXQoKVsnQEBpdGVyYXRvciddID09PSAnZnVuY3Rpb24nKSB7XG4gICAgJGl0ZXJhdG9yJCA9ICdAQGl0ZXJhdG9yJztcbiAgfVxuXG4gIHZhciBkb25lRW51bWVyYXRvciA9IFJ4LmRvbmVFbnVtZXJhdG9yID0geyBkb25lOiB0cnVlLCB2YWx1ZTogdW5kZWZpbmVkIH07XG5cbiAgdmFyIGlzSXRlcmFibGUgPSBSeC5oZWxwZXJzLmlzSXRlcmFibGUgPSBmdW5jdGlvbiAobykge1xuICAgIHJldHVybiBvICYmIG9bJGl0ZXJhdG9yJF0gIT09IHVuZGVmaW5lZDtcbiAgfTtcblxuICB2YXIgaXNBcnJheUxpa2UgPSBSeC5oZWxwZXJzLmlzQXJyYXlMaWtlID0gZnVuY3Rpb24gKG8pIHtcbiAgICByZXR1cm4gbyAmJiBvLmxlbmd0aCAhPT0gdW5kZWZpbmVkO1xuICB9O1xuXG4gIFJ4LmhlbHBlcnMuaXRlcmF0b3IgPSAkaXRlcmF0b3IkO1xuXG4gIHZhciBiaW5kQ2FsbGJhY2sgPSBSeC5pbnRlcm5hbHMuYmluZENhbGxiYWNrID0gZnVuY3Rpb24gKGZ1bmMsIHRoaXNBcmcsIGFyZ0NvdW50KSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzQXJnID09PSAndW5kZWZpbmVkJykgeyByZXR1cm4gZnVuYzsgfVxuICAgIHN3aXRjaChhcmdDb3VudCkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnKVxuICAgICAgICB9O1xuICAgICAgY2FzZSAxOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCBhcmcpO1xuICAgICAgICB9XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCk7XG4gICAgICAgIH07XG4gICAgICBjYXNlIDM6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpc0FyZywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9O1xuXG4gIC8qKiBVc2VkIHRvIGRldGVybWluZSBpZiB2YWx1ZXMgYXJlIG9mIHRoZSBsYW5ndWFnZSB0eXBlIE9iamVjdCAqL1xuICB2YXIgZG9udEVudW1zID0gWyd0b1N0cmluZycsXG4gICAgJ3RvTG9jYWxlU3RyaW5nJyxcbiAgICAndmFsdWVPZicsXG4gICAgJ2hhc093blByb3BlcnR5JyxcbiAgICAnaXNQcm90b3R5cGVPZicsXG4gICAgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJyxcbiAgICAnY29uc3RydWN0b3InXSxcbiAgZG9udEVudW1zTGVuZ3RoID0gZG9udEVudW1zLmxlbmd0aDtcblxuICAvKiogYE9iamVjdCN0b1N0cmluZ2AgcmVzdWx0IHNob3J0Y3V0cyAqL1xuICB2YXIgYXJnc0NsYXNzID0gJ1tvYmplY3QgQXJndW1lbnRzXScsXG4gICAgYXJyYXlDbGFzcyA9ICdbb2JqZWN0IEFycmF5XScsXG4gICAgYm9vbENsYXNzID0gJ1tvYmplY3QgQm9vbGVhbl0nLFxuICAgIGRhdGVDbGFzcyA9ICdbb2JqZWN0IERhdGVdJyxcbiAgICBlcnJvckNsYXNzID0gJ1tvYmplY3QgRXJyb3JdJyxcbiAgICBmdW5jQ2xhc3MgPSAnW29iamVjdCBGdW5jdGlvbl0nLFxuICAgIG51bWJlckNsYXNzID0gJ1tvYmplY3QgTnVtYmVyXScsXG4gICAgb2JqZWN0Q2xhc3MgPSAnW29iamVjdCBPYmplY3RdJyxcbiAgICByZWdleHBDbGFzcyA9ICdbb2JqZWN0IFJlZ0V4cF0nLFxuICAgIHN0cmluZ0NsYXNzID0gJ1tvYmplY3QgU3RyaW5nXSc7XG5cbiAgdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxcbiAgICBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksXG4gICAgc3VwcG9ydHNBcmdzQ2xhc3MgPSB0b1N0cmluZy5jYWxsKGFyZ3VtZW50cykgPT0gYXJnc0NsYXNzLCAvLyBGb3IgbGVzcyA8SUU5ICYmIEZGPDRcbiAgICBzdXBwb3J0Tm9kZUNsYXNzLFxuICAgIGVycm9yUHJvdG8gPSBFcnJvci5wcm90b3R5cGUsXG4gICAgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlLFxuICAgIHN0cmluZ1Byb3RvID0gU3RyaW5nLnByb3RvdHlwZSxcbiAgICBwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IG9iamVjdFByb3RvLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xuXG4gIHRyeSB7XG4gICAgc3VwcG9ydE5vZGVDbGFzcyA9ICEodG9TdHJpbmcuY2FsbChkb2N1bWVudCkgPT0gb2JqZWN0Q2xhc3MgJiYgISh7ICd0b1N0cmluZyc6IDAgfSArICcnKSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBzdXBwb3J0Tm9kZUNsYXNzID0gdHJ1ZTtcbiAgfVxuXG4gIHZhciBub25FbnVtUHJvcHMgPSB7fTtcbiAgbm9uRW51bVByb3BzW2FycmF5Q2xhc3NdID0gbm9uRW51bVByb3BzW2RhdGVDbGFzc10gPSBub25FbnVtUHJvcHNbbnVtYmVyQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9Mb2NhbGVTdHJpbmcnOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlLCAndmFsdWVPZic6IHRydWUgfTtcbiAgbm9uRW51bVByb3BzW2Jvb2xDbGFzc10gPSBub25FbnVtUHJvcHNbc3RyaW5nQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlLCAndmFsdWVPZic6IHRydWUgfTtcbiAgbm9uRW51bVByb3BzW2Vycm9yQ2xhc3NdID0gbm9uRW51bVByb3BzW2Z1bmNDbGFzc10gPSBub25FbnVtUHJvcHNbcmVnZXhwQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlIH07XG4gIG5vbkVudW1Qcm9wc1tvYmplY3RDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUgfTtcblxuICB2YXIgc3VwcG9ydCA9IHt9O1xuICAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdG9yID0gZnVuY3Rpb24oKSB7IHRoaXMueCA9IDE7IH0sXG4gICAgICBwcm9wcyA9IFtdO1xuXG4gICAgY3Rvci5wcm90b3R5cGUgPSB7ICd2YWx1ZU9mJzogMSwgJ3knOiAxIH07XG4gICAgZm9yICh2YXIga2V5IGluIG5ldyBjdG9yKSB7IHByb3BzLnB1c2goa2V5KTsgfVxuICAgIGZvciAoa2V5IGluIGFyZ3VtZW50cykgeyB9XG5cbiAgICAvLyBEZXRlY3QgaWYgYG5hbWVgIG9yIGBtZXNzYWdlYCBwcm9wZXJ0aWVzIG9mIGBFcnJvci5wcm90b3R5cGVgIGFyZSBlbnVtZXJhYmxlIGJ5IGRlZmF1bHQuXG4gICAgc3VwcG9ydC5lbnVtRXJyb3JQcm9wcyA9IHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZXJyb3JQcm90bywgJ21lc3NhZ2UnKSB8fCBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGVycm9yUHJvdG8sICduYW1lJyk7XG5cbiAgICAvLyBEZXRlY3QgaWYgYHByb3RvdHlwZWAgcHJvcGVydGllcyBhcmUgZW51bWVyYWJsZSBieSBkZWZhdWx0LlxuICAgIHN1cHBvcnQuZW51bVByb3RvdHlwZXMgPSBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGN0b3IsICdwcm90b3R5cGUnKTtcblxuICAgIC8vIERldGVjdCBpZiBgYXJndW1lbnRzYCBvYmplY3QgaW5kZXhlcyBhcmUgbm9uLWVudW1lcmFibGVcbiAgICBzdXBwb3J0Lm5vbkVudW1BcmdzID0ga2V5ICE9IDA7XG5cbiAgICAvLyBEZXRlY3QgaWYgcHJvcGVydGllcyBzaGFkb3dpbmcgdGhvc2Ugb24gYE9iamVjdC5wcm90b3R5cGVgIGFyZSBub24tZW51bWVyYWJsZS5cbiAgICBzdXBwb3J0Lm5vbkVudW1TaGFkb3dzID0gIS92YWx1ZU9mLy50ZXN0KHByb3BzKTtcbiAgfSgxKSk7XG5cbiAgdmFyIGlzT2JqZWN0ID0gUnguaW50ZXJuYWxzLmlzT2JqZWN0ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICB2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcbiAgICByZXR1cm4gdmFsdWUgJiYgKHR5cGUgPT0gJ2Z1bmN0aW9uJyB8fCB0eXBlID09ICdvYmplY3QnKSB8fCBmYWxzZTtcbiAgfTtcblxuICBmdW5jdGlvbiBrZXlzSW4ob2JqZWN0KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIGlmICghaXNPYmplY3Qob2JqZWN0KSkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaWYgKHN1cHBvcnQubm9uRW51bUFyZ3MgJiYgb2JqZWN0Lmxlbmd0aCAmJiBpc0FyZ3VtZW50cyhvYmplY3QpKSB7XG4gICAgICBvYmplY3QgPSBzbGljZS5jYWxsKG9iamVjdCk7XG4gICAgfVxuICAgIHZhciBza2lwUHJvdG8gPSBzdXBwb3J0LmVudW1Qcm90b3R5cGVzICYmIHR5cGVvZiBvYmplY3QgPT0gJ2Z1bmN0aW9uJyxcbiAgICAgICAgc2tpcEVycm9yUHJvcHMgPSBzdXBwb3J0LmVudW1FcnJvclByb3BzICYmIChvYmplY3QgPT09IGVycm9yUHJvdG8gfHwgb2JqZWN0IGluc3RhbmNlb2YgRXJyb3IpO1xuXG4gICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkge1xuICAgICAgaWYgKCEoc2tpcFByb3RvICYmIGtleSA9PSAncHJvdG90eXBlJykgJiZcbiAgICAgICAgICAhKHNraXBFcnJvclByb3BzICYmIChrZXkgPT0gJ21lc3NhZ2UnIHx8IGtleSA9PSAnbmFtZScpKSkge1xuICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0Lm5vbkVudW1TaGFkb3dzICYmIG9iamVjdCAhPT0gb2JqZWN0UHJvdG8pIHtcbiAgICAgIHZhciBjdG9yID0gb2JqZWN0LmNvbnN0cnVjdG9yLFxuICAgICAgICAgIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gZG9udEVudW1zTGVuZ3RoO1xuXG4gICAgICBpZiAob2JqZWN0ID09PSAoY3RvciAmJiBjdG9yLnByb3RvdHlwZSkpIHtcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9IG9iamVjdCA9PT0gc3RyaW5nUHJvdG8gPyBzdHJpbmdDbGFzcyA6IG9iamVjdCA9PT0gZXJyb3JQcm90byA/IGVycm9yQ2xhc3MgOiB0b1N0cmluZy5jYWxsKG9iamVjdCksXG4gICAgICAgICAgICBub25FbnVtID0gbm9uRW51bVByb3BzW2NsYXNzTmFtZV07XG4gICAgICB9XG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICBrZXkgPSBkb250RW51bXNbaW5kZXhdO1xuICAgICAgICBpZiAoIShub25FbnVtICYmIG5vbkVudW1ba2V5XSkgJiYgaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkpIHtcbiAgICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBmdW5jdGlvbiBpbnRlcm5hbEZvcihvYmplY3QsIGNhbGxiYWNrLCBrZXlzRnVuYykge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgcHJvcHMgPSBrZXlzRnVuYyhvYmplY3QpLFxuICAgICAgbGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIHZhciBrZXkgPSBwcm9wc1tpbmRleF07XG4gICAgICBpZiAoY2FsbGJhY2sob2JqZWN0W2tleV0sIGtleSwgb2JqZWN0KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cblxuICBmdW5jdGlvbiBpbnRlcm5hbEZvckluKG9iamVjdCwgY2FsbGJhY2spIHtcbiAgICByZXR1cm4gaW50ZXJuYWxGb3Iob2JqZWN0LCBjYWxsYmFjaywga2V5c0luKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzTm9kZSh2YWx1ZSkge1xuICAgIC8vIElFIDwgOSBwcmVzZW50cyBET00gbm9kZXMgYXMgYE9iamVjdGAgb2JqZWN0cyBleGNlcHQgdGhleSBoYXZlIGB0b1N0cmluZ2BcbiAgICAvLyBtZXRob2RzIHRoYXQgYXJlIGB0eXBlb2ZgIFwic3RyaW5nXCIgYW5kIHN0aWxsIGNhbiBjb2VyY2Ugbm9kZXMgdG8gc3RyaW5nc1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUudG9TdHJpbmcgIT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgKHZhbHVlICsgJycpID09ICdzdHJpbmcnO1xuICB9XG5cbiAgdmFyIGlzQXJndW1lbnRzID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JykgPyB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PSBhcmdzQ2xhc3MgOiBmYWxzZTtcbiAgfVxuXG4gIC8vIGZhbGxiYWNrIGZvciBicm93c2VycyB0aGF0IGNhbid0IGRldGVjdCBgYXJndW1lbnRzYCBvYmplY3RzIGJ5IFtbQ2xhc3NdXVxuICBpZiAoIXN1cHBvcnRzQXJnc0NsYXNzKSB7XG4gICAgaXNBcmd1bWVudHMgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcpID8gaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NhbGxlZScpIDogZmFsc2U7XG4gICAgfTtcbiAgfVxuXG4gIHZhciBpc0VxdWFsID0gUnguaW50ZXJuYWxzLmlzRXF1YWwgPSBmdW5jdGlvbiAoeCwgeSkge1xuICAgIHJldHVybiBkZWVwRXF1YWxzKHgsIHksIFtdLCBbXSk7XG4gIH07XG5cbiAgLyoqIEBwcml2YXRlXG4gICAqIFVzZWQgZm9yIGRlZXAgY29tcGFyaXNvblxuICAgKiovXG4gIGZ1bmN0aW9uIGRlZXBFcXVhbHMoYSwgYiwgc3RhY2tBLCBzdGFja0IpIHtcbiAgICAvLyBleGl0IGVhcmx5IGZvciBpZGVudGljYWwgdmFsdWVzXG4gICAgaWYgKGEgPT09IGIpIHtcbiAgICAgIC8vIHRyZWF0IGArMGAgdnMuIGAtMGAgYXMgbm90IGVxdWFsXG4gICAgICByZXR1cm4gYSAhPT0gMCB8fCAoMSAvIGEgPT0gMSAvIGIpO1xuICAgIH1cblxuICAgIHZhciB0eXBlID0gdHlwZW9mIGEsXG4gICAgICAgIG90aGVyVHlwZSA9IHR5cGVvZiBiO1xuXG4gICAgLy8gZXhpdCBlYXJseSBmb3IgdW5saWtlIHByaW1pdGl2ZSB2YWx1ZXNcbiAgICBpZiAoYSA9PT0gYSAmJiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCB8fFxuICAgICAgICAodHlwZSAhPSAnZnVuY3Rpb24nICYmIHR5cGUgIT0gJ29iamVjdCcgJiYgb3RoZXJUeXBlICE9ICdmdW5jdGlvbicgJiYgb3RoZXJUeXBlICE9ICdvYmplY3QnKSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBjb21wYXJlIFtbQ2xhc3NdXSBuYW1lc1xuICAgIHZhciBjbGFzc05hbWUgPSB0b1N0cmluZy5jYWxsKGEpLFxuICAgICAgICBvdGhlckNsYXNzID0gdG9TdHJpbmcuY2FsbChiKTtcblxuICAgIGlmIChjbGFzc05hbWUgPT0gYXJnc0NsYXNzKSB7XG4gICAgICBjbGFzc05hbWUgPSBvYmplY3RDbGFzcztcbiAgICB9XG4gICAgaWYgKG90aGVyQ2xhc3MgPT0gYXJnc0NsYXNzKSB7XG4gICAgICBvdGhlckNsYXNzID0gb2JqZWN0Q2xhc3M7XG4gICAgfVxuICAgIGlmIChjbGFzc05hbWUgIT0gb3RoZXJDbGFzcykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBzd2l0Y2ggKGNsYXNzTmFtZSkge1xuICAgICAgY2FzZSBib29sQ2xhc3M6XG4gICAgICBjYXNlIGRhdGVDbGFzczpcbiAgICAgICAgLy8gY29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1iZXJzLCBkYXRlcyB0byBtaWxsaXNlY29uZHMgYW5kIGJvb2xlYW5zXG4gICAgICAgIC8vIHRvIGAxYCBvciBgMGAgdHJlYXRpbmcgaW52YWxpZCBkYXRlcyBjb2VyY2VkIHRvIGBOYU5gIGFzIG5vdCBlcXVhbFxuICAgICAgICByZXR1cm4gK2EgPT0gK2I7XG5cbiAgICAgIGNhc2UgbnVtYmVyQ2xhc3M6XG4gICAgICAgIC8vIHRyZWF0IGBOYU5gIHZzLiBgTmFOYCBhcyBlcXVhbFxuICAgICAgICByZXR1cm4gKGEgIT0gK2EpID9cbiAgICAgICAgICBiICE9ICtiIDpcbiAgICAgICAgICAvLyBidXQgdHJlYXQgYC0wYCB2cy4gYCswYCBhcyBub3QgZXF1YWxcbiAgICAgICAgICAoYSA9PSAwID8gKDEgLyBhID09IDEgLyBiKSA6IGEgPT0gK2IpO1xuXG4gICAgICBjYXNlIHJlZ2V4cENsYXNzOlxuICAgICAgY2FzZSBzdHJpbmdDbGFzczpcbiAgICAgICAgLy8gY29lcmNlIHJlZ2V4ZXMgdG8gc3RyaW5ncyAoaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS4xMC42LjQpXG4gICAgICAgIC8vIHRyZWF0IHN0cmluZyBwcmltaXRpdmVzIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIG9iamVjdCBpbnN0YW5jZXMgYXMgZXF1YWxcbiAgICAgICAgcmV0dXJuIGEgPT0gU3RyaW5nKGIpO1xuICAgIH1cbiAgICB2YXIgaXNBcnIgPSBjbGFzc05hbWUgPT0gYXJyYXlDbGFzcztcbiAgICBpZiAoIWlzQXJyKSB7XG5cbiAgICAgIC8vIGV4aXQgZm9yIGZ1bmN0aW9ucyBhbmQgRE9NIG5vZGVzXG4gICAgICBpZiAoY2xhc3NOYW1lICE9IG9iamVjdENsYXNzIHx8ICghc3VwcG9ydC5ub2RlQ2xhc3MgJiYgKGlzTm9kZShhKSB8fCBpc05vZGUoYikpKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICAvLyBpbiBvbGRlciB2ZXJzaW9ucyBvZiBPcGVyYSwgYGFyZ3VtZW50c2Agb2JqZWN0cyBoYXZlIGBBcnJheWAgY29uc3RydWN0b3JzXG4gICAgICB2YXIgY3RvckEgPSAhc3VwcG9ydC5hcmdzT2JqZWN0ICYmIGlzQXJndW1lbnRzKGEpID8gT2JqZWN0IDogYS5jb25zdHJ1Y3RvcixcbiAgICAgICAgICBjdG9yQiA9ICFzdXBwb3J0LmFyZ3NPYmplY3QgJiYgaXNBcmd1bWVudHMoYikgPyBPYmplY3QgOiBiLmNvbnN0cnVjdG9yO1xuXG4gICAgICAvLyBub24gYE9iamVjdGAgb2JqZWN0IGluc3RhbmNlcyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVhbFxuICAgICAgaWYgKGN0b3JBICE9IGN0b3JCICYmXG4gICAgICAgICAgICAhKGhhc093blByb3BlcnR5LmNhbGwoYSwgJ2NvbnN0cnVjdG9yJykgJiYgaGFzT3duUHJvcGVydHkuY2FsbChiLCAnY29uc3RydWN0b3InKSkgJiZcbiAgICAgICAgICAgICEoaXNGdW5jdGlvbihjdG9yQSkgJiYgY3RvckEgaW5zdGFuY2VvZiBjdG9yQSAmJiBpc0Z1bmN0aW9uKGN0b3JCKSAmJiBjdG9yQiBpbnN0YW5jZW9mIGN0b3JCKSAmJlxuICAgICAgICAgICAgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpXG4gICAgICAgICAgKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gYXNzdW1lIGN5Y2xpYyBzdHJ1Y3R1cmVzIGFyZSBlcXVhbFxuICAgIC8vIHRoZSBhbGdvcml0aG0gZm9yIGRldGVjdGluZyBjeWNsaWMgc3RydWN0dXJlcyBpcyBhZGFwdGVkIGZyb20gRVMgNS4xXG4gICAgLy8gc2VjdGlvbiAxNS4xMi4zLCBhYnN0cmFjdCBvcGVyYXRpb24gYEpPYCAoaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS4xMi4zKVxuICAgIHZhciBpbml0ZWRTdGFjayA9ICFzdGFja0E7XG4gICAgc3RhY2tBIHx8IChzdGFja0EgPSBbXSk7XG4gICAgc3RhY2tCIHx8IChzdGFja0IgPSBbXSk7XG5cbiAgICB2YXIgbGVuZ3RoID0gc3RhY2tBLmxlbmd0aDtcbiAgICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICAgIGlmIChzdGFja0FbbGVuZ3RoXSA9PSBhKSB7XG4gICAgICAgIHJldHVybiBzdGFja0JbbGVuZ3RoXSA9PSBiO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgc2l6ZSA9IDA7XG4gICAgdmFyIHJlc3VsdCA9IHRydWU7XG5cbiAgICAvLyBhZGQgYGFgIGFuZCBgYmAgdG8gdGhlIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzXG4gICAgc3RhY2tBLnB1c2goYSk7XG4gICAgc3RhY2tCLnB1c2goYik7XG5cbiAgICAvLyByZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgYW5kIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG4gICAgaWYgKGlzQXJyKSB7XG4gICAgICAvLyBjb21wYXJlIGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeVxuICAgICAgbGVuZ3RoID0gYS5sZW5ndGg7XG4gICAgICBzaXplID0gYi5sZW5ndGg7XG4gICAgICByZXN1bHQgPSBzaXplID09IGxlbmd0aDtcblxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAvLyBkZWVwIGNvbXBhcmUgdGhlIGNvbnRlbnRzLCBpZ25vcmluZyBub24tbnVtZXJpYyBwcm9wZXJ0aWVzXG4gICAgICAgIHdoaWxlIChzaXplLS0pIHtcbiAgICAgICAgICB2YXIgaW5kZXggPSBsZW5ndGgsXG4gICAgICAgICAgICAgIHZhbHVlID0gYltzaXplXTtcblxuICAgICAgICAgIGlmICghKHJlc3VsdCA9IGRlZXBFcXVhbHMoYVtzaXplXSwgdmFsdWUsIHN0YWNrQSwgc3RhY2tCKSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIC8vIGRlZXAgY29tcGFyZSBvYmplY3RzIHVzaW5nIGBmb3JJbmAsIGluc3RlYWQgb2YgYGZvck93bmAsIHRvIGF2b2lkIGBPYmplY3Qua2V5c2BcbiAgICAgIC8vIHdoaWNoLCBpbiB0aGlzIGNhc2UsIGlzIG1vcmUgY29zdGx5XG4gICAgICBpbnRlcm5hbEZvckluKGIsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGIpIHtcbiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYiwga2V5KSkge1xuICAgICAgICAgIC8vIGNvdW50IHRoZSBudW1iZXIgb2YgcHJvcGVydGllcy5cbiAgICAgICAgICBzaXplKys7XG4gICAgICAgICAgLy8gZGVlcCBjb21wYXJlIGVhY2ggcHJvcGVydHkgdmFsdWUuXG4gICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKGEsIGtleSkgJiYgZGVlcEVxdWFscyhhW2tleV0sIHZhbHVlLCBzdGFja0EsIHN0YWNrQikpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAvLyBlbnN1cmUgYm90aCBvYmplY3RzIGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mIHByb3BlcnRpZXNcbiAgICAgICAgaW50ZXJuYWxGb3JJbihhLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBhKSB7XG4gICAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYSwga2V5KSkge1xuICAgICAgICAgICAgLy8gYHNpemVgIHdpbGwgYmUgYC0xYCBpZiBgYWAgaGFzIG1vcmUgcHJvcGVydGllcyB0aGFuIGBiYFxuICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSAtLXNpemUgPiAtMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgc3RhY2tBLnBvcCgpO1xuICAgIHN0YWNrQi5wb3AoKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICB2YXIgaGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LFxuICAgICAgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbiAgdmFyIGluaGVyaXRzID0gUnguaW50ZXJuYWxzLmluaGVyaXRzID0gZnVuY3Rpb24gKGNoaWxkLCBwYXJlbnQpIHtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9XG4gICAgX18ucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTtcbiAgICBjaGlsZC5wcm90b3R5cGUgPSBuZXcgX18oKTtcbiAgfTtcblxuICB2YXIgYWRkUHJvcGVydGllcyA9IFJ4LmludGVybmFscy5hZGRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKG9iaikge1xuICAgIGZvcih2YXIgc291cmNlcyA9IFtdLCBpID0gMSwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG4gICAgZm9yICh2YXIgaWR4ID0gMCwgbG4gPSBzb3VyY2VzLmxlbmd0aDsgaWR4IDwgbG47IGlkeCsrKSB7XG4gICAgICB2YXIgc291cmNlID0gc291cmNlc1tpZHhdO1xuICAgICAgZm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpIHtcbiAgICAgICAgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvLyBSeCBVdGlsc1xuICB2YXIgYWRkUmVmID0gUnguaW50ZXJuYWxzLmFkZFJlZiA9IGZ1bmN0aW9uICh4cywgcikge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShyLmdldERpc3Bvc2FibGUoKSwgeHMuc3Vic2NyaWJlKG9ic2VydmVyKSk7XG4gICAgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gYXJyYXlJbml0aWFsaXplKGNvdW50LCBmYWN0b3J5KSB7XG4gICAgdmFyIGEgPSBuZXcgQXJyYXkoY291bnQpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgYVtpXSA9IGZhY3RvcnkoKTtcbiAgICB9XG4gICAgcmV0dXJuIGE7XG4gIH1cblxuICAvKipcbiAgICogUmVwcmVzZW50cyBhIGdyb3VwIG9mIGRpc3Bvc2FibGUgcmVzb3VyY2VzIHRoYXQgYXJlIGRpc3Bvc2VkIHRvZ2V0aGVyLlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIHZhciBDb21wb3NpdGVEaXNwb3NhYmxlID0gUnguQ29tcG9zaXRlRGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXJncyA9IFtdLCBpLCBsZW47XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgYXJncyA9IGFyZ3VtZW50c1swXTtcbiAgICAgIGxlbiA9IGFyZ3MubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIH1cbiAgICB0aGlzLmRpc3Bvc2FibGVzID0gYXJncztcbiAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICB0aGlzLmxlbmd0aCA9IGFyZ3MubGVuZ3RoO1xuICB9O1xuXG4gIHZhciBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlID0gQ29tcG9zaXRlRGlzcG9zYWJsZS5wcm90b3R5cGU7XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBkaXNwb3NhYmxlIHRvIHRoZSBDb21wb3NpdGVEaXNwb3NhYmxlIG9yIGRpc3Bvc2VzIHRoZSBkaXNwb3NhYmxlIGlmIHRoZSBDb21wb3NpdGVEaXNwb3NhYmxlIGlzIGRpc3Bvc2VkLlxuICAgKiBAcGFyYW0ge01peGVkfSBpdGVtIERpc3Bvc2FibGUgdG8gYWRkLlxuICAgKi9cbiAgQ29tcG9zaXRlRGlzcG9zYWJsZVByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGlmICh0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIGl0ZW0uZGlzcG9zZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRpc3Bvc2FibGVzLnB1c2goaXRlbSk7XG4gICAgICB0aGlzLmxlbmd0aCsrO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlcyBhbmQgZGlzcG9zZXMgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYSBkaXNwb3NhYmxlIGZyb20gdGhlIENvbXBvc2l0ZURpc3Bvc2FibGUuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGl0ZW0gRGlzcG9zYWJsZSB0byByZW1vdmUuXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSB0cnVlIGlmIGZvdW5kOyBmYWxzZSBvdGhlcndpc2UuXG4gICAqL1xuICBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIHNob3VsZERpc3Bvc2UgPSBmYWxzZTtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdmFyIGlkeCA9IHRoaXMuZGlzcG9zYWJsZXMuaW5kZXhPZihpdGVtKTtcbiAgICAgIGlmIChpZHggIT09IC0xKSB7XG4gICAgICAgIHNob3VsZERpc3Bvc2UgPSB0cnVlO1xuICAgICAgICB0aGlzLmRpc3Bvc2FibGVzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICB0aGlzLmxlbmd0aC0tO1xuICAgICAgICBpdGVtLmRpc3Bvc2UoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNob3VsZERpc3Bvc2U7XG4gIH07XG5cbiAgLyoqXG4gICAqICBEaXNwb3NlcyBhbGwgZGlzcG9zYWJsZXMgaW4gdGhlIGdyb3VwIGFuZCByZW1vdmVzIHRoZW0gZnJvbSB0aGUgZ3JvdXAuXG4gICAqL1xuICBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICB2YXIgbGVuID0gdGhpcy5kaXNwb3NhYmxlcy5sZW5ndGgsIGN1cnJlbnREaXNwb3NhYmxlcyA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGN1cnJlbnREaXNwb3NhYmxlc1tpXSA9IHRoaXMuZGlzcG9zYWJsZXNbaV07IH1cbiAgICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBbXTtcbiAgICAgIHRoaXMubGVuZ3RoID0gMDtcblxuICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGN1cnJlbnREaXNwb3NhYmxlc1tpXS5kaXNwb3NlKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBQcm92aWRlcyBhIHNldCBvZiBzdGF0aWMgbWV0aG9kcyBmb3IgY3JlYXRpbmcgRGlzcG9zYWJsZXMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGRpc3Bvc2UgQWN0aW9uIHRvIHJ1biBkdXJpbmcgdGhlIGZpcnN0IGNhbGwgdG8gZGlzcG9zZS4gVGhlIGFjdGlvbiBpcyBndWFyYW50ZWVkIHRvIGJlIHJ1biBhdCBtb3N0IG9uY2UuXG4gICAqL1xuICB2YXIgRGlzcG9zYWJsZSA9IFJ4LkRpc3Bvc2FibGUgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb24gfHwgbm9vcDtcbiAgfTtcblxuICAvKiogUGVyZm9ybXMgdGhlIHRhc2sgb2YgY2xlYW5pbmcgdXAgcmVzb3VyY2VzLiAqL1xuICBEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICB0aGlzLmFjdGlvbigpO1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBkaXNwb3NhYmxlIG9iamVjdCB0aGF0IGludm9rZXMgdGhlIHNwZWNpZmllZCBhY3Rpb24gd2hlbiBkaXNwb3NlZC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZGlzcG9zZSBBY3Rpb24gdG8gcnVuIGR1cmluZyB0aGUgZmlyc3QgY2FsbCB0byBkaXNwb3NlLiBUaGUgYWN0aW9uIGlzIGd1YXJhbnRlZWQgdG8gYmUgcnVuIGF0IG1vc3Qgb25jZS5cbiAgICogQHJldHVybiB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHRoYXQgcnVucyB0aGUgZ2l2ZW4gYWN0aW9uIHVwb24gZGlzcG9zYWwuXG4gICAqL1xuICB2YXIgZGlzcG9zYWJsZUNyZWF0ZSA9IERpc3Bvc2FibGUuY3JlYXRlID0gZnVuY3Rpb24gKGFjdGlvbikgeyByZXR1cm4gbmV3IERpc3Bvc2FibGUoYWN0aW9uKTsgfTtcblxuICAvKipcbiAgICogR2V0cyB0aGUgZGlzcG9zYWJsZSB0aGF0IGRvZXMgbm90aGluZyB3aGVuIGRpc3Bvc2VkLlxuICAgKi9cbiAgdmFyIGRpc3Bvc2FibGVFbXB0eSA9IERpc3Bvc2FibGUuZW1wdHkgPSB7IGRpc3Bvc2U6IG5vb3AgfTtcblxuICAvKipcbiAgICogVmFsaWRhdGVzIHdoZXRoZXIgdGhlIGdpdmVuIG9iamVjdCBpcyBhIGRpc3Bvc2FibGVcbiAgICogQHBhcmFtIHtPYmplY3R9IE9iamVjdCB0byB0ZXN0IHdoZXRoZXIgaXQgaGFzIGEgZGlzcG9zZSBtZXRob2RcbiAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgaWYgYSBkaXNwb3NhYmxlIG9iamVjdCwgZWxzZSBmYWxzZS5cbiAgICovXG4gIHZhciBpc0Rpc3Bvc2FibGUgPSBEaXNwb3NhYmxlLmlzRGlzcG9zYWJsZSA9IGZ1bmN0aW9uIChkKSB7XG4gICAgcmV0dXJuIGQgJiYgaXNGdW5jdGlvbihkLmRpc3Bvc2UpO1xuICB9O1xuXG4gIHZhciBjaGVja0Rpc3Bvc2VkID0gRGlzcG9zYWJsZS5jaGVja0Rpc3Bvc2VkID0gZnVuY3Rpb24gKGRpc3Bvc2FibGUpIHtcbiAgICBpZiAoZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkKSB7IHRocm93IG5ldyBPYmplY3REaXNwb3NlZEVycm9yKCk7IH1cbiAgfTtcblxuICB2YXIgZGlzcG9zYWJsZUZpeHVwID0gRGlzcG9zYWJsZS5fZml4dXAgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgcmV0dXJuIGlzRGlzcG9zYWJsZShyZXN1bHQpID8gcmVzdWx0IDogZGlzcG9zYWJsZUVtcHR5O1xuICB9O1xuXG4gIC8vIFNpbmdsZSBhc3NpZ25tZW50XG4gIHZhciBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSA9IFJ4LlNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG4gIH07XG4gIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlLnByb3RvdHlwZS5nZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnQ7XG4gIH07XG4gIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlLnByb3RvdHlwZS5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudCkgeyB0aHJvdyBuZXcgRXJyb3IoJ0Rpc3Bvc2FibGUgaGFzIGFscmVhZHkgYmVlbiBhc3NpZ25lZCcpOyB9XG4gICAgdmFyIHNob3VsZERpc3Bvc2UgPSB0aGlzLmlzRGlzcG9zZWQ7XG4gICAgIXNob3VsZERpc3Bvc2UgJiYgKHRoaXMuY3VycmVudCA9IHZhbHVlKTtcbiAgICBzaG91bGREaXNwb3NlICYmIHZhbHVlICYmIHZhbHVlLmRpc3Bvc2UoKTtcbiAgfTtcbiAgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICB2YXIgb2xkID0gdGhpcy5jdXJyZW50O1xuICAgICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcbiAgICAgIG9sZCAmJiBvbGQuZGlzcG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICAvLyBNdWx0aXBsZSBhc3NpZ25tZW50IGRpc3Bvc2FibGVcbiAgdmFyIFNlcmlhbERpc3Bvc2FibGUgPSBSeC5TZXJpYWxEaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG4gIH07XG4gIFNlcmlhbERpc3Bvc2FibGUucHJvdG90eXBlLmdldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudDtcbiAgfTtcbiAgU2VyaWFsRGlzcG9zYWJsZS5wcm90b3R5cGUuc2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHZhciBzaG91bGREaXNwb3NlID0gdGhpcy5pc0Rpc3Bvc2VkO1xuICAgIGlmICghc2hvdWxkRGlzcG9zZSkge1xuICAgICAgdmFyIG9sZCA9IHRoaXMuY3VycmVudDtcbiAgICAgIHRoaXMuY3VycmVudCA9IHZhbHVlO1xuICAgIH1cbiAgICBvbGQgJiYgb2xkLmRpc3Bvc2UoKTtcbiAgICBzaG91bGREaXNwb3NlICYmIHZhbHVlICYmIHZhbHVlLmRpc3Bvc2UoKTtcbiAgfTtcbiAgU2VyaWFsRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIHZhciBvbGQgPSB0aGlzLmN1cnJlbnQ7XG4gICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuICAgIH1cbiAgICBvbGQgJiYgb2xkLmRpc3Bvc2UoKTtcbiAgfTtcblxuICB2YXIgQmluYXJ5RGlzcG9zYWJsZSA9IFJ4LkJpbmFyeURpc3Bvc2FibGUgPSBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgIHRoaXMuX2ZpcnN0ID0gZmlyc3Q7XG4gICAgdGhpcy5fc2Vjb25kID0gc2Vjb25kO1xuICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICB9O1xuXG4gIEJpbmFyeURpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICB2YXIgb2xkMSA9IHRoaXMuX2ZpcnN0O1xuICAgICAgdGhpcy5fZmlyc3QgPSBudWxsO1xuICAgICAgb2xkMSAmJiBvbGQxLmRpc3Bvc2UoKTtcbiAgICAgIHZhciBvbGQyID0gdGhpcy5fc2Vjb25kO1xuICAgICAgdGhpcy5fc2Vjb25kID0gbnVsbDtcbiAgICAgIG9sZDIgJiYgb2xkMi5kaXNwb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBOQXJ5RGlzcG9zYWJsZSA9IFJ4Lk5BcnlEaXNwb3NhYmxlID0gZnVuY3Rpb24gKGRpc3Bvc2FibGVzKSB7XG4gICAgdGhpcy5fZGlzcG9zYWJsZXMgPSBkaXNwb3NhYmxlcztcbiAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgfTtcblxuICBOQXJ5RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9kaXNwb3NhYmxlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB0aGlzLl9kaXNwb3NhYmxlc1tpXS5kaXNwb3NlKCk7XG4gICAgICB9XG4gICAgICB0aGlzLl9kaXNwb3NhYmxlcy5sZW5ndGggPSAwO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUmVwcmVzZW50cyBhIGRpc3Bvc2FibGUgcmVzb3VyY2UgdGhhdCBvbmx5IGRpc3Bvc2VzIGl0cyB1bmRlcmx5aW5nIGRpc3Bvc2FibGUgcmVzb3VyY2Ugd2hlbiBhbGwgZGVwZW5kZW50IGRpc3Bvc2FibGUgb2JqZWN0cyBoYXZlIGJlZW4gZGlzcG9zZWQuXG4gICAqL1xuICB2YXIgUmVmQ291bnREaXNwb3NhYmxlID0gUnguUmVmQ291bnREaXNwb3NhYmxlID0gKGZ1bmN0aW9uICgpIHtcblxuICAgIGZ1bmN0aW9uIElubmVyRGlzcG9zYWJsZShkaXNwb3NhYmxlKSB7XG4gICAgICB0aGlzLmRpc3Bvc2FibGUgPSBkaXNwb3NhYmxlO1xuICAgICAgdGhpcy5kaXNwb3NhYmxlLmNvdW50Kys7XG4gICAgICB0aGlzLmlzSW5uZXJEaXNwb3NlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIElubmVyRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5kaXNwb3NhYmxlLmlzRGlzcG9zZWQgJiYgIXRoaXMuaXNJbm5lckRpc3Bvc2VkKSB7XG4gICAgICAgIHRoaXMuaXNJbm5lckRpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5kaXNwb3NhYmxlLmNvdW50LS07XG4gICAgICAgIGlmICh0aGlzLmRpc3Bvc2FibGUuY291bnQgPT09IDAgJiYgdGhpcy5kaXNwb3NhYmxlLmlzUHJpbWFyeURpc3Bvc2VkKSB7XG4gICAgICAgICAgdGhpcy5kaXNwb3NhYmxlLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuZGlzcG9zYWJsZS51bmRlcmx5aW5nRGlzcG9zYWJsZS5kaXNwb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIFJlZkNvdW50RGlzcG9zYWJsZSB3aXRoIHRoZSBzcGVjaWZpZWQgZGlzcG9zYWJsZS5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0Rpc3Bvc2FibGV9IGRpc3Bvc2FibGUgVW5kZXJseWluZyBkaXNwb3NhYmxlLlxuICAgICAgKi9cbiAgICBmdW5jdGlvbiBSZWZDb3VudERpc3Bvc2FibGUoZGlzcG9zYWJsZSkge1xuICAgICAgdGhpcy51bmRlcmx5aW5nRGlzcG9zYWJsZSA9IGRpc3Bvc2FibGU7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNQcmltYXJ5RGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc3Bvc2VzIHRoZSB1bmRlcmx5aW5nIGRpc3Bvc2FibGUgb25seSB3aGVuIGFsbCBkZXBlbmRlbnQgZGlzcG9zYWJsZXMgaGF2ZSBiZWVuIGRpc3Bvc2VkXG4gICAgICovXG4gICAgUmVmQ291bnREaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQgJiYgIXRoaXMuaXNQcmltYXJ5RGlzcG9zZWQpIHtcbiAgICAgICAgdGhpcy5pc1ByaW1hcnlEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLmNvdW50ID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLnVuZGVybHlpbmdEaXNwb3NhYmxlLmRpc3Bvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZGVwZW5kZW50IGRpc3Bvc2FibGUgdGhhdCB3aGVuIGRpc3Bvc2VkIGRlY3JlYXNlcyB0aGUgcmVmY291bnQgb24gdGhlIHVuZGVybHlpbmcgZGlzcG9zYWJsZS5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkZXBlbmRlbnQgZGlzcG9zYWJsZSBjb250cmlidXRpbmcgdG8gdGhlIHJlZmVyZW5jZSBjb3VudCB0aGF0IG1hbmFnZXMgdGhlIHVuZGVybHlpbmcgZGlzcG9zYWJsZSdzIGxpZmV0aW1lLlxuICAgICAqL1xuICAgIFJlZkNvdW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzRGlzcG9zZWQgPyBkaXNwb3NhYmxlRW1wdHkgOiBuZXcgSW5uZXJEaXNwb3NhYmxlKHRoaXMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gUmVmQ291bnREaXNwb3NhYmxlO1xuICB9KSgpO1xuXG4gIHZhciBTY2hlZHVsZWRJdGVtID0gUnguaW50ZXJuYWxzLlNjaGVkdWxlZEl0ZW0gPSBmdW5jdGlvbiAoc2NoZWR1bGVyLCBzdGF0ZSwgYWN0aW9uLCBkdWVUaW1lLCBjb21wYXJlcikge1xuICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcbiAgICB0aGlzLmR1ZVRpbWUgPSBkdWVUaW1lO1xuICAgIHRoaXMuY29tcGFyZXIgPSBjb21wYXJlciB8fCBkZWZhdWx0U3ViQ29tcGFyZXI7XG4gICAgdGhpcy5kaXNwb3NhYmxlID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gIH1cblxuICBTY2hlZHVsZWRJdGVtLnByb3RvdHlwZS5pbnZva2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5kaXNwb3NhYmxlLnNldERpc3Bvc2FibGUodGhpcy5pbnZva2VDb3JlKCkpO1xuICB9O1xuXG4gIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHJldHVybiB0aGlzLmNvbXBhcmVyKHRoaXMuZHVlVGltZSwgb3RoZXIuZHVlVGltZSk7XG4gIH07XG5cbiAgU2NoZWR1bGVkSXRlbS5wcm90b3R5cGUuaXNDYW5jZWxsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkO1xuICB9O1xuXG4gIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmludm9rZUNvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRpc3Bvc2FibGVGaXh1cCh0aGlzLmFjdGlvbih0aGlzLnNjaGVkdWxlciwgdGhpcy5zdGF0ZSkpO1xuICB9O1xuXG4gIC8qKiBQcm92aWRlcyBhIHNldCBvZiBzdGF0aWMgcHJvcGVydGllcyB0byBhY2Nlc3MgY29tbW9ubHkgdXNlZCBzY2hlZHVsZXJzLiAqL1xuICB2YXIgU2NoZWR1bGVyID0gUnguU2NoZWR1bGVyID0gKGZ1bmN0aW9uICgpIHtcblxuICAgIGZ1bmN0aW9uIFNjaGVkdWxlcigpIHsgfVxuXG4gICAgLyoqIERldGVybWluZXMgd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgc2NoZWR1bGVyICovXG4gICAgU2NoZWR1bGVyLmlzU2NoZWR1bGVyID0gZnVuY3Rpb24gKHMpIHtcbiAgICAgIHJldHVybiBzIGluc3RhbmNlb2YgU2NoZWR1bGVyO1xuICAgIH07XG5cbiAgICB2YXIgc2NoZWR1bGVyUHJvdG8gPSBTY2hlZHVsZXIucHJvdG90eXBlO1xuXG4gICAgLyoqXG4gICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG4gICAqIEBwYXJhbSBzdGF0ZSBTdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBiZSBleGVjdXRlZC5cbiAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuICAgKi9cbiAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG4gICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQgYWZ0ZXIgZHVlVGltZS5cbiAgICogQHBhcmFtIHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgKiBAcGFyYW0ge051bWJlcn0gZHVlVGltZSBSZWxhdGl2ZSB0aW1lIGFmdGVyIHdoaWNoIHRvIGV4ZWN1dGUgdGhlIGFjdGlvbi5cbiAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuICAgKi9cbiAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZUZ1dHVyZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZHVlVGltZSwgYWN0aW9uKSB7XG4gICAgICB2YXIgZHQgPSBkdWVUaW1lO1xuICAgICAgZHQgaW5zdGFuY2VvZiBEYXRlICYmIChkdCA9IGR0IC0gdGhpcy5ub3coKSk7XG4gICAgICBkdCA9IFNjaGVkdWxlci5ub3JtYWxpemUoZHQpO1xuXG4gICAgICBpZiAoZHQgPT09IDApIHsgcmV0dXJuIHRoaXMuc2NoZWR1bGUoc3RhdGUsIGFjdGlvbik7IH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3NjaGVkdWxlRnV0dXJlKHN0YXRlLCBkdCwgYWN0aW9uKTtcbiAgICB9O1xuXG4gICAgc2NoZWR1bGVyUHJvdG8uX3NjaGVkdWxlRnV0dXJlID0gZnVuY3Rpb24gKHN0YXRlLCBkdWVUaW1lLCBhY3Rpb24pIHtcbiAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gICAgfTtcblxuICAgIC8qKiBHZXRzIHRoZSBjdXJyZW50IHRpbWUgYWNjb3JkaW5nIHRvIHRoZSBsb2NhbCBtYWNoaW5lJ3Mgc3lzdGVtIGNsb2NrLiAqL1xuICAgIFNjaGVkdWxlci5ub3cgPSBkZWZhdWx0Tm93O1xuXG4gICAgLyoqIEdldHMgdGhlIGN1cnJlbnQgdGltZSBhY2NvcmRpbmcgdG8gdGhlIGxvY2FsIG1hY2hpbmUncyBzeXN0ZW0gY2xvY2suICovXG4gICAgU2NoZWR1bGVyLnByb3RvdHlwZS5ub3cgPSBkZWZhdWx0Tm93O1xuXG4gICAgLyoqXG4gICAgICogTm9ybWFsaXplcyB0aGUgc3BlY2lmaWVkIFRpbWVTcGFuIHZhbHVlIHRvIGEgcG9zaXRpdmUgdmFsdWUuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHRpbWVTcGFuIFRoZSB0aW1lIHNwYW4gdmFsdWUgdG8gbm9ybWFsaXplLlxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBzcGVjaWZpZWQgVGltZVNwYW4gdmFsdWUgaWYgaXQgaXMgemVybyBvciBwb3NpdGl2ZTsgb3RoZXJ3aXNlLCAwXG4gICAgICovXG4gICAgU2NoZWR1bGVyLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uICh0aW1lU3Bhbikge1xuICAgICAgdGltZVNwYW4gPCAwICYmICh0aW1lU3BhbiA9IDApO1xuICAgICAgcmV0dXJuIHRpbWVTcGFuO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2NoZWR1bGVyO1xuICB9KCkpO1xuXG4gIHZhciBub3JtYWxpemVUaW1lID0gU2NoZWR1bGVyLm5vcm1hbGl6ZSwgaXNTY2hlZHVsZXIgPSBTY2hlZHVsZXIuaXNTY2hlZHVsZXI7XG5cbiAgKGZ1bmN0aW9uIChzY2hlZHVsZXJQcm90bykge1xuXG4gICAgZnVuY3Rpb24gaW52b2tlUmVjSW1tZWRpYXRlKHNjaGVkdWxlciwgcGFpcikge1xuICAgICAgdmFyIHN0YXRlID0gcGFpclswXSwgYWN0aW9uID0gcGFpclsxXSwgZ3JvdXAgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuICAgICAgYWN0aW9uKHN0YXRlLCBpbm5lckFjdGlvbik7XG4gICAgICByZXR1cm4gZ3JvdXA7XG5cbiAgICAgIGZ1bmN0aW9uIGlubmVyQWN0aW9uKHN0YXRlMikge1xuICAgICAgICB2YXIgaXNBZGRlZCA9IGZhbHNlLCBpc0RvbmUgPSBmYWxzZTtcblxuICAgICAgICB2YXIgZCA9IHNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZTIsIHNjaGVkdWxlV29yayk7XG4gICAgICAgIGlmICghaXNEb25lKSB7XG4gICAgICAgICAgZ3JvdXAuYWRkKGQpO1xuICAgICAgICAgIGlzQWRkZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2NoZWR1bGVXb3JrKF8sIHN0YXRlMykge1xuICAgICAgICAgIGlmIChpc0FkZGVkKSB7XG4gICAgICAgICAgICBncm91cC5yZW1vdmUoZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFjdGlvbihzdGF0ZTMsIGlubmVyQWN0aW9uKTtcbiAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW52b2tlUmVjRGF0ZShzY2hlZHVsZXIsIHBhaXIpIHtcbiAgICAgIHZhciBzdGF0ZSA9IHBhaXJbMF0sIGFjdGlvbiA9IHBhaXJbMV0sIGdyb3VwID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcbiAgICAgIGFjdGlvbihzdGF0ZSwgaW5uZXJBY3Rpb24pO1xuICAgICAgcmV0dXJuIGdyb3VwO1xuXG4gICAgICBmdW5jdGlvbiBpbm5lckFjdGlvbihzdGF0ZTIsIGR1ZVRpbWUxKSB7XG4gICAgICAgIHZhciBpc0FkZGVkID0gZmFsc2UsIGlzRG9uZSA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBkID0gc2NoZWR1bGVyLnNjaGVkdWxlRnV0dXJlKHN0YXRlMiwgZHVlVGltZTEsIHNjaGVkdWxlV29yayk7XG4gICAgICAgIGlmICghaXNEb25lKSB7XG4gICAgICAgICAgZ3JvdXAuYWRkKGQpO1xuICAgICAgICAgIGlzQWRkZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2NoZWR1bGVXb3JrKF8sIHN0YXRlMykge1xuICAgICAgICAgIGlmIChpc0FkZGVkKSB7XG4gICAgICAgICAgICBncm91cC5yZW1vdmUoZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFjdGlvbihzdGF0ZTMsIGlubmVyQWN0aW9uKTtcbiAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2NoZWR1bGVzIGFuIGFjdGlvbiB0byBiZSBleGVjdXRlZCByZWN1cnNpdmVseS5cbiAgICAgKiBAcGFyYW0ge01peGVkfSBzdGF0ZSBTdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGV4ZWN1dGUgcmVjdXJzaXZlbHkuIFRoZSBsYXN0IHBhcmFtZXRlciBwYXNzZWQgdG8gdGhlIGFjdGlvbiBpcyB1c2VkIHRvIHRyaWdnZXIgcmVjdXJzaXZlIHNjaGVkdWxpbmcgb2YgdGhlIGFjdGlvbiwgcGFzc2luZyBpbiByZWN1cnNpdmUgaW52b2NhdGlvbiBzdGF0ZS5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG4gICAgICovXG4gICAgc2NoZWR1bGVyUHJvdG8uc2NoZWR1bGVSZWN1cnNpdmUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGUoW3N0YXRlLCBhY3Rpb25dLCBpbnZva2VSZWNJbW1lZGlhdGUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTY2hlZHVsZXMgYW4gYWN0aW9uIHRvIGJlIGV4ZWN1dGVkIHJlY3Vyc2l2ZWx5IGFmdGVyIGEgc3BlY2lmaWVkIHJlbGF0aXZlIG9yIGFic29sdXRlIGR1ZSB0aW1lLlxuICAgICAqIEBwYXJhbSB7TWl4ZWR9IHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gZXhlY3V0ZSByZWN1cnNpdmVseS4gVGhlIGxhc3QgcGFyYW1ldGVyIHBhc3NlZCB0byB0aGUgYWN0aW9uIGlzIHVzZWQgdG8gdHJpZ2dlciByZWN1cnNpdmUgc2NoZWR1bGluZyBvZiB0aGUgYWN0aW9uLCBwYXNzaW5nIGluIHRoZSByZWN1cnNpdmUgZHVlIHRpbWUgYW5kIGludm9jYXRpb24gc3RhdGUuXG4gICAgICogQHBhcmFtIHtOdW1iZXIgfCBEYXRlfSBkdWVUaW1lIFJlbGF0aXZlIG9yIGFic29sdXRlIHRpbWUgYWZ0ZXIgd2hpY2ggdG8gZXhlY3V0ZSB0aGUgYWN0aW9uIGZvciB0aGUgZmlyc3QgdGltZS5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG4gICAgICovXG4gICAgc2NoZWR1bGVyUHJvdG8uc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVGdXR1cmUoW3N0YXRlLCBhY3Rpb25dLCBkdWVUaW1lLCBpbnZva2VSZWNEYXRlKTtcbiAgICB9O1xuXG4gIH0oU2NoZWR1bGVyLnByb3RvdHlwZSkpO1xuXG4gIChmdW5jdGlvbiAoc2NoZWR1bGVyUHJvdG8pIHtcblxuICAgIC8qKlxuICAgICAqIFNjaGVkdWxlcyBhIHBlcmlvZGljIHBpZWNlIG9mIHdvcmsgYnkgZHluYW1pY2FsbHkgZGlzY292ZXJpbmcgdGhlIHNjaGVkdWxlcidzIGNhcGFiaWxpdGllcy4gVGhlIHBlcmlvZGljIHRhc2sgd2lsbCBiZSBzY2hlZHVsZWQgdXNpbmcgd2luZG93LnNldEludGVydmFsIGZvciB0aGUgYmFzZSBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKiBAcGFyYW0ge01peGVkfSBzdGF0ZSBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHVwb24gdGhlIGZpcnN0IGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcGVyaW9kIFBlcmlvZCBmb3IgcnVubmluZyB0aGUgd29yayBwZXJpb2RpY2FsbHkuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBiZSBleGVjdXRlZCwgcG90ZW50aWFsbHkgdXBkYXRpbmcgdGhlIHN0YXRlLlxuICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCByZWN1cnJpbmcgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG4gICAgICovXG4gICAgU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZVBlcmlvZGljID0gZnVuY3Rpb24oc3RhdGUsIHBlcmlvZCwgYWN0aW9uKSB7XG4gICAgICBpZiAodHlwZW9mIHJvb3Quc2V0SW50ZXJ2YWwgPT09ICd1bmRlZmluZWQnKSB7IHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcigpOyB9XG4gICAgICBwZXJpb2QgPSBub3JtYWxpemVUaW1lKHBlcmlvZCk7XG4gICAgICB2YXIgcyA9IHN0YXRlLCBpZCA9IHJvb3Quc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyBzID0gYWN0aW9uKHMpOyB9LCBwZXJpb2QpO1xuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkgeyByb290LmNsZWFySW50ZXJ2YWwoaWQpOyB9KTtcbiAgICB9O1xuXG4gIH0oU2NoZWR1bGVyLnByb3RvdHlwZSkpO1xuXG4gIC8qKiBHZXRzIGEgc2NoZWR1bGVyIHRoYXQgc2NoZWR1bGVzIHdvcmsgaW1tZWRpYXRlbHkgb24gdGhlIGN1cnJlbnQgdGhyZWFkLiAqL1xuICAgdmFyIEltbWVkaWF0ZVNjaGVkdWxlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoSW1tZWRpYXRlU2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEltbWVkaWF0ZVNjaGVkdWxlcigpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIEltbWVkaWF0ZVNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVGaXh1cChhY3Rpb24odGhpcywgc3RhdGUpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEltbWVkaWF0ZVNjaGVkdWxlcjtcbiAgfShTY2hlZHVsZXIpKTtcblxuICB2YXIgaW1tZWRpYXRlU2NoZWR1bGVyID0gU2NoZWR1bGVyLmltbWVkaWF0ZSA9IG5ldyBJbW1lZGlhdGVTY2hlZHVsZXIoKTtcblxuICAvKipcbiAgICogR2V0cyBhIHNjaGVkdWxlciB0aGF0IHNjaGVkdWxlcyB3b3JrIGFzIHNvb24gYXMgcG9zc2libGUgb24gdGhlIGN1cnJlbnQgdGhyZWFkLlxuICAgKi9cbiAgdmFyIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIHZhciBxdWV1ZTtcblxuICAgIGZ1bmN0aW9uIHJ1blRyYW1wb2xpbmUgKCkge1xuICAgICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmFyIGl0ZW0gPSBxdWV1ZS5kZXF1ZXVlKCk7XG4gICAgICAgICFpdGVtLmlzQ2FuY2VsbGVkKCkgJiYgaXRlbS5pbnZva2UoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpbmhlcml0cyhDdXJyZW50VGhyZWFkU2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIoKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBDdXJyZW50VGhyZWFkU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG4gICAgICB2YXIgc2kgPSBuZXcgU2NoZWR1bGVkSXRlbSh0aGlzLCBzdGF0ZSwgYWN0aW9uLCB0aGlzLm5vdygpKTtcblxuICAgICAgaWYgKCFxdWV1ZSkge1xuICAgICAgICBxdWV1ZSA9IG5ldyBQcmlvcml0eVF1ZXVlKDQpO1xuICAgICAgICBxdWV1ZS5lbnF1ZXVlKHNpKTtcblxuICAgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2gocnVuVHJhbXBvbGluZSkoKTtcbiAgICAgICAgcXVldWUgPSBudWxsO1xuICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyB0aHJvd2VyKHJlc3VsdC5lKTsgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWUuZW5xdWV1ZShzaSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2kuZGlzcG9zYWJsZTtcbiAgICB9O1xuXG4gICAgQ3VycmVudFRocmVhZFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGVSZXF1aXJlZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICFxdWV1ZTsgfTtcblxuICAgIHJldHVybiBDdXJyZW50VGhyZWFkU2NoZWR1bGVyO1xuICB9KFNjaGVkdWxlcikpO1xuXG4gIHZhciBjdXJyZW50VGhyZWFkU2NoZWR1bGVyID0gU2NoZWR1bGVyLmN1cnJlbnRUaHJlYWQgPSBuZXcgQ3VycmVudFRocmVhZFNjaGVkdWxlcigpO1xuXG4gIHZhciBTY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlID0gUnguaW50ZXJuYWxzLlNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVRpY2soc2VsZikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHRpY2soY29tbWFuZCwgcmVjdXJzZSkge1xuICAgICAgICByZWN1cnNlKDAsIHNlbGYuX3BlcmlvZCk7XG4gICAgICAgIHZhciBzdGF0ZSA9IHRyeUNhdGNoKHNlbGYuX2FjdGlvbikoc2VsZi5fc3RhdGUpO1xuICAgICAgICBpZiAoc3RhdGUgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgc2VsZi5fY2FuY2VsLmRpc3Bvc2UoKTtcbiAgICAgICAgICB0aHJvd2VyKHN0YXRlLmUpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuX3N0YXRlID0gc3RhdGU7XG4gICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIFNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUoc2NoZWR1bGVyLCBzdGF0ZSwgcGVyaW9kLCBhY3Rpb24pIHtcbiAgICAgIHRoaXMuX3NjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICB0aGlzLl9wZXJpb2QgPSBwZXJpb2Q7XG4gICAgICB0aGlzLl9hY3Rpb24gPSBhY3Rpb247XG4gICAgfVxuXG4gICAgU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgdGhpcy5fY2FuY2VsID0gZDtcbiAgICAgIGQuc2V0RGlzcG9zYWJsZSh0aGlzLl9zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUoMCwgdGhpcy5fcGVyaW9kLCBjcmVhdGVUaWNrKHRoaXMpKSk7XG5cbiAgICAgIHJldHVybiBkO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZTtcbiAgfSgpKTtcblxuICB2YXIgc2NoZWR1bGVNZXRob2QsIGNsZWFyTWV0aG9kO1xuXG4gIHZhciBsb2NhbFRpbWVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbG9jYWxTZXRUaW1lb3V0LCBsb2NhbENsZWFyVGltZW91dCA9IG5vb3A7XG4gICAgaWYgKCEhcm9vdC5zZXRUaW1lb3V0KSB7XG4gICAgICBsb2NhbFNldFRpbWVvdXQgPSByb290LnNldFRpbWVvdXQ7XG4gICAgICBsb2NhbENsZWFyVGltZW91dCA9IHJvb3QuY2xlYXJUaW1lb3V0O1xuICAgIH0gZWxzZSBpZiAoISFyb290LldTY3JpcHQpIHtcbiAgICAgIGxvY2FsU2V0VGltZW91dCA9IGZ1bmN0aW9uIChmbiwgdGltZSkge1xuICAgICAgICByb290LldTY3JpcHQuU2xlZXAodGltZSk7XG4gICAgICAgIGZuKCk7XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgTm90U3VwcG9ydGVkRXJyb3IoKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc2V0VGltZW91dDogbG9jYWxTZXRUaW1lb3V0LFxuICAgICAgY2xlYXJUaW1lb3V0OiBsb2NhbENsZWFyVGltZW91dFxuICAgIH07XG4gIH0oKSk7XG4gIHZhciBsb2NhbFNldFRpbWVvdXQgPSBsb2NhbFRpbWVyLnNldFRpbWVvdXQsXG4gICAgbG9jYWxDbGVhclRpbWVvdXQgPSBsb2NhbFRpbWVyLmNsZWFyVGltZW91dDtcblxuICAoZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIG5leHRIYW5kbGUgPSAxLCB0YXNrc0J5SGFuZGxlID0ge30sIGN1cnJlbnRseVJ1bm5pbmcgPSBmYWxzZTtcblxuICAgIGNsZWFyTWV0aG9kID0gZnVuY3Rpb24gKGhhbmRsZSkge1xuICAgICAgZGVsZXRlIHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcnVuVGFzayhoYW5kbGUpIHtcbiAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nKSB7XG4gICAgICAgIGxvY2FsU2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJ1blRhc2soaGFuZGxlKTsgfSwgMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdGFzayA9IHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcbiAgICAgICAgaWYgKHRhc2spIHtcbiAgICAgICAgICBjdXJyZW50bHlSdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGFzaykoKTtcbiAgICAgICAgICBjbGVhck1ldGhvZChoYW5kbGUpO1xuICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyB0aHJvd2VyKHJlc3VsdC5lKTsgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHJlTmF0aXZlID0gbmV3IFJlZ0V4cCgnXicgK1xuICAgICAgU3RyaW5nKHRvU3RyaW5nKVxuICAgICAgICAucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKVxuICAgICAgICAucmVwbGFjZSgvdG9TdHJpbmd8IGZvciBbXlxcXV0rL2csICcuKj8nKSArICckJ1xuICAgICk7XG5cbiAgICB2YXIgc2V0SW1tZWRpYXRlID0gdHlwZW9mIChzZXRJbW1lZGlhdGUgPSBmcmVlR2xvYmFsICYmIG1vZHVsZUV4cG9ydHMgJiYgZnJlZUdsb2JhbC5zZXRJbW1lZGlhdGUpID09ICdmdW5jdGlvbicgJiZcbiAgICAgICFyZU5hdGl2ZS50ZXN0KHNldEltbWVkaWF0ZSkgJiYgc2V0SW1tZWRpYXRlO1xuXG4gICAgZnVuY3Rpb24gcG9zdE1lc3NhZ2VTdXBwb3J0ZWQgKCkge1xuICAgICAgLy8gRW5zdXJlIG5vdCBpbiBhIHdvcmtlclxuICAgICAgaWYgKCFyb290LnBvc3RNZXNzYWdlIHx8IHJvb3QuaW1wb3J0U2NyaXB0cykgeyByZXR1cm4gZmFsc2U7IH1cbiAgICAgIHZhciBpc0FzeW5jID0gZmFsc2UsIG9sZEhhbmRsZXIgPSByb290Lm9ubWVzc2FnZTtcbiAgICAgIC8vIFRlc3QgZm9yIGFzeW5jXG4gICAgICByb290Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uICgpIHsgaXNBc3luYyA9IHRydWU7IH07XG4gICAgICByb290LnBvc3RNZXNzYWdlKCcnLCAnKicpO1xuICAgICAgcm9vdC5vbm1lc3NhZ2UgPSBvbGRIYW5kbGVyO1xuXG4gICAgICByZXR1cm4gaXNBc3luYztcbiAgICB9XG5cbiAgICAvLyBVc2UgaW4gb3JkZXIsIHNldEltbWVkaWF0ZSwgbmV4dFRpY2ssIHBvc3RNZXNzYWdlLCBNZXNzYWdlQ2hhbm5lbCwgc2NyaXB0IHJlYWR5c3RhdGVjaGFuZ2VkLCBzZXRUaW1lb3V0XG4gICAgaWYgKGlzRnVuY3Rpb24oc2V0SW1tZWRpYXRlKSkge1xuICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcbiAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG4gICAgICAgIHNldEltbWVkaWF0ZShmdW5jdGlvbiAoKSB7IHJ1blRhc2soaWQpOyB9KTtcblxuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHt9LnRvU3RyaW5nLmNhbGwocHJvY2VzcykgPT09ICdbb2JqZWN0IHByb2Nlc3NdJykge1xuICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcbiAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG4gICAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkgeyBydW5UYXNrKGlkKTsgfSk7XG5cbiAgICAgICAgcmV0dXJuIGlkO1xuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHBvc3RNZXNzYWdlU3VwcG9ydGVkKCkpIHtcbiAgICAgIHZhciBNU0dfUFJFRklYID0gJ21zLnJ4LnNjaGVkdWxlJyArIE1hdGgucmFuZG9tKCk7XG5cbiAgICAgIHZhciBvbkdsb2JhbFBvc3RNZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIE9ubHkgaWYgd2UncmUgYSBtYXRjaCB0byBhdm9pZCBhbnkgb3RoZXIgZ2xvYmFsIGV2ZW50c1xuICAgICAgICBpZiAodHlwZW9mIGV2ZW50LmRhdGEgPT09ICdzdHJpbmcnICYmIGV2ZW50LmRhdGEuc3Vic3RyaW5nKDAsIE1TR19QUkVGSVgubGVuZ3RoKSA9PT0gTVNHX1BSRUZJWCkge1xuICAgICAgICAgIHJ1blRhc2soZXZlbnQuZGF0YS5zdWJzdHJpbmcoTVNHX1BSRUZJWC5sZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgcm9vdC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgb25HbG9iYWxQb3N0TWVzc2FnZSwgZmFsc2UpO1xuXG4gICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcbiAgICAgICAgcm9vdC5wb3N0TWVzc2FnZShNU0dfUFJFRklYICsgY3VycmVudElkLCAnKicpO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAoISFyb290Lk1lc3NhZ2VDaGFubmVsKSB7XG4gICAgICB2YXIgY2hhbm5lbCA9IG5ldyByb290Lk1lc3NhZ2VDaGFubmVsKCk7XG5cbiAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsgcnVuVGFzayhlLmRhdGEpOyB9O1xuXG4gICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcbiAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZShpZCk7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmICgnZG9jdW1lbnQnIGluIHJvb3QgJiYgJ29ucmVhZHlzdGF0ZWNoYW5nZScgaW4gcm9vdC5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKSkge1xuXG4gICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIHNjcmlwdEVsZW1lbnQgPSByb290LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG4gICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuXG4gICAgICAgIHNjcmlwdEVsZW1lbnQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJ1blRhc2soaWQpO1xuICAgICAgICAgIHNjcmlwdEVsZW1lbnQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICBzY3JpcHRFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0RWxlbWVudCk7XG4gICAgICAgICAgc2NyaXB0RWxlbWVudCA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIHJvb3QuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKHNjcmlwdEVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG4gICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuICAgICAgICBsb2NhbFNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJ1blRhc2soaWQpO1xuICAgICAgICB9LCAwKTtcblxuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuICAgIH1cbiAgfSgpKTtcblxuICAvKipcbiAgICogR2V0cyBhIHNjaGVkdWxlciB0aGF0IHNjaGVkdWxlcyB3b3JrIHZpYSBhIHRpbWVkIGNhbGxiYWNrIGJhc2VkIHVwb24gcGxhdGZvcm0uXG4gICAqL1xuICAgdmFyIERlZmF1bHRTY2hlZHVsZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgICBpbmhlcml0cyhEZWZhdWx0U2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuICAgICBmdW5jdGlvbiBEZWZhdWx0U2NoZWR1bGVyKCkge1xuICAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgICB9XG5cbiAgICAgZnVuY3Rpb24gc2NoZWR1bGVBY3Rpb24oZGlzcG9zYWJsZSwgYWN0aW9uLCBzY2hlZHVsZXIsIHN0YXRlKSB7XG4gICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNjaGVkdWxlKCkge1xuICAgICAgICAgIWRpc3Bvc2FibGUuaXNEaXNwb3NlZCAmJiBkaXNwb3NhYmxlLnNldERpc3Bvc2FibGUoRGlzcG9zYWJsZS5fZml4dXAoYWN0aW9uKHNjaGVkdWxlciwgc3RhdGUpKSk7XG4gICAgICAgfTtcbiAgICAgfVxuXG4gICAgIGZ1bmN0aW9uIENsZWFyRGlzcG9zYWJsZShtZXRob2QsIGlkKSB7XG4gICAgICAgdGhpcy5faWQgPSBpZDtcbiAgICAgICB0aGlzLl9tZXRob2QgPSBtZXRob2Q7XG4gICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgIH1cblxuICAgICBDbGVhckRpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICB0aGlzLl9tZXRob2QuY2FsbChudWxsLCB0aGlzLl9pZCk7XG4gICAgICAgfVxuICAgICB9O1xuXG4gICAgRGVmYXVsdFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuICAgICAgdmFyIGRpc3Bvc2FibGUgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcbiAgICAgICAgICBpZCA9IHNjaGVkdWxlTWV0aG9kKHNjaGVkdWxlQWN0aW9uKGRpc3Bvc2FibGUsIGFjdGlvbiwgdGhpcywgc3RhdGUpKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShkaXNwb3NhYmxlLCBuZXcgQ2xlYXJEaXNwb3NhYmxlKGNsZWFyTWV0aG9kLCBpZCkpO1xuICAgIH07XG5cbiAgICBEZWZhdWx0U2NoZWR1bGVyLnByb3RvdHlwZS5fc2NoZWR1bGVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuICAgICAgaWYgKGR1ZVRpbWUgPT09IDApIHsgcmV0dXJuIHRoaXMuc2NoZWR1bGUoc3RhdGUsIGFjdGlvbik7IH1cbiAgICAgIHZhciBkaXNwb3NhYmxlID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksXG4gICAgICAgICAgaWQgPSBsb2NhbFNldFRpbWVvdXQoc2NoZWR1bGVBY3Rpb24oZGlzcG9zYWJsZSwgYWN0aW9uLCB0aGlzLCBzdGF0ZSksIGR1ZVRpbWUpO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKGRpc3Bvc2FibGUsIG5ldyBDbGVhckRpc3Bvc2FibGUobG9jYWxDbGVhclRpbWVvdXQsIGlkKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBEZWZhdWx0U2NoZWR1bGVyO1xuICB9KFNjaGVkdWxlcikpO1xuXG4gIHZhciBkZWZhdWx0U2NoZWR1bGVyID0gU2NoZWR1bGVyWydkZWZhdWx0J10gPSBTY2hlZHVsZXIuYXN5bmMgPSBuZXcgRGVmYXVsdFNjaGVkdWxlcigpO1xuXG4gIGZ1bmN0aW9uIEluZGV4ZWRJdGVtKGlkLCB2YWx1ZSkge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICBJbmRleGVkSXRlbS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGMgPSB0aGlzLnZhbHVlLmNvbXBhcmVUbyhvdGhlci52YWx1ZSk7XG4gICAgYyA9PT0gMCAmJiAoYyA9IHRoaXMuaWQgLSBvdGhlci5pZCk7XG4gICAgcmV0dXJuIGM7XG4gIH07XG5cbiAgdmFyIFByaW9yaXR5UXVldWUgPSBSeC5pbnRlcm5hbHMuUHJpb3JpdHlRdWV1ZSA9IGZ1bmN0aW9uIChjYXBhY2l0eSkge1xuICAgIHRoaXMuaXRlbXMgPSBuZXcgQXJyYXkoY2FwYWNpdHkpO1xuICAgIHRoaXMubGVuZ3RoID0gMDtcbiAgfTtcblxuICB2YXIgcHJpb3JpdHlQcm90byA9IFByaW9yaXR5UXVldWUucHJvdG90eXBlO1xuICBwcmlvcml0eVByb3RvLmlzSGlnaGVyUHJpb3JpdHkgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcbiAgICByZXR1cm4gdGhpcy5pdGVtc1tsZWZ0XS5jb21wYXJlVG8odGhpcy5pdGVtc1tyaWdodF0pIDwgMDtcbiAgfTtcblxuICBwcmlvcml0eVByb3RvLnBlcmNvbGF0ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCB8fCBpbmRleCA8IDApIHsgcmV0dXJuOyB9XG4gICAgdmFyIHBhcmVudCA9IGluZGV4IC0gMSA+PiAxO1xuICAgIGlmIChwYXJlbnQgPCAwIHx8IHBhcmVudCA9PT0gaW5kZXgpIHsgcmV0dXJuOyB9XG4gICAgaWYgKHRoaXMuaXNIaWdoZXJQcmlvcml0eShpbmRleCwgcGFyZW50KSkge1xuICAgICAgdmFyIHRlbXAgPSB0aGlzLml0ZW1zW2luZGV4XTtcbiAgICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gdGhpcy5pdGVtc1twYXJlbnRdO1xuICAgICAgdGhpcy5pdGVtc1twYXJlbnRdID0gdGVtcDtcbiAgICAgIHRoaXMucGVyY29sYXRlKHBhcmVudCk7XG4gICAgfVxuICB9O1xuXG4gIHByaW9yaXR5UHJvdG8uaGVhcGlmeSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICtpbmRleCB8fCAoaW5kZXggPSAwKTtcbiAgICBpZiAoaW5kZXggPj0gdGhpcy5sZW5ndGggfHwgaW5kZXggPCAwKSB7IHJldHVybjsgfVxuICAgIHZhciBsZWZ0ID0gMiAqIGluZGV4ICsgMSxcbiAgICAgICAgcmlnaHQgPSAyICogaW5kZXggKyAyLFxuICAgICAgICBmaXJzdCA9IGluZGV4O1xuICAgIGlmIChsZWZ0IDwgdGhpcy5sZW5ndGggJiYgdGhpcy5pc0hpZ2hlclByaW9yaXR5KGxlZnQsIGZpcnN0KSkge1xuICAgICAgZmlyc3QgPSBsZWZ0O1xuICAgIH1cbiAgICBpZiAocmlnaHQgPCB0aGlzLmxlbmd0aCAmJiB0aGlzLmlzSGlnaGVyUHJpb3JpdHkocmlnaHQsIGZpcnN0KSkge1xuICAgICAgZmlyc3QgPSByaWdodDtcbiAgICB9XG4gICAgaWYgKGZpcnN0ICE9PSBpbmRleCkge1xuICAgICAgdmFyIHRlbXAgPSB0aGlzLml0ZW1zW2luZGV4XTtcbiAgICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gdGhpcy5pdGVtc1tmaXJzdF07XG4gICAgICB0aGlzLml0ZW1zW2ZpcnN0XSA9IHRlbXA7XG4gICAgICB0aGlzLmhlYXBpZnkoZmlyc3QpO1xuICAgIH1cbiAgfTtcblxuICBwcmlvcml0eVByb3RvLnBlZWsgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLml0ZW1zWzBdLnZhbHVlOyB9O1xuXG4gIHByaW9yaXR5UHJvdG8ucmVtb3ZlQXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICB0aGlzLml0ZW1zW2luZGV4XSA9IHRoaXMuaXRlbXNbLS10aGlzLmxlbmd0aF07XG4gICAgdGhpcy5pdGVtc1t0aGlzLmxlbmd0aF0gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5oZWFwaWZ5KCk7XG4gIH07XG5cbiAgcHJpb3JpdHlQcm90by5kZXF1ZXVlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciByZXN1bHQgPSB0aGlzLnBlZWsoKTtcbiAgICB0aGlzLnJlbW92ZUF0KDApO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgcHJpb3JpdHlQcm90by5lbnF1ZXVlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLmxlbmd0aCsrO1xuICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gbmV3IEluZGV4ZWRJdGVtKFByaW9yaXR5UXVldWUuY291bnQrKywgaXRlbSk7XG4gICAgdGhpcy5wZXJjb2xhdGUoaW5kZXgpO1xuICB9O1xuXG4gIHByaW9yaXR5UHJvdG8ucmVtb3ZlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLml0ZW1zW2ldLnZhbHVlID09PSBpdGVtKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlQXQoaSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIFByaW9yaXR5UXVldWUuY291bnQgPSAwO1xuXG4gIC8qKlxuICAgKiAgUmVwcmVzZW50cyBhIG5vdGlmaWNhdGlvbiB0byBhbiBvYnNlcnZlci5cbiAgICovXG4gIHZhciBOb3RpZmljYXRpb24gPSBSeC5Ob3RpZmljYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE5vdGlmaWNhdGlvbigpIHtcblxuICAgIH1cblxuICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICAgIH07XG5cbiAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHRPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEludm9rZXMgdGhlIGRlbGVnYXRlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIG5vdGlmaWNhdGlvbiBvciB0aGUgb2JzZXJ2ZXIncyBtZXRob2QgY29ycmVzcG9uZGluZyB0byB0aGUgbm90aWZpY2F0aW9uIGFuZCByZXR1cm5zIHRoZSBwcm9kdWNlZCByZXN1bHQuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTm90aWZpY2F0aW9uXG4gICAgICogQHBhcmFtIHtBbnl9IG9ic2VydmVyT3JPbk5leHQgRGVsZWdhdGUgdG8gaW52b2tlIGZvciBhbiBPbk5leHQgbm90aWZpY2F0aW9uIG9yIE9ic2VydmVyIHRvIGludm9rZSB0aGUgbm90aWZpY2F0aW9uIG9uLi5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkVycm9yIERlbGVnYXRlIHRvIGludm9rZSBmb3IgYW4gT25FcnJvciBub3RpZmljYXRpb24uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25Db21wbGV0ZWQgRGVsZWdhdGUgdG8gaW52b2tlIGZvciBhbiBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24uXG4gICAgICogQHJldHVybnMge0FueX0gUmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBvYnNlcnZhdGlvbi5cbiAgICAgKi9cbiAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uIChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuICAgICAgcmV0dXJuIG9ic2VydmVyT3JPbk5leHQgJiYgdHlwZW9mIG9ic2VydmVyT3JPbk5leHQgPT09ICdvYmplY3QnID9cbiAgICAgICAgdGhpcy5fYWNjZXB0T2JzZXJ2YWJsZShvYnNlcnZlck9yT25OZXh0KSA6XG4gICAgICAgIHRoaXMuX2FjY2VwdChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIGEgc2luZ2xlIG5vdGlmaWNhdGlvbi5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBOb3RpZmljYXRpb25zXG4gICAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBzZW5kIG91dCB0aGUgbm90aWZpY2F0aW9uIGNhbGxzIG9uLlxuICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHN1cmZhY2VzIHRoZSBiZWhhdmlvciBvZiB0aGUgbm90aWZpY2F0aW9uIHVwb24gc3Vic2NyaXB0aW9uLlxuICAgICAqL1xuICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9PYnNlcnZhYmxlID0gZnVuY3Rpb24gKHNjaGVkdWxlcikge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcbiAgICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKHNlbGYsIGZ1bmN0aW9uIChfLCBub3RpZmljYXRpb24pIHtcbiAgICAgICAgICBub3RpZmljYXRpb24uX2FjY2VwdE9ic2VydmFibGUobyk7XG4gICAgICAgICAgbm90aWZpY2F0aW9uLmtpbmQgPT09ICdOJyAmJiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiBOb3RpZmljYXRpb247XG4gIH0pKCk7XG5cbiAgdmFyIE9uTmV4dE5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoT25OZXh0Tm90aWZpY2F0aW9uLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE9uTmV4dE5vdGlmaWNhdGlvbih2YWx1ZSkge1xuICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgdGhpcy5raW5kID0gJ04nO1xuICAgIH1cblxuICAgIE9uTmV4dE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQpIHtcbiAgICAgIHJldHVybiBvbk5leHQodGhpcy52YWx1ZSk7XG4gICAgfTtcblxuICAgIE9uTmV4dE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIG8ub25OZXh0KHRoaXMudmFsdWUpO1xuICAgIH07XG5cbiAgICBPbk5leHROb3RpZmljYXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuICdPbk5leHQoJyArIHRoaXMudmFsdWUgKyAnKSc7XG4gICAgfTtcblxuICAgIHJldHVybiBPbk5leHROb3RpZmljYXRpb247XG4gIH0oTm90aWZpY2F0aW9uKSk7XG5cbiAgdmFyIE9uRXJyb3JOb3RpZmljYXRpb24gPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE9uRXJyb3JOb3RpZmljYXRpb24sIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gT25FcnJvck5vdGlmaWNhdGlvbihlcnJvcikge1xuICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgdGhpcy5raW5kID0gJ0UnO1xuICAgIH1cblxuICAgIE9uRXJyb3JOb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHQgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yKSB7XG4gICAgICByZXR1cm4gb25FcnJvcih0aGlzLmVycm9yKTtcbiAgICB9O1xuXG4gICAgT25FcnJvck5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIG8ub25FcnJvcih0aGlzLmVycm9yKTtcbiAgICB9O1xuXG4gICAgT25FcnJvck5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gJ09uRXJyb3IoJyArIHRoaXMuZXJyb3IgKyAnKSc7XG4gICAgfTtcblxuICAgIHJldHVybiBPbkVycm9yTm90aWZpY2F0aW9uO1xuICB9KE5vdGlmaWNhdGlvbikpO1xuXG4gIHZhciBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoT25Db21wbGV0ZWROb3RpZmljYXRpb24sIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gT25Db21wbGV0ZWROb3RpZmljYXRpb24oKSB7XG4gICAgICB0aGlzLmtpbmQgPSAnQyc7XG4gICAgfVxuXG4gICAgT25Db21wbGV0ZWROb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHQgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuICAgICAgcmV0dXJuIG9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gJ09uQ29tcGxldGVkKCknO1xuICAgIH07XG5cbiAgICByZXR1cm4gT25Db21wbGV0ZWROb3RpZmljYXRpb247XG4gIH0oTm90aWZpY2F0aW9uKSk7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhbiBPbk5leHQgbm90aWZpY2F0aW9uIHRvIGFuIG9ic2VydmVyLlxuICAgKiBAcGFyYW0ge0FueX0gdmFsdWUgVGhlIHZhbHVlIGNvbnRhaW5lZCBpbiB0aGUgbm90aWZpY2F0aW9uLlxuICAgKiBAcmV0dXJucyB7Tm90aWZpY2F0aW9ufSBUaGUgT25OZXh0IG5vdGlmaWNhdGlvbiBjb250YWluaW5nIHRoZSB2YWx1ZS5cbiAgICovXG4gIHZhciBub3RpZmljYXRpb25DcmVhdGVPbk5leHQgPSBOb3RpZmljYXRpb24uY3JlYXRlT25OZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgcmV0dXJuIG5ldyBPbk5leHROb3RpZmljYXRpb24odmFsdWUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgYW4gT25FcnJvciBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG4gICAqIEBwYXJhbSB7QW55fSBlcnJvciBUaGUgZXhjZXB0aW9uIGNvbnRhaW5lZCBpbiB0aGUgbm90aWZpY2F0aW9uLlxuICAgKiBAcmV0dXJucyB7Tm90aWZpY2F0aW9ufSBUaGUgT25FcnJvciBub3RpZmljYXRpb24gY29udGFpbmluZyB0aGUgZXhjZXB0aW9uLlxuICAgKi9cbiAgdmFyIG5vdGlmaWNhdGlvbkNyZWF0ZU9uRXJyb3IgPSBOb3RpZmljYXRpb24uY3JlYXRlT25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgIHJldHVybiBuZXcgT25FcnJvck5vdGlmaWNhdGlvbihlcnJvcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhbiBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG4gICAqIEByZXR1cm5zIHtOb3RpZmljYXRpb259IFRoZSBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24uXG4gICAqL1xuICB2YXIgbm90aWZpY2F0aW9uQ3JlYXRlT25Db21wbGV0ZWQgPSBOb3RpZmljYXRpb24uY3JlYXRlT25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbigpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdXBwb3J0cyBwdXNoLXN0eWxlIGl0ZXJhdGlvbiBvdmVyIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqL1xuICB2YXIgT2JzZXJ2ZXIgPSBSeC5PYnNlcnZlciA9IGZ1bmN0aW9uICgpIHsgfTtcblxuICAvKipcbiAgICogIENyZWF0ZXMgYW4gb2JzZXJ2ZXIgZnJvbSB0aGUgc3BlY2lmaWVkIE9uTmV4dCwgYWxvbmcgd2l0aCBvcHRpb25hbCBPbkVycm9yLCBhbmQgT25Db21wbGV0ZWQgYWN0aW9ucy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uTmV4dF0gT2JzZXJ2ZXIncyBPbk5leHQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25FcnJvcl0gT2JzZXJ2ZXIncyBPbkVycm9yIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uQ29tcGxldGVkXSBPYnNlcnZlcidzIE9uQ29tcGxldGVkIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICogQHJldHVybnMge09ic2VydmVyfSBUaGUgb2JzZXJ2ZXIgb2JqZWN0IGltcGxlbWVudGVkIHVzaW5nIHRoZSBnaXZlbiBhY3Rpb25zLlxuICAgKi9cbiAgdmFyIG9ic2VydmVyQ3JlYXRlID0gT2JzZXJ2ZXIuY3JlYXRlID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcbiAgICBvbk5leHQgfHwgKG9uTmV4dCA9IG5vb3ApO1xuICAgIG9uRXJyb3IgfHwgKG9uRXJyb3IgPSBkZWZhdWx0RXJyb3IpO1xuICAgIG9uQ29tcGxldGVkIHx8IChvbkNvbXBsZXRlZCA9IG5vb3ApO1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2ZXIob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgT2JzZXJ2ZXIgY2xhc3MuXG4gICAqIFRoaXMgYmFzZSBjbGFzcyBlbmZvcmNlcyB0aGUgZ3JhbW1hciBvZiBvYnNlcnZlcnMgd2hlcmUgT25FcnJvciBhbmQgT25Db21wbGV0ZWQgYXJlIHRlcm1pbmFsIG1lc3NhZ2VzLlxuICAgKi9cbiAgdmFyIEFic3RyYWN0T2JzZXJ2ZXIgPSBSeC5pbnRlcm5hbHMuQWJzdHJhY3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQWJzdHJhY3RPYnNlcnZlciwgX19zdXBlcl9fKTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgb2JzZXJ2ZXIgaW4gYSBub24tc3RvcHBlZCBzdGF0ZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBYnN0cmFjdE9ic2VydmVyKCkge1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBNdXN0IGJlIGltcGxlbWVudGVkIGJ5IG90aGVyIG9ic2VydmVyc1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBub3RJbXBsZW1lbnRlZDtcbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IG5vdEltcGxlbWVudGVkO1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IG5vdEltcGxlbWVudGVkO1xuXG4gICAgLyoqXG4gICAgICogTm90aWZpZXMgdGhlIG9ic2VydmVyIG9mIGEgbmV3IGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuICAgICAqIEBwYXJhbSB7QW55fSB2YWx1ZSBOZXh0IGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuICAgICAqL1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgIXRoaXMuaXNTdG9wcGVkICYmIHRoaXMubmV4dCh2YWx1ZSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIHRoZSBvYnNlcnZlciB0aGF0IGFuIGV4Y2VwdGlvbiBoYXMgb2NjdXJyZWQuXG4gICAgICogQHBhcmFtIHtBbnl9IGVycm9yIFRoZSBlcnJvciB0aGF0IGhhcyBvY2N1cnJlZC5cbiAgICAgKi9cbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIHRoZSBvYnNlcnZlciBvZiB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZS5cbiAgICAgKi9cbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlcyB0aGUgb2JzZXJ2ZXIsIGNhdXNpbmcgaXQgdG8gdHJhbnNpdGlvbiB0byB0aGUgc3RvcHBlZCBzdGF0ZS5cbiAgICAgKi9cbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmVycm9yKGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICByZXR1cm4gQWJzdHJhY3RPYnNlcnZlcjtcbiAgfShPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBDbGFzcyB0byBjcmVhdGUgYW4gT2JzZXJ2ZXIgaW5zdGFuY2UgZnJvbSBkZWxlZ2F0ZS1iYXNlZCBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIG9uKiBtZXRob2RzLlxuICAgKi9cbiAgdmFyIEFub255bW91c09ic2VydmVyID0gUnguQW5vbnltb3VzT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEFub255bW91c09ic2VydmVyLCBfX3N1cGVyX18pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBvYnNlcnZlciBmcm9tIHRoZSBzcGVjaWZpZWQgT25OZXh0LCBPbkVycm9yLCBhbmQgT25Db21wbGV0ZWQgYWN0aW9ucy5cbiAgICAgKiBAcGFyYW0ge0FueX0gb25OZXh0IE9ic2VydmVyJ3MgT25OZXh0IGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FueX0gb25FcnJvciBPYnNlcnZlcidzIE9uRXJyb3IgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgICAqIEBwYXJhbSB7QW55fSBvbkNvbXBsZXRlZCBPYnNlcnZlcidzIE9uQ29tcGxldGVkIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBbm9ueW1vdXNPYnNlcnZlcihvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuX29uTmV4dCA9IG9uTmV4dDtcbiAgICAgIHRoaXMuX29uRXJyb3IgPSBvbkVycm9yO1xuICAgICAgdGhpcy5fb25Db21wbGV0ZWQgPSBvbkNvbXBsZXRlZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxscyB0aGUgb25OZXh0IGFjdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FueX0gdmFsdWUgTmV4dCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cbiAgICAgKi9cbiAgICBBbm9ueW1vdXNPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdGhpcy5fb25OZXh0KHZhbHVlKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FsbHMgdGhlIG9uRXJyb3IgYWN0aW9uLlxuICAgICAqIEBwYXJhbSB7QW55fSBlcnJvciBUaGUgZXJyb3IgdGhhdCBoYXMgb2NjdXJyZWQuXG4gICAgICovXG4gICAgQW5vbnltb3VzT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICB0aGlzLl9vbkVycm9yKGVycm9yKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogIENhbGxzIHRoZSBvbkNvbXBsZXRlZCBhY3Rpb24uXG4gICAgICovXG4gICAgQW5vbnltb3VzT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX29uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBBbm9ueW1vdXNPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgdmFyIG9ic2VydmFibGVQcm90bztcblxuICAvKipcbiAgICogUmVwcmVzZW50cyBhIHB1c2gtc3R5bGUgY29sbGVjdGlvbi5cbiAgICovXG4gIHZhciBPYnNlcnZhYmxlID0gUnguT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICBmdW5jdGlvbiBtYWtlU3Vic2NyaWJlKHNlbGYsIHN1YnNjcmliZSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIHZhciBvbGRPbkVycm9yID0gby5vbkVycm9yO1xuICAgICAgICBvLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIG1ha2VTdGFja1RyYWNlTG9uZyhlLCBzZWxmKTtcbiAgICAgICAgICBvbGRPbkVycm9yLmNhbGwobywgZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHN1YnNjcmliZS5jYWxsKHNlbGYsIG8pO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKCkge1xuICAgICAgaWYgKFJ4LmNvbmZpZy5sb25nU3RhY2tTdXBwb3J0ICYmIGhhc1N0YWNrcykge1xuICAgICAgICB2YXIgb2xkU3Vic2NyaWJlID0gdGhpcy5fc3Vic2NyaWJlO1xuICAgICAgICB2YXIgZSA9IHRyeUNhdGNoKHRocm93ZXIpKG5ldyBFcnJvcigpKS5lO1xuICAgICAgICB0aGlzLnN0YWNrID0gZS5zdGFjay5zdWJzdHJpbmcoZS5zdGFjay5pbmRleE9mKCdcXG4nKSArIDEpO1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmUgPSBtYWtlU3Vic2NyaWJlKHRoaXMsIG9sZFN1YnNjcmliZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgb2JzZXJ2YWJsZVByb3RvID0gT2JzZXJ2YWJsZS5wcm90b3R5cGU7XG5cbiAgICAvKipcbiAgICAqIERldGVybWluZXMgd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGFuIE9ic2VydmFibGVcbiAgICAqIEBwYXJhbSB7QW55fSBBbiBvYmplY3QgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgaXQgaXMgYW4gT2JzZXJ2YWJsZVxuICAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgaWYgYW4gT2JzZXJ2YWJsZSwgZWxzZSBmYWxzZS5cbiAgICAqL1xuICAgIE9ic2VydmFibGUuaXNPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiBvICYmIGlzRnVuY3Rpb24oby5zdWJzY3JpYmUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiAgU3Vic2NyaWJlcyBhbiBvIHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgICAqICBAcGFyYW0ge01peGVkfSBbb09yT25OZXh0XSBUaGUgb2JqZWN0IHRoYXQgaXMgdG8gcmVjZWl2ZSBub3RpZmljYXRpb25zIG9yIGFuIGFjdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiAgQHBhcmFtIHtGdW5jdGlvbn0gW29uRXJyb3JdIEFjdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiAgQHBhcmFtIHtGdW5jdGlvbn0gW29uQ29tcGxldGVkXSBBY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAgICogIEByZXR1cm5zIHtEaXBvc2FibGV9IEEgZGlzcG9zYWJsZSBoYW5kbGluZyB0aGUgc3Vic2NyaXB0aW9ucyBhbmQgdW5zdWJzY3JpcHRpb25zLlxuICAgICAqL1xuICAgIG9ic2VydmFibGVQcm90by5zdWJzY3JpYmUgPSBvYnNlcnZhYmxlUHJvdG8uZm9yRWFjaCA9IGZ1bmN0aW9uIChvT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKHR5cGVvZiBvT3JPbk5leHQgPT09ICdvYmplY3QnID9cbiAgICAgICAgb09yT25OZXh0IDpcbiAgICAgICAgb2JzZXJ2ZXJDcmVhdGUob09yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmVzIHRvIHRoZSBuZXh0IHZhbHVlIGluIHRoZSBzZXF1ZW5jZSB3aXRoIGFuIG9wdGlvbmFsIFwidGhpc1wiIGFyZ3VtZW50LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uTmV4dCBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIG9uIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG4gICAgICovXG4gICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZU9uTmV4dCA9IGZ1bmN0aW9uIChvbk5leHQsIHRoaXNBcmcpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUob2JzZXJ2ZXJDcmVhdGUodHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24oeCkgeyBvbk5leHQuY2FsbCh0aGlzQXJnLCB4KTsgfSA6IG9uTmV4dCkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmVzIHRvIGFuIGV4Y2VwdGlvbmFsIGNvbmRpdGlvbiBpbiB0aGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBcInRoaXNcIiBhcmd1bWVudC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkVycm9yIFRoZSBmdW5jdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG4gICAgICovXG4gICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZU9uRXJyb3IgPSBmdW5jdGlvbiAob25FcnJvciwgdGhpc0FyZykge1xuICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShvYnNlcnZlckNyZWF0ZShudWxsLCB0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbihlKSB7IG9uRXJyb3IuY2FsbCh0aGlzQXJnLCBlKTsgfSA6IG9uRXJyb3IpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlcyB0byB0aGUgbmV4dCB2YWx1ZSBpbiB0aGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBcInRoaXNcIiBhcmd1bWVudC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkNvbXBsZXRlZCBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG4gICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IEEgZGlzcG9zYWJsZSBoYW5kbGluZyB0aGUgc3Vic2NyaXB0aW9ucyBhbmQgdW5zdWJzY3JpcHRpb25zLlxuICAgICAqL1xuICAgIG9ic2VydmFibGVQcm90by5zdWJzY3JpYmVPbkNvbXBsZXRlZCA9IGZ1bmN0aW9uIChvbkNvbXBsZXRlZCwgdGhpc0FyZykge1xuICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShvYnNlcnZlckNyZWF0ZShudWxsLCBudWxsLCB0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbigpIHsgb25Db21wbGV0ZWQuY2FsbCh0aGlzQXJnKTsgfSA6IG9uQ29tcGxldGVkKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBPYnNlcnZhYmxlO1xuICB9KSgpO1xuXG4gIHZhciBTY2hlZHVsZWRPYnNlcnZlciA9IFJ4LmludGVybmFscy5TY2hlZHVsZWRPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2NoZWR1bGVkT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBTY2hlZHVsZWRPYnNlcnZlcihzY2hlZHVsZXIsIG9ic2VydmVyKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy5pc0FjcXVpcmVkID0gZmFsc2U7XG4gICAgICB0aGlzLmhhc0ZhdWx0ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMucXVldWUgPSBbXTtcbiAgICAgIHRoaXMuZGlzcG9zYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG4gICAgfVxuXG4gICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHRoaXMucXVldWUucHVzaChmdW5jdGlvbiAoKSB7IHNlbGYub2JzZXJ2ZXIub25OZXh0KHZhbHVlKTsgfSk7XG4gICAgfTtcblxuICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB0aGlzLnF1ZXVlLnB1c2goZnVuY3Rpb24gKCkgeyBzZWxmLm9ic2VydmVyLm9uRXJyb3IoZSk7IH0pO1xuICAgIH07XG5cbiAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5xdWV1ZS5wdXNoKGZ1bmN0aW9uICgpIHsgc2VsZi5vYnNlcnZlci5vbkNvbXBsZXRlZCgpOyB9KTtcbiAgICB9O1xuXG4gICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLmVuc3VyZUFjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBpc093bmVyID0gZmFsc2U7XG4gICAgICBpZiAoIXRoaXMuaGFzRmF1bHRlZCAmJiB0aGlzLnF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgaXNPd25lciA9ICF0aGlzLmlzQWNxdWlyZWQ7XG4gICAgICAgIHRoaXMuaXNBY3F1aXJlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoaXNPd25lcikge1xuICAgICAgICB0aGlzLmRpc3Bvc2FibGUuc2V0RGlzcG9zYWJsZSh0aGlzLnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSh0aGlzLCBmdW5jdGlvbiAocGFyZW50LCBzZWxmKSB7XG4gICAgICAgICAgdmFyIHdvcms7XG4gICAgICAgICAgaWYgKHBhcmVudC5xdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB3b3JrID0gcGFyZW50LnF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBhcmVudC5pc0FjcXVpcmVkID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh3b3JrKSgpO1xuICAgICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICBwYXJlbnQucXVldWUgPSBbXTtcbiAgICAgICAgICAgIHBhcmVudC5oYXNGYXVsdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiB0aHJvd2VyKHJlcy5lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2VsZihwYXJlbnQpO1xuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgX19zdXBlcl9fLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLmRpc3Bvc2FibGUuZGlzcG9zZSgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2NoZWR1bGVkT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIHZhciBPYnNlcnZhYmxlQmFzZSA9IFJ4Lk9ic2VydmFibGVCYXNlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhPYnNlcnZhYmxlQmFzZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIGZpeFN1YnNjcmliZXIoc3Vic2NyaWJlcikge1xuICAgICAgcmV0dXJuIHN1YnNjcmliZXIgJiYgaXNGdW5jdGlvbihzdWJzY3JpYmVyLmRpc3Bvc2UpID8gc3Vic2NyaWJlciA6XG4gICAgICAgIGlzRnVuY3Rpb24oc3Vic2NyaWJlcikgPyBkaXNwb3NhYmxlQ3JlYXRlKHN1YnNjcmliZXIpIDogZGlzcG9zYWJsZUVtcHR5O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldERpc3Bvc2FibGUocywgc3RhdGUpIHtcbiAgICAgIHZhciBhZG8gPSBzdGF0ZVswXSwgc2VsZiA9IHN0YXRlWzFdO1xuICAgICAgdmFyIHN1YiA9IHRyeUNhdGNoKHNlbGYuc3Vic2NyaWJlQ29yZSkuY2FsbChzZWxmLCBhZG8pO1xuICAgICAgaWYgKHN1YiA9PT0gZXJyb3JPYmogJiYgIWFkby5mYWlsKGVycm9yT2JqLmUpKSB7IHRocm93ZXIoZXJyb3JPYmouZSk7IH1cbiAgICAgIGFkby5zZXREaXNwb3NhYmxlKGZpeFN1YnNjcmliZXIoc3ViKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZUJhc2UoKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBPYnNlcnZhYmxlQmFzZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgYWRvID0gbmV3IEF1dG9EZXRhY2hPYnNlcnZlcihvKSwgc3RhdGUgPSBbYWRvLCB0aGlzXTtcblxuICAgICAgaWYgKGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZXF1aXJlZCgpKSB7XG4gICAgICAgIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNldERpc3Bvc2FibGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0RGlzcG9zYWJsZShudWxsLCBzdGF0ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYWRvO1xuICAgIH07XG5cbiAgICBPYnNlcnZhYmxlQmFzZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IG5vdEltcGxlbWVudGVkO1xuXG4gICAgcmV0dXJuIE9ic2VydmFibGVCYXNlO1xuICB9KE9ic2VydmFibGUpKTtcblxudmFyIEZsYXRNYXBPYnNlcnZhYmxlID0gUnguRmxhdE1hcE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cbiAgICBpbmhlcml0cyhGbGF0TWFwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIEZsYXRNYXBPYnNlcnZhYmxlKHNvdXJjZSwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgICB0aGlzLnJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihyZXN1bHRTZWxlY3RvcikgPyByZXN1bHRTZWxlY3RvciA6IG51bGw7XG4gICAgICB0aGlzLnNlbGVjdG9yID0gYmluZENhbGxiYWNrKGlzRnVuY3Rpb24oc2VsZWN0b3IpID8gc2VsZWN0b3IgOiBmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGVjdG9yOyB9LCB0aGlzQXJnLCAzKTtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRmxhdE1hcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMuc2VsZWN0b3IsIHRoaXMucmVzdWx0U2VsZWN0b3IsIHRoaXMpKTtcbiAgICB9O1xuXG4gICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvYnNlcnZlciwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCBzb3VyY2UpIHtcbiAgICAgIHRoaXMuaSA9IDA7XG4gICAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICB0aGlzLnJlc3VsdFNlbGVjdG9yID0gcmVzdWx0U2VsZWN0b3I7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMubyA9IG9ic2VydmVyO1xuICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLl93cmFwUmVzdWx0ID0gZnVuY3Rpb24ocmVzdWx0LCB4LCBpKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZXN1bHRTZWxlY3RvciA/XG4gICAgICAgIHJlc3VsdC5tYXAoZnVuY3Rpb24oeSwgaTIpIHsgcmV0dXJuIHRoaXMucmVzdWx0U2VsZWN0b3IoeCwgeSwgaSwgaTIpOyB9LCB0aGlzKSA6XG4gICAgICAgIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgIHZhciBpID0gdGhpcy5pKys7XG4gICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5zZWxlY3RvcikoeCwgaSwgdGhpcy5zb3VyY2UpO1xuICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuXG4gICAgICBpc1Byb21pc2UocmVzdWx0KSAmJiAocmVzdWx0ID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHJlc3VsdCkpO1xuICAgICAgKGlzQXJyYXlMaWtlKHJlc3VsdCkgfHwgaXNJdGVyYWJsZShyZXN1bHQpKSAmJiAocmVzdWx0ID0gT2JzZXJ2YWJsZS5mcm9tKHJlc3VsdCkpO1xuICAgICAgdGhpcy5vLm9uTmV4dCh0aGlzLl93cmFwUmVzdWx0KHJlc3VsdCwgeCwgaSkpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uKGUpIHsgdGhpcy5vLm9uRXJyb3IoZSk7IH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkgeyB0aGlzLm8ub25Db21wbGV0ZWQoKTsgfTtcblxuICAgIHJldHVybiBGbGF0TWFwT2JzZXJ2YWJsZTtcblxufShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBFbnVtZXJhYmxlID0gUnguaW50ZXJuYWxzLkVudW1lcmFibGUgPSBmdW5jdGlvbiAoKSB7IH07XG5cbiAgZnVuY3Rpb24gSXNEaXNwb3NlZERpc3Bvc2FibGUoc3RhdGUpIHtcbiAgICB0aGlzLl9zID0gc3RhdGU7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gIH1cblxuICBJc0Rpc3Bvc2VkRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX3MuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIHZhciBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZShzb3VyY2VzKSB7XG4gICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHN0YXRlID0geyBpc0Rpc3Bvc2VkOiBmYWxzZSB9LCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuICAgICAgdmFyIGNhbmNlbGFibGUgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKHRoaXMuc291cmNlc1skaXRlcmF0b3IkXSgpLCBmdW5jdGlvbiAoZSwgc2VsZikge1xuICAgICAgICBpZiAoc3RhdGUuaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdmFyIGN1cnJlbnRJdGVtID0gdHJ5Q2F0Y2goZS5uZXh0KS5jYWxsKGUpO1xuICAgICAgICBpZiAoY3VycmVudEl0ZW0gPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IoY3VycmVudEl0ZW0uZSk7IH1cblxuICAgICAgICBpZiAoY3VycmVudEl0ZW0uZG9uZSkge1xuICAgICAgICAgIHJldHVybiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcbiAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblxuICAgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgICAgZC5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgc2VsZiwgZSkpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIG5ldyBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSldKTtcbiAgICB9O1xuXG4gICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBzLCBlKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgdGhpcy5fZSA9IGU7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KHgpOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX3ModGhpcy5fZSk7IH07XG5cbiAgICByZXR1cm4gQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICBFbnVtZXJhYmxlLnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICB2YXIgQ2F0Y2hFcnJvck9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ2F0Y2hFcnJvck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ2F0Y2hFcnJvck9ic2VydmFibGUoc291cmNlcykge1xuICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIENhdGNoRXJyb3JPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBlID0gdGhpcy5zb3VyY2VzWyRpdGVyYXRvciRdKCk7XG5cbiAgICAgIHZhciBzdGF0ZSA9IHsgaXNEaXNwb3NlZDogZmFsc2UgfSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcbiAgICAgIHZhciBjYW5jZWxhYmxlID0gY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZShudWxsLCBmdW5jdGlvbiAobGFzdEV4Y2VwdGlvbiwgc2VsZikge1xuICAgICAgICBpZiAoc3RhdGUuaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdmFyIGN1cnJlbnRJdGVtID0gdHJ5Q2F0Y2goZS5uZXh0KS5jYWxsKGUpO1xuICAgICAgICBpZiAoY3VycmVudEl0ZW0gPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IoY3VycmVudEl0ZW0uZSk7IH1cblxuICAgICAgICBpZiAoY3VycmVudEl0ZW0uZG9uZSkge1xuICAgICAgICAgIHJldHVybiBsYXN0RXhjZXB0aW9uICE9PSBudWxsID8gby5vbkVycm9yKGxhc3RFeGNlcHRpb24pIDogby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgcHJvbWlzZVxuICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gY3VycmVudEl0ZW0udmFsdWU7XG4gICAgICAgIGlzUHJvbWlzZShjdXJyZW50VmFsdWUpICYmIChjdXJyZW50VmFsdWUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoY3VycmVudFZhbHVlKSk7XG5cbiAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICAgIGQuc2V0RGlzcG9zYWJsZShjdXJyZW50VmFsdWUuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHNlbGYpKSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoW3N1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSwgbmV3IElzRGlzcG9zZWREaXNwb3NhYmxlKHN0YXRlKV0pO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHJlY3Vyc2UpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcmVjdXJzZSA9IHJlY3Vyc2U7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KHgpOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fcmVjdXJzZShlKTsgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblxuICAgIHJldHVybiBDYXRjaEVycm9yT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIEVudW1lcmFibGUucHJvdG90eXBlLmNhdGNoRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBDYXRjaEVycm9yT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICBFbnVtZXJhYmxlLnByb3RvdHlwZS5jYXRjaEVycm9yV2hlbiA9IGZ1bmN0aW9uIChub3RpZmljYXRpb25IYW5kbGVyKSB7XG4gICAgdmFyIHNvdXJjZXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGV4Y2VwdGlvbnMgPSBuZXcgU3ViamVjdCgpLFxuICAgICAgICBub3RpZmllciA9IG5ldyBTdWJqZWN0KCksXG4gICAgICAgIGhhbmRsZWQgPSBub3RpZmljYXRpb25IYW5kbGVyKGV4Y2VwdGlvbnMpLFxuICAgICAgICBub3RpZmljYXRpb25EaXNwb3NhYmxlID0gaGFuZGxlZC5zdWJzY3JpYmUobm90aWZpZXIpO1xuXG4gICAgICB2YXIgZSA9IHNvdXJjZXNbJGl0ZXJhdG9yJF0oKTtcblxuICAgICAgdmFyIHN0YXRlID0geyBpc0Rpc3Bvc2VkOiBmYWxzZSB9LFxuICAgICAgICBsYXN0RXhjZXB0aW9uLFxuICAgICAgICBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuICAgICAgdmFyIGNhbmNlbGFibGUgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKG51bGwsIGZ1bmN0aW9uIChfLCBzZWxmKSB7XG4gICAgICAgIGlmIChzdGF0ZS5pc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSB0cnlDYXRjaChlLm5leHQpLmNhbGwoZSk7XG4gICAgICAgIGlmIChjdXJyZW50SXRlbSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihjdXJyZW50SXRlbS5lKTsgfVxuXG4gICAgICAgIGlmIChjdXJyZW50SXRlbS5kb25lKSB7XG4gICAgICAgICAgaWYgKGxhc3RFeGNlcHRpb24pIHtcbiAgICAgICAgICAgIG8ub25FcnJvcihsYXN0RXhjZXB0aW9uKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcbiAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblxuICAgICAgICB2YXIgb3V0ZXIgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgdmFyIGlubmVyID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG5ldyBCaW5hcnlEaXNwb3NhYmxlKGlubmVyLCBvdXRlcikpO1xuICAgICAgICBvdXRlci5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUoXG4gICAgICAgICAgZnVuY3Rpb24oeCkgeyBvLm9uTmV4dCh4KTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoZXhuKSB7XG4gICAgICAgICAgICBpbm5lci5zZXREaXNwb3NhYmxlKG5vdGlmaWVyLnN1YnNjcmliZShzZWxmLCBmdW5jdGlvbihleCkge1xuICAgICAgICAgICAgICBvLm9uRXJyb3IoZXgpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgZXhjZXB0aW9ucy5vbk5leHQoZXhuKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZ1bmN0aW9uKCkgeyBvLm9uQ29tcGxldGVkKCk7IH0pKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtub3RpZmljYXRpb25EaXNwb3NhYmxlLCBzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIG5ldyBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSldKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgUmVwZWF0RW51bWVyYWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoUmVwZWF0RW51bWVyYWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIFJlcGVhdEVudW1lcmFibGUodiwgYykge1xuICAgICAgdGhpcy52ID0gdjtcbiAgICAgIHRoaXMuYyA9IGMgPT0gbnVsbCA/IC0xIDogYztcbiAgICB9XG4gICAgUmVwZWF0RW51bWVyYWJsZS5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3IFJlcGVhdEVudW1lcmF0b3IodGhpcyk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFJlcGVhdEVudW1lcmF0b3IocCkge1xuICAgICAgdGhpcy52ID0gcC52O1xuICAgICAgdGhpcy5sID0gcC5jO1xuICAgIH1cbiAgICBSZXBlYXRFbnVtZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMubCA9PT0gMCkgeyByZXR1cm4gZG9uZUVudW1lcmF0b3I7IH1cbiAgICAgIGlmICh0aGlzLmwgPiAwKSB7IHRoaXMubC0tOyB9XG4gICAgICByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMudiB9O1xuICAgIH07XG5cbiAgICByZXR1cm4gUmVwZWF0RW51bWVyYWJsZTtcbiAgfShFbnVtZXJhYmxlKSk7XG5cbiAgdmFyIGVudW1lcmFibGVSZXBlYXQgPSBFbnVtZXJhYmxlLnJlcGVhdCA9IGZ1bmN0aW9uICh2YWx1ZSwgcmVwZWF0Q291bnQpIHtcbiAgICByZXR1cm4gbmV3IFJlcGVhdEVudW1lcmFibGUodmFsdWUsIHJlcGVhdENvdW50KTtcbiAgfTtcblxuICB2YXIgT2ZFbnVtZXJhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE9mRW51bWVyYWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBPZkVudW1lcmFibGUocywgZm4sIHRoaXNBcmcpIHtcbiAgICAgIHRoaXMucyA9IHM7XG4gICAgICB0aGlzLmZuID0gZm4gPyBiaW5kQ2FsbGJhY2soZm4sIHRoaXNBcmcsIDMpIDogbnVsbDtcbiAgICB9XG4gICAgT2ZFbnVtZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBuZXcgT2ZFbnVtZXJhdG9yKHRoaXMpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBPZkVudW1lcmF0b3IocCkge1xuICAgICAgdGhpcy5pID0gLTE7XG4gICAgICB0aGlzLnMgPSBwLnM7XG4gICAgICB0aGlzLmwgPSB0aGlzLnMubGVuZ3RoO1xuICAgICAgdGhpcy5mbiA9IHAuZm47XG4gICAgfVxuICAgIE9mRW51bWVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgcmV0dXJuICsrdGhpcy5pIDwgdGhpcy5sID9cbiAgICAgICB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogIXRoaXMuZm4gPyB0aGlzLnNbdGhpcy5pXSA6IHRoaXMuZm4odGhpcy5zW3RoaXMuaV0sIHRoaXMuaSwgdGhpcy5zKSB9IDpcbiAgICAgICBkb25lRW51bWVyYXRvcjtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE9mRW51bWVyYWJsZTtcbiAgfShFbnVtZXJhYmxlKSk7XG5cbiAgdmFyIGVudW1lcmFibGVPZiA9IEVudW1lcmFibGUub2YgPSBmdW5jdGlvbiAoc291cmNlLCBzZWxlY3RvciwgdGhpc0FyZykge1xuICAgIHJldHVybiBuZXcgT2ZFbnVtZXJhYmxlKHNvdXJjZSwgc2VsZWN0b3IsIHRoaXNBcmcpO1xuICB9O1xuXG4gIHZhciBUb0FycmF5T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUb0FycmF5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUb0FycmF5T2JzZXJ2YWJsZShzb3VyY2UpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVG9BcnJheU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8pKTtcbiAgICB9O1xuXG4gICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvKSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy5hID0gW107XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIFxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLmEucHVzaCh4KTsgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuby5vbkVycm9yKGUpOyAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuby5vbk5leHQodGhpcy5hKTsgdGhpcy5vLm9uQ29tcGxldGVkKCk7IH07XG5cbiAgICByZXR1cm4gVG9BcnJheU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgKiBDcmVhdGVzIGFuIGFycmF5IGZyb20gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIGEgc2luZ2xlIGVsZW1lbnQgd2l0aCBhIGxpc3QgY29udGFpbmluZyBhbGwgdGhlIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICovXG4gIG9ic2VydmFibGVQcm90by50b0FycmF5ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgVG9BcnJheU9ic2VydmFibGUodGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqICBDcmVhdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgZnJvbSBhIHNwZWNpZmllZCBzdWJzY3JpYmUgbWV0aG9kIGltcGxlbWVudGF0aW9uLlxuICAgKiBAZXhhbXBsZVxuICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuY3JlYXRlKGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB9ICk7XG4gICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBSeC5EaXNwb3NhYmxlLmVtcHR5OyB9ICk7XG4gICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IH0gKTtcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gc3Vic2NyaWJlIEltcGxlbWVudGF0aW9uIG9mIHRoZSByZXN1bHRpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSdzIHN1YnNjcmliZSBtZXRob2QsIHJldHVybmluZyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSB3cmFwcGVkIGluIGEgRGlzcG9zYWJsZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGhlIHNwZWNpZmllZCBpbXBsZW1lbnRhdGlvbiBmb3IgdGhlIFN1YnNjcmliZSBtZXRob2QuXG4gICAqL1xuICBPYnNlcnZhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmUsIHBhcmVudCkge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShzdWJzY3JpYmUsIHBhcmVudCk7XG4gIH07XG5cbiAgdmFyIERlZmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERlZmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIERlZmVyKGZhY3RvcnkpIHtcbiAgICAgIHRoaXMuX2YgPSBmYWN0b3J5O1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVmZXIucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuX2YpKCk7XG4gICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gb2JzZXJ2YWJsZVRocm93KHJlc3VsdC5lKS5zdWJzY3JpYmUobyk7fVxuICAgICAgaXNQcm9taXNlKHJlc3VsdCkgJiYgKHJlc3VsdCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShyZXN1bHQpKTtcbiAgICAgIHJldHVybiByZXN1bHQuc3Vic2NyaWJlKG8pO1xuICAgIH07XG5cbiAgICByZXR1cm4gRGVmZXI7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGludm9rZXMgdGhlIHNwZWNpZmllZCBmYWN0b3J5IGZ1bmN0aW9uIHdoZW5ldmVyIGEgbmV3IG9ic2VydmVyIHN1YnNjcmliZXMuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5kZWZlcihmdW5jdGlvbiAoKSB7IHJldHVybiBSeC5PYnNlcnZhYmxlLmZyb21BcnJheShbMSwyLDNdKTsgfSk7XG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9ic2VydmFibGVGYWN0b3J5IE9ic2VydmFibGUgZmFjdG9yeSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggb2JzZXJ2ZXIgdGhhdCBzdWJzY3JpYmVzIHRvIHRoZSByZXN1bHRpbmcgc2VxdWVuY2Ugb3IgUHJvbWlzZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2Ugb2JzZXJ2ZXJzIHRyaWdnZXIgYW4gaW52b2NhdGlvbiBvZiB0aGUgZ2l2ZW4gb2JzZXJ2YWJsZSBmYWN0b3J5IGZ1bmN0aW9uLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVEZWZlciA9IE9ic2VydmFibGUuZGVmZXIgPSBmdW5jdGlvbiAob2JzZXJ2YWJsZUZhY3RvcnkpIHtcbiAgICByZXR1cm4gbmV3IERlZmVyKG9ic2VydmFibGVGYWN0b3J5KTtcbiAgfTtcblxuICB2YXIgRW1wdHlPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEVtcHR5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBFbXB0eU9ic2VydmFibGUoc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIEVtcHR5T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgRW1wdHlTaW5rKG9ic2VydmVyLCB0aGlzLnNjaGVkdWxlcik7XG4gICAgICByZXR1cm4gc2luay5ydW4oKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gRW1wdHlTaW5rKG9ic2VydmVyLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjaGVkdWxlSXRlbShzLCBzdGF0ZSkge1xuICAgICAgc3RhdGUub25Db21wbGV0ZWQoKTtcbiAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgfVxuXG4gICAgRW1wdHlTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc3RhdGUgPSB0aGlzLm9ic2VydmVyO1xuICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVyID09PSBpbW1lZGlhdGVTY2hlZHVsZXIgP1xuICAgICAgICBzY2hlZHVsZUl0ZW0obnVsbCwgc3RhdGUpIDpcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNjaGVkdWxlSXRlbSk7XG4gICAgfTtcblxuICAgIHJldHVybiBFbXB0eU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgRU1QVFlfT0JTRVJWQUJMRSA9IG5ldyBFbXB0eU9ic2VydmFibGUoaW1tZWRpYXRlU2NoZWR1bGVyKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gZW1wdHkgb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgdGhlIHNpbmdsZSBPbkNvbXBsZXRlZCBtZXNzYWdlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuZW1wdHkoKTtcbiAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmVtcHR5KFJ4LlNjaGVkdWxlci50aW1lb3V0KTtcbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBzZW5kIHRoZSB0ZXJtaW5hdGlvbiBjYWxsIG9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIG5vIGVsZW1lbnRzLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVFbXB0eSA9IE9ic2VydmFibGUuZW1wdHkgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gc2NoZWR1bGVyID09PSBpbW1lZGlhdGVTY2hlZHVsZXIgPyBFTVBUWV9PQlNFUlZBQkxFIDogbmV3IEVtcHR5T2JzZXJ2YWJsZShzY2hlZHVsZXIpO1xuICB9O1xuXG4gIHZhciBGcm9tT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhGcm9tT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBGcm9tT2JzZXJ2YWJsZShpdGVyYWJsZSwgbWFwcGVyLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuaXRlcmFibGUgPSBpdGVyYWJsZTtcbiAgICAgIHRoaXMubWFwcGVyID0gbWFwcGVyO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBGcm9tT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgc2luayA9IG5ldyBGcm9tU2luayhvLCB0aGlzKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRnJvbU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgRnJvbVNpbmsgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZyb21TaW5rKG8sIHBhcmVudCkge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgIH1cblxuICAgIEZyb21TaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgbGlzdCA9IE9iamVjdCh0aGlzLnBhcmVudC5pdGVyYWJsZSksXG4gICAgICAgICAgaXQgPSBnZXRJdGVyYWJsZShsaXN0KSxcbiAgICAgICAgICBvID0gdGhpcy5vLFxuICAgICAgICAgIG1hcHBlciA9IHRoaXMucGFyZW50Lm1hcHBlcjtcblxuICAgICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShpLCByZWN1cnNlKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdHJ5Q2F0Y2goaXQubmV4dCkuY2FsbChpdCk7XG4gICAgICAgIGlmIChuZXh0ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKG5leHQuZSk7IH1cbiAgICAgICAgaWYgKG5leHQuZG9uZSkgeyByZXR1cm4gby5vbkNvbXBsZXRlZCgpOyB9XG5cbiAgICAgICAgdmFyIHJlc3VsdCA9IG5leHQudmFsdWU7XG5cbiAgICAgICAgaWYgKGlzRnVuY3Rpb24obWFwcGVyKSkge1xuICAgICAgICAgIHJlc3VsdCA9IHRyeUNhdGNoKG1hcHBlcikocmVzdWx0LCBpKTtcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuICAgICAgICB9XG5cbiAgICAgICAgby5vbk5leHQocmVzdWx0KTtcbiAgICAgICAgcmVjdXJzZShpICsgMSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSk7XG4gICAgfTtcblxuICAgIHJldHVybiBGcm9tU2luaztcbiAgfSgpKTtcblxuICB2YXIgbWF4U2FmZUludGVnZXIgPSBNYXRoLnBvdygyLCA1MykgLSAxO1xuXG4gIGZ1bmN0aW9uIFN0cmluZ0l0ZXJhYmxlKHMpIHtcbiAgICB0aGlzLl9zID0gcztcbiAgfVxuXG4gIFN0cmluZ0l0ZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IFN0cmluZ0l0ZXJhdG9yKHRoaXMuX3MpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIFN0cmluZ0l0ZXJhdG9yKHMpIHtcbiAgICB0aGlzLl9zID0gcztcbiAgICB0aGlzLl9sID0gcy5sZW5ndGg7XG4gICAgdGhpcy5faSA9IDA7XG4gIH1cblxuICBTdHJpbmdJdGVyYXRvci5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgU3RyaW5nSXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2kgPCB0aGlzLl9sID8geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMuX3MuY2hhckF0KHRoaXMuX2krKykgfSA6IGRvbmVFbnVtZXJhdG9yO1xuICB9O1xuXG4gIGZ1bmN0aW9uIEFycmF5SXRlcmFibGUoYSkge1xuICAgIHRoaXMuX2EgPSBhO1xuICB9XG5cbiAgQXJyYXlJdGVyYWJsZS5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBBcnJheUl0ZXJhdG9yKHRoaXMuX2EpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIEFycmF5SXRlcmF0b3IoYSkge1xuICAgIHRoaXMuX2EgPSBhO1xuICAgIHRoaXMuX2wgPSB0b0xlbmd0aChhKTtcbiAgICB0aGlzLl9pID0gMDtcbiAgfVxuXG4gIEFycmF5SXRlcmF0b3IucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEFycmF5SXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2kgPCB0aGlzLl9sID8geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMuX2FbdGhpcy5faSsrXSB9IDogZG9uZUVudW1lcmF0b3I7XG4gIH07XG5cbiAgZnVuY3Rpb24gbnVtYmVySXNGaW5pdGUodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiByb290LmlzRmluaXRlKHZhbHVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzTmFuKG4pIHtcbiAgICByZXR1cm4gbiAhPT0gbjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEl0ZXJhYmxlKG8pIHtcbiAgICB2YXIgaSA9IG9bJGl0ZXJhdG9yJF0sIGl0O1xuICAgIGlmICghaSAmJiB0eXBlb2YgbyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGl0ID0gbmV3IFN0cmluZ0l0ZXJhYmxlKG8pO1xuICAgICAgcmV0dXJuIGl0WyRpdGVyYXRvciRdKCk7XG4gICAgfVxuICAgIGlmICghaSAmJiBvLmxlbmd0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpdCA9IG5ldyBBcnJheUl0ZXJhYmxlKG8pO1xuICAgICAgcmV0dXJuIGl0WyRpdGVyYXRvciRdKCk7XG4gICAgfVxuICAgIGlmICghaSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdPYmplY3QgaXMgbm90IGl0ZXJhYmxlJyk7IH1cbiAgICByZXR1cm4gb1skaXRlcmF0b3IkXSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2lnbih2YWx1ZSkge1xuICAgIHZhciBudW1iZXIgPSArdmFsdWU7XG4gICAgaWYgKG51bWJlciA9PT0gMCkgeyByZXR1cm4gbnVtYmVyOyB9XG4gICAgaWYgKGlzTmFOKG51bWJlcikpIHsgcmV0dXJuIG51bWJlcjsgfVxuICAgIHJldHVybiBudW1iZXIgPCAwID8gLTEgOiAxO1xuICB9XG5cbiAgZnVuY3Rpb24gdG9MZW5ndGgobykge1xuICAgIHZhciBsZW4gPSArby5sZW5ndGg7XG4gICAgaWYgKGlzTmFOKGxlbikpIHsgcmV0dXJuIDA7IH1cbiAgICBpZiAobGVuID09PSAwIHx8ICFudW1iZXJJc0Zpbml0ZShsZW4pKSB7IHJldHVybiBsZW47IH1cbiAgICBsZW4gPSBzaWduKGxlbikgKiBNYXRoLmZsb29yKE1hdGguYWJzKGxlbikpO1xuICAgIGlmIChsZW4gPD0gMCkgeyByZXR1cm4gMDsgfVxuICAgIGlmIChsZW4gPiBtYXhTYWZlSW50ZWdlcikgeyByZXR1cm4gbWF4U2FmZUludGVnZXI7IH1cbiAgICByZXR1cm4gbGVuO1xuICB9XG5cbiAgLyoqXG4gICogVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyBPYnNlcnZhYmxlIHNlcXVlbmNlIGZyb20gYW4gYXJyYXktbGlrZSBvciBpdGVyYWJsZSBvYmplY3QuXG4gICogQHBhcmFtIHtBbnl9IGFycmF5TGlrZSBBbiBhcnJheS1saWtlIG9yIGl0ZXJhYmxlIG9iamVjdCB0byBjb252ZXJ0IHRvIGFuIE9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gW21hcEZuXSBNYXAgZnVuY3Rpb24gdG8gY2FsbCBvbiBldmVyeSBlbGVtZW50IG9mIHRoZSBhcnJheS5cbiAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIFRoZSBjb250ZXh0IHRvIHVzZSBjYWxsaW5nIHRoZSBtYXBGbiBpZiBwcm92aWRlZC5cbiAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gT3B0aW9uYWwgc2NoZWR1bGVyIHRvIHVzZSBmb3Igc2NoZWR1bGluZy4gIElmIG5vdCBwcm92aWRlZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmN1cnJlbnRUaHJlYWQuXG4gICovXG4gIHZhciBvYnNlcnZhYmxlRnJvbSA9IE9ic2VydmFibGUuZnJvbSA9IGZ1bmN0aW9uIChpdGVyYWJsZSwgbWFwRm4sIHRoaXNBcmcsIHNjaGVkdWxlcikge1xuICAgIGlmIChpdGVyYWJsZSA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2l0ZXJhYmxlIGNhbm5vdCBiZSBudWxsLicpXG4gICAgfVxuICAgIGlmIChtYXBGbiAmJiAhaXNGdW5jdGlvbihtYXBGbikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignbWFwRm4gd2hlbiBwcm92aWRlZCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgaWYgKG1hcEZuKSB7XG4gICAgICB2YXIgbWFwcGVyID0gYmluZENhbGxiYWNrKG1hcEZuLCB0aGlzQXJnLCAyKTtcbiAgICB9XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBGcm9tT2JzZXJ2YWJsZShpdGVyYWJsZSwgbWFwcGVyLCBzY2hlZHVsZXIpO1xuICB9XG5cbiAgdmFyIEZyb21BcnJheU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRnJvbUFycmF5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIHNjaGVkdWxlcikge1xuICAgICAgdGhpcy5hcmdzID0gYXJncztcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRnJvbUFycmF5T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgRnJvbUFycmF5U2luayhvYnNlcnZlciwgdGhpcyk7XG4gICAgICByZXR1cm4gc2luay5ydW4oKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEZyb21BcnJheU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICBmdW5jdGlvbiBGcm9tQXJyYXlTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcbiAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIH1cblxuICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGFyZ3MsIG9ic2VydmVyKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3MubGVuZ3RoO1xuICAgIHJldHVybiBmdW5jdGlvbiBsb29wIChpLCByZWN1cnNlKSB7XG4gICAgICBpZiAoaSA8IGxlbikge1xuICAgICAgICBvYnNlcnZlci5vbk5leHQoYXJnc1tpXSk7XG4gICAgICAgIHJlY3Vyc2UoaSArIDEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgRnJvbUFycmF5U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSh0aGlzLnBhcmVudC5hcmdzLCB0aGlzLm9ic2VydmVyKSk7XG4gIH07XG5cbiAgLyoqXG4gICogIENvbnZlcnRzIGFuIGFycmF5IHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UsIHVzaW5nIGFuIG9wdGlvbmFsIHNjaGVkdWxlciB0byBlbnVtZXJhdGUgdGhlIGFycmF5LlxuICAqIEBkZXByZWNhdGVkIHVzZSBPYnNlcnZhYmxlLmZyb20gb3IgT2JzZXJ2YWJsZS5vZlxuICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSBlbnVtZXJhdGlvbiBvZiB0aGUgaW5wdXQgc2VxdWVuY2Ugb24uXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSBwdWxsZWQgZnJvbSB0aGUgZ2l2ZW4gZW51bWVyYWJsZSBzZXF1ZW5jZS5cbiAgKi9cbiAgdmFyIG9ic2VydmFibGVGcm9tQXJyYXkgPSBPYnNlcnZhYmxlLmZyb21BcnJheSA9IGZ1bmN0aW9uIChhcnJheSwgc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpXG4gIH07XG5cbiAgdmFyIE5ldmVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhOZXZlck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gTmV2ZXJPYnNlcnZhYmxlKCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgTmV2ZXJPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgIH07XG5cbiAgICByZXR1cm4gTmV2ZXJPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIE5FVkVSX09CU0VSVkFCTEUgPSBuZXcgTmV2ZXJPYnNlcnZhYmxlKCk7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBub24tdGVybWluYXRpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgd2hpY2ggY2FuIGJlIHVzZWQgdG8gZGVub3RlIGFuIGluZmluaXRlIGR1cmF0aW9uIChlLmcuIHdoZW4gdXNpbmcgcmVhY3RpdmUgam9pbnMpLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBvYnNlcnZlcnMgd2lsbCBuZXZlciBnZXQgY2FsbGVkLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVOZXZlciA9IE9ic2VydmFibGUubmV2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIE5FVkVSX09CU0VSVkFCTEU7XG4gIH07XG5cbiAgZnVuY3Rpb24gb2JzZXJ2YWJsZU9mIChzY2hlZHVsZXIsIGFycmF5KSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpO1xuICB9XG5cbiAgLyoqXG4gICogIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgT2JzZXJ2YWJsZSBpbnN0YW5jZSB3aXRoIGEgdmFyaWFibGUgbnVtYmVyIG9mIGFyZ3VtZW50cywgcmVnYXJkbGVzcyBvZiBudW1iZXIgb3IgdHlwZSBvZiB0aGUgYXJndW1lbnRzLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgcHVsbGVkIGZyb20gdGhlIGdpdmVuIGFyZ3VtZW50cy5cbiAgKi9cbiAgT2JzZXJ2YWJsZS5vZiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuICB9O1xuXG4gIC8qKlxuICAqICBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgbmV3IE9ic2VydmFibGUgaW5zdGFuY2Ugd2l0aCBhIHZhcmlhYmxlIG51bWJlciBvZiBhcmd1bWVudHMsIHJlZ2FyZGxlc3Mgb2YgbnVtYmVyIG9yIHR5cGUgb2YgdGhlIGFyZ3VtZW50cy5cbiAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIEEgc2NoZWR1bGVyIHRvIHVzZSBmb3Igc2NoZWR1bGluZyB0aGUgYXJndW1lbnRzLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgcHVsbGVkIGZyb20gdGhlIGdpdmVuIGFyZ3VtZW50cy5cbiAgKi9cbiAgT2JzZXJ2YWJsZS5vZldpdGhTY2hlZHVsZXIgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0gMSk7XG4gICAgZm9yKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIFBhaXJzT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhQYWlyc09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUGFpcnNPYnNlcnZhYmxlKG9iaiwgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLm9iaiA9IG9iajtcbiAgICAgIHRoaXMua2V5cyA9IE9iamVjdC5rZXlzKG9iaik7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFBhaXJzT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgUGFpcnNTaW5rKG9ic2VydmVyLCB0aGlzKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICByZXR1cm4gUGFpcnNPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgZnVuY3Rpb24gUGFpcnNTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcbiAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIH1cblxuICBQYWlyc1NpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb2JzZXJ2ZXIgPSB0aGlzLm9ic2VydmVyLCBvYmogPSB0aGlzLnBhcmVudC5vYmosIGtleXMgPSB0aGlzLnBhcmVudC5rZXlzLCBsZW4gPSBrZXlzLmxlbmd0aDtcbiAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGksIHJlY3Vyc2UpIHtcbiAgICAgIGlmIChpIDwgbGVuKSB7XG4gICAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgICBvYnNlcnZlci5vbk5leHQoW2tleSwgb2JqW2tleV1dKTtcbiAgICAgICAgcmVjdXJzZShpICsgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgYW4gb2JqZWN0IGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBba2V5LCB2YWx1ZV0gcGFpcnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZW51bWVyYXRpb24gb2YgdGhlIGlucHV0IHNlcXVlbmNlIG9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBba2V5LCB2YWx1ZV0gcGFpcnMgZnJvbSB0aGUgb2JqZWN0LlxuICAgKi9cbiAgT2JzZXJ2YWJsZS5wYWlycyA9IGZ1bmN0aW9uIChvYmosIHNjaGVkdWxlcikge1xuICAgIHNjaGVkdWxlciB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBQYWlyc09ic2VydmFibGUob2JqLCBzY2hlZHVsZXIpO1xuICB9O1xuXG4gICAgdmFyIFJhbmdlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhSYW5nZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUmFuZ2VPYnNlcnZhYmxlKHN0YXJ0LCBjb3VudCwgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7XG4gICAgICB0aGlzLnJhbmdlQ291bnQgPSBjb3VudDtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgUmFuZ2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICB2YXIgc2luayA9IG5ldyBSYW5nZVNpbmsob2JzZXJ2ZXIsIHRoaXMpO1xuICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBSYW5nZU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgUmFuZ2VTaW5rID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSYW5nZVNpbmsob2JzZXJ2ZXIsIHBhcmVudCkge1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShzdGFydCwgY291bnQsIG9ic2VydmVyKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gbG9vcCAoaSwgcmVjdXJzZSkge1xuICAgICAgICBpZiAoaSA8IGNvdW50KSB7XG4gICAgICAgICAgb2JzZXJ2ZXIub25OZXh0KHN0YXJ0ICsgaSk7XG4gICAgICAgICAgcmVjdXJzZShpICsgMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBSYW5nZVNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoXG4gICAgICAgIDAsXG4gICAgICAgIGxvb3BSZWN1cnNpdmUodGhpcy5wYXJlbnQuc3RhcnQsIHRoaXMucGFyZW50LnJhbmdlQ291bnQsIHRoaXMub2JzZXJ2ZXIpXG4gICAgICApO1xuICAgIH07XG5cbiAgICByZXR1cm4gUmFuZ2VTaW5rO1xuICB9KCkpO1xuXG4gIC8qKlxuICAqICBHZW5lcmF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBpbnRlZ3JhbCBudW1iZXJzIHdpdGhpbiBhIHNwZWNpZmllZCByYW5nZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgb2JzZXJ2ZXIgbWVzc2FnZXMuXG4gICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0IFRoZSB2YWx1ZSBvZiB0aGUgZmlyc3QgaW50ZWdlciBpbiB0aGUgc2VxdWVuY2UuXG4gICogQHBhcmFtIHtOdW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2Ygc2VxdWVudGlhbCBpbnRlZ2VycyB0byBnZW5lcmF0ZS5cbiAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZ2VuZXJhdG9yIGxvb3Agb24uIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5jdXJyZW50VGhyZWFkLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgYSByYW5nZSBvZiBzZXF1ZW50aWFsIGludGVncmFsIG51bWJlcnMuXG4gICovXG4gIE9ic2VydmFibGUucmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQsIGNvdW50LCBzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IFJhbmdlT2JzZXJ2YWJsZShzdGFydCwgY291bnQsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIFJlcGVhdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoUmVwZWF0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBSZXBlYXRPYnNlcnZhYmxlKHZhbHVlLCByZXBlYXRDb3VudCwgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICB0aGlzLnJlcGVhdENvdW50ID0gcmVwZWF0Q291bnQgPT0gbnVsbCA/IC0xIDogcmVwZWF0Q291bnQ7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFJlcGVhdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IFJlcGVhdFNpbmsob2JzZXJ2ZXIsIHRoaXMpO1xuICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBSZXBlYXRPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgZnVuY3Rpb24gUmVwZWF0U2luayhvYnNlcnZlciwgcGFyZW50KSB7XG4gICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICB9XG5cbiAgUmVwZWF0U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBvYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXIsIHZhbHVlID0gdGhpcy5wYXJlbnQudmFsdWU7XG4gICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShpLCByZWN1cnNlKSB7XG4gICAgICBpZiAoaSA9PT0gLTEgfHwgaSA+IDApIHtcbiAgICAgICAgb2JzZXJ2ZXIub25OZXh0KHZhbHVlKTtcbiAgICAgICAgaSA+IDAgJiYgaS0tO1xuICAgICAgfVxuICAgICAgaWYgKGkgPT09IDApIHsgcmV0dXJuIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7IH1cbiAgICAgIHJlY3Vyc2UoaSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSh0aGlzLnBhcmVudC5yZXBlYXRDb3VudCwgbG9vcFJlY3Vyc2l2ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqICBHZW5lcmF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHJlcGVhdHMgdGhlIGdpdmVuIGVsZW1lbnQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IG9ic2VydmVyIG1lc3NhZ2VzLlxuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBFbGVtZW50IHRvIHJlcGVhdC5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IHJlcGVhdENvdW50IFtPcHRpb25hXSBOdW1iZXIgb2YgdGltZXMgdG8gcmVwZWF0IHRoZSBlbGVtZW50LiBJZiBub3Qgc3BlY2lmaWVkLCByZXBlYXRzIGluZGVmaW5pdGVseS5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBTY2hlZHVsZXIgdG8gcnVuIHRoZSBwcm9kdWNlciBsb29wIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuaW1tZWRpYXRlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHJlcGVhdHMgdGhlIGdpdmVuIGVsZW1lbnQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gICAqL1xuICBPYnNlcnZhYmxlLnJlcGVhdCA9IGZ1bmN0aW9uICh2YWx1ZSwgcmVwZWF0Q291bnQsIHNjaGVkdWxlcikge1xuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuICAgIHJldHVybiBuZXcgUmVwZWF0T2JzZXJ2YWJsZSh2YWx1ZSwgcmVwZWF0Q291bnQsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIEp1c3RPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEp1c3RPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEp1c3RPYnNlcnZhYmxlKHZhbHVlLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSnVzdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IEp1c3RTaW5rKG9ic2VydmVyLCB0aGlzLnZhbHVlLCB0aGlzLnNjaGVkdWxlcik7XG4gICAgICByZXR1cm4gc2luay5ydW4oKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gSnVzdFNpbmsob2JzZXJ2ZXIsIHZhbHVlLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjaGVkdWxlSXRlbShzLCBzdGF0ZSkge1xuICAgICAgdmFyIHZhbHVlID0gc3RhdGVbMF0sIG9ic2VydmVyID0gc3RhdGVbMV07XG4gICAgICBvYnNlcnZlci5vbk5leHQodmFsdWUpO1xuICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgfVxuXG4gICAgSnVzdFNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzdGF0ZSA9IFt0aGlzLnZhbHVlLCB0aGlzLm9ic2VydmVyXTtcbiAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlciA9PT0gaW1tZWRpYXRlU2NoZWR1bGVyID9cbiAgICAgICAgc2NoZWR1bGVJdGVtKG51bGwsIHN0YXRlKSA6XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKHN0YXRlLCBzY2hlZHVsZUl0ZW0pO1xuICAgIH07XG5cbiAgICByZXR1cm4gSnVzdE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIGEgc2luZ2xlIGVsZW1lbnQsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IG9ic2VydmVyIG1lc3NhZ2VzLlxuICAgKiAgVGhlcmUgaXMgYW4gYWxpYXMgY2FsbGVkICdqdXN0JyBvciBicm93c2VycyA8SUU5LlxuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBTaW5nbGUgZWxlbWVudCBpbiB0aGUgcmVzdWx0aW5nIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBzY2hlZHVsZXIgU2NoZWR1bGVyIHRvIHNlbmQgdGhlIHNpbmdsZSBlbGVtZW50IG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuaW1tZWRpYXRlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBzaW5nbGUgc3BlY2lmaWVkIGVsZW1lbnQuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZVJldHVybiA9IE9ic2VydmFibGVbJ3JldHVybiddID0gT2JzZXJ2YWJsZS5qdXN0ID0gZnVuY3Rpb24gKHZhbHVlLCBzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXIpO1xuICAgIHJldHVybiBuZXcgSnVzdE9ic2VydmFibGUodmFsdWUsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIFRocm93T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUaHJvd09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGhyb3dPYnNlcnZhYmxlKGVycm9yLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGhyb3dPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IFRocm93U2luayhvLCB0aGlzKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBUaHJvd1NpbmsobywgcCkge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMucCA9IHA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVJdGVtKHMsIHN0YXRlKSB7XG4gICAgICB2YXIgZSA9IHN0YXRlWzBdLCBvID0gc3RhdGVbMV07XG4gICAgICBvLm9uRXJyb3IoZSk7XG4gICAgfVxuXG4gICAgVGhyb3dTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5wLnNjaGVkdWxlci5zY2hlZHVsZShbdGhpcy5wLmVycm9yLCB0aGlzLm9dLCBzY2hlZHVsZUl0ZW0pO1xuICAgIH07XG5cbiAgICByZXR1cm4gVGhyb3dPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCB0ZXJtaW5hdGVzIHdpdGggYW4gZXhjZXB0aW9uLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCB0aGUgc2luZ2xlIG9uRXJyb3IgbWVzc2FnZS5cbiAgICogIFRoZXJlIGlzIGFuIGFsaWFzIHRvIHRoaXMgbWV0aG9kIGNhbGxlZCAndGhyb3dFcnJvcicgZm9yIGJyb3dzZXJzIDxJRTkuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIEFuIG9iamVjdCB1c2VkIGZvciB0aGUgc2VxdWVuY2UncyB0ZXJtaW5hdGlvbi5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBTY2hlZHVsZXIgdG8gc2VuZCB0aGUgZXhjZXB0aW9uYWwgdGVybWluYXRpb24gY2FsbCBvbi4gSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmltbWVkaWF0ZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgdGVybWluYXRlcyBleGNlcHRpb25hbGx5IHdpdGggdGhlIHNwZWNpZmllZCBleGNlcHRpb24gb2JqZWN0LlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVUaHJvdyA9IE9ic2VydmFibGVbJ3Rocm93J10gPSBmdW5jdGlvbiAoZXJyb3IsIHNjaGVkdWxlcikge1xuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBUaHJvd09ic2VydmFibGUoZXJyb3IsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIENhdGNoT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ2F0Y2hPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIENhdGNoT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX2ZuID0gZm47XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBDYXRjaE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGQxID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG4gICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkMSk7XG4gICAgICBkMS5zZXREaXNwb3NhYmxlKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgQ2F0Y2hPYnNlcnZlcihvLCBzdWJzY3JpcHRpb24sIHRoaXMuX2ZuKSkpO1xuICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENhdGNoT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBDYXRjaE9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENhdGNoT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ2F0Y2hPYnNlcnZlcihvLCBzLCBmbikge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIHRoaXMuX2ZuID0gZm47XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBDYXRjaE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fby5vbk5leHQoeCk7IH07XG4gICAgQ2F0Y2hPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuICAgIENhdGNoT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLl9mbikoZSk7XG4gICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuICAgICAgaXNQcm9taXNlKHJlc3VsdCkgJiYgKHJlc3VsdCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShyZXN1bHQpKTtcblxuICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHRoaXMuX3Muc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgIGQuc2V0RGlzcG9zYWJsZShyZXN1bHQuc3Vic2NyaWJlKHRoaXMuX28pKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENhdGNoT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBDb250aW51ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRlcm1pbmF0ZWQgYnkgYW4gZXhjZXB0aW9uIHdpdGggdGhlIG5leHQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtNaXhlZH0gaGFuZGxlck9yU2Vjb25kIEV4Y2VwdGlvbiBoYW5kbGVyIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGdpdmVuIHRoZSBlcnJvciB0aGF0IG9jY3VycmVkIGluIHRoZSBmaXJzdCBzZXF1ZW5jZSwgb3IgYSBzZWNvbmQgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1c2VkIHRvIHByb2R1Y2UgcmVzdWx0cyB3aGVuIGFuIGVycm9yIG9jY3VycmVkIGluIHRoZSBmaXJzdCBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgZmlyc3Qgc2VxdWVuY2UncyBlbGVtZW50cywgZm9sbG93ZWQgYnkgdGhlIGVsZW1lbnRzIG9mIHRoZSBoYW5kbGVyIHNlcXVlbmNlIGluIGNhc2UgYW4gZXhjZXB0aW9uIG9jY3VycmVkLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvWydjYXRjaCddID0gZnVuY3Rpb24gKGhhbmRsZXJPclNlY29uZCkge1xuICAgIHJldHVybiBpc0Z1bmN0aW9uKGhhbmRsZXJPclNlY29uZCkgPyBuZXcgQ2F0Y2hPYnNlcnZhYmxlKHRoaXMsIGhhbmRsZXJPclNlY29uZCkgOiBvYnNlcnZhYmxlQ2F0Y2goW3RoaXMsIGhhbmRsZXJPclNlY29uZF0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDb250aW51ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRlcm1pbmF0ZWQgYnkgYW4gZXhjZXB0aW9uIHdpdGggdGhlIG5leHQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtBcnJheSB8IEFyZ3VtZW50c30gYXJncyBBcmd1bWVudHMgb3IgYW4gYXJyYXkgdG8gdXNlIGFzIHRoZSBuZXh0IHNlcXVlbmNlIGlmIGFuIGVycm9yIG9jY3Vycy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyBlbGVtZW50cyBmcm9tIGNvbnNlY3V0aXZlIHNvdXJjZSBzZXF1ZW5jZXMgdW50aWwgYSBzb3VyY2Ugc2VxdWVuY2UgdGVybWluYXRlcyBzdWNjZXNzZnVsbHkuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZUNhdGNoID0gT2JzZXJ2YWJsZVsnY2F0Y2gnXSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaXRlbXM7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgaXRlbXMgPSBhcmd1bWVudHNbMF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgaXRlbXMgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBpdGVtc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIH1cbiAgICByZXR1cm4gZW51bWVyYWJsZU9mKGl0ZW1zKS5jYXRjaEVycm9yKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFueSBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgb3IgUHJvbWlzZXMgcHJvZHVjZXMgYW4gZWxlbWVudC5cbiAgICogVGhpcyBjYW4gYmUgaW4gdGhlIGZvcm0gb2YgYW4gYXJndW1lbnQgbGlzdCBvZiBvYnNlcnZhYmxlcyBvciBhbiBhcnJheS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogMSAtIG9icyA9IG9ic2VydmFibGUuY29tYmluZUxhdGVzdChvYnMxLCBvYnMyLCBvYnMzLCBmdW5jdGlvbiAobzEsIG8yLCBvMykgeyByZXR1cm4gbzEgKyBvMiArIG8zOyB9KTtcbiAgICogMiAtIG9icyA9IG9ic2VydmFibGUuY29tYmluZUxhdGVzdChbb2JzMSwgb2JzMiwgb2JzM10sIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmNvbWJpbmVMYXRlc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NbMF0pKSB7XG4gICAgICBhcmdzWzBdLnVuc2hpZnQodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFyZ3MudW5zaGlmdCh0aGlzKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbWJpbmVMYXRlc3QuYXBwbHkodGhpcywgYXJncyk7XG4gIH07XG5cbiAgZnVuY3Rpb24gZmFsc2VGYWN0b3J5KCkgeyByZXR1cm4gZmFsc2U7IH1cbiAgZnVuY3Rpb24gYXJndW1lbnRzVG9BcnJheSgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIGFyZ3M7XG4gIH1cblxuICB2YXIgQ29tYmluZUxhdGVzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ29tYmluZUxhdGVzdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29tYmluZUxhdGVzdE9ic2VydmFibGUocGFyYW1zLCBjYikge1xuICAgICAgdGhpcy5fcGFyYW1zID0gcGFyYW1zO1xuICAgICAgdGhpcy5fY2IgPSBjYjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLl9wYXJhbXMubGVuZ3RoLFxuICAgICAgICAgIHN1YnNjcmlwdGlvbnMgPSBuZXcgQXJyYXkobGVuKTtcblxuICAgICAgdmFyIHN0YXRlID0ge1xuICAgICAgICBoYXNWYWx1ZTogYXJyYXlJbml0aWFsaXplKGxlbiwgZmFsc2VGYWN0b3J5KSxcbiAgICAgICAgaGFzVmFsdWVBbGw6IGZhbHNlLFxuICAgICAgICBpc0RvbmU6IGFycmF5SW5pdGlhbGl6ZShsZW4sIGZhbHNlRmFjdG9yeSksXG4gICAgICAgIHZhbHVlczogbmV3IEFycmF5KGxlbilcbiAgICAgIH07XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IHRoaXMuX3BhcmFtc1tpXSwgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgIHN1YnNjcmlwdGlvbnNbaV0gPSBzYWQ7XG4gICAgICAgIGlzUHJvbWlzZShzb3VyY2UpICYmIChzb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uoc291cmNlKSk7XG4gICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUobmV3IENvbWJpbmVMYXRlc3RPYnNlcnZlcihvYnNlcnZlciwgaSwgdGhpcy5fY2IsIHN0YXRlKSkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbnMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gQ29tYmluZUxhdGVzdE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgQ29tYmluZUxhdGVzdE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29tYmluZUxhdGVzdE9ic2VydmVyKG8sIGksIGNiLCBzdGF0ZSkge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9pID0gaTtcbiAgICAgIHRoaXMuX2NiID0gY2I7XG4gICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbm90VGhlU2FtZShpKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHgsIGopIHtcbiAgICAgICAgcmV0dXJuIGogIT09IGk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIENvbWJpbmVMYXRlc3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9zdGF0ZS52YWx1ZXNbdGhpcy5faV0gPSB4O1xuICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVbdGhpcy5faV0gPSB0cnVlO1xuICAgICAgaWYgKHRoaXMuX3N0YXRlLmhhc1ZhbHVlQWxsIHx8ICh0aGlzLl9zdGF0ZS5oYXNWYWx1ZUFsbCA9IHRoaXMuX3N0YXRlLmhhc1ZhbHVlLmV2ZXJ5KGlkZW50aXR5KSkpIHtcbiAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX2NiKS5hcHBseShudWxsLCB0aGlzLl9zdGF0ZS52YWx1ZXMpO1xuICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgICB0aGlzLl9vLm9uTmV4dChyZXMpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLl9zdGF0ZS5pc0RvbmUuZmlsdGVyKG5vdFRoZVNhbWUodGhpcy5faSkpLmV2ZXJ5KGlkZW50aXR5KSkge1xuICAgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIENvbWJpbmVMYXRlc3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3N0YXRlLmlzRG9uZVt0aGlzLl9pXSA9IHRydWU7XG4gICAgICB0aGlzLl9zdGF0ZS5pc0RvbmUuZXZlcnkoaWRlbnRpdHkpICYmIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENvbWJpbmVMYXRlc3RPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYW55IG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBQcm9taXNlcyBwcm9kdWNlcyBhbiBlbGVtZW50LlxuICAqXG4gICogQGV4YW1wbGVcbiAgKiAxIC0gb2JzID0gUnguT2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0KG9iczEsIG9iczIsIG9iczMsIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuICAqIDIgLSBvYnMgPSBSeC5PYnNlcnZhYmxlLmNvbWJpbmVMYXRlc3QoW29iczEsIG9iczIsIG9iczNdLCBmdW5jdGlvbiAobzEsIG8yLCBvMykgeyByZXR1cm4gbzEgKyBvMiArIG8zOyB9KTtcbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAqL1xuICB2YXIgY29tYmluZUxhdGVzdCA9IE9ic2VydmFibGUuY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuICAgIEFycmF5LmlzQXJyYXkoYXJnc1swXSkgJiYgKGFyZ3MgPSBhcmdzWzBdKTtcbiAgICByZXR1cm4gbmV3IENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlKGFyZ3MsIHJlc3VsdFNlbGVjdG9yKTtcbiAgfTtcblxuICAvKipcbiAgICogQ29uY2F0ZW5hdGVzIGFsbCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuICBUaGlzIHRha2VzIGluIGVpdGhlciBhbiBhcnJheSBvciB2YXJpYWJsZSBhcmd1bWVudHMgdG8gY29uY2F0ZW5hdGUuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGVhY2ggZ2l2ZW4gc2VxdWVuY2UsIGluIHNlcXVlbnRpYWwgb3JkZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uY29uY2F0ID0gZnVuY3Rpb24gKCkge1xuICAgIGZvcih2YXIgYXJncyA9IFtdLCBpID0gMCwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3MucHVzaChhcmd1bWVudHNbaV0pOyB9XG4gICAgYXJncy51bnNoaWZ0KHRoaXMpO1xuICAgIHJldHVybiBvYnNlcnZhYmxlQ29uY2F0LmFwcGx5KG51bGwsIGFyZ3MpO1xuICB9O1xuXG4gIHZhciBDb25jYXRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENvbmNhdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29uY2F0T2JzZXJ2YWJsZShzb3VyY2VzKSB7XG4gICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgQ29uY2F0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IENvbmNhdFNpbmsodGhpcy5zb3VyY2VzLCBvKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBDb25jYXRTaW5rKHNvdXJjZXMsIG8pIHtcbiAgICAgIHRoaXMuc291cmNlcyA9IHNvdXJjZXM7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgIH1cbiAgICBDb25jYXRTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaXNEaXNwb3NlZCwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSwgc291cmNlcyA9IHRoaXMuc291cmNlcywgbGVuZ3RoID0gc291cmNlcy5sZW5ndGgsIG8gPSB0aGlzLm87XG4gICAgICB2YXIgY2FuY2VsYWJsZSA9IGltbWVkaWF0ZVNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBmdW5jdGlvbiAoaSwgc2VsZikge1xuICAgICAgICBpZiAoaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cbiAgICAgICAgaWYgKGkgPT09IGxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBzb3VyY2VzW2ldO1xuICAgICAgICBpc1Byb21pc2UoY3VycmVudFZhbHVlKSAmJiAoY3VycmVudFZhbHVlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGN1cnJlbnRWYWx1ZSkpO1xuXG4gICAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgICBkLnNldERpc3Bvc2FibGUoY3VycmVudFZhbHVlLnN1YnNjcmliZShcbiAgICAgICAgICBmdW5jdGlvbiAoeCkgeyBvLm9uTmV4dCh4KTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG4gICAgICAgICAgZnVuY3Rpb24gKCkgeyBzZWxmKGkgKyAxKTsgfVxuICAgICAgICApKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlLCBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICB9KSk7XG4gICAgfTtcblxuXG4gICAgcmV0dXJuIENvbmNhdE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogQ29uY2F0ZW5hdGVzIGFsbCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG4gICAqIEBwYXJhbSB7QXJyYXkgfCBBcmd1bWVudHN9IGFyZ3MgQXJndW1lbnRzIG9yIGFuIGFycmF5IHRvIGNvbmNhdCB0byB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgZWFjaCBnaXZlbiBzZXF1ZW5jZSwgaW4gc2VxdWVudGlhbCBvcmRlci5cbiAgICovXG4gIHZhciBvYnNlcnZhYmxlQ29uY2F0ID0gT2JzZXJ2YWJsZS5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFyZ3M7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgYXJncyA9IGFyZ3VtZW50c1swXTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgIGZvcih2YXIgaSA9IDAsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgQ29uY2F0T2JzZXJ2YWJsZShhcmdzKTtcbiAgfTtcblxuICAvKipcbiAgICogQ29uY2F0ZW5hdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGVhY2ggb2JzZXJ2ZWQgaW5uZXIgc2VxdWVuY2UsIGluIHNlcXVlbnRpYWwgb3JkZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uY29uY2F0QWxsID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLm1lcmdlKDEpO1xuICB9O1xuXG4gIHZhciBNZXJnZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE1lcmdlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIE1lcmdlT2JzZXJ2YWJsZShzb3VyY2UsIG1heENvbmN1cnJlbnQpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5tYXhDb25jdXJyZW50ID0gbWF4Q29uY3VycmVudDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE1lcmdlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG9ic2VydmVyKSB7XG4gICAgICB2YXIgZyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG4gICAgICBnLmFkZCh0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IE1lcmdlT2JzZXJ2ZXIob2JzZXJ2ZXIsIHRoaXMubWF4Q29uY3VycmVudCwgZykpKTtcbiAgICAgIHJldHVybiBnO1xuICAgIH07XG5cbiAgICByZXR1cm4gTWVyZ2VPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgTWVyZ2VPYnNlcnZlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWVyZ2VPYnNlcnZlcihvLCBtYXgsIGcpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLm1heCA9IG1heDtcbiAgICAgIHRoaXMuZyA9IGc7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMucSA9IFtdO1xuICAgICAgdGhpcy5hY3RpdmVDb3VudCA9IDA7XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5oYW5kbGVTdWJzY3JpYmUgPSBmdW5jdGlvbiAoeHMpIHtcbiAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHRoaXMuZy5hZGQoc2FkKTtcbiAgICAgIGlzUHJvbWlzZSh4cykgJiYgKHhzID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHhzKSk7XG4gICAgICBzYWQuc2V0RGlzcG9zYWJsZSh4cy5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIodGhpcywgc2FkKSkpO1xuICAgIH07XG4gICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKGlubmVyU291cmNlKSB7XG4gICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmKHRoaXMuYWN0aXZlQ291bnQgPCB0aGlzLm1heCkge1xuICAgICAgICAgIHRoaXMuYWN0aXZlQ291bnQrKztcbiAgICAgICAgICB0aGlzLmhhbmRsZVN1YnNjcmliZShpbm5lclNvdXJjZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xLnB1c2goaW5uZXJTb3VyY2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuYWN0aXZlQ291bnQgPT09IDAgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcbiAgICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcblxuICAgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihwYXJlbnQsIHNhZCkge1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5zYWQgPSBzYWQ7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoeCkgeyBpZighdGhpcy5pc1N0b3BwZWQpIHsgdGhpcy5wYXJlbnQuby5vbk5leHQoeCk7IH0gfTtcbiAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICAgIHBhcmVudC5nLnJlbW92ZSh0aGlzLnNhZCk7XG4gICAgICAgICAgaWYgKHBhcmVudC5xLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHBhcmVudC5oYW5kbGVTdWJzY3JpYmUocGFyZW50LnEuc2hpZnQoKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBhcmVudC5hY3RpdmVDb3VudC0tO1xuICAgICAgICAgICAgcGFyZW50LmRvbmUgJiYgcGFyZW50LmFjdGl2ZUNvdW50ID09PSAwICYmIHBhcmVudC5vLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG4gICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLnBhcmVudC5vLm9uRXJyb3IoZSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gTWVyZ2VPYnNlcnZlcjtcbiAgfSgpKTtcblxuXG5cblxuXG4gIC8qKlxuICAqIE1lcmdlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgbGltaXRpbmcgdGhlIG51bWJlciBvZiBjb25jdXJyZW50IHN1YnNjcmlwdGlvbnMgdG8gaW5uZXIgc2VxdWVuY2VzLlxuICAqIE9yIG1lcmdlcyB0d28gb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhIHNpbmdsZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqXG4gICogQGV4YW1wbGVcbiAgKiAxIC0gbWVyZ2VkID0gc291cmNlcy5tZXJnZSgxKTtcbiAgKiAyIC0gbWVyZ2VkID0gc291cmNlLm1lcmdlKG90aGVyU291cmNlKTtcbiAgKiBAcGFyYW0ge01peGVkfSBbbWF4Q29uY3VycmVudE9yT3RoZXJdIE1heGltdW0gbnVtYmVyIG9mIGlubmVyIG9ic2VydmFibGUgc2VxdWVuY2VzIGJlaW5nIHN1YnNjcmliZWQgdG8gY29uY3VycmVudGx5IG9yIHRoZSBzZWNvbmQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBtZXJnZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBpbm5lciBzZXF1ZW5jZXMuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5tZXJnZSA9IGZ1bmN0aW9uIChtYXhDb25jdXJyZW50T3JPdGhlcikge1xuICAgIHJldHVybiB0eXBlb2YgbWF4Q29uY3VycmVudE9yT3RoZXIgIT09ICdudW1iZXInID9cbiAgICAgIG9ic2VydmFibGVNZXJnZSh0aGlzLCBtYXhDb25jdXJyZW50T3JPdGhlcikgOlxuICAgICAgbmV3IE1lcmdlT2JzZXJ2YWJsZSh0aGlzLCBtYXhDb25jdXJyZW50T3JPdGhlcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1lcmdlcyBhbGwgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYSBzaW5nbGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogVGhlIHNjaGVkdWxlciBpcyBvcHRpb25hbCBhbmQgaWYgbm90IHNwZWNpZmllZCwgdGhlIGltbWVkaWF0ZSBzY2hlZHVsZXIgaXMgdXNlZC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgbWVyZ2VzIHRoZSBlbGVtZW50cyBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZU1lcmdlID0gT2JzZXJ2YWJsZS5tZXJnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2NoZWR1bGVyLCBzb3VyY2VzID0gW10sIGksIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgaWYgKCFhcmd1bWVudHNbMF0pIHtcbiAgICAgIHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcjtcbiAgICAgIGZvcihpID0gMTsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG4gICAgfSBlbHNlIGlmIChpc1NjaGVkdWxlcihhcmd1bWVudHNbMF0pKSB7XG4gICAgICBzY2hlZHVsZXIgPSBhcmd1bWVudHNbMF07XG4gICAgICBmb3IoaSA9IDE7IGkgPCBsZW47IGkrKykgeyBzb3VyY2VzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXI7XG4gICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgeyBzb3VyY2VzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2VzWzBdKSkge1xuICAgICAgc291cmNlcyA9IHNvdXJjZXNbMF07XG4gICAgfVxuICAgIHJldHVybiBvYnNlcnZhYmxlT2Yoc2NoZWR1bGVyLCBzb3VyY2VzKS5tZXJnZUFsbCgpO1xuICB9O1xuXG4gIHZhciBDb21wb3NpdGVFcnJvciA9IFJ4LkNvbXBvc2l0ZUVycm9yID0gZnVuY3Rpb24oZXJyb3JzKSB7XG4gICAgdGhpcy5pbm5lckVycm9ycyA9IGVycm9ycztcbiAgICB0aGlzLm1lc3NhZ2UgPSAnVGhpcyBjb250YWlucyBtdWx0aXBsZSBlcnJvcnMuIENoZWNrIHRoZSBpbm5lckVycm9ycyc7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgQ29tcG9zaXRlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuICBDb21wb3NpdGVFcnJvci5wcm90b3R5cGUubmFtZSA9ICdDb21wb3NpdGVFcnJvcic7XG5cbiAgdmFyIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBncm91cCA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCksXG4gICAgICAgIG0gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcbiAgICAgICAgc3RhdGUgPSB7IGlzU3RvcHBlZDogZmFsc2UsIGVycm9yczogW10sIG86IG8gfTtcblxuICAgICAgZ3JvdXAuYWRkKG0pO1xuICAgICAgbS5zZXREaXNwb3NhYmxlKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIoZ3JvdXAsIHN0YXRlKSkpO1xuXG4gICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfTtcblxuICAgIHJldHVybiBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE1lcmdlRGVsYXlFcnJvck9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyKGdyb3VwLCBzdGF0ZSkge1xuICAgICAgdGhpcy5fZ3JvdXAgPSBncm91cDtcbiAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRDb21wbGV0aW9uKG8sIGVycm9ycykge1xuICAgICAgaWYgKGVycm9ycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfSBlbHNlIGlmIChlcnJvcnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIG8ub25FcnJvcihlcnJvcnNbMF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgby5vbkVycm9yKG5ldyBDb21wb3NpdGVFcnJvcihlcnJvcnMpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB2YXIgaW5uZXIgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHRoaXMuX2dyb3VwLmFkZChpbm5lcik7XG5cbiAgICAgIC8vIENoZWNrIGZvciBwcm9taXNlcyBzdXBwb3J0XG4gICAgICBpc1Byb21pc2UoeCkgJiYgKHggPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoeCkpO1xuICAgICAgaW5uZXIuc2V0RGlzcG9zYWJsZSh4LnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihpbm5lciwgdGhpcy5fZ3JvdXAsIHRoaXMuX3N0YXRlKSkpO1xuICAgIH07XG5cbiAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fc3RhdGUuZXJyb3JzLnB1c2goZSk7XG4gICAgICB0aGlzLl9zdGF0ZS5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fZ3JvdXAubGVuZ3RoID09PSAxICYmIHNldENvbXBsZXRpb24odGhpcy5fc3RhdGUubywgdGhpcy5fc3RhdGUuZXJyb3JzKTtcbiAgICB9O1xuXG4gICAgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIoaW5uZXIsIGdyb3VwLCBzdGF0ZSkge1xuICAgICAgdGhpcy5faW5uZXIgPSBpbm5lcjtcbiAgICAgIHRoaXMuX2dyb3VwID0gZ3JvdXA7XG4gICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX3N0YXRlLm8ub25OZXh0KHgpOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX3N0YXRlLmVycm9ycy5wdXNoKGUpO1xuICAgICAgdGhpcy5fZ3JvdXAucmVtb3ZlKHRoaXMuX2lubmVyKTtcbiAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCAmJiB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fZ3JvdXAucmVtb3ZlKHRoaXMuX2lubmVyKTtcbiAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCAmJiB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAqIEZsYXR0ZW5zIGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBPYnNlcnZhYmxlcyBpbnRvIG9uZSBPYnNlcnZhYmxlLCBpbiBhIHdheSB0aGF0IGFsbG93cyBhbiBPYnNlcnZlciB0b1xuICAqIHJlY2VpdmUgYWxsIHN1Y2Nlc3NmdWxseSBlbWl0dGVkIGl0ZW1zIGZyb20gYWxsIG9mIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZXMgd2l0aG91dCBiZWluZyBpbnRlcnJ1cHRlZCBieVxuICAqIGFuIGVycm9yIG5vdGlmaWNhdGlvbiBmcm9tIG9uZSBvZiB0aGVtLlxuICAqXG4gICogVGhpcyBiZWhhdmVzIGxpa2UgT2JzZXJ2YWJsZS5wcm90b3R5cGUubWVyZ2VBbGwgZXhjZXB0IHRoYXQgaWYgYW55IG9mIHRoZSBtZXJnZWQgT2JzZXJ2YWJsZXMgbm90aWZ5IG9mIGFuXG4gICogZXJyb3IgdmlhIHRoZSBPYnNlcnZlcidzIG9uRXJyb3IsIG1lcmdlRGVsYXlFcnJvciB3aWxsIHJlZnJhaW4gZnJvbSBwcm9wYWdhdGluZyB0aGF0XG4gICogZXJyb3Igbm90aWZpY2F0aW9uIHVudGlsIGFsbCBvZiB0aGUgbWVyZ2VkIE9ic2VydmFibGVzIGhhdmUgZmluaXNoZWQgZW1pdHRpbmcgaXRlbXMuXG4gICogQHBhcmFtIHtBcnJheSB8IEFyZ3VtZW50c30gYXJncyBBcmd1bWVudHMgb3IgYW4gYXJyYXkgdG8gbWVyZ2UuXG4gICogQHJldHVybnMge09ic2VydmFibGV9IGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBhbGwgb2YgdGhlIGl0ZW1zIGVtaXR0ZWQgYnkgdGhlIE9ic2VydmFibGVzIGVtaXR0ZWQgYnkgdGhlIE9ic2VydmFibGVcbiAgKi9cbiAgT2JzZXJ2YWJsZS5tZXJnZURlbGF5RXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXJncztcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG4gICAgICBhcmdzID0gYXJndW1lbnRzWzBdO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgfVxuICAgIHZhciBzb3VyY2UgPSBvYnNlcnZhYmxlT2YobnVsbCwgYXJncyk7XG4gICAgcmV0dXJuIG5ldyBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlKHNvdXJjZSk7XG4gIH07XG5cbiAgdmFyIE1lcmdlQWxsT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTWVyZ2VBbGxPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gTWVyZ2VBbGxPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBNZXJnZUFsbE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBnID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKSwgbSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgZy5hZGQobSk7XG4gICAgICBtLnNldERpc3Bvc2FibGUodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNZXJnZUFsbE9ic2VydmVyKG9ic2VydmVyLCBnKSkpO1xuICAgICAgcmV0dXJuIGc7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIE1lcmdlQWxsT2JzZXJ2ZXIobywgZykge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMuZyA9IGc7XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgfVxuICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uKGlubmVyU291cmNlKSB7XG4gICAgICBpZih0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHRoaXMuZy5hZGQoc2FkKTtcblxuICAgICAgaXNQcm9taXNlKGlubmVyU291cmNlKSAmJiAoaW5uZXJTb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoaW5uZXJTb3VyY2UpKTtcblxuICAgICAgc2FkLnNldERpc3Bvc2FibGUoaW5uZXJTb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKHRoaXMsIHNhZCkpKTtcbiAgICB9O1xuICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZy5sZW5ndGggPT09IDEgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcbiAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihwYXJlbnQsIHNhZCkge1xuICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICB0aGlzLnNhZCA9IHNhZDtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7IGlmICghdGhpcy5pc1N0b3BwZWQpIHsgdGhpcy5wYXJlbnQuby5vbk5leHQoeCk7IH0gfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICBwYXJlbnQuZy5yZW1vdmUodGhpcy5zYWQpO1xuICAgICAgICBwYXJlbnQuZG9uZSAmJiBwYXJlbnQuZy5sZW5ndGggPT09IDEgJiYgcGFyZW50Lm8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE1lcmdlQWxsT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqIE1lcmdlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBtZXJnZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBpbm5lciBzZXF1ZW5jZXMuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5tZXJnZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IE1lcmdlQWxsT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICB2YXIgU2tpcFVudGlsT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTa2lwVW50aWxPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gU2tpcFVudGlsT2JzZXJ2YWJsZShzb3VyY2UsIG90aGVyKSB7XG4gICAgICB0aGlzLl9zID0gc291cmNlO1xuICAgICAgdGhpcy5fbyA9IGlzUHJvbWlzZShvdGhlcikgPyBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpIDogb3RoZXI7XG4gICAgICB0aGlzLl9vcGVuID0gZmFsc2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwVW50aWxPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuICAgICAgdmFyIGxlZnRTdWJzY3JpcHRpb24gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIGxlZnRTdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZSh0aGlzLl9zLnN1YnNjcmliZShuZXcgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIobywgdGhpcykpKTtcblxuICAgICAgaXNQcm9taXNlKHRoaXMuX28pICYmICh0aGlzLl9vID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHRoaXMuX28pKTtcblxuICAgICAgdmFyIHJpZ2h0U3Vic2NyaXB0aW9uID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICByaWdodFN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHRoaXMuX28uc3Vic2NyaWJlKG5ldyBTa2lwVW50aWxPdGhlck9ic2VydmVyKG8sIHRoaXMsIHJpZ2h0U3Vic2NyaXB0aW9uKSkpO1xuXG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUobGVmdFN1YnNjcmlwdGlvbiwgcmlnaHRTdWJzY3JpcHRpb24pO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcFVudGlsT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBTa2lwVW50aWxTb3VyY2VPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTa2lwVW50aWxTb3VyY2VPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwVW50aWxTb3VyY2VPYnNlcnZlcihvLCBwKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3AgPSBwO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdGhpcy5fcC5fb3BlbiAmJiB0aGlzLl9vLm9uTmV4dCh4KTtcbiAgICB9O1xuXG4gICAgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGVycik7XG4gICAgfTtcblxuICAgIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3AuX29wZW4gJiYgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcFVudGlsU291cmNlT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIHZhciBTa2lwVW50aWxPdGhlck9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gU2tpcFVudGlsT3RoZXJPYnNlcnZlcihvLCBwLCByKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3AgPSBwO1xuICAgICAgdGhpcy5fciA9IHI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwVW50aWxPdGhlck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fcC5fb3BlbiA9IHRydWU7XG4gICAgICB0aGlzLl9yLmRpc3Bvc2UoKTtcbiAgICB9O1xuXG4gICAgU2tpcFVudGlsT3RoZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZXJyKTtcbiAgICB9O1xuXG4gICAgU2tpcFVudGlsT3RoZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9yLmRpc3Bvc2UoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB2YWx1ZXMgZnJvbSB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2Ugb25seSBhZnRlciB0aGUgb3RoZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNlcyBhIHZhbHVlLlxuICAgKiBAcGFyYW0ge09ic2VydmFibGUgfCBQcm9taXNlfSBvdGhlciBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvciBQcm9taXNlIHRoYXQgdHJpZ2dlcnMgcHJvcGFnYXRpb24gb2YgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZSBzdGFydGluZyBmcm9tIHRoZSBwb2ludCB0aGUgb3RoZXIgc2VxdWVuY2UgdHJpZ2dlcmVkIHByb3BhZ2F0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNraXBVbnRpbCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHJldHVybiBuZXcgU2tpcFVudGlsT2JzZXJ2YWJsZSh0aGlzLCBvdGhlcik7XG4gIH07XG5cbiAgdmFyIFN3aXRjaE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU3dpdGNoT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTd2l0Y2hPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTd2l0Y2hPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBpbm5lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksIHMgPSB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFN3aXRjaE9ic2VydmVyKG8sIGlubmVyKSk7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUocywgaW5uZXIpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhTd2l0Y2hPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gU3dpdGNoT2JzZXJ2ZXIobywgaW5uZXIpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmlubmVyID0gaW5uZXI7XG4gICAgICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMubGF0ZXN0ID0gMDtcbiAgICAgIHRoaXMuaGFzTGF0ZXN0ID0gZmFsc2U7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU3dpdGNoT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaW5uZXJTb3VyY2UpIHtcbiAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIGlkID0gKyt0aGlzLmxhdGVzdDtcbiAgICAgIHRoaXMuaGFzTGF0ZXN0ID0gdHJ1ZTtcbiAgICAgIHRoaXMuaW5uZXIuc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgIGlzUHJvbWlzZShpbm5lclNvdXJjZSkgJiYgKGlubmVyU291cmNlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGlubmVyU291cmNlKSk7XG4gICAgICBkLnNldERpc3Bvc2FibGUoaW5uZXJTb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKHRoaXMsIGlkKSkpO1xuICAgIH07XG5cbiAgICBTd2l0Y2hPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIFN3aXRjaE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnN0b3BwZWQgPSB0cnVlO1xuICAgICAgIXRoaXMuaGFzTGF0ZXN0ICYmIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKHBhcmVudCwgaWQpIHtcbiAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMucGFyZW50LmxhdGVzdCA9PT0gdGhpcy5pZCAmJiB0aGlzLnBhcmVudC5vLm9uTmV4dCh4KTtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5wYXJlbnQubGF0ZXN0ID09PSB0aGlzLmlkICYmIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMucGFyZW50LmxhdGVzdCA9PT0gdGhpcy5pZCkge1xuICAgICAgICB0aGlzLnBhcmVudC5oYXNMYXRlc3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wYXJlbnQuaXNTdG9wcGVkICYmIHRoaXMucGFyZW50Lm8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIFN3aXRjaE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgKiBUcmFuc2Zvcm1zIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2luZyB2YWx1ZXMgb25seSBmcm9tIHRoZSBtb3N0IHJlY2VudCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGF0IGFueSBwb2ludCBpbiB0aW1lIHByb2R1Y2VzIHRoZSBlbGVtZW50cyBvZiB0aGUgbW9zdCByZWNlbnQgaW5uZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGhhcyBiZWVuIHJlY2VpdmVkLlxuICAqL1xuICBvYnNlcnZhYmxlUHJvdG9bJ3N3aXRjaCddID0gb2JzZXJ2YWJsZVByb3RvLnN3aXRjaExhdGVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IFN3aXRjaE9ic2VydmFibGUodGhpcyk7XG4gIH07XG5cbiAgdmFyIFRha2VVbnRpbE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGFrZVVudGlsT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIFRha2VVbnRpbE9ic2VydmFibGUoc291cmNlLCBvdGhlcikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLm90aGVyID0gaXNQcm9taXNlKG90aGVyKSA/IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikgOiBvdGhlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRha2VVbnRpbE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG4gICAgICAgIHRoaXMuc291cmNlLnN1YnNjcmliZShvKSxcbiAgICAgICAgdGhpcy5vdGhlci5zdWJzY3JpYmUobmV3IFRha2VVbnRpbE9ic2VydmVyKG8pKVxuICAgICAgKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRha2VVbnRpbE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgVGFrZVVudGlsT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGFrZVVudGlsT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGFrZVVudGlsT2JzZXJ2ZXIobykge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUYWtlVW50aWxPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgVGFrZVVudGlsT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGVycik7XG4gICAgfTtcblxuICAgIFRha2VVbnRpbE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IG5vb3A7XG5cbiAgICByZXR1cm4gVGFrZVVudGlsT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB2YWx1ZXMgZnJvbSB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdW50aWwgdGhlIG90aGVyIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjZXMgYSB2YWx1ZS5cbiAgICogQHBhcmFtIHtPYnNlcnZhYmxlIHwgUHJvbWlzZX0gb3RoZXIgT2JzZXJ2YWJsZSBzZXF1ZW5jZSBvciBQcm9taXNlIHRoYXQgdGVybWluYXRlcyBwcm9wYWdhdGlvbiBvZiBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlIHVwIHRvIHRoZSBwb2ludCB0aGUgb3RoZXIgc2VxdWVuY2UgaW50ZXJydXB0ZWQgZnVydGhlciBwcm9wYWdhdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50YWtlVW50aWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICByZXR1cm4gbmV3IFRha2VVbnRpbE9ic2VydmFibGUodGhpcywgb3RoZXIpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGZhbHNlRmFjdG9yeSgpIHsgcmV0dXJuIGZhbHNlOyB9XG4gIGZ1bmN0aW9uIGFyZ3VtZW50c1RvQXJyYXkoKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIHJldHVybiBhcmdzO1xuICB9XG5cbiAgdmFyIFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlKHNvdXJjZSwgc291cmNlcywgcmVzdWx0U2VsZWN0b3IpIHtcbiAgICAgIHRoaXMuX3MgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9zcyA9IHNvdXJjZXM7XG4gICAgICB0aGlzLl9jYiA9IHJlc3VsdFNlbGVjdG9yO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLl9zcy5sZW5ndGg7XG4gICAgICB2YXIgc3RhdGUgPSB7XG4gICAgICAgIGhhc1ZhbHVlOiBhcnJheUluaXRpYWxpemUobGVuLCBmYWxzZUZhY3RvcnkpLFxuICAgICAgICBoYXNWYWx1ZUFsbDogZmFsc2UsXG4gICAgICAgIHZhbHVlczogbmV3IEFycmF5KGxlbilcbiAgICAgIH07XG5cbiAgICAgIHZhciBuID0gdGhpcy5fc3MubGVuZ3RoLCBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KG4gKyAxKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIHZhciBvdGhlciA9IHRoaXMuX3NzW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgaXNQcm9taXNlKG90aGVyKSAmJiAob3RoZXIgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpKTtcbiAgICAgICAgc2FkLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG5ldyBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIobywgaSwgc3RhdGUpKSk7XG4gICAgICAgIHN1YnNjcmlwdGlvbnNbaV0gPSBzYWQ7XG4gICAgICB9XG5cbiAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHRoaXMuX3Muc3Vic2NyaWJlKG5ldyBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyKG8sIHRoaXMuX2NiLCBzdGF0ZSkpKTtcbiAgICAgIHN1YnNjcmlwdGlvbnNbbl0gPSBzYWQ7XG5cbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG4gICAgfTtcblxuICAgIHJldHVybiBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyKG8sIGksIHN0YXRlKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX2kgPSBpO1xuICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9zdGF0ZS52YWx1ZXNbdGhpcy5faV0gPSB4O1xuICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVbdGhpcy5faV0gPSB0cnVlO1xuICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwgPSB0aGlzLl9zdGF0ZS5oYXNWYWx1ZS5ldmVyeShpZGVudGl0eSk7XG4gICAgfTtcblxuICAgIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IG5vb3A7XG5cbiAgICByZXR1cm4gV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICB2YXIgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyKG8sIGNiLCBzdGF0ZSkge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9jYiA9IGNiO1xuICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdmFyIGFsbFZhbHVlcyA9IFt4XS5jb25jYXQodGhpcy5fc3RhdGUudmFsdWVzKTtcbiAgICAgIGlmICghdGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwpIHsgcmV0dXJuOyB9XG4gICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5fY2IpLmFwcGx5KG51bGwsIGFsbFZhbHVlcyk7XG4gICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgdGhpcy5fby5vbk5leHQocmVzKTtcbiAgICB9O1xuXG4gICAgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gb25seSB3aGVuIHRoZSAoZmlyc3QpIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2VzIGFuIGVsZW1lbnQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ud2l0aExhdGVzdEZyb20gPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFyZ3VtZW50cycpOyB9XG5cbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuICAgIEFycmF5LmlzQXJyYXkoYXJnc1swXSkgJiYgKGFyZ3MgPSBhcmdzWzBdKTtcblxuICAgIHJldHVybiBuZXcgV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlKHRoaXMsIGFyZ3MsIHJlc3VsdFNlbGVjdG9yKTtcbiAgfTtcblxuICBmdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuICBmdW5jdGlvbiBlbXB0eUFycmF5RmFjdG9yeSgpIHsgcmV0dXJuIFtdOyB9XG5cbiAgdmFyIFppcE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoWmlwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBaaXBPYnNlcnZhYmxlKHNvdXJjZXMsIHJlc3VsdFNlbGVjdG9yKSB7XG4gICAgICB0aGlzLl9zID0gc291cmNlcztcbiAgICAgIHRoaXMuX2NiID0gcmVzdWx0U2VsZWN0b3I7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBaaXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBuID0gdGhpcy5fcy5sZW5ndGgsXG4gICAgICAgICAgc3Vic2NyaXB0aW9ucyA9IG5ldyBBcnJheShuKTtcbiAgICAgICAgICBkb25lID0gYXJyYXlJbml0aWFsaXplKG4sIGZhbHNlRmFjdG9yeSksXG4gICAgICAgICAgcSA9IGFycmF5SW5pdGlhbGl6ZShuLCBlbXB0eUFycmF5RmFjdG9yeSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLl9zW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcbiAgICAgICAgaXNQcm9taXNlKHNvdXJjZSkgJiYgKHNvdXJjZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShzb3VyY2UpKTtcbiAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShuZXcgWmlwT2JzZXJ2ZXIob2JzZXJ2ZXIsIGksIHRoaXMsIHEsIGRvbmUpKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG4gICAgfTtcblxuICAgIHJldHVybiBaaXBPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFppcE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhaaXBPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBaaXBPYnNlcnZlcihvLCBpLCBwLCBxLCBkKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX2kgPSBpO1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9xID0gcTtcbiAgICAgIHRoaXMuX2QgPSBkO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbm90RW1wdHkoeCkgeyByZXR1cm4geC5sZW5ndGggPiAwOyB9XG4gICAgZnVuY3Rpb24gc2hpZnRFYWNoKHgpIHsgcmV0dXJuIHguc2hpZnQoKTsgfVxuICAgIGZ1bmN0aW9uIG5vdFRoZVNhbWUoaSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh4LCBqKSB7XG4gICAgICAgIHJldHVybiBqICE9PSBpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBaaXBPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9xW3RoaXMuX2ldLnB1c2goeCk7XG4gICAgICBpZiAodGhpcy5fcS5ldmVyeShub3RFbXB0eSkpIHtcbiAgICAgICAgdmFyIHF1ZXVlZFZhbHVlcyA9IHRoaXMuX3EubWFwKHNoaWZ0RWFjaCk7XG4gICAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl9wLl9jYikuYXBwbHkobnVsbCwgcXVldWVkVmFsdWVzKTtcbiAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcihyZXMuZSk7IH1cbiAgICAgICAgdGhpcy5fby5vbk5leHQocmVzKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fZC5maWx0ZXIobm90VGhlU2FtZSh0aGlzLl9pKSkuZXZlcnkoaWRlbnRpdHkpKSB7XG4gICAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgWmlwT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgWmlwT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2RbdGhpcy5faV0gPSB0cnVlO1xuICAgICAgdGhpcy5fZC5ldmVyeShpZGVudGl0eSkgJiYgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gWmlwT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbGwgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIG9yIGFuIGFycmF5IGhhdmUgcHJvZHVjZWQgYW4gZWxlbWVudCBhdCBhIGNvcnJlc3BvbmRpbmcgaW5kZXguXG4gICAqIFRoZSBsYXN0IGVsZW1lbnQgaW4gdGhlIGFyZ3VtZW50cyBtdXN0IGJlIGEgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIHNlcmllcyBvZiBlbGVtZW50cyBhdCBjb3JyZXNwb25kaW5nIGluZGV4ZXMgaW4gdGhlIGFyZ3MuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIGFyZ3MgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uemlwID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7IHRocm93IG5ldyBFcnJvcignaW52YWxpZCBhcmd1bWVudHMnKTsgfVxuXG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIHZhciByZXN1bHRTZWxlY3RvciA9IGlzRnVuY3Rpb24oYXJnc1tsZW4gLSAxXSkgPyBhcmdzLnBvcCgpIDogYXJndW1lbnRzVG9BcnJheTtcbiAgICBBcnJheS5pc0FycmF5KGFyZ3NbMF0pICYmIChhcmdzID0gYXJnc1swXSk7XG5cbiAgICB2YXIgcGFyZW50ID0gdGhpcztcbiAgICBhcmdzLnVuc2hpZnQocGFyZW50KTtcblxuICAgIHJldHVybiBuZXcgWmlwT2JzZXJ2YWJsZShhcmdzLCByZXN1bHRTZWxlY3Rvcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFsbCBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaGF2ZSBwcm9kdWNlZCBhbiBlbGVtZW50IGF0IGEgY29ycmVzcG9uZGluZyBpbmRleC5cbiAgICogQHBhcmFtIGFyZ3VtZW50cyBPYnNlcnZhYmxlIHNvdXJjZXMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IHJlc3VsdFNlbGVjdG9yIEZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBzZXJpZXMgb2YgZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzIGluIHRoZSBzb3VyY2VzLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgT2JzZXJ2YWJsZS56aXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NbMF0pKSB7XG4gICAgICBhcmdzID0gaXNGdW5jdGlvbihhcmdzWzFdKSA/IGFyZ3NbMF0uY29uY2F0KGFyZ3NbMV0pIDogYXJnc1swXTtcbiAgICB9XG4gICAgdmFyIGZpcnN0ID0gYXJncy5zaGlmdCgpO1xuICAgIHJldHVybiBmaXJzdC56aXAuYXBwbHkoZmlyc3QsIGFyZ3MpO1xuICB9O1xuXG5mdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuZnVuY3Rpb24gZW1wdHlBcnJheUZhY3RvcnkoKSB7IHJldHVybiBbXTsgfVxuZnVuY3Rpb24gYXJndW1lbnRzVG9BcnJheSgpIHtcbiAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgcmV0dXJuIGFyZ3M7XG59XG5cbi8qKlxuICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYWxsIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBhbiBhcnJheSBoYXZlIHByb2R1Y2VkIGFuIGVsZW1lbnQgYXQgYSBjb3JyZXNwb25kaW5nIGluZGV4LlxuICogVGhlIGxhc3QgZWxlbWVudCBpbiB0aGUgYXJndW1lbnRzIG11c3QgYmUgYSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggc2VyaWVzIG9mIGVsZW1lbnRzIGF0IGNvcnJlc3BvbmRpbmcgaW5kZXhlcyBpbiB0aGUgYXJncy5cbiAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIGFyZ3MgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gKi9cbm9ic2VydmFibGVQcm90by56aXBJdGVyYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFyZ3VtZW50cycpOyB9XG5cbiAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuXG4gIHZhciBwYXJlbnQgPSB0aGlzO1xuICBhcmdzLnVuc2hpZnQocGFyZW50KTtcbiAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgdmFyIG4gPSBhcmdzLmxlbmd0aCxcbiAgICAgIHF1ZXVlcyA9IGFycmF5SW5pdGlhbGl6ZShuLCBlbXB0eUFycmF5RmFjdG9yeSksXG4gICAgICBpc0RvbmUgPSBhcnJheUluaXRpYWxpemUobiwgZmFsc2VGYWN0b3J5KTtcblxuICAgIHZhciBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KG4pO1xuICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IG47IGlkeCsrKSB7XG4gICAgICAoZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3NbaV0sIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXG4gICAgICAgIChpc0FycmF5TGlrZShzb3VyY2UpIHx8IGlzSXRlcmFibGUoc291cmNlKSkgJiYgKHNvdXJjZSA9IG9ic2VydmFibGVGcm9tKHNvdXJjZSkpO1xuXG4gICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICBxdWV1ZXNbaV0ucHVzaCh4KTtcbiAgICAgICAgICBpZiAocXVldWVzLmV2ZXJ5KGZ1bmN0aW9uICh4KSB7IHJldHVybiB4Lmxlbmd0aCA+IDA7IH0pKSB7XG4gICAgICAgICAgICB2YXIgcXVldWVkVmFsdWVzID0gcXVldWVzLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5zaGlmdCgpOyB9KSxcbiAgICAgICAgICAgICAgICByZXMgPSB0cnlDYXRjaChyZXN1bHRTZWxlY3RvcikuYXBwbHkocGFyZW50LCBxdWV1ZWRWYWx1ZXMpO1xuICAgICAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXMuZSk7IH1cbiAgICAgICAgICAgIG8ub25OZXh0KHJlcyk7XG4gICAgICAgICAgfSBlbHNlIGlmIChpc0RvbmUuZmlsdGVyKGZ1bmN0aW9uICh4LCBqKSB7IHJldHVybiBqICE9PSBpOyB9KS5ldmVyeShpZGVudGl0eSkpIHtcbiAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlzRG9uZVtpXSA9IHRydWU7XG4gICAgICAgICAgaXNEb25lLmV2ZXJ5KGlkZW50aXR5KSAmJiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcbiAgICAgIH0pKGlkeCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbnMpO1xuICB9LCBwYXJlbnQpO1xufTtcblxuICBmdW5jdGlvbiBhc09ic2VydmFibGUoc291cmNlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIHN1YnNjcmliZShvKSB7IHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG8pOyB9O1xuICB9XG5cbiAgLyoqXG4gICAqICBIaWRlcyB0aGUgaWRlbnRpdHkgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBoaWRlcyB0aGUgaWRlbnRpdHkgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5hc09ic2VydmFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGFzT2JzZXJ2YWJsZSh0aGlzKSwgdGhpcyk7XG4gIH07XG5cbiAgdmFyIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZShzb3VyY2UpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgRGVtYXRlcmlhbGl6ZU9ic2VydmVyKG8pKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIERlbWF0ZXJpYWxpemVPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRGVtYXRlcmlhbGl6ZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gRGVtYXRlcmlhbGl6ZU9ic2VydmVyKG8pIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVtYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgeC5hY2NlcHQodGhpcy5fbyk7IH07XG4gICAgRGVtYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcbiAgICBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXG4gICAgcmV0dXJuIERlbWF0ZXJpYWxpemVPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICAqIERlbWF0ZXJpYWxpemVzIHRoZSBleHBsaWNpdCBub3RpZmljYXRpb24gdmFsdWVzIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgaW1wbGljaXQgbm90aWZpY2F0aW9ucy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgZXhoaWJpdGluZyB0aGUgYmVoYXZpb3IgY29ycmVzcG9uZGluZyB0byB0aGUgc291cmNlIHNlcXVlbmNlJ3Mgbm90aWZpY2F0aW9uIHZhbHVlcy5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5kZW1hdGVyaWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUodGhpcyk7XG4gIH07XG5cbiAgdmFyIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlKHNvdXJjZSwga2V5Rm4sIGNvbXBhcmVyKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMua2V5Rm4gPSBrZXlGbjtcbiAgICAgIHRoaXMuY29tcGFyZXIgPSBjb21wYXJlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyKG8sIHRoaXMua2V5Rm4sIHRoaXMuY29tcGFyZXIpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlcihvLCBrZXlGbiwgY29tcGFyZXIpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmtleUZuID0ga2V5Rm47XG4gICAgICB0aGlzLmNvbXBhcmVyID0gY29tcGFyZXI7XG4gICAgICB0aGlzLmhhc0N1cnJlbnRLZXkgPSBmYWxzZTtcbiAgICAgIHRoaXMuY3VycmVudEtleSA9IG51bGw7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHZhciBrZXkgPSB4LCBjb21wYXJlckVxdWFscztcbiAgICAgIGlmIChpc0Z1bmN0aW9uKHRoaXMua2V5Rm4pKSB7XG4gICAgICAgIGtleSA9IHRyeUNhdGNoKHRoaXMua2V5Rm4pKHgpO1xuICAgICAgICBpZiAoa2V5ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3Ioa2V5LmUpOyB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5oYXNDdXJyZW50S2V5KSB7XG4gICAgICAgIGNvbXBhcmVyRXF1YWxzID0gdHJ5Q2F0Y2godGhpcy5jb21wYXJlcikodGhpcy5jdXJyZW50S2V5LCBrZXkpO1xuICAgICAgICBpZiAoY29tcGFyZXJFcXVhbHMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihjb21wYXJlckVxdWFscy5lKTsgfVxuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmhhc0N1cnJlbnRLZXkgfHwgIWNvbXBhcmVyRXF1YWxzKSB7XG4gICAgICAgIHRoaXMuaGFzQ3VycmVudEtleSA9IHRydWU7XG4gICAgICAgIHRoaXMuY3VycmVudEtleSA9IGtleTtcbiAgICAgICAgdGhpcy5vLm9uTmV4dCh4KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24oZSkge1xuICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgfTtcbiAgICBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyBvbmx5IGRpc3RpbmN0IGNvbnRpZ3VvdXMgZWxlbWVudHMgYWNjb3JkaW5nIHRvIHRoZSBrZXlGbiBhbmQgdGhlIGNvbXBhcmVyLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IFtrZXlGbl0gQSBmdW5jdGlvbiB0byBjb21wdXRlIHRoZSBjb21wYXJpc29uIGtleSBmb3IgZWFjaCBlbGVtZW50LiBJZiBub3QgcHJvdmlkZWQsIGl0IHByb2plY3RzIHRoZSB2YWx1ZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGFyZXJdIEVxdWFsaXR5IGNvbXBhcmVyIGZvciBjb21wdXRlZCBrZXkgdmFsdWVzLiBJZiBub3QgcHJvdmlkZWQsIGRlZmF1bHRzIHRvIGFuIGVxdWFsaXR5IGNvbXBhcmVyIGZ1bmN0aW9uLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9ubHkgY29udGFpbmluZyB0aGUgZGlzdGluY3QgY29udGlndW91cyBlbGVtZW50cywgYmFzZWQgb24gYSBjb21wdXRlZCBrZXkgdmFsdWUsIGZyb20gdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmRpc3RpbmN0VW50aWxDaGFuZ2VkID0gZnVuY3Rpb24gKGtleUZuLCBjb21wYXJlcikge1xuICAgIGNvbXBhcmVyIHx8IChjb21wYXJlciA9IGRlZmF1bHRDb21wYXJlcik7XG4gICAgcmV0dXJuIG5ldyBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUodGhpcywga2V5Rm4sIGNvbXBhcmVyKTtcbiAgfTtcblxuICB2YXIgVGFwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYXBPYnNlcnZhYmxlLF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGFwT2JzZXJ2YWJsZShzb3VyY2UsIG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX29OID0gb2JzZXJ2ZXJPck9uTmV4dDtcbiAgICAgIHRoaXMuX29FID0gb25FcnJvcjtcbiAgICAgIHRoaXMuX29DID0gb25Db21wbGV0ZWQ7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUYXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgcCkge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMudCA9ICFwLl9vTiB8fCBpc0Z1bmN0aW9uKHAuX29OKSA/XG4gICAgICAgIG9ic2VydmVyQ3JlYXRlKHAuX29OIHx8IG5vb3AsIHAuX29FIHx8IG5vb3AsIHAuX29DIHx8IG5vb3ApIDpcbiAgICAgICAgcC5fb047XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMudC5vbk5leHQpLmNhbGwodGhpcy50LCB4KTtcbiAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgdGhpcy5vLm9uTmV4dCh4KTtcbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24oZXJyKSB7XG4gICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy50Lm9uRXJyb3IpLmNhbGwodGhpcy50LCBlcnIpO1xuICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgdGhpcy5vLm9uRXJyb3IoZXJyKTtcbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMudC5vbkNvbXBsZXRlZCkuY2FsbCh0aGlzLnQpO1xuICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBUYXBPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICogIEludm9rZXMgYW4gYWN0aW9uIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIGludm9rZXMgYW4gYWN0aW9uIHVwb24gZ3JhY2VmdWwgb3IgZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9uIHwgT2JzZXJ2ZXJ9IG9ic2VydmVyT3JPbk5leHQgQWN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIG9yIGFuIG8uXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gW29uRXJyb3JdICBBY3Rpb24gdG8gaW52b2tlIHVwb24gZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuIFVzZWQgaWYgb25seSB0aGUgb2JzZXJ2ZXJPck9uTmV4dCBwYXJhbWV0ZXIgaXMgYWxzbyBhIGZ1bmN0aW9uLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkNvbXBsZXRlZF0gIEFjdGlvbiB0byBpbnZva2UgdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS4gVXNlZCBpZiBvbmx5IHRoZSBvYnNlcnZlck9yT25OZXh0IHBhcmFtZXRlciBpcyBhbHNvIGEgZnVuY3Rpb24uXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvWydkbyddID0gb2JzZXJ2YWJsZVByb3RvLnRhcCA9IG9ic2VydmFibGVQcm90by5kb0FjdGlvbiA9IGZ1bmN0aW9uIChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuICAgIHJldHVybiBuZXcgVGFwT2JzZXJ2YWJsZSh0aGlzLCBvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG4gIH07XG5cbiAgLyoqXG4gICogIEludm9rZXMgYW4gYWN0aW9uIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbk5leHQgQWN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5kb09uTmV4dCA9IG9ic2VydmFibGVQcm90by50YXBPbk5leHQgPSBmdW5jdGlvbiAob25OZXh0LCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIHRoaXMudGFwKHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uICh4KSB7IG9uTmV4dC5jYWxsKHRoaXNBcmcsIHgpOyB9IDogb25OZXh0KTtcbiAgfTtcblxuICAvKipcbiAgKiAgSW52b2tlcyBhbiBhY3Rpb24gdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiAgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZywgbG9nZ2luZywgZXRjLiBvZiBxdWVyeSBiZWhhdmlvciBieSBpbnRlcmNlcHRpbmcgdGhlIG1lc3NhZ2Ugc3RyZWFtIHRvIHJ1biBhcmJpdHJhcnkgYWN0aW9ucyBmb3IgbWVzc2FnZXMgb24gdGhlIHBpcGVsaW5lLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRXJyb3IgQWN0aW9uIHRvIGludm9rZSB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5kb09uRXJyb3IgPSBvYnNlcnZhYmxlUHJvdG8udGFwT25FcnJvciA9IGZ1bmN0aW9uIChvbkVycm9yLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIHRoaXMudGFwKG5vb3AsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uIChlKSB7IG9uRXJyb3IuY2FsbCh0aGlzQXJnLCBlKTsgfSA6IG9uRXJyb3IpO1xuICB9O1xuXG4gIC8qKlxuICAqICBJbnZva2VzIGFuIGFjdGlvbiB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqICBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBmb3IgZGVidWdnaW5nLCBsb2dnaW5nLCBldGMuIG9mIHF1ZXJ5IGJlaGF2aW9yIGJ5IGludGVyY2VwdGluZyB0aGUgbWVzc2FnZSBzdHJlYW0gdG8gcnVuIGFyYml0cmFyeSBhY3Rpb25zIGZvciBtZXNzYWdlcyBvbiB0aGUgcGlwZWxpbmUuXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gb25Db21wbGV0ZWQgQWN0aW9uIHRvIGludm9rZSB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5kb09uQ29tcGxldGVkID0gb2JzZXJ2YWJsZVByb3RvLnRhcE9uQ29tcGxldGVkID0gZnVuY3Rpb24gKG9uQ29tcGxldGVkLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIHRoaXMudGFwKG5vb3AsIG51bGwsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uICgpIHsgb25Db21wbGV0ZWQuY2FsbCh0aGlzQXJnKTsgfSA6IG9uQ29tcGxldGVkKTtcbiAgfTtcblxuICAvKipcbiAgICogIEludm9rZXMgYSBzcGVjaWZpZWQgYWN0aW9uIGFmdGVyIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0ZXJtaW5hdGVzIGdyYWNlZnVsbHkgb3IgZXhjZXB0aW9uYWxseS5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZmluYWxseUFjdGlvbiBBY3Rpb24gdG8gaW52b2tlIGFmdGVyIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0ZXJtaW5hdGVzLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gU291cmNlIHNlcXVlbmNlIHdpdGggdGhlIGFjdGlvbi1pbnZva2luZyB0ZXJtaW5hdGlvbiBiZWhhdmlvciBhcHBsaWVkLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvWydmaW5hbGx5J10gPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgdmFyIHNvdXJjZSA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHRyeUNhdGNoKHNvdXJjZS5zdWJzY3JpYmUpLmNhbGwoc291cmNlLCBvYnNlcnZlcik7XG4gICAgICBpZiAoc3Vic2NyaXB0aW9uID09PSBlcnJvck9iaikge1xuICAgICAgICBhY3Rpb24oKTtcbiAgICAgICAgcmV0dXJuIHRocm93ZXIoc3Vic2NyaXB0aW9uLmUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgciA9IHRyeUNhdGNoKHN1YnNjcmlwdGlvbi5kaXNwb3NlKS5jYWxsKHN1YnNjcmlwdGlvbik7XG4gICAgICAgIGFjdGlvbigpO1xuICAgICAgICByID09PSBlcnJvck9iaiAmJiB0aHJvd2VyKHIuZSk7XG4gICAgICB9KTtcbiAgICB9LCB0aGlzKTtcbiAgfTtcblxuICB2YXIgSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZShzb3VyY2UpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobykpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8pIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBub29wO1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm8ub25FcnJvcihlcnIpO1xuICAgICAgfVxuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIub25FcnJvcihlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAgKiAgSWdub3JlcyBhbGwgZWxlbWVudHMgaW4gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBsZWF2aW5nIG9ubHkgdGhlIHRlcm1pbmF0aW9uIG1lc3NhZ2VzLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gZW1wdHkgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNpZ25hbHMgdGVybWluYXRpb24sIHN1Y2Nlc3NmdWwgb3IgZXhjZXB0aW9uYWwsIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uaWdub3JlRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBJZ25vcmVFbGVtZW50c09ic2VydmFibGUodGhpcyk7XG4gIH07XG5cbiAgdmFyIE1hdGVyaWFsaXplT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTWF0ZXJpYWxpemVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE1hdGVyaWFsaXplT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE1hdGVyaWFsaXplT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNYXRlcmlhbGl6ZU9ic2VydmVyKG8pKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE1hdGVyaWFsaXplT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBNYXRlcmlhbGl6ZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhNYXRlcmlhbGl6ZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gTWF0ZXJpYWxpemVPYnNlcnZlcihvKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLl9vLm9uTmV4dChub3RpZmljYXRpb25DcmVhdGVPbk5leHQoeCkpIH07XG4gICAgTWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uTmV4dChub3RpZmljYXRpb25DcmVhdGVPbkVycm9yKGUpKTsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuICAgIE1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbk5leHQobm90aWZpY2F0aW9uQ3JlYXRlT25Db21wbGV0ZWQoKSk7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblxuICAgIHJldHVybiBNYXRlcmlhbGl6ZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIE1hdGVyaWFsaXplcyB0aGUgaW1wbGljaXQgbm90aWZpY2F0aW9ucyBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIGV4cGxpY2l0IG5vdGlmaWNhdGlvbiB2YWx1ZXMuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIG1hdGVyaWFsaXplZCBub3RpZmljYXRpb24gdmFsdWVzIGZyb20gdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5tYXRlcmlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IE1hdGVyaWFsaXplT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogIFJlcGVhdHMgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLiBJZiB0aGUgcmVwZWF0IGNvdW50IGlzIG5vdCBzcGVjaWZpZWQsIHRoZSBzZXF1ZW5jZSByZXBlYXRzIGluZGVmaW5pdGVseS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtyZXBlYXRDb3VudF0gIE51bWJlciBvZiB0aW1lcyB0byByZXBlYXQgdGhlIHNlcXVlbmNlLiBJZiBub3QgcHJvdmlkZWQsIHJlcGVhdHMgdGhlIHNlcXVlbmNlIGluZGVmaW5pdGVseS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2luZyB0aGUgZWxlbWVudHMgb2YgdGhlIGdpdmVuIHNlcXVlbmNlIHJlcGVhdGVkbHkuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucmVwZWF0ID0gZnVuY3Rpb24gKHJlcGVhdENvdW50KSB7XG4gICAgcmV0dXJuIGVudW1lcmFibGVSZXBlYXQodGhpcywgcmVwZWF0Q291bnQpLmNvbmNhdCgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiAgUmVwZWF0cyB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMgb3IgdW50aWwgaXQgc3VjY2Vzc2Z1bGx5IHRlcm1pbmF0ZXMuIElmIHRoZSByZXRyeSBjb3VudCBpcyBub3Qgc3BlY2lmaWVkLCBpdCByZXRyaWVzIGluZGVmaW5pdGVseS5cbiAgICogIE5vdGUgaWYgeW91IGVuY291bnRlciBhbiBlcnJvciBhbmQgd2FudCBpdCB0byByZXRyeSBvbmNlLCB0aGVuIHlvdSBtdXN0IHVzZSAucmV0cnkoMik7XG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICB2YXIgcmVzID0gcmV0cmllZCA9IHJldHJ5LnJlcGVhdCgpO1xuICAgKiAgdmFyIHJlcyA9IHJldHJpZWQgPSByZXRyeS5yZXBlYXQoMik7XG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbcmV0cnlDb3VudF0gIE51bWJlciBvZiB0aW1lcyB0byByZXRyeSB0aGUgc2VxdWVuY2UuIElmIG5vdCBwcm92aWRlZCwgcmV0cnkgdGhlIHNlcXVlbmNlIGluZGVmaW5pdGVseS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2VxdWVuY2UgcmVwZWF0ZWRseSB1bnRpbCBpdCB0ZXJtaW5hdGVzIHN1Y2Nlc3NmdWxseS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5yZXRyeSA9IGZ1bmN0aW9uIChyZXRyeUNvdW50KSB7XG4gICAgcmV0dXJuIGVudW1lcmFibGVSZXBlYXQodGhpcywgcmV0cnlDb3VudCkuY2F0Y2hFcnJvcigpO1xuICB9O1xuXG4gIC8qKlxuICAgKiAgUmVwZWF0cyB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdXBvbiBlcnJvciBlYWNoIHRpbWUgdGhlIG5vdGlmaWVyIGVtaXRzIG9yIHVudGlsIGl0IHN1Y2Nlc3NmdWxseSB0ZXJtaW5hdGVzLiBcbiAgICogIGlmIHRoZSBub3RpZmllciBjb21wbGV0ZXMsIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbXBsZXRlcy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogIHZhciB0aW1lciA9IE9ic2VydmFibGUudGltZXIoNTAwKTtcbiAgICogIHZhciBzb3VyY2UgPSBvYnNlcnZhYmxlLnJldHJ5V2hlbih0aW1lcik7XG4gICAqIEBwYXJhbSB7T2JzZXJ2YWJsZX0gW25vdGlmaWVyXSBBbiBvYnNlcnZhYmxlIHRoYXQgdHJpZ2dlcnMgdGhlIHJldHJpZXMgb3IgY29tcGxldGVzIHRoZSBvYnNlcnZhYmxlIHdpdGggb25OZXh0IG9yIG9uQ29tcGxldGVkIHJlc3BlY3RpdmVseS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2VxdWVuY2UgcmVwZWF0ZWRseSB1bnRpbCBpdCB0ZXJtaW5hdGVzIHN1Y2Nlc3NmdWxseS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5yZXRyeVdoZW4gPSBmdW5jdGlvbiAobm90aWZpZXIpIHtcbiAgICByZXR1cm4gZW51bWVyYWJsZVJlcGVhdCh0aGlzKS5jYXRjaEVycm9yV2hlbihub3RpZmllcik7XG4gIH07XG4gIHZhciBTY2FuT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTY2FuT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTY2FuT2JzZXJ2YWJsZShzb3VyY2UsIGFjY3VtdWxhdG9yLCBoYXNTZWVkLCBzZWVkKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSBhY2N1bXVsYXRvcjtcbiAgICAgIHRoaXMuaGFzU2VlZCA9IGhhc1NlZWQ7XG4gICAgICB0aGlzLnNlZWQgPSBzZWVkO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2Nhbk9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBTY2FuT2JzZXJ2ZXIobyx0aGlzKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBTY2FuT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBTY2FuT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNjYW5PYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTY2FuT2JzZXJ2ZXIobywgcGFyZW50KSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3AgPSBwYXJlbnQ7XG4gICAgICB0aGlzLl9mbiA9IHBhcmVudC5hY2N1bXVsYXRvcjtcbiAgICAgIHRoaXMuX2hzID0gcGFyZW50Lmhhc1NlZWQ7XG4gICAgICB0aGlzLl9zID0gcGFyZW50LnNlZWQ7XG4gICAgICB0aGlzLl9oYSA9IGZhbHNlO1xuICAgICAgdGhpcy5fYSA9IG51bGw7XG4gICAgICB0aGlzLl9odiA9IGZhbHNlO1xuICAgICAgdGhpcy5faSA9IDA7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTY2FuT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgIXRoaXMuX2h2ICYmICh0aGlzLl9odiA9IHRydWUpO1xuICAgICAgaWYgKHRoaXMuX2hhKSB7XG4gICAgICAgIHRoaXMuX2EgPSB0cnlDYXRjaCh0aGlzLl9mbikodGhpcy5fYSwgeCwgdGhpcy5faSwgdGhpcy5fcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9hID0gdGhpcy5faHMgPyB0cnlDYXRjaCh0aGlzLl9mbikodGhpcy5fcywgeCwgdGhpcy5faSwgdGhpcy5fcCkgOiB4O1xuICAgICAgICB0aGlzLl9oYSA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fYSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcih0aGlzLl9hLmUpOyB9XG4gICAgICB0aGlzLl9vLm9uTmV4dCh0aGlzLl9hKTtcbiAgICAgIHRoaXMuX2krKztcbiAgICB9O1xuXG4gICAgU2Nhbk9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIFNjYW5PYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgIXRoaXMuX2h2ICYmIHRoaXMuX2hzICYmIHRoaXMuX28ub25OZXh0KHRoaXMuX3MpO1xuICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2Nhbk9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgKiAgQXBwbGllcyBhbiBhY2N1bXVsYXRvciBmdW5jdGlvbiBvdmVyIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIHJldHVybnMgZWFjaCBpbnRlcm1lZGlhdGUgcmVzdWx0LiBUaGUgb3B0aW9uYWwgc2VlZCB2YWx1ZSBpcyB1c2VkIGFzIHRoZSBpbml0aWFsIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAqICBGb3IgYWdncmVnYXRpb24gYmVoYXZpb3Igd2l0aCBubyBpbnRlcm1lZGlhdGUgcmVzdWx0cywgc2VlIE9ic2VydmFibGUuYWdncmVnYXRlLlxuICAqIEBwYXJhbSB7TWl4ZWR9IFtzZWVkXSBUaGUgaW5pdGlhbCBhY2N1bXVsYXRvciB2YWx1ZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY2N1bXVsYXRvciBBbiBhY2N1bXVsYXRvciBmdW5jdGlvbiB0byBiZSBpbnZva2VkIG9uIGVhY2ggZWxlbWVudC5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBhY2N1bXVsYXRlZCB2YWx1ZXMuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5zY2FuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBoYXNTZWVkID0gZmFsc2UsIHNlZWQsIGFjY3VtdWxhdG9yID0gYXJndW1lbnRzWzBdO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBoYXNTZWVkID0gdHJ1ZTtcbiAgICAgIHNlZWQgPSBhcmd1bWVudHNbMV07XG4gICAgfVxuICAgIHJldHVybiBuZXcgU2Nhbk9ic2VydmFibGUodGhpcywgYWNjdW11bGF0b3IsIGhhc1NlZWQsIHNlZWQpO1xuICB9O1xuXG4gIHZhciBTa2lwTGFzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBMYXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwTGFzdE9ic2VydmFibGUoc291cmNlLCBjKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX2MgPSBjO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2tpcExhc3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFNraXBMYXN0T2JzZXJ2ZXIobywgdGhpcy5fYykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcExhc3RPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFNraXBMYXN0T2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBMYXN0T2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gU2tpcExhc3RPYnNlcnZlcihvLCBjKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX2MgPSBjO1xuICAgICAgdGhpcy5fcSA9IFtdO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2tpcExhc3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9xLnB1c2goeCk7XG4gICAgICB0aGlzLl9xLmxlbmd0aCA+IHRoaXMuX2MgJiYgdGhpcy5fby5vbk5leHQodGhpcy5fcS5zaGlmdCgpKTtcbiAgICB9O1xuXG4gICAgU2tpcExhc3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBTa2lwTGFzdE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBTa2lwTGFzdE9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIEJ5cGFzc2VzIGEgc3BlY2lmaWVkIG51bWJlciBvZiBlbGVtZW50cyBhdCB0aGUgZW5kIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiAgVGhpcyBvcGVyYXRvciBhY2N1bXVsYXRlcyBhIHF1ZXVlIHdpdGggYSBsZW5ndGggZW5vdWdoIHRvIHN0b3JlIHRoZSBmaXJzdCBgY291bnRgIGVsZW1lbnRzLiBBcyBtb3JlIGVsZW1lbnRzIGFyZVxuICAgKiAgcmVjZWl2ZWQsIGVsZW1lbnRzIGFyZSB0YWtlbiBmcm9tIHRoZSBmcm9udCBvZiB0aGUgcXVldWUgYW5kIHByb2R1Y2VkIG9uIHRoZSByZXN1bHQgc2VxdWVuY2UuIFRoaXMgY2F1c2VzIGVsZW1lbnRzIHRvIGJlIGRlbGF5ZWQuXG4gICAqIEBwYXJhbSBjb3VudCBOdW1iZXIgb2YgZWxlbWVudHMgdG8gYnlwYXNzIGF0IHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgc291cmNlIHNlcXVlbmNlIGVsZW1lbnRzIGV4Y2VwdCBmb3IgdGhlIGJ5cGFzc2VkIG9uZXMgYXQgdGhlIGVuZC5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5za2lwTGFzdCA9IGZ1bmN0aW9uIChjb3VudCkge1xuICAgIGlmIChjb3VudCA8IDApIHsgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yKCk7IH1cbiAgICByZXR1cm4gbmV3IFNraXBMYXN0T2JzZXJ2YWJsZSh0aGlzLCBjb3VudCk7XG4gIH07XG5cbiAgLyoqXG4gICAqICBQcmVwZW5kcyBhIHNlcXVlbmNlIG9mIHZhbHVlcyB0byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggYW4gb3B0aW9uYWwgc2NoZWR1bGVyIGFuZCBhbiBhcmd1bWVudCBsaXN0IG9mIHZhbHVlcyB0byBwcmVwZW5kLlxuICAgKiAgQGV4YW1wbGVcbiAgICogIHZhciByZXMgPSBzb3VyY2Uuc3RhcnRXaXRoKDEsIDIsIDMpO1xuICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5zdGFydFdpdGgoUnguU2NoZWR1bGVyLnRpbWVvdXQsIDEsIDIsIDMpO1xuICAgKiBAcGFyYW0ge0FyZ3VtZW50c30gYXJncyBUaGUgc3BlY2lmaWVkIHZhbHVlcyB0byBwcmVwZW5kIHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHByZXBlbmRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWVzLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnN0YXJ0V2l0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmFsdWVzLCBzY2hlZHVsZXIsIHN0YXJ0ID0gMDtcbiAgICBpZiAoISFhcmd1bWVudHMubGVuZ3RoICYmIGlzU2NoZWR1bGVyKGFyZ3VtZW50c1swXSkpIHtcbiAgICAgIHNjaGVkdWxlciA9IGFyZ3VtZW50c1swXTtcbiAgICAgIHN0YXJ0ID0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyO1xuICAgIH1cbiAgICBmb3IodmFyIGFyZ3MgPSBbXSwgaSA9IHN0YXJ0LCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cbiAgICByZXR1cm4gZW51bWVyYWJsZU9mKFtvYnNlcnZhYmxlRnJvbUFycmF5KGFyZ3MsIHNjaGVkdWxlciksIHRoaXNdKS5jb25jYXQoKTtcbiAgfTtcblxuICB2YXIgVGFrZUxhc3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGFrZUxhc3RPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUYWtlTGFzdE9ic2VydmVyKG8sIGMpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fYyA9IGM7XG4gICAgICB0aGlzLl9xID0gW107XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUYWtlTGFzdE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMuX3EucHVzaCh4KTtcbiAgICAgIHRoaXMuX3EubGVuZ3RoID4gdGhpcy5fYyAmJiB0aGlzLl9xLnNoaWZ0KCk7XG4gICAgfTtcblxuICAgIFRha2VMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgVGFrZUxhc3RPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgd2hpbGUgKHRoaXMuX3EubGVuZ3RoID4gMCkgeyB0aGlzLl9vLm9uTmV4dCh0aGlzLl9xLnNoaWZ0KCkpOyB9XG4gICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBUYWtlTGFzdE9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGNvbnRpZ3VvdXMgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiAgVGhpcyBvcGVyYXRvciBhY2N1bXVsYXRlcyBhIGJ1ZmZlciB3aXRoIGEgbGVuZ3RoIGVub3VnaCB0byBzdG9yZSBlbGVtZW50cyBjb3VudCBlbGVtZW50cy4gVXBvbiBjb21wbGV0aW9uIG9mXG4gICAqICB0aGUgc291cmNlIHNlcXVlbmNlLCB0aGlzIGJ1ZmZlciBpcyBkcmFpbmVkIG9uIHRoZSByZXN1bHQgc2VxdWVuY2UuIFRoaXMgY2F1c2VzIHRoZSBlbGVtZW50cyB0byBiZSBkZWxheWVkLlxuICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgTnVtYmVyIG9mIGVsZW1lbnRzIHRvIHRha2UgZnJvbSB0aGUgZW5kIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8udGFrZUxhc3QgPSBmdW5jdGlvbiAoY291bnQpIHtcbiAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG4gICAgdmFyIHNvdXJjZSA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShuZXcgVGFrZUxhc3RPYnNlcnZlcihvLCBjb3VudCkpO1xuICAgIH0sIHNvdXJjZSk7XG4gIH07XG5cbm9ic2VydmFibGVQcm90by5mbGF0TWFwQ29uY2F0ID0gb2JzZXJ2YWJsZVByb3RvLmNvbmNhdE1hcCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5tZXJnZSgxKTtcbn07XG4gIHZhciBNYXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhNYXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gTWFwT2JzZXJ2YWJsZShzb3VyY2UsIHNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuc2VsZWN0b3IgPSBiaW5kQ2FsbGJhY2soc2VsZWN0b3IsIHRoaXNBcmcsIDMpO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5uZXJNYXAoc2VsZWN0b3IsIHNlbGYpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoeCwgaSwgbykgeyByZXR1cm4gc2VsZWN0b3IuY2FsbCh0aGlzLCBzZWxmLnNlbGVjdG9yKHgsIGksIG8pLCBpLCBvKTsgfVxuICAgIH1cblxuICAgIE1hcE9ic2VydmFibGUucHJvdG90eXBlLmludGVybmFsTWFwID0gZnVuY3Rpb24gKHNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgICByZXR1cm4gbmV3IE1hcE9ic2VydmFibGUodGhpcy5zb3VyY2UsIGlubmVyTWFwKHNlbGVjdG9yLCB0aGlzKSwgdGhpc0FyZyk7XG4gICAgfTtcblxuICAgIE1hcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnNlbGVjdG9yLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgc2VsZWN0b3IsIHNvdXJjZSkge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5pID0gMDtcbiAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuc2VsZWN0b3IpKHgsIHRoaXMuaSsrLCB0aGlzLnNvdXJjZSk7XG4gICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzdWx0LmUpOyB9XG4gICAgICB0aGlzLm8ub25OZXh0KHJlc3VsdCk7XG4gICAgfTtcblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE1hcE9ic2VydmFibGU7XG5cbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqIFByb2plY3RzIGVhY2ggZWxlbWVudCBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGludG8gYSBuZXcgZm9ybSBieSBpbmNvcnBvcmF0aW5nIHRoZSBlbGVtZW50J3MgaW5kZXguXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gc2VsZWN0b3IgQSB0cmFuc2Zvcm0gZnVuY3Rpb24gdG8gYXBwbHkgdG8gZWFjaCBzb3VyY2UgZWxlbWVudDsgdGhlIHNlY29uZCBwYXJhbWV0ZXIgb2YgdGhlIGZ1bmN0aW9uIHJlcHJlc2VudHMgdGhlIGluZGV4IG9mIHRoZSBzb3VyY2UgZWxlbWVudC5cbiAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgdHJhbnNmb3JtIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCBvZiBzb3VyY2UuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5tYXAgPSBvYnNlcnZhYmxlUHJvdG8uc2VsZWN0ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgdmFyIHNlbGVjdG9yRm4gPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICdmdW5jdGlvbicgPyBzZWxlY3RvciA6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGVjdG9yOyB9O1xuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgTWFwT2JzZXJ2YWJsZSA/XG4gICAgICB0aGlzLmludGVybmFsTWFwKHNlbGVjdG9yRm4sIHRoaXNBcmcpIDpcbiAgICAgIG5ldyBNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yRm4sIHRoaXNBcmcpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsdWNrZXIoYXJncywgbGVuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIG1hcHBlcih4KSB7XG4gICAgICB2YXIgY3VycmVudFByb3AgPSB4O1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB2YXIgcCA9IGN1cnJlbnRQcm9wW2FyZ3NbaV1dO1xuICAgICAgICBpZiAodHlwZW9mIHAgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgY3VycmVudFByb3AgPSBwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBjdXJyZW50UHJvcDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIHRoZSB2YWx1ZSBvZiBhIHNwZWNpZmllZCBuZXN0ZWQgcHJvcGVydHkgZnJvbSBhbGwgZWxlbWVudHMgaW5cbiAgICogdGhlIE9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBwYXJhbSB7QXJndW1lbnRzfSBhcmd1bWVudHMgVGhlIG5lc3RlZCBwcm9wZXJ0aWVzIHRvIHBsdWNrLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gUmV0dXJucyBhIG5ldyBPYnNlcnZhYmxlIHNlcXVlbmNlIG9mIHByb3BlcnR5IHZhbHVlcy5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5wbHVjayA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGlmIChsZW4gPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdMaXN0IG9mIHByb3BlcnRpZXMgY2Fubm90IGJlIGVtcHR5LicpOyB9XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICByZXR1cm4gdGhpcy5tYXAocGx1Y2tlcihhcmdzLCBsZW4pKTtcbiAgfTtcblxub2JzZXJ2YWJsZVByb3RvLmZsYXRNYXAgPSBvYnNlcnZhYmxlUHJvdG8uc2VsZWN0TWFueSA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5tZXJnZUFsbCgpO1xufTtcblxuXG4vL1xuLy9SeC5PYnNlcnZhYmxlLnByb3RvdHlwZS5mbGF0TWFwV2l0aE1heENvbmN1cnJlbnQgPSBmdW5jdGlvbihsaW1pdCwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG4vLyAgICByZXR1cm4gbmV3IEZsYXRNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykubWVyZ2UobGltaXQpO1xuLy99O1xuLy9cblxuUnguT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcExhdGVzdCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5zd2l0Y2hMYXRlc3QoKTtcbn07XG4gIHZhciBTa2lwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTa2lwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwT2JzZXJ2YWJsZShzb3VyY2UsIGNvdW50KSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuc2tpcENvdW50ID0gY291bnQ7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgXG4gICAgU2tpcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnNraXBDb3VudCkpO1xuICAgIH07XG4gICAgXG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBjKSB7XG4gICAgICB0aGlzLmMgPSBjO1xuICAgICAgdGhpcy5yID0gYztcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuICAgICAgaWYgKHRoaXMuciA8PSAwKSB7IFxuICAgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yLS07XG4gICAgICB9XG4gICAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IHRoaXMuby5vbkVycm9yKGUpOyB9XG4gICAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IHRoaXMuby5vbkNvbXBsZXRlZCgpOyB9XG4gICAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBTa2lwT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpOyAgXG4gIFxuICAvKipcbiAgICogQnlwYXNzZXMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIHRoZW4gcmV0dXJucyB0aGUgcmVtYWluaW5nIGVsZW1lbnRzLlxuICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byBza2lwIGJlZm9yZSByZXR1cm5pbmcgdGhlIHJlbWFpbmluZyBlbGVtZW50cy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgdGhhdCBvY2N1ciBhZnRlciB0aGUgc3BlY2lmaWVkIGluZGV4IGluIHRoZSBpbnB1dCBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5za2lwID0gZnVuY3Rpb24gKGNvdW50KSB7XG4gICAgaWYgKGNvdW50IDwgMCkgeyB0aHJvdyBuZXcgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IoKTsgfVxuICAgIHJldHVybiBuZXcgU2tpcE9ic2VydmFibGUodGhpcywgY291bnQpO1xuICB9O1xuICB2YXIgU2tpcFdoaWxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2tpcFdoaWxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwV2hpbGVPYnNlcnZhYmxlKHNvdXJjZSwgZm4pIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fZm4gPSBmbjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFNraXBXaGlsZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgU2tpcFdoaWxlT2JzZXJ2ZXIobywgdGhpcykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcFdoaWxlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBTa2lwV2hpbGVPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2tpcFdoaWxlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBTa2lwV2hpbGVPYnNlcnZlcihvLCBwKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3AgPSBwO1xuICAgICAgdGhpcy5faSA9IDA7XG4gICAgICB0aGlzLl9yID0gZmFsc2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwV2hpbGVPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICBpZiAoIXRoaXMuX3IpIHtcbiAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX3AuX2ZuKSh4LCB0aGlzLl9pKyssIHRoaXMuX3ApO1xuICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgICB0aGlzLl9yID0gIXJlcztcbiAgICAgIH1cbiAgICAgIHRoaXMuX3IgJiYgdGhpcy5fby5vbk5leHQoeCk7XG4gICAgfTtcbiAgICBTa2lwV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG4gICAgU2tpcFdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXG4gICAgcmV0dXJuIFNraXBXaGlsZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIEJ5cGFzc2VzIGVsZW1lbnRzIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgbG9uZyBhcyBhIHNwZWNpZmllZCBjb25kaXRpb24gaXMgdHJ1ZSBhbmQgdGhlbiByZXR1cm5zIHRoZSByZW1haW5pbmcgZWxlbWVudHMuXG4gICAqICBUaGUgZWxlbWVudCdzIGluZGV4IGlzIHVzZWQgaW4gdGhlIGxvZ2ljIG9mIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24uXG4gICAqXG4gICAqICB2YXIgcmVzID0gc291cmNlLnNraXBXaGlsZShmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHZhbHVlIDwgMTA7IH0pO1xuICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5za2lwV2hpbGUoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgeyByZXR1cm4gdmFsdWUgPCAxMCB8fCBpbmRleCA8IDEwOyB9KTtcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIGVsZW1lbnQgZm9yIGEgY29uZGl0aW9uOyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgZnJvbSB0aGUgaW5wdXQgc2VxdWVuY2Ugc3RhcnRpbmcgYXQgdGhlIGZpcnN0IGVsZW1lbnQgaW4gdGhlIGxpbmVhciBzZXJpZXMgdGhhdCBkb2VzIG5vdCBwYXNzIHRoZSB0ZXN0IHNwZWNpZmllZCBieSBwcmVkaWNhdGUuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2tpcFdoaWxlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhpc0FyZykge1xuICAgIHZhciBmbiA9IGJpbmRDYWxsYmFjayhwcmVkaWNhdGUsIHRoaXNBcmcsIDMpO1xuICAgIHJldHVybiBuZXcgU2tpcFdoaWxlT2JzZXJ2YWJsZSh0aGlzLCBmbik7XG4gIH07XG5cbiAgdmFyIFRha2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRha2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIFxuICAgIGZ1bmN0aW9uIFRha2VPYnNlcnZhYmxlKHNvdXJjZSwgY291bnQpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy50YWtlQ291bnQgPSBjb3VudDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICBcbiAgICBUYWtlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMudGFrZUNvdW50KSk7XG4gICAgfTtcbiAgICBcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIGMpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmMgPSBjO1xuICAgICAgdGhpcy5yID0gYztcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlID0ge1xuICAgICAgb25OZXh0OiBmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmICh0aGlzLnItLSA+IDApIHtcbiAgICAgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuICAgICAgICAgIHRoaXMuciA8PSAwICYmIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycikge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuby5vbkVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH0sXG4gICAgICBmYWlsOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBUYWtlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpOyAgXG4gIFxuICAvKipcbiAgICogIFJldHVybnMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGNvbnRpZ3VvdXMgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgZm9yIHRoZSBlZGdlIGNhc2Ugb2YgdGFrZSgwKS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gcmV0dXJuLlxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHVzZWQgdG8gcHJvZHVjZSBhbiBPbkNvbXBsZXRlZCBtZXNzYWdlIGluIGNhc2UgPHBhcmFtcmVmIG5hbWU9XCJjb3VudCBjb3VudDwvcGFyYW1yZWY+IGlzIHNldCB0byAwLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIHRoZSBpbnB1dCBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50YWtlID0gZnVuY3Rpb24gKGNvdW50LCBzY2hlZHVsZXIpIHtcbiAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG4gICAgaWYgKGNvdW50ID09PSAwKSB7IHJldHVybiBvYnNlcnZhYmxlRW1wdHkoc2NoZWR1bGVyKTsgfVxuICAgIHJldHVybiBuZXcgVGFrZU9ic2VydmFibGUodGhpcywgY291bnQpO1xuICB9O1xuXG4gIHZhciBUYWtlV2hpbGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYWtlV2hpbGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFRha2VXaGlsZU9ic2VydmFibGUoc291cmNlLCBmbikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9mbiA9IGZuO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGFrZVdoaWxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBUYWtlV2hpbGVPYnNlcnZlcihvLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBUYWtlV2hpbGVPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFRha2VXaGlsZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYWtlV2hpbGVPYnNlcnZlciwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIFRha2VXaGlsZU9ic2VydmVyKG8sIHApIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9pID0gMDtcbiAgICAgIHRoaXMuX3IgPSB0cnVlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGFrZVdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgaWYgKHRoaXMuX3IpIHtcbiAgICAgICAgdGhpcy5fciA9IHRyeUNhdGNoKHRoaXMuX3AuX2ZuKSh4LCB0aGlzLl9pKyssIHRoaXMuX3ApO1xuICAgICAgICBpZiAodGhpcy5fciA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcih0aGlzLl9yLmUpOyB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fcikge1xuICAgICAgICB0aGlzLl9vLm9uTmV4dCh4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIFRha2VXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcbiAgICBUYWtlV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cbiAgICByZXR1cm4gVGFrZVdoaWxlT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiAgUmV0dXJucyBlbGVtZW50cyBmcm9tIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgbG9uZyBhcyBhIHNwZWNpZmllZCBjb25kaXRpb24gaXMgdHJ1ZS5cbiAgICogIFRoZSBlbGVtZW50J3MgaW5kZXggaXMgdXNlZCBpbiB0aGUgbG9naWMgb2YgdGhlIHByZWRpY2F0ZSBmdW5jdGlvbi5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIGVsZW1lbnQgZm9yIGEgY29uZGl0aW9uOyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgZnJvbSB0aGUgaW5wdXQgc2VxdWVuY2UgdGhhdCBvY2N1ciBiZWZvcmUgdGhlIGVsZW1lbnQgYXQgd2hpY2ggdGhlIHRlc3Qgbm8gbG9uZ2VyIHBhc3Nlcy5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50YWtlV2hpbGUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB0aGlzQXJnKSB7XG4gICAgdmFyIGZuID0gYmluZENhbGxiYWNrKHByZWRpY2F0ZSwgdGhpc0FyZywgMyk7XG4gICAgcmV0dXJuIG5ldyBUYWtlV2hpbGVPYnNlcnZhYmxlKHRoaXMsIGZuKTtcbiAgfTtcblxuICB2YXIgRmlsdGVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRmlsdGVyT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIEZpbHRlck9ic2VydmFibGUoc291cmNlLCBwcmVkaWNhdGUsIHRoaXNBcmcpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5wcmVkaWNhdGUgPSBiaW5kQ2FsbGJhY2socHJlZGljYXRlLCB0aGlzQXJnLCAzKTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIEZpbHRlck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnByZWRpY2F0ZSwgdGhpcykpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBpbm5lclByZWRpY2F0ZShwcmVkaWNhdGUsIHNlbGYpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbih4LCBpLCBvKSB7IHJldHVybiBzZWxmLnByZWRpY2F0ZSh4LCBpLCBvKSAmJiBwcmVkaWNhdGUuY2FsbCh0aGlzLCB4LCBpLCBvKTsgfVxuICAgIH1cblxuICAgIEZpbHRlck9ic2VydmFibGUucHJvdG90eXBlLmludGVybmFsRmlsdGVyID0gZnVuY3Rpb24ocHJlZGljYXRlLCB0aGlzQXJnKSB7XG4gICAgICByZXR1cm4gbmV3IEZpbHRlck9ic2VydmFibGUodGhpcy5zb3VyY2UsIGlubmVyUHJlZGljYXRlKHByZWRpY2F0ZSwgdGhpcyksIHRoaXNBcmcpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHByZWRpY2F0ZSwgc291cmNlKSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy5wcmVkaWNhdGUgPSBwcmVkaWNhdGU7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuaSA9IDA7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgIHZhciBzaG91bGRZaWVsZCA9IHRyeUNhdGNoKHRoaXMucHJlZGljYXRlKSh4LCB0aGlzLmkrKywgdGhpcy5zb3VyY2UpO1xuICAgICAgaWYgKHNob3VsZFlpZWxkID09PSBlcnJvck9iaikge1xuICAgICAgICByZXR1cm4gdGhpcy5vLm9uRXJyb3Ioc2hvdWxkWWllbGQuZSk7XG4gICAgICB9XG4gICAgICBzaG91bGRZaWVsZCAmJiB0aGlzLm8ub25OZXh0KHgpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLm8ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBGaWx0ZXJPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgKiAgRmlsdGVycyB0aGUgZWxlbWVudHMgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBiYXNlZCBvbiBhIHByZWRpY2F0ZSBieSBpbmNvcnBvcmF0aW5nIHRoZSBlbGVtZW50J3MgaW5kZXguXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIHNvdXJjZSBlbGVtZW50IGZvciBhIGNvbmRpdGlvbjsgdGhlIHNlY29uZCBwYXJhbWV0ZXIgb2YgdGhlIGZ1bmN0aW9uIHJlcHJlc2VudHMgdGhlIGluZGV4IG9mIHRoZSBzb3VyY2UgZWxlbWVudC5cbiAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIGVsZW1lbnRzIGZyb20gdGhlIGlucHV0IHNlcXVlbmNlIHRoYXQgc2F0aXNmeSB0aGUgY29uZGl0aW9uLlxuICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uZmlsdGVyID0gb2JzZXJ2YWJsZVByb3RvLndoZXJlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhpc0FyZykge1xuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgRmlsdGVyT2JzZXJ2YWJsZSA/IHRoaXMuaW50ZXJuYWxGaWx0ZXIocHJlZGljYXRlLCB0aGlzQXJnKSA6XG4gICAgICBuZXcgRmlsdGVyT2JzZXJ2YWJsZSh0aGlzLCBwcmVkaWNhdGUsIHRoaXNBcmcpO1xuICB9O1xuXG5mdW5jdGlvbiBjcmVhdGVDYk9ic2VydmFibGUoZm4sIGN0eCwgc2VsZWN0b3IsIGFyZ3MpIHtcbiAgdmFyIG8gPSBuZXcgQXN5bmNTdWJqZWN0KCk7XG5cbiAgYXJncy5wdXNoKGNyZWF0ZUNiSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSk7XG4gIGZuLmFwcGx5KGN0eCwgYXJncyk7XG5cbiAgcmV0dXJuIG8uYXNPYnNlcnZhYmxlKCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNiSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgcmVzdWx0cyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyByZXN1bHRzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cbiAgICBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHtcbiAgICAgIHJlc3VsdHMgPSB0cnlDYXRjaChzZWxlY3RvcikuYXBwbHkoY3R4LCByZXN1bHRzKTtcbiAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cbiAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocmVzdWx0cy5sZW5ndGggPD0gMSkge1xuICAgICAgICBvLm9uTmV4dChyZXN1bHRzWzBdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgfTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gRnVuY3Rpb24gd2l0aCBhIGNhbGxiYWNrIGFzIHRoZSBsYXN0IHBhcmFtZXRlciB0byBjb252ZXJ0IHRvIGFuIE9ic2VydmFibGUgc2VxdWVuY2UuXG4gKiBAcGFyYW0ge01peGVkfSBbY3R4XSBUaGUgY29udGV4dCBmb3IgdGhlIGZ1bmMgcGFyYW1ldGVyIHRvIGJlIGV4ZWN1dGVkLiAgSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gdW5kZWZpbmVkLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBBIHNlbGVjdG9yIHdoaWNoIHRha2VzIHRoZSBhcmd1bWVudHMgZnJvbSB0aGUgY2FsbGJhY2sgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEEgZnVuY3Rpb24sIHdoZW4gZXhlY3V0ZWQgd2l0aCB0aGUgcmVxdWlyZWQgcGFyYW1ldGVycyBtaW51cyB0aGUgY2FsbGJhY2ssIHByb2R1Y2VzIGFuIE9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCBhIHNpbmdsZSB2YWx1ZSBvZiB0aGUgYXJndW1lbnRzIHRvIHRoZSBjYWxsYmFjayBhcyBhbiBhcnJheS5cbiAqL1xuT2JzZXJ2YWJsZS5mcm9tQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZm4sIGN0eCwgc2VsZWN0b3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB0eXBlb2YgY3R4ID09PSAndW5kZWZpbmVkJyAmJiAoY3R4ID0gdGhpcyk7IFxuXG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKVxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIGNyZWF0ZUNiT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncyk7XG4gIH07XG59O1xuXG5mdW5jdGlvbiBjcmVhdGVOb2RlT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncykge1xuICB2YXIgbyA9IG5ldyBBc3luY1N1YmplY3QoKTtcblxuICBhcmdzLnB1c2goY3JlYXRlTm9kZUhhbmRsZXIobywgY3R4LCBzZWxlY3RvcikpO1xuICBmbi5hcHBseShjdHgsIGFyZ3MpO1xuXG4gIHJldHVybiBvLmFzT2JzZXJ2YWJsZSgpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVOb2RlSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyICgpIHtcbiAgICB2YXIgZXJyID0gYXJndW1lbnRzWzBdO1xuICAgIGlmIChlcnIpIHsgcmV0dXJuIG8ub25FcnJvcihlcnIpOyB9XG5cbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgcmVzdWx0cyA9IFtdO1xuICAgIGZvcih2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykgeyByZXN1bHRzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTsgfVxuXG4gICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpKSB7XG4gICAgICB2YXIgcmVzdWx0cyA9IHRyeUNhdGNoKHNlbGVjdG9yKS5hcHBseShjdHgsIHJlc3VsdHMpO1xuICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuICAgICAgby5vbk5leHQocmVzdWx0cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgIG8ub25OZXh0KHJlc3VsdHNbMF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgby5vbk5leHQocmVzdWx0cyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgby5vbkNvbXBsZXRlZCgpO1xuICB9O1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgTm9kZS5qcyBjYWxsYmFjayBzdHlsZSBmdW5jdGlvbiB0byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLiAgVGhpcyBtdXN0IGJlIGluIGZ1bmN0aW9uIChlcnIsIC4uLikgZm9ybWF0LlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGNhbGxcbiAqIEBwYXJhbSB7TWl4ZWR9IFtjdHhdIFRoZSBjb250ZXh0IGZvciB0aGUgZnVuYyBwYXJhbWV0ZXIgdG8gYmUgZXhlY3V0ZWQuICBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byB1bmRlZmluZWQuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBjYWxsYmFjayBtaW51cyB0aGUgZXJyb3IgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEFuIGFzeW5jIGZ1bmN0aW9uIHdoaWNoIHdoZW4gYXBwbGllZCwgcmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGhlIGNhbGxiYWNrIGFyZ3VtZW50cyBhcyBhbiBhcnJheS5cbiAqL1xuT2JzZXJ2YWJsZS5mcm9tTm9kZUNhbGxiYWNrID0gZnVuY3Rpb24gKGZuLCBjdHgsIHNlbGVjdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdHlwZW9mIGN0eCA9PT0gJ3VuZGVmaW5lZCcgJiYgKGN0eCA9IHRoaXMpOyBcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIGNyZWF0ZU5vZGVPYnNlcnZhYmxlKGZuLCBjdHgsIHNlbGVjdG9yLCBhcmdzKTtcbiAgfTtcbn07XG5cbiAgZnVuY3Rpb24gaXNOb2RlTGlzdChlbCkge1xuICAgIGlmIChyb290LlN0YXRpY05vZGVMaXN0KSB7XG4gICAgICAvLyBJRTggU3BlY2lmaWNcbiAgICAgIC8vIGluc3RhbmNlb2YgaXMgc2xvd2VyIHRoYW4gT2JqZWN0I3RvU3RyaW5nLCBidXQgT2JqZWN0I3RvU3RyaW5nIHdpbGwgbm90IHdvcmsgYXMgaW50ZW5kZWQgaW4gSUU4XG4gICAgICByZXR1cm4gZWwgaW5zdGFuY2VvZiByb290LlN0YXRpY05vZGVMaXN0IHx8IGVsIGluc3RhbmNlb2Ygcm9vdC5Ob2RlTGlzdDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlbCkgPT09ICdbb2JqZWN0IE5vZGVMaXN0XSc7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gTGlzdGVuRGlzcG9zYWJsZShlLCBuLCBmbikge1xuICAgIHRoaXMuX2UgPSBlO1xuICAgIHRoaXMuX24gPSBuO1xuICAgIHRoaXMuX2ZuID0gZm47XG4gICAgdGhpcy5fZS5hZGRFdmVudExpc3RlbmVyKHRoaXMuX24sIHRoaXMuX2ZuLCBmYWxzZSk7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gIH1cbiAgTGlzdGVuRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5fZS5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX24sIHRoaXMuX2ZuLCBmYWxzZSk7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBjcmVhdGVFdmVudExpc3RlbmVyIChlbCwgZXZlbnROYW1lLCBoYW5kbGVyKSB7XG4gICAgdmFyIGRpc3Bvc2FibGVzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcblxuICAgIC8vIEFzdW1lIE5vZGVMaXN0IG9yIEhUTUxDb2xsZWN0aW9uXG4gICAgdmFyIGVsZW1Ub1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlbCk7XG4gICAgaWYgKGlzTm9kZUxpc3QoZWwpIHx8IGVsZW1Ub1N0cmluZyA9PT0gJ1tvYmplY3QgSFRNTENvbGxlY3Rpb25dJykge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGVsLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGRpc3Bvc2FibGVzLmFkZChjcmVhdGVFdmVudExpc3RlbmVyKGVsLml0ZW0oaSksIGV2ZW50TmFtZSwgaGFuZGxlcikpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZWwpIHtcbiAgICAgIGRpc3Bvc2FibGVzLmFkZChuZXcgTGlzdGVuRGlzcG9zYWJsZShlbCwgZXZlbnROYW1lLCBoYW5kbGVyKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRpc3Bvc2FibGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRldGVybWluZSB3aGV0aGVyIHRvIHVzZSBuYXRpdmUgZXZlbnRzIG9ubHlcbiAgICovXG4gIFJ4LmNvbmZpZy51c2VOYXRpdmVFdmVudHMgPSBmYWxzZTtcblxuICB2YXIgRXZlbnRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEV2ZW50T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBFdmVudE9ic2VydmFibGUoZWwsIG5hbWUsIGZuKSB7XG4gICAgICB0aGlzLl9lbCA9IGVsO1xuICAgICAgdGhpcy5fbiA9IG5hbWU7XG4gICAgICB0aGlzLl9mbiA9IGZuO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlSGFuZGxlcihvLCBmbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuICAgICAgICB2YXIgcmVzdWx0cyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oZm4pKSB7XG4gICAgICAgICAgcmVzdWx0cyA9IHRyeUNhdGNoKGZuKS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgICAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cbiAgICAgICAgfVxuICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgRXZlbnRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiBjcmVhdGVFdmVudExpc3RlbmVyKFxuICAgICAgICB0aGlzLl9lbCxcbiAgICAgICAgdGhpcy5fbixcbiAgICAgICAgY3JlYXRlSGFuZGxlcihvLCB0aGlzLl9mbikpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRXZlbnRPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSBhZGRpbmcgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIG1hdGNoaW5nIERPTUVsZW1lbnQgb3IgZWFjaCBpdGVtIGluIHRoZSBOb2RlTGlzdC5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQgVGhlIERPTUVsZW1lbnQgb3IgTm9kZUxpc3QgdG8gYXR0YWNoIGEgbGlzdGVuZXIuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgVGhlIGV2ZW50IG5hbWUgdG8gYXR0YWNoIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBldmVudCBoYW5kbGVyIHRvIHByb2R1Y2UgYSBzaW5nbGUgaXRlbSB0byB5aWVsZCBvbiBuZXh0LlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBldmVudHMgZnJvbSB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgYW5kIHRoZSBzcGVjaWZpZWQgZXZlbnQuXG4gICAqL1xuICBPYnNlcnZhYmxlLmZyb21FdmVudCA9IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudE5hbWUsIHNlbGVjdG9yKSB7XG4gICAgLy8gTm9kZS5qcyBzcGVjaWZpY1xuICAgIGlmIChlbGVtZW50LmFkZExpc3RlbmVyKSB7XG4gICAgICByZXR1cm4gZnJvbUV2ZW50UGF0dGVybihcbiAgICAgICAgZnVuY3Rpb24gKGgpIHsgZWxlbWVudC5hZGRMaXN0ZW5lcihldmVudE5hbWUsIGgpOyB9LFxuICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50LnJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgaCk7IH0sXG4gICAgICAgIHNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICAvLyBVc2Ugb25seSBpZiBub24tbmF0aXZlIGV2ZW50cyBhcmUgYWxsb3dlZFxuICAgIGlmICghUnguY29uZmlnLnVzZU5hdGl2ZUV2ZW50cykge1xuICAgICAgLy8gSGFuZGxlcyBqcSwgQW5ndWxhci5qcywgWmVwdG8sIE1hcmlvbmV0dGUsIEVtYmVyLmpzXG4gICAgICBpZiAodHlwZW9mIGVsZW1lbnQub24gPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGVsZW1lbnQub2ZmID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBmcm9tRXZlbnRQYXR0ZXJuKFxuICAgICAgICAgIGZ1bmN0aW9uIChoKSB7IGVsZW1lbnQub24oZXZlbnROYW1lLCBoKTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50Lm9mZihldmVudE5hbWUsIGgpOyB9LFxuICAgICAgICAgIHNlbGVjdG9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEV2ZW50T2JzZXJ2YWJsZShlbGVtZW50LCBldmVudE5hbWUsIHNlbGVjdG9yKS5wdWJsaXNoKCkucmVmQ291bnQoKTtcbiAgfTtcblxuICB2YXIgRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhFdmVudFBhdHRlcm5PYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEV2ZW50UGF0dGVybk9ic2VydmFibGUoYWRkLCBkZWwsIGZuKSB7XG4gICAgICB0aGlzLl9hZGQgPSBhZGQ7XG4gICAgICB0aGlzLl9kZWwgPSBkZWw7XG4gICAgICB0aGlzLl9mbiA9IGZuO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlSGFuZGxlcihvLCBmbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuICAgICAgICB2YXIgcmVzdWx0cyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oZm4pKSB7XG4gICAgICAgICAgcmVzdWx0cyA9IHRyeUNhdGNoKGZuKS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgICAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cbiAgICAgICAgfVxuICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgZm4gPSBjcmVhdGVIYW5kbGVyKG8sIHRoaXMuX2ZuKTtcbiAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHRoaXMuX2FkZChmbik7XG4gICAgICByZXR1cm4gbmV3IEV2ZW50UGF0dGVybkRpc3Bvc2FibGUodGhpcy5fZGVsLCBmbiwgcmV0dXJuVmFsdWUpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBFdmVudFBhdHRlcm5EaXNwb3NhYmxlKGRlbCwgZm4sIHJldCkge1xuICAgICAgdGhpcy5fZGVsID0gZGVsO1xuICAgICAgdGhpcy5fZm4gPSBmbjtcbiAgICAgIHRoaXMuX3JldCA9IHJldDtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIEV2ZW50UGF0dGVybkRpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZighdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICAgIGlzRnVuY3Rpb24odGhpcy5fZGVsKSAmJiB0aGlzLl9kZWwodGhpcy5fZm4sIHRoaXMuX3JldCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiBFdmVudFBhdHRlcm5PYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBmcm9tIGFuIGV2ZW50IGVtaXR0ZXIgdmlhIGFuIGFkZEhhbmRsZXIvcmVtb3ZlSGFuZGxlciBwYWlyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhZGRIYW5kbGVyIFRoZSBmdW5jdGlvbiB0byBhZGQgYSBoYW5kbGVyIHRvIHRoZSBlbWl0dGVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVtb3ZlSGFuZGxlcl0gVGhlIG9wdGlvbmFsIGZ1bmN0aW9uIHRvIHJlbW92ZSBhIGhhbmRsZXIgZnJvbSBhbiBlbWl0dGVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBldmVudCBoYW5kbGVyIHRvIHByb2R1Y2UgYSBzaW5nbGUgaXRlbSB0byB5aWVsZCBvbiBuZXh0LlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB3cmFwcyBhbiBldmVudCBmcm9tIGFuIGV2ZW50IGVtaXR0ZXJcbiAgICovXG4gIHZhciBmcm9tRXZlbnRQYXR0ZXJuID0gT2JzZXJ2YWJsZS5mcm9tRXZlbnRQYXR0ZXJuID0gZnVuY3Rpb24gKGFkZEhhbmRsZXIsIHJlbW92ZUhhbmRsZXIsIHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIG5ldyBFdmVudFBhdHRlcm5PYnNlcnZhYmxlKGFkZEhhbmRsZXIsIHJlbW92ZUhhbmRsZXIsIHNlbGVjdG9yKS5wdWJsaXNoKCkucmVmQ291bnQoKTtcbiAgfTtcblxuICB2YXIgRnJvbVByb21pc2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEZyb21Qcm9taXNlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBGcm9tUHJvbWlzZU9ic2VydmFibGUocCwgcykge1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjaGVkdWxlTmV4dChzLCBzdGF0ZSkge1xuICAgICAgdmFyIG8gPSBzdGF0ZVswXSwgZGF0YSA9IHN0YXRlWzFdO1xuICAgICAgby5vbk5leHQoZGF0YSk7XG4gICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVFcnJvcihzLCBzdGF0ZSkge1xuICAgICAgdmFyIG8gPSBzdGF0ZVswXSwgZXJyID0gc3RhdGVbMV07XG4gICAgICBvLm9uRXJyb3IoZXJyKTtcbiAgICB9XG5cbiAgICBGcm9tUHJvbWlzZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICB2YXIgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIHNlbGYgPSB0aGlzO1xuXG4gICAgICB0aGlzLl9wXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc2VsZi5fcy5zY2hlZHVsZShbbywgZGF0YV0sIHNjaGVkdWxlTmV4dCkpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc2VsZi5fcy5zY2hlZHVsZShbbywgZXJyXSwgc2NoZWR1bGVFcnJvcikpO1xuICAgICAgICB9KTtcblxuICAgICAgcmV0dXJuIHNhZDtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEZyb21Qcm9taXNlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqIENvbnZlcnRzIGEgUHJvbWlzZSB0byBhbiBPYnNlcnZhYmxlIHNlcXVlbmNlXG4gICogQHBhcmFtIHtQcm9taXNlfSBBbiBFUzYgQ29tcGxpYW50IHByb21pc2UuXG4gICogQHJldHVybnMge09ic2VydmFibGV9IEFuIE9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggd3JhcHMgdGhlIGV4aXN0aW5nIHByb21pc2Ugc3VjY2VzcyBhbmQgZmFpbHVyZS5cbiAgKi9cbiAgdmFyIG9ic2VydmFibGVGcm9tUHJvbWlzZSA9IE9ic2VydmFibGUuZnJvbVByb21pc2UgPSBmdW5jdGlvbiAocHJvbWlzZSwgc2NoZWR1bGVyKSB7XG4gICAgc2NoZWR1bGVyIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IEZyb21Qcm9taXNlT2JzZXJ2YWJsZShwcm9taXNlLCBzY2hlZHVsZXIpO1xuICB9O1xuXG4gIC8qXG4gICAqIENvbnZlcnRzIGFuIGV4aXN0aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgdG8gYW4gRVM2IENvbXBhdGlibGUgUHJvbWlzZVxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcHJvbWlzZSA9IFJ4Lk9ic2VydmFibGUucmV0dXJuKDQyKS50b1Byb21pc2UoUlNWUC5Qcm9taXNlKTtcbiAgICpcbiAgICogLy8gV2l0aCBjb25maWdcbiAgICogUnguY29uZmlnLlByb21pc2UgPSBSU1ZQLlByb21pc2U7XG4gICAqIHZhciBwcm9taXNlID0gUnguT2JzZXJ2YWJsZS5yZXR1cm4oNDIpLnRvUHJvbWlzZSgpO1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJvbWlzZUN0b3JdIFRoZSBjb25zdHJ1Y3RvciBvZiB0aGUgcHJvbWlzZS4gSWYgbm90IHByb3ZpZGVkLCBpdCBsb29rcyBmb3IgaXQgaW4gUnguY29uZmlnLlByb21pc2UuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBbiBFUzYgY29tcGF0aWJsZSBwcm9taXNlIHdpdGggdGhlIGxhc3QgdmFsdWUgZnJvbSB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50b1Byb21pc2UgPSBmdW5jdGlvbiAocHJvbWlzZUN0b3IpIHtcbiAgICBwcm9taXNlQ3RvciB8fCAocHJvbWlzZUN0b3IgPSBSeC5jb25maWcuUHJvbWlzZSk7XG4gICAgaWYgKCFwcm9taXNlQ3RvcikgeyB0aHJvdyBuZXcgTm90U3VwcG9ydGVkRXJyb3IoJ1Byb21pc2UgdHlwZSBub3QgcHJvdmlkZWQgbm9yIGluIFJ4LmNvbmZpZy5Qcm9taXNlJyk7IH1cbiAgICB2YXIgc291cmNlID0gdGhpcztcbiAgICByZXR1cm4gbmV3IHByb21pc2VDdG9yKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIC8vIE5vIGNhbmNlbGxhdGlvbiBjYW4gYmUgZG9uZVxuICAgICAgdmFyIHZhbHVlO1xuICAgICAgc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAodikge1xuICAgICAgICB2YWx1ZSA9IHY7XG4gICAgICB9LCByZWplY3QsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogSW52b2tlcyB0aGUgYXN5bmNocm9ub3VzIGZ1bmN0aW9uLCBzdXJmYWNpbmcgdGhlIHJlc3VsdCB0aHJvdWdoIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmN0aW9uQXN5bmMgQXN5bmNocm9ub3VzIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYSBQcm9taXNlIHRvIHJ1bi5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgZXhwb3NpbmcgdGhlIGZ1bmN0aW9uJ3MgcmVzdWx0IHZhbHVlLCBvciBhbiBleGNlcHRpb24uXG4gICAqL1xuICBPYnNlcnZhYmxlLnN0YXJ0QXN5bmMgPSBmdW5jdGlvbiAoZnVuY3Rpb25Bc3luYykge1xuICAgIHZhciBwcm9taXNlID0gdHJ5Q2F0Y2goZnVuY3Rpb25Bc3luYykoKTtcbiAgICBpZiAocHJvbWlzZSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG9ic2VydmFibGVUaHJvdyhwcm9taXNlLmUpOyB9XG4gICAgcmV0dXJuIG9ic2VydmFibGVGcm9tUHJvbWlzZShwcm9taXNlKTtcbiAgfTtcblxuICB2YXIgTXVsdGljYXN0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTXVsdGljYXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBNdWx0aWNhc3RPYnNlcnZhYmxlKHNvdXJjZSwgZm4xLCBmbjIpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fZm4xID0gZm4xO1xuICAgICAgdGhpcy5fZm4yID0gZm4yO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgTXVsdGljYXN0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgY29ubmVjdGFibGUgPSB0aGlzLnNvdXJjZS5tdWx0aWNhc3QodGhpcy5fZm4xKCkpO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHRoaXMuX2ZuMihjb25uZWN0YWJsZSkuc3Vic2NyaWJlKG8pLCBjb25uZWN0YWJsZS5jb25uZWN0KCkpO1xuICAgIH07XG5cbiAgICByZXR1cm4gTXVsdGljYXN0T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAgKiBNdWx0aWNhc3RzIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugbm90aWZpY2F0aW9ucyB0aHJvdWdoIGFuIGluc3RhbnRpYXRlZCBzdWJqZWN0IGludG8gYWxsIHVzZXMgb2YgdGhlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLiBFYWNoXG4gICAqIHN1YnNjcmlwdGlvbiB0byB0aGUgcmVzdWx0aW5nIHNlcXVlbmNlIGNhdXNlcyBhIHNlcGFyYXRlIG11bHRpY2FzdCBpbnZvY2F0aW9uLCBleHBvc2luZyB0aGUgc2VxdWVuY2UgcmVzdWx0aW5nIGZyb20gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uJ3NcbiAgICogaW52b2NhdGlvbi4gRm9yIHNwZWNpYWxpemF0aW9ucyB3aXRoIGZpeGVkIHN1YmplY3QgdHlwZXMsIHNlZSBQdWJsaXNoLCBQdWJsaXNoTGFzdCwgYW5kIFJlcGxheS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogMSAtIHJlcyA9IHNvdXJjZS5tdWx0aWNhc3Qob2JzZXJ2YWJsZSk7XG4gICAqIDIgLSByZXMgPSBzb3VyY2UubXVsdGljYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBTdWJqZWN0KCk7IH0sIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbnxTdWJqZWN0fSBzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3JcbiAgICogRmFjdG9yeSBmdW5jdGlvbiB0byBjcmVhdGUgYW4gaW50ZXJtZWRpYXRlIHN1YmplY3QgdGhyb3VnaCB3aGljaCB0aGUgc291cmNlIHNlcXVlbmNlJ3MgZWxlbWVudHMgd2lsbCBiZSBtdWx0aWNhc3QgdG8gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKiBPcjpcbiAgICogU3ViamVjdCB0byBwdXNoIHNvdXJjZSBlbGVtZW50cyBpbnRvLlxuICAgKlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIE9wdGlvbmFsIHNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBzdWJqZWN0IHRvIHRoZSBwb2xpY2llcyBlbmZvcmNlZCBieSB0aGUgY3JlYXRlZCBzdWJqZWN0LiBTcGVjaWZpZWQgb25seSBpZiA8cGFyYW1yZWYgbmFtZT1cInN1YmplY3RPclN1YmplY3RTZWxlY3RvclwiIGlzIGEgZmFjdG9yeSBmdW5jdGlvbi5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5tdWx0aWNhc3QgPSBmdW5jdGlvbiAoc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yLCBzZWxlY3Rvcikge1xuICAgIHJldHVybiBpc0Z1bmN0aW9uKHN1YmplY3RPclN1YmplY3RTZWxlY3RvcikgP1xuICAgICAgbmV3IE11bHRpY2FzdE9ic2VydmFibGUodGhpcywgc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yLCBzZWxlY3RvcikgOlxuICAgICAgbmV3IENvbm5lY3RhYmxlT2JzZXJ2YWJsZSh0aGlzLCBzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSBzZWxlY3RvciBvbiBhIGNvbm5lY3RhYmxlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgTXVsdGljYXN0IHVzaW5nIGEgcmVndWxhciBTdWJqZWN0LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcmVzcmVzID0gc291cmNlLnB1Ymxpc2goKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBTZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2UgYXMgbWFueSB0aW1lcyBhcyBuZWVkZWQsIHdpdGhvdXQgY2F1c2luZyBtdWx0aXBsZSBzdWJzY3JpcHRpb25zIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UuIFN1YnNjcmliZXJzIHRvIHRoZSBnaXZlbiBzb3VyY2Ugd2lsbCByZWNlaXZlIGFsbCBub3RpZmljYXRpb25zIG9mIHRoZSBzb3VyY2UgZnJvbSB0aGUgdGltZSBvZiB0aGUgc3Vic2NyaXB0aW9uIG9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2ggPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gc2VsZWN0b3IgJiYgaXNGdW5jdGlvbihzZWxlY3RvcikgP1xuICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFN1YmplY3QoKTsgfSwgc2VsZWN0b3IpIDpcbiAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBTdWJqZWN0KCkpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgcHVibGlzaCB3aGljaCBjcmVhdGVzIGEgc3Vic2NyaXB0aW9uIHdoZW4gdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgZ29lcyBmcm9tIHplcm8gdG8gb25lLCB0aGVuIHNoYXJlcyB0aGF0IHN1YnNjcmlwdGlvbiB3aXRoIGFsbCBzdWJzZXF1ZW50IG9ic2VydmVycyB1bnRpbCB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyByZXR1cm5zIHRvIHplcm8sIGF0IHdoaWNoIHBvaW50IHRoZSBzdWJzY3JpcHRpb24gaXMgZGlzcG9zZWQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2hhcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMucHVibGlzaCgpLnJlZkNvdW50KCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgY29udGFpbmluZyBvbmx5IHRoZSBsYXN0IG5vdGlmaWNhdGlvbi5cbiAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIEFzeW5jU3ViamVjdC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoTGFzdCgpO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hMYXN0KGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICpcbiAgICogQHBhcmFtIHNlbGVjdG9yIFtPcHRpb25hbF0gU2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgb25seSByZWNlaXZlIHRoZSBsYXN0IG5vdGlmaWNhdGlvbiBvZiB0aGUgc291cmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2hMYXN0ID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIHNlbGVjdG9yICYmIGlzRnVuY3Rpb24oc2VsZWN0b3IpID9cbiAgICAgIHRoaXMubXVsdGljYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBBc3luY1N1YmplY3QoKTsgfSwgc2VsZWN0b3IpIDpcbiAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBBc3luY1N1YmplY3QoKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgYW5kIHN0YXJ0cyB3aXRoIGluaXRpYWxWYWx1ZS5cbiAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIEJlaGF2aW9yU3ViamVjdC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoVmFsdWUoNDIpO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hWYWx1ZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5zZWxlY3QoZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkgKiB5OyB9KSB9LCA0Mik7XG4gICAqXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gT3B0aW9uYWwgc2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgcmVjZWl2ZSBpbW1lZGlhdGVseSByZWNlaXZlIHRoZSBpbml0aWFsIHZhbHVlLCBmb2xsb3dlZCBieSBhbGwgbm90aWZpY2F0aW9ucyBvZiB0aGUgc291cmNlIGZyb20gdGhlIHRpbWUgb2YgdGhlIHN1YnNjcmlwdGlvbiBvbi5cbiAgICogQHBhcmFtIHtNaXhlZH0gaW5pdGlhbFZhbHVlIEluaXRpYWwgdmFsdWUgcmVjZWl2ZWQgYnkgb2JzZXJ2ZXJzIHVwb24gc3Vic2NyaXB0aW9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2hWYWx1ZSA9IGZ1bmN0aW9uIChpbml0aWFsVmFsdWVPclNlbGVjdG9yLCBpbml0aWFsVmFsdWUpIHtcbiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMiA/XG4gICAgICB0aGlzLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQmVoYXZpb3JTdWJqZWN0KGluaXRpYWxWYWx1ZSk7XG4gICAgICB9LCBpbml0aWFsVmFsdWVPclNlbGVjdG9yKSA6XG4gICAgICB0aGlzLm11bHRpY2FzdChuZXcgQmVoYXZpb3JTdWJqZWN0KGluaXRpYWxWYWx1ZU9yU2VsZWN0b3IpKTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSBhbmQgc3RhcnRzIHdpdGggYW4gaW5pdGlhbFZhbHVlLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgcHVibGlzaFZhbHVlIHdoaWNoIGNyZWF0ZXMgYSBzdWJzY3JpcHRpb24gd2hlbiB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyBnb2VzIGZyb20gemVybyB0byBvbmUsIHRoZW4gc2hhcmVzIHRoYXQgc3Vic2NyaXB0aW9uIHdpdGggYWxsIHN1YnNlcXVlbnQgb2JzZXJ2ZXJzIHVudGlsIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIHJldHVybnMgdG8gemVybywgYXQgd2hpY2ggcG9pbnQgdGhlIHN1YnNjcmlwdGlvbiBpcyBkaXNwb3NlZC5cbiAgICogQHBhcmFtIHtNaXhlZH0gaW5pdGlhbFZhbHVlIEluaXRpYWwgdmFsdWUgcmVjZWl2ZWQgYnkgb2JzZXJ2ZXJzIHVwb24gc3Vic2NyaXB0aW9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNoYXJlVmFsdWUgPSBmdW5jdGlvbiAoaW5pdGlhbFZhbHVlKSB7XG4gICAgcmV0dXJuIHRoaXMucHVibGlzaFZhbHVlKGluaXRpYWxWYWx1ZSkucmVmQ291bnQoKTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgc2VsZWN0b3Igb24gYSBjb25uZWN0YWJsZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSByZXBsYXlpbmcgbm90aWZpY2F0aW9ucyBzdWJqZWN0IHRvIGEgbWF4aW11bSB0aW1lIGxlbmd0aCBmb3IgdGhlIHJlcGxheSBidWZmZXIuXG4gICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBNdWx0aWNhc3QgdXNpbmcgYSBSZXBsYXlTdWJqZWN0LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShudWxsLCAzKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5yZXBsYXkobnVsbCwgMywgNTAwKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5yZXBsYXkobnVsbCwgMywgNTAwLCBzY2hlZHVsZXIpO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC50YWtlKDYpLnJlcGVhdCgpOyB9LCAzLCA1MDAsIHNjaGVkdWxlcik7XG4gICAqXG4gICAqIEBwYXJhbSBzZWxlY3RvciBbT3B0aW9uYWxdIFNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBhcyBtYW55IHRpbWVzIGFzIG5lZWRlZCwgd2l0aG91dCBjYXVzaW5nIG11bHRpcGxlIHN1YnNjcmlwdGlvbnMgdG8gdGhlIHNvdXJjZSBzZXF1ZW5jZS4gU3Vic2NyaWJlcnMgdG8gdGhlIGdpdmVuIHNvdXJjZSB3aWxsIHJlY2VpdmUgYWxsIHRoZSBub3RpZmljYXRpb25zIG9mIHRoZSBzb3VyY2Ugc3ViamVjdCB0byB0aGUgc3BlY2lmaWVkIHJlcGxheSBidWZmZXIgdHJpbW1pbmcgcG9saWN5LlxuICAgKiBAcGFyYW0gYnVmZmVyU2l6ZSBbT3B0aW9uYWxdIE1heGltdW0gZWxlbWVudCBjb3VudCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICogQHBhcmFtIHdpbmRvd1NpemUgW09wdGlvbmFsXSBNYXhpbXVtIHRpbWUgbGVuZ3RoIG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuICAgKiBAcGFyYW0gc2NoZWR1bGVyIFtPcHRpb25hbF0gU2NoZWR1bGVyIHdoZXJlIGNvbm5lY3RlZCBvYnNlcnZlcnMgd2l0aGluIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucmVwbGF5ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gc2VsZWN0b3IgJiYgaXNGdW5jdGlvbihzZWxlY3RvcikgP1xuICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKTsgfSwgc2VsZWN0b3IpIDpcbiAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBSZXBsYXlTdWJqZWN0KGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIHJlcGxheWluZyBub3RpZmljYXRpb25zIHN1YmplY3QgdG8gYSBtYXhpbXVtIHRpbWUgbGVuZ3RoIGZvciB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIHJlcGxheSB3aGljaCBjcmVhdGVzIGEgc3Vic2NyaXB0aW9uIHdoZW4gdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgZ29lcyBmcm9tIHplcm8gdG8gb25lLCB0aGVuIHNoYXJlcyB0aGF0IHN1YnNjcmlwdGlvbiB3aXRoIGFsbCBzdWJzZXF1ZW50IG9ic2VydmVycyB1bnRpbCB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyByZXR1cm5zIHRvIHplcm8sIGF0IHdoaWNoIHBvaW50IHRoZSBzdWJzY3JpcHRpb24gaXMgZGlzcG9zZWQuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciByZXMgPSBzb3VyY2Uuc2hhcmVSZXBsYXkoMyk7XG4gICAqIHZhciByZXMgPSBzb3VyY2Uuc2hhcmVSZXBsYXkoMywgNTAwKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5zaGFyZVJlcGxheSgzLCA1MDAsIHNjaGVkdWxlcik7XG4gICAqXG5cbiAgICogQHBhcmFtIGJ1ZmZlclNpemUgW09wdGlvbmFsXSBNYXhpbXVtIGVsZW1lbnQgY291bnQgb2YgdGhlIHJlcGxheSBidWZmZXIuXG4gICAqIEBwYXJhbSB3aW5kb3cgW09wdGlvbmFsXSBNYXhpbXVtIHRpbWUgbGVuZ3RoIG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuICAgKiBAcGFyYW0gc2NoZWR1bGVyIFtPcHRpb25hbF0gU2NoZWR1bGVyIHdoZXJlIGNvbm5lY3RlZCBvYnNlcnZlcnMgd2l0aGluIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2hhcmVSZXBsYXkgPSBmdW5jdGlvbiAoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSB7XG4gICAgcmV0dXJuIHRoaXMucmVwbGF5KG51bGwsIGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikucmVmQ291bnQoKTtcbiAgfTtcblxuICB2YXIgUmVmQ291bnRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhSZWZDb3VudE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUmVmQ291bnRPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9jb3VudCA9IDA7XG4gICAgICB0aGlzLl9jb25uZWN0YWJsZVN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBSZWZDb3VudE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHNob3VsZENvbm5lY3QgPSArK3RoaXMuX2NvdW50ID09PSAxLCBzdWJzY3JpcHRpb24gPSB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobyk7XG4gICAgICBzaG91bGRDb25uZWN0ICYmICh0aGlzLl9jb25uZWN0YWJsZVN1YnNjcmlwdGlvbiA9IHRoaXMuc291cmNlLmNvbm5lY3QoKSk7XG4gICAgICByZXR1cm4gbmV3IFJlZkNvdW50RGlzcG9zYWJsZSh0aGlzLCBzdWJzY3JpcHRpb24pO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBSZWZDb3VudERpc3Bvc2FibGUocCwgcykge1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIFJlZkNvdW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX3MuZGlzcG9zZSgpO1xuICAgICAgICAtLXRoaXMuX3AuX2NvdW50ID09PSAwICYmIHRoaXMuX3AuX2Nvbm5lY3RhYmxlU3Vic2NyaXB0aW9uLmRpc3Bvc2UoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIFJlZkNvdW50T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBDb25uZWN0YWJsZU9ic2VydmFibGUgPSBSeC5Db25uZWN0YWJsZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENvbm5lY3RhYmxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDb25uZWN0YWJsZU9ic2VydmFibGUoc291cmNlLCBzdWJqZWN0KSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX2hhc1N1YnNjcmlwdGlvbiAgPSBmYWxzZTtcbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICB0aGlzLl9zb3VyY2VPYnNlcnZhYmxlID0gc291cmNlLmFzT2JzZXJ2YWJsZSgpO1xuICAgICAgdGhpcy5fc3ViamVjdCA9IHN1YmplY3Q7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBDb25uZWN0RGlzcG9zYWJsZShwYXJlbnQpIHtcbiAgICAgIHRoaXMuX3AgPSBwYXJlbnQ7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBDb25uZWN0RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX3AuX2hhc1N1YnNjcmlwdGlvbiA9IGZhbHNlO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBDb25uZWN0YWJsZU9ic2VydmFibGUucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIXRoaXMuX2hhc1N1YnNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLl9oYXNTdWJzY3JpcHRpb24gPSB0cnVlO1xuICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb24gPSBuZXcgQmluYXJ5RGlzcG9zYWJsZShcbiAgICAgICAgICB0aGlzLl9zb3VyY2VPYnNlcnZhYmxlLnN1YnNjcmliZSh0aGlzLl9zdWJqZWN0KSxcbiAgICAgICAgICBuZXcgQ29ubmVjdERpc3Bvc2FibGUodGhpcylcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb247XG4gICAgfTtcblxuICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3ViamVjdC5zdWJzY3JpYmUobyk7XG4gICAgfTtcblxuICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVmQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3IFJlZkNvdW50T2JzZXJ2YWJsZSh0aGlzKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENvbm5lY3RhYmxlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgdmFyIFRpbWVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUaW1lck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGltZXJPYnNlcnZhYmxlKGR0LCBzKSB7XG4gICAgICB0aGlzLl9kdCA9IGR0O1xuICAgICAgdGhpcy5fcyA9IHM7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUaW1lck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuX3Muc2NoZWR1bGVGdXR1cmUobywgdGhpcy5fZHQsIHNjaGVkdWxlTWV0aG9kKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVNZXRob2Qocywgbykge1xuICAgICAgby5vbk5leHQoMCk7XG4gICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFRpbWVyT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIGZ1bmN0aW9uIF9vYnNlcnZhYmxlVGltZXIoZHVlVGltZSwgc2NoZWR1bGVyKSB7XG4gICAgcmV0dXJuIG5ldyBUaW1lck9ic2VydmFibGUoZHVlVGltZSwgc2NoZWR1bGVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9ic2VydmFibGVUaW1lckRhdGVBbmRQZXJpb2QoZHVlVGltZSwgcGVyaW9kLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICB2YXIgZCA9IGR1ZVRpbWUsIHAgPSBub3JtYWxpemVUaW1lKHBlcmlvZCk7XG4gICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlKDAsIGQsIGZ1bmN0aW9uIChjb3VudCwgc2VsZikge1xuICAgICAgICBpZiAocCA+IDApIHtcbiAgICAgICAgICB2YXIgbm93ID0gc2NoZWR1bGVyLm5vdygpO1xuICAgICAgICAgIGQgPSBuZXcgRGF0ZShkLmdldFRpbWUoKSArIHApO1xuICAgICAgICAgIGQuZ2V0VGltZSgpIDw9IG5vdyAmJiAoZCA9IG5ldyBEYXRlKG5vdyArIHApKTtcbiAgICAgICAgfVxuICAgICAgICBvYnNlcnZlci5vbk5leHQoY291bnQpO1xuICAgICAgICBzZWxmKGNvdW50ICsgMSwgbmV3IERhdGUoZCkpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZChkdWVUaW1lLCBwZXJpb2QsIHNjaGVkdWxlcikge1xuICAgIHJldHVybiBkdWVUaW1lID09PSBwZXJpb2QgP1xuICAgICAgbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgIHJldHVybiBzY2hlZHVsZXIuc2NoZWR1bGVQZXJpb2RpYygwLCBwZXJpb2QsIGZ1bmN0aW9uIChjb3VudCkge1xuICAgICAgICAgIG9ic2VydmVyLm9uTmV4dChjb3VudCk7XG4gICAgICAgICAgcmV0dXJuIGNvdW50ICsgMTtcbiAgICAgICAgfSk7XG4gICAgICB9KSA6XG4gICAgICBvYnNlcnZhYmxlRGVmZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZChuZXcgRGF0ZShzY2hlZHVsZXIubm93KCkgKyBkdWVUaW1lKSwgcGVyaW9kLCBzY2hlZHVsZXIpO1xuICAgICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZWFjaCBwZXJpb2QuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICAxIC0gcmVzID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDAwKTtcbiAgICogIDIgLSByZXMgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMDAsIFJ4LlNjaGVkdWxlci50aW1lb3V0KTtcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHBlcmlvZCBQZXJpb2QgZm9yIHByb2R1Y2luZyB0aGUgdmFsdWVzIGluIHRoZSByZXN1bHRpbmcgc2VxdWVuY2UgKHNwZWNpZmllZCBhcyBhbiBpbnRlZ2VyIGRlbm90aW5nIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSB0aW1lciBvbi4gSWYgbm90IHNwZWNpZmllZCwgUnguU2NoZWR1bGVyLnRpbWVvdXQgaXMgdXNlZC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBwcm9kdWNlcyBhIHZhbHVlIGFmdGVyIGVhY2ggcGVyaW9kLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVpbnRlcnZhbCA9IE9ic2VydmFibGUuaW50ZXJ2YWwgPSBmdW5jdGlvbiAocGVyaW9kLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyVGltZVNwYW5BbmRQZXJpb2QocGVyaW9kLCBwZXJpb2QsIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgPyBzY2hlZHVsZXIgOiBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgfTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZHVlVGltZSBoYXMgZWxhcHNlZCBhbmQgdGhlbiBhZnRlciBlYWNoIHBlcmlvZC5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IGR1ZVRpbWUgQWJzb2x1dGUgKHNwZWNpZmllZCBhcyBhIERhdGUgb2JqZWN0KSBvciByZWxhdGl2ZSB0aW1lIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpIGF0IHdoaWNoIHRvIHByb2R1Y2UgdGhlIGZpcnN0IHZhbHVlLlxuICAgKiBAcGFyYW0ge01peGVkfSBbcGVyaW9kT3JTY2hlZHVsZXJdICBQZXJpb2QgdG8gcHJvZHVjZSBzdWJzZXF1ZW50IHZhbHVlcyAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSwgb3IgdGhlIHNjaGVkdWxlciB0byBydW4gdGhlIHRpbWVyIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgcmVzdWx0aW5nIHRpbWVyIGlzIG5vdCByZWN1cnJpbmcuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHRvIHJ1biB0aGUgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB0aW1lb3V0IHNjaGVkdWxlciBpcyB1c2VkLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZHVlIHRpbWUgaGFzIGVsYXBzZWQgYW5kIHRoZW4gZWFjaCBwZXJpb2QuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZVRpbWVyID0gT2JzZXJ2YWJsZS50aW1lciA9IGZ1bmN0aW9uIChkdWVUaW1lLCBwZXJpb2RPclNjaGVkdWxlciwgc2NoZWR1bGVyKSB7XG4gICAgdmFyIHBlcmlvZDtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICBpZiAocGVyaW9kT3JTY2hlZHVsZXIgIT0gbnVsbCAmJiB0eXBlb2YgcGVyaW9kT3JTY2hlZHVsZXIgPT09ICdudW1iZXInKSB7XG4gICAgICBwZXJpb2QgPSBwZXJpb2RPclNjaGVkdWxlcjtcbiAgICB9IGVsc2UgaWYgKGlzU2NoZWR1bGVyKHBlcmlvZE9yU2NoZWR1bGVyKSkge1xuICAgICAgc2NoZWR1bGVyID0gcGVyaW9kT3JTY2hlZHVsZXI7XG4gICAgfVxuICAgIGlmICgoZHVlVGltZSBpbnN0YW5jZW9mIERhdGUgfHwgdHlwZW9mIGR1ZVRpbWUgPT09ICdudW1iZXInKSAmJiBwZXJpb2QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIF9vYnNlcnZhYmxlVGltZXIoZHVlVGltZSwgc2NoZWR1bGVyKTtcbiAgICB9XG4gICAgaWYgKGR1ZVRpbWUgaW5zdGFuY2VvZiBEYXRlICYmIHBlcmlvZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZChkdWVUaW1lLmdldFRpbWUoKSwgcGVyaW9kT3JTY2hlZHVsZXIsIHNjaGVkdWxlcik7XG4gICAgfVxuICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZChkdWVUaW1lLCBwZXJpb2QsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgZnVuY3Rpb24gb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUoc291cmNlLCBkdWVUaW1lLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBhY3RpdmUgPSBmYWxzZSxcbiAgICAgICAgY2FuY2VsYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG4gICAgICAgIGV4Y2VwdGlvbiA9IG51bGwsXG4gICAgICAgIHEgPSBbXSxcbiAgICAgICAgcnVubmluZyA9IGZhbHNlLFxuICAgICAgICBzdWJzY3JpcHRpb247XG4gICAgICBzdWJzY3JpcHRpb24gPSBzb3VyY2UubWF0ZXJpYWxpemUoKS50aW1lc3RhbXAoc2NoZWR1bGVyKS5zdWJzY3JpYmUoZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICB2YXIgZCwgc2hvdWxkUnVuO1xuICAgICAgICBpZiAobm90aWZpY2F0aW9uLnZhbHVlLmtpbmQgPT09ICdFJykge1xuICAgICAgICAgIHEgPSBbXTtcbiAgICAgICAgICBxLnB1c2gobm90aWZpY2F0aW9uKTtcbiAgICAgICAgICBleGNlcHRpb24gPSBub3RpZmljYXRpb24udmFsdWUuZXJyb3I7XG4gICAgICAgICAgc2hvdWxkUnVuID0gIXJ1bm5pbmc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcS5wdXNoKHsgdmFsdWU6IG5vdGlmaWNhdGlvbi52YWx1ZSwgdGltZXN0YW1wOiBub3RpZmljYXRpb24udGltZXN0YW1wICsgZHVlVGltZSB9KTtcbiAgICAgICAgICBzaG91bGRSdW4gPSAhYWN0aXZlO1xuICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNob3VsZFJ1bikge1xuICAgICAgICAgIGlmIChleGNlcHRpb24gIT09IG51bGwpIHtcbiAgICAgICAgICAgIG8ub25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgICAgICBjYW5jZWxhYmxlLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICAgICAgICBkLnNldERpc3Bvc2FibGUoc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlKG51bGwsIGR1ZVRpbWUsIGZ1bmN0aW9uIChfLCBzZWxmKSB7XG4gICAgICAgICAgICAgIHZhciBlLCByZWN1cnNlRHVlVGltZSwgcmVzdWx0LCBzaG91bGRSZWN1cnNlO1xuICAgICAgICAgICAgICBpZiAoZXhjZXB0aW9uICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAocS5sZW5ndGggPiAwICYmIHFbMF0udGltZXN0YW1wIC0gc2NoZWR1bGVyLm5vdygpIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHEuc2hpZnQoKS52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0LmFjY2VwdChvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gd2hpbGUgKHJlc3VsdCAhPT0gbnVsbCk7XG4gICAgICAgICAgICAgIHNob3VsZFJlY3Vyc2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgcmVjdXJzZUR1ZVRpbWUgPSAwO1xuICAgICAgICAgICAgICBpZiAocS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgc2hvdWxkUmVjdXJzZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVjdXJzZUR1ZVRpbWUgPSBNYXRoLm1heCgwLCBxWzBdLnRpbWVzdGFtcCAtIHNjaGVkdWxlci5ub3coKSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZSA9IGV4Y2VwdGlvbjtcbiAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICBpZiAoZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG8ub25FcnJvcihlKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChzaG91bGRSZWN1cnNlKSB7XG4gICAgICAgICAgICAgICAgc2VsZihudWxsLCByZWN1cnNlRHVlVGltZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSk7XG4gICAgfSwgc291cmNlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9ic2VydmFibGVEZWxheUFic29sdXRlKHNvdXJjZSwgZHVlVGltZSwgc2NoZWR1bGVyKSB7XG4gICAgcmV0dXJuIG9ic2VydmFibGVEZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUoc291cmNlLCBkdWVUaW1lIC0gc2NoZWR1bGVyLm5vdygpLCBzY2hlZHVsZXIpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZGVsYXlXaXRoU2VsZWN0b3Ioc291cmNlLCBzdWJzY3JpcHRpb25EZWxheSwgZGVsYXlEdXJhdGlvblNlbGVjdG9yKSB7XG4gICAgdmFyIHN1YkRlbGF5LCBzZWxlY3RvcjtcbiAgICBpZiAoaXNGdW5jdGlvbihzdWJzY3JpcHRpb25EZWxheSkpIHtcbiAgICAgIHNlbGVjdG9yID0gc3Vic2NyaXB0aW9uRGVsYXk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1YkRlbGF5ID0gc3Vic2NyaXB0aW9uRGVsYXk7XG4gICAgICBzZWxlY3RvciA9IGRlbGF5RHVyYXRpb25TZWxlY3RvcjtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgZGVsYXlzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKSwgYXRFbmQgPSBmYWxzZSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblxuICAgICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoXG4gICAgICAgICAgZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHZhciBkZWxheSA9IHRyeUNhdGNoKHNlbGVjdG9yKSh4KTtcbiAgICAgICAgICAgIGlmIChkZWxheSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihkZWxheS5lKTsgfVxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgICAgIGRlbGF5cy5hZGQoZCk7XG4gICAgICAgICAgICBkLnNldERpc3Bvc2FibGUoZGVsYXkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgby5vbk5leHQoeCk7XG4gICAgICAgICAgICAgICAgZGVsYXlzLnJlbW92ZShkKTtcbiAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG8ub25OZXh0KHgpO1xuICAgICAgICAgICAgICAgIGRlbGF5cy5yZW1vdmUoZCk7XG4gICAgICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBhdEVuZCA9IHRydWU7XG4gICAgICAgICAgICBzdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGRvbmUgKCkge1xuICAgICAgICBhdEVuZCAmJiBkZWxheXMubGVuZ3RoID09PSAwICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFzdWJEZWxheSkge1xuICAgICAgICBzdGFydCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoc3ViRGVsYXkuc3Vic2NyaWJlKHN0YXJ0LCBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIHN0YXJ0KSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGRlbGF5cyk7XG4gICAgfSwgdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogIFRpbWUgc2hpZnRzIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IGR1ZVRpbWUuXG4gICAqICBUaGUgcmVsYXRpdmUgdGltZSBpbnRlcnZhbHMgYmV0d2VlbiB0aGUgdmFsdWVzIGFyZSBwcmVzZXJ2ZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBkdWVUaW1lIEFic29sdXRlIChzcGVjaWZpZWQgYXMgYSBEYXRlIG9iamVjdCkgb3IgcmVsYXRpdmUgdGltZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSBieSB3aGljaCB0byBzaGlmdCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIGRlbGF5IHRpbWVycyBvbi4gSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWVvdXQgc2NoZWR1bGVyIGlzIHVzZWQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaW1lLXNoaWZ0ZWQgc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uZGVsYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGZpcnN0QXJnID0gYXJndW1lbnRzWzBdO1xuICAgIGlmICh0eXBlb2YgZmlyc3RBcmcgPT09ICdudW1iZXInIHx8IGZpcnN0QXJnIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgdmFyIGR1ZVRpbWUgPSBmaXJzdEFyZywgc2NoZWR1bGVyID0gYXJndW1lbnRzWzFdO1xuICAgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG4gICAgICByZXR1cm4gZHVlVGltZSBpbnN0YW5jZW9mIERhdGUgP1xuICAgICAgICBvYnNlcnZhYmxlRGVsYXlBYnNvbHV0ZSh0aGlzLCBkdWVUaW1lLCBzY2hlZHVsZXIpIDpcbiAgICAgICAgb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUodGhpcywgZHVlVGltZSwgc2NoZWR1bGVyKTtcbiAgICB9IGVsc2UgaWYgKE9ic2VydmFibGUuaXNPYnNlcnZhYmxlKGZpcnN0QXJnKSB8fCBpc0Z1bmN0aW9uKGZpcnN0QXJnKSkge1xuICAgICAgcmV0dXJuIGRlbGF5V2l0aFNlbGVjdG9yKHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYXJndW1lbnRzJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBEZWJvdW5jZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERlYm91bmNlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBEZWJvdW5jZU9ic2VydmFibGUoc291cmNlLCBkdCwgcykge1xuICAgICAgaXNTY2hlZHVsZXIocykgfHwgKHMgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fZHQgPSBkdDtcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVib3VuY2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBjYW5jZWxhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShcbiAgICAgICAgdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBEZWJvdW5jZU9ic2VydmVyKG8sIHRoaXMuc291cmNlLCB0aGlzLl9kdCwgdGhpcy5fcywgY2FuY2VsYWJsZSkpLFxuICAgICAgICBjYW5jZWxhYmxlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERlYm91bmNlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBEZWJvdW5jZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhEZWJvdW5jZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIERlYm91bmNlT2JzZXJ2ZXIob2JzZXJ2ZXIsIHNvdXJjZSwgZHVlVGltZSwgc2NoZWR1bGVyLCBjYW5jZWxhYmxlKSB7XG4gICAgICB0aGlzLl9vID0gb2JzZXJ2ZXI7XG4gICAgICB0aGlzLl9zID0gc291cmNlO1xuICAgICAgdGhpcy5fZCA9IGR1ZVRpbWU7XG4gICAgICB0aGlzLl9zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICB0aGlzLl9jID0gY2FuY2VsYWJsZTtcbiAgICAgIHRoaXMuX3YgPSBudWxsO1xuICAgICAgdGhpcy5faHYgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2lkID0gMDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIERlYm91bmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdGhpcy5faHYgPSB0cnVlO1xuICAgICAgdGhpcy5fdiA9IHg7XG4gICAgICB2YXIgY3VycmVudElkID0gKyt0aGlzLl9pZCwgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgdGhpcy5fYy5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgZC5zZXREaXNwb3NhYmxlKHRoaXMuX3NjaGVkdWxlci5zY2hlZHVsZUZ1dHVyZSh0aGlzLCB0aGlzLl9kLCBmdW5jdGlvbiAoXywgc2VsZikge1xuICAgICAgICBzZWxmLl9odiAmJiBzZWxmLl9pZCA9PT0gY3VycmVudElkICYmIHNlbGYuX28ub25OZXh0KHgpO1xuICAgICAgICBzZWxmLl9odiA9IGZhbHNlO1xuICAgICAgfSkpO1xuICAgIH07XG5cbiAgICBEZWJvdW5jZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9jLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICAgIHRoaXMuX2h2ID0gZmFsc2U7XG4gICAgICB0aGlzLl9pZCsrO1xuICAgIH07XG5cbiAgICBEZWJvdW5jZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9jLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2h2ICYmIHRoaXMuX28ub25OZXh0KHRoaXMuX3YpO1xuICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgICAgdGhpcy5faHYgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2lkKys7XG4gICAgfTtcblxuICAgIHJldHVybiBEZWJvdW5jZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICBmdW5jdGlvbiBkZWJvdW5jZVdpdGhTZWxlY3Rvcihzb3VyY2UsIGR1cmF0aW9uU2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciB2YWx1ZSwgaGFzVmFsdWUgPSBmYWxzZSwgY2FuY2VsYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksIGlkID0gMDtcbiAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgICBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgIHZhciB0aHJvdHRsZSA9IHRyeUNhdGNoKGR1cmF0aW9uU2VsZWN0b3IpKHgpO1xuICAgICAgICAgIGlmICh0aHJvdHRsZSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcih0aHJvdHRsZS5lKTsgfVxuXG4gICAgICAgICAgaXNQcm9taXNlKHRocm90dGxlKSAmJiAodGhyb3R0bGUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UodGhyb3R0bGUpKTtcblxuICAgICAgICAgIGhhc1ZhbHVlID0gdHJ1ZTtcbiAgICAgICAgICB2YWx1ZSA9IHg7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgICB2YXIgY3VycmVudGlkID0gaWQsIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgICBjYW5jZWxhYmxlLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICAgICAgZC5zZXREaXNwb3NhYmxlKHRocm90dGxlLnN1YnNjcmliZShcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgaGFzVmFsdWUgJiYgaWQgPT09IGN1cnJlbnRpZCAmJiBvLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgICAgIGQuZGlzcG9zZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgaGFzVmFsdWUgJiYgaWQgPT09IGN1cnJlbnRpZCAmJiBvLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgICAgIGQuZGlzcG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICkpO1xuICAgICAgICB9LFxuICAgICAgICBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGNhbmNlbGFibGUuZGlzcG9zZSgpO1xuICAgICAgICAgIG8ub25FcnJvcihlKTtcbiAgICAgICAgICBoYXNWYWx1ZSA9IGZhbHNlO1xuICAgICAgICAgIGlkKys7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjYW5jZWxhYmxlLmRpc3Bvc2UoKTtcbiAgICAgICAgICBoYXNWYWx1ZSAmJiBvLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUpO1xuICAgIH0sIHNvdXJjZSk7XG4gIH1cblxuICBvYnNlcnZhYmxlUHJvdG8uZGVib3VuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24gKGFyZ3VtZW50c1swXSkpIHtcbiAgICAgIHJldHVybiBkZWJvdW5jZVdpdGhTZWxlY3Rvcih0aGlzLCBhcmd1bWVudHNbMF0pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiBuZXcgRGVib3VuY2VPYnNlcnZhYmxlKHRoaXMsIGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50cycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgVGltZXN0YW1wT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGltZXN0YW1wT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUaW1lc3RhbXBPYnNlcnZhYmxlKHNvdXJjZSwgcykge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRpbWVzdGFtcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgVGltZXN0YW1wT2JzZXJ2ZXIobywgdGhpcy5fcykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gVGltZXN0YW1wT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBUaW1lc3RhbXBPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGltZXN0YW1wT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGltZXN0YW1wT2JzZXJ2ZXIobywgcykge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRpbWVzdGFtcE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMuX28ub25OZXh0KHsgdmFsdWU6IHgsIHRpbWVzdGFtcDogdGhpcy5fcy5ub3coKSB9KTtcbiAgICB9O1xuXG4gICAgVGltZXN0YW1wT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgVGltZXN0YW1wT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRpbWVzdGFtcE9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIFJlY29yZHMgdGhlIHRpbWVzdGFtcCBmb3IgZWFjaCB2YWx1ZSBpbiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAgMSAtIHJlcyA9IHNvdXJjZS50aW1lc3RhbXAoKTsgLy8gcHJvZHVjZXMgeyB2YWx1ZTogeCwgdGltZXN0YW1wOiB0cyB9XG4gICAqICAyIC0gcmVzID0gc291cmNlLnRpbWVzdGFtcChSeC5TY2hlZHVsZXIuZGVmYXVsdCk7XG4gICAqXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHVzZWQgdG8gY29tcHV0ZSB0aW1lc3RhbXBzLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgZGVmYXVsdCBzY2hlZHVsZXIgaXMgdXNlZC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCB0aW1lc3RhbXAgaW5mb3JtYXRpb24gb24gdmFsdWVzLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnRpbWVzdGFtcCA9IGZ1bmN0aW9uIChzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IFRpbWVzdGFtcE9ic2VydmFibGUodGhpcywgc2NoZWR1bGVyKTtcbiAgfTtcblxuICBmdW5jdGlvbiBzYW1wbGVPYnNlcnZhYmxlKHNvdXJjZSwgc2FtcGxlcikge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGF0RW5kID0gZmFsc2UsIHZhbHVlLCBoYXNWYWx1ZSA9IGZhbHNlO1xuXG4gICAgICBmdW5jdGlvbiBzYW1wbGVTdWJzY3JpYmUoKSB7XG4gICAgICAgIGlmIChoYXNWYWx1ZSkge1xuICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgby5vbk5leHQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGF0RW5kICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHNvdXJjZVN1YnNjcmlwdGlvbiA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgc291cmNlU3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShcbiAgICAgICAgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgaGFzVmFsdWUgPSB0cnVlO1xuICAgICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGF0RW5kID0gdHJ1ZTtcbiAgICAgICAgICBzb3VyY2VTdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuICAgICAgICB9XG4gICAgICApKTtcblxuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuICAgICAgICBzb3VyY2VTdWJzY3JpcHRpb24sXG4gICAgICAgIHNhbXBsZXIuc3Vic2NyaWJlKHNhbXBsZVN1YnNjcmliZSwgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LCBzYW1wbGVTdWJzY3JpYmUpXG4gICAgICApO1xuICAgIH0sIHNvdXJjZSk7XG4gIH1cblxuICAvKipcbiAgICogIFNhbXBsZXMgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYXQgZWFjaCBpbnRlcnZhbC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogIDEgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKHNhbXBsZU9ic2VydmFibGUpOyAvLyBTYW1wbGVyIHRpY2sgc2VxdWVuY2VcbiAgICogIDIgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKDUwMDApOyAvLyA1IHNlY29uZHNcbiAgICogIDIgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKDUwMDAsIFJ4LlNjaGVkdWxlci50aW1lb3V0KTsgLy8gNSBzZWNvbmRzXG4gICAqXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGludGVydmFsT3JTYW1wbGVyIEludGVydmFsIGF0IHdoaWNoIHRvIHNhbXBsZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSBvciBTYW1wbGVyIE9ic2VydmFibGUuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHRvIHJ1biB0aGUgc2FtcGxpbmcgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB0aW1lb3V0IHNjaGVkdWxlciBpcyB1c2VkLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gU2FtcGxlZCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNhbXBsZSA9IG9ic2VydmFibGVQcm90by50aHJvdHRsZUxhdGVzdCA9IGZ1bmN0aW9uIChpbnRlcnZhbE9yU2FtcGxlciwgc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIHR5cGVvZiBpbnRlcnZhbE9yU2FtcGxlciA9PT0gJ251bWJlcicgP1xuICAgICAgc2FtcGxlT2JzZXJ2YWJsZSh0aGlzLCBvYnNlcnZhYmxlaW50ZXJ2YWwoaW50ZXJ2YWxPclNhbXBsZXIsIHNjaGVkdWxlcikpIDpcbiAgICAgIHNhbXBsZU9ic2VydmFibGUodGhpcywgaW50ZXJ2YWxPclNhbXBsZXIpO1xuICB9O1xuXG4gIHZhciBUaW1lb3V0RXJyb3IgPSBSeC5UaW1lb3V0RXJyb3IgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVGltZW91dCBoYXMgb2NjdXJyZWQnO1xuICAgIHRoaXMubmFtZSA9ICdUaW1lb3V0RXJyb3InO1xuICAgIEVycm9yLmNhbGwodGhpcyk7XG4gIH07XG4gIFRpbWVvdXRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cbiAgZnVuY3Rpb24gdGltZW91dFdpdGhTZWxlY3Rvcihzb3VyY2UsIGZpcnN0VGltZW91dCwgdGltZW91dER1cmF0aW9uU2VsZWN0b3IsIG90aGVyKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24oZmlyc3RUaW1lb3V0KSkge1xuICAgICAgb3RoZXIgPSB0aW1lb3V0RHVyYXRpb25TZWxlY3RvcjtcbiAgICAgIHRpbWVvdXREdXJhdGlvblNlbGVjdG9yID0gZmlyc3RUaW1lb3V0O1xuICAgICAgZmlyc3RUaW1lb3V0ID0gb2JzZXJ2YWJsZU5ldmVyKCk7XG4gICAgfVxuICAgIG90aGVyIHx8IChvdGhlciA9IG9ic2VydmFibGVUaHJvdyhuZXcgVGltZW91dEVycm9yKCkpKTtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLFxuICAgICAgICB0aW1lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG4gICAgICAgIG9yaWdpbmFsID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cbiAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG9yaWdpbmFsKTtcblxuICAgICAgdmFyIGlkID0gMCwgc3dpdGNoZWQgPSBmYWxzZTtcblxuICAgICAgZnVuY3Rpb24gc2V0VGltZXIodGltZW91dCkge1xuICAgICAgICB2YXIgbXlJZCA9IGlkLCBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gdGltZXJXaW5zKCkge1xuICAgICAgICAgIHN3aXRjaGVkID0gKG15SWQgPT09IGlkKTtcbiAgICAgICAgICByZXR1cm4gc3dpdGNoZWQ7XG4gICAgICAgIH1cblxuICAgICAgICB0aW1lci5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgICBkLnNldERpc3Bvc2FibGUodGltZW91dC5zdWJzY3JpYmUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRpbWVyV2lucygpICYmIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG90aGVyLnN1YnNjcmliZShvKSk7XG4gICAgICAgICAgZC5kaXNwb3NlKCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdGltZXJXaW5zKCkgJiYgby5vbkVycm9yKGUpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGltZXJXaW5zKCkgJiYgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG8pKTtcbiAgICAgICAgfSkpO1xuICAgICAgfTtcblxuICAgICAgc2V0VGltZXIoZmlyc3RUaW1lb3V0KTtcblxuICAgICAgZnVuY3Rpb24gb1dpbnMoKSB7XG4gICAgICAgIHZhciByZXMgPSAhc3dpdGNoZWQ7XG4gICAgICAgIGlmIChyZXMpIHsgaWQrKzsgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfVxuXG4gICAgICBvcmlnaW5hbC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgaWYgKG9XaW5zKCkpIHtcbiAgICAgICAgICBvLm9uTmV4dCh4KTtcbiAgICAgICAgICB2YXIgdGltZW91dCA9IHRyeUNhdGNoKHRpbWVvdXREdXJhdGlvblNlbGVjdG9yKSh4KTtcbiAgICAgICAgICBpZiAodGltZW91dCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcih0aW1lb3V0LmUpOyB9XG4gICAgICAgICAgc2V0VGltZXIoaXNQcm9taXNlKHRpbWVvdXQpID8gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHRpbWVvdXQpIDogdGltZW91dCk7XG4gICAgICAgIH1cbiAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIG9XaW5zKCkgJiYgby5vbkVycm9yKGUpO1xuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBvV2lucygpICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH0pKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIHRpbWVyKTtcbiAgICB9LCBzb3VyY2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gdGltZW91dChzb3VyY2UsIGR1ZVRpbWUsIG90aGVyLCBzY2hlZHVsZXIpIHtcbiAgICBpZiAoaXNTY2hlZHVsZXIob3RoZXIpKSB7XG4gICAgICBzY2hlZHVsZXIgPSBvdGhlcjtcbiAgICAgIG90aGVyID0gb2JzZXJ2YWJsZVRocm93KG5ldyBUaW1lb3V0RXJyb3IoKSk7XG4gICAgfVxuICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEVycm9yKSB7IG90aGVyID0gb2JzZXJ2YWJsZVRocm93KG90aGVyKTsgfVxuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgaWQgPSAwLFxuICAgICAgICBvcmlnaW5hbCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLFxuICAgICAgICBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLFxuICAgICAgICBzd2l0Y2hlZCA9IGZhbHNlLFxuICAgICAgICB0aW1lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cbiAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG9yaWdpbmFsKTtcblxuICAgICAgZnVuY3Rpb24gY3JlYXRlVGltZXIoKSB7XG4gICAgICAgIHZhciBteUlkID0gaWQ7XG4gICAgICAgIHRpbWVyLnNldERpc3Bvc2FibGUoc2NoZWR1bGVyLnNjaGVkdWxlRnV0dXJlKG51bGwsIGR1ZVRpbWUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzd2l0Y2hlZCA9IGlkID09PSBteUlkO1xuICAgICAgICAgIGlmIChzd2l0Y2hlZCkge1xuICAgICAgICAgICAgaXNQcm9taXNlKG90aGVyKSAmJiAob3RoZXIgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpKTtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG90aGVyLnN1YnNjcmliZShvKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICB9XG5cbiAgICAgIGNyZWF0ZVRpbWVyKCk7XG5cbiAgICAgIG9yaWdpbmFsLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAoIXN3aXRjaGVkKSB7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgICBvLm9uTmV4dCh4KTtcbiAgICAgICAgICBjcmVhdGVUaW1lcigpO1xuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXN3aXRjaGVkKSB7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgICBvLm9uRXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFzd2l0Y2hlZCkge1xuICAgICAgICAgIGlkKys7XG4gICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCB0aW1lcik7XG4gICAgfSwgc291cmNlKTtcbiAgfVxuXG4gIG9ic2VydmFibGVQcm90by50aW1lb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBmaXJzdEFyZyA9IGFyZ3VtZW50c1swXTtcbiAgICBpZiAoZmlyc3RBcmcgaW5zdGFuY2VvZiBEYXRlIHx8IHR5cGVvZiBmaXJzdEFyZyA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiB0aW1lb3V0KHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7XG4gICAgfSBlbHNlIGlmIChPYnNlcnZhYmxlLmlzT2JzZXJ2YWJsZShmaXJzdEFyZykgfHwgaXNGdW5jdGlvbihmaXJzdEFyZykpIHtcbiAgICAgIHJldHVybiB0aW1lb3V0V2l0aFNlbGVjdG9yKHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhcmd1bWVudHMnKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIG9ubHkgdGhlIGZpcnN0IGl0ZW0gZW1pdHRlZCBieSB0aGUgc291cmNlIE9ic2VydmFibGUgZHVyaW5nIHNlcXVlbnRpYWwgdGltZSB3aW5kb3dzIG9mIGEgc3BlY2lmaWVkIGR1cmF0aW9uLlxuICAgKiBAcGFyYW0ge051bWJlcn0gd2luZG93RHVyYXRpb24gdGltZSB0byB3YWl0IGJlZm9yZSBlbWl0dGluZyBhbm90aGVyIGl0ZW0gYWZ0ZXIgZW1pdHRpbmcgdGhlIGxhc3QgaXRlbVxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gdGhlIFNjaGVkdWxlciB0byB1c2UgaW50ZXJuYWxseSB0byBtYW5hZ2UgdGhlIHRpbWVycyB0aGF0IGhhbmRsZSB0aW1lb3V0IGZvciBlYWNoIGl0ZW0uIElmIG5vdCBwcm92aWRlZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLnRpbWVvdXQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHRoYXQgcGVyZm9ybXMgdGhlIHRocm90dGxlIG9wZXJhdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50aHJvdHRsZSA9IGZ1bmN0aW9uICh3aW5kb3dEdXJhdGlvbiwgc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG4gICAgdmFyIGR1cmF0aW9uID0gK3dpbmRvd0R1cmF0aW9uIHx8IDA7XG4gICAgaWYgKGR1cmF0aW9uIDw9IDApIHsgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3dpbmRvd0R1cmF0aW9uIGNhbm5vdCBiZSBsZXNzIG9yIGVxdWFsIHplcm8uJyk7IH1cbiAgICB2YXIgc291cmNlID0gdGhpcztcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBsYXN0T25OZXh0ID0gMDtcbiAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgICBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgIHZhciBub3cgPSBzY2hlZHVsZXIubm93KCk7XG4gICAgICAgICAgaWYgKGxhc3RPbk5leHQgPT09IDAgfHwgbm93IC0gbGFzdE9uTmV4dCA+PSBkdXJhdGlvbikge1xuICAgICAgICAgICAgbGFzdE9uTmV4dCA9IG5vdztcbiAgICAgICAgICAgIG8ub25OZXh0KHgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIGZ1bmN0aW9uICgpIHsgby5vbkNvbXBsZXRlZCgpOyB9XG4gICAgICApO1xuICAgIH0sIHNvdXJjZSk7XG4gIH07XG5cbiAgdmFyIFBhdXNhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoUGF1c2FibGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFBhdXNhYmxlT2JzZXJ2YWJsZShzb3VyY2UsIHBhdXNlcikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgU3ViamVjdCgpO1xuXG4gICAgICBpZiAocGF1c2VyICYmIHBhdXNlci5zdWJzY3JpYmUpIHtcbiAgICAgICAgdGhpcy5wYXVzZXIgPSB0aGlzLmNvbnRyb2xsZXIubWVyZ2UocGF1c2VyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyO1xuICAgICAgfVxuXG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBQYXVzYWJsZU9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGNvbm4gPSB0aGlzLnNvdXJjZS5wdWJsaXNoKCksXG4gICAgICAgIHN1YnNjcmlwdGlvbiA9IGNvbm4uc3Vic2NyaWJlKG8pLFxuICAgICAgICBjb25uZWN0aW9uID0gZGlzcG9zYWJsZUVtcHR5O1xuXG4gICAgICB2YXIgcGF1c2FibGUgPSB0aGlzLnBhdXNlci5kaXN0aW5jdFVudGlsQ2hhbmdlZCgpLnN1YnNjcmliZShmdW5jdGlvbiAoYikge1xuICAgICAgICBpZiAoYikge1xuICAgICAgICAgIGNvbm5lY3Rpb24gPSBjb25uLmNvbm5lY3QoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25uZWN0aW9uLmRpc3Bvc2UoKTtcbiAgICAgICAgICBjb25uZWN0aW9uID0gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShbc3Vic2NyaXB0aW9uLCBjb25uZWN0aW9uLCBwYXVzYWJsZV0pO1xuICAgIH07XG5cbiAgICBQYXVzYWJsZU9ic2VydmFibGUucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dChmYWxzZSk7XG4gICAgfTtcblxuICAgIFBhdXNhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dCh0cnVlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFBhdXNhYmxlT2JzZXJ2YWJsZTtcblxuICB9KE9ic2VydmFibGUpKTtcblxuICAvKipcbiAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgYmFzZWQgdXBvbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB5aWVsZHMgdHJ1ZS9mYWxzZS5cbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHBhdXNlciA9IG5ldyBSeC5TdWJqZWN0KCk7XG4gICAqIHZhciBzb3VyY2UgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMCkucGF1c2FibGUocGF1c2VyKTtcbiAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBwYXVzZXIgVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdXNlZCB0byBwYXVzZSB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIGlzIHBhdXNlZCBiYXNlZCB1cG9uIHRoZSBwYXVzZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucGF1c2FibGUgPSBmdW5jdGlvbiAocGF1c2VyKSB7XG4gICAgcmV0dXJuIG5ldyBQYXVzYWJsZU9ic2VydmFibGUodGhpcywgcGF1c2VyKTtcbiAgfTtcblxuICBmdW5jdGlvbiBjb21iaW5lTGF0ZXN0U291cmNlKHNvdXJjZSwgc3ViamVjdCwgcmVzdWx0U2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBoYXNWYWx1ZSA9IFtmYWxzZSwgZmFsc2VdLFxuICAgICAgICBoYXNWYWx1ZUFsbCA9IGZhbHNlLFxuICAgICAgICBpc0RvbmUgPSBmYWxzZSxcbiAgICAgICAgdmFsdWVzID0gbmV3IEFycmF5KDIpLFxuICAgICAgICBlcnI7XG5cbiAgICAgIGZ1bmN0aW9uIG5leHQoeCwgaSkge1xuICAgICAgICB2YWx1ZXNbaV0gPSB4O1xuICAgICAgICBoYXNWYWx1ZVtpXSA9IHRydWU7XG4gICAgICAgIGlmIChoYXNWYWx1ZUFsbCB8fCAoaGFzVmFsdWVBbGwgPSBoYXNWYWx1ZS5ldmVyeShpZGVudGl0eSkpKSB7XG4gICAgICAgICAgaWYgKGVycikgeyByZXR1cm4gby5vbkVycm9yKGVycik7IH1cbiAgICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2gocmVzdWx0U2VsZWN0b3IpLmFwcGx5KG51bGwsIHZhbHVlcyk7XG4gICAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXMuZSk7IH1cbiAgICAgICAgICBvLm9uTmV4dChyZXMpO1xuICAgICAgICB9XG4gICAgICAgIGlzRG9uZSAmJiB2YWx1ZXNbMV0gJiYgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG4gICAgICAgIHNvdXJjZS5zdWJzY3JpYmUoXG4gICAgICAgICAgZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIG5leHQoeCwgMCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlc1sxXSkge1xuICAgICAgICAgICAgICBvLm9uRXJyb3IoZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlcnIgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhbHVlc1sxXSAmJiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgfSksXG4gICAgICAgIHN1YmplY3Quc3Vic2NyaWJlKFxuICAgICAgICAgIGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICBuZXh0KHgsIDEpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG4gICAgICAgICAgICBuZXh0KHRydWUsIDEpO1xuICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfSwgc291cmNlKTtcbiAgfVxuXG4gIHZhciBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUoc291cmNlLCBwYXVzZXIpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5jb250cm9sbGVyID0gbmV3IFN1YmplY3QoKTtcblxuICAgICAgaWYgKHBhdXNlciAmJiBwYXVzZXIuc3Vic2NyaWJlKSB7XG4gICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyLm1lcmdlKHBhdXNlcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnBhdXNlciA9IHRoaXMuY29udHJvbGxlcjtcbiAgICAgIH1cblxuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHEgPSBbXSwgcHJldmlvdXNTaG91bGRGaXJlO1xuXG4gICAgICBmdW5jdGlvbiBkcmFpblF1ZXVlKCkgeyB3aGlsZSAocS5sZW5ndGggPiAwKSB7IG8ub25OZXh0KHEuc2hpZnQoKSk7IH0gfVxuXG4gICAgICB2YXIgc3Vic2NyaXB0aW9uID1cbiAgICAgICAgY29tYmluZUxhdGVzdFNvdXJjZShcbiAgICAgICAgICB0aGlzLnNvdXJjZSxcbiAgICAgICAgICB0aGlzLnBhdXNlci5zdGFydFdpdGgoZmFsc2UpLmRpc3RpbmN0VW50aWxDaGFuZ2VkKCksXG4gICAgICAgICAgZnVuY3Rpb24gKGRhdGEsIHNob3VsZEZpcmUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IGRhdGEsIHNob3VsZEZpcmU6IHNob3VsZEZpcmUgfTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICBmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgICAgICAgICBpZiAocHJldmlvdXNTaG91bGRGaXJlICE9PSB1bmRlZmluZWQgJiYgcmVzdWx0cy5zaG91bGRGaXJlICE9PSBwcmV2aW91c1Nob3VsZEZpcmUpIHtcbiAgICAgICAgICAgICAgICBwcmV2aW91c1Nob3VsZEZpcmUgPSByZXN1bHRzLnNob3VsZEZpcmU7XG4gICAgICAgICAgICAgICAgLy8gY2hhbmdlIGluIHNob3VsZEZpcmVcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5zaG91bGRGaXJlKSB7IGRyYWluUXVldWUoKTsgfVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzU2hvdWxkRmlyZSA9IHJlc3VsdHMuc2hvdWxkRmlyZTtcbiAgICAgICAgICAgICAgICAvLyBuZXcgZGF0YVxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLnNob3VsZEZpcmUpIHtcbiAgICAgICAgICAgICAgICAgIG8ub25OZXh0KHJlc3VsdHMuZGF0YSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHEucHVzaChyZXN1bHRzLmRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgICAgICAgICAgICBvLm9uRXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGRyYWluUXVldWUoKTtcbiAgICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICByZXR1cm4gc3Vic2NyaXB0aW9uOyAgICAgIFxuICAgIH07XG5cbiAgICBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIub25OZXh0KGZhbHNlKTtcbiAgICB9O1xuXG4gICAgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY29udHJvbGxlci5vbk5leHQodHJ1ZSk7XG4gICAgfTtcblxuICAgIHJldHVybiBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZTtcblxuICB9KE9ic2VydmFibGUpKTtcblxuICAvKipcbiAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgYmFzZWQgdXBvbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB5aWVsZHMgdHJ1ZS9mYWxzZSxcbiAgICogYW5kIHlpZWxkcyB0aGUgdmFsdWVzIHRoYXQgd2VyZSBidWZmZXJlZCB3aGlsZSBwYXVzZWQuXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciBwYXVzZXIgPSBuZXcgUnguU3ViamVjdCgpO1xuICAgKiB2YXIgc291cmNlID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDApLnBhdXNhYmxlQnVmZmVyZWQocGF1c2VyKTtcbiAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBwYXVzZXIgVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdXNlZCB0byBwYXVzZSB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIGlzIHBhdXNlZCBiYXNlZCB1cG9uIHRoZSBwYXVzZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucGF1c2FibGVCdWZmZXJlZCA9IGZ1bmN0aW9uIChzdWJqZWN0KSB7XG4gICAgcmV0dXJuIG5ldyBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSh0aGlzLCBzdWJqZWN0KTtcbiAgfTtcblxuICB2YXIgQ29udHJvbGxlZE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENvbnRyb2xsZWRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIENvbnRyb2xsZWRPYnNlcnZhYmxlIChzb3VyY2UsIGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5zdWJqZWN0ID0gbmV3IENvbnRyb2xsZWRTdWJqZWN0KGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpO1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2UubXVsdGljYXN0KHRoaXMuc3ViamVjdCkucmVmQ291bnQoKTtcbiAgICB9XG5cbiAgICBDb250cm9sbGVkT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG8pO1xuICAgIH07XG5cbiAgICBDb250cm9sbGVkT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVxdWVzdCA9IGZ1bmN0aW9uIChudW1iZXJPZkl0ZW1zKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdWJqZWN0LnJlcXVlc3QobnVtYmVyT2ZJdGVtcyA9PSBudWxsID8gLTEgOiBudW1iZXJPZkl0ZW1zKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENvbnRyb2xsZWRPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIHZhciBDb250cm9sbGVkU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ29udHJvbGxlZFN1YmplY3QsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29udHJvbGxlZFN1YmplY3QoZW5hYmxlUXVldWUsIHNjaGVkdWxlcikge1xuICAgICAgZW5hYmxlUXVldWUgPT0gbnVsbCAmJiAoZW5hYmxlUXVldWUgPSB0cnVlKTtcblxuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLnN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xuICAgICAgdGhpcy5lbmFibGVRdWV1ZSA9IGVuYWJsZVF1ZXVlO1xuICAgICAgdGhpcy5xdWV1ZSA9IGVuYWJsZVF1ZXVlID8gW10gOiBudWxsO1xuICAgICAgdGhpcy5yZXF1ZXN0ZWRDb3VudCA9IDA7XG4gICAgICB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUgPSBudWxsO1xuICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICB0aGlzLmhhc0ZhaWxlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5oYXNDb21wbGV0ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyIHx8IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXI7XG4gICAgfVxuXG4gICAgYWRkUHJvcGVydGllcyhDb250cm9sbGVkU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLCB7XG4gICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJqZWN0LnN1YnNjcmliZShvKTtcbiAgICAgIH0sXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IHRydWU7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVRdWV1ZSB8fCB0aGlzLnF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIHRoaXMuc3ViamVjdC5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZS5wdXNoKE5vdGlmaWNhdGlvbi5jcmVhdGVPbkNvbXBsZXRlZCgpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICB0aGlzLmhhc0ZhaWxlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVF1ZXVlIHx8IHRoaXMucXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5zdWJqZWN0Lm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZS5wdXNoKE5vdGlmaWNhdGlvbi5jcmVhdGVPbkVycm9yKGVycm9yKSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0ZWRDb3VudCA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5lbmFibGVRdWV1ZSAmJiB0aGlzLnF1ZXVlLnB1c2goTm90aWZpY2F0aW9uLmNyZWF0ZU9uTmV4dCh2YWx1ZSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICh0aGlzLnJlcXVlc3RlZENvdW50LS0gPT09IDApICYmIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG4gICAgICAgICAgdGhpcy5zdWJqZWN0Lm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBfcHJvY2Vzc1JlcXVlc3Q6IGZ1bmN0aW9uIChudW1iZXJPZkl0ZW1zKSB7XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZVF1ZXVlKSB7XG4gICAgICAgICAgd2hpbGUgKHRoaXMucXVldWUubGVuZ3RoID4gMCAmJiAobnVtYmVyT2ZJdGVtcyA+IDAgfHwgdGhpcy5xdWV1ZVswXS5raW5kICE9PSAnTicpKSB7XG4gICAgICAgICAgICB2YXIgZmlyc3QgPSB0aGlzLnF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICBmaXJzdC5hY2NlcHQodGhpcy5zdWJqZWN0KTtcbiAgICAgICAgICAgIGlmIChmaXJzdC5raW5kID09PSAnTicpIHtcbiAgICAgICAgICAgICAgbnVtYmVyT2ZJdGVtcy0tO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudW1iZXJPZkl0ZW1zO1xuICAgICAgfSxcbiAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChudW1iZXIpIHtcbiAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSA9IHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKG51bWJlcixcbiAgICAgICAgZnVuY3Rpb24ocywgaSkge1xuICAgICAgICAgIHZhciByZW1haW5pbmcgPSBzZWxmLl9wcm9jZXNzUmVxdWVzdChpKTtcbiAgICAgICAgICB2YXIgc3RvcHBlZCA9IHNlbGYuaGFzQ29tcGxldGVkIHx8IHNlbGYuaGFzRmFpbGVkO1xuICAgICAgICAgIGlmICghc3RvcHBlZCAmJiByZW1haW5pbmcgPiAwKSB7XG4gICAgICAgICAgICBzZWxmLnJlcXVlc3RlZENvdW50ID0gcmVtYWluaW5nO1xuXG4gICAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHNlbGYucmVxdWVzdGVkQ291bnQgPSAwO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIC8vIFNjaGVkdWxlZCBpdGVtIGlzIHN0aWxsIGluIHByb2dyZXNzLiBSZXR1cm4gYSBuZXdcbiAgICAgICAgICAgICAgLy8gZGlzcG9zYWJsZSB0byBhbGxvdyB0aGUgcmVxdWVzdCB0byBiZSBpbnRlcnJ1cHRlZFxuICAgICAgICAgICAgICAvLyB2aWEgZGlzcG9zZS5cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGU7XG4gICAgICB9LFxuICAgICAgZGlzcG9zZUN1cnJlbnRSZXF1ZXN0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUpIHtcbiAgICAgICAgICB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUuZGlzcG9zZSgpO1xuICAgICAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBDb250cm9sbGVkU3ViamVjdDtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgLyoqXG4gICAqIEF0dGFjaGVzIGEgY29udHJvbGxlciB0byB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIHRoZSBhYmlsaXR5IHRvIHF1ZXVlLlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgc291cmNlID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDApLmNvbnRyb2xsZWQoKTtcbiAgICogc291cmNlLnJlcXVlc3QoMyk7IC8vIFJlYWRzIDMgdmFsdWVzXG4gICAqIEBwYXJhbSB7Ym9vbH0gZW5hYmxlUXVldWUgdHJ1dGh5IHZhbHVlIHRvIGRldGVybWluZSBpZiB2YWx1ZXMgc2hvdWxkIGJlIHF1ZXVlZCBwZW5kaW5nIHRoZSBuZXh0IHJlcXVlc3RcbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBkZXRlcm1pbmVzIGhvdyB0aGUgcmVxdWVzdHMgd2lsbCBiZSBzY2hlZHVsZWRcbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIG9ubHkgcHJvcGFnYXRlcyB2YWx1ZXMgb24gcmVxdWVzdC5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5jb250cm9sbGVkID0gZnVuY3Rpb24gKGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpIHtcblxuICAgIGlmIChlbmFibGVRdWV1ZSAmJiBpc1NjaGVkdWxlcihlbmFibGVRdWV1ZSkpIHtcbiAgICAgIHNjaGVkdWxlciA9IGVuYWJsZVF1ZXVlO1xuICAgICAgZW5hYmxlUXVldWUgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChlbmFibGVRdWV1ZSA9PSBudWxsKSB7ICBlbmFibGVRdWV1ZSA9IHRydWU7IH1cbiAgICByZXR1cm4gbmV3IENvbnRyb2xsZWRPYnNlcnZhYmxlKHRoaXMsIGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQaXBlcyB0aGUgZXhpc3RpbmcgT2JzZXJ2YWJsZSBzZXF1ZW5jZSBpbnRvIGEgTm9kZS5qcyBTdHJlYW0uXG4gICAqIEBwYXJhbSB7U3RyZWFtfSBkZXN0IFRoZSBkZXN0aW5hdGlvbiBOb2RlLmpzIHN0cmVhbS5cbiAgICogQHJldHVybnMge1N0cmVhbX0gVGhlIGRlc3RpbmF0aW9uIHN0cmVhbS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5waXBlID0gZnVuY3Rpb24gKGRlc3QpIHtcbiAgICB2YXIgc291cmNlID0gdGhpcy5wYXVzYWJsZUJ1ZmZlcmVkKCk7XG5cbiAgICBmdW5jdGlvbiBvbkRyYWluKCkge1xuICAgICAgc291cmNlLnJlc3VtZSgpO1xuICAgIH1cblxuICAgIGRlc3QuYWRkTGlzdGVuZXIoJ2RyYWluJywgb25EcmFpbik7XG5cbiAgICBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgIWRlc3Qud3JpdGUoU3RyaW5nKHgpKSAmJiBzb3VyY2UucGF1c2UoKTtcbiAgICAgIH0sXG4gICAgICBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGRlc3QuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gSGFjayBjaGVjayBiZWNhdXNlIFNURElPIGlzIG5vdCBjbG9zYWJsZVxuICAgICAgICAhZGVzdC5faXNTdGRpbyAmJiBkZXN0LmVuZCgpO1xuICAgICAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdkcmFpbicsIG9uRHJhaW4pO1xuICAgICAgfSk7XG5cbiAgICBzb3VyY2UucmVzdW1lKCk7XG5cbiAgICByZXR1cm4gZGVzdDtcbiAgfTtcblxuICB2YXIgVHJhbnNkdWNlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRyYW5zZHVjZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFRyYW5zZHVjZU9ic2VydmVyKG8sIHhmb3JtKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3hmb3JtID0geGZvcm07XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5feGZvcm1bJ0BAdHJhbnNkdWNlci9zdGVwJ10pLmNhbGwodGhpcy5feGZvcm0sIHRoaXMuX28sIHgpO1xuICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgIH07XG5cbiAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG5cbiAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5feGZvcm1bJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSh0aGlzLl9vKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRyYW5zZHVjZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICBmdW5jdGlvbiB0cmFuc2Zvcm1Gb3JPYnNlcnZlcihvKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICdAQHRyYW5zZHVjZXIvaW5pdCc6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbztcbiAgICAgIH0sXG4gICAgICAnQEB0cmFuc2R1Y2VyL3N0ZXAnOiBmdW5jdGlvbihvYnMsIGlucHV0KSB7XG4gICAgICAgIHJldHVybiBvYnMub25OZXh0KGlucHV0KTtcbiAgICAgIH0sXG4gICAgICAnQEB0cmFuc2R1Y2VyL3Jlc3VsdCc6IGZ1bmN0aW9uKG9icykge1xuICAgICAgICByZXR1cm4gb2JzLm9uQ29tcGxldGVkKCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyBhIHRyYW5zZHVjZXIgdG8gdHJhbnNmb3JtIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlXG4gICAqIEBwYXJhbSB7VHJhbnNkdWNlcn0gdHJhbnNkdWNlciBBIHRyYW5zZHVjZXIgdG8gZXhlY3V0ZVxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHRzIGZyb20gdGhlIHRyYW5zZHVjZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8udHJhbnNkdWNlID0gZnVuY3Rpb24odHJhbnNkdWNlcikge1xuICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbihvKSB7XG4gICAgICB2YXIgeGZvcm0gPSB0cmFuc2R1Y2VyKHRyYW5zZm9ybUZvck9ic2VydmVyKG8pKTtcbiAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBUcmFuc2R1Y2VPYnNlcnZlcihvLCB4Zm9ybSkpO1xuICAgIH0sIHNvdXJjZSk7XG4gIH07XG5cbiAgdmFyIEFub255bW91c09ic2VydmFibGUgPSBSeC5Bbm9ueW1vdXNPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBbm9ueW1vdXNPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgLy8gRml4IHN1YnNjcmliZXIgdG8gY2hlY2sgZm9yIHVuZGVmaW5lZCBvciBmdW5jdGlvbiByZXR1cm5lZCB0byBkZWNvcmF0ZSBhcyBEaXNwb3NhYmxlXG4gICAgZnVuY3Rpb24gZml4U3Vic2NyaWJlcihzdWJzY3JpYmVyKSB7XG4gICAgICByZXR1cm4gc3Vic2NyaWJlciAmJiBpc0Z1bmN0aW9uKHN1YnNjcmliZXIuZGlzcG9zZSkgPyBzdWJzY3JpYmVyIDpcbiAgICAgICAgaXNGdW5jdGlvbihzdWJzY3JpYmVyKSA/IGRpc3Bvc2FibGVDcmVhdGUoc3Vic2NyaWJlcikgOiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0RGlzcG9zYWJsZShzLCBzdGF0ZSkge1xuICAgICAgdmFyIGFkbyA9IHN0YXRlWzBdLCBzZWxmID0gc3RhdGVbMV07XG4gICAgICB2YXIgc3ViID0gdHJ5Q2F0Y2goc2VsZi5fX3N1YnNjcmliZSkuY2FsbChzZWxmLCBhZG8pO1xuICAgICAgaWYgKHN1YiA9PT0gZXJyb3JPYmogJiYgIWFkby5mYWlsKGVycm9yT2JqLmUpKSB7IHRocm93ZXIoZXJyb3JPYmouZSk7IH1cbiAgICAgIGFkby5zZXREaXNwb3NhYmxlKGZpeFN1YnNjcmliZXIoc3ViKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQW5vbnltb3VzT2JzZXJ2YWJsZShzdWJzY3JpYmUsIHBhcmVudCkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBwYXJlbnQ7XG4gICAgICB0aGlzLl9fc3Vic2NyaWJlID0gc3Vic2NyaWJlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgQW5vbnltb3VzT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgYWRvID0gbmV3IEF1dG9EZXRhY2hPYnNlcnZlcihvKSwgc3RhdGUgPSBbYWRvLCB0aGlzXTtcblxuICAgICAgaWYgKGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZXF1aXJlZCgpKSB7XG4gICAgICAgIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNldERpc3Bvc2FibGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0RGlzcG9zYWJsZShudWxsLCBzdGF0ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYWRvO1xuICAgIH07XG5cbiAgICByZXR1cm4gQW5vbnltb3VzT2JzZXJ2YWJsZTtcblxuICB9KE9ic2VydmFibGUpKTtcblxuICB2YXIgQXV0b0RldGFjaE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBdXRvRGV0YWNoT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBBdXRvRGV0YWNoT2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy5tID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgfVxuXG4gICAgdmFyIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZSA9IEF1dG9EZXRhY2hPYnNlcnZlci5wcm90b3R5cGU7XG5cbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25OZXh0KS5jYWxsKHRoaXMub2JzZXJ2ZXIsIHZhbHVlKTtcbiAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIHRoaXMuZGlzcG9zZSgpO1xuICAgICAgICB0aHJvd2VyKHJlc3VsdC5lKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25FcnJvcikuY2FsbCh0aGlzLm9ic2VydmVyLCBlcnIpO1xuICAgICAgdGhpcy5kaXNwb3NlKCk7XG4gICAgICByZXN1bHQgPT09IGVycm9yT2JqICYmIHRocm93ZXIocmVzdWx0LmUpO1xuICAgIH07XG5cbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25Db21wbGV0ZWQpLmNhbGwodGhpcy5vYnNlcnZlcik7XG4gICAgICB0aGlzLmRpc3Bvc2UoKTtcbiAgICAgIHJlc3VsdCA9PT0gZXJyb3JPYmogJiYgdGhyb3dlcihyZXN1bHQuZSk7XG4gICAgfTtcblxuICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKHZhbHVlKSB7IHRoaXMubS5zZXREaXNwb3NhYmxlKHZhbHVlKTsgfTtcbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMubS5nZXREaXNwb3NhYmxlKCk7IH07XG5cbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF9fc3VwZXJfXy5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5tLmRpc3Bvc2UoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEF1dG9EZXRhY2hPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgdmFyIElubmVyU3Vic2NyaXB0aW9uID0gZnVuY3Rpb24gKHMsIG8pIHtcbiAgICB0aGlzLl9zID0gcztcbiAgICB0aGlzLl9vID0gbztcbiAgfTtcblxuICBJbm5lclN1YnNjcmlwdGlvbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuX3MuaXNEaXNwb3NlZCAmJiB0aGlzLl9vICE9PSBudWxsKSB7XG4gICAgICB2YXIgaWR4ID0gdGhpcy5fcy5vYnNlcnZlcnMuaW5kZXhPZih0aGlzLl9vKTtcbiAgICAgIHRoaXMuX3Mub2JzZXJ2ZXJzLnNwbGljZShpZHgsIDEpO1xuICAgICAgdGhpcy5fbyA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiAgUmVwcmVzZW50cyBhbiBvYmplY3QgdGhhdCBpcyBib3RoIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgd2VsbCBhcyBhbiBvYnNlcnZlci5cbiAgICogIEVhY2ggbm90aWZpY2F0aW9uIGlzIGJyb2FkY2FzdGVkIHRvIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycy5cbiAgICovXG4gIHZhciBTdWJqZWN0ID0gUnguU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU3ViamVjdCwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTdWJqZWN0KCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgIH1cblxuICAgIGFkZFByb3BlcnRpZXMoU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gobyk7XG4gICAgICAgICAgcmV0dXJuIG5ldyBJbm5lclN1YnNjcmlwdGlvbih0aGlzLCBvKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuICAgICAgICAgIG8ub25FcnJvcih0aGlzLmVycm9yKTtcbiAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cbiAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKi9cbiAgICAgIGhhc09ic2VydmVyczogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5vYnNlcnZlcnMubGVuZ3RoID4gMDsgfSxcbiAgICAgIC8qKlxuICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuICAgICAgICovXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgb3NbaV0ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIFRoZSBleGNlcHRpb24gdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuICAgICAgICovXG4gICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGFycml2YWwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG9zW2ldLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBVbnN1YnNjcmliZSBhbGwgb2JzZXJ2ZXJzIGFuZCByZWxlYXNlIHJlc291cmNlcy5cbiAgICAgICAqL1xuICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm9ic2VydmVycyA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc3ViamVjdCBmcm9tIHRoZSBzcGVjaWZpZWQgb2JzZXJ2ZXIgYW5kIG9ic2VydmFibGUuXG4gICAgICogQHBhcmFtIHtPYnNlcnZlcn0gb2JzZXJ2ZXIgVGhlIG9ic2VydmVyIHVzZWQgdG8gc2VuZCBtZXNzYWdlcyB0byB0aGUgc3ViamVjdC5cbiAgICAgKiBAcGFyYW0ge09ic2VydmFibGV9IG9ic2VydmFibGUgVGhlIG9ic2VydmFibGUgdXNlZCB0byBzdWJzY3JpYmUgdG8gbWVzc2FnZXMgc2VudCBmcm9tIHRoZSBzdWJqZWN0LlxuICAgICAqIEByZXR1cm5zIHtTdWJqZWN0fSBTdWJqZWN0IGltcGxlbWVudGVkIHVzaW5nIHRoZSBnaXZlbiBvYnNlcnZlciBhbmQgb2JzZXJ2YWJsZS5cbiAgICAgKi9cbiAgICBTdWJqZWN0LmNyZWF0ZSA9IGZ1bmN0aW9uIChvYnNlcnZlciwgb2JzZXJ2YWJsZSkge1xuICAgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNTdWJqZWN0KG9ic2VydmVyLCBvYnNlcnZhYmxlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFN1YmplY3Q7XG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIC8qKlxuICAgKiAgUmVwcmVzZW50cyB0aGUgcmVzdWx0IG9mIGFuIGFzeW5jaHJvbm91cyBvcGVyYXRpb24uXG4gICAqICBUaGUgbGFzdCB2YWx1ZSBiZWZvcmUgdGhlIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbiwgb3IgdGhlIGVycm9yIHJlY2VpdmVkIHRocm91Z2ggT25FcnJvciwgaXMgc2VudCB0byBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMuXG4gICAqL1xuICB2YXIgQXN5bmNTdWJqZWN0ID0gUnguQXN5bmNTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBc3luY1N1YmplY3QsIF9fc3VwZXJfXyk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc3ViamVjdCB0aGF0IGNhbiBvbmx5IHJlY2VpdmUgb25lIHZhbHVlIGFuZCB0aGF0IHZhbHVlIGlzIGNhY2hlZCBmb3IgYWxsIGZ1dHVyZSBvYnNlcnZhdGlvbnMuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gQXN5bmNTdWJqZWN0KCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgIH1cblxuICAgIGFkZFByb3BlcnRpZXMoQXN5bmNTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG4gICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG8pO1xuICAgICAgICAgIHJldHVybiBuZXcgSW5uZXJTdWJzY3JpcHRpb24odGhpcywgbyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuICAgICAgICAgIG8ub25FcnJvcih0aGlzLmVycm9yKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhhc1ZhbHVlKSB7XG4gICAgICAgICAgby5vbk5leHQodGhpcy52YWx1ZSk7XG4gICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuICAgICAgICovXG4gICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UsIGFsc28gY2F1c2luZyB0aGUgbGFzdCByZWNlaXZlZCB2YWx1ZSB0byBiZSBzZW50IG91dCAoaWYgYW55KS5cbiAgICAgICAqL1xuICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGksIGxlbjtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoO1xuXG4gICAgICAgICAgaWYgKHRoaXMuaGFzVmFsdWUpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICB2YXIgbyA9IG9zW2ldO1xuICAgICAgICAgICAgICBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgb3NbaV0ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVycm9yLlxuICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIEVycm9yIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cbiAgICAgICAqL1xuICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBTZW5kcyBhIHZhbHVlIHRvIHRoZSBzdWJqZWN0LiBUaGUgbGFzdCB2YWx1ZSByZWNlaXZlZCBiZWZvcmUgc3VjY2Vzc2Z1bCB0ZXJtaW5hdGlvbiB3aWxsIGJlIHNlbnQgdG8gYWxsIHN1YnNjcmliZWQgYW5kIGZ1dHVyZSBvYnNlcnZlcnMuXG4gICAgICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc3RvcmUgaW4gdGhlIHN1YmplY3QuXG4gICAgICAgKi9cbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmhhc1ZhbHVlID0gdHJ1ZTtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuICAgICAgICovXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcbiAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIEFzeW5jU3ViamVjdDtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgdmFyIEFub255bW91c1N1YmplY3QgPSBSeC5Bbm9ueW1vdXNTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBbm9ueW1vdXNTdWJqZWN0LCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEFub255bW91c1N1YmplY3Qob2JzZXJ2ZXIsIG9ic2VydmFibGUpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgIHRoaXMub2JzZXJ2YWJsZSA9IG9ic2VydmFibGU7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBhZGRQcm9wZXJ0aWVzKEFub255bW91c1N1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcbiAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9ic2VydmFibGUuc3Vic2NyaWJlKG8pO1xuICAgICAgfSxcbiAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgIH0sXG4gICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlci5vbkVycm9yKGVycm9yKTtcbiAgICAgIH0sXG4gICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gQW5vbnltb3VzU3ViamVjdDtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgLyoqXG4gICAqICBSZXByZXNlbnRzIGEgdmFsdWUgdGhhdCBjaGFuZ2VzIG92ZXIgdGltZS5cbiAgICogIE9ic2VydmVycyBjYW4gc3Vic2NyaWJlIHRvIHRoZSBzdWJqZWN0IHRvIHJlY2VpdmUgdGhlIGxhc3QgKG9yIGluaXRpYWwpIHZhbHVlIGFuZCBhbGwgc3Vic2VxdWVudCBub3RpZmljYXRpb25zLlxuICAgKi9cbiAgdmFyIEJlaGF2aW9yU3ViamVjdCA9IFJ4LkJlaGF2aW9yU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQmVoYXZpb3JTdWJqZWN0LCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEJlaGF2aW9yU3ViamVjdCh2YWx1ZSkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgIH1cblxuICAgIGFkZFByb3BlcnRpZXMoQmVoYXZpb3JTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG4gICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvKTtcbiAgICAgICAgICBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcbiAgICAgICAgICByZXR1cm4gbmV3IElubmVyU3Vic2NyaXB0aW9uKHRoaXMsIG8pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG4gICAgICAgICAgby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogR2V0cyB0aGUgY3VycmVudCB2YWx1ZSBvciB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuICAgICAgICogVmFsdWUgaXMgZnJvemVuIGFmdGVyIG9uQ29tcGxldGVkIGlzIGNhbGxlZC5cbiAgICAgICAqIEFmdGVyIG9uRXJyb3IgaXMgY2FsbGVkIGFsd2F5cyB0aHJvd3MgdGhlIHNwZWNpZmllZCBleGNlcHRpb24uXG4gICAgICAgKiBBbiBleGNlcHRpb24gaXMgYWx3YXlzIHRocm93biBhZnRlciBkaXNwb3NlIGlzIGNhbGxlZC5cbiAgICAgICAqIEByZXR1cm5zIHtNaXhlZH0gVGhlIGluaXRpYWwgdmFsdWUgcGFzc2VkIHRvIHRoZSBjb25zdHJ1Y3RvciB1bnRpbCBvbk5leHQgaXMgY2FsbGVkOyBhZnRlciB3aGljaCwgdGhlIGxhc3QgdmFsdWUgcGFzc2VkIHRvIG9uTmV4dC5cbiAgICAgICAqL1xuICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgIHRocm93IHRoaXMuZXJyb3I7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cbiAgICAgICAqL1xuICAgICAgaGFzT2JzZXJ2ZXJzOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm9ic2VydmVycy5sZW5ndGggPiAwOyB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UuXG4gICAgICAgKi9cbiAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBvc1tpXS5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXhjZXB0aW9uLlxuICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIGV4Y2VwdGlvbiB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGFycml2YWwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBvc1tpXS5vbk5leHQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBVbnN1YnNjcmliZSBhbGwgb2JzZXJ2ZXJzIGFuZCByZWxlYXNlIHJlc291cmNlcy5cbiAgICAgICAqL1xuICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm9ic2VydmVycyA9IG51bGw7XG4gICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBCZWhhdmlvclN1YmplY3Q7XG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIC8qKlxuICAgKiBSZXByZXNlbnRzIGFuIG9iamVjdCB0aGF0IGlzIGJvdGggYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyB3ZWxsIGFzIGFuIG9ic2VydmVyLlxuICAgKiBFYWNoIG5vdGlmaWNhdGlvbiBpcyBicm9hZGNhc3RlZCB0byBhbGwgc3Vic2NyaWJlZCBhbmQgZnV0dXJlIG9ic2VydmVycywgc3ViamVjdCB0byBidWZmZXIgdHJpbW1pbmcgcG9saWNpZXMuXG4gICAqL1xuICB2YXIgUmVwbGF5U3ViamVjdCA9IFJ4LlJlcGxheVN1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXG4gICAgdmFyIG1heFNhZmVJbnRlZ2VyID0gTWF0aC5wb3coMiwgNTMpIC0gMTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVJlbW92YWJsZURpc3Bvc2FibGUoc3ViamVjdCwgb2JzZXJ2ZXIpIHtcbiAgICAgIHJldHVybiBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgb2JzZXJ2ZXIuZGlzcG9zZSgpO1xuICAgICAgICAhc3ViamVjdC5pc0Rpc3Bvc2VkICYmIHN1YmplY3Qub2JzZXJ2ZXJzLnNwbGljZShzdWJqZWN0Lm9ic2VydmVycy5pbmRleE9mKG9ic2VydmVyKSwgMSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpbmhlcml0cyhSZXBsYXlTdWJqZWN0LCBfX3N1cGVyX18pO1xuXG4gICAgLyoqXG4gICAgICogIEluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBSZXBsYXlTdWJqZWN0IGNsYXNzIHdpdGggdGhlIHNwZWNpZmllZCBidWZmZXIgc2l6ZSwgd2luZG93IHNpemUgYW5kIHNjaGVkdWxlci5cbiAgICAgKiAgQHBhcmFtIHtOdW1iZXJ9IFtidWZmZXJTaXplXSBNYXhpbXVtIGVsZW1lbnQgY291bnQgb2YgdGhlIHJlcGxheSBidWZmZXIuXG4gICAgICogIEBwYXJhbSB7TnVtYmVyfSBbd2luZG93U2l6ZV0gTWF4aW11bSB0aW1lIGxlbmd0aCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICAgKiAgQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0aGUgb2JzZXJ2ZXJzIGFyZSBpbnZva2VkIG9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLmJ1ZmZlclNpemUgPSBidWZmZXJTaXplID09IG51bGwgPyBtYXhTYWZlSW50ZWdlciA6IGJ1ZmZlclNpemU7XG4gICAgICB0aGlzLndpbmRvd1NpemUgPSB3aW5kb3dTaXplID09IG51bGwgPyBtYXhTYWZlSW50ZWdlciA6IHdpbmRvd1NpemU7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlciB8fCBjdXJyZW50VGhyZWFkU2NoZWR1bGVyO1xuICAgICAgdGhpcy5xID0gW107XG4gICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBhZGRQcm9wZXJ0aWVzKFJlcGxheVN1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcbiAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIHZhciBzbyA9IG5ldyBTY2hlZHVsZWRPYnNlcnZlcih0aGlzLnNjaGVkdWxlciwgbyksIHN1YnNjcmlwdGlvbiA9IGNyZWF0ZVJlbW92YWJsZURpc3Bvc2FibGUodGhpcywgc28pO1xuXG4gICAgICAgIHRoaXMuX3RyaW0odGhpcy5zY2hlZHVsZXIubm93KCkpO1xuICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKHNvKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5xLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgc28ub25OZXh0KHRoaXMucVtpXS52YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuICAgICAgICAgIHNvLm9uRXJyb3IodGhpcy5lcnJvcik7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICBzby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc28uZW5zdXJlQWN0aXZlKCk7XG4gICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuICAgICAgICovXG4gICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG4gICAgICB9LFxuICAgICAgX3RyaW06IGZ1bmN0aW9uIChub3cpIHtcbiAgICAgICAgd2hpbGUgKHRoaXMucS5sZW5ndGggPiB0aGlzLmJ1ZmZlclNpemUpIHtcbiAgICAgICAgICB0aGlzLnEuc2hpZnQoKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodGhpcy5xLmxlbmd0aCA+IDAgJiYgKG5vdyAtIHRoaXMucVswXS5pbnRlcnZhbCkgPiB0aGlzLndpbmRvd1NpemUpIHtcbiAgICAgICAgICB0aGlzLnEuc2hpZnQoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBhcnJpdmFsIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG4gICAgICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuICAgICAgICovXG4gICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIHZhciBub3cgPSB0aGlzLnNjaGVkdWxlci5ub3coKTtcbiAgICAgICAgdGhpcy5xLnB1c2goeyBpbnRlcnZhbDogbm93LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgIHRoaXMuX3RyaW0obm93KTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBvc1tpXTtcbiAgICAgICAgICBvYnNlcnZlci5vbk5leHQodmFsdWUpO1xuICAgICAgICAgIG9ic2VydmVyLmVuc3VyZUFjdGl2ZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIFRoZSBleGNlcHRpb24gdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuICAgICAgICovXG4gICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG4gICAgICAgIHZhciBub3cgPSB0aGlzLnNjaGVkdWxlci5ub3coKTtcbiAgICAgICAgdGhpcy5fdHJpbShub3cpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBvc1tpXTtcbiAgICAgICAgICBvYnNlcnZlci5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgICBvYnNlcnZlci5lbnN1cmVBY3RpdmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuICAgICAgICovXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdmFyIG5vdyA9IHRoaXMuc2NoZWR1bGVyLm5vdygpO1xuICAgICAgICB0aGlzLl90cmltKG5vdyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIHZhciBvYnNlcnZlciA9IG9zW2ldO1xuICAgICAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgb2JzZXJ2ZXIuZW5zdXJlQWN0aXZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuICAgICAgICovXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBSZXBsYXlTdWJqZWN0O1xuICB9KE9ic2VydmFibGUpKTtcblxuICAvKipcbiAgKiBVc2VkIHRvIHBhdXNlIGFuZCByZXN1bWUgc3RyZWFtcy5cbiAgKi9cbiAgUnguUGF1c2VyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhQYXVzZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUGF1c2VyKCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgICAqL1xuICAgIFBhdXNlci5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7IHRoaXMub25OZXh0KGZhbHNlKTsgfTtcblxuICAgIC8qKlxuICAgICogUmVzdW1lcyB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cbiAgICAqL1xuICAgIFBhdXNlci5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgeyB0aGlzLm9uTmV4dCh0cnVlKTsgfTtcblxuICAgIHJldHVybiBQYXVzZXI7XG4gIH0oU3ViamVjdCkpO1xuXG4gIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGRlZmluZS5hbWQgPT0gJ29iamVjdCcgJiYgZGVmaW5lLmFtZCkge1xuICAgIHJvb3QuUnggPSBSeDtcblxuICAgIGRlZmluZShmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBSeDtcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlKSB7XG4gICAgLy8gaW4gTm9kZS5qcyBvciBSaW5nb0pTXG4gICAgaWYgKG1vZHVsZUV4cG9ydHMpIHtcbiAgICAgIChmcmVlTW9kdWxlLmV4cG9ydHMgPSBSeCkuUnggPSBSeDtcbiAgICB9IGVsc2Uge1xuICAgICAgZnJlZUV4cG9ydHMuUnggPSBSeDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gaW4gYSBicm93c2VyIG9yIFJoaW5vXG4gICAgcm9vdC5SeCA9IFJ4O1xuICB9XG5cbiAgLy8gQWxsIGNvZGUgYmVmb3JlIHRoaXMgcG9pbnQgd2lsbCBiZSBmaWx0ZXJlZCBmcm9tIHN0YWNrIHRyYWNlcy5cbiAgdmFyIHJFbmRpbmdMaW5lID0gY2FwdHVyZUxpbmUoKTtcblxufS5jYWxsKHRoaXMpKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2NsaW1iLXNvY2lhbC9+L3J4LWxpdGUvcngubGl0ZS5qc1xuICoqIG1vZHVsZSBpZCA9IDEyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikoKTtcbi8vIGltcG9ydHNcblxuXG4vLyBtb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcIi5jbGltYl9fd2FsbHt3aWR0aDoxMDAlO3BhZGRpbmc6MDttYXJnaW46MDstd2Via2l0LWp1c3RpZnktY29udGVudDpjZW50ZXI7LW1zLWZsZXgtcGFjazpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjstd2Via2l0LWZsZXgtZGlyZWN0aW9uOnJvdzstbXMtZmxleC1kaXJlY3Rpb246cm93O2ZsZXgtZGlyZWN0aW9uOnJvdzstd2Via2l0LWZsZXgtd3JhcDp3cmFwOy1tcy1mbGV4LXdyYXA6d3JhcDtmbGV4LXdyYXA6d3JhcDtmb250LXNpemU6MTAwJX0uY2xpbWJfX3RpbGUsLmNsaW1iX193YWxse2Rpc3BsYXk6LXdlYmtpdC1mbGV4O2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4fS5jbGltYl9fdGlsZXstd2Via2l0LWZsZXgtc2hyaW5rOjA7LW1zLWZsZXgtbmVnYXRpdmU6MDtmbGV4LXNocmluazowO2hlaWdodDo0MjVweDtib3gtc2l6aW5nOmJvcmRlci1ib3g7LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQ7LW1zLWZsZXgtcGFjazplbmQ7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kOy13ZWJraXQtZmxleC1kaXJlY3Rpb246Y29sdW1uOy1tcy1mbGV4LWRpcmVjdGlvbjpjb2x1bW47ZmxleC1kaXJlY3Rpb246Y29sdW1uO291dGxpbmU6MXB4IHNvbGlkIHRyYW5zcGFyZW50O21hcmdpbi1ib3R0b206MjBweDtvdmVyZmxvdzpoaWRkZW47dGV4dC1hbGlnbjpsZWZ0O2JvcmRlci1yYWRpdXM6N3B4O2JhY2tncm91bmQtY29sb3I6I2Y2ZjZmNjstd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVuO2JhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVuOy13ZWJraXQtcGVyc3BlY3RpdmU6MTAwMHB4O3BlcnNwZWN0aXZlOjEwMDBweH0uY2xpbWJfX3RpbGVfX2NvbnRlbnR7ei1pbmRleDoxO3BhZGRpbmc6MjZweDtiYWNrZ3JvdW5kLWNvbG9yOiNmNmY2ZjZ9LmNsaW1iX190aWxlLS1oYXMtbm8taW1hZ2UgLmNsaW1iX190aWxlX19jb250ZW50e2hlaWdodDoxMDAlO2Rpc3BsYXk6LXdlYmtpdC1mbGV4O2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4Oy13ZWJraXQtZmxleC1kaXJlY3Rpb246Y29sdW1uOy1tcy1mbGV4LWRpcmVjdGlvbjpjb2x1bW47ZmxleC1kaXJlY3Rpb246Y29sdW1uOy13ZWJraXQtanVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47LW1zLWZsZXgtcGFjazpqdXN0aWZ5O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2JveC1zaXppbmc6Ym9yZGVyLWJveH0uY2xpbWJfX3RpbGVfX2ltYWdle21heC13aWR0aDoxMDAlO3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2JvcmRlci10b3AtbGVmdC1yYWRpdXM6N3B4O2JvcmRlci10b3AtcmlnaHQtcmFkaXVzOjdweH0uY2xpbWJfX3RpbGVfX21lc3NhZ2V7ei1pbmRleDoxO21hcmdpbi1ib3R0b206MjRweH0uY2xpbWJfX3RpbGVfX21lc3NhZ2U+YXt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7bWF4LXdpZHRoOjI2MHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOmJvdHRvbX0uY2xpbWJfX3RpbGUtLWhhcy1uby1pbWFnZSAuY2xpbWJfX3RpbGVfX21lc3NhZ2V7Zm9udC1zaXplOjE4NSV9LmNsaW1iX190aWxlX19hdXRob3J7ZGlzcGxheTpibG9jazttYXJnaW46LTEwcHh9LmNsaW1iX190aWxlX19hdXRob3IgaW1ne2JvcmRlci1yYWRpdXM6MjVweDt3aWR0aDozNHB4fS5jbGltYl9fdGlsZV9fYXV0aG9yIC5jbGltYl9fdGlsZV9fYXV0aG9yX191c2VybmFtZXtkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW46MCAwIDAgMTBweDtsaW5lLWhlaWdodDozNHB4O3ZlcnRpY2FsLWFsaWduOnRvcH0uY2xpbWItYmFkZ2V7cG9zaXRpb246Zml4ZWQ7Ym90dG9tOjIwcHg7cmlnaHQ6MjBweDt6LWluZGV4Ojk7YmFja2dyb3VuZDojYTljYWUyIHVybChcIiArIHJlcXVpcmUoXCIuLi9pbWcvY2xpbWIuc29jaWFsX2xvZ28tLXNtYWxsLnBuZ1wiKSArIFwiKSBjZW50ZXIgY2VudGVyIG5vLXJlcGVhdDt3aWR0aDoyMDBweDtoZWlnaHQ6ODBweDtib3JkZXItcmFkaXVzOjVweH0uY2xpbWItYmFkZ2U+c3Bhbntwb3NpdGlvbjphYnNvbHV0ZSFpbXBvcnRhbnQ7dG9wOi05OTk5cHghaW1wb3J0YW50O2xlZnQ6LTk5OTlweCFpbXBvcnRhbnR9XCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vY3NzLWxvYWRlciEuL34vYXV0b3ByZWZpeGVyLWxvYWRlcj9icm93c2Vycz1sYXN0IDIgdmVyc2lvbiEuL34vc2Fzcy1sb2FkZXIhLi9zcmMvc3R5bGUvbWFpbi5zY3NzXG4gKiogbW9kdWxlIGlkID0gMTNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8qXHJcblx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuXHRBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXHJcbiovXHJcbi8vIGNzcyBiYXNlIGNvZGUsIGluamVjdGVkIGJ5IHRoZSBjc3MtbG9hZGVyXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIGxpc3QgPSBbXTtcclxuXHJcblx0Ly8gcmV0dXJuIHRoZSBsaXN0IG9mIG1vZHVsZXMgYXMgY3NzIHN0cmluZ1xyXG5cdGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcclxuXHRcdHZhciByZXN1bHQgPSBbXTtcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBpdGVtID0gdGhpc1tpXTtcclxuXHRcdFx0aWYoaXRlbVsyXSkge1xyXG5cdFx0XHRcdHJlc3VsdC5wdXNoKFwiQG1lZGlhIFwiICsgaXRlbVsyXSArIFwie1wiICsgaXRlbVsxXSArIFwifVwiKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRyZXN1bHQucHVzaChpdGVtWzFdKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHJlc3VsdC5qb2luKFwiXCIpO1xyXG5cdH07XHJcblxyXG5cdC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XHJcblx0bGlzdC5pID0gZnVuY3Rpb24obW9kdWxlcywgbWVkaWFRdWVyeSkge1xyXG5cdFx0aWYodHlwZW9mIG1vZHVsZXMgPT09IFwic3RyaW5nXCIpXHJcblx0XHRcdG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsIFwiXCJdXTtcclxuXHRcdHZhciBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzID0ge307XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaWQgPSB0aGlzW2ldWzBdO1xyXG5cdFx0XHRpZih0eXBlb2YgaWQgPT09IFwibnVtYmVyXCIpXHJcblx0XHRcdFx0YWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0Zm9yKGkgPSAwOyBpIDwgbW9kdWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaXRlbSA9IG1vZHVsZXNbaV07XHJcblx0XHRcdC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcclxuXHRcdFx0Ly8gdGhpcyBpbXBsZW1lbnRhdGlvbiBpcyBub3QgMTAwJSBwZXJmZWN0IGZvciB3ZWlyZCBtZWRpYSBxdWVyeSBjb21iaW5hdGlvbnNcclxuXHRcdFx0Ly8gIHdoZW4gYSBtb2R1bGUgaXMgaW1wb3J0ZWQgbXVsdGlwbGUgdGltZXMgd2l0aCBkaWZmZXJlbnQgbWVkaWEgcXVlcmllcy5cclxuXHRcdFx0Ly8gIEkgaG9wZSB0aGlzIHdpbGwgbmV2ZXIgb2NjdXIgKEhleSB0aGlzIHdheSB3ZSBoYXZlIHNtYWxsZXIgYnVuZGxlcylcclxuXHRcdFx0aWYodHlwZW9mIGl0ZW1bMF0gIT09IFwibnVtYmVyXCIgfHwgIWFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaXRlbVswXV0pIHtcclxuXHRcdFx0XHRpZihtZWRpYVF1ZXJ5ICYmICFpdGVtWzJdKSB7XHJcblx0XHRcdFx0XHRpdGVtWzJdID0gbWVkaWFRdWVyeTtcclxuXHRcdFx0XHR9IGVsc2UgaWYobWVkaWFRdWVyeSkge1xyXG5cdFx0XHRcdFx0aXRlbVsyXSA9IFwiKFwiICsgaXRlbVsyXSArIFwiKSBhbmQgKFwiICsgbWVkaWFRdWVyeSArIFwiKVwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRsaXN0LnB1c2goaXRlbSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9O1xyXG5cdHJldHVybiBsaXN0O1xyXG59O1xyXG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1xuICoqIG1vZHVsZSBpZCA9IDE0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFsnZXhwb3J0cycsICdtb2R1bGUnXSwgZmFjdG9yeSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgZmFjdG9yeShleHBvcnRzLCBtb2R1bGUpO1xuICB9IGVsc2Uge1xuICAgIHZhciBtb2QgPSB7XG4gICAgICBleHBvcnRzOiB7fVxuICAgIH07XG4gICAgZmFjdG9yeShtb2QuZXhwb3J0cywgbW9kKTtcbiAgICBnbG9iYWwuZmV0Y2hKc29ucCA9IG1vZC5leHBvcnRzO1xuICB9XG59KSh0aGlzLCBmdW5jdGlvbiAoZXhwb3J0cywgbW9kdWxlKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgdGltZW91dDogNTAwMCxcbiAgICBqc29ucENhbGxiYWNrOiAnY2FsbGJhY2snXG4gIH07XG5cbiAgZnVuY3Rpb24gZ2VuZXJhdGVDYWxsYmFja0Z1bmN0aW9uKCkge1xuICAgIHJldHVybiAnanNvbnBfJyArIERhdGUubm93KCkgKyAnXycgKyBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDEwMDAwMCk7XG4gIH1cblxuICAvLyBLbm93biBpc3N1ZTogV2lsbCB0aHJvdyAnVW5jYXVnaHQgUmVmZXJlbmNlRXJyb3I6IGNhbGxiYWNrXyoqKiBpcyBub3QgZGVmaW5lZCcgZXJyb3IgaWYgcmVxdWVzdCB0aW1lb3V0XG4gIGZ1bmN0aW9uIGNsZWFyRnVuY3Rpb24oZnVuY3Rpb25OYW1lKSB7XG4gICAgLy8gSUU4IHRocm93cyBhbiBleGNlcHRpb24gd2hlbiB5b3UgdHJ5IHRvIGRlbGV0ZSBhIHByb3BlcnR5IG9uIHdpbmRvd1xuICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzE4MjQyMjgvNzUxMDg5XG4gICAgdHJ5IHtcbiAgICAgIGRlbGV0ZSB3aW5kb3dbZnVuY3Rpb25OYW1lXTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB3aW5kb3dbZnVuY3Rpb25OYW1lXSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVTY3JpcHQoc2NyaXB0SWQpIHtcbiAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2NyaXB0SWQpO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICB9XG5cbiAgdmFyIGZldGNoSnNvbnAgPSBmdW5jdGlvbiBmZXRjaEpzb25wKHVybCkge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07XG5cbiAgICB2YXIgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCAhPSBudWxsID8gb3B0aW9ucy50aW1lb3V0IDogZGVmYXVsdE9wdGlvbnMudGltZW91dDtcbiAgICB2YXIganNvbnBDYWxsYmFjayA9IG9wdGlvbnMuanNvbnBDYWxsYmFjayAhPSBudWxsID8gb3B0aW9ucy5qc29ucENhbGxiYWNrIDogZGVmYXVsdE9wdGlvbnMuanNvbnBDYWxsYmFjaztcblxuICAgIHZhciB0aW1lb3V0SWQgPSB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIGNhbGxiYWNrRnVuY3Rpb24gPSBnZW5lcmF0ZUNhbGxiYWNrRnVuY3Rpb24oKTtcblxuICAgICAgd2luZG93W2NhbGxiYWNrRnVuY3Rpb25dID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIC8vIGtlZXAgY29uc2lzdGVudCB3aXRoIGZldGNoIEFQSVxuICAgICAgICAgIGpzb246IGZ1bmN0aW9uIGpzb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aW1lb3V0SWQpIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuXG4gICAgICAgIHJlbW92ZVNjcmlwdChqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbik7XG5cbiAgICAgICAgY2xlYXJGdW5jdGlvbihjYWxsYmFja0Z1bmN0aW9uKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoZSB1c2VyIHNldCB0aGVpciBvd24gcGFyYW1zLCBhbmQgaWYgbm90IGFkZCBhID8gdG8gc3RhcnQgYSBsaXN0IG9mIHBhcmFtc1xuICAgICAgdXJsICs9IHVybC5pbmRleE9mKCc/JykgPT09IC0xID8gJz8nIDogJyYnO1xuXG4gICAgICB2YXIganNvbnBTY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgIGpzb25wU2NyaXB0LnNldEF0dHJpYnV0ZShcInNyY1wiLCB1cmwgKyBqc29ucENhbGxiYWNrICsgJz0nICsgY2FsbGJhY2tGdW5jdGlvbik7XG4gICAgICBqc29ucFNjcmlwdC5pZCA9IGpzb25wQ2FsbGJhY2sgKyAnXycgKyBjYWxsYmFja0Z1bmN0aW9uO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLmFwcGVuZENoaWxkKGpzb25wU2NyaXB0KTtcblxuICAgICAgdGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0pTT05QIHJlcXVlc3QgdG8gJyArIHVybCArICcgdGltZWQgb3V0JykpO1xuXG4gICAgICAgIGNsZWFyRnVuY3Rpb24oY2FsbGJhY2tGdW5jdGlvbik7XG4gICAgICAgIHJlbW92ZVNjcmlwdChqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbik7XG4gICAgICB9LCB0aW1lb3V0KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBleHBvcnQgYXMgZ2xvYmFsIGZ1bmN0aW9uXG4gIC8qXG4gIGxldCBsb2NhbDtcbiAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWwgPSBnbG9iYWw7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWwgPSBzZWxmO1xuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICBsb2NhbCA9IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb2x5ZmlsbCBmYWlsZWQgYmVjYXVzZSBnbG9iYWwgb2JqZWN0IGlzIHVuYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKTtcbiAgICB9XG4gIH1cbiAgXG4gIGxvY2FsLmZldGNoSnNvbnAgPSBmZXRjaEpzb25wO1xuICAqL1xuXG4gIG1vZHVsZS5leHBvcnRzID0gZmV0Y2hKc29ucDtcbn0pO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2ZldGNoLWpzb25wL2J1aWxkL2ZldGNoLWpzb25wLmpzXG4gKiogbW9kdWxlIGlkID0gMTVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3B1YmxpY19wYXRoX18gKyBcImVhOTRjYmMzN2I3MGVlMGZjMjMyZTZhYjJmYTAwYTAyLnBuZ1wiXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9pbWcvY2xpbWIuc29jaWFsX2xvZ28tLXNtYWxsLnBuZ1xuICoqIG1vZHVsZSBpZCA9IDE2XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzWydkZWZhdWx0J10gPSBjb25maWdBbmltYXRpb247XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblxudmFyIF9wZXJmb3JtYW5jZU5vdyA9IHJlcXVpcmUoJ3BlcmZvcm1hbmNlLW5vdycpO1xuXG52YXIgX3BlcmZvcm1hbmNlTm93MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BlcmZvcm1hbmNlTm93KTtcblxudmFyIF9yYWYgPSByZXF1aXJlKCdyYWYnKTtcblxudmFyIF9yYWYyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmFmKTtcblxuZnVuY3Rpb24gY29uZmlnQW5pbWF0aW9uKCkge1xuICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMF07XG4gIHZhciBfY29uZmlnJHRpbWVTdGVwID0gY29uZmlnLnRpbWVTdGVwO1xuICB2YXIgdGltZVN0ZXAgPSBfY29uZmlnJHRpbWVTdGVwID09PSB1bmRlZmluZWQgPyAxIC8gNjAgKiAxMDAwIDogX2NvbmZpZyR0aW1lU3RlcDtcbiAgdmFyIF9jb25maWckdGltZVNjYWxlID0gY29uZmlnLnRpbWVTY2FsZTtcbiAgdmFyIHRpbWVTY2FsZSA9IF9jb25maWckdGltZVNjYWxlID09PSB1bmRlZmluZWQgPyAxIDogX2NvbmZpZyR0aW1lU2NhbGU7XG4gIHZhciBfY29uZmlnJG1heFN0ZXBzID0gY29uZmlnLm1heFN0ZXBzO1xuICB2YXIgbWF4U3RlcHMgPSBfY29uZmlnJG1heFN0ZXBzID09PSB1bmRlZmluZWQgPyAxMCA6IF9jb25maWckbWF4U3RlcHM7XG4gIHZhciBfY29uZmlnJHJhZiA9IGNvbmZpZy5yYWY7XG4gIHZhciByYWYgPSBfY29uZmlnJHJhZiA9PT0gdW5kZWZpbmVkID8gX3JhZjJbJ2RlZmF1bHQnXSA6IF9jb25maWckcmFmO1xuICB2YXIgX2NvbmZpZyRub3cgPSBjb25maWcubm93O1xuICB2YXIgbm93ID0gX2NvbmZpZyRub3cgPT09IHVuZGVmaW5lZCA/IF9wZXJmb3JtYW5jZU5vdzJbJ2RlZmF1bHQnXSA6IF9jb25maWckbm93O1xuXG4gIHZhciBhbmltUnVubmluZyA9IFtdO1xuICB2YXIgcnVubmluZyA9IGZhbHNlO1xuICB2YXIgcHJldlRpbWUgPSAwO1xuICB2YXIgYWNjdW11bGF0ZWRUaW1lID0gMDtcblxuICBmdW5jdGlvbiBsb29wKCkge1xuICAgIHZhciBjdXJyZW50VGltZSA9IG5vdygpO1xuICAgIHZhciBmcmFtZVRpbWUgPSBjdXJyZW50VGltZSAtIHByZXZUaW1lOyAvLyBkZWx0YVxuXG4gICAgcHJldlRpbWUgPSBjdXJyZW50VGltZTtcbiAgICBhY2N1bXVsYXRlZFRpbWUgKz0gZnJhbWVUaW1lICogdGltZVNjYWxlO1xuXG4gICAgaWYgKGFjY3VtdWxhdGVkVGltZSA+IHRpbWVTdGVwICogbWF4U3RlcHMpIHtcbiAgICAgIGFjY3VtdWxhdGVkVGltZSA9IDA7XG4gICAgfVxuXG4gICAgdmFyIGZyYW1lTnVtYmVyID0gTWF0aC5jZWlsKGFjY3VtdWxhdGVkVGltZSAvIHRpbWVTdGVwKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1SdW5uaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgX2FuaW1SdW5uaW5nJGkgPSBhbmltUnVubmluZ1tpXTtcbiAgICAgIHZhciBhY3RpdmUgPSBfYW5pbVJ1bm5pbmckaS5hY3RpdmU7XG4gICAgICB2YXIgYW5pbWF0aW9uU3RlcCA9IF9hbmltUnVubmluZyRpLmFuaW1hdGlvblN0ZXA7XG4gICAgICB2YXIgcHJldlByZXZTdGF0ZSA9IF9hbmltUnVubmluZyRpLnByZXZTdGF0ZTtcbiAgICAgIHZhciBwcmV2TmV4dFN0YXRlID0gYW5pbVJ1bm5pbmdbaV0ubmV4dFN0YXRlO1xuXG4gICAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gU2VlbXMgbGlrZSBiZWNhdXNlIHRoZSBUUyBzZXRzIGRlc3RWYWxzIGFzIGVudGVyVmFscyBmb3IgdGhlIGZpcnN0XG4gICAgICAvLyB0aWNrLCB3ZSBtaWdodCByZW5kZXIgdGhhdCB2YWx1ZSB0d2ljZS4gV2UgcmVuZGVyIGl0IG9uY2UsIGN1cnJWYWx1ZSBpc1xuICAgICAgLy8gZW50ZXJWYWwgYW5kIGRlc3RWYWwgaXMgZW50ZXJWYWwuIFRoZSBuZXh0IHRpY2sgaXMgZmFzdGVyIHRoYW4gMTZtcyxcbiAgICAgIC8vIHNvIGFjY3VtdWxhdGVkVGltZSAod2hpY2ggd291bGQgYmUgYWJvdXQgLTE2bXMgZnJvbSB0aGUgcHJldmlvdXMgdGljaylcbiAgICAgIC8vIGlzIG5lZ2F0aXZlICgtMTZtcyArIGFueSBudW1iZXIgbGVzcyB0aGFuIDE2bXMgPCAwKS4gU28gd2UganVzdCByZW5kZXJcbiAgICAgIC8vIHBhcnQgd2F5cyB0b3dhcmRzIHRoZSBuZXh0U3RhdGUsIGJ1dCB0aGF0J3MgZW50ZXJWYWwgc3RpbGwuIFdlIHJlbmRlclxuICAgICAgLy8gc2F5IDc1JSBiZXR3ZWVuIGN1cnJWYWx1ZSAoPT09IGVudGVyVmFsKSBhbmQgZGVzdFZhbHVlICg9PT0gZW50ZXJWYWwpLlxuICAgICAgLy8gU28gd2UgcmVuZGVyIHRoZSBzYW1lIHZhbHVlIGEgc2Vjb25kIHRpbWUuXG4gICAgICAvLyBUaGUgc29sdXRpb24gYmVsb3cgaXMgdG8gcmVjYWxjdWxhdGUgdGhlIGRlc3RpbmF0aW9uIHN0YXRlIGV2ZW4gd2hlblxuICAgICAgLy8geW91J3JlIG1vdmluZyBwYXJ0aWFsbHkgdG93YXJkcyBpdC5cbiAgICAgIGlmIChhY2N1bXVsYXRlZFRpbWUgPD0gMCkge1xuICAgICAgICBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGUgPSBhbmltYXRpb25TdGVwKHRpbWVTdGVwIC8gMTAwMCwgcHJldlByZXZTdGF0ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZyYW1lTnVtYmVyOyBqKyspIHtcbiAgICAgICAgICBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGUgPSBhbmltYXRpb25TdGVwKHRpbWVTdGVwIC8gMTAwMCwgcHJldk5leHRTdGF0ZSk7XG4gICAgICAgICAgdmFyIF9yZWYgPSBbcHJldk5leHRTdGF0ZSwgYW5pbVJ1bm5pbmdbaV0ubmV4dFN0YXRlXTtcbiAgICAgICAgICBhbmltUnVubmluZ1tpXS5wcmV2U3RhdGUgPSBfcmVmWzBdO1xuICAgICAgICAgIHByZXZOZXh0U3RhdGUgPSBfcmVmWzFdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgYWNjdW11bGF0ZWRUaW1lID0gYWNjdW11bGF0ZWRUaW1lIC0gZnJhbWVOdW1iZXIgKiB0aW1lU3RlcDtcblxuICAgIC8vIFJlbmRlciBhbmQgZmlsdGVyIGluIG9uZSBpdGVyYXRpb24uXG4gICAgdmFyIGFscGhhID0gMSArIGFjY3VtdWxhdGVkVGltZSAvIHRpbWVTdGVwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbVJ1bm5pbmcubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBfYW5pbVJ1bm5pbmckaTIgPSBhbmltUnVubmluZ1tpXTtcbiAgICAgIHZhciBhbmltYXRpb25SZW5kZXIgPSBfYW5pbVJ1bm5pbmckaTIuYW5pbWF0aW9uUmVuZGVyO1xuICAgICAgdmFyIG5leHRTdGF0ZSA9IF9hbmltUnVubmluZyRpMi5uZXh0U3RhdGU7XG4gICAgICB2YXIgcHJldlN0YXRlID0gX2FuaW1SdW5uaW5nJGkyLnByZXZTdGF0ZTtcblxuICAgICAgLy8gTWlnaHQgbXV0YXRlIGFuaW1SdW5uaW5nLi4uLi4uLi5cbiAgICAgIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpO1xuICAgIH1cblxuICAgIGFuaW1SdW5uaW5nID0gYW5pbVJ1bm5pbmcuZmlsdGVyKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgdmFyIGFjdGl2ZSA9IF9yZWYyLmFjdGl2ZTtcbiAgICAgIHJldHVybiBhY3RpdmU7XG4gICAgfSk7XG5cbiAgICBpZiAoYW5pbVJ1bm5pbmcubGVuZ3RoID09PSAwKSB7XG4gICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJhZihsb29wKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICBpZiAoIXJ1bm5pbmcpIHtcbiAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgcHJldlRpbWUgPSBub3coKTtcbiAgICAgIGFjY3VtdWxhdGVkVGltZSA9IDA7XG4gICAgICByYWYobG9vcCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW9uKHN0YXRlLCBhbmltYXRpb25TdGVwLCBhbmltYXRpb25SZW5kZXIpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1SdW5uaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdmFsID0gYW5pbVJ1bm5pbmdbaV07XG4gICAgICBpZiAodmFsLmFuaW1hdGlvblN0ZXAgPT09IGFuaW1hdGlvblN0ZXApIHtcbiAgICAgICAgdmFsLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhbC5wcmV2U3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgc3RhcnQoKTtcbiAgICAgICAgcmV0dXJuIHZhbC5zdG9wO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBuZXdBbmltID0ge1xuICAgICAgYW5pbWF0aW9uU3RlcDogYW5pbWF0aW9uU3RlcCxcbiAgICAgIGFuaW1hdGlvblJlbmRlcjogYW5pbWF0aW9uUmVuZGVyLFxuICAgICAgcHJldlN0YXRlOiBzdGF0ZSxcbiAgICAgIG5leHRTdGF0ZTogc3RhdGUsXG4gICAgICBhY3RpdmU6IHRydWVcbiAgICB9O1xuXG4gICAgbmV3QW5pbS5zdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG5ld0FuaW0uYWN0aXZlID0gZmFsc2U7XG4gICAgfTtcbiAgICBhbmltUnVubmluZy5wdXNoKG5ld0FuaW0pO1xuXG4gICAgc3RhcnQoKTtcblxuICAgIHJldHVybiBuZXdBbmltLnN0b3A7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvYW5pbWF0aW9uTG9vcC5qc1xuICoqIG1vZHVsZSBpZCA9IDE3XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbmV4cG9ydHNbJ2RlZmF1bHQnXSA9IGNvbXBvbmVudHM7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblxudmFyIF9ub1ZlbG9jaXR5ID0gcmVxdWlyZSgnLi9ub1ZlbG9jaXR5Jyk7XG5cbnZhciBfbm9WZWxvY2l0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ub1ZlbG9jaXR5KTtcblxudmFyIF9oYXNSZWFjaGVkU3R5bGUgPSByZXF1aXJlKCcuL2hhc1JlYWNoZWRTdHlsZScpO1xuXG52YXIgX2hhc1JlYWNoZWRTdHlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNSZWFjaGVkU3R5bGUpO1xuXG52YXIgX21lcmdlRGlmZiA9IHJlcXVpcmUoJy4vbWVyZ2VEaWZmJyk7XG5cbnZhciBfbWVyZ2VEaWZmMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lcmdlRGlmZik7XG5cbnZhciBfYW5pbWF0aW9uTG9vcCA9IHJlcXVpcmUoJy4vYW5pbWF0aW9uTG9vcCcpO1xuXG52YXIgX2FuaW1hdGlvbkxvb3AyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYW5pbWF0aW9uTG9vcCk7XG5cbnZhciBfemVybyA9IHJlcXVpcmUoJy4vemVybycpO1xuXG52YXIgX3plcm8yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfemVybyk7XG5cbnZhciBfdXBkYXRlVHJlZSA9IHJlcXVpcmUoJy4vdXBkYXRlVHJlZScpO1xuXG52YXIgX2RlcHJlY2F0ZWRTcHJpbmdzMiA9IHJlcXVpcmUoJy4vZGVwcmVjYXRlZFNwcmluZ3MnKTtcblxudmFyIF9kZXByZWNhdGVkU3ByaW5nczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZXByZWNhdGVkU3ByaW5nczIpO1xuXG52YXIgX3N0cmlwU3R5bGUgPSByZXF1aXJlKCcuL3N0cmlwU3R5bGUnKTtcblxudmFyIF9zdHJpcFN0eWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmlwU3R5bGUpO1xuXG52YXIgc3RhcnRBbmltYXRpb24gPSBfYW5pbWF0aW9uTG9vcDJbJ2RlZmF1bHQnXSgpO1xuXG5mdW5jdGlvbiBtYXBPYmplY3QoZiwgb2JqKSB7XG4gIHZhciByZXQgPSB7fTtcbiAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgIGlmICghb2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICByZXRba2V5XSA9IGYob2JqW2tleV0sIGtleSk7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gZXZlcnlPYmooZiwgb2JqKSB7XG4gIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICBpZiAoIW9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKCFmKG9ialtrZXldLCBrZXkpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBjb21wb25lbnRzKFJlYWN0KSB7XG4gIHZhciBQcm9wVHlwZXMgPSBSZWFjdC5Qcm9wVHlwZXM7XG5cbiAgdmFyIE1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBkaXNwbGF5TmFtZTogJ01vdGlvbicsXG5cbiAgICBwcm9wVHlwZXM6IHtcbiAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGEgY29uZmlnIGluIGhlcmVcbiAgICAgIGRlZmF1bHRWYWx1ZTogZnVuY3Rpb24gZGVmYXVsdFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1NwcmluZ1xcJ3MgYGRlZmF1bHRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgZGVmYXVsdFN0eWxlYC4gJyArICdJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpIGNoYW5nZXMgYXMgd2VsbC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGVuZFZhbHVlOiBmdW5jdGlvbiBlbmRWYWx1ZShwcm9wLCBwcm9wTmFtZSkge1xuICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdTcHJpbmdcXCdzIGBlbmRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgc3R5bGVgLiBJdHMgZm9ybWF0ICcgKyAncmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgY2hhbmdlcyBhcyB3ZWxsLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVmYXVsdFN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgICAgc3R5bGU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG4gICAgfSxcblxuICAgIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24gZ2V0SW5pdGlhbFN0YXRlKCkge1xuICAgICAgdmFyIF9wcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgICB2YXIgZGVmYXVsdFN0eWxlID0gX3Byb3BzLmRlZmF1bHRTdHlsZTtcbiAgICAgIHZhciBzdHlsZSA9IF9wcm9wcy5zdHlsZTtcblxuICAgICAgdmFyIGN1cnJlbnRTdHlsZSA9IGRlZmF1bHRTdHlsZSB8fCBzdHlsZTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGN1cnJlbnRTdHlsZTogY3VycmVudFN0eWxlLFxuICAgICAgICBjdXJyZW50VmVsb2NpdHk6IG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgY3VycmVudFN0eWxlKVxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuICAgIH0sXG5cbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKCkge1xuICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuICAgIH0sXG5cbiAgICBhbmltYXRpb25TdGVwOiBmdW5jdGlvbiBhbmltYXRpb25TdGVwKHRpbWVzdGVwLCBzdGF0ZSkge1xuICAgICAgdmFyIGN1cnJlbnRTdHlsZSA9IHN0YXRlLmN1cnJlbnRTdHlsZTtcbiAgICAgIHZhciBjdXJyZW50VmVsb2NpdHkgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdHk7XG4gICAgICB2YXIgc3R5bGUgPSB0aGlzLnByb3BzLnN0eWxlO1xuXG4gICAgICB2YXIgbmV3Q3VycmVudFN0eWxlID0gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFN0eWxlKHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpO1xuICAgICAgdmFyIG5ld0N1cnJlbnRWZWxvY2l0eSA9IF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRWZWxvY2l0eSh0aW1lc3RlcCwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdHksIHN0eWxlKTtcblxuICAgICAgLy8gVE9PRDogdGhpcyBpc24ndCBuZWNlc3NhcnkgYW55bW9yZS4gSXQgd2FzIHVzZWQgb25seSBhZ2FpbnN0IGVuZFZhbHVlIGZ1bmNcbiAgICAgIGlmIChfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXShjdXJyZW50VmVsb2NpdHksIG5ld0N1cnJlbnRTdHlsZSkgJiYgX25vVmVsb2NpdHkyWydkZWZhdWx0J10obmV3Q3VycmVudFZlbG9jaXR5LCBuZXdDdXJyZW50U3R5bGUpKSB7XG4gICAgICAgIC8vIGNoZWNrIGV4cGxhbmF0aW9uIGluIGBNb3Rpb24uYW5pbWF0aW9uUmVuZGVyYFxuICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTsgLy8gTmFzdHkgc2lkZSBlZmZlY3RzLi4uLlxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjdXJyZW50U3R5bGU6IG5ld0N1cnJlbnRTdHlsZSxcbiAgICAgICAgY3VycmVudFZlbG9jaXR5OiBuZXdDdXJyZW50VmVsb2NpdHlcbiAgICAgIH07XG4gICAgfSxcblxuICAgIHN0b3BBbmltYXRpb246IG51bGwsXG5cbiAgICAvLyB1c2VkIGluIGFuaW1hdGlvblJlbmRlclxuICAgIGhhc1VubW91bnRlZDogZmFsc2UsXG5cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcbiAgICAgIHRoaXMuaGFzVW5tb3VudGVkID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc3RhcnRBbmltYXRpbmc6IGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW5nKCkge1xuICAgICAgLy8gSXMgc21hcnQgZW5vdWdoIHRvIG5vdCBzdGFydCBpdCB0d2ljZVxuICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uID0gc3RhcnRBbmltYXRpb24odGhpcy5zdGF0ZSwgdGhpcy5hbmltYXRpb25TdGVwLCB0aGlzLmFuaW1hdGlvblJlbmRlcik7XG4gICAgfSxcblxuICAgIGFuaW1hdGlvblJlbmRlcjogZnVuY3Rpb24gYW5pbWF0aW9uUmVuZGVyKGFscGhhLCBuZXh0U3RhdGUsIHByZXZTdGF0ZSkge1xuICAgICAgLy8gYHRoaXMuaGFzVW5tb3VudGVkYCBtaWdodCBiZSB0cnVlIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uOlxuICAgICAgLy8gdXNlciBkb2VzIHNvbWUgY2hlY2tzIGluIGBzdHlsZWAgYW5kIGNhbGxzIGFuIG93bmVyIGhhbmRsZXJcbiAgICAgIC8vIG93bmVyIHNldHMgc3RhdGUgaW4gdGhlIGNhbGxiYWNrLCB0cmlnZ2VyaW5nIGEgcmUtcmVuZGVyXG4gICAgICAvLyB1bm1vdW50cyBNb3Rpb25cbiAgICAgIGlmICghdGhpcy5oYXNVbm1vdW50ZWQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgY3VycmVudFN0eWxlOiBfdXBkYXRlVHJlZS5pbnRlcnBvbGF0ZVZhbHVlKGFscGhhLCBuZXh0U3RhdGUuY3VycmVudFN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlKSxcbiAgICAgICAgICBjdXJyZW50VmVsb2NpdHk6IG5leHRTdGF0ZS5jdXJyZW50VmVsb2NpdHlcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSBfc3RyaXBTdHlsZTJbJ2RlZmF1bHQnXSh0aGlzLnN0YXRlLmN1cnJlbnRTdHlsZSk7XG4gICAgICB2YXIgcmVuZGVyZWRDaGlsZHJlbiA9IHRoaXMucHJvcHMuY2hpbGRyZW4oc3RyaXBwZWRTdHlsZSk7XG4gICAgICByZXR1cm4gcmVuZGVyZWRDaGlsZHJlbiAmJiBSZWFjdC5DaGlsZHJlbi5vbmx5KHJlbmRlcmVkQ2hpbGRyZW4pO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIFN0YWdnZXJlZE1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBkaXNwbGF5TmFtZTogJ1N0YWdnZXJlZE1vdGlvbicsXG5cbiAgICBwcm9wVHlwZXM6IHtcbiAgICAgIGRlZmF1bHRTdHlsZTogZnVuY3Rpb24gZGVmYXVsdFN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgU3RhZ2dlcmVkTW90aW9uYFxcJ3MgYGRlZmF1bHRTdHlsZXNgLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc3R5bGU6IGZ1bmN0aW9uIHN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgU3RhZ2dlcmVkTW90aW9uYFxcJ3MgYHN0eWxlc2AuJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvLyBUT09EOiB3YXJuIGFnYWluc3QgcHV0dGluZyBjb25maWdzIGluIGhlcmVcbiAgICAgIGRlZmF1bHRTdHlsZXM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5vYmplY3QpLFxuICAgICAgc3R5bGVzOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgY2hpbGRyZW46IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWRcbiAgICB9LFxuXG4gICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgICB2YXIgX3Byb3BzMiA9IHRoaXMucHJvcHM7XG4gICAgICB2YXIgc3R5bGVzID0gX3Byb3BzMi5zdHlsZXM7XG4gICAgICB2YXIgZGVmYXVsdFN0eWxlcyA9IF9wcm9wczIuZGVmYXVsdFN0eWxlcztcblxuICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBkZWZhdWx0U3R5bGVzID8gZGVmYXVsdFN0eWxlcyA6IHN0eWxlcygpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY3VycmVudFN0eWxlczogY3VycmVudFN0eWxlcyxcbiAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IGN1cnJlbnRTdHlsZXMubWFwKGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgcyk7XG4gICAgICAgIH0pXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGFuaW1hdGlvblN0ZXA6IGZ1bmN0aW9uIGFuaW1hdGlvblN0ZXAodGltZXN0ZXAsIHN0YXRlKSB7XG4gICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHN0YXRlLmN1cnJlbnRTdHlsZXM7XG4gICAgICB2YXIgY3VycmVudFZlbG9jaXRpZXMgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdGllcztcblxuICAgICAgdmFyIHN0eWxlcyA9IHRoaXMucHJvcHMuc3R5bGVzKGN1cnJlbnRTdHlsZXMubWFwKF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddKSk7XG5cbiAgICAgIHZhciBuZXdDdXJyZW50U3R5bGVzID0gY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKGN1cnJlbnRTdHlsZSwgaSkge1xuICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFN0eWxlKHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0aWVzW2ldLCBzdHlsZXNbaV0pO1xuICAgICAgfSk7XG4gICAgICB2YXIgbmV3Q3VycmVudFZlbG9jaXRpZXMgPSBjdXJyZW50U3R5bGVzLm1hcChmdW5jdGlvbiAoY3VycmVudFN0eWxlLCBpKSB7XG4gICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50VmVsb2NpdHkodGltZXN0ZXAsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXRpZXNbaV0sIHN0eWxlc1tpXSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVE9ETzogaXMgdGhpcyByaWdodD9cbiAgICAgIGlmIChjdXJyZW50VmVsb2NpdGllcy5ldmVyeShmdW5jdGlvbiAodiwgaykge1xuICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgY3VycmVudFN0eWxlc1trXSk7XG4gICAgICB9KSAmJiBuZXdDdXJyZW50VmVsb2NpdGllcy5ldmVyeShmdW5jdGlvbiAodiwgaykge1xuICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgbmV3Q3VycmVudFN0eWxlc1trXSk7XG4gICAgICB9KSkge1xuICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY3VycmVudFN0eWxlczogbmV3Q3VycmVudFN0eWxlcyxcbiAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5ld0N1cnJlbnRWZWxvY2l0aWVzXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBzdG9wQW5pbWF0aW9uOiBudWxsLFxuXG4gICAgLy8gdXNlZCBpbiBhbmltYXRpb25SZW5kZXJcbiAgICBoYXNVbm1vdW50ZWQ6IGZhbHNlLFxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG4gICAgICB0aGlzLmhhc1VubW91bnRlZCA9IHRydWU7XG4gICAgfSxcblxuICAgIHN0YXJ0QW5pbWF0aW5nOiBmdW5jdGlvbiBzdGFydEFuaW1hdGluZygpIHtcbiAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbiA9IHN0YXJ0QW5pbWF0aW9uKHRoaXMuc3RhdGUsIHRoaXMuYW5pbWF0aW9uU3RlcCwgdGhpcy5hbmltYXRpb25SZW5kZXIpO1xuICAgIH0sXG5cbiAgICBhbmltYXRpb25SZW5kZXI6IGZ1bmN0aW9uIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpIHtcbiAgICAgIC8vIFNlZSBjb21tZW50IGluIE1vdGlvbi5cbiAgICAgIGlmICghdGhpcy5oYXNVbm1vdW50ZWQpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBuZXh0U3RhdGUuY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKHN0eWxlLCBpKSB7XG4gICAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLmludGVycG9sYXRlVmFsdWUoYWxwaGEsIHN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlc1tpXSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuICAgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXh0U3RhdGUuY3VycmVudFZlbG9jaXRpZXNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSB0aGlzLnN0YXRlLmN1cnJlbnRTdHlsZXMubWFwKF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddKTtcbiAgICAgIHZhciByZW5kZXJlZENoaWxkcmVuID0gdGhpcy5wcm9wcy5jaGlsZHJlbihzdHJpcHBlZFN0eWxlKTtcbiAgICAgIHJldHVybiByZW5kZXJlZENoaWxkcmVuICYmIFJlYWN0LkNoaWxkcmVuLm9ubHkocmVuZGVyZWRDaGlsZHJlbik7XG4gICAgfVxuICB9KTtcblxuICB2YXIgVHJhbnNpdGlvbk1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBkaXNwbGF5TmFtZTogJ1RyYW5zaXRpb25Nb3Rpb24nLFxuXG4gICAgcHJvcFR5cGVzOiB7XG4gICAgICBkZWZhdWx0VmFsdWU6IGZ1bmN0aW9uIGRlZmF1bHRWYWx1ZShwcm9wLCBwcm9wTmFtZSkge1xuICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdUcmFuc2l0aW9uU3ByaW5nXFwncyBgZGVmYXVsdFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvICcgKyAnYGRlZmF1bHRTdHlsZXNgLiBJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpICcgKyAnY2hhbmdlcyBhcyB3ZWxsLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZW5kVmFsdWU6IGZ1bmN0aW9uIGVuZFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1RyYW5zaXRpb25TcHJpbmdcXCdzIGBlbmRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgc3R5bGVzYC4gJyArICdJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpIGNoYW5nZXMgYXMgd2VsbC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlZmF1bHRTdHlsZTogZnVuY3Rpb24gZGVmYXVsdFN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgVHJhbnNpdGlvbk1vdGlvbmBcXCdzIGBkZWZhdWx0U3R5bGVzYC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShwcm9wLCBwcm9wTmFtZSkge1xuICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdZb3UgZm9yZ290IHRoZSBcInNcIiBmb3IgYFRyYW5zaXRpb25Nb3Rpb25gXFwncyBgc3R5bGVzYC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGNvbmZpZ3MgaW4gaGVyZVxuICAgICAgZGVmYXVsdFN0eWxlczogUHJvcFR5cGVzLm9iamVjdE9mKFByb3BUeXBlcy5hbnkpLFxuICAgICAgc3R5bGVzOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuYywgUHJvcFR5cGVzLm9iamVjdE9mKFByb3BUeXBlcy5hbnkuaXNSZXF1aXJlZCldKS5pc1JlcXVpcmVkLFxuICAgICAgd2lsbExlYXZlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuY10pLFxuICAgICAgLy8gVE9PRDogd2FybiBhZ2FpbnN0IHB1dHRpbmcgY29uZmlncyBpbiBoZXJlXG4gICAgICB3aWxsRW50ZXI6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5mdW5jXSksXG4gICAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxuICAgIH0sXG5cbiAgICBnZXREZWZhdWx0UHJvcHM6IGZ1bmN0aW9uIGdldERlZmF1bHRQcm9wcygpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdpbGxFbnRlcjogZnVuY3Rpb24gd2lsbEVudGVyKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIHdpbGxMZWF2ZTogZnVuY3Rpb24gd2lsbExlYXZlKCkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcbiAgICAgIHZhciBfcHJvcHMzID0gdGhpcy5wcm9wcztcbiAgICAgIHZhciBzdHlsZXMgPSBfcHJvcHMzLnN0eWxlcztcbiAgICAgIHZhciBkZWZhdWx0U3R5bGVzID0gX3Byb3BzMy5kZWZhdWx0U3R5bGVzO1xuXG4gICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHVuZGVmaW5lZDtcbiAgICAgIGlmIChkZWZhdWx0U3R5bGVzID09IG51bGwpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzdHlsZXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBjdXJyZW50U3R5bGVzID0gc3R5bGVzKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3VycmVudFN0eWxlcyA9IHN0eWxlcztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudFN0eWxlcyA9IGRlZmF1bHRTdHlsZXM7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuICAgICAgICBjdXJyZW50VmVsb2NpdGllczogbWFwT2JqZWN0KGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgcyk7XG4gICAgICAgIH0sIGN1cnJlbnRTdHlsZXMpXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGFuaW1hdGlvblN0ZXA6IGZ1bmN0aW9uIGFuaW1hdGlvblN0ZXAodGltZXN0ZXAsIHN0YXRlKSB7XG4gICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHN0YXRlLmN1cnJlbnRTdHlsZXM7XG4gICAgICB2YXIgY3VycmVudFZlbG9jaXRpZXMgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdGllcztcbiAgICAgIHZhciBfcHJvcHM0ID0gdGhpcy5wcm9wcztcbiAgICAgIHZhciBzdHlsZXMgPSBfcHJvcHM0LnN0eWxlcztcbiAgICAgIHZhciB3aWxsRW50ZXIgPSBfcHJvcHM0LndpbGxFbnRlcjtcbiAgICAgIHZhciB3aWxsTGVhdmUgPSBfcHJvcHM0LndpbGxMZWF2ZTtcblxuICAgICAgaWYgKHR5cGVvZiBzdHlsZXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgc3R5bGVzID0gc3R5bGVzKGN1cnJlbnRTdHlsZXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBUT0RPOiBodWg/XG4gICAgICB2YXIgbWVyZ2VkU3R5bGVzID0gc3R5bGVzOyAvLyBzZXQgbWVyZ2VkU3R5bGVzIHRvIHN0eWxlcyBhcyB0aGUgZGVmYXVsdFxuICAgICAgdmFyIGhhc05ld0tleSA9IGZhbHNlO1xuXG4gICAgICBtZXJnZWRTdHlsZXMgPSBfbWVyZ2VEaWZmMlsnZGVmYXVsdCddKGN1cnJlbnRTdHlsZXMsIHN0eWxlcyxcbiAgICAgIC8vIFRPRE86IHN0b3AgYWxsb2NhdGluZyBsaWtlIGNyYXp5IGluIHRoaXMgd2hvbGUgY29kZSBwYXRoXG4gICAgICBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHZhciByZXMgPSB3aWxsTGVhdmUoa2V5LCBjdXJyZW50U3R5bGVzW2tleV0sIHN0eWxlcywgY3VycmVudFN0eWxlcywgY3VycmVudFZlbG9jaXRpZXMpO1xuICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAvLyBGb3IgbGVnYWN5IHJlYXNvbi4gV2Ugd29uJ3QgYWxsb3cgcmV0dXJuaW5nIG51bGwgc29vblxuICAgICAgICAgIC8vIFRPRE86IHJlbW92ZSwgYWZ0ZXIgbmV4dCByZWxlYXNlXG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoX25vVmVsb2NpdHkyWydkZWZhdWx0J10oY3VycmVudFZlbG9jaXRpZXNba2V5XSwgY3VycmVudFN0eWxlc1trZXldKSAmJiBfaGFzUmVhY2hlZFN0eWxlMlsnZGVmYXVsdCddKGN1cnJlbnRTdHlsZXNba2V5XSwgcmVzKSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgICB9KTtcblxuICAgICAgT2JqZWN0LmtleXMobWVyZ2VkU3R5bGVzKS5maWx0ZXIoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4gIWN1cnJlbnRTdHlsZXMuaGFzT3duUHJvcGVydHkoa2V5KTtcbiAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICB2YXIgX2V4dGVuZHMyLCBfZXh0ZW5kczM7XG5cbiAgICAgICAgaGFzTmV3S2V5ID0gdHJ1ZTtcbiAgICAgICAgdmFyIGVudGVyU3R5bGUgPSB3aWxsRW50ZXIoa2V5LCBtZXJnZWRTdHlsZXNba2V5XSwgc3R5bGVzLCBjdXJyZW50U3R5bGVzLCBjdXJyZW50VmVsb2NpdGllcyk7XG5cbiAgICAgICAgLy8gV2UgY2FuIG11dGF0ZSB0aGlzIGhlcmUgYmVjYXVzZSBtZXJnZURpZmYgcmV0dXJucyBhIG5ldyBPYmpcbiAgICAgICAgbWVyZ2VkU3R5bGVzW2tleV0gPSBlbnRlclN0eWxlO1xuXG4gICAgICAgIGN1cnJlbnRTdHlsZXMgPSBfZXh0ZW5kcyh7fSwgY3VycmVudFN0eWxlcywgKF9leHRlbmRzMiA9IHt9LCBfZXh0ZW5kczJba2V5XSA9IGVudGVyU3R5bGUsIF9leHRlbmRzMikpO1xuICAgICAgICBjdXJyZW50VmVsb2NpdGllcyA9IF9leHRlbmRzKHt9LCBjdXJyZW50VmVsb2NpdGllcywgKF9leHRlbmRzMyA9IHt9LCBfZXh0ZW5kczNba2V5XSA9IG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgZW50ZXJTdHlsZSksIF9leHRlbmRzMykpO1xuICAgICAgfSk7XG5cbiAgICAgIHZhciBuZXdDdXJyZW50U3R5bGVzID0gbWFwT2JqZWN0KGZ1bmN0aW9uIChtZXJnZWRTdHlsZSwga2V5KSB7XG4gICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50U3R5bGUodGltZXN0ZXAsIGN1cnJlbnRTdHlsZXNba2V5XSwgY3VycmVudFZlbG9jaXRpZXNba2V5XSwgbWVyZ2VkU3R5bGUpO1xuICAgICAgfSwgbWVyZ2VkU3R5bGVzKTtcbiAgICAgIHZhciBuZXdDdXJyZW50VmVsb2NpdGllcyA9IG1hcE9iamVjdChmdW5jdGlvbiAobWVyZ2VkU3R5bGUsIGtleSkge1xuICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFZlbG9jaXR5KHRpbWVzdGVwLCBjdXJyZW50U3R5bGVzW2tleV0sIGN1cnJlbnRWZWxvY2l0aWVzW2tleV0sIG1lcmdlZFN0eWxlKTtcbiAgICAgIH0sIG1lcmdlZFN0eWxlcyk7XG5cbiAgICAgIGlmICghaGFzTmV3S2V5ICYmIGV2ZXJ5T2JqKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBjdXJyZW50U3R5bGVzW2tdKTtcbiAgICAgIH0sIGN1cnJlbnRWZWxvY2l0aWVzKSAmJiBldmVyeU9iaihmdW5jdGlvbiAodiwgaykge1xuICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgbmV3Q3VycmVudFN0eWxlc1trXSk7XG4gICAgICB9LCBuZXdDdXJyZW50VmVsb2NpdGllcykpIHtcbiAgICAgICAgLy8gY2hlY2sgZXhwbGFuYXRpb24gaW4gYE1vdGlvbi5hbmltYXRpb25SZW5kZXJgXG4gICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpOyAvLyBOYXN0eSBzaWRlIGVmZmVjdHMuLi4uXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGN1cnJlbnRTdHlsZXM6IG5ld0N1cnJlbnRTdHlsZXMsXG4gICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXdDdXJyZW50VmVsb2NpdGllc1xuICAgICAgfTtcbiAgICB9LFxuXG4gICAgc3RvcEFuaW1hdGlvbjogbnVsbCxcblxuICAgIC8vIHVzZWQgaW4gYW5pbWF0aW9uUmVuZGVyXG4gICAgaGFzVW5tb3VudGVkOiBmYWxzZSxcblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuICAgICAgdGhpcy5oYXNVbm1vdW50ZWQgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBzdGFydEFuaW1hdGluZzogZnVuY3Rpb24gc3RhcnRBbmltYXRpbmcoKSB7XG4gICAgICB0aGlzLnN0b3BBbmltYXRpb24gPSBzdGFydEFuaW1hdGlvbih0aGlzLnN0YXRlLCB0aGlzLmFuaW1hdGlvblN0ZXAsIHRoaXMuYW5pbWF0aW9uUmVuZGVyKTtcbiAgICB9LFxuXG4gICAgYW5pbWF0aW9uUmVuZGVyOiBmdW5jdGlvbiBhbmltYXRpb25SZW5kZXIoYWxwaGEsIG5leHRTdGF0ZSwgcHJldlN0YXRlKSB7XG4gICAgICAvLyBTZWUgY29tbWVudCBpbiBNb3Rpb24uXG4gICAgICBpZiAoIXRoaXMuaGFzVW5tb3VudGVkKSB7XG4gICAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gbWFwT2JqZWN0KGZ1bmN0aW9uIChzdHlsZSwga2V5KSB7XG4gICAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLmludGVycG9sYXRlVmFsdWUoYWxwaGEsIHN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlc1trZXldKTtcbiAgICAgICAgfSwgbmV4dFN0YXRlLmN1cnJlbnRTdHlsZXMpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuICAgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXh0U3RhdGUuY3VycmVudFZlbG9jaXRpZXNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSBtYXBPYmplY3QoX3N0cmlwU3R5bGUyWydkZWZhdWx0J10sIHRoaXMuc3RhdGUuY3VycmVudFN0eWxlcyk7XG4gICAgICB2YXIgcmVuZGVyZWRDaGlsZHJlbiA9IHRoaXMucHJvcHMuY2hpbGRyZW4oc3RyaXBwZWRTdHlsZSk7XG4gICAgICByZXR1cm4gcmVuZGVyZWRDaGlsZHJlbiAmJiBSZWFjdC5DaGlsZHJlbi5vbmx5KHJlbmRlcmVkQ2hpbGRyZW4pO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIF9kZXByZWNhdGVkU3ByaW5ncyA9IF9kZXByZWNhdGVkU3ByaW5nczNbJ2RlZmF1bHQnXShSZWFjdCk7XG5cbiAgdmFyIFNwcmluZyA9IF9kZXByZWNhdGVkU3ByaW5ncy5TcHJpbmc7XG4gIHZhciBUcmFuc2l0aW9uU3ByaW5nID0gX2RlcHJlY2F0ZWRTcHJpbmdzLlRyYW5zaXRpb25TcHJpbmc7XG5cbiAgcmV0dXJuIHsgU3ByaW5nOiBTcHJpbmcsIFRyYW5zaXRpb25TcHJpbmc6IFRyYW5zaXRpb25TcHJpbmcsIE1vdGlvbjogTW90aW9uLCBTdGFnZ2VyZWRNb3Rpb246IFN0YWdnZXJlZE1vdGlvbiwgVHJhbnNpdGlvbk1vdGlvbjogVHJhbnNpdGlvbk1vdGlvbiB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL2NvbXBvbmVudHMuanNcbiAqKiBtb2R1bGUgaWQgPSAxOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1snZGVmYXVsdCddID0gZGVwcmVjYXRlZFNwcmluZ3M7XG52YXIgaGFzV2FybmVkRm9yU3ByaW5nID0ge307XG52YXIgaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZyA9IHt9O1xuXG5mdW5jdGlvbiBkZXByZWNhdGVkU3ByaW5ncyhSZWFjdCkge1xuICB2YXIgU3ByaW5nID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICAgIGRpc3BsYXlOYW1lOiAnU3ByaW5nJyxcblxuICAgIGNvbXBvbmVudFdpbGxNb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICAgIHZhciBvd25lck5hbWUgPSB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lciAmJiB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lci5nZXROYW1lKCk7XG4gICAgICAgIGlmICghaGFzV2FybmVkRm9yU3ByaW5nW293bmVyTmFtZV0pIHtcbiAgICAgICAgICBoYXNXYXJuZWRGb3JTcHJpbmdbb3duZXJOYW1lXSA9IHRydWU7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignU3ByaW5nICh1c2VkIGluICVzcmVuZGVyKSBoYXMgbm93IGJlZW4gcmVuYW1lZCB0byBNb3Rpb24uICcgKyAnUGxlYXNlIHNlZSB0aGUgcmVsZWFzZSBub3RlIGZvciB0aGUgdXBncmFkZSBwYXRoLiBUaGFuayB5b3UhJywgb3duZXJOYW1lID8gb3duZXJOYW1lICsgJ1xcJ3MgJyA6ICdSZWFjdC4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIFRyYW5zaXRpb25TcHJpbmcgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gICAgZGlzcGxheU5hbWU6ICdUcmFuc2l0aW9uU3ByaW5nJyxcblxuICAgIGNvbXBvbmVudFdpbGxNb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICAgIHZhciBvd25lck5hbWUgPSB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lciAmJiB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lci5nZXROYW1lKCk7XG4gICAgICAgIGlmICghaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZ1tvd25lck5hbWVdKSB7XG4gICAgICAgICAgaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZ1tvd25lck5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdUcmFuc2l0aW9uU3ByaW5nICh1c2VkIGluICVzcmVuZGVyKSBoYXMgbm93IGJlZW4gcmVuYW1lZCB0byAnICsgJ1RyYW5zaXRpb25Nb3Rpb24uIFBsZWFzZSBzZWUgdGhlIHJlbGVhc2Ugbm90ZSBmb3IgdGhlIHVwZ3JhZGUgJyArICdwYXRoLiBUaGFuayB5b3UhJywgb3duZXJOYW1lID8gb3duZXJOYW1lICsgJ1xcJ3MgJyA6ICdSZWFjdC4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHsgU3ByaW5nOiBTcHJpbmcsIFRyYW5zaXRpb25TcHJpbmc6IFRyYW5zaXRpb25TcHJpbmcgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9kZXByZWNhdGVkU3ByaW5ncy5qc1xuICoqIG1vZHVsZSBpZCA9IDE5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gaGFzUmVhY2hlZFN0eWxlO1xuXG5mdW5jdGlvbiBoYXNSZWFjaGVkU3R5bGUoY3VycmVudFN0eWxlLCBzdHlsZSkge1xuICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcbiAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB2YXIgY3VycmVudFZhbHVlID0gY3VycmVudFN0eWxlW2tleV07XG4gICAgdmFyIGRlc3RWYWx1ZSA9IHN0eWxlW2tleV07XG4gICAgaWYgKCFkZXN0VmFsdWUuY29uZmlnKSB7XG4gICAgICAvLyBub3QgYSBzcHJpbmcgY29uZmlnXG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGN1cnJlbnRWYWx1ZS5jb25maWcgJiYgY3VycmVudFZhbHVlLnZhbCAhPT0gZGVzdFZhbHVlLnZhbCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoIWN1cnJlbnRWYWx1ZS5jb25maWcgJiYgY3VycmVudFZhbHVlICE9PSBkZXN0VmFsdWUudmFsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9oYXNSZWFjaGVkU3R5bGUuanNcbiAqKiBtb2R1bGUgaWQgPSAyMFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gdGhpcyBmdW5jdGlvbiBpcyBhbGxvY2F0aW9uLWxlc3MgdGhhbmtzIHRvIGJhYmVsLCB3aGljaCB0cmFuc2Zvcm1zIHRoZSB0YWlsXG4vLyBjYWxscyBpbnRvIGxvb3BzXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gbWVyZ2VEaWZmO1xuZnVuY3Rpb24gbWVyZ2VEaWZmQXJyKF94LCBfeDIsIF94MywgX3g0LCBfeDUsIF94NiwgX3g3KSB7XG4gIHZhciBfYWdhaW4gPSB0cnVlO1xuXG4gIF9mdW5jdGlvbjogd2hpbGUgKF9hZ2Fpbikge1xuICAgIHZhciBhcnJBID0gX3gsXG4gICAgICAgIGFyckIgPSBfeDIsXG4gICAgICAgIGNvbGxCID0gX3gzLFxuICAgICAgICBpbmRleEEgPSBfeDQsXG4gICAgICAgIGluZGV4QiA9IF94NSxcbiAgICAgICAgb25SZW1vdmUgPSBfeDYsXG4gICAgICAgIGFjY3VtID0gX3g3O1xuICAgIGVuZEEgPSBlbmRCID0ga2V5QSA9IGtleUIgPSBmaWxsID0gZmlsbCA9IHVuZGVmaW5lZDtcbiAgICBfYWdhaW4gPSBmYWxzZTtcblxuICAgIHZhciBlbmRBID0gaW5kZXhBID09PSBhcnJBLmxlbmd0aDtcbiAgICB2YXIgZW5kQiA9IGluZGV4QiA9PT0gYXJyQi5sZW5ndGg7XG4gICAgdmFyIGtleUEgPSBhcnJBW2luZGV4QV07XG4gICAgdmFyIGtleUIgPSBhcnJCW2luZGV4Ql07XG4gICAgaWYgKGVuZEEgJiYgZW5kQikge1xuICAgICAgLy8gcmV0dXJuaW5nIG51bGwgaGVyZSwgb3RoZXJ3aXNlIGxpbnQgY29tcGxhaW5zIHRoYXQgd2UncmUgbm90IGV4cGVjdGluZ1xuICAgICAgLy8gYSByZXR1cm4gdmFsdWUgaW4gc3Vic2VxdWVudCBjYWxscy4gV2Uga25vdyB3aGF0IHdlJ3JlIGRvaW5nLlxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGVuZEEpIHtcbiAgICAgIGFjY3VtW2tleUJdID0gY29sbEJba2V5Ql07XG4gICAgICBfeCA9IGFyckE7XG4gICAgICBfeDIgPSBhcnJCO1xuICAgICAgX3gzID0gY29sbEI7XG4gICAgICBfeDQgPSBpbmRleEE7XG4gICAgICBfeDUgPSBpbmRleEIgKyAxO1xuICAgICAgX3g2ID0gb25SZW1vdmU7XG4gICAgICBfeDcgPSBhY2N1bTtcbiAgICAgIF9hZ2FpbiA9IHRydWU7XG4gICAgICBjb250aW51ZSBfZnVuY3Rpb247XG4gICAgfVxuXG4gICAgaWYgKGVuZEIpIHtcbiAgICAgIHZhciBmaWxsID0gb25SZW1vdmUoa2V5QSk7XG4gICAgICBpZiAoZmlsbCAhPSBudWxsKSB7XG4gICAgICAgIGFjY3VtW2tleUFdID0gZmlsbDtcbiAgICAgIH1cbiAgICAgIF94ID0gYXJyQTtcbiAgICAgIF94MiA9IGFyckI7XG4gICAgICBfeDMgPSBjb2xsQjtcbiAgICAgIF94NCA9IGluZGV4QSArIDE7XG4gICAgICBfeDUgPSBpbmRleEI7XG4gICAgICBfeDYgPSBvblJlbW92ZTtcbiAgICAgIF94NyA9IGFjY3VtO1xuICAgICAgX2FnYWluID0gdHJ1ZTtcbiAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcbiAgICB9XG5cbiAgICBpZiAoa2V5QSA9PT0ga2V5Qikge1xuICAgICAgYWNjdW1ba2V5QV0gPSBjb2xsQltrZXlBXTtcbiAgICAgIF94ID0gYXJyQTtcbiAgICAgIF94MiA9IGFyckI7XG4gICAgICBfeDMgPSBjb2xsQjtcbiAgICAgIF94NCA9IGluZGV4QSArIDE7XG4gICAgICBfeDUgPSBpbmRleEIgKyAxO1xuICAgICAgX3g2ID0gb25SZW1vdmU7XG4gICAgICBfeDcgPSBhY2N1bTtcbiAgICAgIF9hZ2FpbiA9IHRydWU7XG4gICAgICBjb250aW51ZSBfZnVuY3Rpb247XG4gICAgfVxuXG4gICAgaWYgKCFjb2xsQi5oYXNPd25Qcm9wZXJ0eShrZXlBKSkge1xuICAgICAgdmFyIGZpbGwgPSBvblJlbW92ZShrZXlBKTtcbiAgICAgIGlmIChmaWxsICE9IG51bGwpIHtcbiAgICAgICAgYWNjdW1ba2V5QV0gPSBmaWxsO1xuICAgICAgfVxuICAgICAgX3ggPSBhcnJBO1xuICAgICAgX3gyID0gYXJyQjtcbiAgICAgIF94MyA9IGNvbGxCO1xuICAgICAgX3g0ID0gaW5kZXhBICsgMTtcbiAgICAgIF94NSA9IGluZGV4QjtcbiAgICAgIF94NiA9IG9uUmVtb3ZlO1xuICAgICAgX3g3ID0gYWNjdW07XG4gICAgICBfYWdhaW4gPSB0cnVlO1xuICAgICAgY29udGludWUgX2Z1bmN0aW9uO1xuICAgIH1cblxuICAgIF94ID0gYXJyQTtcbiAgICBfeDIgPSBhcnJCO1xuICAgIF94MyA9IGNvbGxCO1xuICAgIF94NCA9IGluZGV4QSArIDE7XG4gICAgX3g1ID0gaW5kZXhCO1xuICAgIF94NiA9IG9uUmVtb3ZlO1xuICAgIF94NyA9IGFjY3VtO1xuICAgIF9hZ2FpbiA9IHRydWU7XG4gICAgY29udGludWUgX2Z1bmN0aW9uO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1lcmdlRGlmZihhLCBiLCBvblJlbW92ZSkge1xuICB2YXIgcmV0ID0ge307XG4gIC8vIGlmIGFueW9uZSBjYW4gbWFrZSB0aGlzIHdvcmsgd2l0aG91dCBhbGxvY2F0aW5nIHRoZSBhcnJheXMgaGVyZSwgd2UnbGxcbiAgLy8gZ2l2ZSB5b3UgYSBtZWRhbFxuICBtZXJnZURpZmZBcnIoT2JqZWN0LmtleXMoYSksIE9iamVjdC5rZXlzKGIpLCBiLCAwLCAwLCBvblJlbW92ZSwgcmV0KTtcbiAgcmV0dXJuIHJldDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL21lcmdlRGlmZi5qc1xuICoqIG1vZHVsZSBpZCA9IDIxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyBjdXJyZW50U3R5bGUga2VlcHMgdGhlIGluZm8gYWJvdXQgd2hldGhlciBhIHByb3AgaXMgY29uZmlndXJlZCBhcyBhIHNwcmluZ1xuLy8gb3IgaWYgaXQncyBqdXN0IGEgcmFuZG9tIHByb3AgdGhhdCBoYXBwZW5zIHRvIGJlIHByZXNlbnQgb24gdGhlIHN0eWxlXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gbm9WZWxvY2l0eTtcblxuZnVuY3Rpb24gbm9WZWxvY2l0eShjdXJyZW50VmVsb2NpdHksIGN1cnJlbnRTdHlsZSkge1xuICBmb3IgKHZhciBrZXkgaW4gY3VycmVudFZlbG9jaXR5KSB7XG4gICAgaWYgKCFjdXJyZW50VmVsb2NpdHkuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChjdXJyZW50U3R5bGVba2V5XS5jb25maWcgJiYgY3VycmVudFZlbG9jaXR5W2tleV0gIT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9ub1ZlbG9jaXR5LmpzXG4gKiogbW9kdWxlIGlkID0gMjJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3JlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfY29tcG9uZW50czIgPSByZXF1aXJlKCcuL2NvbXBvbmVudHMnKTtcblxudmFyIF9jb21wb25lbnRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudHMyKTtcblxudmFyIF9yZW9yZGVyS2V5cyA9IHJlcXVpcmUoJy4vcmVvcmRlcktleXMnKTtcblxudmFyIF9yZW9yZGVyS2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW9yZGVyS2V5cyk7XG5cbnZhciBfY29tcG9uZW50cyA9IF9jb21wb25lbnRzM1snZGVmYXVsdCddKF9yZWFjdDJbJ2RlZmF1bHQnXSk7XG5cbnZhciBTcHJpbmcgPSBfY29tcG9uZW50cy5TcHJpbmc7XG52YXIgVHJhbnNpdGlvblNwcmluZyA9IF9jb21wb25lbnRzLlRyYW5zaXRpb25TcHJpbmc7XG52YXIgTW90aW9uID0gX2NvbXBvbmVudHMuTW90aW9uO1xudmFyIFN0YWdnZXJlZE1vdGlvbiA9IF9jb21wb25lbnRzLlN0YWdnZXJlZE1vdGlvbjtcbnZhciBUcmFuc2l0aW9uTW90aW9uID0gX2NvbXBvbmVudHMuVHJhbnNpdGlvbk1vdGlvbjtcbmV4cG9ydHMuU3ByaW5nID0gU3ByaW5nO1xuZXhwb3J0cy5UcmFuc2l0aW9uU3ByaW5nID0gVHJhbnNpdGlvblNwcmluZztcbmV4cG9ydHMuTW90aW9uID0gTW90aW9uO1xuZXhwb3J0cy5TdGFnZ2VyZWRNb3Rpb24gPSBTdGFnZ2VyZWRNb3Rpb247XG5leHBvcnRzLlRyYW5zaXRpb25Nb3Rpb24gPSBUcmFuc2l0aW9uTW90aW9uO1xuXG52YXIgX3NwcmluZzIgPSByZXF1aXJlKCcuL3NwcmluZycpO1xuXG52YXIgX3NwcmluZzMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zcHJpbmcyKTtcblxuZXhwb3J0cy5zcHJpbmcgPSBfc3ByaW5nM1snZGVmYXVsdCddO1xuXG52YXIgX3ByZXNldHMyID0gcmVxdWlyZSgnLi9wcmVzZXRzJyk7XG5cbnZhciBfcHJlc2V0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcmVzZXRzMik7XG5cbmV4cG9ydHMucHJlc2V0cyA9IF9wcmVzZXRzM1snZGVmYXVsdCddO1xudmFyIHV0aWxzID0ge1xuICByZW9yZGVyS2V5czogX3Jlb3JkZXJLZXlzMlsnZGVmYXVsdCddXG59O1xuZXhwb3J0cy51dGlscyA9IHV0aWxzO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvcmVhY3QtbW90aW9uLmpzXG4gKiogbW9kdWxlIGlkID0gMjNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSByZW9yZGVyS2V5cztcblxuZnVuY3Rpb24gcmVvcmRlcktleXMob2JqLCBmKSB7XG4gIHZhciBuZXdLZXlzID0gZihPYmplY3Qua2V5cyhvYmopKTtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG5ld0tleXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIga2V5ID0gbmV3S2V5c1tpXTtcbiAgICByZXRba2V5XSA9IG9ialtrZXldO1xuICB9XG5cbiAgcmV0dXJuIHJldDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3Jlb3JkZXJLZXlzLmpzXG4gKiogbW9kdWxlIGlkID0gMjRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbJ2RlZmF1bHQnXSA9IHNwcmluZztcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3ByZXNldHMgPSByZXF1aXJlKCcuL3ByZXNldHMnKTtcblxudmFyIF9wcmVzZXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ByZXNldHMpO1xuXG4vLyBpbnN0ZWFkIG9mIGV4cG9zaW5nIHt2YWw6IGJsYSwgY29uZmlnOiBibGF9LCB1c2UgYSBoZWxwZXJcblxuZnVuY3Rpb24gc3ByaW5nKHZhbCkge1xuICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gX3ByZXNldHMyWydkZWZhdWx0J10ubm9Xb2JibGUgOiBhcmd1bWVudHNbMV07XG5cbiAgcmV0dXJuIHsgdmFsOiB2YWwsIGNvbmZpZzogY29uZmlnIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvc3ByaW5nLmpzXG4gKiogbW9kdWxlIGlkID0gMjVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBzdGVwcGVyO1xudmFyIGVycm9yTWFyZ2luID0gMC4wMDAxO1xuXG5mdW5jdGlvbiBzdGVwcGVyKGZyYW1lUmF0ZSwgeCwgdiwgZGVzdFgsIGssIGIpIHtcbiAgLy8gU3ByaW5nIHN0aWZmbmVzcywgaW4ga2cgLyBzXjJcblxuICAvLyBmb3IgYW5pbWF0aW9ucywgZGVzdFggaXMgcmVhbGx5IHNwcmluZyBsZW5ndGggKHNwcmluZyBhdCByZXN0KS4gaW5pdGlhbFxuICAvLyBwb3NpdGlvbiBpcyBjb25zaWRlcmVkIGFzIHRoZSBzdHJldGNoZWQvY29tcHJlc3NlZCBwb3NpdGlvbiBvZiBhIHNwcmluZ1xuICB2YXIgRnNwcmluZyA9IC1rICogKHggLSBkZXN0WCk7XG5cbiAgLy8gRGFtcGluZywgaW4ga2cgLyBzXG4gIHZhciBGZGFtcGVyID0gLWIgKiB2O1xuXG4gIC8vIHVzdWFsbHkgd2UgcHV0IG1hc3MgaGVyZSwgYnV0IGZvciBhbmltYXRpb24gcHVycG9zZXMsIHNwZWNpZnlpbmcgbWFzcyBpcyBhXG4gIC8vIGJpdCByZWR1bmRhbnQuIHlvdSBjb3VsZCBzaW1wbHkgYWRqdXN0IGsgYW5kIGIgYWNjb3JkaW5nbHlcbiAgLy8gbGV0IGEgPSAoRnNwcmluZyArIEZkYW1wZXIpIC8gbWFzcztcbiAgdmFyIGEgPSBGc3ByaW5nICsgRmRhbXBlcjtcblxuICB2YXIgbmV3ViA9IHYgKyBhICogZnJhbWVSYXRlO1xuICB2YXIgbmV3WCA9IHggKyBuZXdWICogZnJhbWVSYXRlO1xuXG4gIGlmIChNYXRoLmFicyhuZXdWIC0gdikgPCBlcnJvck1hcmdpbiAmJiBNYXRoLmFicyhuZXdYIC0geCkgPCBlcnJvck1hcmdpbikge1xuICAgIHJldHVybiBbZGVzdFgsIDBdO1xuICB9XG5cbiAgcmV0dXJuIFtuZXdYLCBuZXdWXTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3N0ZXBwZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAyNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gdHVybiB7eDoge3ZhbDogMSwgY29uZmlnOiBbMSwgMl19LCB5OiAyfSBpbnRvIHt4OiAxLCB5OiAyfVxuXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHN0cmlwU3R5bGU7XG5cbmZ1bmN0aW9uIHN0cmlwU3R5bGUoc3R5bGUpIHtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcbiAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICByZXRba2V5XSA9IHN0eWxlW2tleV0udmFsID09IG51bGwgPyBzdHlsZVtrZXldIDogc3R5bGVba2V5XS52YWw7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3N0cmlwU3R5bGUuanNcbiAqKiBtb2R1bGUgaWQgPSAyN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5pbnRlcnBvbGF0ZVZhbHVlID0gaW50ZXJwb2xhdGVWYWx1ZTtcbmV4cG9ydHMudXBkYXRlQ3VycmVudFN0eWxlID0gdXBkYXRlQ3VycmVudFN0eWxlO1xuZXhwb3J0cy51cGRhdGVDdXJyZW50VmVsb2NpdHkgPSB1cGRhdGVDdXJyZW50VmVsb2NpdHk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblxudmFyIF9zdGVwcGVyID0gcmVxdWlyZSgnLi9zdGVwcGVyJyk7XG5cbnZhciBfc3RlcHBlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGVwcGVyKTtcblxuLy8gVE9ETzogcmVmYWN0b3IgY29tbW9uIGxvZ2ljIHdpdGggdXBkYXRlQ3VyclZhbHVlIGFuZCB1cGRhdGVDdXJyVmVsb2NpdHlcblxuZnVuY3Rpb24gaW50ZXJwb2xhdGVWYWx1ZShhbHBoYSwgbmV4dFN0eWxlLCBwcmV2U3R5bGUpIHtcbiAgLy8gbWlnaHQgYmUgdXNlZCBieSBhIFRyYW5zaXRpb25Nb3Rpb24sIHdoZXJlIHByZXZTdHlsZSBtaWdodCBub3QgZXhpc3QgYW55bW9yZVxuICBpZiAoIXByZXZTdHlsZSkge1xuICAgIHJldHVybiBuZXh0U3R5bGU7XG4gIH1cblxuICB2YXIgcmV0ID0ge307XG4gIGZvciAodmFyIGtleSBpbiBuZXh0U3R5bGUpIHtcbiAgICBpZiAoIW5leHRTdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoIW5leHRTdHlsZVtrZXldLmNvbmZpZykge1xuICAgICAgcmV0W2tleV0gPSBuZXh0U3R5bGVba2V5XTtcbiAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWcsIG5vdCBzb21ldGhpbmcgd2Ugd2FudCB0byBpbnRlcnBvbGF0ZVxuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHZhciBwcmV2VmFsdWUgPSBwcmV2U3R5bGVba2V5XS5jb25maWcgPyBwcmV2U3R5bGVba2V5XS52YWwgOiBwcmV2U3R5bGVba2V5XTtcbiAgICByZXRba2V5XSA9IHtcbiAgICAgIHZhbDogbmV4dFN0eWxlW2tleV0udmFsICogYWxwaGEgKyBwcmV2VmFsdWUgKiAoMSAtIGFscGhhKSxcbiAgICAgIGNvbmZpZzogbmV4dFN0eWxlW2tleV0uY29uZmlnXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiByZXQ7XG59XG5cbi8vIFRPRE86IHJlZmFjdG9yIGNvbW1vbiBsb2dpYyB3aXRoIHVwZGF0ZUN1cnJlbnRWZWxvY2l0eVxuXG5mdW5jdGlvbiB1cGRhdGVDdXJyZW50U3R5bGUoZnJhbWVSYXRlLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpIHtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcbiAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoIXN0eWxlW2tleV0uY29uZmlnKSB7XG4gICAgICByZXRba2V5XSA9IHN0eWxlW2tleV07XG4gICAgICAvLyBub3QgYSBzcHJpbmcgY29uZmlnLCBub3Qgc29tZXRoaW5nIHdlIHdhbnQgdG8gaW50ZXJwb2xhdGVcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB2YXIgX3N0eWxlJGtleSRjb25maWcgPSBzdHlsZVtrZXldLmNvbmZpZztcbiAgICB2YXIgayA9IF9zdHlsZSRrZXkkY29uZmlnWzBdO1xuICAgIHZhciBiID0gX3N0eWxlJGtleSRjb25maWdbMV07XG5cbiAgICB2YXIgdmFsID0gX3N0ZXBwZXIyWydkZWZhdWx0J10oZnJhbWVSYXRlLFxuICAgIC8vIG1pZ2h0IGhhdmUgYmVlbiBhIG5vbi1zcHJpbmdlZCBwcm9wIHRoYXQganVzdCBiZWNhbWUgb25lXG4gICAgY3VycmVudFN0eWxlW2tleV0udmFsID09IG51bGwgPyBjdXJyZW50U3R5bGVba2V5XSA6IGN1cnJlbnRTdHlsZVtrZXldLnZhbCwgY3VycmVudFZlbG9jaXR5W2tleV0sIHN0eWxlW2tleV0udmFsLCBrLCBiKVswXTtcbiAgICByZXRba2V5XSA9IHtcbiAgICAgIHZhbDogdmFsLFxuICAgICAgY29uZmlnOiBzdHlsZVtrZXldLmNvbmZpZ1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ3VycmVudFZlbG9jaXR5KGZyYW1lUmF0ZSwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdHksIHN0eWxlKSB7XG4gIHZhciByZXQgPSB7fTtcbiAgZm9yICh2YXIga2V5IGluIHN0eWxlKSB7XG4gICAgaWYgKCFzdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKCFzdHlsZVtrZXldLmNvbmZpZykge1xuICAgICAgLy8gbm90IGEgc3ByaW5nIGNvbmZpZywgbm90IHNvbWV0aGluZyB3ZSB3YW50IHRvIGludGVycG9sYXRlXG4gICAgICByZXRba2V5XSA9IDA7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgdmFyIF9zdHlsZSRrZXkkY29uZmlnMiA9IHN0eWxlW2tleV0uY29uZmlnO1xuICAgIHZhciBrID0gX3N0eWxlJGtleSRjb25maWcyWzBdO1xuICAgIHZhciBiID0gX3N0eWxlJGtleSRjb25maWcyWzFdO1xuXG4gICAgdmFyIHZhbCA9IF9zdGVwcGVyMlsnZGVmYXVsdCddKGZyYW1lUmF0ZSxcbiAgICAvLyBtaWdodCBoYXZlIGJlZW4gYSBub24tc3ByaW5nZWQgcHJvcCB0aGF0IGp1c3QgYmVjYW1lIG9uZVxuICAgIGN1cnJlbnRTdHlsZVtrZXldLnZhbCA9PSBudWxsID8gY3VycmVudFN0eWxlW2tleV0gOiBjdXJyZW50U3R5bGVba2V5XS52YWwsIGN1cnJlbnRWZWxvY2l0eVtrZXldLCBzdHlsZVtrZXldLnZhbCwgaywgYilbMV07XG4gICAgcmV0W2tleV0gPSB2YWw7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3VwZGF0ZVRyZWUuanNcbiAqKiBtb2R1bGUgaWQgPSAyOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gdXNlZCBieSB0aGUgdHJlZS13YWxraW5nIHVwZGF0ZXMgYW5kIHNwcmluZ3MuIEF2b2lkcyBzb21lIGFsbG9jYXRpb25zXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gemVybztcblxuZnVuY3Rpb24gemVybygpIHtcbiAgcmV0dXJuIDA7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi96ZXJvLmpzXG4gKiogbW9kdWxlIGlkID0gMjlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInZhciBub3cgPSByZXF1aXJlKCdwZXJmb3JtYW5jZS1ub3cnKVxuICAsIGdsb2JhbCA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnID8ge30gOiB3aW5kb3dcbiAgLCB2ZW5kb3JzID0gWydtb3onLCAnd2Via2l0J11cbiAgLCBzdWZmaXggPSAnQW5pbWF0aW9uRnJhbWUnXG4gICwgcmFmID0gZ2xvYmFsWydyZXF1ZXN0JyArIHN1ZmZpeF1cbiAgLCBjYWYgPSBnbG9iYWxbJ2NhbmNlbCcgKyBzdWZmaXhdIHx8IGdsb2JhbFsnY2FuY2VsUmVxdWVzdCcgKyBzdWZmaXhdXG5cbmZvcih2YXIgaSA9IDA7IGkgPCB2ZW5kb3JzLmxlbmd0aCAmJiAhcmFmOyBpKyspIHtcbiAgcmFmID0gZ2xvYmFsW3ZlbmRvcnNbaV0gKyAnUmVxdWVzdCcgKyBzdWZmaXhdXG4gIGNhZiA9IGdsb2JhbFt2ZW5kb3JzW2ldICsgJ0NhbmNlbCcgKyBzdWZmaXhdXG4gICAgICB8fCBnbG9iYWxbdmVuZG9yc1tpXSArICdDYW5jZWxSZXF1ZXN0JyArIHN1ZmZpeF1cbn1cblxuLy8gU29tZSB2ZXJzaW9ucyBvZiBGRiBoYXZlIHJBRiBidXQgbm90IGNBRlxuaWYoIXJhZiB8fCAhY2FmKSB7XG4gIHZhciBsYXN0ID0gMFxuICAgICwgaWQgPSAwXG4gICAgLCBxdWV1ZSA9IFtdXG4gICAgLCBmcmFtZUR1cmF0aW9uID0gMTAwMCAvIDYwXG5cbiAgcmFmID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICBpZihxdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgIHZhciBfbm93ID0gbm93KClcbiAgICAgICAgLCBuZXh0ID0gTWF0aC5tYXgoMCwgZnJhbWVEdXJhdGlvbiAtIChfbm93IC0gbGFzdCkpXG4gICAgICBsYXN0ID0gbmV4dCArIF9ub3dcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjcCA9IHF1ZXVlLnNsaWNlKDApXG4gICAgICAgIC8vIENsZWFyIHF1ZXVlIGhlcmUgdG8gcHJldmVudFxuICAgICAgICAvLyBjYWxsYmFja3MgZnJvbSBhcHBlbmRpbmcgbGlzdGVuZXJzXG4gICAgICAgIC8vIHRvIHRoZSBjdXJyZW50IGZyYW1lJ3MgcXVldWVcbiAgICAgICAgcXVldWUubGVuZ3RoID0gMFxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY3AubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZighY3BbaV0uY2FuY2VsbGVkKSB7XG4gICAgICAgICAgICB0cnl7XG4gICAgICAgICAgICAgIGNwW2ldLmNhbGxiYWNrKGxhc3QpXG4gICAgICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgdGhyb3cgZSB9LCAwKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgTWF0aC5yb3VuZChuZXh0KSlcbiAgICB9XG4gICAgcXVldWUucHVzaCh7XG4gICAgICBoYW5kbGU6ICsraWQsXG4gICAgICBjYWxsYmFjazogY2FsbGJhY2ssXG4gICAgICBjYW5jZWxsZWQ6IGZhbHNlXG4gICAgfSlcbiAgICByZXR1cm4gaWRcbiAgfVxuXG4gIGNhZiA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYocXVldWVbaV0uaGFuZGxlID09PSBoYW5kbGUpIHtcbiAgICAgICAgcXVldWVbaV0uY2FuY2VsbGVkID0gdHJ1ZVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuKSB7XG4gIC8vIFdyYXAgaW4gYSBuZXcgZnVuY3Rpb24gdG8gcHJldmVudFxuICAvLyBgY2FuY2VsYCBwb3RlbnRpYWxseSBiZWluZyBhc3NpZ25lZFxuICAvLyB0byB0aGUgbmF0aXZlIHJBRiBmdW5jdGlvblxuICByZXR1cm4gcmFmLmNhbGwoZ2xvYmFsLCBmbilcbn1cbm1vZHVsZS5leHBvcnRzLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICBjYWYuYXBwbHkoZ2xvYmFsLCBhcmd1bWVudHMpXG59XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vfi9yYWYvaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAzMFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLypcclxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxyXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuKi9cclxudmFyIHN0eWxlc0luRG9tID0ge30sXHJcblx0bWVtb2l6ZSA9IGZ1bmN0aW9uKGZuKSB7XHJcblx0XHR2YXIgbWVtbztcclxuXHRcdHJldHVybiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGlmICh0eXBlb2YgbWVtbyA9PT0gXCJ1bmRlZmluZWRcIikgbWVtbyA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdHJldHVybiBtZW1vO1xyXG5cdFx0fTtcclxuXHR9LFxyXG5cdGlzT2xkSUUgPSBtZW1vaXplKGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIC9tc2llIFs2LTldXFxiLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpO1xyXG5cdH0pLFxyXG5cdGdldEhlYWRFbGVtZW50ID0gbWVtb2l6ZShmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF07XHJcblx0fSksXHJcblx0c2luZ2xldG9uRWxlbWVudCA9IG51bGwsXHJcblx0c2luZ2xldG9uQ291bnRlciA9IDA7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxpc3QsIG9wdGlvbnMpIHtcclxuXHRpZih0eXBlb2YgREVCVUcgIT09IFwidW5kZWZpbmVkXCIgJiYgREVCVUcpIHtcclxuXHRcdGlmKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50XCIpO1xyXG5cdH1cclxuXHJcblx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcblx0Ly8gRm9yY2Ugc2luZ2xlLXRhZyBzb2x1dGlvbiBvbiBJRTYtOSwgd2hpY2ggaGFzIGEgaGFyZCBsaW1pdCBvbiB0aGUgIyBvZiA8c3R5bGU+XHJcblx0Ly8gdGFncyBpdCB3aWxsIGFsbG93IG9uIGEgcGFnZVxyXG5cdGlmICh0eXBlb2Ygb3B0aW9ucy5zaW5nbGV0b24gPT09IFwidW5kZWZpbmVkXCIpIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xyXG5cclxuXHR2YXIgc3R5bGVzID0gbGlzdFRvU3R5bGVzKGxpc3QpO1xyXG5cdGFkZFN0eWxlc1RvRG9tKHN0eWxlcywgb3B0aW9ucyk7XHJcblxyXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGUobmV3TGlzdCkge1xyXG5cdFx0dmFyIG1heVJlbW92ZSA9IFtdO1xyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaXRlbSA9IHN0eWxlc1tpXTtcclxuXHRcdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XHJcblx0XHRcdGRvbVN0eWxlLnJlZnMtLTtcclxuXHRcdFx0bWF5UmVtb3ZlLnB1c2goZG9tU3R5bGUpO1xyXG5cdFx0fVxyXG5cdFx0aWYobmV3TGlzdCkge1xyXG5cdFx0XHR2YXIgbmV3U3R5bGVzID0gbGlzdFRvU3R5bGVzKG5ld0xpc3QpO1xyXG5cdFx0XHRhZGRTdHlsZXNUb0RvbShuZXdTdHlsZXMsIG9wdGlvbnMpO1xyXG5cdFx0fVxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IG1heVJlbW92ZS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBtYXlSZW1vdmVbaV07XHJcblx0XHRcdGlmKGRvbVN0eWxlLnJlZnMgPT09IDApIHtcclxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspXHJcblx0XHRcdFx0XHRkb21TdHlsZS5wYXJ0c1tqXSgpO1xyXG5cdFx0XHRcdGRlbGV0ZSBzdHlsZXNJbkRvbVtkb21TdHlsZS5pZF07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpIHtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHR2YXIgaXRlbSA9IHN0eWxlc1tpXTtcclxuXHRcdHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdO1xyXG5cdFx0aWYoZG9tU3R5bGUpIHtcclxuXHRcdFx0ZG9tU3R5bGUucmVmcysrO1xyXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRkb21TdHlsZS5wYXJ0c1tqXShpdGVtLnBhcnRzW2pdKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IoOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdGRvbVN0eWxlLnBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSwgb3B0aW9ucykpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR2YXIgcGFydHMgPSBbXTtcclxuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRzdHlsZXNJbkRvbVtpdGVtLmlkXSA9IHtpZDogaXRlbS5pZCwgcmVmczogMSwgcGFydHM6IHBhcnRzfTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxpc3RUb1N0eWxlcyhsaXN0KSB7XHJcblx0dmFyIHN0eWxlcyA9IFtdO1xyXG5cdHZhciBuZXdTdHlsZXMgPSB7fTtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG5cdFx0dmFyIGl0ZW0gPSBsaXN0W2ldO1xyXG5cdFx0dmFyIGlkID0gaXRlbVswXTtcclxuXHRcdHZhciBjc3MgPSBpdGVtWzFdO1xyXG5cdFx0dmFyIG1lZGlhID0gaXRlbVsyXTtcclxuXHRcdHZhciBzb3VyY2VNYXAgPSBpdGVtWzNdO1xyXG5cdFx0dmFyIHBhcnQgPSB7Y3NzOiBjc3MsIG1lZGlhOiBtZWRpYSwgc291cmNlTWFwOiBzb3VyY2VNYXB9O1xyXG5cdFx0aWYoIW5ld1N0eWxlc1tpZF0pXHJcblx0XHRcdHN0eWxlcy5wdXNoKG5ld1N0eWxlc1tpZF0gPSB7aWQ6IGlkLCBwYXJ0czogW3BhcnRdfSk7XHJcblx0XHRlbHNlXHJcblx0XHRcdG5ld1N0eWxlc1tpZF0ucGFydHMucHVzaChwYXJ0KTtcclxuXHR9XHJcblx0cmV0dXJuIHN0eWxlcztcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlU3R5bGVFbGVtZW50KCkge1xyXG5cdHZhciBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XHJcblx0dmFyIGhlYWQgPSBnZXRIZWFkRWxlbWVudCgpO1xyXG5cdHN0eWxlRWxlbWVudC50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xyXG5cdGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGVFbGVtZW50KTtcclxuXHRyZXR1cm4gc3R5bGVFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVMaW5rRWxlbWVudCgpIHtcclxuXHR2YXIgbGlua0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTtcclxuXHR2YXIgaGVhZCA9IGdldEhlYWRFbGVtZW50KCk7XHJcblx0bGlua0VsZW1lbnQucmVsID0gXCJzdHlsZXNoZWV0XCI7XHJcblx0aGVhZC5hcHBlbmRDaGlsZChsaW5rRWxlbWVudCk7XHJcblx0cmV0dXJuIGxpbmtFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRTdHlsZShvYmosIG9wdGlvbnMpIHtcclxuXHR2YXIgc3R5bGVFbGVtZW50LCB1cGRhdGUsIHJlbW92ZTtcclxuXHJcblx0aWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XHJcblx0XHR2YXIgc3R5bGVJbmRleCA9IHNpbmdsZXRvbkNvdW50ZXIrKztcclxuXHRcdHN0eWxlRWxlbWVudCA9IHNpbmdsZXRvbkVsZW1lbnQgfHwgKHNpbmdsZXRvbkVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQoKSk7XHJcblx0XHR1cGRhdGUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50LCBzdHlsZUluZGV4LCBmYWxzZSk7XHJcblx0XHRyZW1vdmUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50LCBzdHlsZUluZGV4LCB0cnVlKTtcclxuXHR9IGVsc2UgaWYob2JqLnNvdXJjZU1hcCAmJlxyXG5cdFx0dHlwZW9mIFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHR0eXBlb2YgVVJMLmNyZWF0ZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHR0eXBlb2YgVVJMLnJldm9rZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHR0eXBlb2YgQmxvYiA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHR0eXBlb2YgYnRvYSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcblx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVMaW5rRWxlbWVudCgpO1xyXG5cdFx0dXBkYXRlID0gdXBkYXRlTGluay5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50KTtcclxuXHRcdFx0aWYoc3R5bGVFbGVtZW50LmhyZWYpXHJcblx0XHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChzdHlsZUVsZW1lbnQuaHJlZik7XHJcblx0XHR9O1xyXG5cdH0gZWxzZSB7XHJcblx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQoKTtcclxuXHRcdHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQpO1xyXG5cdFx0cmVtb3ZlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0dXBkYXRlKG9iaik7XHJcblxyXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmopIHtcclxuXHRcdGlmKG5ld09iaikge1xyXG5cdFx0XHRpZihuZXdPYmouY3NzID09PSBvYmouY3NzICYmIG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmIG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXApXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR1cGRhdGUob2JqID0gbmV3T2JqKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJlbW92ZSgpO1xyXG5cdFx0fVxyXG5cdH07XHJcbn1cclxuXHJcbnZhciByZXBsYWNlVGV4dCA9IChmdW5jdGlvbiAoKSB7XHJcblx0dmFyIHRleHRTdG9yZSA9IFtdO1xyXG5cclxuXHRyZXR1cm4gZnVuY3Rpb24gKGluZGV4LCByZXBsYWNlbWVudCkge1xyXG5cdFx0dGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xyXG5cdFx0cmV0dXJuIHRleHRTdG9yZS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XHJcblx0fTtcclxufSkoKTtcclxuXHJcbmZ1bmN0aW9uIGFwcGx5VG9TaW5nbGV0b25UYWcoc3R5bGVFbGVtZW50LCBpbmRleCwgcmVtb3ZlLCBvYmopIHtcclxuXHR2YXIgY3NzID0gcmVtb3ZlID8gXCJcIiA6IG9iai5jc3M7XHJcblxyXG5cdGlmIChzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xyXG5cdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XHJcblx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlRWxlbWVudC5jaGlsZE5vZGVzO1xyXG5cdFx0aWYgKGNoaWxkTm9kZXNbaW5kZXhdKSBzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0aWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudC5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGNzc05vZGUpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gYXBwbHlUb1RhZyhzdHlsZUVsZW1lbnQsIG9iaikge1xyXG5cdHZhciBjc3MgPSBvYmouY3NzO1xyXG5cdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcclxuXHR2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcclxuXHJcblx0aWYobWVkaWEpIHtcclxuXHRcdHN0eWxlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBtZWRpYSlcclxuXHR9XHJcblxyXG5cdGlmKHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0KSB7XHJcblx0XHRzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR3aGlsZShzdHlsZUVsZW1lbnQuZmlyc3RDaGlsZCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpO1xyXG5cdFx0fVxyXG5cdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcykpO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlTGluayhsaW5rRWxlbWVudCwgb2JqKSB7XHJcblx0dmFyIGNzcyA9IG9iai5jc3M7XHJcblx0dmFyIG1lZGlhID0gb2JqLm1lZGlhO1xyXG5cdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xyXG5cclxuXHRpZihzb3VyY2VNYXApIHtcclxuXHRcdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI2NjAzODc1XHJcblx0XHRjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArIFwiICovXCI7XHJcblx0fVxyXG5cclxuXHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3NdLCB7IHR5cGU6IFwidGV4dC9jc3NcIiB9KTtcclxuXHJcblx0dmFyIG9sZFNyYyA9IGxpbmtFbGVtZW50LmhyZWY7XHJcblxyXG5cdGxpbmtFbGVtZW50LmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG5cclxuXHRpZihvbGRTcmMpXHJcblx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKG9sZFNyYyk7XHJcbn1cclxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1xuICoqIG1vZHVsZSBpZCA9IDMxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuLy4uLy4uL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzP2Jyb3dzZXJzPWxhc3QgMiB2ZXJzaW9uIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2luZGV4LmpzIS4vbWFpbi5zY3NzXCIpO1xuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4vLyBhZGQgdGhlIHN0eWxlcyB0byB0aGUgRE9NXG52YXIgdXBkYXRlID0gcmVxdWlyZShcIiEuLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIHt9KTtcbmlmKGNvbnRlbnQubG9jYWxzKSBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzO1xuLy8gSG90IE1vZHVsZSBSZXBsYWNlbWVudFxuaWYobW9kdWxlLmhvdCkge1xuXHQvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFnc1xuXHRpZighY29udGVudC5sb2NhbHMpIHtcblx0XHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuLy4uLy4uL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzP2Jyb3dzZXJzPWxhc3QgMiB2ZXJzaW9uIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2luZGV4LmpzIS4vbWFpbi5zY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2F1dG9wcmVmaXhlci1sb2FkZXIvaW5kZXguanM/YnJvd3NlcnM9bGFzdCAyIHZlcnNpb24hLi8uLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhLi9tYWluLnNjc3NcIik7XG5cdFx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblx0XHRcdHVwZGF0ZShuZXdDb250ZW50KTtcblx0XHR9KTtcblx0fVxuXHQvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvc3R5bGUvbWFpbi5zY3NzXG4gKiogbW9kdWxlIGlkID0gMzJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XHJcblx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0bW9kdWxlLnBhdGhzID0gW107XHJcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn1cclxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAod2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanNcbiAqKiBtb2R1bGUgaWQgPSAzM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==