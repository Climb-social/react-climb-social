!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("ReactDOM")):"function"==typeof define&&define.amd?define(["react","ReactDOM"],e):"object"==typeof exports?exports["react-climb-social"]=e(require("react"),require("ReactDOM")):t["react-climb-social"]=e(t.React,t.ReactDOM)}(this,function(t,e){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="/",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=r(o),s=n(38),u=r(s),c=n(15),a=r(c),l=n(12),p=r(l);if(n(35),window){window.Climb=window.Climb||{};for(var h=document.querySelectorAll(".climb-wall"),f=0;f<h.length;++f){var d=h[f],v=d.dataset.collectionId,b=d.dataset.limit;u["default"].render(i["default"].createElement(a["default"],{collectionId:v,limit:b}),d)}for(var y=document.querySelectorAll(".climb-slideshow"),f=0;f<y.length;++f){var d=y[f],v=d.dataset.collectionId;u["default"].render(i["default"].createElement(p["default"],{collectionId:v}),d)}}e.WallContainer=a["default"];var m=n(5);Object.defineProperty(e,"Wall",{enumerable:!0,get:function(){return m.Wall}});var _=n(4);Object.defineProperty(e,"Tile",{enumerable:!0,get:function(){return _.Tile}})},function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return i(e,t),s(e,[{key:"render",value:function(){return a["default"].createElement("img",{className:"climb__image",src:this.props.src,"data-width":this.props.width,"data-height":this.props.height})}}]),e}(a["default"].Component);l.propTypes={src:a["default"].PropTypes.string.isRequired,width:a["default"].PropTypes.number,height:a["default"].PropTypes.number},e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return i(e,t),s(e,[{key:"render",value:function(){var t=this.props.body.replace(/<a href="http:\/\/pic.twitter.com\/[^>]*>([^<]+)<\/a>/g,"");return a["default"].createElement("div",{className:"climb__tile__message",dangerouslySetInnerHTML:{__html:t}})}}]),e}(a["default"].Component);l.propTypes={body:a["default"].PropTypes.string.isRequired},e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=n(2),p=r(l),h=n(3),f=r(h),d=n(10),v=r(d),b=function(t){function e(t){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return i(e,t),s(e,[{key:"createImage",value:function(){if(null!==this.props.image){var t=this.props.image,e=t.url,n=t.width,r=t.height;return a["default"].createElement(p["default"],{src:e,width:n,height:r})}return null}},{key:"createMessage",value:function(){return this.props.message?a["default"].createElement(f["default"],{body:this.props.message}):null}},{key:"createClassString",value:function(){var t="climb__tile climb__tile--"+this.props.source_type;return t+=this.props.image?" climb__tile--has-media climb__tile--has-image":" climb__tile--has-no-image",t+=this.props.video_url?" climb__tile--has-media climb__tile--has-video":" climb__tile--has-no-video"}},{key:"render",value:function(){var t=this.createImage(),e=this.createMessage(),n=this.createClassString(),r=this.props.author;return a["default"].createElement("div",{className:n,style:this.props.style},a["default"].createElement("a",{href:this.props.link},t),a["default"].createElement("div",{className:"climb__tile__content"},e,a["default"].createElement(v["default"],r)))}}]),e}(a["default"].Component);b.propTypes={link:a["default"].PropTypes.string.isRequired,source_type:a["default"].PropTypes.string.isRequired,timestamp:a["default"].PropTypes.number.isRequired,author:a["default"].PropTypes.shape({username:a["default"].PropTypes.string.isRequired,picture:a["default"].PropTypes.string.isRequired,link:a["default"].PropTypes.string.isRequired}),message:a["default"].PropTypes.string,video_src:a["default"].PropTypes.string,image:a["default"].PropTypes.shape({url:a["default"].PropTypes.string.isRequired,width:a["default"].PropTypes.number.isRequired,height:a["default"].PropTypes.number.isRequired})},e["default"]=b,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},l=n(1),p=r(l),h=n(4),f=r(h),d=n(26),v=function(t){function e(){i(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return s(e,t),c(e,[{key:"getStyles",value:function(){var t=this,e={};return Object.keys(this.props.items).map(function(n){e[n]={opacity:d.spring(1),width:d.spring(30),margin:d.spring(1),item:t.props.items[n]}}),e}},{key:"willEnter",value:function(t){return{opacity:d.spring(0),width:d.spring(0),margin:d.spring(0),item:this.props.items[t]}}},{key:"willLeave",value:function(t,e){return{opacity:d.spring(0),width:d.spring(0),margin:d.spring(0),item:e.item}}},{key:"renderTile",value:function(t,e){var n=e.item,r=o(e,["item"]),i=o(n,[]),s={opacity:r.opacity,width:r.width+"%",marginLeft:r.margin+"%",marginRight:r.margin+"%"};return p["default"].createElement(f["default"],u({key:t,style:s},i))}},{key:"render",value:function(){var t=this;return p["default"].createElement(d.TransitionMotion,{styles:this.getStyles.bind(this)(),willEnter:this.willEnter.bind(this),willLeave:this.willLeave.bind(this)},function(e){return p["default"].createElement("div",{className:"climb__wall"},Object.keys(e).map(function(n){var r=e[n];return t.renderTile(n,r)}))})}}],[{key:"propTypes",value:{items:l.PropTypes.object.isRequired},enumerable:!0}]),e}(l.Component);e["default"]=v,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),i=n(19),s=r(i),u=function(t){var e=5e3,n=o.Observable.just("http://app.climb.social/api/v1/collections/"+t),r=o.Observable.interval(e).startWith(null),i=r.combineLatest(n,function(t,e){return e}).flatMap(function(t){var e=""+t;return o.Observable.fromPromise(s["default"](e).then(function(t){return t.json()}))});return i};e["default"]={getStream:u},t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0,e["default"]={noWobble:[170,26],gentle:[120,14],wobbly:[180,12],stiff:[210,20]},t.exports=e["default"]},function(t,e,n){(function(e){(function(){var n,r,o;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(n()-o)/1e6},r=e.hrtime,n=function(){var t;return t=r(),1e9*t[0]+t[1]},o=n()):Date.now?(t.exports=function(){return Date.now()-o},o=Date.now()):(t.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(e,n(9))},function(t,e){function n(){a=!1,s.length?c=s.concat(c):l=-1,c.length&&r()}function r(){if(!a){var t=setTimeout(n);a=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,a=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function i(){}var s,u=t.exports={},c=[],a=!1,l=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new o(t,e)),1!==c.length||a||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return i(e,t),s(e,[{key:"render",value:function(){return a["default"].createElement("a",{className:"climb__tile__author",href:this.props.link},a["default"].createElement("img",{src:this.props.picture,alt:"Profile pic of "+this.props.name}),a["default"].createElement("h4",{className:"climb__tile__author__username"},this.props.username))}}]),e}(a["default"].Component);l.propTypes={},e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=n(13),p=r(l),h=function(t){function e(t){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={currentItemIndex:0}}return i(e,t),s(e,[{key:"componentDidMount",value:function(){var t=this.props.delay;this.timer=setInterval(this.nextSlide.bind(this),1e3*t)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"nextSlide",value:function(){var t=Object.keys(this.props.items).length,e=Math.floor(Math.random()*t);this.setState({currentItemIndex:e})}},{key:"render",value:function(){var t=Object.keys(this.props.items)[this.state.currentItemIndex];if(!t)return null;var e=this.props.items[t];return a["default"].createElement("div",null,a["default"].createElement(p["default"],{key:t,item:e}))}}],[{key:"propTypes",value:{items:c.PropTypes.object.isRequired,delay:c.PropTypes.number},enumerable:!0},{key:"defaultProps",value:{delay:3},enumerable:!0}]),e}(c.Component);e["default"]=h,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=n(6),p=r(l),h=n(11),f=r(h),d=function(t){function e(t){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={items:{}}}return i(e,t),s(e,[{key:"init",value:function(){var t=this;this.props.collectionId&&p["default"].getStream(this.props.collectionId).subscribe(function(e){var n={};e.map(function(t){n[t.id]=t}),t.setState({items:n})})}},{key:"componentDidMount",value:function(){this.init()}},{key:"render",value:function(){return a["default"].createElement(f["default"],{items:this.state.items})}}],[{key:"propTypes",value:{collectionId:c.PropTypes.string.isRequired},enumerable:!0},{key:"defaultProps",value:{collectionId:"561ba63445284e1740e016f7"},enumerable:!0}]),e}(c.Component);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=n(3),p=r(l),h=n(2),f=r(h),d=function(t){function e(t){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return i(e,t),s(e,[{key:"createImage",value:function(){var t=this.props.item.image;if(null!==t){var e=t.url,n=t.width,r=t.height;return a["default"].createElement(f["default"],{src:e,width:n,height:r})}return null}},{key:"render",value:function(){var t=this.props.item,e=this.createImage();return a["default"].createElement("div",{className:"climb-slideshow__slide"},e,a["default"].createElement(p["default"],{body:t.message}))}}],[{key:"propTypes",value:{item:c.PropTypes.object.isRequired},enumerable:!0}]),e}(c.Component);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return i(e,t),s(e,[{key:"render",value:function(){var t=n(36);return a["default"].createElement("a",{href:"http://climb.social/",className:"climb-social-badge",dangerouslySetInnerHTML:{__html:t}})}}]),e}(c.Component);e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var o=t,i=e,s=n;u=a=c=void 0,r=!1,null===o&&(o=Function.prototype);var u=Object.getOwnPropertyDescriptor(o,i);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(o);if(null===a)return void 0;t=a,e=i,n=s,r=!0}},c=n(1),a=r(c),l=n(6),p=r(l),h=n(5),f=r(h),d=n(14),v=r(d),b=function(t){function e(t){o(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={items:{}}}return i(e,t),s(e,[{key:"init",value:function(){var t=this;this.props.collectionId&&p["default"].getStream(this.props.collectionId).subscribe(function(e){var n=parseInt(t.props.limit,0),r={};e.splice(0,n).map(function(t){r[t.id]=t}),t.setState({items:r})})}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentDidUpdate",value:function(){var t=void 0;(t=window.Climb&&window.Climb.onUpdate?window.Climb.onUpdate:function(){})()}},{key:"render",value:function(){return a["default"].createElement("div",null,a["default"].createElement(f["default"],{items:this.state.items}),a["default"].createElement(v["default"],null))}}],[{key:"propTypes",value:{collectionId:c.PropTypes.string.isRequired,limit:c.PropTypes.oneOfType([c.PropTypes.number,c.PropTypes.string])},enumerable:!0},{key:"defaultProps",value:{collectionId:"561ba63445284e1740e016f7",limit:30},enumerable:!0}]),e}(c.Component);e["default"]=b,t.exports=e["default"]},function(t,e,n){var r;(function(t,o,i){(function(s){function u(t){return t&&t.Object===Object?t:null}function c(t){for(var e=t.length,n=new Array(e),r=0;e>r;r++)n[r]=t[r];return n}function a(t){return function(){try{return t.apply(this,arguments)}catch(e){return jt.e=e,jt}}}function l(t){throw t}function p(t,e){if(kt&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(Tt)){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var o=n.join("\n"+Tt+"\n");t.stack=h(o)}}function h(t){for(var e=t.split("\n"),n=[],r=0,o=e.length;o>r;r++){var i=e[r];f(i)||d(i)||!i||n.push(i)}return n.join("\n")}function f(t){var e=b(t);if(!e)return!1;var n=e[0],r=e[1];return n===Pt&&r>=Mt&&co>=r}function d(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function v(){if(kt)try{throw new Error}catch(t){var e=t.stack.split("\n"),n=e[0].indexOf("@")>0?e[1]:e[2],r=b(n);if(!r)return;return Pt=r[0],r[1]}}function b(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function y(t){var e=[];if(!de(t))return e;fe.nonEnumArgs&&t.length&&ve(t)&&(t=ye.call(t));var n=fe.enumPrototypes&&"function"==typeof t,r=fe.enumErrorProps&&(t===ue||t instanceof Error);for(var o in t)n&&"prototype"==o||r&&("message"==o||"name"==o)||e.push(o);if(fe.nonEnumShadows&&t!==ce){var i=t.constructor,s=-1,u=Ht;if(t===(i&&i.prototype))var c=t===ae?re:t===ue?Jt:oe.call(t),a=he[c];for(;++s<u;)o=Kt[s],a&&a[o]||!ie.call(t,o)||e.push(o)}return e}function m(t,e,n){for(var r=-1,o=n(t),i=o.length;++r<i;){var s=o[r];if(e(t[s],s,t)===!1)break}return t}function _(t,e){return m(t,e,y)}function g(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function w(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;var o=typeof t,i=typeof e;if(t===t&&(null==t||null==e||"function"!=o&&"object"!=o&&"function"!=i&&"object"!=i))return!1;var s=oe.call(t),u=oe.call(e);if(s==Qt&&(s=ee),u==Qt&&(u=ee),s!=u)return!1;switch(s){case Yt:case Gt:return+t==+e;case te:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case ne:case re:return t==String(e)}var c=s==$t;if(!c){if(s!=ee||!fe.nodeClass&&(g(t)||g(e)))return!1;var a=!fe.argsObject&&ve(t)?Object:t.constructor,l=!fe.argsObject&&ve(e)?Object:e.constructor;if(!(a==l||ie.call(t,"constructor")&&ie.call(e,"constructor")||Ot(a)&&a instanceof a&&Ot(l)&&l instanceof l||!("constructor"in t&&"constructor"in e)))return!1}n||(n=[]),r||(r=[]);for(var p=n.length;p--;)if(n[p]==t)return r[p]==e;var h=0,f=!0;if(n.push(t),r.push(e),c){if(p=t.length,h=e.length,f=h==p)for(;h--;){var d=e[h];if(!(f=w(t[h],d,n,r)))break}}else _(e,function(e,o,i){return ie.call(i,o)?(h++,f=ie.call(t,o)&&w(t[o],e,n,r)):void 0}),f&&_(t,function(t,e,n){return ie.call(n,e)?f=--h>-1:void 0});return n.pop(),r.pop(),f}function C(t,e){for(var n=new Array(t),r=0;t>r;r++)n[r]=e();return n}function x(t,e){this.id=t,this.value=e}function S(t){this._s=t,this.isDisposed=!1}function E(t){this._s=t}function O(t){this._s=t,this._l=t.length,this._i=0}function j(t){this._a=t}function D(t){this._a=t,this._l=M(t),this._i=0}function k(t){return"number"==typeof t&&yt.isFinite(t)}function N(t){var e,n=t[Vt];if(!n&&"string"==typeof t)return e=new E(t),e[Vt]();if(!n&&t.length!==s)return e=new j(t),e[Vt]();if(!n)throw new TypeError("Object is not iterable");return t[Vt]()}function P(t){var e=+t;return 0===e?e:isNaN(e)?e:0>e?-1:1}function M(t){var e=+t.length;return isNaN(e)?0:0!==e&&k(e)?(e=P(e)*Math.floor(Math.abs(e)),0>=e?0:e>jn?jn:e):e}function T(t,e){this.observer=t,this.parent=e}function A(t,e){var n=t.length;return function(r,o){n>r?(e.onNext(t[r]),o(r+1)):e.onCompleted()}}function L(t,e){return qe(t)||(t=Ue),new kn(e,t)}function R(t,e){this.observer=t,this.parent=e}function I(t,e){this.observer=t,this.parent=e}function F(){return!1}function V(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function F(){return!1}function V(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function F(){return!1}function U(){return[]}function F(){return!1}function U(){return[]}function V(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function W(t){return function(e){return t.subscribe(e)}}function z(t,e){return function(n){for(var r=n,o=0;e>o;o++){var i=r[t[o]];if("undefined"==typeof i)return s;r=i}return r}}function B(t,e,n,r){var o=new oo;return r.push(Z(o,e,n)),t.apply(e,r),o.asObservable()}function Z(t,e,n){return function(){for(var r=arguments.length,o=new Array(r),i=0;r>i;i++)o[i]=arguments[i];if(Ot(n)){if(o=Dt(n).apply(e,o),o===jt)return t.onError(o.e);t.onNext(o)}else o.length<=1?t.onNext(o[0]):t.onNext(o);t.onCompleted()}}function K(t,e,n,r){var o=new oo;return r.push(H(o,e,n)),t.apply(e,r),o.asObservable()}function H(t,e,n){return function(){var r=arguments[0];if(r)return t.onError(r);for(var o=arguments.length,i=[],s=1;o>s;s++)i[s-1]=arguments[s];if(Ot(n)){var i=Dt(n).apply(e,i);if(i===jt)return t.onError(i.e);t.onNext(i)}else i.length<=1?t.onNext(i[0]):t.onNext(i);t.onCompleted()}}function Q(t){return yt.StaticNodeList?t instanceof yt.StaticNodeList||t instanceof yt.NodeList:"[object NodeList]"===Object.prototype.toString.call(t)}function $(t,e,n){this._e=t,this._n=e,this._fn=n,this._e.addEventListener(this._n,this._fn,!1),this.isDisposed=!1}function Y(t,e,n){var r=new ge,o=Object.prototype.toString.call(t);if(Q(t)||"[object HTMLCollection]"===o)for(var i=0,s=t.length;s>i;i++)r.add(Y(t.item(i),e,n));else t&&r.add(new $(t,e,n));return r}function G(t,e){return new Wr(t,e)}function J(t,e,n){return new to(function(r){var o=t,i=Ae(e);return n.scheduleRecursiveFuture(0,o,function(t,e){if(i>0){var s=n.now();o=new Date(o.getTime()+i),o.getTime()<=s&&(o=new Date(s+i))}r.onNext(t),e(t+1,new Date(o))})})}function X(t,e,n){return t===e?new to(function(t){return n.schedulePeriodic(0,e,function(e){return t.onNext(e),e+1})}):wn(function(){return J(new Date(n.now()+t),e,n)})}function tt(t,e,n){return new to(function(r){var o,i=!1,s=new ke,u=null,c=[],a=!1;return o=t.materialize().timestamp(n).subscribe(function(t){var o,l;"E"===t.value.kind?(c=[],c.push(t),u=t.value.error,l=!a):(c.push({value:t.value,timestamp:t.timestamp+e}),l=!i,i=!0),l&&(null!==u?r.onError(u):(o=new De,s.setDisposable(o),o.setDisposable(n.scheduleRecursiveFuture(null,e,function(t,e){var o,s,l,p;if(null===u){a=!0;do l=null,c.length>0&&c[0].timestamp-n.now()<=0&&(l=c.shift().value),null!==l&&l.accept(r);while(null!==l);p=!1,s=0,c.length>0?(p=!0,s=Math.max(0,c[0].timestamp-n.now())):i=!1,o=u,a=!1,null!==o?r.onError(o):p&&e(null,s)}}))))}),new Ne(o,s)},t)}function et(t,e,n){return wn(function(){return tt(t,e-n.now(),n)})}function nt(t,e,n){var r,o;return Ot(e)?o=e:(r=e,o=n),new to(function(e){function n(){c.setDisposable(t.subscribe(function(t){var n=Dt(o)(t);if(n===jt)return e.onError(n.e);var r=new De;s.add(r),r.setDisposable(n.subscribe(function(){e.onNext(t),s.remove(r),i()},function(t){e.onError(t)},function(){e.onNext(t),s.remove(r),i()}))},function(t){e.onError(t)},function(){u=!0,c.dispose(),i()}))}function i(){u&&0===s.length&&e.onCompleted()}var s=new ge,u=!1,c=new ke;return r?c.setDisposable(r.subscribe(n,function(t){e.onError(t)},n)):n(),new Ne(c,s)},this)}function rt(t,e){return new to(function(n){var r,o=!1,i=new ke,s=0,u=t.subscribe(function(t){var u=Dt(e)(t);if(u===jt)return n.onError(u.e);Et(u)&&(u=Ir(u)),o=!0,r=t,s++;var c=s,a=new De;i.setDisposable(a),a.setDisposable(u.subscribe(function(){o&&s===c&&n.onNext(r),o=!1,a.dispose()},function(t){n.onError(t)},function(){o&&s===c&&n.onNext(r),o=!1,a.dispose()}))},function(t){i.dispose(),n.onError(t),o=!1,s++},function(){i.dispose(),o&&n.onNext(r),n.onCompleted(),o=!1,s++});return new Ne(u,i)},t)}function ot(t,e){return new to(function(n){function r(){s&&(s=!1,n.onNext(o)),i&&n.onCompleted()}var o,i=!1,s=!1,u=new De;return u.setDisposable(t.subscribe(function(t){s=!0,o=t},function(t){n.onError(t)},function(){i=!0,u.dispose()})),new Ne(u,e.subscribe(r,function(t){n.onError(t)},r))},t)}function it(t,e,n,r){return Ot(e)&&(r=n,n=e,e=Tn()),r||(r=Vn(new Qr)),new to(function(o){function i(t){function e(){return p=n===l}var n=l,i=new De;c.setDisposable(i),i.setDisposable(t.subscribe(function(){
e()&&u.setDisposable(r.subscribe(o)),i.dispose()},function(t){e()&&o.onError(t)},function(){e()&&u.setDisposable(r.subscribe(o))}))}function s(){var t=!p;return t&&l++,t}var u=new ke,c=new ke,a=new De;u.setDisposable(a);var l=0,p=!1;return i(e),a.setDisposable(t.subscribe(function(t){if(s()){o.onNext(t);var e=Dt(n)(t);if(e===jt)return o.onError(e.e);i(Et(e)?Ir(e):e)}},function(t){s()&&o.onError(t)},function(){s()&&o.onCompleted()})),new Ne(u,c)},t)}function st(t,e,n,r){return qe(n)&&(r=n,n=Vn(new Qr)),n instanceof Error&&(n=Vn(n)),qe(r)||(r=Ke),new to(function(o){function i(){var t=s;l.setDisposable(r.scheduleFuture(null,e,function(){a=s===t,a&&(Et(n)&&(n=Ir(n)),c.setDisposable(n.subscribe(o)))}))}var s=0,u=new De,c=new ke,a=!1,l=new ke;return c.setDisposable(u),i(),u.setDisposable(t.subscribe(function(t){a||(s++,o.onNext(t),i())},function(t){a||(s++,o.onError(t))},function(){a||(s++,o.onCompleted())})),new Ne(c,l)},t)}function ut(t,e,n){return new to(function(r){function o(t,e){if(a[e]=t,s[e]=!0,u||(u=s.every(gt))){if(i)return r.onError(i);var o=Dt(n).apply(null,a);if(o===jt)return r.onError(o.e);r.onNext(o)}c&&a[1]&&r.onCompleted()}var i,s=[!1,!1],u=!1,c=!1,a=new Array(2);return new Ne(t.subscribe(function(t){o(t,0)},function(t){a[1]?r.onError(t):i=t},function(){c=!0,a[1]&&r.onCompleted()}),e.subscribe(function(t){o(t,1)},function(t){r.onError(t)},function(){c=!0,o(!0,1)}))},t)}function ct(t){return{"@@transducer/init":function(){return t},"@@transducer/step":function(t,e){return t.onNext(e)},"@@transducer/result":function(t){return t.onCompleted()}}}var at={"function":!0,object:!0},lt=at[typeof e]&&e&&!e.nodeType?e:null,pt=at[typeof t]&&t&&!t.nodeType?t:null,ht=u(lt&&pt&&"object"==typeof o&&o),ft=u(at[typeof self]&&self),dt=u(at[typeof window]&&window),vt=pt&&pt.exports===lt?lt:null,bt=u(at[typeof this]&&this),yt=ht||dt!==(bt&&bt.window)&&dt||ft||bt||Function("return this")(),mt={internals:{},config:{Promise:yt.Promise},helpers:{}},_t=mt.helpers.noop=function(){},gt=mt.helpers.identity=function(t){return t},wt=mt.helpers.defaultNow=Date.now,Ct=mt.helpers.defaultComparer=function(t,e){return be(t,e)},xt=mt.helpers.defaultSubComparer=function(t,e){return t>e?1:e>t?-1:0},St=(mt.helpers.defaultKeySerializer=function(t){return t.toString()},mt.helpers.defaultError=function(t){throw t}),Et=mt.helpers.isPromise=function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then},Ot=mt.helpers.isFunction=function(){var t=function(t){return"function"==typeof t||!1};return t(/x/)&&(t=function(t){return"function"==typeof t&&"[object Function]"==oe.call(t)}),t}(),jt={e:{}},Dt=mt.internals.tryCatch=function(t){if(!Ot(t))throw new TypeError("fn must be a function");return a(t)};mt.config.longStackSupport=!1;var kt=!1,Nt=Dt(function(){throw new Error})();kt=!!Nt.e&&!!Nt.e.stack;var Pt,Mt=v(),Tt="From previous event:",At=mt.EmptyError=function(){this.message="Sequence contains no elements.",Error.call(this)};At.prototype=Object.create(Error.prototype),At.prototype.name="EmptyError";var qt=mt.ObjectDisposedError=function(){this.message="Object has been disposed",Error.call(this)};qt.prototype=Object.create(Error.prototype),qt.prototype.name="ObjectDisposedError";var Lt=mt.ArgumentOutOfRangeError=function(){this.message="Argument out of range",Error.call(this)};Lt.prototype=Object.create(Error.prototype),Lt.prototype.name="ArgumentOutOfRangeError";var Rt=mt.NotSupportedError=function(t){this.message=t||"This operation is not supported",Error.call(this)};Rt.prototype=Object.create(Error.prototype),Rt.prototype.name="NotSupportedError";var It=mt.NotImplementedError=function(t){this.message=t||"This operation is not implemented",Error.call(this)};It.prototype=Object.create(Error.prototype),It.prototype.name="NotImplementedError";var Ft=mt.helpers.notImplemented=function(){throw new It},Vt=(mt.helpers.notSupported=function(){throw new Rt},"function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_");yt.Set&&"function"==typeof(new yt.Set)["@@iterator"]&&(Vt="@@iterator");var Ut=mt.doneEnumerator={done:!0,value:s},Wt=mt.helpers.isIterable=function(t){return t&&t[Vt]!==s},zt=mt.helpers.isArrayLike=function(t){return t&&t.length!==s};mt.helpers.iterator=Vt;var Bt,Zt=mt.internals.bindCallback=function(t,e,n){if("undefined"==typeof e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},Kt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Ht=Kt.length,Qt="[object Arguments]",$t="[object Array]",Yt="[object Boolean]",Gt="[object Date]",Jt="[object Error]",Xt="[object Function]",te="[object Number]",ee="[object Object]",ne="[object RegExp]",re="[object String]",oe=Object.prototype.toString,ie=Object.prototype.hasOwnProperty,se=oe.call(arguments)==Qt,ue=Error.prototype,ce=Object.prototype,ae=String.prototype,le=ce.propertyIsEnumerable;try{Bt=!(oe.call(document)==ee&&!({toString:0}+""))}catch(pe){Bt=!0}var he={};he[$t]=he[Gt]=he[te]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},he[Yt]=he[re]={constructor:!0,toString:!0,valueOf:!0},he[Jt]=he[Xt]=he[ne]={constructor:!0,toString:!0},he[ee]={constructor:!0};var fe={};!function(){var t=function(){this.x=1},e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments);fe.enumErrorProps=le.call(ue,"message")||le.call(ue,"name"),fe.enumPrototypes=le.call(t,"prototype"),fe.nonEnumArgs=0!=n,fe.nonEnumShadows=!/valueOf/.test(e)}(1);var de=mt.internals.isObject=function(t){var e=typeof t;return t&&("function"==e||"object"==e)||!1},ve=function(t){return t&&"object"==typeof t?oe.call(t)==Qt:!1};se||(ve=function(t){return t&&"object"==typeof t?ie.call(t,"callee"):!1});var be=mt.internals.isEqual=function(t,e){return w(t,e,[],[])},ye=({}.hasOwnProperty,Array.prototype.slice),me=mt.internals.inherits=function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n},_e=mt.internals.addProperties=function(t){for(var e=[],n=1,r=arguments.length;r>n;n++)e.push(arguments[n]);for(var o=0,i=e.length;i>o;o++){var s=e[o];for(var u in s)t[u]=s[u]}},ge=(mt.internals.addRef=function(t,e){return new to(function(n){return new Ne(e.getDisposable(),t.subscribe(n))})},mt.CompositeDisposable=function(){var t,e,n=[];if(Array.isArray(arguments[0]))n=arguments[0],e=n.length;else for(e=arguments.length,n=new Array(e),t=0;e>t;t++)n[t]=arguments[t];this.disposables=n,this.isDisposed=!1,this.length=n.length}),we=ge.prototype;we.add=function(t){this.isDisposed?t.dispose():(this.disposables.push(t),this.length++)},we.remove=function(t){var e=!1;if(!this.isDisposed){var n=this.disposables.indexOf(t);-1!==n&&(e=!0,this.disposables.splice(n,1),this.length--,t.dispose())}return e},we.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=this.disposables.length,e=new Array(t),n=0;t>n;n++)e[n]=this.disposables[n];for(this.disposables=[],this.length=0,n=0;t>n;n++)e[n].dispose()}};var Ce=mt.Disposable=function(t){this.isDisposed=!1,this.action=t||_t};Ce.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var xe=Ce.create=function(t){return new Ce(t)},Se=Ce.empty={dispose:_t},Ee=Ce.isDisposable=function(t){return t&&Ot(t.dispose)},Oe=Ce.checkDisposed=function(t){if(t.isDisposed)throw new qt},je=Ce._fixup=function(t){return Ee(t)?t:Se},De=mt.SingleAssignmentDisposable=function(){this.isDisposed=!1,this.current=null};De.prototype.getDisposable=function(){return this.current},De.prototype.setDisposable=function(t){if(this.current)throw new Error("Disposable has already been assigned");var e=this.isDisposed;!e&&(this.current=t),e&&t&&t.dispose()},De.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null,t&&t.dispose()}};var ke=mt.SerialDisposable=function(){this.isDisposed=!1,this.current=null};ke.prototype.getDisposable=function(){return this.current},ke.prototype.setDisposable=function(t){var e=this.isDisposed;if(!e){var n=this.current;this.current=t}n&&n.dispose(),e&&t&&t.dispose()},ke.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null}t&&t.dispose()};var Ne=mt.BinaryDisposable=function(t,e){this._first=t,this._second=e,this.isDisposed=!1};Ne.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this._first;this._first=null,t&&t.dispose();var e=this._second;this._second=null,e&&e.dispose()}};var Pe=mt.NAryDisposable=function(t){this._disposables=t,this.isDisposed=!1};Pe.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=0,e=this._disposables.length;e>t;t++)this._disposables[t].dispose();this._disposables.length=0}};var Me=(mt.RefCountDisposable=function(){function t(t){this.disposable=t,this.disposable.count++,this.isInnerDisposed=!1}function e(t){this.underlyingDisposable=t,this.isDisposed=!1,this.isPrimaryDisposed=!1,this.count=0}return t.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,0===this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))},e.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))},e.prototype.getDisposable=function(){return this.isDisposed?Se:new t(this)},e}(),mt.internals.ScheduledItem=function(t,e,n,r,o){this.scheduler=t,this.state=e,this.action=n,this.dueTime=r,this.comparer=o||xt,this.disposable=new De});Me.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())},Me.prototype.compareTo=function(t){return this.comparer(this.dueTime,t.dueTime)},Me.prototype.isCancelled=function(){return this.disposable.isDisposed},Me.prototype.invokeCore=function(){return je(this.action(this.scheduler,this.state))};var Te=mt.Scheduler=function(){function t(){}t.isScheduler=function(e){return e instanceof t};var e=t.prototype;return e.schedule=function(t,e){throw new It},e.scheduleFuture=function(e,n,r){var o=n;return o instanceof Date&&(o-=this.now()),o=t.normalize(o),0===o?this.schedule(e,r):this._scheduleFuture(e,o,r)},e._scheduleFuture=function(t,e,n){throw new It},t.now=wt,t.prototype.now=wt,t.normalize=function(t){return 0>t&&(t=0),t},t}(),Ae=Te.normalize,qe=Te.isScheduler;!function(t){function e(t,e){function n(e){function r(t,e){return s?i.remove(c):u=!0,o(e,n),Se}var s=!1,u=!1,c=t.schedule(e,r);u||(i.add(c),s=!0)}var r=e[0],o=e[1],i=new ge;return o(r,n),i}function n(t,e){function n(e,r){function s(t,e){return u?i.remove(a):c=!0,o(e,n),Se}var u=!1,c=!1,a=t.scheduleFuture(e,r,s);c||(i.add(a),u=!0)}var r=e[0],o=e[1],i=new ge;return o(r,n),i}t.scheduleRecursive=function(t,n){return this.schedule([t,n],e)},t.scheduleRecursiveFuture=function(t,e,r){return this.scheduleFuture([t,r],e,n)}}(Te.prototype),function(t){Te.prototype.schedulePeriodic=function(t,e,n){if("undefined"==typeof yt.setInterval)throw new Rt;e=Ae(e);var r=t,o=yt.setInterval(function(){r=n(r)},e);return xe(function(){yt.clearInterval(o)})}}(Te.prototype);var Le,Re,Ie=function(t){function e(){t.call(this)}return me(e,t),e.prototype.schedule=function(t,e){return je(e(this,t))},e}(Te),Fe=Te.immediate=new Ie,Ve=function(t){function e(){for(;r.length>0;){var t=r.dequeue();!t.isCancelled()&&t.invoke()}}function n(){t.call(this)}var r;return me(n,t),n.prototype.schedule=function(t,n){var o=new Me(this,t,n,this.now());if(r)r.enqueue(o);else{r=new He(4),r.enqueue(o);var i=Dt(e)();r=null,i===jt&&l(i.e)}return o.disposable},n.prototype.scheduleRequired=function(){return!r},n}(Te),Ue=Te.currentThread=new Ve,We=(mt.internals.SchedulePeriodicRecursive=function(){function t(t){return function(e,n){n(0,t._period);var r=Dt(t._action)(t._state);r===jt&&(t._cancel.dispose(),l(r.e)),t._state=r}}function e(t,e,n,r){this._scheduler=t,this._state=e,this._period=n,this._action=r}return e.prototype.start=function(){var e=new De;return this._cancel=e,e.setDisposable(this._scheduler.scheduleRecursiveFuture(0,this._period,t(this))),e},e}(),function(){var t,e=_t;if(yt.setTimeout)t=yt.setTimeout,e=yt.clearTimeout;else{if(!yt.WScript)throw new Rt;t=function(t,e){yt.WScript.Sleep(e),t()}}return{setTimeout:t,clearTimeout:e}}()),ze=We.setTimeout,Be=We.clearTimeout;!function(){function t(e){if(o)ze(function(){t(e)},0);else{var n=r[e];if(n){o=!0;var i=Dt(n)();Re(e),o=!1,i===jt&&l(i.e)}}}function e(){if(!yt.postMessage||yt.importScripts)return!1;var t=!1,e=yt.onmessage;return yt.onmessage=function(){t=!0},yt.postMessage("","*"),yt.onmessage=e,t}var n=1,r={},o=!1;Re=function(t){delete r[t]};var s=new RegExp("^"+String(oe).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),u="function"==typeof(u=ht&&vt&&ht.setImmediate)&&!s.test(u)&&u;if(Ot(u))Le=function(e){var o=n++;return r[o]=e,u(function(){t(o)}),o};else if("undefined"!=typeof i&&"[object process]"==={}.toString.call(i))Le=function(e){var o=n++;return r[o]=e,i.nextTick(function(){t(o)}),o};else if(e()){var c="ms.rx.schedule"+Math.random(),a=function(e){"string"==typeof e.data&&e.data.substring(0,c.length)===c&&t(e.data.substring(c.length))};yt.addEventListener("message",a,!1),Le=function(t){var e=n++;return r[e]=t,yt.postMessage(c+currentId,"*"),e}}else if(yt.MessageChannel){var p=new yt.MessageChannel;p.port1.onmessage=function(e){t(e.data)},Le=function(t){var e=n++;return r[e]=t,p.port2.postMessage(e),e}}else Le="document"in yt&&"onreadystatechange"in yt.document.createElement("script")?function(e){var o=yt.document.createElement("script"),i=n++;return r[i]=e,o.onreadystatechange=function(){t(i),o.onreadystatechange=null,o.parentNode.removeChild(o),o=null},yt.document.documentElement.appendChild(o),i}:function(e){var o=n++;return r[o]=e,ze(function(){t(o)},0),o}}();var Ze=function(t){function e(){t.call(this)}function n(t,e,n,r){return function(){!t.isDisposed&&t.setDisposable(Ce._fixup(e(n,r)))}}function r(t,e){this._id=e,this._method=t,this.isDisposed=!1}return me(e,t),r.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._method.call(null,this._id))},e.prototype.schedule=function(t,e){var o=new De,i=Le(n(o,e,this,t));return new Ne(o,new r(Re,i))},e.prototype._scheduleFuture=function(t,e,o){if(0===e)return this.schedule(t,o);var i=new De,s=ze(n(i,o,this,t),e);return new Ne(i,new r(Be,s))},e}(Te),Ke=Te["default"]=Te.async=new Ze;x.prototype.compareTo=function(t){var e=this.value.compareTo(t.value);return 0===e&&(e=this.id-t.id),e};var He=mt.internals.PriorityQueue=function(t){this.items=new Array(t),this.length=0},Qe=He.prototype;Qe.isHigherPriority=function(t,e){return this.items[t].compareTo(this.items[e])<0},Qe.percolate=function(t){if(!(t>=this.length||0>t)){var e=t-1>>1;if(!(0>e||e===t)&&this.isHigherPriority(t,e)){var n=this.items[t];this.items[t]=this.items[e],this.items[e]=n,this.percolate(e)}}},Qe.heapify=function(t){if(+t||(t=0),!(t>=this.length||0>t)){var e=2*t+1,n=2*t+2,r=t;if(e<this.length&&this.isHigherPriority(e,r)&&(r=e),n<this.length&&this.isHigherPriority(n,r)&&(r=n),r!==t){var o=this.items[t];this.items[t]=this.items[r],this.items[r]=o,this.heapify(r)}}},Qe.peek=function(){return this.items[0].value},Qe.removeAt=function(t){this.items[t]=this.items[--this.length],this.items[this.length]=s,this.heapify()},Qe.dequeue=function(){var t=this.peek();return this.removeAt(0),t},Qe.enqueue=function(t){var e=this.length++;this.items[e]=new x(He.count++,t),this.percolate(e)},Qe.remove=function(t){for(var e=0;e<this.length;e++)if(this.items[e].value===t)return this.removeAt(e),!0;return!1},He.count=0;var $e,Ye=mt.Notification=function(){function t(){}return t.prototype._accept=function(t,e,n){throw new It},t.prototype._acceptObservable=function(t,e,n){throw new It},t.prototype.accept=function(t,e,n){return t&&"object"==typeof t?this._acceptObservable(t):this._accept(t,e,n)},t.prototype.toObservable=function(t){var e=this;return qe(t)||(t=Fe),new to(function(n){return t.schedule(e,function(t,e){e._acceptObservable(n),"N"===e.kind&&n.onCompleted()})})},t}(),Ge=function(t){function e(t){this.value=t,this.kind="N"}return me(e,t),e.prototype._accept=function(t){return t(this.value)},e.prototype._acceptObservable=function(t){return t.onNext(this.value)},e.prototype.toString=function(){return"OnNext("+this.value+")"},e}(Ye),Je=function(t){function e(t){this.error=t,this.kind="E"}return me(e,t),e.prototype._accept=function(t,e){return e(this.error)},e.prototype._acceptObservable=function(t){return t.onError(this.error)},e.prototype.toString=function(){return"OnError("+this.error+")"},e}(Ye),Xe=function(t){function e(){this.kind="C"}return me(e,t),e.prototype._accept=function(t,e,n){return n()},e.prototype._acceptObservable=function(t){return t.onCompleted()},e.prototype.toString=function(){return"OnCompleted()"},e}(Ye),tn=Ye.createOnNext=function(t){return new Ge(t)},en=Ye.createOnError=function(t){return new Je(t)},nn=Ye.createOnCompleted=function(){return new Xe},rn=mt.Observer=function(){},on=rn.create=function(t,e,n){return t||(t=_t),e||(e=St),n||(n=_t),new un(t,e,n)},sn=mt.internals.AbstractObserver=function(t){function e(){this.isStopped=!1}return me(e,t),e.prototype.next=Ft,e.prototype.error=Ft,e.prototype.completed=Ft,e.prototype.onNext=function(t){!this.isStopped&&this.next(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.error(t))},e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.error(t),!0)},e}(rn),un=mt.AnonymousObserver=function(t){function e(e,n,r){t.call(this),this._onNext=e,this._onError=n,this._onCompleted=r}return me(e,t),e.prototype.next=function(t){this._onNext(t)},e.prototype.error=function(t){this._onError(t)},e.prototype.completed=function(){this._onCompleted()},e}(sn),cn=mt.Observable=function(){function t(t,e){return function(n){var r=n.onError;return n.onError=function(e){p(e,t),r.call(n,e)},e.call(t,n)}}function e(){if(mt.config.longStackSupport&&kt){var e=this._subscribe,n=Dt(l)(new Error).e;this.stack=n.stack.substring(n.stack.indexOf("\n")+1),this._subscribe=t(this,e)}}return $e=e.prototype,e.isObservable=function(t){return t&&Ot(t.subscribe)},$e.subscribe=$e.forEach=function(t,e,n){return this._subscribe("object"==typeof t?t:on(t,e,n))},$e.subscribeOnNext=function(t,e){return this._subscribe(on("undefined"!=typeof e?function(n){t.call(e,n)}:t))},$e.subscribeOnError=function(t,e){return this._subscribe(on(null,"undefined"!=typeof e?function(n){t.call(e,n)}:t))},$e.subscribeOnCompleted=function(t,e){return this._subscribe(on(null,null,"undefined"!=typeof e?function(){t.call(e)}:t))},e}(),an=mt.internals.ScheduledObserver=function(t){function e(e,n){t.call(this),this.scheduler=e,this.observer=n,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new ke}return me(e,t),e.prototype.next=function(t){var e=this;this.queue.push(function(){e.observer.onNext(t)})},e.prototype.error=function(t){var e=this;this.queue.push(function(){e.observer.onError(t)})},e.prototype.completed=function(){var t=this;this.queue.push(function(){t.observer.onCompleted()})},e.prototype.ensureActive=function(){var t=!1;!this.hasFaulted&&this.queue.length>0&&(t=!this.isAcquired,this.isAcquired=!0),t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(this,function(t,e){var n;if(!(t.queue.length>0))return void(t.isAcquired=!1);n=t.queue.shift();var r=Dt(n)();return r===jt?(t.queue=[],t.hasFaulted=!0,l(r.e)):void e(t)}))},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.disposable.dispose()},e}(sn),ln=mt.ObservableBase=function(t){function e(t){return t&&Ot(t.dispose)?t:Ot(t)?xe(t):Se}function n(t,n){var r=n[0],o=n[1],i=Dt(o.subscribeCore).call(o,r);i!==jt||r.fail(jt.e)||l(jt.e),r.setDisposable(e(i))}function r(){t.call(this)}return me(r,t),r.prototype._subscribe=function(t){var e=new eo(t),r=[e,this];return Ue.scheduleRequired()?Ue.schedule(r,n):n(null,r),e},r.prototype.subscribeCore=Ft,r}(cn),pn=mt.FlatMapObservable=function(t){function e(e,n,r,o){this.resultSelector=Ot(r)?r:null,this.selector=Zt(Ot(n)?n:function(){return n},o,3),this.source=e,t.call(this)}function n(t,e,n,r){this.i=0,this.selector=e,this.resultSelector=n,this.source=r,this.o=t,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.selector,this.resultSelector,this))},me(n,sn),n.prototype._wrapResult=function(t,e,n){return this.resultSelector?t.map(function(t,r){return this.resultSelector(e,t,n,r)},this):t},n.prototype.next=function(t){var e=this.i++,n=Dt(this.selector)(t,e,this.source);return n===jt?this.o.onError(n.e):(Et(n)&&(n=Ir(n)),(zt(n)||Wt(n))&&(n=cn.from(n)),void this.o.onNext(this._wrapResult(n,t,e)))},n.prototype.error=function(t){this.o.onError(t)},n.prototype.onCompleted=function(){this.o.onCompleted()},e}(ln),hn=mt.internals.Enumerable=function(){};S.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.isDisposed=!0)};var fn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e,n){this._o=t,this._s=e,this._e=n,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e={isDisposed:!1},r=new ke,o=Ue.scheduleRecursive(this.sources[Vt](),function(o,i){if(!e.isDisposed){var s=Dt(o.next).call(o);if(s===jt)return t.onError(s.e);if(s.done)return t.onCompleted();var u=s.value;Et(u)&&(u=Ir(u));var c=new De;r.setDisposable(c),c.setDisposable(u.subscribe(new n(t,i,o)))}});return new Pe([r,o,new S(e)])},me(n,sn),n.prototype.onNext=function(t){this._o.onNext(t)},n.prototype.onError=function(t){this._o.onError(t)},n.prototype.onCompleted=function(){this._s(this._e)},e}(ln);hn.prototype.concat=function(){return new fn(this)};var dn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){this._o=t,this._recurse=e,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=this.sources[Vt](),r={isDisposed:!1},o=new ke,i=Ue.scheduleRecursive(null,function(i,s){if(!r.isDisposed){var u=Dt(e.next).call(e);if(u===jt)return t.onError(u.e);if(u.done)return null!==i?t.onError(i):t.onCompleted();var c=u.value;Et(c)&&(c=Ir(c));var a=new De;o.setDisposable(a),a.setDisposable(c.subscribe(new n(t,s)))}});return new Pe([o,i,new S(r)])},me(n,sn),n.prototype.next=function(t){this._o.onNext(t)},n.prototype.error=function(t){this._recurse(t)},n.prototype.completed=function(){this._o.onCompleted()},e}(ln);hn.prototype.catchError=function(){return new dn(this)},hn.prototype.catchErrorWhen=function(t){var e=this;return new to(function(n){var r,o=new ro,i=new ro,s=t(o),u=s.subscribe(i),c=e[Vt](),a={isDisposed:!1},l=new ke,p=Ue.scheduleRecursive(null,function(t,e){if(!a.isDisposed){var s=Dt(c.next).call(c);if(s===jt)return n.onError(s.e);if(s.done)return void(r?n.onError(r):n.onCompleted());var u=s.value;Et(u)&&(u=Ir(u));var p=new De,h=new De;l.setDisposable(new Ne(h,p)),p.setDisposable(u.subscribe(function(t){n.onNext(t)},function(t){h.setDisposable(i.subscribe(e,function(t){n.onError(t)},function(){n.onCompleted()})),o.onNext(t)},function(){n.onCompleted()}))}});return new Pe([u,l,p,new S(a)])})};var vn=function(t){function e(t,e){this.v=t,this.c=null==e?-1:e}function n(t){this.v=t.v,this.l=t.c}return me(e,t),e.prototype[Vt]=function(){return new n(this)},n.prototype.next=function(){return 0===this.l?Ut:(this.l>0&&this.l--,{done:!1,value:this.v})},e}(hn),bn=hn.repeat=function(t,e){return new vn(t,e)},yn=function(t){function e(t,e,n){this.s=t,this.fn=e?Zt(e,n,3):null}function n(t){this.i=-1,this.s=t.s,this.l=this.s.length,this.fn=t.fn}return me(e,t),e.prototype[Vt]=function(){return new n(this)},n.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:Ut},e}(hn),mn=hn.of=function(t,e,n){return new yn(t,e,n)},_n=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.a=[],sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},me(n,sn),n.prototype.next=function(t){this.a.push(t)},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.o.onNext(this.a),this.o.onCompleted()},e}(ln);$e.toArray=function(){return new _n(this)},cn.create=function(t,e){return new to(t,e)};var gn=function(t){function e(e){this._f=e,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=Dt(this._f)();return e===jt?Vn(e.e).subscribe(t):(Et(e)&&(e=Ir(e)),e.subscribe(t))},e}(ln),wn=cn.defer=function(t){return new gn(t)},Cn=function(t){function e(e){this.scheduler=e,t.call(this)}function n(t,e){this.observer=t,this.scheduler=e}function r(t,e){return e.onCompleted(),Se}return me(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this.scheduler);return e.run()},n.prototype.run=function(){var t=this.observer;return this.scheduler===Fe?r(null,t):this.scheduler.schedule(t,r)},e}(ln),xn=new Cn(Fe),Sn=cn.empty=function(t){return qe(t)||(t=Fe),t===Fe?xn:new Cn(t)},En=function(t){function e(e,n,r){this.iterable=e,this.mapper=n,this.scheduler=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new On(t,this);return e.run()},e}(ln),On=function(){function t(t,e){this.o=t,this.parent=e}return t.prototype.run=function(){function t(t,e){var i=Dt(n.next).call(n);if(i===jt)return r.onError(i.e);if(i.done)return r.onCompleted();var s=i.value;return Ot(o)&&(s=Dt(o)(s,t),s===jt)?r.onError(s.e):(r.onNext(s),void e(t+1))}var e=Object(this.parent.iterable),n=N(e),r=this.o,o=this.parent.mapper;return this.parent.scheduler.scheduleRecursive(0,t)},t}(),jn=Math.pow(2,53)-1;E.prototype[Vt]=function(){return new O(this._s)},O.prototype[Vt]=function(){return this},O.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:Ut},j.prototype[Vt]=function(){return new D(this._a)},D.prototype[Vt]=function(){return this},D.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:Ut};var Dn=cn.from=function(t,e,n,r){if(null==t)throw new Error("iterable cannot be null.");if(e&&!Ot(e))throw new Error("mapFn when provided must be a function");if(e)var o=Zt(e,n,2);return qe(r)||(r=Ue),new En(t,o,r)},kn=function(t){function e(e,n){this.args=e,this.scheduler=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new T(t,this);return e.run()},e}(ln);T.prototype.run=function(){return this.parent.scheduler.scheduleRecursive(0,A(this.parent.args,this.observer))};var Nn=cn.fromArray=function(t,e){return qe(e)||(e=Ue),new kn(t,e)},Pn=function(t){function e(){t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return Se},e}(ln),Mn=new Pn,Tn=cn.never=function(){return Mn};cn.of=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return new kn(e,Ue)},cn.ofWithScheduler=function(t){for(var e=arguments.length,n=new Array(e-1),r=1;e>r;r++)n[r-1]=arguments[r];return new kn(n,t)};var An=function(t){function e(e,n){this.obj=e,this.keys=Object.keys(e),this.scheduler=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new R(t,this);return e.run()},e}(ln);R.prototype.run=function(){function t(t,i){if(o>t){var s=r[t];e.onNext([s,n[s]]),i(t+1)}else e.onCompleted()}var e=this.observer,n=this.parent.obj,r=this.parent.keys,o=r.length;return this.parent.scheduler.scheduleRecursive(0,t)},cn.pairs=function(t,e){return e||(e=Ue),new An(t,e)};var qn=function(t){function e(e,n,r){this.start=e,this.rangeCount=n,this.scheduler=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new Ln(t,this);return e.run()},e}(ln),Ln=function(){function t(t,e){this.observer=t,this.parent=e}function e(t,e,n){return function(r,o){e>r?(n.onNext(t+r),o(r+1)):n.onCompleted()}}return t.prototype.run=function(){return this.parent.scheduler.scheduleRecursive(0,e(this.parent.start,this.parent.rangeCount,this.observer))},t}();cn.range=function(t,e,n){return qe(n)||(n=Ue),new qn(t,e,n)};var Rn=function(t){function e(e,n,r){this.value=e,this.repeatCount=null==n?-1:n,this.scheduler=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new I(t,this);return e.run()},e}(ln);I.prototype.run=function(){function t(t,r){return(-1===t||t>0)&&(e.onNext(n),t>0&&t--),0===t?e.onCompleted():void r(t)}var e=this.observer,n=this.parent.value;return this.parent.scheduler.scheduleRecursive(this.parent.repeatCount,t)},cn.repeat=function(t,e,n){return qe(n)||(n=Ue),new Rn(t,e,n)};var In=function(t){function e(e,n){this.value=e,this.scheduler=n,t.call(this)}function n(t,e,n){this.observer=t,this.value=e,this.scheduler=n}function r(t,e){var n=e[0],r=e[1];return r.onNext(n),r.onCompleted(),Se}return me(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this.value,this.scheduler);return e.run()},n.prototype.run=function(){var t=[this.value,this.observer];return this.scheduler===Fe?r(null,t):this.scheduler.schedule(t,r)},e}(ln),Fn=(cn["return"]=cn.just=function(t,e){return qe(e)||(e=Fe),new In(t,e)},function(t){function e(e,n){this.error=e,this.scheduler=n,t.call(this)}function n(t,e){this.o=t,this.p=e}function r(t,e){var n=e[0],r=e[1];r.onError(n)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this);return e.run()},n.prototype.run=function(){return this.p.scheduler.schedule([this.p.error,this.o],r)},e}(ln)),Vn=cn["throw"]=function(t,e){return qe(e)||(e=Fe),new Fn(t,e)},Un=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new De,n=new ke;return n.setDisposable(e),e.setDisposable(this.source.subscribe(new Wn(t,n,this._fn))),n},e}(ln),Wn=function(t){function e(e,n,r){this._o=e,this._s=n,this._fn=r,t.call(this)}return me(e,t),e.prototype.next=function(t){this._o.onNext(t)},e.prototype.completed=function(){return this._o.onCompleted()},e.prototype.error=function(t){var e=Dt(this._fn)(t);if(e===jt)return this._o.onError(e.e);Et(e)&&(e=Ir(e));var n=new De;this._s.setDisposable(n),n.setDisposable(e.subscribe(this._o))},e}(sn);$e["catch"]=function(t){return Ot(t)?new Un(this,t):zn([this,t])};var zn=cn["catch"]=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;e>n;n++)t[n]=arguments[n]}return mn(t).catchError()};$e.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return Array.isArray(e[0])?e[0].unshift(this):e.unshift(this),Kn.apply(this,e)};var Bn=function(t){function e(e,n){this._params=e,this._cb=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){for(var e=this._params.length,n=new Array(e),r={hasValue:C(e,F),hasValueAll:!1,isDone:C(e,F),values:new Array(e)},o=0;e>o;o++){var i=this._params[o],s=new De;n[o]=s,Et(i)&&(i=Ir(i)),s.setDisposable(i.subscribe(new Zn(t,o,this._cb,r)))}return new Pe(n)},e}(ln),Zn=function(t){function e(e,n,r,o){this._o=e,this._i=n,this._cb=r,this._state=o,t.call(this)}function n(t){return function(e,n){return n!==t}}return me(e,t),e.prototype.next=function(t){if(this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll||(this._state.hasValueAll=this._state.hasValue.every(gt))){var e=Dt(this._cb).apply(null,this._state.values);if(e===jt)return this._o.onError(e.e);this._o.onNext(e)}else this._state.isDone.filter(n(this._i)).every(gt)&&this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._state.isDone[this._i]=!0,this._state.isDone.every(gt)&&this._o.onCompleted()},e}(sn),Kn=cn.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];
var r=Ot(e[t-1])?e.pop():V;return Array.isArray(e[0])&&(e=e[0]),new Bn(e,r)};$e.concat=function(){for(var t=[],e=0,n=arguments.length;n>e;e++)t.push(arguments[e]);return t.unshift(this),Qn.apply(null,t)};var Hn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){this.sources=t,this.o=e}return me(e,t),e.prototype.subscribeCore=function(t){var e=new n(this.sources,t);return e.run()},n.prototype.run=function(){var t,e=new ke,n=this.sources,r=n.length,o=this.o,i=Fe.scheduleRecursive(0,function(i,s){if(!t){if(i===r)return o.onCompleted();var u=n[i];Et(u)&&(u=Ir(u));var c=new De;e.setDisposable(c),c.setDisposable(u.subscribe(function(t){o.onNext(t)},function(t){o.onError(t)},function(){s(i+1)}))}});return new ge(e,i,xe(function(){t=!0}))},e}(ln),Qn=cn.concat=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(arguments.length);for(var e=0,n=arguments.length;n>e;e++)t[e]=arguments[e]}return new Hn(t)};$e.concatAll=function(){return this.merge(1)};var $n=function(t){function e(e,n){this.source=e,this.maxConcurrent=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ge;return e.add(this.source.subscribe(new Yn(t,this.maxConcurrent,e))),e},e}(ln),Yn=function(){function t(t,e,n){this.o=t,this.max=e,this.g=n,this.done=!1,this.q=[],this.activeCount=0,this.isStopped=!1}function e(t,e){this.parent=t,this.sad=e,this.isStopped=!1}return t.prototype.handleSubscribe=function(t){var n=new De;this.g.add(n),Et(t)&&(t=Ir(t)),n.setDisposable(t.subscribe(new e(this,n)))},t.prototype.onNext=function(t){this.isStopped||(this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(t)):this.q.push(t))},t.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},t.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.done=!0,0===this.activeCount&&this.o.onCompleted())},t.prototype.dispose=function(){this.isStopped=!0},t.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},e.prototype.onNext=function(t){this.isStopped||this.parent.o.onNext(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.o.onError(t))},e.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var t=this.parent;t.g.remove(this.sad),t.q.length>0?t.handleSubscribe(t.q.shift()):(t.activeCount--,t.done&&0===t.activeCount&&t.o.onCompleted())}},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(t),!0)},t}();$e.merge=function(t){return"number"!=typeof t?Gn(this,t):new $n(this,t)};var Gn=cn.merge=function(){var t,e,n=[],r=arguments.length;if(arguments[0])if(qe(arguments[0]))for(t=arguments[0],e=1;r>e;e++)n.push(arguments[e]);else for(t=Fe,e=0;r>e;e++)n.push(arguments[e]);else for(t=Fe,e=1;r>e;e++)n.push(arguments[e]);return Array.isArray(n[0])&&(n=n[0]),L(t,n).mergeAll()},Jn=mt.CompositeError=function(t){this.innerErrors=t,this.message="This contains multiple errors. Check the innerErrors",Error.call(this)};Jn.prototype=Object.create(Error.prototype),Jn.prototype.name="CompositeError";var Xn=function(t){function e(e){this.source=e,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ge,n=new De,r={isStopped:!1,errors:[],o:t};return e.add(n),n.setDisposable(this.source.subscribe(new tr(e,r))),e},e}(ln),tr=function(t){function e(e,n){this._group=e,this._state=n,t.call(this)}function n(t,e){0===e.length?t.onCompleted():1===e.length?t.onError(e[0]):t.onError(new Jn(e))}function r(e,n,r){this._inner=e,this._group=n,this._state=r,t.call(this)}return me(e,t),e.prototype.next=function(t){var e=new De;this._group.add(e),Et(t)&&(t=Ir(t)),e.setDisposable(t.subscribe(new r(e,this._group,this._state)))},e.prototype.error=function(t){this._state.errors.push(t),this._state.isStopped=!0,1===this._group.length&&n(this._state.o,this._state.errors)},e.prototype.completed=function(){this._state.isStopped=!0,1===this._group.length&&n(this._state.o,this._state.errors)},me(r,t),r.prototype.next=function(t){this._state.o.onNext(t)},r.prototype.error=function(t){this._state.errors.push(t),this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&n(this._state.o,this._state.errors)},r.prototype.completed=function(){this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&n(this._state.o,this._state.errors)},e}(sn);cn.mergeDelayError=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;e>n;n++)t[n]=arguments[n]}var r=L(null,t);return new Xn(r)};var er=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.g=e,this.isStopped=!1,this.done=!1}function r(t,e){this.parent=t,this.sad=e,this.isStopped=!1}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ge,r=new De;return e.add(r),r.setDisposable(this.source.subscribe(new n(t,e))),e},n.prototype.onNext=function(t){if(!this.isStopped){var e=new De;this.g.add(e),Et(t)&&(t=Ir(t)),e.setDisposable(t.subscribe(new r(this,e)))}},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.done=!0,1===this.g.length&&this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},r.prototype.onNext=function(t){this.isStopped||this.parent.o.onNext(t)},r.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.o.onError(t))},r.prototype.onCompleted=function(){if(!this.isStopped){var t=this.parent;this.isStopped=!0,t.g.remove(this.sad),t.done&&1===t.g.length&&t.o.onCompleted()}},r.prototype.dispose=function(){this.isStopped=!0},r.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(t),!0)},e}(ln);$e.mergeAll=function(){return new er(this)};var nr=function(t){function e(e,n){this._s=e,this._o=Et(n)?Ir(n):n,this._open=!1,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new De;e.setDisposable(this._s.subscribe(new rr(t,this))),Et(this._o)&&(this._o=Ir(this._o));var n=new De;return n.setDisposable(this._o.subscribe(new or(t,this,n))),new Ne(e,n)},e}(ln),rr=function(t){function e(e,n){this._o=e,this._p=n,t.call(this)}return me(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._p._open&&this._o.onCompleted()},e}(sn),or=function(t){function e(e,n,r){this._o=e,this._p=n,this._r=r,t.call(this)}return me(e,t),e.prototype.next=function(){this._p._open=!0,this._r.dispose()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._r.dispose()},e}(sn);$e.skipUntil=function(t){return new nr(this,t)};var ir=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.inner=e,this.stopped=!1,this.latest=0,this.hasLatest=!1,sn.call(this)}function r(t,e){this.parent=t,this.id=e,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ke,r=this.source.subscribe(new n(t,e));return new Ne(r,e)},me(n,sn),n.prototype.next=function(t){var e=new De,n=++this.latest;this.hasLatest=!0,this.inner.setDisposable(e),Et(t)&&(t=Ir(t)),e.setDisposable(t.subscribe(new r(this,n)))},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.stopped=!0,!this.hasLatest&&this.o.onCompleted()},me(r,sn),r.prototype.next=function(t){this.parent.latest===this.id&&this.parent.o.onNext(t)},r.prototype.error=function(t){this.parent.latest===this.id&&this.parent.o.onError(t)},r.prototype.completed=function(){this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.isStopped&&this.parent.o.onCompleted())},e}(ln);$e["switch"]=$e.switchLatest=function(){return new ir(this)};var sr=function(t){function e(e,n){this.source=e,this.other=Et(n)?Ir(n):n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return new Ne(this.source.subscribe(t),this.other.subscribe(new ur(t)))},e}(ln),ur=function(t){function e(e){this._o=e,t.call(this)}return me(e,t),e.prototype.next=function(){this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=_t,e}(sn);$e.takeUntil=function(t){return new sr(this,t)};var cr=function(t){function e(e,n,r){this._s=e,this._ss=n,this._cb=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){for(var e=this._ss.length,n={hasValue:C(e,F),hasValueAll:!1,values:new Array(e)},r=this._ss.length,o=new Array(r+1),i=0;r>i;i++){var s=this._ss[i],u=new De;Et(s)&&(s=Ir(s)),u.setDisposable(s.subscribe(new ar(t,i,n))),o[i]=u}var u=new De;return u.setDisposable(this._s.subscribe(new lr(t,this._cb,n))),o[r]=u,new Pe(o)},e}(ln),ar=function(t){function e(e,n,r){this._o=e,this._i=n,this._state=r,t.call(this)}return me(e,t),e.prototype.next=function(t){this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll=this._state.hasValue.every(gt)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=_t,e}(sn),lr=function(t){function e(e,n,r){this._o=e,this._cb=n,this._state=r,t.call(this)}return me(e,t),e.prototype.next=function(t){var e=[t].concat(this._state.values);if(this._state.hasValueAll){var n=Dt(this._cb).apply(null,e);return n===jt?this._o.onError(n.e):void this._o.onNext(n)}},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.withLatestFrom=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():V;return Array.isArray(e[0])&&(e=e[0]),new cr(this,e,r)};var pr=function(t){function e(e,n){this._s=e,this._cb=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=this._s.length,n=new Array(e);done=C(e,F),q=C(e,U);for(var r=0;e>r;r++){var o=this._s[r],i=new De;n[r]=i,Et(o)&&(o=Ir(o)),i.setDisposable(o.subscribe(new hr(t,r,this,q,done)))}return new Pe(n)},e}(ln),hr=function(t){function e(e,n,r,o,i){this._o=e,this._i=n,this._p=r,this._q=o,this._d=i,t.call(this)}function n(t){return t.length>0}function r(t){return t.shift()}function o(t){return function(e,n){return n!==t}}return me(e,t),e.prototype.next=function(t){if(this._q[this._i].push(t),this._q.every(n)){var e=this._q.map(r),i=Dt(this._p._cb).apply(null,e);if(i===jt)return this._o.onError(i.e);this._o.onNext(i)}else this._d.filter(o(this._i)).every(gt)&&this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._d[this._i]=!0,this._d.every(gt)&&this._o.onCompleted()},e}(sn);$e.zip=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():V;Array.isArray(e[0])&&(e=e[0]);var o=this;return e.unshift(o),new pr(e,r)},cn.zip=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];Array.isArray(e[0])&&(e=Ot(e[1])?e[0].concat(e[1]):e[0]);var r=e.shift();return r.zip.apply(r,e)},$e.zipIterable=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():V,o=this;return e.unshift(o),new to(function(t){for(var n=e.length,i=C(n,U),s=C(n,F),u=new Array(n),c=0;n>c;c++)!function(n){var c=e[n],a=new De;(zt(c)||Wt(c))&&(c=Dn(c)),a.setDisposable(c.subscribe(function(e){if(i[n].push(e),i.every(function(t){return t.length>0})){var u=i.map(function(t){return t.shift()}),c=Dt(r).apply(o,u);if(c===jt)return t.onError(c.e);t.onNext(c)}else s.filter(function(t,e){return e!==n}).every(gt)&&t.onCompleted()},function(e){t.onError(e)},function(){s[n]=!0,s.every(gt)&&t.onCompleted()})),u[n]=a}(c);return new ge(u)},o)},$e.asObservable=function(){return new to(W(this),this)};var fr=function(t){function e(e){this.source=e,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new dr(t))},e}(ln),dr=function(t){function e(e){this._o=e,t.call(this)}return me(e,t),e.prototype.next=function(t){t.accept(this._o)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.dematerialize=function(){return new fr(this)};var vr=function(t){function e(e,n,r){this.source=e,this.keyFn=n,this.comparer=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new br(t,this.keyFn,this.comparer))},e}(ln),br=function(t){function e(e,n,r){this.o=e,this.keyFn=n,this.comparer=r,this.hasCurrentKey=!1,this.currentKey=null,t.call(this)}return me(e,t),e.prototype.next=function(t){var e,n=t;return Ot(this.keyFn)&&(n=Dt(this.keyFn)(t),n===jt)?this.o.onError(n.e):this.hasCurrentKey&&(e=Dt(this.comparer)(this.currentKey,n),e===jt)?this.o.onError(e.e):void(this.hasCurrentKey&&e||(this.hasCurrentKey=!0,this.currentKey=n,this.o.onNext(t)))},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.o.onCompleted()},e}(sn);$e.distinctUntilChanged=function(t,e){return e||(e=Ct),new vr(this,t,e)};var yr=function(t){function e(e,n,r,o){this.source=e,this._oN=n,this._oE=r,this._oC=o,t.call(this)}function n(t,e){this.o=t,this.t=!e._oN||Ot(e._oN)?on(e._oN||_t,e._oE||_t,e._oC||_t):e._oN,this.isStopped=!1,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this))},me(n,sn),n.prototype.next=function(t){var e=Dt(this.t.onNext).call(this.t,t);e===jt&&this.o.onError(e.e),this.o.onNext(t)},n.prototype.error=function(t){var e=Dt(this.t.onError).call(this.t,t);return e===jt?this.o.onError(e.e):void this.o.onError(t)},n.prototype.completed=function(){var t=Dt(this.t.onCompleted).call(this.t);return t===jt?this.o.onError(t.e):void this.o.onCompleted()},e}(ln);$e["do"]=$e.tap=$e.doAction=function(t,e,n){return new yr(this,t,e,n)},$e.doOnNext=$e.tapOnNext=function(t,e){return this.tap("undefined"!=typeof e?function(n){t.call(e,n)}:t)},$e.doOnError=$e.tapOnError=function(t,e){return this.tap(_t,"undefined"!=typeof e?function(n){t.call(e,n)}:t)},$e.doOnCompleted=$e.tapOnCompleted=function(t,e){return this.tap(_t,null,"undefined"!=typeof e?function(){t.call(e)}:t)},$e["finally"]=function(t){var e=this;return new to(function(n){var r=Dt(e.subscribe).call(e,n);return r===jt?(t(),l(r.e)):xe(function(){var e=Dt(r.dispose).call(r);t(),e===jt&&l(e.e)})},this)};var mr=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.isStopped=!1}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},n.prototype.onNext=_t,n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.observer.onError(t),!0)},e}(ln);$e.ignoreElements=function(){return new mr(this)};var _r=function(t){function e(e,n){this.source=e,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new gr(t))},e}(ln),gr=function(t){function e(e){this._o=e,t.call(this)}return me(e,t),e.prototype.next=function(t){this._o.onNext(tn(t))},e.prototype.error=function(t){this._o.onNext(en(t)),this._o.onCompleted()},e.prototype.completed=function(){this._o.onNext(nn()),this._o.onCompleted()},e}(sn);$e.materialize=function(){return new _r(this)},$e.repeat=function(t){return bn(this,t).concat()},$e.retry=function(t){return bn(this,t).catchError()},$e.retryWhen=function(t){return bn(this).catchErrorWhen(t)};var wr=function(t){function e(e,n,r,o){this.source=e,this.accumulator=n,this.hasSeed=r,this.seed=o,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Cr(t,this))},e}(ln),Cr=function(t){function e(e,n){this._o=e,this._p=n,this._fn=n.accumulator,this._hs=n.hasSeed,this._s=n.seed,this._ha=!1,this._a=null,this._hv=!1,this._i=0,t.call(this)}return me(e,t),e.prototype.next=function(t){return!this._hv&&(this._hv=!0),this._ha?this._a=Dt(this._fn)(this._a,t,this._i,this._p):(this._a=this._hs?Dt(this._fn)(this._s,t,this._i,this._p):t,this._ha=!0),this._a===jt?this._o.onError(this._a.e):(this._o.onNext(this._a),void this._i++)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){!this._hv&&this._hs&&this._o.onNext(this._s),this._o.onCompleted()},e}(sn);$e.scan=function(){var t,e=!1,n=arguments[0];return 2===arguments.length&&(e=!0,t=arguments[1]),new wr(this,n,e,t)};var xr=function(t){function e(e,n){this.source=e,this._c=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Sr(t,this._c))},e}(ln),Sr=function(t){function e(e,n){this._o=e,this._c=n,this._q=[],t.call(this)}return me(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._o.onNext(this._q.shift())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.skipLast=function(t){if(0>t)throw new Lt;return new xr(this,t)},$e.startWith=function(){var t,e=0;arguments.length&&qe(arguments[0])?(t=arguments[0],e=1):t=Fe;for(var n=[],r=e,o=arguments.length;o>r;r++)n.push(arguments[r]);return mn([Nn(n,t),this]).concat()};var Er=function(t){function e(e,n){this._o=e,this._c=n,this._q=[],t.call(this)}return me(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(;this._q.length>0;)this._o.onNext(this._q.shift());this._o.onCompleted()},e}(sn);$e.takeLast=function(t){if(0>t)throw new Lt;var e=this;return new to(function(n){return e.subscribe(new Er(n,t))},e)},$e.flatMapConcat=$e.concatMap=function(t,e,n){return new pn(this,t,e,n).merge(1)};var Or=function(t){function e(e,n,r){this.source=e,this.selector=Zt(n,r,3),t.call(this)}function n(t,e){return function(n,r,o){return t.call(this,e.selector(n,r,o),r,o)}}function r(t,e,n){this.o=t,this.selector=e,this.source=n,this.i=0,sn.call(this)}return me(e,t),e.prototype.internalMap=function(t,r){return new e(this.source,n(t,this),r)},e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.selector,this))},me(r,sn),r.prototype.next=function(t){var e=Dt(this.selector)(t,this.i++,this.source);return e===jt?this.o.onError(e.e):void this.o.onNext(e)},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(ln);$e.map=$e.select=function(t,e){var n="function"==typeof t?t:function(){return t};return this instanceof Or?this.internalMap(n,e):new Or(this,n,e)},$e.pluck=function(){var t=arguments.length,e=new Array(t);if(0===t)throw new Error("List of properties cannot be empty.");for(var n=0;t>n;n++)e[n]=arguments[n];return this.map(z(e,t))},$e.flatMap=$e.selectMany=function(t,e,n){return new pn(this,t,e,n).mergeAll()},mt.Observable.prototype.flatMapLatest=function(t,e,n){return new pn(this,t,e,n).switchLatest()};var jr=function(t){function e(e,n){this.source=e,this.skipCount=n,t.call(this)}function n(t,e){this.c=e,this.r=e,this.o=t,this.isStopped=!1}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.skipCount))},n.prototype.onNext=function(t){this.isStopped||(this.r<=0?this.o.onNext(t):this.r--)},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},e}(ln);$e.skip=function(t){if(0>t)throw new Lt;return new jr(this,t)};var Dr=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new kr(t,this))},e}(ln),kr=function(t){function e(e,n){this._o=e,this._p=n,this._i=0,this._r=!1,t.call(this)}return me(e,t),e.prototype.next=function(t){if(!this._r){var e=Dt(this._p._fn)(t,this._i++,this._p);if(e===jt)return this._o.onError(e.e);this._r=!e}this._r&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.skipWhile=function(t,e){var n=Zt(t,e,3);return new Dr(this,n)};var Nr=function(t){function e(e,n){this.source=e,this.takeCount=n,t.call(this)}function n(t,e){this.o=t,this.c=e,this.r=e,this.isStopped=!1}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.takeCount))},n.prototype={onNext:function(t){this.isStopped||this.r-->0&&(this.o.onNext(t),this.r<=0&&this.o.onCompleted())},onError:function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},onCompleted:function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},dispose:function(){this.isStopped=!0},fail:function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)}},e}(ln);$e.take=function(t,e){if(0>t)throw new Lt;return 0===t?Sn(e):new Nr(this,t)};var Pr=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Mr(t,this))},e}(ln),Mr=function(t){function e(e,n){this._o=e,this._p=n,this._i=0,this._r=!0,t.call(this)}return me(e,t),e.prototype.next=function(t){return this._r&&(this._r=Dt(this._p._fn)(t,this._i++,this._p),this._r===jt)?this._o.onError(this._r.e):void(this._r?this._o.onNext(t):this._o.onCompleted())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.takeWhile=function(t,e){var n=Zt(t,e,3);return new Pr(this,n)};var Tr=function(t){function e(e,n,r){this.source=e,this.predicate=Zt(n,r,3),t.call(this)}function n(t,e){return function(n,r,o){return e.predicate(n,r,o)&&t.call(this,n,r,o)}}function r(t,e,n){this.o=t,this.predicate=e,this.source=n,this.i=0,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.predicate,this))},e.prototype.internalFilter=function(t,r){return new e(this.source,n(t,this),r)},me(r,sn),r.prototype.next=function(t){var e=Dt(this.predicate)(t,this.i++,this.source);return e===jt?this.o.onError(e.e):void(e&&this.o.onNext(t))},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(ln);$e.filter=$e.where=function(t,e){return this instanceof Tr?this.internalFilter(t,e):new Tr(this,t,e)},cn.fromCallback=function(t,e,n){return function(){"undefined"==typeof e&&(e=this);for(var r=arguments.length,o=new Array(r),i=0;r>i;i++)o[i]=arguments[i];return B(t,e,n,o)}},cn.fromNodeCallback=function(t,e,n){return function(){"undefined"==typeof e&&(e=this);for(var r=arguments.length,o=new Array(r),i=0;r>i;i++)o[i]=arguments[i];return K(t,e,n,o)}},$.prototype.dispose=function(){this.isDisposed||(this._e.removeEventListener(this._n,this._fn,!1),this.isDisposed=!0)},mt.config.useNativeEvents=!1;var Ar=function(t){function e(e,n,r){this._el=e,this._n=n,this._fn=r,t.call(this)}function n(t,e){return function(){var n=arguments[0];return Ot(e)&&(n=Dt(e).apply(null,arguments),n===jt)?t.onError(n.e):void t.onNext(n)}}return me(e,t),e.prototype.subscribeCore=function(t){return Y(this._el,this._n,n(t,this._fn))},e}(ln);cn.fromEvent=function(t,e,n){return t.addListener?Lr(function(n){t.addListener(e,n)},function(n){t.removeListener(e,n)},n):mt.config.useNativeEvents||"function"!=typeof t.on||"function"!=typeof t.off?new Ar(t,e,n).publish().refCount():Lr(function(n){t.on(e,n)},function(n){t.off(e,n)},n)};var qr=function(t){function e(e,n,r){this._add=e,this._del=n,this._fn=r,t.call(this)}function n(t,e){return function(){var n=arguments[0];return Ot(e)&&(n=Dt(e).apply(null,arguments),n===jt)?t.onError(n.e):void t.onNext(n)}}function r(t,e,n){this._del=t,this._fn=e,this._ret=n,this.isDisposed=!1}return me(e,t),e.prototype.subscribeCore=function(t){var e=n(t,this._fn),o=this._add(e);return new r(this._del,e,o)},r.prototype.dispose=function(){this.isDisposed||Ot(this._del)&&this._del(this._fn,this._ret)},e}(ln),Lr=cn.fromEventPattern=function(t,e,n){return new qr(t,e,n).publish().refCount()},Rr=function(t){function e(e,n){this._p=e,this._s=n,t.call(this)}function n(t,e){var n=e[0],r=e[1];n.onNext(r),n.onCompleted()}function r(t,e){var n=e[0],r=e[1];n.onError(r)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new De,o=this;return this._p.then(function(r){e.setDisposable(o._s.schedule([t,r],n))},function(n){e.setDisposable(o._s.schedule([t,n],r))}),e},e}(ln),Ir=cn.fromPromise=function(t,e){return e||(e=Ke),new Rr(t,e)};$e.toPromise=function(t){if(t||(t=mt.config.Promise),!t)throw new Rt("Promise type not provided nor in Rx.config.Promise");var e=this;return new t(function(t,n){var r;e.subscribe(function(t){r=t},n,function(){t(r)})})},cn.startAsync=function(t){var e=Dt(t)();return e===jt?Vn(e.e):Ir(e)};var Fr=function(t){function e(e,n,r){this.source=e,this._fn1=n,this._fn2=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=this.source.multicast(this._fn1());return new Ne(this._fn2(e).subscribe(t),e.connect())},e}(ln);$e.multicast=function(t,e){return Ot(t)?new Fr(this,t,e):new Ur(this,t)},$e.publish=function(t){return t&&Ot(t)?this.multicast(function(){return new ro},t):this.multicast(new ro)},$e.share=function(){return this.publish().refCount()},$e.publishLast=function(t){return t&&Ot(t)?this.multicast(function(){return new oo},t):this.multicast(new oo)},$e.publishValue=function(t,e){return 2===arguments.length?this.multicast(function(){return new so(e)},t):this.multicast(new so(t))},$e.shareValue=function(t){return this.publishValue(t).refCount()},$e.replay=function(t,e,n,r){return t&&Ot(t)?this.multicast(function(){return new uo(e,n,r)},t):this.multicast(new uo(e,n,r))},$e.shareReplay=function(t,e,n){return this.replay(null,t,e,n).refCount()};var Vr=function(t){function e(e){this.source=e,this._count=0,this._connectableSubscription=null,t.call(this)}function n(t,e){this._p=t,this._s=e,this.isDisposed=!1}return me(e,t),e.prototype.subscribeCore=function(t){var e=1===++this._count,r=this.source.subscribe(t);return e&&(this._connectableSubscription=this.source.connect()),new n(this,r)},n.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.dispose(),0===--this._p._count&&this._p._connectableSubscription.dispose())},e}(ln),Ur=mt.ConnectableObservable=function(t){function e(e,n){this.source=e,this._hasSubscription=!1,this._subscription=null,this._sourceObservable=e.asObservable(),this._subject=n,t.call(this)}function n(t){this._p=t,this.isDisposed=!1}return me(e,t),n.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._p._hasSubscription=!1)},e.prototype.connect=function(){return this._hasSubscription||(this._hasSubscription=!0,this._subscription=new Ne(this._sourceObservable.subscribe(this._subject),new n(this))),this._subscription},e.prototype._subscribe=function(t){return this._subject.subscribe(t)},e.prototype.refCount=function(){return new Vr(this)},e}(cn),Wr=function(t){function e(e,n){this._dt=e,this._s=n,t.call(this)}function n(t,e){e.onNext(0),e.onCompleted()}return me(e,t),e.prototype.subscribeCore=function(t){return this._s.scheduleFuture(t,this._dt,n)},e}(ln),zr=cn.interval=function(t,e){return X(t,t,qe(e)?e:Ke)};cn.timer=function(t,e,n){var r;return qe(n)||(n=Ke),null!=e&&"number"==typeof e?r=e:qe(e)&&(n=e),(t instanceof Date||"number"==typeof t)&&r===s?G(t,n):t instanceof Date&&r!==s?J(t.getTime(),e,n):X(t,r,n)};$e.delay=function(){var t=arguments[0];if("number"==typeof t||t instanceof Date){var e=t,n=arguments[1];return qe(n)||(n=Ke),e instanceof Date?et(this,e,n):tt(this,e,n)}if(cn.isObservable(t)||Ot(t))return nt(this,t,arguments[1]);throw new Error("Invalid arguments")};var Br=function(t){function e(e,n,r){qe(r)||(r=Ke),this.source=e,this._dt=n,this._s=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ke;return new Ne(this.source.subscribe(new Zr(t,this.source,this._dt,this._s,e)),e)},e}(ln),Zr=function(t){function e(e,n,r,o,i){this._o=e,this._s=n,this._d=r,this._scheduler=o,this._c=i,this._v=null,this._hv=!1,this._id=0,t.call(this)}return me(e,t),e.prototype.next=function(t){this._hv=!0,this._v=t;var e=++this._id,n=new De;this._c.setDisposable(n),n.setDisposable(this._scheduler.scheduleFuture(this,this._d,function(n,r){r._hv&&r._id===e&&r._o.onNext(t),r._hv=!1}))},e.prototype.error=function(t){this._c.dispose(),this._o.onError(t),this._hv=!1,this._id++},e.prototype.completed=function(){this._c.dispose(),this._hv&&this._o.onNext(this._v),this._o.onCompleted(),this._hv=!1,this._id++},e}(sn);$e.debounce=function(){if(Ot(arguments[0]))return rt(this,arguments[0]);if("number"==typeof arguments[0])return new Br(this,arguments[0],arguments[1]);throw new Error("Invalid arguments")};var Kr=function(t){function e(e,n){this.source=e,this._s=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Hr(t,this._s))},e}(ln),Hr=function(t){function e(e,n){this._o=e,this._s=n,t.call(this)}return me(e,t),e.prototype.next=function(t){this._o.onNext({value:t,timestamp:this._s.now()})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.timestamp=function(t){return qe(t)||(t=Ke),new Kr(this,t)},$e.sample=$e.throttleLatest=function(t,e){return qe(e)||(e=Ke),"number"==typeof t?ot(this,zr(t,e)):ot(this,t)};var Qr=mt.TimeoutError=function(t){this.message=t||"Timeout has occurred",this.name="TimeoutError",Error.call(this)};Qr.prototype=Object.create(Error.prototype),$e.timeout=function(){var t=arguments[0];if(t instanceof Date||"number"==typeof t)return st(this,t,arguments[1],arguments[2]);if(cn.isObservable(t)||Ot(t))return it(this,t,arguments[1],arguments[2]);throw new Error("Invalid arguments")},$e.throttle=function(t,e){qe(e)||(e=Ke);var n=+t||0;if(0>=n)throw new RangeError("windowDuration cannot be less or equal zero.");var r=this;return new to(function(t){var o=0;return r.subscribe(function(r){var i=e.now();(0===o||i-o>=n)&&(o=i,t.onNext(r))},function(e){t.onError(e)},function(){t.onCompleted()})},r)};var $r=function(t){function e(e,n){this.source=e,this.controller=new ro,n&&n.subscribe?this.pauser=this.controller.merge(n):this.pauser=this.controller,t.call(this)}return me(e,t),e.prototype._subscribe=function(t){var e=this.source.publish(),n=e.subscribe(t),r=Se,o=this.pauser.distinctUntilChanged().subscribe(function(t){t?r=e.connect():(r.dispose(),r=Se)});return new Pe([n,r,o])},e.prototype.pause=function(){this.controller.onNext(!1)},e.prototype.resume=function(){this.controller.onNext(!0)},e}(cn);$e.pausable=function(t){return new $r(this,t)};var Yr=function(t){function e(e,n){this.source=e,this.controller=new ro,n&&n.subscribe?this.pauser=this.controller.merge(n):this.pauser=this.controller,t.call(this)}return me(e,t),e.prototype._subscribe=function(t){function e(){for(;r.length>0;)t.onNext(r.shift())}var n,r=[],o=ut(this.source,this.pauser.startWith(!1).distinctUntilChanged(),function(t,e){return{data:t,shouldFire:e}}).subscribe(function(o){n!==s&&o.shouldFire!==n?(n=o.shouldFire,o.shouldFire&&e()):(n=o.shouldFire,o.shouldFire?t.onNext(o.data):r.push(o.data))},function(n){e(),t.onError(n)},function(){e(),t.onCompleted()});return o},e.prototype.pause=function(){this.controller.onNext(!1)},e.prototype.resume=function(){this.controller.onNext(!0)},e}(cn);$e.pausableBuffered=function(t){return new Yr(this,t)};var Gr=function(t){function e(e,n,r){t.call(this),
this.subject=new Jr(n,r),this.source=e.multicast(this.subject).refCount()}return me(e,t),e.prototype._subscribe=function(t){return this.source.subscribe(t)},e.prototype.request=function(t){return this.subject.request(null==t?-1:t)},e}(cn),Jr=function(t){function e(e,n){null==e&&(e=!0),t.call(this),this.subject=new ro,this.enableQueue=e,this.queue=e?[]:null,this.requestedCount=0,this.requestedDisposable=null,this.error=null,this.hasFailed=!1,this.hasCompleted=!1,this.scheduler=n||Ue}return me(e,t),_e(e.prototype,rn,{_subscribe:function(t){return this.subject.subscribe(t)},onCompleted:function(){this.hasCompleted=!0,this.enableQueue&&0!==this.queue.length?this.queue.push(Ye.createOnCompleted()):(this.subject.onCompleted(),this.disposeCurrentRequest())},onError:function(t){this.hasFailed=!0,this.error=t,this.enableQueue&&0!==this.queue.length?this.queue.push(Ye.createOnError(t)):(this.subject.onError(t),this.disposeCurrentRequest())},onNext:function(t){this.requestedCount<=0?this.enableQueue&&this.queue.push(Ye.createOnNext(t)):(0===this.requestedCount--&&this.disposeCurrentRequest(),this.subject.onNext(t))},_processRequest:function(t){if(this.enableQueue)for(;this.queue.length>0&&(t>0||"N"!==this.queue[0].kind);){var e=this.queue.shift();e.accept(this.subject),"N"===e.kind?t--:(this.disposeCurrentRequest(),this.queue=[])}return t},request:function(t){this.disposeCurrentRequest();var e=this;return this.requestedDisposable=this.scheduler.schedule(t,function(t,n){var r=e._processRequest(n),o=e.hasCompleted||e.hasFailed;return!o&&r>0?(e.requestedCount=r,xe(function(){e.requestedCount=0})):void 0}),this.requestedDisposable},disposeCurrentRequest:function(){this.requestedDisposable&&(this.requestedDisposable.dispose(),this.requestedDisposable=null)}}),e}(cn);$e.controlled=function(t,e){return t&&qe(t)&&(e=t,t=!0),null==t&&(t=!0),new Gr(this,t,e)},$e.pipe=function(t){function e(){n.resume()}var n=this.pausableBuffered();return t.addListener("drain",e),n.subscribe(function(e){!t.write(String(e))&&n.pause()},function(e){t.emit("error",e)},function(){!t._isStdio&&t.end(),t.removeListener("drain",e)}),n.resume(),t};var Xr=function(t){function e(e,n){this._o=e,this._xform=n,t.call(this)}return me(e,t),e.prototype.next=function(t){var e=Dt(this._xform["@@transducer/step"]).call(this._xform,this._o,t);e===jt&&this._o.onError(e.e)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._xform["@@transducer/result"](this._o)},e}(sn);$e.transduce=function(t){var e=this;return new to(function(n){var r=t(ct(n));return e.subscribe(new Xr(n,r))},e)};var to=mt.AnonymousObservable=function(t){function e(t){return t&&Ot(t.dispose)?t:Ot(t)?xe(t):Se}function n(t,n){var r=n[0],o=n[1],i=Dt(o.__subscribe).call(o,r);i!==jt||r.fail(jt.e)||l(jt.e),r.setDisposable(e(i))}function r(e,n){this.source=n,this.__subscribe=e,t.call(this)}return me(r,t),r.prototype._subscribe=function(t){var e=new eo(t),r=[e,this];return Ue.scheduleRequired()?Ue.schedule(r,n):n(null,r),e},r}(cn),eo=function(t){function e(e){t.call(this),this.observer=e,this.m=new De}me(e,t);var n=e.prototype;return n.next=function(t){var e=Dt(this.observer.onNext).call(this.observer,t);e===jt&&(this.dispose(),l(e.e))},n.error=function(t){var e=Dt(this.observer.onError).call(this.observer,t);this.dispose(),e===jt&&l(e.e)},n.completed=function(){var t=Dt(this.observer.onCompleted).call(this.observer);this.dispose(),t===jt&&l(t.e)},n.setDisposable=function(t){this.m.setDisposable(t)},n.getDisposable=function(){return this.m.getDisposable()},n.dispose=function(){t.prototype.dispose.call(this),this.m.dispose()},e}(sn),no=function(t,e){this._s=t,this._o=e};no.prototype.dispose=function(){if(!this._s.isDisposed&&null!==this._o){var t=this._s.observers.indexOf(this._o);this._s.observers.splice(t,1),this._o=null}};var ro=mt.Subject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return me(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?this.hasError?(t.onError(this.error),Se):(t.onCompleted(),Se):(this.observers.push(t),new no(this,t))},hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=c(this.observers),n=e.length;n>t;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(Oe(this),!this.isStopped)for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onNext(t)},dispose:function(){this.isDisposed=!0,this.observers=null}}),e.create=function(t,e){return new io(t,e)},e}(cn),oo=mt.AsyncSubject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return me(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?(this.hasError?t.onError(this.error):this.hasValue?(t.onNext(this.value),t.onCompleted()):t.onCompleted(),Se):(this.observers.push(t),new no(this,t))},hasObservers:function(){return Oe(this),this.observers.length>0},onCompleted:function(){var t,e;if(Oe(this),!this.isStopped){this.isStopped=!0;var n=c(this.observers),e=n.length;if(this.hasValue)for(t=0;e>t;t++){var r=n[t];r.onNext(this.value),r.onCompleted()}else for(t=0;e>t;t++)n[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){Oe(this),this.isStopped||(this.value=t,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.error=null,this.value=null}}),e}(cn),io=mt.AnonymousSubject=function(t){function e(e,n){this.observer=e,this.observable=n,t.call(this)}return me(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return this.observable.subscribe(t)},onCompleted:function(){this.observer.onCompleted()},onError:function(t){this.observer.onError(t)},onNext:function(t){this.observer.onNext(t)}}),e}(cn),so=mt.BehaviorSubject=function(t){function e(e){t.call(this),this.value=e,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return me(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?(this.hasError?t.onError(this.error):t.onCompleted(),Se):(this.observers.push(t),t.onNext(this.value),new no(this,t))},getValue:function(){if(Oe(this),this.hasError)throw this.error;return this.value},hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=c(this.observers),n=e.length;n>t;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(Oe(this),!this.isStopped){this.value=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onNext(t)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.error=null}}),e}(cn),uo=mt.ReplaySubject=function(t){function e(t,e){return xe(function(){e.dispose(),!t.isDisposed&&t.observers.splice(t.observers.indexOf(e),1)})}function n(e,n,o){this.bufferSize=null==e?r:e,this.windowSize=null==n?r:n,this.scheduler=o||Ue,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,t.call(this)}var r=Math.pow(2,53)-1;return me(n,t),_e(n.prototype,rn.prototype,{_subscribe:function(t){Oe(this);var n=new an(this.scheduler,t),r=e(this,n);this._trim(this.scheduler.now()),this.observers.push(n);for(var o=0,i=this.q.length;i>o;o++)n.onNext(this.q[o].value);return this.hasError?n.onError(this.error):this.isStopped&&n.onCompleted(),n.ensureActive(),r},hasObservers:function(){return this.observers.length>0},_trim:function(t){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&t-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(t){if(Oe(this),!this.isStopped){var e=this.scheduler.now();this.q.push({interval:e,value:t}),this._trim(e);for(var n=0,r=c(this.observers),o=r.length;o>n;n++){var i=r[n];i.onNext(t),i.ensureActive()}}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;var e=this.scheduler.now();this._trim(e);for(var n=0,r=c(this.observers),o=r.length;o>n;n++){var i=r[n];i.onError(t),i.ensureActive()}this.observers.length=0}},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;var t=this.scheduler.now();this._trim(t);for(var e=0,n=c(this.observers),r=n.length;r>e;e++){var o=n[e];o.onCompleted(),o.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),n}(cn);mt.Pauser=function(t){function e(){t.call(this)}return me(e,t),e.prototype.pause=function(){this.onNext(!1)},e.prototype.resume=function(){this.onNext(!0)},e}(ro),yt.Rx=mt,r=function(){return mt}.call(e,n,e,t),!(r!==s&&(t.exports=r));var co=v()}).call(this)}).call(e,n(37)(t),function(){return this}(),n(9))},function(t,e,n){e=t.exports=n(18)(),e.push([t.id,".climb__wall{width:100%;padding:0;margin:0;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;font-size:100%}.climb__tile,.climb__wall{display:-webkit-flex;display:-ms-flexbox;display:flex}.climb__tile{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:425px;box-sizing:border-box;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-bottom:20px;overflow:hidden;text-align:left;border-radius:7px;background-color:#f6f6f6;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:1000px;perspective:1000px}.climb__tile__content{z-index:1;padding:26px;background-color:#f6f6f6}.climb__tile--has-no-image .climb__tile__content{height:100%;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;box-sizing:border-box}.climb__image{display:block;max-width:100%}.climb__tile .climb__image{position:absolute;top:0;border-top-left-radius:7px;border-top-right-radius:7px}.climb__tile__message{z-index:1;margin-bottom:24px}.climb__tile__message>a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:260px;display:inline-block;vertical-align:bottom}.climb__tile--has-no-image .climb__tile__message{font-size:185%}.climb__tile__author{display:block;margin:-10px}.climb__tile__author img{border-radius:25px;width:34px}.climb__tile__author .climb__tile__author__username{display:inline-block;margin:0 0 0 10px;line-height:34px;vertical-align:top}.climb-social-badge{position:fixed;bottom:20px;right:20px;z-index:9;background-color:#a9cae2;width:200px;height:66px;border-radius:5px}.climb-social-badge>span{position:absolute!important;top:-9999px!important;left:-9999px!important}.climb-slideshow{height:100vh;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.climb-slideshow__slide{display:block;width:70%;margin:0 auto;background-color:#f6f6f6}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<e.length;o++){var s=e[o];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(t,e,n){var r,o,i;!function(n,s){o=[e,t],r=s,i="function"==typeof r?r.apply(e,o):r,!(void 0!==i&&(t.exports=i))}(this,function(t,e){"use strict";function n(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function r(t){try{delete window[t]}catch(e){window[t]=void 0}}function o(t){var e=document.getElementById(t);document.getElementsByTagName("head")[0].removeChild(e)}var i={timeout:5e3,jsonpCallback:"callback"},s=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=null!=e.timeout?e.timeout:i.timeout,u=null!=e.jsonpCallback?e.jsonpCallback:i.jsonpCallback,c=void 0;return new Promise(function(e,i){var a=n();window[a]=function(t){e({ok:!0,json:function(){return Promise.resolve(t)}}),c&&clearTimeout(c),o(u+"_"+a),r(a)},t+=-1===t.indexOf("?")?"?":"&";var l=document.createElement("script");l.setAttribute("src",t+u+"="+a),l.id=u+"_"+a,document.getElementsByTagName("head")[0].appendChild(l),c=setTimeout(function(){i(new Error("JSONP request to "+t+" timed out")),r(a),o(u+"_"+a)},s)})};e.exports=s})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(){function t(){var e=d(),n=e-y;y=e,m+=n*u,m>o*l&&(m=0);for(var r=Math.ceil(m/o),i=0;i<v.length;i++){var s=v[i],c=s.active,a=s.animationStep,p=s.prevState,f=v[i].nextState;if(c)if(0>=m)v[i].nextState=a(o/1e3,p);else for(var _=0;r>_;_++){v[i].nextState=a(o/1e3,f);var g=[f,v[i].nextState];v[i].prevState=g[0],f=g[1]}}m-=r*o;for(var w=1+m/o,i=0;i<v.length;i++){var C=v[i],x=C.animationRender,S=C.nextState,E=C.prevState;x(w,S,E)}v=v.filter(function(t){var e=t.active;return e}),0===v.length?b=!1:h(t)}function e(){b||(b=!0,y=d(),m=0,h(t))}var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=n.timeStep,o=void 0===r?1/60*1e3:r,i=n.timeScale,u=void 0===i?1:i,a=n.maxSteps,l=void 0===a?10:a,p=n.raf,h=void 0===p?c["default"]:p,f=n.now,d=void 0===f?s["default"]:f,v=[],b=!1,y=0,m=0;return function(t,n,r){for(var o=0;o<v.length;o++){var i=v[o];if(i.animationStep===n)return i.active=!0,i.prevState=t,e(),i.stop}var s={animationStep:n,animationRender:r,prevState:t,nextState:t,active:!0};return s.stop=function(){return s.active=!1},v.push(s),e(),s.stop}}e.__esModule=!0,e["default"]=o;var i=n(8),s=r(i),u=n(33),c=r(u);t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r));return n}function i(t,e){for(var n in e)if(e.hasOwnProperty(n)&&!t(e[n],n))return!1;return!0}function s(t){var e=t.PropTypes,n=t.createClass({displayName:"Motion",propTypes:{defaultValue:function(t,e){return t[e]?new Error("Spring's `defaultValue` has been changed to `defaultStyle`. Its format received a few (easy to update!) changes as well."):void 0},endValue:function(t,e){return t[e]?new Error("Spring's `endValue` has been changed to `style`. Its format received a few (easy to update!) changes as well."):void 0},defaultStyle:e.object,style:e.object.isRequired,children:e.func.isRequired},getInitialState:function(){var t=this.props,e=t.defaultStyle,n=t.style,r=e||n;return{currentStyle:r,currentVelocity:o(y["default"],r)}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyle,r=e.currentVelocity,o=this.props.style,i=m.updateCurrentStyle(t,n,r,o),s=m.updateCurrentVelocity(t,n,r,o);return a["default"](r,i)&&a["default"](s,i)&&this.stopAnimation(),{currentStyle:i,currentVelocity:s}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=x(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){this.hasUnmounted||this.setState({currentStyle:m.interpolateValue(t,e.currentStyle,n.currentStyle),currentVelocity:e.currentVelocity})},render:function(){var e=C["default"](this.state.currentStyle),n=this.props.children(e);return n&&t.Children.only(n)}}),r=t.createClass({displayName:"StaggeredMotion",propTypes:{defaultStyle:function(t,e){return t[e]?new Error('You forgot the "s" for `StaggeredMotion`\'s `defaultStyles`.'):void 0},style:function(t,e){return t[e]?new Error('You forgot the "s" for `StaggeredMotion`\'s `styles`.'):void 0},defaultStyles:e.arrayOf(e.object),styles:e.func.isRequired,children:e.func.isRequired},getInitialState:function(){var t=this.props,e=t.styles,n=t.defaultStyles,r=n?n:e();return{currentStyles:r,currentVelocities:r.map(function(t){return o(y["default"],t)})}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyles,r=e.currentVelocities,o=this.props.styles(n.map(C["default"])),i=n.map(function(e,n){return m.updateCurrentStyle(t,e,r[n],o[n])}),s=n.map(function(e,n){return m.updateCurrentVelocity(t,e,r[n],o[n])});return r.every(function(t,e){return a["default"](t,n[e])})&&s.every(function(t,e){return a["default"](t,i[e])})&&this.stopAnimation(),{currentStyles:i,currentVelocities:s}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=x(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){if(!this.hasUnmounted){var r=e.currentStyles.map(function(e,r){return m.interpolateValue(t,e,n.currentStyles[r])});this.setState({currentStyles:r,currentVelocities:e.currentVelocities})}},render:function(){var e=this.state.currentStyles.map(C["default"]),n=this.props.children(e);return n&&t.Children.only(n)}}),s=t.createClass({displayName:"TransitionMotion",propTypes:{defaultValue:function(t,e){return t[e]?new Error("TransitionSpring's `defaultValue` has been changed to `defaultStyles`. Its format received a few (easy to update!) changes as well."):void 0},endValue:function(t,e){return t[e]?new Error("TransitionSpring's `endValue` has been changed to `styles`. Its format received a few (easy to update!) changes as well."):void 0},defaultStyle:function(t,e){return t[e]?new Error('You forgot the "s" for `TransitionMotion`\'s `defaultStyles`.'):void 0},style:function(t,e){return t[e]?new Error('You forgot the "s" for `TransitionMotion`\'s `styles`.'):void 0},defaultStyles:e.objectOf(e.any),styles:e.oneOfType([e.func,e.objectOf(e.any.isRequired)]).isRequired,willLeave:e.oneOfType([e.func]),willEnter:e.oneOfType([e.func]),children:e.func.isRequired},getDefaultProps:function(){return{willEnter:function(t,e){return e},willLeave:function(){return null}}},getInitialState:function(){var t=this.props,e=t.styles,n=t.defaultStyles,r=void 0;return r=null==n?"function"==typeof e?e():e:n,{currentStyles:r,currentVelocities:o(function(t){return o(y["default"],t)},r)}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyles,r=e.currentVelocities,s=this.props,c=s.styles,l=s.willEnter,h=s.willLeave;"function"==typeof c&&(c=c(n));var d=c,v=!1;d=f["default"](n,c,function(t){var e=h(t,n[t],c,n,r);return null==e?null:a["default"](r[t],n[t])&&p["default"](n[t],e)?null:e}),Object.keys(d).filter(function(t){return!n.hasOwnProperty(t)}).forEach(function(t){var e,i;v=!0;var s=l(t,d[t],c,n,r);d[t]=s,n=u({},n,(e={},e[t]=s,e)),r=u({},r,(i={},i[t]=o(y["default"],s),i))});var b=o(function(e,o){return m.updateCurrentStyle(t,n[o],r[o],e)},d),_=o(function(e,o){return m.updateCurrentVelocity(t,n[o],r[o],e)},d);return!v&&i(function(t,e){return a["default"](t,n[e])},r)&&i(function(t,e){return a["default"](t,b[e])},_)&&this.stopAnimation(),{currentStyles:b,currentVelocities:_}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=x(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){if(!this.hasUnmounted){var r=o(function(e,r){return m.interpolateValue(t,e,n.currentStyles[r])},e.currentStyles);this.setState({currentStyles:r,currentVelocities:e.currentVelocities})}},render:function(){var e=o(C["default"],this.state.currentStyles),n=this.props.children(e);return n&&t.Children.only(n)}}),c=g["default"](t),l=c.Spring,h=c.TransitionSpring;return{Spring:l,TransitionSpring:h,Motion:n,StaggeredMotion:r,TransitionMotion:s}}e.__esModule=!0;var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e["default"]=s;var c=n(25),a=r(c),l=n(23),p=r(l),h=n(24),f=r(h),d=n(20),v=r(d),b=n(32),y=r(b),m=n(31),_=n(22),g=r(_),w=n(30),C=r(w),x=v["default"]();t.exports=e["default"]},function(t,e,n){"use strict";function r(t){var e=t.createClass({displayName:"Spring",componentWillMount:function(){},render:function(){return null}}),n=t.createClass({displayName:"TransitionSpring",componentWillMount:function(){},render:function(){return null}});return{Spring:e,TransitionSpring:n}}e.__esModule=!0,e["default"]=r;t.exports=e["default"]},function(t,e){"use strict";function n(t,e){for(var n in e)if(e.hasOwnProperty(n)){var r=t[n],o=e[n];if(o.config){if(r.config&&r.val!==o.val)return!1;if(!r.config&&r!==o.val)return!1}}return!0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e){"use strict";function n(t,e,n,r,o,i,s){for(var u=!0;u;){var c=t,a=e,l=n,p=r,h=o,f=i,d=s;v=b=y=m=_=_=void 0,u=!1;var v=p===c.length,b=h===a.length,y=c[p],m=a[h];if(v&&b)return null;if(v)d[m]=l[m],t=c,e=a,n=l,r=p,o=h+1,i=f,s=d,u=!0;else if(b){var _=f(y);null!=_&&(d[y]=_),t=c,e=a,n=l,r=p+1,o=h,i=f,s=d,u=!0}else if(y!==m)if(l.hasOwnProperty(y))t=c,e=a,n=l,r=p+1,o=h,i=f,s=d,u=!0;else{var _=f(y);null!=_&&(d[y]=_),t=c,e=a,n=l,r=p+1,o=h,i=f,s=d,u=!0}else d[y]=l[y],t=c,e=a,n=l,r=p+1,o=h+1,i=f,s=d,u=!0}}function r(t,e,r){var o={};return n(Object.keys(t),Object.keys(e),e,0,0,r,o),o}e.__esModule=!0,e["default"]=r,t.exports=e["default"]},function(t,e){"use strict";function n(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e[n].config&&0!==t[n])return!1;return!0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var o=n(1),i=r(o),s=n(21),u=r(s),c=n(27),a=r(c),l=u["default"](i["default"]),p=l.Spring,h=l.TransitionSpring,f=l.Motion,d=l.StaggeredMotion,v=l.TransitionMotion;e.Spring=p,e.TransitionSpring=h,e.Motion=f,e.StaggeredMotion=d,e.TransitionMotion=v;var b=n(28),y=r(b);e.spring=y["default"];var m=n(7),_=r(m);e.presets=_["default"];var g={reorderKeys:a["default"]};e.utils=g},function(t,e){"use strict";function n(t,e){for(var n=e(Object.keys(t)),r={},o=0;o<n.length;o++){var i=n[o];r[i]=t[i]}return r}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t){var e=arguments.length<=1||void 0===arguments[1]?s["default"].noWobble:arguments[1];return{val:t,config:e}}e.__esModule=!0,e["default"]=o;var i=n(7),s=r(i);t.exports=e["default"]},function(t,e){"use strict";function n(t,e,n,o,i,s){var u=-i*(e-o),c=-s*n,a=u+c,l=n+a*t,p=e+l*t;return Math.abs(l-n)<r&&Math.abs(p-e)<r?[o,0]:[p,l]}e.__esModule=!0,e["default"]=n;var r=1e-4;t.exports=e["default"]},function(t,e){"use strict";function n(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=null==t[n].val?t[n]:t[n].val);return e}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function o(t,e,n){if(!n)return e;var r={};for(var o in e)if(e.hasOwnProperty(o))if(e[o].config){var i=n[o].config?n[o].val:n[o];r[o]={val:e[o].val*t+i*(1-t),config:e[o].config}}else r[o]=e[o];return r}function i(t,e,n,r){var o={};for(var i in r)if(r.hasOwnProperty(i))if(r[i].config){var s=r[i].config,u=s[0],a=s[1],l=c["default"](t,null==e[i].val?e[i]:e[i].val,n[i],r[i].val,u,a)[0];o[i]={val:l,config:r[i].config}}else o[i]=r[i];return o}function s(t,e,n,r){var o={};for(var i in r)if(r.hasOwnProperty(i))if(r[i].config){var s=r[i].config,u=s[0],a=s[1],l=c["default"](t,null==e[i].val?e[i]:e[i].val,n[i],r[i].val,u,a)[1];o[i]=l}else o[i]=0;return o}e.__esModule=!0,e.interpolateValue=o,e.updateCurrentStyle=i,e.updateCurrentVelocity=s;var u=n(29),c=r(u)},function(t,e){"use strict";function n(){return 0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){for(var r=n(8),o="undefined"==typeof window?{}:window,i=["moz","webkit"],s="AnimationFrame",u=o["request"+s],c=o["cancel"+s]||o["cancelRequest"+s],a=0;a<i.length&&!u;a++)u=o[i[a]+"Request"+s],c=o[i[a]+"Cancel"+s]||o[i[a]+"CancelRequest"+s];if(!u||!c){var l=0,p=0,h=[],f=1e3/60;u=function(t){if(0===h.length){var e=r(),n=Math.max(0,f-(e-l));l=n+e,setTimeout(function(){var t=h.slice(0);h.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(l)}catch(n){setTimeout(function(){throw n},0)}},Math.round(n))}return h.push({handle:++p,callback:t,cancelled:!1}),p},c=function(t){for(var e=0;e<h.length;e++)h[e].handle===t&&(h[e].cancelled=!0)}}t.exports=function(t){return u.call(o,t)},t.exports.cancel=function(){c.apply(o,arguments)}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=p[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(u(r.parts[i],e))}else{for(var s=[],i=0;i<r.parts.length;i++)s.push(u(r.parts[i],e));p[r.id]={id:r.id,refs:1,parts:s}}}}function o(t){for(var e=[],n={},r=0;r<t.length;r++){var o=t[r],i=o[0],s=o[1],u=o[2],c=o[3],a={css:s,media:u,sourceMap:c};n[i]?n[i].parts.push(a):e.push(n[i]={id:i,parts:[a]})}return e}function i(){var t=document.createElement("style"),e=d();return t.type="text/css",e.appendChild(t),t}function s(){var t=document.createElement("link"),e=d();return t.rel="stylesheet",e.appendChild(t),t}function u(t,e){var n,r,o;if(e.singleton){var u=b++;n=v||(v=i()),r=c.bind(null,n,u,!1),o=c.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(),r=l.bind(null,n),o=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=i(),r=a.bind(null,n),o=function(){n.parentNode.removeChild(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function c(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var i=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(i,s[e]):t.appendChild(i)}}function a(t,e){var n=e.css,r=e.media;e.sourceMap;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function l(t,e){var n=e.css,r=(e.media,e.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var p={},h=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},f=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),d=h(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,b=0;t.exports=function(t,e){if("object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},"undefined"==typeof e.singleton&&(e.singleton=f());var n=o(t);return r(n,e),function(t){for(var i=[],s=0;s<n.length;s++){var u=n[s],c=p[u.id];c.refs--,i.push(c)}if(t){var a=o(t);r(a,e)}for(var s=0;s<i.length;s++){var c=i[s];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete p[c.id]}}}};var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){var r=n(17);"string"==typeof r&&(r=[[t.id,r,""]]);n(34)(r,{});r.locals&&(t.exports=r.locals)},function(t,e){t.exports='<svg viewBox="0 0 2681 814" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>Climb Logo Beta</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="Climb-Logo-Beta" sketch:type="MSArtboardGroup" fill="#19374D"><g id="cli----b.social-+-Path-Copy-+-Type-something-Copy-Copy-Copy-Copy-Copy" sketch:type="MSLayerGroup" transform="translate(206.000000, 249.000000)"><g id="cli----b.social-+-Path-Copy" sketch:type="MSShapeGroup"><path d="M723.374207,187.442211 L767.027641,337.383575 C767.510889,341.265552 771.860124,345.147529 776.209359,345.147529 L833.232664,345.147529 C839.031644,345.147529 843.380879,340.780305 842.414383,334.472092 L739.482485,8.38601982 C738.999237,4.01879564 734.650002,0.622065728 730.784015,0.622065728 L723.052041,0.622065728 C720.6358,0.622065728 716.286565,2.56305425 714.83682,5.47453704 L643.514302,209.019062 L576.494003,105.431788 C573.721058,101.145895 567.342539,97.6714919 562.2556,97.6714919 L552.179033,97.6714919 C547.088326,97.6714919 541.529384,101.558749 539.770061,106.334187 L454.980068,336.484833 C453.21749,341.269108 455.927086,345.147529 461.014102,345.147529 L522.138067,345.147529 C527.23315,345.147529 532.791054,341.261733 534.552797,336.466171 L571.473144,235.966924 L642.108528,346.107712 C643.487141,348.257363 646.667092,350 649.212307,350 L659.971412,350 C662.516108,350 665.282044,348.045078 666.141982,345.653918 L683.827261,296.477872 L723.374207,187.442211 Z" id="Path-Copy"></path><path d="M0.145213441,247.085101 C0.145213441,305.23404 49.0872377,348.845745 104.32873,348.845745 C139.218094,348.845745 164.415968,335.277659 182.345224,308.141487 C185.737246,303.295742 183.314373,298.449997 178.953203,294.573401 L149.878733,269.375527 C146.971286,266.952655 142.610116,267.921804 139.218094,271.313825 C131.464902,279.067017 123.227136,286.335635 106.267028,286.335635 C84.9457505,286.335635 68.4702176,268.890953 68.4702176,247.085101 C68.4702176,225.763823 85.9148995,207.834566 107.236177,207.834566 C118.381391,207.834566 128.557455,213.164886 135.341498,220.433503 C137.764371,222.856376 143.579265,223.825525 146.002137,221.402652 L175.076607,193.781906 C179.437777,189.90531 180.891501,184.57499 177.49948,180.21382 C159.085649,157.923393 135.341498,145.324456 104.813305,145.324456 C49.5718122,145.324456 0.145213441,189.90531 0.145213441,247.085101 L0.145213441,247.085101 Z M218.688312,334.793085 C218.688312,339.63883 223.049482,344 227.895227,344 L281.198422,344 C286.044167,344 290.405337,339.63883 290.405337,334.793085 L290.405337,14.0047672 C290.405337,9.15902226 286.044167,4.79785179 281.198422,4.79785179 L227.895227,4.79785179 C223.049482,4.79785179 218.688312,9.15902226 218.688312,14.0047672 L218.688312,334.793085 Z M378.113321,91.5366868 C399.434599,91.5366868 416.879281,74.5765794 416.879281,53.2553015 C416.879281,31.9340236 399.434599,14.4893417 378.113321,14.4893417 C356.792044,14.4893417 339.831936,31.9340236 339.831936,53.2553015 C339.831936,74.5765794 356.792044,91.5366868 378.113321,91.5366868 L378.113321,91.5366868 Z M342.739383,334.793085 C342.739383,339.63883 347.100554,344 351.946299,344 L405.249493,344 C410.095238,344 414.456409,339.63883 414.456409,334.793085 L414.456409,159.377116 C414.456409,154.046797 410.095238,150.170201 405.249493,150.170201 L351.946299,150.170201 C347.100554,150.170201 342.739383,154.046797 342.739383,159.377116 L342.739383,334.793085 Z M889.15431,334.793085 C889.15431,339.63883 893.515481,344 898.361226,344 L921.136227,344 C925.981972,344 929.373994,339.63883 931.312292,334.30851 L937.127185,318.317552 C937.127185,318.317552 959.417612,348.845745 1002.06017,348.845745 C1056.81709,348.845745 1098.00592,302.811168 1098.00592,247.085101 C1098.00592,178.760096 1053.42506,145.324456 1001.57559,145.324456 C985.100061,145.324456 967.170804,151.13935 961.35591,154.531371 L961.35591,14.0047672 C961.35591,9.15902226 956.99474,4.79785179 952.148995,4.79785179 L898.361226,4.79785179 C893.515481,4.79785179 889.15431,9.15902226 889.15431,14.0047672 L889.15431,334.793085 Z M953.602718,246.600526 C953.602718,224.794674 970.078251,207.834566 992.368678,207.834566 C1014.65911,207.834566 1031.61921,224.794674 1031.61921,246.600526 C1031.61921,268.890953 1014.65911,286.335635 992.368678,286.335635 C970.078251,286.335635 953.602718,268.890953 953.602718,246.600526 L953.602718,246.600526 Z M1134.25645,321.224999 C1134.25645,336.246808 1146.85539,348.845745 1161.8772,348.845745 C1177.38358,348.845745 1189.49795,336.246808 1189.49795,321.224999 C1189.49795,305.718615 1177.38358,293.604252 1161.8772,293.604252 C1146.85539,293.604252 1134.25645,305.718615 1134.25645,321.224999 L1134.25645,321.224999 Z M1236.0171,332.854787 C1245.70859,340.607979 1269.93731,348.845745 1301.91923,348.845745 C1356.67615,348.845745 1383.81232,321.224999 1383.81232,287.304784 C1383.81232,248.538824 1356.67615,233.03244 1317.42561,219.464354 C1300.95008,213.64946 1295.61976,208.803715 1295.61976,203.95797 C1295.61976,198.627651 1299.98093,197.173927 1306.2804,197.173927 C1325.1788,197.173927 1347.46923,208.319141 1347.46923,208.319141 C1351.34583,209.772864 1356.19157,208.319141 1357.6453,205.411694 L1375.57455,172.460628 C1378.482,167.614883 1375.08998,163.253712 1370.72881,160.346265 C1360.06817,153.562223 1336.80859,145.324456 1306.2804,145.324456 C1253.94635,145.324456 1230.68678,171.491479 1230.68678,203.95797 C1230.68678,234.001589 1247.16231,255.807441 1284.95912,268.890953 C1309.67242,277.613294 1312.57987,284.397337 1312.57987,289.243082 C1312.57987,295.057976 1308.2187,297.965423 1303.37295,297.965423 C1282.53625,297.965423 1259.76125,285.366486 1259.76125,285.366486 C1255.88465,283.428188 1251.03891,286.335635 1249.58518,289.243082 L1232.62508,322.678722 C1230.2022,327.039893 1232.62508,329.94734 1236.0171,332.854787 L1236.0171,332.854787 Z M1407.55647,246.600526 C1407.55647,302.326593 1453.10647,348.845745 1508.34796,348.845745 C1563.58946,348.845745 1609.13946,302.326593 1609.13946,246.600526 C1609.13946,191.843608 1563.58946,145.324456 1508.34796,145.324456 C1453.10647,145.324456 1407.55647,191.843608 1407.55647,246.600526 L1407.55647,246.600526 Z M1470.06658,246.600526 C1470.06658,225.279248 1487.02669,207.834566 1508.34796,207.834566 C1529.66924,207.834566 1546.62935,225.279248 1546.62935,246.600526 C1546.62935,268.406378 1529.66924,286.335635 1508.34796,286.335635 C1487.02669,286.335635 1470.06658,268.406378 1470.06658,246.600526 L1470.06658,246.600526 Z M1631.42989,247.085101 C1631.42989,305.23404 1680.37191,348.845745 1735.6134,348.845745 C1770.50277,348.845745 1795.70064,335.277659 1813.6299,308.141487 C1817.02192,303.295742 1814.59905,298.449997 1810.23788,294.573401 L1781.16341,269.375527 C1778.25596,266.952655 1773.89479,267.921804 1770.50277,271.313825 C1762.74958,279.067017 1754.51181,286.335635 1737.5517,286.335635 C1716.23042,286.335635 1699.75489,268.890953 1699.75489,247.085101 C1699.75489,225.763823 1717.19957,207.834566 1738.52085,207.834566 C1749.66606,207.834566 1759.84213,213.164886 1766.62617,220.433503 C1769.04904,222.856376 1774.86394,223.825525 1777.28681,221.402652 L1806.36128,193.781906 C1810.72245,189.90531 1812.17617,184.57499 1808.78415,180.21382 C1790.37032,157.923393 1766.62617,145.324456 1736.09798,145.324456 C1680.85649,145.324456 1631.42989,189.90531 1631.42989,247.085101 L1631.42989,247.085101 Z M1885.34692,91.5366868 C1906.6682,91.5366868 1924.11288,74.5765794 1924.11288,53.2553015 C1924.11288,31.9340236 1906.6682,14.4893417 1885.34692,14.4893417 C1864.02565,14.4893417 1847.06554,31.9340236 1847.06554,53.2553015 C1847.06554,74.5765794 1864.02565,91.5366868 1885.34692,91.5366868 L1885.34692,91.5366868 Z M1849.97299,334.793085 C1849.97299,339.63883 1854.33416,344 1859.1799,344 L1912.4831,344 C1917.32884,344 1921.69001,339.63883 1921.69001,334.793085 L1921.69001,159.377116 C1921.69001,154.046797 1917.32884,150.170201 1912.4831,150.170201 L1859.1799,150.170201 C1854.33416,150.170201 1849.97299,154.046797 1849.97299,159.377116 L1849.97299,334.793085 Z M1960.94055,284.881911 C1960.94055,323.163297 1989.53044,348.845745 2027.81183,348.845745 C2058.34002,348.845745 2075.30013,334.793085 2086.44534,324.61702 L2093.22938,337.700532 C2095.65226,343.030851 2099.04428,344 2101.95172,344 L2123.273,344 C2128.11875,344 2132.47992,339.63883 2132.47992,334.793085 L2132.47992,227.702121 C2132.47992,170.52233 2110.67407,145.324456 2050.58683,145.324456 C2024.4198,145.324456 1990.49959,151.13935 1986.13842,152.593074 C1981.77725,154.046797 1977.41608,157.438818 1978.8698,165.676585 L1983.23097,196.204778 C1984.20012,203.473396 1987.59214,208.803715 1994.86076,206.380843 C2007.4597,202.504247 2030.2347,199.112225 2043.31821,199.112225 C2066.57779,199.112225 2069.48523,208.803715 2069.48523,227.702121 C2069.48523,227.702121 2053.97885,219.948929 2032.173,219.948929 C1988.07672,219.948929 1960.94055,247.569675 1960.94055,284.881911 L1960.94055,284.881911 Z M2023.93523,280.036166 C2023.93523,268.890953 2033.14215,259.684037 2044.77193,259.684037 C2056.40172,259.684037 2065.60864,268.890953 2066.09321,280.036166 C2066.09321,291.665954 2056.40172,301.357444 2044.77193,301.357444 C2033.14215,301.357444 2023.93523,291.665954 2023.93523,280.036166 L2023.93523,280.036166 Z M2181.90652,334.793085 C2181.90652,339.63883 2186.26769,344 2191.11343,344 L2244.41663,344 C2249.26237,344 2253.62354,339.63883 2253.62354,334.793085 L2253.62354,14.0047672 C2253.62354,9.15902226 2249.26237,4.79785179 2244.41663,4.79785179 L2191.11343,4.79785179 C2186.26769,4.79785179 2181.90652,9.15902226 2181.90652,14.0047672 L2181.90652,334.793085 Z" id="cli----b.social"></path></g></g></g></g></svg>';
},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,n){t.exports=e}])});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy9yZWFjdC1jbGltYi1zb2NpYWwubWluLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAyMzRhZWM5NGZiN2Y5YzVjYmZkYiIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIHtcInJvb3RcIjpcIlJlYWN0XCIsXCJjb21tb25qczJcIjpcInJlYWN0XCIsXCJjb21tb25qc1wiOlwicmVhY3RcIixcImFtZFwiOlwicmVhY3RcIn0iLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvY29tbW9uL0ltYWdlLmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jb21tb24vTWVzc2FnZS5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvd2FsbC9UaWxlLmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy93YWxsL1dhbGwuanN4Iiwid2VicGFjazovLy8uL34vY2xpbWItc29jaWFsL2Rpc3QvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL3ByZXNldHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vfi9wZXJmb3JtYW5jZS1ub3cvbGliL3BlcmZvcm1hbmNlLW5vdy5qcyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL34vbm9kZS1saWJzLWJyb3dzZXIvfi9wcm9jZXNzL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvY29tbW9uL0F1dGhvci5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2xpZGVzaG93L1NsaWRlc2hvdy5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2xpZGVzaG93L1NsaWRlc2hvd0NvbnRhaW5lci5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvc2xpZGVzaG93L3NsaWRlLmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy93YWxsL0NsaW1iQmFkZ2UuanN4Iiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3dhbGwvV2FsbENvbnRhaW5lci5qc3giLCJ3ZWJwYWNrOi8vLy4vfi9jbGltYi1zb2NpYWwvfi9yeC1saXRlL3J4LmxpdGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N0eWxlL21haW4uc2NzcyIsIndlYnBhY2s6Ly8vLi9+L2Nzcy1sb2FkZXIvbGliL2Nzcy1iYXNlLmpzIiwid2VicGFjazovLy8uL34vZmV0Y2gtanNvbnAvYnVpbGQvZmV0Y2gtanNvbnAuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL2FuaW1hdGlvbkxvb3AuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL2NvbXBvbmVudHMuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL2RlcHJlY2F0ZWRTcHJpbmdzLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9oYXNSZWFjaGVkU3R5bGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL21lcmdlRGlmZi5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9saWIvbm9WZWxvY2l0eS5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9saWIvcmVhY3QtbW90aW9uLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9yZW9yZGVyS2V5cy5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9saWIvc3ByaW5nLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9zdGVwcGVyLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9zdHJpcFN0eWxlLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi91cGRhdGVUcmVlLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi96ZXJvLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL34vcmFmL2luZGV4LmpzIiwid2VicGFjazovLy8uL34vc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc3R5bGUvbWFpbi5zY3NzPzNhZGIiLCJ3ZWJwYWNrOi8vLy4vc3JjL2ltZy9jbGltYl9sb2dvLnN2ZyIsIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcIlJlYWN0RE9NXCIiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwicmVxdWlyZSIsImRlZmluZSIsImFtZCIsInRoaXMiLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMzhfXyIsIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsIl9yZWFjdCIsIl9yZWFjdDIiLCJfcmVhY3REb20iLCJfcmVhY3REb20yIiwiX2NvbXBvbmVudHNXYWxsV2FsbENvbnRhaW5lciIsIl9jb21wb25lbnRzV2FsbFdhbGxDb250YWluZXIyIiwiX2NvbXBvbmVudHNTbGlkZXNob3dTbGlkZXNob3dDb250YWluZXIiLCJfY29tcG9uZW50c1NsaWRlc2hvd1NsaWRlc2hvd0NvbnRhaW5lcjIiLCJ3aW5kb3ciLCJDbGltYiIsIiR3YWxscyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImkiLCJsZW5ndGgiLCIkaXRlbSIsImNvbGxlY3Rpb25JZCIsImRhdGFzZXQiLCJsaW1pdCIsInJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCIkc2xpZGVzaG93cyIsIldhbGxDb250YWluZXIiLCJfY29tcG9uZW50c1dhbGxXYWxsIiwiZW51bWVyYWJsZSIsImdldCIsIldhbGwiLCJfY29tcG9uZW50c1dhbGxUaWxlIiwiVGlsZSIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJwcm90b3R5cGUiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJkZXNjcmlwdG9yIiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiX2dldCIsIl94IiwiX3gyIiwiX3gzIiwiX2FnYWluIiwib2JqZWN0IiwicHJvcGVydHkiLCJyZWNlaXZlciIsImRlc2MiLCJwYXJlbnQiLCJnZXR0ZXIiLCJ1bmRlZmluZWQiLCJGdW5jdGlvbiIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImdldFByb3RvdHlwZU9mIiwiSW1hZ2UiLCJfUmVhY3QkQ29tcG9uZW50IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJjbGFzc05hbWUiLCJzcmMiLCJkYXRhLXdpZHRoIiwid2lkdGgiLCJkYXRhLWhlaWdodCIsImhlaWdodCIsIkNvbXBvbmVudCIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsInN0cmluZyIsImlzUmVxdWlyZWQiLCJudW1iZXIiLCJNZXNzYWdlIiwibWVzc2FnZSIsImJvZHkiLCJyZXBsYWNlIiwiZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwiLCJfX2h0bWwiLCJfY29tbW9uSW1hZ2UiLCJfY29tbW9uSW1hZ2UyIiwiX2NvbW1vbk1lc3NhZ2UiLCJfY29tbW9uTWVzc2FnZTIiLCJfY29tbW9uQXV0aG9yIiwiX2NvbW1vbkF1dGhvcjIiLCJpbWFnZSIsIl9wcm9wcyRpbWFnZSIsInVybCIsImNsYXNzU3RyaW5nIiwic291cmNlX3R5cGUiLCJ2aWRlb191cmwiLCJjcmVhdGVJbWFnZSIsImNyZWF0ZU1lc3NhZ2UiLCJjcmVhdGVDbGFzc1N0cmluZyIsImF1dGhvciIsInN0eWxlIiwiaHJlZiIsImxpbmsiLCJ0aW1lc3RhbXAiLCJzaGFwZSIsInVzZXJuYW1lIiwicGljdHVyZSIsInZpZGVvX3NyYyIsIl9vYmplY3RXaXRob3V0UHJvcGVydGllcyIsImtleXMiLCJpbmRleE9mIiwiaGFzT3duUHJvcGVydHkiLCJfZXh0ZW5kcyIsImFzc2lnbiIsInNvdXJjZSIsIl9UaWxlIiwiX1RpbGUyIiwiX3JlYWN0TW90aW9uIiwiX0NvbXBvbmVudCIsIl90aGlzIiwiY29uZmlncyIsIml0ZW1zIiwibWFwIiwib3BhY2l0eSIsInNwcmluZyIsIm1hcmdpbiIsIml0ZW0iLCJpdGVtVmFsdWVzIiwic3R5bGVDb25maWciLCJpdGVtUHJvcHMiLCJtYXJnaW5MZWZ0IiwibWFyZ2luUmlnaHQiLCJfdGhpczIiLCJUcmFuc2l0aW9uTW90aW9uIiwic3R5bGVzIiwiZ2V0U3R5bGVzIiwiYmluZCIsIndpbGxFbnRlciIsIndpbGxMZWF2ZSIsInZhbHVlcyIsInJlbmRlclRpbGUiLCJfcnhMaXRlIiwiX2ZldGNoSnNvbnAiLCJfZmV0Y2hKc29ucDIiLCJnZXRTdHJlYW0iLCJwb2xsUmF0ZSIsInJlcXVlc3RTdHJlYW0iLCJPYnNlcnZhYmxlIiwianVzdCIsInVwZGF0ZVN0cmVhbSIsImludGVydmFsIiwic3RhcnRXaXRoIiwicmVzcG9uc2VTdHJlYW0iLCJjb21iaW5lTGF0ZXN0IiwidGljayIsImZsYXRNYXAiLCJiYXNlVXJsIiwicmVxdWVzdFVybCIsImZyb21Qcm9taXNlIiwidGhlbiIsInJlc3AiLCJqc29uIiwibm9Xb2JibGUiLCJnZW50bGUiLCJ3b2JibHkiLCJzdGlmZiIsInByb2Nlc3MiLCJnZXROYW5vU2Vjb25kcyIsImhydGltZSIsImxvYWRUaW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJociIsIkRhdGUiLCJnZXRUaW1lIiwiY2xlYW5VcE5leHRUaWNrIiwiZHJhaW5pbmciLCJjdXJyZW50UXVldWUiLCJxdWV1ZSIsImNvbmNhdCIsInF1ZXVlSW5kZXgiLCJkcmFpblF1ZXVlIiwidGltZW91dCIsInNldFRpbWVvdXQiLCJsZW4iLCJydW4iLCJjbGVhclRpbWVvdXQiLCJJdGVtIiwiZnVuIiwiYXJyYXkiLCJub29wIiwibmV4dFRpY2siLCJhcmdzIiwiQXJyYXkiLCJwdXNoIiwidGl0bGUiLCJicm93c2VyIiwiZW52IiwiYXJndiIsInZlcnNpb24iLCJ2ZXJzaW9ucyIsIm9uIiwiYWRkTGlzdGVuZXIiLCJvbmNlIiwib2ZmIiwicmVtb3ZlTGlzdGVuZXIiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJlbWl0IiwiYmluZGluZyIsIm5hbWUiLCJFcnJvciIsImN3ZCIsImNoZGlyIiwiZGlyIiwidW1hc2siLCJBdXRob3IiLCJhbHQiLCJfc2xpZGUiLCJfc2xpZGUyIiwiU2xpZGVzaG93Iiwic3RhdGUiLCJjdXJyZW50SXRlbUluZGV4IiwiZGVsYXkiLCJ0aW1lciIsInNldEludGVydmFsIiwibmV4dFNsaWRlIiwiY2xlYXJJbnRlcnZhbCIsInNsaWRlc2hvd0xlbmd0aCIsIm5ld0luZGV4IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic2V0U3RhdGUiLCJfY2xpbWJTb2NpYWwiLCJfY2xpbWJTb2NpYWwyIiwiX1NsaWRlc2hvdyIsIl9TbGlkZXNob3cyIiwiU2xpZGVzaG93Q29udGFpbmVyIiwic3Vic2NyaWJlIiwibWFwcGVkSXRlbXMiLCJpbml0IiwiU2xpZGUiLCJDbGltYkJhZGdlIiwibG9nbyIsIl9XYWxsIiwiX1dhbGwyIiwiX0NsaW1iQmFkZ2UiLCJfQ2xpbWJCYWRnZTIiLCJtYXhTaXplIiwicGFyc2VJbnQiLCJzcGxpY2UiLCJjYiIsIm9uVXBkYXRlIiwib25lT2ZUeXBlIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18iLCJnbG9iYWwiLCJjaGVja0dsb2JhbCIsImNsb25lQXJyYXkiLCJhcnIiLCJhIiwidHJ5Q2F0Y2hlckdlbiIsInRyeUNhdGNoVGFyZ2V0IiwiZSIsImVycm9yT2JqIiwidGhyb3dlciIsIm1ha2VTdGFja1RyYWNlTG9uZyIsImVycm9yIiwib2JzZXJ2YWJsZSIsImhhc1N0YWNrcyIsInN0YWNrIiwiU1RBQ0tfSlVNUF9TRVBBUkFUT1IiLCJzdGFja3MiLCJvIiwidW5zaGlmdCIsImNvbmNhdGVkU3RhY2tzIiwiam9pbiIsImZpbHRlclN0YWNrU3RyaW5nIiwic3RhY2tTdHJpbmciLCJsaW5lcyIsInNwbGl0IiwiZGVzaXJlZExpbmVzIiwibGluZSIsImlzSW50ZXJuYWxGcmFtZSIsImlzTm9kZUZyYW1lIiwic3RhY2tMaW5lIiwiZmlsZU5hbWVBbmRMaW5lTnVtYmVyIiwiZ2V0RmlsZU5hbWVBbmRMaW5lTnVtYmVyIiwiZmlsZU5hbWUiLCJsaW5lTnVtYmVyIiwickZpbGVOYW1lIiwiclN0YXJ0aW5nTGluZSIsInJFbmRpbmdMaW5lIiwiY2FwdHVyZUxpbmUiLCJmaXJzdExpbmUiLCJhdHRlbXB0MSIsImV4ZWMiLCJOdW1iZXIiLCJhdHRlbXB0MiIsImF0dGVtcHQzIiwia2V5c0luIiwicmVzdWx0IiwiaXNPYmplY3QiLCJzdXBwb3J0Iiwibm9uRW51bUFyZ3MiLCJpc0FyZ3VtZW50cyIsInNsaWNlIiwic2tpcFByb3RvIiwiZW51bVByb3RvdHlwZXMiLCJza2lwRXJyb3JQcm9wcyIsImVudW1FcnJvclByb3BzIiwiZXJyb3JQcm90byIsIm5vbkVudW1TaGFkb3dzIiwib2JqZWN0UHJvdG8iLCJjdG9yIiwiaW5kZXgiLCJkb250RW51bXNMZW5ndGgiLCJzdHJpbmdQcm90byIsInN0cmluZ0NsYXNzIiwiZXJyb3JDbGFzcyIsInRvU3RyaW5nIiwibm9uRW51bSIsIm5vbkVudW1Qcm9wcyIsImRvbnRFbnVtcyIsImludGVybmFsRm9yIiwiY2FsbGJhY2siLCJrZXlzRnVuYyIsImludGVybmFsRm9ySW4iLCJpc05vZGUiLCJkZWVwRXF1YWxzIiwiYiIsInN0YWNrQSIsInN0YWNrQiIsInR5cGUiLCJvdGhlclR5cGUiLCJvdGhlckNsYXNzIiwiYXJnc0NsYXNzIiwib2JqZWN0Q2xhc3MiLCJib29sQ2xhc3MiLCJkYXRlQ2xhc3MiLCJudW1iZXJDbGFzcyIsInJlZ2V4cENsYXNzIiwiU3RyaW5nIiwiaXNBcnIiLCJhcnJheUNsYXNzIiwibm9kZUNsYXNzIiwiY3RvckEiLCJhcmdzT2JqZWN0IiwiY3RvckIiLCJpc0Z1bmN0aW9uIiwic2l6ZSIsInBvcCIsImFycmF5SW5pdGlhbGl6ZSIsImNvdW50IiwiSW5kZXhlZEl0ZW0iLCJJc0Rpc3Bvc2VkRGlzcG9zYWJsZSIsIl9zIiwiaXNEaXNwb3NlZCIsIlN0cmluZ0l0ZXJhYmxlIiwicyIsIlN0cmluZ0l0ZXJhdG9yIiwiX2wiLCJfaSIsIkFycmF5SXRlcmFibGUiLCJfYSIsIkFycmF5SXRlcmF0b3IiLCJ0b0xlbmd0aCIsIm51bWJlcklzRmluaXRlIiwiaXNGaW5pdGUiLCJnZXRJdGVyYWJsZSIsIml0IiwiJGl0ZXJhdG9yJCIsInNpZ24iLCJpc05hTiIsImFicyIsIm1heFNhZmVJbnRlZ2VyIiwiRnJvbUFycmF5U2luayIsIm9ic2VydmVyIiwibG9vcFJlY3Vyc2l2ZSIsInJlY3Vyc2UiLCJvbk5leHQiLCJvbkNvbXBsZXRlZCIsIm9ic2VydmFibGVPZiIsInNjaGVkdWxlciIsImlzU2NoZWR1bGVyIiwiY3VycmVudFRocmVhZFNjaGVkdWxlciIsIkZyb21BcnJheU9ic2VydmFibGUiLCJQYWlyc1NpbmsiLCJSZXBlYXRTaW5rIiwiZmFsc2VGYWN0b3J5IiwiYXJndW1lbnRzVG9BcnJheSIsImVtcHR5QXJyYXlGYWN0b3J5IiwiYXNPYnNlcnZhYmxlIiwicGx1Y2tlciIsIngiLCJjdXJyZW50UHJvcCIsImNyZWF0ZUNiT2JzZXJ2YWJsZSIsImZuIiwiY3R4Iiwic2VsZWN0b3IiLCJBc3luY1N1YmplY3QiLCJjcmVhdGVDYkhhbmRsZXIiLCJyZXN1bHRzIiwidHJ5Q2F0Y2giLCJvbkVycm9yIiwiY3JlYXRlTm9kZU9ic2VydmFibGUiLCJjcmVhdGVOb2RlSGFuZGxlciIsImVyciIsImlzTm9kZUxpc3QiLCJlbCIsIlN0YXRpY05vZGVMaXN0IiwiTm9kZUxpc3QiLCJMaXN0ZW5EaXNwb3NhYmxlIiwibiIsIl9lIiwiX24iLCJfZm4iLCJhZGRFdmVudExpc3RlbmVyIiwiY3JlYXRlRXZlbnRMaXN0ZW5lciIsImV2ZW50TmFtZSIsImhhbmRsZXIiLCJkaXNwb3NhYmxlcyIsIkNvbXBvc2l0ZURpc3Bvc2FibGUiLCJlbGVtVG9TdHJpbmciLCJhZGQiLCJfb2JzZXJ2YWJsZVRpbWVyIiwiZHVlVGltZSIsIlRpbWVyT2JzZXJ2YWJsZSIsIm9ic2VydmFibGVUaW1lckRhdGVBbmRQZXJpb2QiLCJwZXJpb2QiLCJBbm9ueW1vdXNPYnNlcnZhYmxlIiwiZCIsIm5vcm1hbGl6ZVRpbWUiLCJzY2hlZHVsZVJlY3Vyc2l2ZUZ1dHVyZSIsInNlbGYiLCJvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZCIsInNjaGVkdWxlUGVyaW9kaWMiLCJvYnNlcnZhYmxlRGVmZXIiLCJvYnNlcnZhYmxlRGVsYXlSZWxhdGl2ZSIsInN1YnNjcmlwdGlvbiIsImFjdGl2ZSIsImNhbmNlbGFibGUiLCJTZXJpYWxEaXNwb3NhYmxlIiwiZXhjZXB0aW9uIiwicSIsInJ1bm5pbmciLCJtYXRlcmlhbGl6ZSIsIm5vdGlmaWNhdGlvbiIsInNob3VsZFJ1biIsImtpbmQiLCJTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSIsInNldERpc3Bvc2FibGUiLCJfIiwicmVjdXJzZUR1ZVRpbWUiLCJzaG91bGRSZWN1cnNlIiwic2hpZnQiLCJhY2NlcHQiLCJtYXgiLCJCaW5hcnlEaXNwb3NhYmxlIiwib2JzZXJ2YWJsZURlbGF5QWJzb2x1dGUiLCJkZWxheVdpdGhTZWxlY3RvciIsInN1YnNjcmlwdGlvbkRlbGF5IiwiZGVsYXlEdXJhdGlvblNlbGVjdG9yIiwic3ViRGVsYXkiLCJzdGFydCIsImRlbGF5cyIsInJlbW92ZSIsImRvbmUiLCJhdEVuZCIsImRpc3Bvc2UiLCJkZWJvdW5jZVdpdGhTZWxlY3RvciIsImR1cmF0aW9uU2VsZWN0b3IiLCJoYXNWYWx1ZSIsInRocm90dGxlIiwiaXNQcm9taXNlIiwib2JzZXJ2YWJsZUZyb21Qcm9taXNlIiwiY3VycmVudGlkIiwic2FtcGxlT2JzZXJ2YWJsZSIsInNhbXBsZXIiLCJzYW1wbGVTdWJzY3JpYmUiLCJzb3VyY2VTdWJzY3JpcHRpb24iLCJuZXdWYWx1ZSIsInRpbWVvdXRXaXRoU2VsZWN0b3IiLCJmaXJzdFRpbWVvdXQiLCJ0aW1lb3V0RHVyYXRpb25TZWxlY3RvciIsIm90aGVyIiwib2JzZXJ2YWJsZU5ldmVyIiwib2JzZXJ2YWJsZVRocm93IiwiVGltZW91dEVycm9yIiwic2V0VGltZXIiLCJ0aW1lcldpbnMiLCJzd2l0Y2hlZCIsIm15SWQiLCJvV2lucyIsInJlcyIsIm9yaWdpbmFsIiwiZGVmYXVsdFNjaGVkdWxlciIsImNyZWF0ZVRpbWVyIiwic2NoZWR1bGVGdXR1cmUiLCJjb21iaW5lTGF0ZXN0U291cmNlIiwic3ViamVjdCIsInJlc3VsdFNlbGVjdG9yIiwibmV4dCIsImhhc1ZhbHVlQWxsIiwiZXZlcnkiLCJpZGVudGl0eSIsImlzRG9uZSIsInRyYW5zZm9ybUZvck9ic2VydmVyIiwiQEB0cmFuc2R1Y2VyL2luaXQiLCJAQHRyYW5zZHVjZXIvc3RlcCIsIm9icyIsImlucHV0IiwiQEB0cmFuc2R1Y2VyL3Jlc3VsdCIsIm9iamVjdFR5cGVzIiwiZnVuY3Rpb24iLCJmcmVlRXhwb3J0cyIsIm5vZGVUeXBlIiwiZnJlZU1vZHVsZSIsImZyZWVHbG9iYWwiLCJmcmVlU2VsZiIsImZyZWVXaW5kb3ciLCJtb2R1bGVFeHBvcnRzIiwidGhpc0dsb2JhbCIsIlJ4IiwiaW50ZXJuYWxzIiwiY29uZmlnIiwiUHJvbWlzZSIsImhlbHBlcnMiLCJkZWZhdWx0Tm93IiwiZGVmYXVsdENvbXBhcmVyIiwieSIsImlzRXF1YWwiLCJkZWZhdWx0U3ViQ29tcGFyZXIiLCJkZWZhdWx0RXJyb3IiLCJkZWZhdWx0S2V5U2VyaWFsaXplciIsImlzRm4iLCJsb25nU3RhY2tTdXBwb3J0IiwiRW1wdHlFcnJvciIsIk9iamVjdERpc3Bvc2VkRXJyb3IiLCJBcmd1bWVudE91dE9mUmFuZ2VFcnJvciIsIk5vdFN1cHBvcnRlZEVycm9yIiwiTm90SW1wbGVtZW50ZWRFcnJvciIsIm5vdEltcGxlbWVudGVkIiwibm90U3VwcG9ydGVkIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJTZXQiLCJkb25lRW51bWVyYXRvciIsImlzSXRlcmFibGUiLCJpc0FycmF5TGlrZSIsInN1cHBvcnROb2RlQ2xhc3MiLCJiaW5kQ2FsbGJhY2siLCJmdW5jIiwidGhpc0FyZyIsImFyZ0NvdW50IiwiYXJnIiwiY29sbGVjdGlvbiIsImZ1bmNDbGFzcyIsInN1cHBvcnRzQXJnc0NsYXNzIiwicHJvcGVydHlJc0VudW1lcmFibGUiLCJ0b0xvY2FsZVN0cmluZyIsInZhbHVlT2YiLCJ0ZXN0IiwiaW5oZXJpdHMiLCJjaGlsZCIsIl9fIiwiYWRkUHJvcGVydGllcyIsInNvdXJjZXMiLCJpZHgiLCJsbiIsInByb3AiLCJhZGRSZWYiLCJ4cyIsInIiLCJnZXREaXNwb3NhYmxlIiwiaXNBcnJheSIsIkNvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUiLCJzaG91bGREaXNwb3NlIiwiY3VycmVudERpc3Bvc2FibGVzIiwiRGlzcG9zYWJsZSIsImFjdGlvbiIsImRpc3Bvc2FibGVDcmVhdGUiLCJkaXNwb3NhYmxlRW1wdHkiLCJlbXB0eSIsImlzRGlzcG9zYWJsZSIsImNoZWNrRGlzcG9zZWQiLCJkaXNwb3NhYmxlIiwiZGlzcG9zYWJsZUZpeHVwIiwiX2ZpeHVwIiwiY3VycmVudCIsIm9sZCIsImZpcnN0Iiwic2Vjb25kIiwiX2ZpcnN0IiwiX3NlY29uZCIsIm9sZDEiLCJvbGQyIiwiTkFyeURpc3Bvc2FibGUiLCJfZGlzcG9zYWJsZXMiLCJTY2hlZHVsZWRJdGVtIiwiUmVmQ291bnREaXNwb3NhYmxlIiwiSW5uZXJEaXNwb3NhYmxlIiwiaXNJbm5lckRpc3Bvc2VkIiwidW5kZXJseWluZ0Rpc3Bvc2FibGUiLCJpc1ByaW1hcnlEaXNwb3NlZCIsImNvbXBhcmVyIiwiaW52b2tlIiwiaW52b2tlQ29yZSIsImNvbXBhcmVUbyIsImlzQ2FuY2VsbGVkIiwiU2NoZWR1bGVyIiwic2NoZWR1bGVyUHJvdG8iLCJzY2hlZHVsZSIsImR0Iiwibm9ybWFsaXplIiwiX3NjaGVkdWxlRnV0dXJlIiwidGltZVNwYW4iLCJpbnZva2VSZWNJbW1lZGlhdGUiLCJwYWlyIiwiaW5uZXJBY3Rpb24iLCJzdGF0ZTIiLCJzY2hlZHVsZVdvcmsiLCJzdGF0ZTMiLCJpc0FkZGVkIiwiZ3JvdXAiLCJpbnZva2VSZWNEYXRlIiwiZHVlVGltZTEiLCJzY2hlZHVsZVJlY3Vyc2l2ZSIsInNjaGVkdWxlTWV0aG9kIiwiY2xlYXJNZXRob2QiLCJJbW1lZGlhdGVTY2hlZHVsZXIiLCJfX3N1cGVyX18iLCJpbW1lZGlhdGVTY2hlZHVsZXIiLCJpbW1lZGlhdGUiLCJDdXJyZW50VGhyZWFkU2NoZWR1bGVyIiwicnVuVHJhbXBvbGluZSIsImRlcXVldWUiLCJzaSIsImVucXVldWUiLCJQcmlvcml0eVF1ZXVlIiwic2NoZWR1bGVSZXF1aXJlZCIsImN1cnJlbnRUaHJlYWQiLCJsb2NhbFRpbWVyIiwiU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZSIsImNyZWF0ZVRpY2siLCJjb21tYW5kIiwiX3BlcmlvZCIsIl9hY3Rpb24iLCJfc3RhdGUiLCJfY2FuY2VsIiwiX3NjaGVkdWxlciIsImxvY2FsU2V0VGltZW91dCIsImxvY2FsQ2xlYXJUaW1lb3V0IiwiV1NjcmlwdCIsInRpbWUiLCJTbGVlcCIsInJ1blRhc2siLCJoYW5kbGUiLCJjdXJyZW50bHlSdW5uaW5nIiwidGFzayIsInRhc2tzQnlIYW5kbGUiLCJwb3N0TWVzc2FnZVN1cHBvcnRlZCIsInBvc3RNZXNzYWdlIiwiaW1wb3J0U2NyaXB0cyIsImlzQXN5bmMiLCJvbGRIYW5kbGVyIiwib25tZXNzYWdlIiwibmV4dEhhbmRsZSIsInJlTmF0aXZlIiwiUmVnRXhwIiwic2V0SW1tZWRpYXRlIiwiTVNHX1BSRUZJWCIsIm9uR2xvYmFsUG9zdE1lc3NhZ2UiLCJldmVudCIsImRhdGEiLCJzdWJzdHJpbmciLCJjdXJyZW50SWQiLCJNZXNzYWdlQ2hhbm5lbCIsImNoYW5uZWwiLCJwb3J0MSIsInBvcnQyIiwic2NyaXB0RWxlbWVudCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImRvY3VtZW50RWxlbWVudCIsImFwcGVuZENoaWxkIiwiRGVmYXVsdFNjaGVkdWxlciIsInNjaGVkdWxlQWN0aW9uIiwiQ2xlYXJEaXNwb3NhYmxlIiwibWV0aG9kIiwiX2lkIiwiX21ldGhvZCIsImFzeW5jIiwiY2FwYWNpdHkiLCJwcmlvcml0eVByb3RvIiwiaXNIaWdoZXJQcmlvcml0eSIsImxlZnQiLCJyaWdodCIsInBlcmNvbGF0ZSIsInRlbXAiLCJoZWFwaWZ5IiwicGVlayIsInJlbW92ZUF0Iiwib2JzZXJ2YWJsZVByb3RvIiwiTm90aWZpY2F0aW9uIiwiX2FjY2VwdCIsIl9hY2NlcHRPYnNlcnZhYmxlIiwib2JzZXJ2ZXJPck9uTmV4dCIsInRvT2JzZXJ2YWJsZSIsIk9uTmV4dE5vdGlmaWNhdGlvbiIsIk9uRXJyb3JOb3RpZmljYXRpb24iLCJPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbiIsIm5vdGlmaWNhdGlvbkNyZWF0ZU9uTmV4dCIsImNyZWF0ZU9uTmV4dCIsIm5vdGlmaWNhdGlvbkNyZWF0ZU9uRXJyb3IiLCJjcmVhdGVPbkVycm9yIiwibm90aWZpY2F0aW9uQ3JlYXRlT25Db21wbGV0ZWQiLCJjcmVhdGVPbkNvbXBsZXRlZCIsIk9ic2VydmVyIiwib2JzZXJ2ZXJDcmVhdGUiLCJBbm9ueW1vdXNPYnNlcnZlciIsIkFic3RyYWN0T2JzZXJ2ZXIiLCJpc1N0b3BwZWQiLCJjb21wbGV0ZWQiLCJmYWlsIiwiX29uTmV4dCIsIl9vbkVycm9yIiwiX29uQ29tcGxldGVkIiwibWFrZVN1YnNjcmliZSIsIm9sZE9uRXJyb3IiLCJvbGRTdWJzY3JpYmUiLCJfc3Vic2NyaWJlIiwiaXNPYnNlcnZhYmxlIiwiZm9yRWFjaCIsIm9Pck9uTmV4dCIsInN1YnNjcmliZU9uTmV4dCIsInN1YnNjcmliZU9uRXJyb3IiLCJzdWJzY3JpYmVPbkNvbXBsZXRlZCIsIlNjaGVkdWxlZE9ic2VydmVyIiwiaXNBY3F1aXJlZCIsImhhc0ZhdWx0ZWQiLCJlbnN1cmVBY3RpdmUiLCJpc093bmVyIiwid29yayIsIk9ic2VydmFibGVCYXNlIiwiZml4U3Vic2NyaWJlciIsInN1YnNjcmliZXIiLCJhZG8iLCJzdWIiLCJzdWJzY3JpYmVDb3JlIiwiQXV0b0RldGFjaE9ic2VydmVyIiwiRmxhdE1hcE9ic2VydmFibGUiLCJJbm5lck9ic2VydmVyIiwiX3dyYXBSZXN1bHQiLCJpMiIsImZyb20iLCJFbnVtZXJhYmxlIiwiQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUiLCJfbyIsImN1cnJlbnRJdGVtIiwiY3VycmVudFZhbHVlIiwiQ2F0Y2hFcnJvck9ic2VydmFibGUiLCJfcmVjdXJzZSIsImxhc3RFeGNlcHRpb24iLCJjYXRjaEVycm9yIiwiY2F0Y2hFcnJvcldoZW4iLCJub3RpZmljYXRpb25IYW5kbGVyIiwiZXhjZXB0aW9ucyIsIlN1YmplY3QiLCJub3RpZmllciIsImhhbmRsZWQiLCJub3RpZmljYXRpb25EaXNwb3NhYmxlIiwib3V0ZXIiLCJpbm5lciIsImV4biIsImV4IiwiUmVwZWF0RW51bWVyYWJsZSIsInYiLCJSZXBlYXRFbnVtZXJhdG9yIiwibCIsImVudW1lcmFibGVSZXBlYXQiLCJyZXBlYXQiLCJyZXBlYXRDb3VudCIsIk9mRW51bWVyYWJsZSIsIk9mRW51bWVyYXRvciIsImVudW1lcmFibGVPZiIsIm9mIiwiVG9BcnJheU9ic2VydmFibGUiLCJ0b0FycmF5IiwiRGVmZXIiLCJfZiIsImRlZmVyIiwib2JzZXJ2YWJsZUZhY3RvcnkiLCJFbXB0eU9ic2VydmFibGUiLCJFbXB0eVNpbmsiLCJzY2hlZHVsZUl0ZW0iLCJzaW5rIiwiRU1QVFlfT0JTRVJWQUJMRSIsIm9ic2VydmFibGVFbXB0eSIsIkZyb21PYnNlcnZhYmxlIiwiaXRlcmFibGUiLCJtYXBwZXIiLCJGcm9tU2luayIsImxpc3QiLCJwb3ciLCJjaGFyQXQiLCJvYnNlcnZhYmxlRnJvbSIsIm1hcEZuIiwib2JzZXJ2YWJsZUZyb21BcnJheSIsImZyb21BcnJheSIsIk5ldmVyT2JzZXJ2YWJsZSIsIk5FVkVSX09CU0VSVkFCTEUiLCJuZXZlciIsIm9mV2l0aFNjaGVkdWxlciIsIlBhaXJzT2JzZXJ2YWJsZSIsInBhaXJzIiwiUmFuZ2VPYnNlcnZhYmxlIiwicmFuZ2VDb3VudCIsIlJhbmdlU2luayIsInJhbmdlIiwiUmVwZWF0T2JzZXJ2YWJsZSIsIkp1c3RPYnNlcnZhYmxlIiwiSnVzdFNpbmsiLCJUaHJvd09ic2VydmFibGUiLCJUaHJvd1NpbmsiLCJDYXRjaE9ic2VydmFibGUiLCJkMSIsIkNhdGNoT2JzZXJ2ZXIiLCJoYW5kbGVyT3JTZWNvbmQiLCJvYnNlcnZhYmxlQ2F0Y2giLCJDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZSIsInBhcmFtcyIsIl9wYXJhbXMiLCJfY2IiLCJzdWJzY3JpcHRpb25zIiwic2FkIiwiQ29tYmluZUxhdGVzdE9ic2VydmVyIiwibm90VGhlU2FtZSIsImoiLCJmaWx0ZXIiLCJvYnNlcnZhYmxlQ29uY2F0IiwiQ29uY2F0T2JzZXJ2YWJsZSIsIkNvbmNhdFNpbmsiLCJjb25jYXRBbGwiLCJtZXJnZSIsIk1lcmdlT2JzZXJ2YWJsZSIsIm1heENvbmN1cnJlbnQiLCJnIiwiTWVyZ2VPYnNlcnZlciIsImFjdGl2ZUNvdW50IiwiaGFuZGxlU3Vic2NyaWJlIiwiaW5uZXJTb3VyY2UiLCJtYXhDb25jdXJyZW50T3JPdGhlciIsIm9ic2VydmFibGVNZXJnZSIsIm1lcmdlQWxsIiwiQ29tcG9zaXRlRXJyb3IiLCJlcnJvcnMiLCJpbm5lckVycm9ycyIsIk1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUiLCJNZXJnZURlbGF5RXJyb3JPYnNlcnZlciIsIl9ncm91cCIsInNldENvbXBsZXRpb24iLCJfaW5uZXIiLCJtZXJnZURlbGF5RXJyb3IiLCJNZXJnZUFsbE9ic2VydmFibGUiLCJNZXJnZUFsbE9ic2VydmVyIiwiU2tpcFVudGlsT2JzZXJ2YWJsZSIsIl9vcGVuIiwibGVmdFN1YnNjcmlwdGlvbiIsIlNraXBVbnRpbFNvdXJjZU9ic2VydmVyIiwicmlnaHRTdWJzY3JpcHRpb24iLCJTa2lwVW50aWxPdGhlck9ic2VydmVyIiwiX3AiLCJfciIsInNraXBVbnRpbCIsIlN3aXRjaE9ic2VydmFibGUiLCJTd2l0Y2hPYnNlcnZlciIsInN0b3BwZWQiLCJsYXRlc3QiLCJoYXNMYXRlc3QiLCJzd2l0Y2hMYXRlc3QiLCJUYWtlVW50aWxPYnNlcnZhYmxlIiwiVGFrZVVudGlsT2JzZXJ2ZXIiLCJ0YWtlVW50aWwiLCJXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUiLCJfc3MiLCJXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIiLCJXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyIiwiYWxsVmFsdWVzIiwid2l0aExhdGVzdEZyb20iLCJaaXBPYnNlcnZhYmxlIiwiWmlwT2JzZXJ2ZXIiLCJfcSIsIl9kIiwibm90RW1wdHkiLCJzaGlmdEVhY2giLCJxdWV1ZWRWYWx1ZXMiLCJ6aXAiLCJ6aXBJdGVyYWJsZSIsInF1ZXVlcyIsIkRlbWF0ZXJpYWxpemVPYnNlcnZhYmxlIiwiRGVtYXRlcmlhbGl6ZU9ic2VydmVyIiwiZGVtYXRlcmlhbGl6ZSIsIkRpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSIsImtleUZuIiwiRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlciIsImhhc0N1cnJlbnRLZXkiLCJjdXJyZW50S2V5IiwiY29tcGFyZXJFcXVhbHMiLCJkaXN0aW5jdFVudGlsQ2hhbmdlZCIsIlRhcE9ic2VydmFibGUiLCJfb04iLCJfb0UiLCJfb0MiLCJ0IiwidGFwIiwiZG9BY3Rpb24iLCJkb09uTmV4dCIsInRhcE9uTmV4dCIsImRvT25FcnJvciIsInRhcE9uRXJyb3IiLCJkb09uQ29tcGxldGVkIiwidGFwT25Db21wbGV0ZWQiLCJJZ25vcmVFbGVtZW50c09ic2VydmFibGUiLCJpZ25vcmVFbGVtZW50cyIsIk1hdGVyaWFsaXplT2JzZXJ2YWJsZSIsIk1hdGVyaWFsaXplT2JzZXJ2ZXIiLCJyZXRyeSIsInJldHJ5Q291bnQiLCJyZXRyeVdoZW4iLCJTY2FuT2JzZXJ2YWJsZSIsImFjY3VtdWxhdG9yIiwiaGFzU2VlZCIsInNlZWQiLCJTY2FuT2JzZXJ2ZXIiLCJfaHMiLCJfaGEiLCJfaHYiLCJzY2FuIiwiU2tpcExhc3RPYnNlcnZhYmxlIiwiX2MiLCJTa2lwTGFzdE9ic2VydmVyIiwic2tpcExhc3QiLCJUYWtlTGFzdE9ic2VydmVyIiwidGFrZUxhc3QiLCJmbGF0TWFwQ29uY2F0IiwiY29uY2F0TWFwIiwiTWFwT2JzZXJ2YWJsZSIsImlubmVyTWFwIiwiaW50ZXJuYWxNYXAiLCJzZWxlY3QiLCJzZWxlY3RvckZuIiwicGx1Y2siLCJzZWxlY3RNYW55IiwiZmxhdE1hcExhdGVzdCIsIlNraXBPYnNlcnZhYmxlIiwic2tpcENvdW50Iiwic2tpcCIsIlNraXBXaGlsZU9ic2VydmFibGUiLCJTa2lwV2hpbGVPYnNlcnZlciIsInNraXBXaGlsZSIsInByZWRpY2F0ZSIsIlRha2VPYnNlcnZhYmxlIiwidGFrZUNvdW50IiwidGFrZSIsIlRha2VXaGlsZU9ic2VydmFibGUiLCJUYWtlV2hpbGVPYnNlcnZlciIsInRha2VXaGlsZSIsIkZpbHRlck9ic2VydmFibGUiLCJpbm5lclByZWRpY2F0ZSIsImludGVybmFsRmlsdGVyIiwic2hvdWxkWWllbGQiLCJ3aGVyZSIsImZyb21DYWxsYmFjayIsImZyb21Ob2RlQ2FsbGJhY2siLCJyZW1vdmVFdmVudExpc3RlbmVyIiwidXNlTmF0aXZlRXZlbnRzIiwiRXZlbnRPYnNlcnZhYmxlIiwiX2VsIiwiY3JlYXRlSGFuZGxlciIsImZyb21FdmVudCIsImVsZW1lbnQiLCJmcm9tRXZlbnRQYXR0ZXJuIiwiaCIsInB1Ymxpc2giLCJyZWZDb3VudCIsIkV2ZW50UGF0dGVybk9ic2VydmFibGUiLCJkZWwiLCJfYWRkIiwiX2RlbCIsIkV2ZW50UGF0dGVybkRpc3Bvc2FibGUiLCJyZXQiLCJfcmV0IiwicmV0dXJuVmFsdWUiLCJhZGRIYW5kbGVyIiwicmVtb3ZlSGFuZGxlciIsIkZyb21Qcm9taXNlT2JzZXJ2YWJsZSIsInNjaGVkdWxlTmV4dCIsInNjaGVkdWxlRXJyb3IiLCJwcm9taXNlIiwidG9Qcm9taXNlIiwicHJvbWlzZUN0b3IiLCJyZXNvbHZlIiwicmVqZWN0Iiwic3RhcnRBc3luYyIsImZ1bmN0aW9uQXN5bmMiLCJNdWx0aWNhc3RPYnNlcnZhYmxlIiwiZm4xIiwiZm4yIiwiX2ZuMSIsIl9mbjIiLCJjb25uZWN0YWJsZSIsIm11bHRpY2FzdCIsImNvbm5lY3QiLCJzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IiLCJDb25uZWN0YWJsZU9ic2VydmFibGUiLCJzaGFyZSIsInB1Ymxpc2hMYXN0IiwicHVibGlzaFZhbHVlIiwiaW5pdGlhbFZhbHVlT3JTZWxlY3RvciIsImluaXRpYWxWYWx1ZSIsIkJlaGF2aW9yU3ViamVjdCIsInNoYXJlVmFsdWUiLCJyZXBsYXkiLCJidWZmZXJTaXplIiwid2luZG93U2l6ZSIsIlJlcGxheVN1YmplY3QiLCJzaGFyZVJlcGxheSIsIlJlZkNvdW50T2JzZXJ2YWJsZSIsIl9jb3VudCIsIl9jb25uZWN0YWJsZVN1YnNjcmlwdGlvbiIsInNob3VsZENvbm5lY3QiLCJfaGFzU3Vic2NyaXB0aW9uIiwiX3N1YnNjcmlwdGlvbiIsIl9zb3VyY2VPYnNlcnZhYmxlIiwiX3N1YmplY3QiLCJDb25uZWN0RGlzcG9zYWJsZSIsIl9kdCIsIm9ic2VydmFibGVpbnRlcnZhbCIsInBlcmlvZE9yU2NoZWR1bGVyIiwiZmlyc3RBcmciLCJEZWJvdW5jZU9ic2VydmFibGUiLCJEZWJvdW5jZU9ic2VydmVyIiwiX3YiLCJkZWJvdW5jZSIsIlRpbWVzdGFtcE9ic2VydmFibGUiLCJUaW1lc3RhbXBPYnNlcnZlciIsInNhbXBsZSIsInRocm90dGxlTGF0ZXN0IiwiaW50ZXJ2YWxPclNhbXBsZXIiLCJ3aW5kb3dEdXJhdGlvbiIsImR1cmF0aW9uIiwiUmFuZ2VFcnJvciIsImxhc3RPbk5leHQiLCJQYXVzYWJsZU9ic2VydmFibGUiLCJwYXVzZXIiLCJjb250cm9sbGVyIiwiY29ubiIsImNvbm5lY3Rpb24iLCJwYXVzYWJsZSIsInBhdXNlIiwicmVzdW1lIiwiUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUiLCJwcmV2aW91c1Nob3VsZEZpcmUiLCJzaG91bGRGaXJlIiwicGF1c2FibGVCdWZmZXJlZCIsIkNvbnRyb2xsZWRPYnNlcnZhYmxlIiwiZW5hYmxlUXVldWUiLCJDb250cm9sbGVkU3ViamVjdCIsInJlcXVlc3QiLCJudW1iZXJPZkl0ZW1zIiwicmVxdWVzdGVkQ291bnQiLCJyZXF1ZXN0ZWREaXNwb3NhYmxlIiwiaGFzRmFpbGVkIiwiaGFzQ29tcGxldGVkIiwiZGlzcG9zZUN1cnJlbnRSZXF1ZXN0IiwiX3Byb2Nlc3NSZXF1ZXN0IiwicmVtYWluaW5nIiwiY29udHJvbGxlZCIsInBpcGUiLCJkZXN0Iiwib25EcmFpbiIsIndyaXRlIiwiX2lzU3RkaW8iLCJlbmQiLCJUcmFuc2R1Y2VPYnNlcnZlciIsInhmb3JtIiwiX3hmb3JtIiwidHJhbnNkdWNlIiwidHJhbnNkdWNlciIsIl9fc3Vic2NyaWJlIiwiQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlIiwiSW5uZXJTdWJzY3JpcHRpb24iLCJvYnNlcnZlcnMiLCJoYXNFcnJvciIsImhhc09ic2VydmVycyIsIm9zIiwiQW5vbnltb3VzU3ViamVjdCIsImdldFZhbHVlIiwiY3JlYXRlUmVtb3ZhYmxlRGlzcG9zYWJsZSIsInNvIiwiX3RyaW0iLCJQYXVzZXIiLCJtZWRpYVF1ZXJ5IiwiYWxyZWFkeUltcG9ydGVkTW9kdWxlcyIsIl9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXyIsIl9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18iLCJnZW5lcmF0ZUNhbGxiYWNrRnVuY3Rpb24iLCJjZWlsIiwiY2xlYXJGdW5jdGlvbiIsImZ1bmN0aW9uTmFtZSIsInJlbW92ZVNjcmlwdCIsInNjcmlwdElkIiwic2NyaXB0IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImRlZmF1bHRPcHRpb25zIiwianNvbnBDYWxsYmFjayIsImZldGNoSnNvbnAiLCJvcHRpb25zIiwidGltZW91dElkIiwiY2FsbGJhY2tGdW5jdGlvbiIsInJlc3BvbnNlIiwib2siLCJqc29ucFNjcmlwdCIsInNldEF0dHJpYnV0ZSIsImNvbmZpZ0FuaW1hdGlvbiIsImxvb3AiLCJjdXJyZW50VGltZSIsImZyYW1lVGltZSIsInByZXZUaW1lIiwiYWNjdW11bGF0ZWRUaW1lIiwidGltZVNjYWxlIiwidGltZVN0ZXAiLCJtYXhTdGVwcyIsImZyYW1lTnVtYmVyIiwiYW5pbVJ1bm5pbmciLCJfYW5pbVJ1bm5pbmckaSIsImFuaW1hdGlvblN0ZXAiLCJwcmV2UHJldlN0YXRlIiwicHJldlN0YXRlIiwicHJldk5leHRTdGF0ZSIsIm5leHRTdGF0ZSIsIl9yZWYiLCJhbHBoYSIsIl9hbmltUnVubmluZyRpMiIsImFuaW1hdGlvblJlbmRlciIsIl9yZWYyIiwicmFmIiwiX2NvbmZpZyR0aW1lU3RlcCIsIl9jb25maWckdGltZVNjYWxlIiwiX2NvbmZpZyRtYXhTdGVwcyIsIl9jb25maWckcmFmIiwiX3JhZjIiLCJfY29uZmlnJG5vdyIsIl9wZXJmb3JtYW5jZU5vdzIiLCJ2YWwiLCJzdG9wIiwibmV3QW5pbSIsIl9wZXJmb3JtYW5jZU5vdyIsIl9yYWYiLCJtYXBPYmplY3QiLCJmIiwiZXZlcnlPYmoiLCJjb21wb25lbnRzIiwiUmVhY3QiLCJNb3Rpb24iLCJjcmVhdGVDbGFzcyIsImRpc3BsYXlOYW1lIiwiZGVmYXVsdFZhbHVlIiwicHJvcE5hbWUiLCJlbmRWYWx1ZSIsImRlZmF1bHRTdHlsZSIsImNoaWxkcmVuIiwiZ2V0SW5pdGlhbFN0YXRlIiwiX3Byb3BzIiwiY3VycmVudFN0eWxlIiwiY3VycmVudFZlbG9jaXR5IiwiX3plcm8yIiwiY29tcG9uZW50RGlkTW91bnQiLCJzdGFydEFuaW1hdGluZyIsImNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLCJ0aW1lc3RlcCIsIm5ld0N1cnJlbnRTdHlsZSIsIl91cGRhdGVUcmVlIiwidXBkYXRlQ3VycmVudFN0eWxlIiwibmV3Q3VycmVudFZlbG9jaXR5IiwidXBkYXRlQ3VycmVudFZlbG9jaXR5IiwiX25vVmVsb2NpdHkyIiwic3RvcEFuaW1hdGlvbiIsImhhc1VubW91bnRlZCIsImNvbXBvbmVudFdpbGxVbm1vdW50Iiwic3RhcnRBbmltYXRpb24iLCJpbnRlcnBvbGF0ZVZhbHVlIiwic3RyaXBwZWRTdHlsZSIsIl9zdHJpcFN0eWxlMiIsInJlbmRlcmVkQ2hpbGRyZW4iLCJDaGlsZHJlbiIsIm9ubHkiLCJTdGFnZ2VyZWRNb3Rpb24iLCJkZWZhdWx0U3R5bGVzIiwiYXJyYXlPZiIsIl9wcm9wczIiLCJjdXJyZW50U3R5bGVzIiwiY3VycmVudFZlbG9jaXRpZXMiLCJuZXdDdXJyZW50U3R5bGVzIiwibmV3Q3VycmVudFZlbG9jaXRpZXMiLCJrIiwib2JqZWN0T2YiLCJhbnkiLCJnZXREZWZhdWx0UHJvcHMiLCJfcHJvcHMzIiwiX3Byb3BzNCIsIm1lcmdlZFN0eWxlcyIsImhhc05ld0tleSIsIl9tZXJnZURpZmYyIiwiX2hhc1JlYWNoZWRTdHlsZTIiLCJfZXh0ZW5kczIiLCJfZXh0ZW5kczMiLCJlbnRlclN0eWxlIiwibWVyZ2VkU3R5bGUiLCJfZGVwcmVjYXRlZFNwcmluZ3MiLCJfZGVwcmVjYXRlZFNwcmluZ3MzIiwiU3ByaW5nIiwiVHJhbnNpdGlvblNwcmluZyIsIl9ub1ZlbG9jaXR5IiwiX2hhc1JlYWNoZWRTdHlsZSIsIl9tZXJnZURpZmYiLCJfYW5pbWF0aW9uTG9vcCIsIl9hbmltYXRpb25Mb29wMiIsIl96ZXJvIiwiX2RlcHJlY2F0ZWRTcHJpbmdzMiIsIl9zdHJpcFN0eWxlIiwiZGVwcmVjYXRlZFNwcmluZ3MiLCJjb21wb25lbnRXaWxsTW91bnQiLCJoYXNSZWFjaGVkU3R5bGUiLCJkZXN0VmFsdWUiLCJtZXJnZURpZmZBcnIiLCJfeDQiLCJfeDUiLCJfeDYiLCJfeDciLCJhcnJBIiwiYXJyQiIsImNvbGxCIiwiaW5kZXhBIiwiaW5kZXhCIiwib25SZW1vdmUiLCJhY2N1bSIsImVuZEEiLCJlbmRCIiwia2V5QSIsImtleUIiLCJmaWxsIiwibWVyZ2VEaWZmIiwibm9WZWxvY2l0eSIsIl9jb21wb25lbnRzMiIsIl9jb21wb25lbnRzMyIsIl9yZW9yZGVyS2V5cyIsIl9yZW9yZGVyS2V5czIiLCJfY29tcG9uZW50cyIsIl9zcHJpbmcyIiwiX3NwcmluZzMiLCJfcHJlc2V0czIiLCJfcHJlc2V0czMiLCJwcmVzZXRzIiwidXRpbHMiLCJyZW9yZGVyS2V5cyIsIm5ld0tleXMiLCJfcHJlc2V0cyIsInN0ZXBwZXIiLCJmcmFtZVJhdGUiLCJkZXN0WCIsIkZzcHJpbmciLCJGZGFtcGVyIiwibmV3ViIsIm5ld1giLCJlcnJvck1hcmdpbiIsInN0cmlwU3R5bGUiLCJuZXh0U3R5bGUiLCJwcmV2U3R5bGUiLCJwcmV2VmFsdWUiLCJfc3R5bGUka2V5JGNvbmZpZyIsIl9zdGVwcGVyMiIsIl9zdHlsZSRrZXkkY29uZmlnMiIsIl9zdGVwcGVyIiwiemVybyIsInZlbmRvcnMiLCJzdWZmaXgiLCJjYWYiLCJsYXN0IiwiZnJhbWVEdXJhdGlvbiIsIl9ub3ciLCJjcCIsImNhbmNlbGxlZCIsInJvdW5kIiwiY2FuY2VsIiwiYWRkU3R5bGVzVG9Eb20iLCJkb21TdHlsZSIsInN0eWxlc0luRG9tIiwicmVmcyIsInBhcnRzIiwiYWRkU3R5bGUiLCJsaXN0VG9TdHlsZXMiLCJuZXdTdHlsZXMiLCJjc3MiLCJtZWRpYSIsInNvdXJjZU1hcCIsInBhcnQiLCJjcmVhdGVTdHlsZUVsZW1lbnQiLCJzdHlsZUVsZW1lbnQiLCJoZWFkIiwiZ2V0SGVhZEVsZW1lbnQiLCJjcmVhdGVMaW5rRWxlbWVudCIsImxpbmtFbGVtZW50IiwicmVsIiwidXBkYXRlIiwic2luZ2xldG9uIiwic3R5bGVJbmRleCIsInNpbmdsZXRvbkNvdW50ZXIiLCJzaW5nbGV0b25FbGVtZW50IiwiYXBwbHlUb1NpbmdsZXRvblRhZyIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsInJldm9rZU9iamVjdFVSTCIsIkJsb2IiLCJidG9hIiwidXBkYXRlTGluayIsImFwcGx5VG9UYWciLCJuZXdPYmoiLCJzdHlsZVNoZWV0IiwiY3NzVGV4dCIsInJlcGxhY2VUZXh0IiwiY3NzTm9kZSIsImNyZWF0ZVRleHROb2RlIiwiY2hpbGROb2RlcyIsImluc2VydEJlZm9yZSIsImZpcnN0Q2hpbGQiLCJ1bmVzY2FwZSIsImVuY29kZVVSSUNvbXBvbmVudCIsIkpTT04iLCJzdHJpbmdpZnkiLCJibG9iIiwib2xkU3JjIiwibWVtb2l6ZSIsIm1lbW8iLCJpc09sZElFIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwidG9Mb3dlckNhc2UiLCJuZXdMaXN0IiwibWF5UmVtb3ZlIiwidGV4dFN0b3JlIiwicmVwbGFjZW1lbnQiLCJCb29sZWFuIiwiY29udGVudCIsImxvY2FscyIsIndlYnBhY2tQb2x5ZmlsbCIsImRlcHJlY2F0ZSIsInBhdGhzIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUNBLGdCQUFBQyxVQUFBLGdCQUFBQyxRQUNBQSxPQUFBRCxRQUFBRCxFQUFBRyxRQUFBLFNBQUFBLFFBQUEsYUFDQSxrQkFBQUMsZ0JBQUFDLElBQ0FELFFBQUEsb0JBQUFKLEdBQ0EsZ0JBQUFDLFNBQ0FBLFFBQUEsc0JBQUFELEVBQUFHLFFBQUEsU0FBQUEsUUFBQSxhQUVBSixFQUFBLHNCQUFBQyxFQUFBRCxFQUFBLE1BQUFBLEVBQUEsV0FDQ08sS0FBQSxTQUFBQyxFQUFBQyxHQUNELE1DQWdCLFVBQVVDLEdDTjFCLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBVixPQUdBLElBQUFDLEdB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R0FBQTlDLEdBQUFELEVBQUErQyxFQUNBckQsR0FBQU8sRUFBQXpMLEdBRUEsT0FBQXRsQyxHQUFBLEVBQWdCQSxFQUFBOHpDLEVBQUE3ekMsT0FBc0JELElBQUEsQ0FDdEMsR0FBQXl3QyxHQUFBcUQsRUFBQTl6QyxFQUNBLFFBQUF5d0MsRUFBQUUsS0FBQSxDQUNBLE9BQUE5YyxHQUFBLEVBQWtCQSxFQUFBNGMsRUFBQUcsTUFBQTN3QyxPQUEyQjR6QixJQUM3QzRjLEVBQUFHLE1BQUEvYyxXQUNBNmMsR0FBQUQsRUFBQW55QyxPQXdHQSxJQUFBcTBDLEdBQUEsV0FDQSxHQUFBb0IsS0FFQSxpQkFBQTlnQyxFQUFBK2dDLEdBRUEsTUFEQUQsR0FBQTlnQyxHQUFBK2dDLEVBQ0FELEVBQUFqZ0IsT0FBQW1nQixTQUFBdmpDLEtBQUEsV3BDZzVTTSxTQUFTL1MsRUFBUUQsRUFBU1MsR3FDN2lUaEMsR0FBQSsxQyxHQUFBLzFDLEVBQUEsR0FDQSxpQkFBQSsxQyxTQUFBdjJDLEVBQUFXLEdBQUE0MUMsRUFBQSxLQUVBLzFDLEdBQUEsSUFBQSsxQyxLQUNBQSxHQUFBQyxTQUFBeDJDLEVBQUFELFFBQUF3MkMsRUFBQUMsU3JDbWtUTSxTQUFTeDJDLEVBQVFELEdzQzFrVHZCQyxFQUFBRCxRQUFBO0V0Q2dsVE0sU0FBU0MsRUFBUUQsR3VDaGxUdkJDLEVBQUFELFFBQUEsU0FBQUMsR0FRQSxNQVBBQSxHQUFBeTJDLGtCQUNBejJDLEVBQUEwMkMsVUFBQSxhQUNBMTJDLEVBQUEyMkMsU0FFQTMyQyxFQUFBaXJDLFlBQ0FqckMsRUFBQXkyQyxnQkFBQSxHQUVBejJDLEl2Q3dsVE0sU0FBU0EsRUFBUUQsR3dDaG1UdkJDLEVBQUFELFFBQUFPIiwiZmlsZSI6InJlYWN0LWNsaW1iLXNvY2lhbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJyZWFjdFwiKSwgcmVxdWlyZShcIlJlYWN0RE9NXCIpKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtcInJlYWN0XCIsIFwiUmVhY3RET01cIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wicmVhY3QtY2xpbWItc29jaWFsXCJdID0gZmFjdG9yeShyZXF1aXJlKFwicmVhY3RcIiksIHJlcXVpcmUoXCJSZWFjdERPTVwiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wicmVhY3QtY2xpbWItc29jaWFsXCJdID0gZmFjdG9yeShyb290W1wiUmVhY3RcIl0sIHJvb3RbXCJSZWFjdERPTVwiXSk7XG59KSh0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8zOF9fKSB7XG5yZXR1cm4gXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uXG4gKiovIiwiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicmVhY3RcIiksIHJlcXVpcmUoXCJSZWFjdERPTVwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJyZWFjdFwiLCBcIlJlYWN0RE9NXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInJlYWN0LWNsaW1iLXNvY2lhbFwiXSA9IGZhY3RvcnkocmVxdWlyZShcInJlYWN0XCIpLCByZXF1aXJlKFwiUmVhY3RET01cIikpO1xuXHRlbHNlXG5cdFx0cm9vdFtcInJlYWN0LWNsaW1iLXNvY2lhbFwiXSA9IGZhY3Rvcnkocm9vdFtcIlJlYWN0XCJdLCByb290W1wiUmVhY3RET01cIl0pO1xufSkodGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMzhfXykge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9cIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBfcmVhY3REb20gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KTtcblx0XG5cdHZhciBfcmVhY3REb20yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3REb20pO1xuXHRcblx0dmFyIF9jb21wb25lbnRzV2FsbFdhbGxDb250YWluZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTtcblx0XG5cdHZhciBfY29tcG9uZW50c1dhbGxXYWxsQ29udGFpbmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudHNXYWxsV2FsbENvbnRhaW5lcik7XG5cdFxuXHR2YXIgX2NvbXBvbmVudHNTbGlkZXNob3dTbGlkZXNob3dDb250YWluZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEyKTtcblx0XG5cdHZhciBfY29tcG9uZW50c1NsaWRlc2hvd1NsaWRlc2hvd0NvbnRhaW5lcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRzU2xpZGVzaG93U2xpZGVzaG93Q29udGFpbmVyKTtcblx0XG5cdF9fd2VicGFja19yZXF1aXJlX18oMzUpO1xuXHRcblx0aWYgKHdpbmRvdykge1xuXHQgICAgd2luZG93LkNsaW1iID0gd2luZG93LkNsaW1iIHx8IHt9O1xuXHRcblx0ICAgIHZhciAkd2FsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2xpbWItd2FsbCcpO1xuXHRcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHdhbGxzLmxlbmd0aDsgKytpKSB7XG5cdCAgICAgICAgdmFyICRpdGVtID0gJHdhbGxzW2ldO1xuXHQgICAgICAgIHZhciBjb2xsZWN0aW9uSWQgPSAkaXRlbS5kYXRhc2V0LmNvbGxlY3Rpb25JZDtcblx0ICAgICAgICB2YXIgbGltaXQgPSAkaXRlbS5kYXRhc2V0LmxpbWl0O1xuXHRcblx0ICAgICAgICBfcmVhY3REb20yWydkZWZhdWx0J10ucmVuZGVyKF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzV2FsbFdhbGxDb250YWluZXIyWydkZWZhdWx0J10sIHsgY29sbGVjdGlvbklkOiBjb2xsZWN0aW9uSWQsIGxpbWl0OiBsaW1pdCB9KSwgJGl0ZW0pO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciAkc2xpZGVzaG93cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbGltYi1zbGlkZXNob3cnKTtcblx0XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzbGlkZXNob3dzLmxlbmd0aDsgKytpKSB7XG5cdCAgICAgICAgdmFyICRpdGVtID0gJHNsaWRlc2hvd3NbaV07XG5cdCAgICAgICAgdmFyIGNvbGxlY3Rpb25JZCA9ICRpdGVtLmRhdGFzZXQuY29sbGVjdGlvbklkO1xuXHRcblx0ICAgICAgICBfcmVhY3REb20yWydkZWZhdWx0J10ucmVuZGVyKF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzU2xpZGVzaG93U2xpZGVzaG93Q29udGFpbmVyMlsnZGVmYXVsdCddLCB7IGNvbGxlY3Rpb25JZDogY29sbGVjdGlvbklkIH0pLCAkaXRlbSk7XG5cdCAgICB9XG5cdH1cblx0XG5cdGV4cG9ydHMuV2FsbENvbnRhaW5lciA9IF9jb21wb25lbnRzV2FsbFdhbGxDb250YWluZXIyWydkZWZhdWx0J107XG5cdFxuXHR2YXIgX2NvbXBvbmVudHNXYWxsV2FsbCA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ1dhbGwnLCB7XG5cdCAgICBlbnVtZXJhYmxlOiB0cnVlLFxuXHQgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdCAgICAgICAgcmV0dXJuIF9jb21wb25lbnRzV2FsbFdhbGwuV2FsbDtcblx0ICAgIH1cblx0fSk7XG5cdFxuXHR2YXIgX2NvbXBvbmVudHNXYWxsVGlsZSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ1RpbGUnLCB7XG5cdCAgICBlbnVtZXJhYmxlOiB0cnVlLFxuXHQgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdCAgICAgICAgcmV0dXJuIF9jb21wb25lbnRzV2FsbFRpbGUuVGlsZTtcblx0ICAgIH1cblx0fSk7XG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMV9fO1xuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBcImRlZmF1bHRcIjogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgSW1hZ2UgPSAoZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhJbWFnZSwgX1JlYWN0JENvbXBvbmVudCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gSW1hZ2UoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEltYWdlKTtcblx0XG5cdCAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoSW1hZ2UucHJvdG90eXBlKSwgXCJjb25zdHJ1Y3RvclwiLCB0aGlzKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhJbWFnZSwgW3tcblx0ICAgICAgICBrZXk6IFwicmVuZGVyXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgeyBjbGFzc05hbWU6IFwiY2xpbWJfX2ltYWdlXCIsXG5cdCAgICAgICAgICAgICAgICBzcmM6IHRoaXMucHJvcHMuc3JjLCBcImRhdGEtd2lkdGhcIjogdGhpcy5wcm9wcy53aWR0aCwgXCJkYXRhLWhlaWdodFwiOiB0aGlzLnByb3BzLmhlaWdodCB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIEltYWdlO1xuXHR9KShfcmVhY3QyW1wiZGVmYXVsdFwiXS5Db21wb25lbnQpO1xuXHRcblx0SW1hZ2UucHJvcFR5cGVzID0ge1xuXHQgICAgc3JjOiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICB3aWR0aDogX3JlYWN0MltcImRlZmF1bHRcIl0uUHJvcFR5cGVzLm51bWJlcixcblx0ICAgIGhlaWdodDogX3JlYWN0MltcImRlZmF1bHRcIl0uUHJvcFR5cGVzLm51bWJlclxuXHR9O1xuXHRcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBJbWFnZTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgTWVzc2FnZSA9IChmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKE1lc3NhZ2UsIF9SZWFjdCRDb21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIE1lc3NhZ2UoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lc3NhZ2UpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihNZXNzYWdlLnByb3RvdHlwZSksICdjb25zdHJ1Y3RvcicsIHRoaXMpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKE1lc3NhZ2UsIFt7XG5cdCAgICAgICAga2V5OiAncmVuZGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcblx0ICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSB0aGlzLnByb3BzLmJvZHkucmVwbGFjZSgvPGEgaHJlZj1cImh0dHA6XFwvXFwvcGljLnR3aXR0ZXIuY29tXFwvW14+XSo+KFtePF0rKTxcXC9hPi9nLCAnJyk7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnY2xpbWJfX3RpbGVfX21lc3NhZ2UnLFxuXHQgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHsgX19odG1sOiBtZXNzYWdlIH0gfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBNZXNzYWdlO1xuXHR9KShfcmVhY3QyWydkZWZhdWx0J10uQ29tcG9uZW50KTtcblx0XG5cdE1lc3NhZ2UucHJvcFR5cGVzID0ge1xuXHQgICAgYm9keTogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuXHR9O1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gTWVzc2FnZTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmICgndmFsdWUnIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cdFxuXHR2YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXHRcblx0dmFyIF9jb21tb25JbWFnZSA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR2YXIgX2NvbW1vbkltYWdlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbW1vbkltYWdlKTtcblx0XG5cdHZhciBfY29tbW9uTWVzc2FnZSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdFxuXHR2YXIgX2NvbW1vbk1lc3NhZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tbW9uTWVzc2FnZSk7XG5cdFxuXHR2YXIgX2NvbW1vbkF1dGhvciA9IF9fd2VicGFja19yZXF1aXJlX18oMTApO1xuXHRcblx0dmFyIF9jb21tb25BdXRob3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tbW9uQXV0aG9yKTtcblx0XG5cdHZhciBUaWxlID0gKGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG5cdCAgICBfaW5oZXJpdHMoVGlsZSwgX1JlYWN0JENvbXBvbmVudCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gVGlsZShwcm9wcykge1xuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUaWxlKTtcblx0XG5cdCAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoVGlsZS5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5jYWxsKHRoaXMsIHByb3BzKTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoVGlsZSwgW3tcblx0ICAgICAgICBrZXk6ICdjcmVhdGVJbWFnZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUltYWdlKCkge1xuXHRcblx0ICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuaW1hZ2UgIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBfcHJvcHMkaW1hZ2UgPSB0aGlzLnByb3BzLmltYWdlO1xuXHQgICAgICAgICAgICAgICAgdmFyIHNyYyA9IF9wcm9wcyRpbWFnZS51cmw7XG5cdCAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBfcHJvcHMkaW1hZ2Uud2lkdGg7XG5cdCAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gX3Byb3BzJGltYWdlLmhlaWdodDtcblx0XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX2NvbW1vbkltYWdlMlsnZGVmYXVsdCddLCB7IHNyYzogc3JjLFxuXHQgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcblx0ICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCB9KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY3JlYXRlTWVzc2FnZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZU1lc3NhZ2UoKSB7XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5tZXNzYWdlKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX2NvbW1vbk1lc3NhZ2UyWydkZWZhdWx0J10sIHsgYm9keTogdGhpcy5wcm9wcy5tZXNzYWdlIH0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdjcmVhdGVDbGFzc1N0cmluZycsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUNsYXNzU3RyaW5nKCkge1xuXHRcblx0ICAgICAgICAgICAgdmFyIGNsYXNzU3RyaW5nID0gJ2NsaW1iX190aWxlIGNsaW1iX190aWxlLS0nICsgdGhpcy5wcm9wcy5zb3VyY2VfdHlwZTtcblx0XG5cdCAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLmltYWdlKSB7XG5cdCAgICAgICAgICAgICAgICBjbGFzc1N0cmluZyArPSAnIGNsaW1iX190aWxlLS1oYXMtbWVkaWEgY2xpbWJfX3RpbGUtLWhhcy1pbWFnZSc7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBjbGFzc1N0cmluZyArPSAnIGNsaW1iX190aWxlLS1oYXMtbm8taW1hZ2UnO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5wcm9wcy52aWRlb191cmwpIHtcblx0ICAgICAgICAgICAgICAgIGNsYXNzU3RyaW5nICs9ICcgY2xpbWJfX3RpbGUtLWhhcy1tZWRpYSBjbGltYl9fdGlsZS0taGFzLXZpZGVvJztcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGNsYXNzU3RyaW5nICs9ICcgY2xpbWJfX3RpbGUtLWhhcy1uby12aWRlbyc7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiBjbGFzc1N0cmluZztcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVuZGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcblx0ICAgICAgICAgICAgdmFyIGltYWdlID0gdGhpcy5jcmVhdGVJbWFnZSgpO1xuXHQgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IHRoaXMuY3JlYXRlTWVzc2FnZSgpO1xuXHQgICAgICAgICAgICB2YXIgY2xhc3NTdHJpbmcgPSB0aGlzLmNyZWF0ZUNsYXNzU3RyaW5nKCk7XG5cdCAgICAgICAgICAgIHZhciBhdXRob3IgPSB0aGlzLnByb3BzLmF1dGhvcjtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChcblx0ICAgICAgICAgICAgICAgICdkaXYnLFxuXHQgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6IGNsYXNzU3RyaW5nLFxuXHQgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB0aGlzLnByb3BzLnN0eWxlIH0sXG5cdCAgICAgICAgICAgICAgICBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChcblx0ICAgICAgICAgICAgICAgICAgICAnYScsXG5cdCAgICAgICAgICAgICAgICAgICAgeyBocmVmOiB0aGlzLnByb3BzLmxpbmsgfSxcblx0ICAgICAgICAgICAgICAgICAgICBpbWFnZVxuXHQgICAgICAgICAgICAgICAgKSxcblx0ICAgICAgICAgICAgICAgIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgICAgICdkaXYnLFxuXHQgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnY2xpbWJfX3RpbGVfX2NvbnRlbnQnIH0sXG5cdCAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSxcblx0ICAgICAgICAgICAgICAgICAgICBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfY29tbW9uQXV0aG9yMlsnZGVmYXVsdCddLCBhdXRob3IpXG5cdCAgICAgICAgICAgICAgICApXG5cdCAgICAgICAgICAgICk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBUaWxlO1xuXHR9KShfcmVhY3QyWydkZWZhdWx0J10uQ29tcG9uZW50KTtcblx0XG5cdFRpbGUucHJvcFR5cGVzID0ge1xuXHRcblx0ICAgIC8vIFJlcXVpcmVkIGF0dHJzXG5cdCAgICBsaW5rOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuXHQgICAgc291cmNlX3R5cGU6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICB0aW1lc3RhbXA6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG5cdCAgICBhdXRob3I6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc2hhcGUoe1xuXHQgICAgICAgIHVzZXJuYW1lOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuXHQgICAgICAgIHBpY3R1cmU6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICAgICAgbGluazogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuXHQgICAgfSksXG5cdFxuXHQgICAgLy8gT3B0aW9uYWwgYXR0cnNcblx0ICAgIG1lc3NhZ2U6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc3RyaW5nLFxuXHQgICAgdmlkZW9fc3JjOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnN0cmluZyxcblx0ICAgIGltYWdlOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnNoYXBlKHtcblx0ICAgICAgICB1cmw6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICAgICAgd2lkdGg6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG5cdCAgICAgICAgaGVpZ2h0OiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkXG5cdCAgICB9KVxuXHRcblx0fTtcblx0XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IFRpbGU7XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhvYmosIGtleXMpIHsgdmFyIHRhcmdldCA9IHt9OyBmb3IgKHZhciBpIGluIG9iaikgeyBpZiAoa2V5cy5pbmRleE9mKGkpID49IDApIGNvbnRpbnVlOyBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGkpKSBjb250aW51ZTsgdGFyZ2V0W2ldID0gb2JqW2ldOyB9IHJldHVybiB0YXJnZXQ7IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgX1RpbGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHRcblx0dmFyIF9UaWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1RpbGUpO1xuXHRcblx0dmFyIF9yZWFjdE1vdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMjYpO1xuXHRcblx0dmFyIFdhbGwgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhXYWxsLCBfQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBXYWxsKCkge1xuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXYWxsKTtcblx0XG5cdCAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoV2FsbC5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhXYWxsLCBbe1xuXHQgICAgICAgIGtleTogJ2dldFN0eWxlcycsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0eWxlcygpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHZhciBjb25maWdzID0ge307XG5cdCAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMucHJvcHMuaXRlbXMpLm1hcChmdW5jdGlvbiAoa2V5KSB7XG5cdCAgICAgICAgICAgICAgICBjb25maWdzW2tleV0gPSB7XG5cdCAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDEpLFxuXHQgICAgICAgICAgICAgICAgICAgIHdpZHRoOiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMzApLFxuXHQgICAgICAgICAgICAgICAgICAgIG1hcmdpbjogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDEpLFxuXHQgICAgICAgICAgICAgICAgICAgIGl0ZW06IF90aGlzLnByb3BzLml0ZW1zW2tleV1cblx0ICAgICAgICAgICAgICAgIH07XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICByZXR1cm4gY29uZmlncztcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnd2lsbEVudGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gd2lsbEVudGVyKGtleSkge1xuXHQgICAgICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICAgICAgb3BhY2l0eTogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgd2lkdGg6ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgwKSxcblx0ICAgICAgICAgICAgICAgIG1hcmdpbjogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3dpbGxMZWF2ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpbGxMZWF2ZShrZXksIHN0eWxlKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgICAgICBvcGFjaXR5OiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMCksXG5cdCAgICAgICAgICAgICAgICB3aWR0aDogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgbWFyZ2luOiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMCksXG5cdCAgICAgICAgICAgICAgICBpdGVtOiBzdHlsZS5pdGVtXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbmRlclRpbGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJUaWxlKGtleSwgaXRlbVZhbHVlcykge1xuXHQgICAgICAgICAgICB2YXIgaXRlbSA9IGl0ZW1WYWx1ZXMuaXRlbTtcblx0XG5cdCAgICAgICAgICAgIHZhciBzdHlsZUNvbmZpZyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhpdGVtVmFsdWVzLCBbJ2l0ZW0nXSk7XG5cdFxuXHQgICAgICAgICAgICB2YXIgaXRlbVByb3BzID0gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKGl0ZW0sIFtdKTtcblx0XG5cdCAgICAgICAgICAgIHZhciBzdHlsZSA9IHtcblx0ICAgICAgICAgICAgICAgIG9wYWNpdHk6IHN0eWxlQ29uZmlnLm9wYWNpdHksXG5cdCAgICAgICAgICAgICAgICB3aWR0aDogc3R5bGVDb25maWcud2lkdGggKyAnJScsXG5cdCAgICAgICAgICAgICAgICBtYXJnaW5MZWZ0OiBzdHlsZUNvbmZpZy5tYXJnaW4gKyAnJScsXG5cdCAgICAgICAgICAgICAgICBtYXJnaW5SaWdodDogc3R5bGVDb25maWcubWFyZ2luICsgJyUnXG5cdCAgICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX1RpbGUyWydkZWZhdWx0J10sIF9leHRlbmRzKHsga2V5OiBrZXksXG5cdCAgICAgICAgICAgICAgICBzdHlsZTogc3R5bGVcblx0ICAgICAgICAgICAgfSwgaXRlbVByb3BzKSk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbmRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgICAgICAgICBfcmVhY3RNb3Rpb24uVHJhbnNpdGlvbk1vdGlvbixcblx0ICAgICAgICAgICAgICAgIHtcblx0ICAgICAgICAgICAgICAgICAgICBzdHlsZXM6IHRoaXMuZ2V0U3R5bGVzLmJpbmQodGhpcykoKSxcblx0ICAgICAgICAgICAgICAgICAgICB3aWxsRW50ZXI6IHRoaXMud2lsbEVudGVyLmJpbmQodGhpcyksXG5cdCAgICAgICAgICAgICAgICAgICAgd2lsbExlYXZlOiB0aGlzLndpbGxMZWF2ZS5iaW5kKHRoaXMpIH0sXG5cdCAgICAgICAgICAgICAgICBmdW5jdGlvbiAodmFsdWVzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAnZGl2Jyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdjbGltYl9fd2FsbCcgfSxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXModmFsdWVzKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZXMgPSB2YWx1ZXNba2V5XTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIucmVuZGVyVGlsZShrZXksIGl0ZW1WYWx1ZXMpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXHQgICAgICAgICAgICAgICAgICAgICk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0sIFt7XG5cdCAgICAgICAga2V5OiAncHJvcFR5cGVzJyxcblx0ICAgICAgICB2YWx1ZToge1xuXHQgICAgICAgICAgICBpdGVtczogX3JlYWN0LlByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBXYWxsO1xuXHR9KShfcmVhY3QuQ29tcG9uZW50KTtcblx0XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IFdhbGw7XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX3J4TGl0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpO1xuXHRcblx0dmFyIF9mZXRjaEpzb25wID0gX193ZWJwYWNrX3JlcXVpcmVfXygxOSk7XG5cdFxuXHR2YXIgX2ZldGNoSnNvbnAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmV0Y2hKc29ucCk7XG5cdFxuXHR2YXIgZ2V0U3RyZWFtID0gZnVuY3Rpb24gZ2V0U3RyZWFtKGNvbGxlY3Rpb25JZCkge1xuXHRcblx0ICAgIHZhciBwb2xsUmF0ZSA9IDUgKiAxMDAwO1xuXHRcblx0ICAgIHZhciByZXF1ZXN0U3RyZWFtID0gX3J4TGl0ZS5PYnNlcnZhYmxlLmp1c3QoJ2h0dHA6Ly9hcHAuY2xpbWIuc29jaWFsL2FwaS92MS9jb2xsZWN0aW9ucy8nICsgY29sbGVjdGlvbklkKTtcblx0XG5cdCAgICB2YXIgdXBkYXRlU3RyZWFtID0gX3J4TGl0ZS5PYnNlcnZhYmxlLmludGVydmFsKHBvbGxSYXRlKS5zdGFydFdpdGgobnVsbCk7XG5cdFxuXHQgICAgdmFyIHJlc3BvbnNlU3RyZWFtID0gdXBkYXRlU3RyZWFtLmNvbWJpbmVMYXRlc3QocmVxdWVzdFN0cmVhbSwgZnVuY3Rpb24gKHRpY2ssIHVybCkge1xuXHQgICAgICAgIHJldHVybiB1cmw7XG5cdCAgICB9KS5mbGF0TWFwKGZ1bmN0aW9uIChiYXNlVXJsKSB7XG5cdFxuXHQgICAgICAgIHZhciByZXF1ZXN0VXJsID0gJycgKyBiYXNlVXJsO1xuXHRcblx0ICAgICAgICByZXR1cm4gX3J4TGl0ZS5PYnNlcnZhYmxlLmZyb21Qcm9taXNlKCgwLCBfZmV0Y2hKc29ucDJbJ2RlZmF1bHQnXSkocmVxdWVzdFVybCkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuXHQgICAgICAgICAgICByZXR1cm4gcmVzcC5qc29uKCk7XG5cdCAgICAgICAgfSkpO1xuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIHJlc3BvbnNlU3RyZWFtO1xuXHR9O1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0ge1xuXHQgICAgZ2V0U3RyZWFtOiBnZXRTdHJlYW1cblx0fTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cblxuLyoqKi8gfSxcbi8qIDcgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIFtzdGlmZm5lc3MsIGRhbXBpbmddXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB7XG5cdCAgbm9Xb2JibGU6IFsxNzAsIDI2XSwgLy8gdGhlIGRlZmF1bHRcblx0ICBnZW50bGU6IFsxMjAsIDE0XSxcblx0ICB3b2JibHk6IFsxODAsIDEyXSxcblx0ICBzdGlmZjogWzIxMCwgMjBdXG5cdH07XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiA4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24ocHJvY2Vzcykgey8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS43LjFcblx0KGZ1bmN0aW9uKCkge1xuXHQgIHZhciBnZXROYW5vU2Vjb25kcywgaHJ0aW1lLCBsb2FkVGltZTtcblx0XG5cdCAgaWYgKCh0eXBlb2YgcGVyZm9ybWFuY2UgIT09IFwidW5kZWZpbmVkXCIgJiYgcGVyZm9ybWFuY2UgIT09IG51bGwpICYmIHBlcmZvcm1hbmNlLm5vdykge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIHBlcmZvcm1hbmNlLm5vdygpO1xuXHQgICAgfTtcblx0ICB9IGVsc2UgaWYgKCh0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwcm9jZXNzICE9PSBudWxsKSAmJiBwcm9jZXNzLmhydGltZSkge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIChnZXROYW5vU2Vjb25kcygpIC0gbG9hZFRpbWUpIC8gMWU2O1xuXHQgICAgfTtcblx0ICAgIGhydGltZSA9IHByb2Nlc3MuaHJ0aW1lO1xuXHQgICAgZ2V0TmFub1NlY29uZHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgdmFyIGhyO1xuXHQgICAgICBociA9IGhydGltZSgpO1xuXHQgICAgICByZXR1cm4gaHJbMF0gKiAxZTkgKyBoclsxXTtcblx0ICAgIH07XG5cdCAgICBsb2FkVGltZSA9IGdldE5hbm9TZWNvbmRzKCk7XG5cdCAgfSBlbHNlIGlmIChEYXRlLm5vdykge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIERhdGUubm93KCkgLSBsb2FkVGltZTtcblx0ICAgIH07XG5cdCAgICBsb2FkVGltZSA9IERhdGUubm93KCk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIGxvYWRUaW1lO1xuXHQgICAgfTtcblx0ICAgIGxvYWRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdCAgfVxuXHRcblx0fSkuY2FsbCh0aGlzKTtcblx0XG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpKSlcblxuLyoqKi8gfSxcbi8qIDkgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXHRcblx0dmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXHR2YXIgcXVldWUgPSBbXTtcblx0dmFyIGRyYWluaW5nID0gZmFsc2U7XG5cdHZhciBjdXJyZW50UXVldWU7XG5cdHZhciBxdWV1ZUluZGV4ID0gLTE7XG5cdFxuXHRmdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG5cdCAgICBkcmFpbmluZyA9IGZhbHNlO1xuXHQgICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcblx0ICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG5cdCAgICB9XG5cdCAgICBpZiAocXVldWUubGVuZ3RoKSB7XG5cdCAgICAgICAgZHJhaW5RdWV1ZSgpO1xuXHQgICAgfVxuXHR9XG5cdFxuXHRmdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuXHQgICAgaWYgKGRyYWluaW5nKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHQgICAgdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG5cdCAgICBkcmFpbmluZyA9IHRydWU7XG5cdFxuXHQgICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcblx0ICAgIHdoaWxlKGxlbikge1xuXHQgICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuXHQgICAgICAgIHF1ZXVlID0gW107XG5cdCAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuXHQgICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG5cdCAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuXHQgICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcblx0ICAgIH1cblx0ICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG5cdCAgICBkcmFpbmluZyA9IGZhbHNlO1xuXHQgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuXHR9XG5cdFxuXHRwcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuXHQgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuXHQgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHQgICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcblx0ICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG5cdCAgICAgICAgc2V0VGltZW91dChkcmFpblF1ZXVlLCAwKTtcblx0ICAgIH1cblx0fTtcblx0XG5cdC8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcblx0ZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG5cdCAgICB0aGlzLmZ1biA9IGZ1bjtcblx0ICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcblx0fVxuXHRJdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcblx0fTtcblx0cHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcblx0cHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcblx0cHJvY2Vzcy5lbnYgPSB7fTtcblx0cHJvY2Vzcy5hcmd2ID0gW107XG5cdHByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xuXHRwcm9jZXNzLnZlcnNpb25zID0ge307XG5cdFxuXHRmdW5jdGlvbiBub29wKCkge31cblx0XG5cdHByb2Nlc3Mub24gPSBub29wO1xuXHRwcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcblx0cHJvY2Vzcy5vbmNlID0gbm9vcDtcblx0cHJvY2Vzcy5vZmYgPSBub29wO1xuXHRwcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcblx0cHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xuXHRwcm9jZXNzLmVtaXQgPSBub29wO1xuXHRcblx0cHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcblx0ICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcblx0fTtcblx0XG5cdHByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5cdHByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG5cdCAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xuXHR9O1xuXHRwcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cbi8qKiovIH0sXG4vKiAxMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBcImRlZmF1bHRcIjogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgQXV0aG9yID0gKGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG5cdCAgICBfaW5oZXJpdHMoQXV0aG9yLCBfUmVhY3QkQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBBdXRob3IoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1dGhvcik7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKEF1dGhvci5wcm90b3R5cGUpLCBcImNvbnN0cnVjdG9yXCIsIHRoaXMpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKEF1dGhvciwgW3tcblx0ICAgICAgICBrZXk6IFwicmVuZGVyXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgXCJhXCIsXG5cdCAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogXCJjbGltYl9fdGlsZV9fYXV0aG9yXCIsXG5cdCAgICAgICAgICAgICAgICAgICAgaHJlZjogdGhpcy5wcm9wcy5saW5rIH0sXG5cdCAgICAgICAgICAgICAgICBfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KFwiaW1nXCIsIHsgc3JjOiB0aGlzLnByb3BzLnBpY3R1cmUsXG5cdCAgICAgICAgICAgICAgICAgICAgYWx0OiBcIlByb2ZpbGUgcGljIG9mIFwiICsgdGhpcy5wcm9wcy5uYW1lIH0pLFxuXHQgICAgICAgICAgICAgICAgX3JlYWN0MltcImRlZmF1bHRcIl0uY3JlYXRlRWxlbWVudChcblx0ICAgICAgICAgICAgICAgICAgICBcImg0XCIsXG5cdCAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6IFwiY2xpbWJfX3RpbGVfX2F1dGhvcl9fdXNlcm5hbWVcIiB9LFxuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvcHMudXNlcm5hbWVcblx0ICAgICAgICAgICAgICAgIClcblx0ICAgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIEF1dGhvcjtcblx0fSkoX3JlYWN0MltcImRlZmF1bHRcIl0uQ29tcG9uZW50KTtcblx0XG5cdEF1dGhvci5wcm9wVHlwZXMgPSB7fTtcblx0XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gQXV0aG9yO1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogMTEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgX3NsaWRlID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7XG5cdFxuXHR2YXIgX3NsaWRlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NsaWRlKTtcblx0XG5cdHZhciBTbGlkZXNob3cgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhTbGlkZXNob3csIF9Db21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFNsaWRlc2hvdyhwcm9wcykge1xuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTbGlkZXNob3cpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihTbGlkZXNob3cucHJvdG90eXBlKSwgJ2NvbnN0cnVjdG9yJywgdGhpcykuY2FsbCh0aGlzLCBwcm9wcyk7XG5cdCAgICAgICAgdGhpcy5zdGF0ZSA9IHtcblx0ICAgICAgICAgICAgY3VycmVudEl0ZW1JbmRleDogMFxuXHQgICAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFNsaWRlc2hvdywgW3tcblx0ICAgICAgICBrZXk6ICdjb21wb25lbnREaWRNb3VudCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuXHQgICAgICAgICAgICB2YXIgZGVsYXkgPSB0aGlzLnByb3BzLmRlbGF5O1xuXHRcblx0ICAgICAgICAgICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKHRoaXMubmV4dFNsaWRlLmJpbmQodGhpcyksIGRlbGF5ICogMTAwMCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2NvbXBvbmVudFdpbGxVbm1vdW50Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG5cdCAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ25leHRTbGlkZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG5leHRTbGlkZSgpIHtcblx0ICAgICAgICAgICAgdmFyIHNsaWRlc2hvd0xlbmd0aCA9IE9iamVjdC5rZXlzKHRoaXMucHJvcHMuaXRlbXMpLmxlbmd0aDtcblx0ICAgICAgICAgICAgdmFyIG5ld0luZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2xpZGVzaG93TGVuZ3RoKTtcblx0ICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG5cdCAgICAgICAgICAgICAgICBjdXJyZW50SXRlbUluZGV4OiBuZXdJbmRleFxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVuZGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcblx0ICAgICAgICAgICAgdmFyIGtleSA9IE9iamVjdC5rZXlzKHRoaXMucHJvcHMuaXRlbXMpW3RoaXMuc3RhdGUuY3VycmVudEl0ZW1JbmRleF07XG5cdFxuXHQgICAgICAgICAgICBpZiAoIWtleSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHZhciBpdGVtID0gdGhpcy5wcm9wcy5pdGVtc1trZXldO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgJ2RpdicsXG5cdCAgICAgICAgICAgICAgICBudWxsLFxuXHQgICAgICAgICAgICAgICAgX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX3NsaWRlMlsnZGVmYXVsdCddLCB7IGtleToga2V5LCBpdGVtOiBpdGVtIH0pXG5cdCAgICAgICAgICAgICk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0sIFt7XG5cdCAgICAgICAga2V5OiAncHJvcFR5cGVzJyxcblx0ICAgICAgICB2YWx1ZToge1xuXHQgICAgICAgICAgICBpdGVtczogX3JlYWN0LlByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcblx0ICAgICAgICAgICAgZGVsYXk6IF9yZWFjdC5Qcm9wVHlwZXMubnVtYmVyXG5cdCAgICAgICAgfSxcblx0ICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnZGVmYXVsdFByb3BzJyxcblx0ICAgICAgICB2YWx1ZToge1xuXHQgICAgICAgICAgICBkZWxheTogM1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBTbGlkZXNob3c7XG5cdH0pKF9yZWFjdC5Db21wb25lbnQpO1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gU2xpZGVzaG93O1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDEyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmICgndmFsdWUnIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cdFxuXHR2YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXHRcblx0dmFyIF9jbGltYlNvY2lhbCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdFxuXHR2YXIgX2NsaW1iU29jaWFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsaW1iU29jaWFsKTtcblx0XG5cdHZhciBfU2xpZGVzaG93ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7XG5cdFxuXHR2YXIgX1NsaWRlc2hvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TbGlkZXNob3cpO1xuXHRcblx0dmFyIFNsaWRlc2hvd0NvbnRhaW5lciA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKFNsaWRlc2hvd0NvbnRhaW5lciwgX0NvbXBvbmVudCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gU2xpZGVzaG93Q29udGFpbmVyKHByb3BzKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNsaWRlc2hvd0NvbnRhaW5lcik7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFNsaWRlc2hvd0NvbnRhaW5lci5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5jYWxsKHRoaXMsIHByb3BzKTtcblx0ICAgICAgICB0aGlzLnN0YXRlID0ge1xuXHQgICAgICAgICAgICBpdGVtczoge31cblx0ICAgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhTbGlkZXNob3dDb250YWluZXIsIFt7XG5cdCAgICAgICAga2V5OiAnaW5pdCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICBpZiAoIXRoaXMucHJvcHMuY29sbGVjdGlvbklkKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIF9jbGltYlNvY2lhbDJbJ2RlZmF1bHQnXS5nZXRTdHJlYW0odGhpcy5wcm9wcy5jb2xsZWN0aW9uSWQpLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbXMpIHtcblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgbWFwcGVkSXRlbXMgPSB7fTtcblx0ICAgICAgICAgICAgICAgIGl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuXHQgICAgICAgICAgICAgICAgICAgIG1hcHBlZEl0ZW1zW2l0ZW0uaWRdID0gaXRlbTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcblx0ICAgICAgICAgICAgICAgICAgICBpdGVtczogbWFwcGVkSXRlbXNcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY29tcG9uZW50RGlkTW91bnQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcblx0ICAgICAgICAgICAgdGhpcy5pbml0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbmRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9TbGlkZXNob3cyWydkZWZhdWx0J10sIHsgaXRlbXM6IHRoaXMuc3RhdGUuaXRlbXMgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0sIFt7XG5cdCAgICAgICAga2V5OiAncHJvcFR5cGVzJyxcblx0ICAgICAgICB2YWx1ZToge1xuXHQgICAgICAgICAgICBjb2xsZWN0aW9uSWQ6IF9yZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVudW1lcmFibGU6IHRydWVcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdkZWZhdWx0UHJvcHMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogJzU2MWJhNjM0NDUyODRlMTc0MGUwMTZmNydcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVudW1lcmFibGU6IHRydWVcblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gU2xpZGVzaG93Q29udGFpbmVyO1xuXHR9KShfcmVhY3QuQ29tcG9uZW50KTtcblx0XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IFNsaWRlc2hvd0NvbnRhaW5lcjtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAxMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoJ3ZhbHVlJyBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfSB9O1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBfY29tbW9uTWVzc2FnZSA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdFxuXHR2YXIgX2NvbW1vbk1lc3NhZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tbW9uTWVzc2FnZSk7XG5cdFxuXHR2YXIgX2NvbW1vbkltYWdlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdHZhciBfY29tbW9uSW1hZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tbW9uSW1hZ2UpO1xuXHRcblx0dmFyIFNsaWRlID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7XG5cdCAgICBfaW5oZXJpdHMoU2xpZGUsIF9Db21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFNsaWRlKHByb3BzKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNsaWRlKTtcblx0XG5cdCAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoU2xpZGUucHJvdG90eXBlKSwgJ2NvbnN0cnVjdG9yJywgdGhpcykuY2FsbCh0aGlzLCBwcm9wcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFNsaWRlLCBbe1xuXHQgICAgICAgIGtleTogJ2NyZWF0ZUltYWdlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlSW1hZ2UoKSB7XG5cdCAgICAgICAgICAgIHZhciBpbWFnZSA9IHRoaXMucHJvcHMuaXRlbS5pbWFnZTtcblx0XG5cdCAgICAgICAgICAgIGlmIChpbWFnZSAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIHNyYyA9IGltYWdlLnVybDtcblx0ICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGltYWdlLndpZHRoO1xuXHQgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmhlaWdodDtcblx0XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX2NvbW1vbkltYWdlMlsnZGVmYXVsdCddLCB7IHNyYzogc3JjLFxuXHQgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcblx0ICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCB9KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVuZGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMucHJvcHMuaXRlbTtcblx0XG5cdCAgICAgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuY3JlYXRlSW1hZ2UoKTtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChcblx0ICAgICAgICAgICAgICAgICdkaXYnLFxuXHQgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdjbGltYi1zbGlkZXNob3dfX3NsaWRlJyB9LFxuXHQgICAgICAgICAgICAgICAgaW1hZ2UsXG5cdCAgICAgICAgICAgICAgICBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfY29tbW9uTWVzc2FnZTJbJ2RlZmF1bHQnXSwgeyBib2R5OiBpdGVtLm1lc3NhZ2UgfSlcblx0ICAgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdCAgICB9XSwgW3tcblx0ICAgICAgICBrZXk6ICdwcm9wVHlwZXMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIGl0ZW06IF9yZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWRcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVudW1lcmFibGU6IHRydWVcblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gU2xpZGU7XG5cdH0pKF9yZWFjdC5Db21wb25lbnQpO1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gU2xpZGU7XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogMTQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgQ2xpbWJCYWRnZSA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKENsaW1iQmFkZ2UsIF9Db21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIENsaW1iQmFkZ2UoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENsaW1iQmFkZ2UpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihDbGltYkJhZGdlLnByb3RvdHlwZSksICdjb25zdHJ1Y3RvcicsIHRoaXMpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKENsaW1iQmFkZ2UsIFt7XG5cdCAgICAgICAga2V5OiAncmVuZGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcblx0ICAgICAgICAgICAgdmFyIGxvZ28gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM2KTtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudCgnYScsIHsgaHJlZjogJ2h0dHA6Ly9jbGltYi5zb2NpYWwvJyxcblx0ICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2NsaW1iLXNvY2lhbC1iYWRnZScsXG5cdCAgICAgICAgICAgICAgICBkYW5nZXJvdXNseVNldElubmVySFRNTDogeyBfX2h0bWw6IGxvZ28gfSB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIENsaW1iQmFkZ2U7XG5cdH0pKF9yZWFjdC5Db21wb25lbnQpO1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gQ2xpbWJCYWRnZTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAxNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoJ3ZhbHVlJyBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfSB9O1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBfY2xpbWJTb2NpYWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpO1xuXHRcblx0dmFyIF9jbGltYlNvY2lhbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jbGltYlNvY2lhbCk7XG5cdFxuXHR2YXIgX1dhbGwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xuXHRcblx0dmFyIF9XYWxsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1dhbGwpO1xuXHRcblx0dmFyIF9DbGltYkJhZGdlID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNCk7XG5cdFxuXHR2YXIgX0NsaW1iQmFkZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQ2xpbWJCYWRnZSk7XG5cdFxuXHR2YXIgV2FsbENvbnRhaW5lciA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKFdhbGxDb250YWluZXIsIF9Db21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFdhbGxDb250YWluZXIocHJvcHMpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV2FsbENvbnRhaW5lcik7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFdhbGxDb250YWluZXIucHJvdG90eXBlKSwgJ2NvbnN0cnVjdG9yJywgdGhpcykuY2FsbCh0aGlzLCBwcm9wcyk7XG5cdCAgICAgICAgdGhpcy5zdGF0ZSA9IHtcblx0ICAgICAgICAgICAgaXRlbXM6IHt9XG5cdCAgICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoV2FsbENvbnRhaW5lciwgW3tcblx0ICAgICAgICBrZXk6ICdpbml0Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIGlmICghdGhpcy5wcm9wcy5jb2xsZWN0aW9uSWQpIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgX2NsaW1iU29jaWFsMlsnZGVmYXVsdCddLmdldFN0cmVhbSh0aGlzLnByb3BzLmNvbGxlY3Rpb25JZCkuc3Vic2NyaWJlKGZ1bmN0aW9uIChpdGVtcykge1xuXHRcblx0ICAgICAgICAgICAgICAgIHZhciBtYXhTaXplID0gcGFyc2VJbnQoX3RoaXMucHJvcHMubGltaXQsIDApO1xuXHRcblx0ICAgICAgICAgICAgICAgIHZhciBtYXBwZWRJdGVtcyA9IHt9O1xuXHQgICAgICAgICAgICAgICAgaXRlbXMuc3BsaWNlKDAsIG1heFNpemUpLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuXHQgICAgICAgICAgICAgICAgICAgIG1hcHBlZEl0ZW1zW2l0ZW0uaWRdID0gaXRlbTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcblx0ICAgICAgICAgICAgICAgICAgICBpdGVtczogbWFwcGVkSXRlbXNcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY29tcG9uZW50RGlkTW91bnQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcblx0ICAgICAgICAgICAgdGhpcy5pbml0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2NvbXBvbmVudERpZFVwZGF0ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZFVwZGF0ZSgpIHtcblx0ICAgICAgICAgICAgdmFyIGNiID0gdW5kZWZpbmVkO1xuXHQgICAgICAgICAgICBpZiAod2luZG93LkNsaW1iICYmIHdpbmRvdy5DbGltYi5vblVwZGF0ZSkge1xuXHQgICAgICAgICAgICAgICAgY2IgPSB3aW5kb3cuQ2xpbWIub25VcGRhdGU7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAvLyBub29wXG5cdCAgICAgICAgICAgICAgICBjYiA9IGZ1bmN0aW9uICgpIHt9O1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIGNiKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbmRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgJ2RpdicsXG5cdCAgICAgICAgICAgICAgICBudWxsLFxuXHQgICAgICAgICAgICAgICAgX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX1dhbGwyWydkZWZhdWx0J10sIHsgaXRlbXM6IHRoaXMuc3RhdGUuaXRlbXMgfSksXG5cdCAgICAgICAgICAgICAgICBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfQ2xpbWJCYWRnZTJbJ2RlZmF1bHQnXSwgbnVsbClcblx0ICAgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdCAgICB9XSwgW3tcblx0ICAgICAgICBrZXk6ICdwcm9wVHlwZXMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogX3JlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgICAgICAgICAgbGltaXQ6IF9yZWFjdC5Qcm9wVHlwZXMub25lT2ZUeXBlKFtfcmVhY3QuUHJvcFR5cGVzLm51bWJlciwgX3JlYWN0LlByb3BUeXBlcy5zdHJpbmddKVxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2RlZmF1bHRQcm9wcycsXG5cdCAgICAgICAgdmFsdWU6IHtcblx0ICAgICAgICAgICAgY29sbGVjdGlvbklkOiAnNTYxYmE2MzQ0NTI4NGUxNzQwZTAxNmY3Jyxcblx0ICAgICAgICAgICAgbGltaXQ6IDMwXG5cdCAgICAgICAgfSxcblx0ICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIFdhbGxDb250YWluZXI7XG5cdH0pKF9yZWFjdC5Db21wb25lbnQpO1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gV2FsbENvbnRhaW5lcjtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAxNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOy8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihtb2R1bGUsIGdsb2JhbCwgcHJvY2Vzcykgey8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0LCBBbGwgcmlnaHRzIHJlc2VydmVkLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cblx0XG5cdDsoZnVuY3Rpb24gKHVuZGVmaW5lZCkge1xuXHRcblx0ICB2YXIgb2JqZWN0VHlwZXMgPSB7XG5cdCAgICAnZnVuY3Rpb24nOiB0cnVlLFxuXHQgICAgJ29iamVjdCc6IHRydWVcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBjaGVja0dsb2JhbCh2YWx1ZSkge1xuXHQgICAgcmV0dXJuICh2YWx1ZSAmJiB2YWx1ZS5PYmplY3QgPT09IE9iamVjdCkgPyB2YWx1ZSA6IG51bGw7XG5cdCAgfVxuXHRcblx0ICB2YXIgZnJlZUV4cG9ydHMgPSAob2JqZWN0VHlwZXNbdHlwZW9mIGV4cG9ydHNdICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUpID8gZXhwb3J0cyA6IG51bGw7XG5cdCAgdmFyIGZyZWVNb2R1bGUgPSAob2JqZWN0VHlwZXNbdHlwZW9mIG1vZHVsZV0gJiYgbW9kdWxlICYmICFtb2R1bGUubm9kZVR5cGUpID8gbW9kdWxlIDogbnVsbDtcblx0ICB2YXIgZnJlZUdsb2JhbCA9IGNoZWNrR2xvYmFsKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUgJiYgdHlwZW9mIGdsb2JhbCA9PT0gJ29iamVjdCcgJiYgZ2xvYmFsKTtcblx0ICB2YXIgZnJlZVNlbGYgPSBjaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2Ygc2VsZl0gJiYgc2VsZik7XG5cdCAgdmFyIGZyZWVXaW5kb3cgPSBjaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2Ygd2luZG93XSAmJiB3aW5kb3cpO1xuXHQgIHZhciBtb2R1bGVFeHBvcnRzID0gKGZyZWVNb2R1bGUgJiYgZnJlZU1vZHVsZS5leHBvcnRzID09PSBmcmVlRXhwb3J0cykgPyBmcmVlRXhwb3J0cyA6IG51bGw7XG5cdCAgdmFyIHRoaXNHbG9iYWwgPSBjaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2YgdGhpc10gJiYgdGhpcyk7XG5cdCAgdmFyIHJvb3QgPSBmcmVlR2xvYmFsIHx8ICgoZnJlZVdpbmRvdyAhPT0gKHRoaXNHbG9iYWwgJiYgdGhpc0dsb2JhbC53aW5kb3cpKSAmJiBmcmVlV2luZG93KSB8fCBmcmVlU2VsZiB8fCB0aGlzR2xvYmFsIHx8IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdFxuXHQgIHZhciBSeCA9IHtcblx0ICAgIGludGVybmFsczoge30sXG5cdCAgICBjb25maWc6IHtcblx0ICAgICAgUHJvbWlzZTogcm9vdC5Qcm9taXNlXG5cdCAgICB9LFxuXHQgICAgaGVscGVyczogeyB9XG5cdCAgfTtcblx0XG5cdCAgLy8gRGVmYXVsdHNcblx0ICB2YXIgbm9vcCA9IFJ4LmhlbHBlcnMubm9vcCA9IGZ1bmN0aW9uICgpIHsgfSxcblx0ICAgIGlkZW50aXR5ID0gUnguaGVscGVycy5pZGVudGl0eSA9IGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9LFxuXHQgICAgZGVmYXVsdE5vdyA9IFJ4LmhlbHBlcnMuZGVmYXVsdE5vdyA9IERhdGUubm93LFxuXHQgICAgZGVmYXVsdENvbXBhcmVyID0gUnguaGVscGVycy5kZWZhdWx0Q29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gaXNFcXVhbCh4LCB5KTsgfSxcblx0ICAgIGRlZmF1bHRTdWJDb21wYXJlciA9IFJ4LmhlbHBlcnMuZGVmYXVsdFN1YkNvbXBhcmVyID0gZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggPiB5ID8gMSA6ICh4IDwgeSA/IC0xIDogMCk7IH0sXG5cdCAgICBkZWZhdWx0S2V5U2VyaWFsaXplciA9IFJ4LmhlbHBlcnMuZGVmYXVsdEtleVNlcmlhbGl6ZXIgPSBmdW5jdGlvbiAoeCkgeyByZXR1cm4geC50b1N0cmluZygpOyB9LFxuXHQgICAgZGVmYXVsdEVycm9yID0gUnguaGVscGVycy5kZWZhdWx0RXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7IHRocm93IGVycjsgfSxcblx0ICAgIGlzUHJvbWlzZSA9IFJ4LmhlbHBlcnMuaXNQcm9taXNlID0gZnVuY3Rpb24gKHApIHsgcmV0dXJuICEhcCAmJiB0eXBlb2YgcC5zdWJzY3JpYmUgIT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIHAudGhlbiA9PT0gJ2Z1bmN0aW9uJzsgfSxcblx0ICAgIGlzRnVuY3Rpb24gPSBSeC5oZWxwZXJzLmlzRnVuY3Rpb24gPSAoZnVuY3Rpb24gKCkge1xuXHRcblx0ICAgICAgdmFyIGlzRm4gPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdmdW5jdGlvbicgfHwgZmFsc2U7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIGZhbGxiYWNrIGZvciBvbGRlciB2ZXJzaW9ucyBvZiBDaHJvbWUgYW5kIFNhZmFyaVxuXHQgICAgICBpZiAoaXNGbigveC8pKSB7XG5cdCAgICAgICAgaXNGbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICAgICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdmdW5jdGlvbicgJiYgdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcblx0ICAgICAgICB9O1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gaXNGbjtcblx0ICAgIH0oKSk7XG5cdFxuXHQgICAgZnVuY3Rpb24gY2xvbmVBcnJheShhcnIpIHtcblx0ICAgICAgdmFyIGxlbiA9IGFyci5sZW5ndGgsIGEgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFbaV0gPSBhcnJbaV07IH1cblx0ICAgICAgcmV0dXJuIGE7XG5cdCAgICB9XG5cdFxuXHQgIHZhciBlcnJvck9iaiA9IHtlOiB7fX07XG5cdCAgXG5cdCAgZnVuY3Rpb24gdHJ5Q2F0Y2hlckdlbih0cnlDYXRjaFRhcmdldCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIHRyeUNhdGNoZXIoKSB7XG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgcmV0dXJuIHRyeUNhdGNoVGFyZ2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICBlcnJvck9iai5lID0gZTtcblx0ICAgICAgICByZXR1cm4gZXJyb3JPYmo7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgfVxuXHRcblx0ICB2YXIgdHJ5Q2F0Y2ggPSBSeC5pbnRlcm5hbHMudHJ5Q2F0Y2ggPSBmdW5jdGlvbiB0cnlDYXRjaChmbikge1xuXHQgICAgaWYgKCFpc0Z1bmN0aW9uKGZuKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdmbiBtdXN0IGJlIGEgZnVuY3Rpb24nKTsgfVxuXHQgICAgcmV0dXJuIHRyeUNhdGNoZXJHZW4oZm4pO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIHRocm93ZXIoZSkge1xuXHQgICAgdGhyb3cgZTtcblx0ICB9XG5cdFxuXHQgIFJ4LmNvbmZpZy5sb25nU3RhY2tTdXBwb3J0ID0gZmFsc2U7XG5cdCAgdmFyIGhhc1N0YWNrcyA9IGZhbHNlLCBzdGFja3MgPSB0cnlDYXRjaChmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcigpOyB9KSgpO1xuXHQgIGhhc1N0YWNrcyA9ICEhc3RhY2tzLmUgJiYgISFzdGFja3MuZS5zdGFjaztcblx0XG5cdCAgLy8gQWxsIGNvZGUgYWZ0ZXIgdGhpcyBwb2ludCB3aWxsIGJlIGZpbHRlcmVkIGZyb20gc3RhY2sgdHJhY2VzIHJlcG9ydGVkIGJ5IFJ4SlNcblx0ICB2YXIgclN0YXJ0aW5nTGluZSA9IGNhcHR1cmVMaW5lKCksIHJGaWxlTmFtZTtcblx0XG5cdCAgdmFyIFNUQUNLX0pVTVBfU0VQQVJBVE9SID0gJ0Zyb20gcHJldmlvdXMgZXZlbnQ6Jztcblx0XG5cdCAgZnVuY3Rpb24gbWFrZVN0YWNrVHJhY2VMb25nKGVycm9yLCBvYnNlcnZhYmxlKSB7XG5cdCAgICAvLyBJZiBwb3NzaWJsZSwgdHJhbnNmb3JtIHRoZSBlcnJvciBzdGFjayB0cmFjZSBieSByZW1vdmluZyBOb2RlIGFuZCBSeEpTXG5cdCAgICAvLyBjcnVmdCwgdGhlbiBjb25jYXRlbmF0aW5nIHdpdGggdGhlIHN0YWNrIHRyYWNlIG9mIGBvYnNlcnZhYmxlYC5cblx0ICAgIGlmIChoYXNTdGFja3MgJiZcblx0ICAgICAgICBvYnNlcnZhYmxlLnN0YWNrICYmXG5cdCAgICAgICAgdHlwZW9mIGVycm9yID09PSAnb2JqZWN0JyAmJlxuXHQgICAgICAgIGVycm9yICE9PSBudWxsICYmXG5cdCAgICAgICAgZXJyb3Iuc3RhY2sgJiZcblx0ICAgICAgICBlcnJvci5zdGFjay5pbmRleE9mKFNUQUNLX0pVTVBfU0VQQVJBVE9SKSA9PT0gLTFcblx0ICAgICkge1xuXHQgICAgICB2YXIgc3RhY2tzID0gW107XG5cdCAgICAgIGZvciAodmFyIG8gPSBvYnNlcnZhYmxlOyAhIW87IG8gPSBvLnNvdXJjZSkge1xuXHQgICAgICAgIGlmIChvLnN0YWNrKSB7XG5cdCAgICAgICAgICBzdGFja3MudW5zaGlmdChvLnN0YWNrKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgc3RhY2tzLnVuc2hpZnQoZXJyb3Iuc3RhY2spO1xuXHRcblx0ICAgICAgdmFyIGNvbmNhdGVkU3RhY2tzID0gc3RhY2tzLmpvaW4oJ1xcbicgKyBTVEFDS19KVU1QX1NFUEFSQVRPUiArICdcXG4nKTtcblx0ICAgICAgZXJyb3Iuc3RhY2sgPSBmaWx0ZXJTdGFja1N0cmluZyhjb25jYXRlZFN0YWNrcyk7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBmaWx0ZXJTdGFja1N0cmluZyhzdGFja1N0cmluZykge1xuXHQgICAgdmFyIGxpbmVzID0gc3RhY2tTdHJpbmcuc3BsaXQoJ1xcbicpLCBkZXNpcmVkTGluZXMgPSBbXTtcblx0ICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBsaW5lcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICB2YXIgbGluZSA9IGxpbmVzW2ldO1xuXHRcblx0ICAgICAgaWYgKCFpc0ludGVybmFsRnJhbWUobGluZSkgJiYgIWlzTm9kZUZyYW1lKGxpbmUpICYmIGxpbmUpIHtcblx0ICAgICAgICBkZXNpcmVkTGluZXMucHVzaChsaW5lKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIGRlc2lyZWRMaW5lcy5qb2luKCdcXG4nKTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGlzSW50ZXJuYWxGcmFtZShzdGFja0xpbmUpIHtcblx0ICAgIHZhciBmaWxlTmFtZUFuZExpbmVOdW1iZXIgPSBnZXRGaWxlTmFtZUFuZExpbmVOdW1iZXIoc3RhY2tMaW5lKTtcblx0ICAgIGlmICghZmlsZU5hbWVBbmRMaW5lTnVtYmVyKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0ICAgIHZhciBmaWxlTmFtZSA9IGZpbGVOYW1lQW5kTGluZU51bWJlclswXSwgbGluZU51bWJlciA9IGZpbGVOYW1lQW5kTGluZU51bWJlclsxXTtcblx0XG5cdCAgICByZXR1cm4gZmlsZU5hbWUgPT09IHJGaWxlTmFtZSAmJlxuXHQgICAgICBsaW5lTnVtYmVyID49IHJTdGFydGluZ0xpbmUgJiZcblx0ICAgICAgbGluZU51bWJlciA8PSByRW5kaW5nTGluZTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGlzTm9kZUZyYW1lKHN0YWNrTGluZSkge1xuXHQgICAgcmV0dXJuIHN0YWNrTGluZS5pbmRleE9mKCcobW9kdWxlLmpzOicpICE9PSAtMSB8fFxuXHQgICAgICBzdGFja0xpbmUuaW5kZXhPZignKG5vZGUuanM6JykgIT09IC0xO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gY2FwdHVyZUxpbmUoKSB7XG5cdCAgICBpZiAoIWhhc1N0YWNrcykgeyByZXR1cm47IH1cblx0XG5cdCAgICB0cnkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcblx0ICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgdmFyIGxpbmVzID0gZS5zdGFjay5zcGxpdCgnXFxuJyk7XG5cdCAgICAgIHZhciBmaXJzdExpbmUgPSBsaW5lc1swXS5pbmRleE9mKCdAJykgPiAwID8gbGluZXNbMV0gOiBsaW5lc1syXTtcblx0ICAgICAgdmFyIGZpbGVOYW1lQW5kTGluZU51bWJlciA9IGdldEZpbGVOYW1lQW5kTGluZU51bWJlcihmaXJzdExpbmUpO1xuXHQgICAgICBpZiAoIWZpbGVOYW1lQW5kTGluZU51bWJlcikgeyByZXR1cm47IH1cblx0XG5cdCAgICAgIHJGaWxlTmFtZSA9IGZpbGVOYW1lQW5kTGluZU51bWJlclswXTtcblx0ICAgICAgcmV0dXJuIGZpbGVOYW1lQW5kTGluZU51bWJlclsxXTtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGdldEZpbGVOYW1lQW5kTGluZU51bWJlcihzdGFja0xpbmUpIHtcblx0ICAgIC8vIE5hbWVkIGZ1bmN0aW9uczogJ2F0IGZ1bmN0aW9uTmFtZSAoZmlsZW5hbWU6bGluZU51bWJlcjpjb2x1bW5OdW1iZXIpJ1xuXHQgICAgdmFyIGF0dGVtcHQxID0gL2F0IC4rIFxcKCguKyk6KFxcZCspOig/OlxcZCspXFwpJC8uZXhlYyhzdGFja0xpbmUpO1xuXHQgICAgaWYgKGF0dGVtcHQxKSB7IHJldHVybiBbYXR0ZW1wdDFbMV0sIE51bWJlcihhdHRlbXB0MVsyXSldOyB9XG5cdFxuXHQgICAgLy8gQW5vbnltb3VzIGZ1bmN0aW9uczogJ2F0IGZpbGVuYW1lOmxpbmVOdW1iZXI6Y29sdW1uTnVtYmVyJ1xuXHQgICAgdmFyIGF0dGVtcHQyID0gL2F0IChbXiBdKyk6KFxcZCspOig/OlxcZCspJC8uZXhlYyhzdGFja0xpbmUpO1xuXHQgICAgaWYgKGF0dGVtcHQyKSB7IHJldHVybiBbYXR0ZW1wdDJbMV0sIE51bWJlcihhdHRlbXB0MlsyXSldOyB9XG5cdFxuXHQgICAgLy8gRmlyZWZveCBzdHlsZTogJ2Z1bmN0aW9uQGZpbGVuYW1lOmxpbmVOdW1iZXIgb3IgQGZpbGVuYW1lOmxpbmVOdW1iZXInXG5cdCAgICB2YXIgYXR0ZW1wdDMgPSAvLipAKC4rKTooXFxkKykkLy5leGVjKHN0YWNrTGluZSk7XG5cdCAgICBpZiAoYXR0ZW1wdDMpIHsgcmV0dXJuIFthdHRlbXB0M1sxXSwgTnVtYmVyKGF0dGVtcHQzWzJdKV07IH1cblx0ICB9XG5cdFxuXHQgIHZhciBFbXB0eUVycm9yID0gUnguRW1wdHlFcnJvciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgdGhpcy5tZXNzYWdlID0gJ1NlcXVlbmNlIGNvbnRhaW5zIG5vIGVsZW1lbnRzLic7XG5cdCAgICBFcnJvci5jYWxsKHRoaXMpO1xuXHQgIH07XG5cdCAgRW1wdHlFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cdCAgRW1wdHlFcnJvci5wcm90b3R5cGUubmFtZSA9ICdFbXB0eUVycm9yJztcblx0XG5cdCAgdmFyIE9iamVjdERpc3Bvc2VkRXJyb3IgPSBSeC5PYmplY3REaXNwb3NlZEVycm9yID0gZnVuY3Rpb24oKSB7XG5cdCAgICB0aGlzLm1lc3NhZ2UgPSAnT2JqZWN0IGhhcyBiZWVuIGRpc3Bvc2VkJztcblx0ICAgIEVycm9yLmNhbGwodGhpcyk7XG5cdCAgfTtcblx0ICBPYmplY3REaXNwb3NlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblx0ICBPYmplY3REaXNwb3NlZEVycm9yLnByb3RvdHlwZS5uYW1lID0gJ09iamVjdERpc3Bvc2VkRXJyb3InO1xuXHRcblx0ICB2YXIgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IgPSBSeC5Bcmd1bWVudE91dE9mUmFuZ2VFcnJvciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHRoaXMubWVzc2FnZSA9ICdBcmd1bWVudCBvdXQgb2YgcmFuZ2UnO1xuXHQgICAgRXJyb3IuY2FsbCh0aGlzKTtcblx0ICB9O1xuXHQgIEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblx0ICBBcmd1bWVudE91dE9mUmFuZ2VFcnJvci5wcm90b3R5cGUubmFtZSA9ICdBcmd1bWVudE91dE9mUmFuZ2VFcnJvcic7XG5cdFxuXHQgIHZhciBOb3RTdXBwb3J0ZWRFcnJvciA9IFJ4Lk5vdFN1cHBvcnRlZEVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcblx0ICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgJ1RoaXMgb3BlcmF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQnO1xuXHQgICAgRXJyb3IuY2FsbCh0aGlzKTtcblx0ICB9O1xuXHQgIE5vdFN1cHBvcnRlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblx0ICBOb3RTdXBwb3J0ZWRFcnJvci5wcm90b3R5cGUubmFtZSA9ICdOb3RTdXBwb3J0ZWRFcnJvcic7XG5cdFxuXHQgIHZhciBOb3RJbXBsZW1lbnRlZEVycm9yID0gUnguTm90SW1wbGVtZW50ZWRFcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG5cdCAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlIHx8ICdUaGlzIG9wZXJhdGlvbiBpcyBub3QgaW1wbGVtZW50ZWQnO1xuXHQgICAgRXJyb3IuY2FsbCh0aGlzKTtcblx0ICB9O1xuXHQgIE5vdEltcGxlbWVudGVkRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuXHQgIE5vdEltcGxlbWVudGVkRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnTm90SW1wbGVtZW50ZWRFcnJvcic7XG5cdFxuXHQgIHZhciBub3RJbXBsZW1lbnRlZCA9IFJ4LmhlbHBlcnMubm90SW1wbGVtZW50ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBub3RTdXBwb3J0ZWQgPSBSeC5oZWxwZXJzLm5vdFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcigpO1xuXHQgIH07XG5cdFxuXHQgIC8vIFNoaW0gaW4gaXRlcmF0b3Igc3VwcG9ydFxuXHQgIHZhciAkaXRlcmF0b3IkID0gKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgU3ltYm9sLml0ZXJhdG9yKSB8fFxuXHQgICAgJ19lczZzaGltX2l0ZXJhdG9yXyc7XG5cdCAgLy8gQnVnIGZvciBtb3ppbGxhIHZlcnNpb25cblx0ICBpZiAocm9vdC5TZXQgJiYgdHlwZW9mIG5ldyByb290LlNldCgpWydAQGl0ZXJhdG9yJ10gPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICRpdGVyYXRvciQgPSAnQEBpdGVyYXRvcic7XG5cdCAgfVxuXHRcblx0ICB2YXIgZG9uZUVudW1lcmF0b3IgPSBSeC5kb25lRW51bWVyYXRvciA9IHsgZG9uZTogdHJ1ZSwgdmFsdWU6IHVuZGVmaW5lZCB9O1xuXHRcblx0ICB2YXIgaXNJdGVyYWJsZSA9IFJ4LmhlbHBlcnMuaXNJdGVyYWJsZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICByZXR1cm4gbyAmJiBvWyRpdGVyYXRvciRdICE9PSB1bmRlZmluZWQ7XG5cdCAgfTtcblx0XG5cdCAgdmFyIGlzQXJyYXlMaWtlID0gUnguaGVscGVycy5pc0FycmF5TGlrZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICByZXR1cm4gbyAmJiBvLmxlbmd0aCAhPT0gdW5kZWZpbmVkO1xuXHQgIH07XG5cdFxuXHQgIFJ4LmhlbHBlcnMuaXRlcmF0b3IgPSAkaXRlcmF0b3IkO1xuXHRcblx0ICB2YXIgYmluZENhbGxiYWNrID0gUnguaW50ZXJuYWxzLmJpbmRDYWxsYmFjayA9IGZ1bmN0aW9uIChmdW5jLCB0aGlzQXJnLCBhcmdDb3VudCkge1xuXHQgICAgaWYgKHR5cGVvZiB0aGlzQXJnID09PSAndW5kZWZpbmVkJykgeyByZXR1cm4gZnVuYzsgfVxuXHQgICAgc3dpdGNoKGFyZ0NvdW50KSB7XG5cdCAgICAgIGNhc2UgMDpcblx0ICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcpXG5cdCAgICAgICAgfTtcblx0ICAgICAgY2FzZSAxOlxuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbihhcmcpIHtcblx0ICAgICAgICAgIHJldHVybiBmdW5jLmNhbGwodGhpc0FyZywgYXJnKTtcblx0ICAgICAgICB9XG5cdCAgICAgIGNhc2UgMjpcblx0ICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7XG5cdCAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgY2FzZSAzOlxuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcblx0ICAgICAgICAgIHJldHVybiBmdW5jLmNhbGwodGhpc0FyZywgdmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKTtcblx0ICAgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpc0FyZywgYXJndW1lbnRzKTtcblx0ICAgIH07XG5cdCAgfTtcblx0XG5cdCAgLyoqIFVzZWQgdG8gZGV0ZXJtaW5lIGlmIHZhbHVlcyBhcmUgb2YgdGhlIGxhbmd1YWdlIHR5cGUgT2JqZWN0ICovXG5cdCAgdmFyIGRvbnRFbnVtcyA9IFsndG9TdHJpbmcnLFxuXHQgICAgJ3RvTG9jYWxlU3RyaW5nJyxcblx0ICAgICd2YWx1ZU9mJyxcblx0ICAgICdoYXNPd25Qcm9wZXJ0eScsXG5cdCAgICAnaXNQcm90b3R5cGVPZicsXG5cdCAgICAncHJvcGVydHlJc0VudW1lcmFibGUnLFxuXHQgICAgJ2NvbnN0cnVjdG9yJ10sXG5cdCAgZG9udEVudW1zTGVuZ3RoID0gZG9udEVudW1zLmxlbmd0aDtcblx0XG5cdCAgLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCBzaG9ydGN1dHMgKi9cblx0ICB2YXIgYXJnc0NsYXNzID0gJ1tvYmplY3QgQXJndW1lbnRzXScsXG5cdCAgICBhcnJheUNsYXNzID0gJ1tvYmplY3QgQXJyYXldJyxcblx0ICAgIGJvb2xDbGFzcyA9ICdbb2JqZWN0IEJvb2xlYW5dJyxcblx0ICAgIGRhdGVDbGFzcyA9ICdbb2JqZWN0IERhdGVdJyxcblx0ICAgIGVycm9yQ2xhc3MgPSAnW29iamVjdCBFcnJvcl0nLFxuXHQgICAgZnVuY0NsYXNzID0gJ1tvYmplY3QgRnVuY3Rpb25dJyxcblx0ICAgIG51bWJlckNsYXNzID0gJ1tvYmplY3QgTnVtYmVyXScsXG5cdCAgICBvYmplY3RDbGFzcyA9ICdbb2JqZWN0IE9iamVjdF0nLFxuXHQgICAgcmVnZXhwQ2xhc3MgPSAnW29iamVjdCBSZWdFeHBdJyxcblx0ICAgIHN0cmluZ0NsYXNzID0gJ1tvYmplY3QgU3RyaW5nXSc7XG5cdFxuXHQgIHZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsXG5cdCAgICBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksXG5cdCAgICBzdXBwb3J0c0FyZ3NDbGFzcyA9IHRvU3RyaW5nLmNhbGwoYXJndW1lbnRzKSA9PSBhcmdzQ2xhc3MsIC8vIEZvciBsZXNzIDxJRTkgJiYgRkY8NFxuXHQgICAgc3VwcG9ydE5vZGVDbGFzcyxcblx0ICAgIGVycm9yUHJvdG8gPSBFcnJvci5wcm90b3R5cGUsXG5cdCAgICBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGUsXG5cdCAgICBzdHJpbmdQcm90byA9IFN0cmluZy5wcm90b3R5cGUsXG5cdCAgICBwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IG9iamVjdFByb3RvLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xuXHRcblx0ICB0cnkge1xuXHQgICAgc3VwcG9ydE5vZGVDbGFzcyA9ICEodG9TdHJpbmcuY2FsbChkb2N1bWVudCkgPT0gb2JqZWN0Q2xhc3MgJiYgISh7ICd0b1N0cmluZyc6IDAgfSArICcnKSk7XG5cdCAgfSBjYXRjaCAoZSkge1xuXHQgICAgc3VwcG9ydE5vZGVDbGFzcyA9IHRydWU7XG5cdCAgfVxuXHRcblx0ICB2YXIgbm9uRW51bVByb3BzID0ge307XG5cdCAgbm9uRW51bVByb3BzW2FycmF5Q2xhc3NdID0gbm9uRW51bVByb3BzW2RhdGVDbGFzc10gPSBub25FbnVtUHJvcHNbbnVtYmVyQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9Mb2NhbGVTdHJpbmcnOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlLCAndmFsdWVPZic6IHRydWUgfTtcblx0ICBub25FbnVtUHJvcHNbYm9vbENsYXNzXSA9IG5vbkVudW1Qcm9wc1tzdHJpbmdDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUsICd0b1N0cmluZyc6IHRydWUsICd2YWx1ZU9mJzogdHJ1ZSB9O1xuXHQgIG5vbkVudW1Qcm9wc1tlcnJvckNsYXNzXSA9IG5vbkVudW1Qcm9wc1tmdW5jQ2xhc3NdID0gbm9uRW51bVByb3BzW3JlZ2V4cENsYXNzXSA9IHsgJ2NvbnN0cnVjdG9yJzogdHJ1ZSwgJ3RvU3RyaW5nJzogdHJ1ZSB9O1xuXHQgIG5vbkVudW1Qcm9wc1tvYmplY3RDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUgfTtcblx0XG5cdCAgdmFyIHN1cHBvcnQgPSB7fTtcblx0ICAoZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGN0b3IgPSBmdW5jdGlvbigpIHsgdGhpcy54ID0gMTsgfSxcblx0ICAgICAgcHJvcHMgPSBbXTtcblx0XG5cdCAgICBjdG9yLnByb3RvdHlwZSA9IHsgJ3ZhbHVlT2YnOiAxLCAneSc6IDEgfTtcblx0ICAgIGZvciAodmFyIGtleSBpbiBuZXcgY3RvcikgeyBwcm9wcy5wdXNoKGtleSk7IH1cblx0ICAgIGZvciAoa2V5IGluIGFyZ3VtZW50cykgeyB9XG5cdFxuXHQgICAgLy8gRGV0ZWN0IGlmIGBuYW1lYCBvciBgbWVzc2FnZWAgcHJvcGVydGllcyBvZiBgRXJyb3IucHJvdG90eXBlYCBhcmUgZW51bWVyYWJsZSBieSBkZWZhdWx0LlxuXHQgICAgc3VwcG9ydC5lbnVtRXJyb3JQcm9wcyA9IHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZXJyb3JQcm90bywgJ21lc3NhZ2UnKSB8fCBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGVycm9yUHJvdG8sICduYW1lJyk7XG5cdFxuXHQgICAgLy8gRGV0ZWN0IGlmIGBwcm90b3R5cGVgIHByb3BlcnRpZXMgYXJlIGVudW1lcmFibGUgYnkgZGVmYXVsdC5cblx0ICAgIHN1cHBvcnQuZW51bVByb3RvdHlwZXMgPSBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGN0b3IsICdwcm90b3R5cGUnKTtcblx0XG5cdCAgICAvLyBEZXRlY3QgaWYgYGFyZ3VtZW50c2Agb2JqZWN0IGluZGV4ZXMgYXJlIG5vbi1lbnVtZXJhYmxlXG5cdCAgICBzdXBwb3J0Lm5vbkVudW1BcmdzID0ga2V5ICE9IDA7XG5cdFxuXHQgICAgLy8gRGV0ZWN0IGlmIHByb3BlcnRpZXMgc2hhZG93aW5nIHRob3NlIG9uIGBPYmplY3QucHJvdG90eXBlYCBhcmUgbm9uLWVudW1lcmFibGUuXG5cdCAgICBzdXBwb3J0Lm5vbkVudW1TaGFkb3dzID0gIS92YWx1ZU9mLy50ZXN0KHByb3BzKTtcblx0ICB9KDEpKTtcblx0XG5cdCAgdmFyIGlzT2JqZWN0ID0gUnguaW50ZXJuYWxzLmlzT2JqZWN0ID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuXHQgICAgcmV0dXJuIHZhbHVlICYmICh0eXBlID09ICdmdW5jdGlvbicgfHwgdHlwZSA9PSAnb2JqZWN0JykgfHwgZmFsc2U7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24ga2V5c0luKG9iamVjdCkge1xuXHQgICAgdmFyIHJlc3VsdCA9IFtdO1xuXHQgICAgaWYgKCFpc09iamVjdChvYmplY3QpKSB7XG5cdCAgICAgIHJldHVybiByZXN1bHQ7XG5cdCAgICB9XG5cdCAgICBpZiAoc3VwcG9ydC5ub25FbnVtQXJncyAmJiBvYmplY3QubGVuZ3RoICYmIGlzQXJndW1lbnRzKG9iamVjdCkpIHtcblx0ICAgICAgb2JqZWN0ID0gc2xpY2UuY2FsbChvYmplY3QpO1xuXHQgICAgfVxuXHQgICAgdmFyIHNraXBQcm90byA9IHN1cHBvcnQuZW51bVByb3RvdHlwZXMgJiYgdHlwZW9mIG9iamVjdCA9PSAnZnVuY3Rpb24nLFxuXHQgICAgICAgIHNraXBFcnJvclByb3BzID0gc3VwcG9ydC5lbnVtRXJyb3JQcm9wcyAmJiAob2JqZWN0ID09PSBlcnJvclByb3RvIHx8IG9iamVjdCBpbnN0YW5jZW9mIEVycm9yKTtcblx0XG5cdCAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG5cdCAgICAgIGlmICghKHNraXBQcm90byAmJiBrZXkgPT0gJ3Byb3RvdHlwZScpICYmXG5cdCAgICAgICAgICAhKHNraXBFcnJvclByb3BzICYmIChrZXkgPT0gJ21lc3NhZ2UnIHx8IGtleSA9PSAnbmFtZScpKSkge1xuXHQgICAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBpZiAoc3VwcG9ydC5ub25FbnVtU2hhZG93cyAmJiBvYmplY3QgIT09IG9iamVjdFByb3RvKSB7XG5cdCAgICAgIHZhciBjdG9yID0gb2JqZWN0LmNvbnN0cnVjdG9yLFxuXHQgICAgICAgICAgaW5kZXggPSAtMSxcblx0ICAgICAgICAgIGxlbmd0aCA9IGRvbnRFbnVtc0xlbmd0aDtcblx0XG5cdCAgICAgIGlmIChvYmplY3QgPT09IChjdG9yICYmIGN0b3IucHJvdG90eXBlKSkge1xuXHQgICAgICAgIHZhciBjbGFzc05hbWUgPSBvYmplY3QgPT09IHN0cmluZ1Byb3RvID8gc3RyaW5nQ2xhc3MgOiBvYmplY3QgPT09IGVycm9yUHJvdG8gPyBlcnJvckNsYXNzIDogdG9TdHJpbmcuY2FsbChvYmplY3QpLFxuXHQgICAgICAgICAgICBub25FbnVtID0gbm9uRW51bVByb3BzW2NsYXNzTmFtZV07XG5cdCAgICAgIH1cblx0ICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcblx0ICAgICAgICBrZXkgPSBkb250RW51bXNbaW5kZXhdO1xuXHQgICAgICAgIGlmICghKG5vbkVudW0gJiYgbm9uRW51bVtrZXldKSAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwga2V5KSkge1xuXHQgICAgICAgICAgcmVzdWx0LnB1c2goa2V5KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiByZXN1bHQ7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBpbnRlcm5hbEZvcihvYmplY3QsIGNhbGxiYWNrLCBrZXlzRnVuYykge1xuXHQgICAgdmFyIGluZGV4ID0gLTEsXG5cdCAgICAgIHByb3BzID0ga2V5c0Z1bmMob2JqZWN0KSxcblx0ICAgICAgbGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuXHRcblx0ICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG5cdCAgICAgIHZhciBrZXkgPSBwcm9wc1tpbmRleF07XG5cdCAgICAgIGlmIChjYWxsYmFjayhvYmplY3Rba2V5XSwga2V5LCBvYmplY3QpID09PSBmYWxzZSkge1xuXHQgICAgICAgIGJyZWFrO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gb2JqZWN0O1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gaW50ZXJuYWxGb3JJbihvYmplY3QsIGNhbGxiYWNrKSB7XG5cdCAgICByZXR1cm4gaW50ZXJuYWxGb3Iob2JqZWN0LCBjYWxsYmFjaywga2V5c0luKTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGlzTm9kZSh2YWx1ZSkge1xuXHQgICAgLy8gSUUgPCA5IHByZXNlbnRzIERPTSBub2RlcyBhcyBgT2JqZWN0YCBvYmplY3RzIGV4Y2VwdCB0aGV5IGhhdmUgYHRvU3RyaW5nYFxuXHQgICAgLy8gbWV0aG9kcyB0aGF0IGFyZSBgdHlwZW9mYCBcInN0cmluZ1wiIGFuZCBzdGlsbCBjYW4gY29lcmNlIG5vZGVzIHRvIHN0cmluZ3Ncblx0ICAgIHJldHVybiB0eXBlb2YgdmFsdWUudG9TdHJpbmcgIT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgKHZhbHVlICsgJycpID09ICdzdHJpbmcnO1xuXHQgIH1cblx0XG5cdCAgdmFyIGlzQXJndW1lbnRzID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgIHJldHVybiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnKSA/IHRvU3RyaW5nLmNhbGwodmFsdWUpID09IGFyZ3NDbGFzcyA6IGZhbHNlO1xuXHQgIH1cblx0XG5cdCAgLy8gZmFsbGJhY2sgZm9yIGJyb3dzZXJzIHRoYXQgY2FuJ3QgZGV0ZWN0IGBhcmd1bWVudHNgIG9iamVjdHMgYnkgW1tDbGFzc11dXG5cdCAgaWYgKCFzdXBwb3J0c0FyZ3NDbGFzcykge1xuXHQgICAgaXNBcmd1bWVudHMgPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICByZXR1cm4gKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JykgPyBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCAnY2FsbGVlJykgOiBmYWxzZTtcblx0ICAgIH07XG5cdCAgfVxuXHRcblx0ICB2YXIgaXNFcXVhbCA9IFJ4LmludGVybmFscy5pc0VxdWFsID0gZnVuY3Rpb24gKHgsIHkpIHtcblx0ICAgIHJldHVybiBkZWVwRXF1YWxzKHgsIHksIFtdLCBbXSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqIEBwcml2YXRlXG5cdCAgICogVXNlZCBmb3IgZGVlcCBjb21wYXJpc29uXG5cdCAgICoqL1xuXHQgIGZ1bmN0aW9uIGRlZXBFcXVhbHMoYSwgYiwgc3RhY2tBLCBzdGFja0IpIHtcblx0ICAgIC8vIGV4aXQgZWFybHkgZm9yIGlkZW50aWNhbCB2YWx1ZXNcblx0ICAgIGlmIChhID09PSBiKSB7XG5cdCAgICAgIC8vIHRyZWF0IGArMGAgdnMuIGAtMGAgYXMgbm90IGVxdWFsXG5cdCAgICAgIHJldHVybiBhICE9PSAwIHx8ICgxIC8gYSA9PSAxIC8gYik7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIHR5cGUgPSB0eXBlb2YgYSxcblx0ICAgICAgICBvdGhlclR5cGUgPSB0eXBlb2YgYjtcblx0XG5cdCAgICAvLyBleGl0IGVhcmx5IGZvciB1bmxpa2UgcHJpbWl0aXZlIHZhbHVlc1xuXHQgICAgaWYgKGEgPT09IGEgJiYgKGEgPT0gbnVsbCB8fCBiID09IG51bGwgfHxcblx0ICAgICAgICAodHlwZSAhPSAnZnVuY3Rpb24nICYmIHR5cGUgIT0gJ29iamVjdCcgJiYgb3RoZXJUeXBlICE9ICdmdW5jdGlvbicgJiYgb3RoZXJUeXBlICE9ICdvYmplY3QnKSkpIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIGNvbXBhcmUgW1tDbGFzc11dIG5hbWVzXG5cdCAgICB2YXIgY2xhc3NOYW1lID0gdG9TdHJpbmcuY2FsbChhKSxcblx0ICAgICAgICBvdGhlckNsYXNzID0gdG9TdHJpbmcuY2FsbChiKTtcblx0XG5cdCAgICBpZiAoY2xhc3NOYW1lID09IGFyZ3NDbGFzcykge1xuXHQgICAgICBjbGFzc05hbWUgPSBvYmplY3RDbGFzcztcblx0ICAgIH1cblx0ICAgIGlmIChvdGhlckNsYXNzID09IGFyZ3NDbGFzcykge1xuXHQgICAgICBvdGhlckNsYXNzID0gb2JqZWN0Q2xhc3M7XG5cdCAgICB9XG5cdCAgICBpZiAoY2xhc3NOYW1lICE9IG90aGVyQ2xhc3MpIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHQgICAgc3dpdGNoIChjbGFzc05hbWUpIHtcblx0ICAgICAgY2FzZSBib29sQ2xhc3M6XG5cdCAgICAgIGNhc2UgZGF0ZUNsYXNzOlxuXHQgICAgICAgIC8vIGNvZXJjZSBkYXRlcyBhbmQgYm9vbGVhbnMgdG8gbnVtYmVycywgZGF0ZXMgdG8gbWlsbGlzZWNvbmRzIGFuZCBib29sZWFuc1xuXHQgICAgICAgIC8vIHRvIGAxYCBvciBgMGAgdHJlYXRpbmcgaW52YWxpZCBkYXRlcyBjb2VyY2VkIHRvIGBOYU5gIGFzIG5vdCBlcXVhbFxuXHQgICAgICAgIHJldHVybiArYSA9PSArYjtcblx0XG5cdCAgICAgIGNhc2UgbnVtYmVyQ2xhc3M6XG5cdCAgICAgICAgLy8gdHJlYXQgYE5hTmAgdnMuIGBOYU5gIGFzIGVxdWFsXG5cdCAgICAgICAgcmV0dXJuIChhICE9ICthKSA/XG5cdCAgICAgICAgICBiICE9ICtiIDpcblx0ICAgICAgICAgIC8vIGJ1dCB0cmVhdCBgLTBgIHZzLiBgKzBgIGFzIG5vdCBlcXVhbFxuXHQgICAgICAgICAgKGEgPT0gMCA/ICgxIC8gYSA9PSAxIC8gYikgOiBhID09ICtiKTtcblx0XG5cdCAgICAgIGNhc2UgcmVnZXhwQ2xhc3M6XG5cdCAgICAgIGNhc2Ugc3RyaW5nQ2xhc3M6XG5cdCAgICAgICAgLy8gY29lcmNlIHJlZ2V4ZXMgdG8gc3RyaW5ncyAoaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS4xMC42LjQpXG5cdCAgICAgICAgLy8gdHJlYXQgc3RyaW5nIHByaW1pdGl2ZXMgYW5kIHRoZWlyIGNvcnJlc3BvbmRpbmcgb2JqZWN0IGluc3RhbmNlcyBhcyBlcXVhbFxuXHQgICAgICAgIHJldHVybiBhID09IFN0cmluZyhiKTtcblx0ICAgIH1cblx0ICAgIHZhciBpc0FyciA9IGNsYXNzTmFtZSA9PSBhcnJheUNsYXNzO1xuXHQgICAgaWYgKCFpc0Fycikge1xuXHRcblx0ICAgICAgLy8gZXhpdCBmb3IgZnVuY3Rpb25zIGFuZCBET00gbm9kZXNcblx0ICAgICAgaWYgKGNsYXNzTmFtZSAhPSBvYmplY3RDbGFzcyB8fCAoIXN1cHBvcnQubm9kZUNsYXNzICYmIChpc05vZGUoYSkgfHwgaXNOb2RlKGIpKSkpIHtcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH1cblx0ICAgICAgLy8gaW4gb2xkZXIgdmVyc2lvbnMgb2YgT3BlcmEsIGBhcmd1bWVudHNgIG9iamVjdHMgaGF2ZSBgQXJyYXlgIGNvbnN0cnVjdG9yc1xuXHQgICAgICB2YXIgY3RvckEgPSAhc3VwcG9ydC5hcmdzT2JqZWN0ICYmIGlzQXJndW1lbnRzKGEpID8gT2JqZWN0IDogYS5jb25zdHJ1Y3Rvcixcblx0ICAgICAgICAgIGN0b3JCID0gIXN1cHBvcnQuYXJnc09iamVjdCAmJiBpc0FyZ3VtZW50cyhiKSA/IE9iamVjdCA6IGIuY29uc3RydWN0b3I7XG5cdFxuXHQgICAgICAvLyBub24gYE9iamVjdGAgb2JqZWN0IGluc3RhbmNlcyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVhbFxuXHQgICAgICBpZiAoY3RvckEgIT0gY3RvckIgJiZcblx0ICAgICAgICAgICAgIShoYXNPd25Qcm9wZXJ0eS5jYWxsKGEsICdjb25zdHJ1Y3RvcicpICYmIGhhc093blByb3BlcnR5LmNhbGwoYiwgJ2NvbnN0cnVjdG9yJykpICYmXG5cdCAgICAgICAgICAgICEoaXNGdW5jdGlvbihjdG9yQSkgJiYgY3RvckEgaW5zdGFuY2VvZiBjdG9yQSAmJiBpc0Z1bmN0aW9uKGN0b3JCKSAmJiBjdG9yQiBpbnN0YW5jZW9mIGN0b3JCKSAmJlxuXHQgICAgICAgICAgICAoJ2NvbnN0cnVjdG9yJyBpbiBhICYmICdjb25zdHJ1Y3RvcicgaW4gYilcblx0ICAgICAgICAgICkge1xuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgLy8gYXNzdW1lIGN5Y2xpYyBzdHJ1Y3R1cmVzIGFyZSBlcXVhbFxuXHQgICAgLy8gdGhlIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGN5Y2xpYyBzdHJ1Y3R1cmVzIGlzIGFkYXB0ZWQgZnJvbSBFUyA1LjFcblx0ICAgIC8vIHNlY3Rpb24gMTUuMTIuMywgYWJzdHJhY3Qgb3BlcmF0aW9uIGBKT2AgKGh0dHA6Ly9lczUuZ2l0aHViLmlvLyN4MTUuMTIuMylcblx0ICAgIHZhciBpbml0ZWRTdGFjayA9ICFzdGFja0E7XG5cdCAgICBzdGFja0EgfHwgKHN0YWNrQSA9IFtdKTtcblx0ICAgIHN0YWNrQiB8fCAoc3RhY2tCID0gW10pO1xuXHRcblx0ICAgIHZhciBsZW5ndGggPSBzdGFja0EubGVuZ3RoO1xuXHQgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG5cdCAgICAgIGlmIChzdGFja0FbbGVuZ3RoXSA9PSBhKSB7XG5cdCAgICAgICAgcmV0dXJuIHN0YWNrQltsZW5ndGhdID09IGI7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHZhciBzaXplID0gMDtcblx0ICAgIHZhciByZXN1bHQgPSB0cnVlO1xuXHRcblx0ICAgIC8vIGFkZCBgYWAgYW5kIGBiYCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHNcblx0ICAgIHN0YWNrQS5wdXNoKGEpO1xuXHQgICAgc3RhY2tCLnB1c2goYik7XG5cdFxuXHQgICAgLy8gcmVjdXJzaXZlbHkgY29tcGFyZSBvYmplY3RzIGFuZCBhcnJheXMgKHN1c2NlcHRpYmxlIHRvIGNhbGwgc3RhY2sgbGltaXRzKVxuXHQgICAgaWYgKGlzQXJyKSB7XG5cdCAgICAgIC8vIGNvbXBhcmUgbGVuZ3RocyB0byBkZXRlcm1pbmUgaWYgYSBkZWVwIGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5XG5cdCAgICAgIGxlbmd0aCA9IGEubGVuZ3RoO1xuXHQgICAgICBzaXplID0gYi5sZW5ndGg7XG5cdCAgICAgIHJlc3VsdCA9IHNpemUgPT0gbGVuZ3RoO1xuXHRcblx0ICAgICAgaWYgKHJlc3VsdCkge1xuXHQgICAgICAgIC8vIGRlZXAgY29tcGFyZSB0aGUgY29udGVudHMsIGlnbm9yaW5nIG5vbi1udW1lcmljIHByb3BlcnRpZXNcblx0ICAgICAgICB3aGlsZSAoc2l6ZS0tKSB7XG5cdCAgICAgICAgICB2YXIgaW5kZXggPSBsZW5ndGgsXG5cdCAgICAgICAgICAgICAgdmFsdWUgPSBiW3NpemVdO1xuXHRcblx0ICAgICAgICAgIGlmICghKHJlc3VsdCA9IGRlZXBFcXVhbHMoYVtzaXplXSwgdmFsdWUsIHN0YWNrQSwgc3RhY2tCKSkpIHtcblx0ICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICBlbHNlIHtcblx0ICAgICAgLy8gZGVlcCBjb21wYXJlIG9iamVjdHMgdXNpbmcgYGZvckluYCwgaW5zdGVhZCBvZiBgZm9yT3duYCwgdG8gYXZvaWQgYE9iamVjdC5rZXlzYFxuXHQgICAgICAvLyB3aGljaCwgaW4gdGhpcyBjYXNlLCBpcyBtb3JlIGNvc3RseVxuXHQgICAgICBpbnRlcm5hbEZvckluKGIsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGIpIHtcblx0ICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChiLCBrZXkpKSB7XG5cdCAgICAgICAgICAvLyBjb3VudCB0aGUgbnVtYmVyIG9mIHByb3BlcnRpZXMuXG5cdCAgICAgICAgICBzaXplKys7XG5cdCAgICAgICAgICAvLyBkZWVwIGNvbXBhcmUgZWFjaCBwcm9wZXJ0eSB2YWx1ZS5cblx0ICAgICAgICAgIHJldHVybiAocmVzdWx0ID0gaGFzT3duUHJvcGVydHkuY2FsbChhLCBrZXkpICYmIGRlZXBFcXVhbHMoYVtrZXldLCB2YWx1ZSwgc3RhY2tBLCBzdGFja0IpKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgaWYgKHJlc3VsdCkge1xuXHQgICAgICAgIC8vIGVuc3VyZSBib3RoIG9iamVjdHMgaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2YgcHJvcGVydGllc1xuXHQgICAgICAgIGludGVybmFsRm9ySW4oYSwgZnVuY3Rpb24odmFsdWUsIGtleSwgYSkge1xuXHQgICAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYSwga2V5KSkge1xuXHQgICAgICAgICAgICAvLyBgc2l6ZWAgd2lsbCBiZSBgLTFgIGlmIGBhYCBoYXMgbW9yZSBwcm9wZXJ0aWVzIHRoYW4gYGJgXG5cdCAgICAgICAgICAgIHJldHVybiAocmVzdWx0ID0gLS1zaXplID4gLTEpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICBzdGFja0EucG9wKCk7XG5cdCAgICBzdGFja0IucG9wKCk7XG5cdFxuXHQgICAgcmV0dXJuIHJlc3VsdDtcblx0ICB9XG5cdFxuXHQgIHZhciBoYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXG5cdCAgICAgIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuXHRcblx0ICB2YXIgaW5oZXJpdHMgPSBSeC5pbnRlcm5hbHMuaW5oZXJpdHMgPSBmdW5jdGlvbiAoY2hpbGQsIHBhcmVudCkge1xuXHQgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfVxuXHQgICAgX18ucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTtcblx0ICAgIGNoaWxkLnByb3RvdHlwZSA9IG5ldyBfXygpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBhZGRQcm9wZXJ0aWVzID0gUnguaW50ZXJuYWxzLmFkZFByb3BlcnRpZXMgPSBmdW5jdGlvbiAob2JqKSB7XG5cdCAgICBmb3IodmFyIHNvdXJjZXMgPSBbXSwgaSA9IDEsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgeyBzb3VyY2VzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuXHQgICAgZm9yICh2YXIgaWR4ID0gMCwgbG4gPSBzb3VyY2VzLmxlbmd0aDsgaWR4IDwgbG47IGlkeCsrKSB7XG5cdCAgICAgIHZhciBzb3VyY2UgPSBzb3VyY2VzW2lkeF07XG5cdCAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7XG5cdCAgICAgICAgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLy8gUnggVXRpbHNcblx0ICB2YXIgYWRkUmVmID0gUnguaW50ZXJuYWxzLmFkZFJlZiA9IGZ1bmN0aW9uICh4cywgcikge1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoci5nZXREaXNwb3NhYmxlKCksIHhzLnN1YnNjcmliZShvYnNlcnZlcikpO1xuXHQgICAgfSk7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gYXJyYXlJbml0aWFsaXplKGNvdW50LCBmYWN0b3J5KSB7XG5cdCAgICB2YXIgYSA9IG5ldyBBcnJheShjb3VudCk7XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcblx0ICAgICAgYVtpXSA9IGZhY3RvcnkoKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBhO1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogUmVwcmVzZW50cyBhIGdyb3VwIG9mIGRpc3Bvc2FibGUgcmVzb3VyY2VzIHRoYXQgYXJlIGRpc3Bvc2VkIHRvZ2V0aGVyLlxuXHQgICAqIEBjb25zdHJ1Y3RvclxuXHQgICAqL1xuXHQgIHZhciBDb21wb3NpdGVEaXNwb3NhYmxlID0gUnguQ29tcG9zaXRlRGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBhcmdzID0gW10sIGksIGxlbjtcblx0ICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3VtZW50c1swXSkpIHtcblx0ICAgICAgYXJncyA9IGFyZ3VtZW50c1swXTtcblx0ICAgICAgbGVuID0gYXJncy5sZW5ndGg7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuXHQgICAgICBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICAgIGZvcihpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIH1cblx0ICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBhcmdzO1xuXHQgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICB0aGlzLmxlbmd0aCA9IGFyZ3MubGVuZ3RoO1xuXHQgIH07XG5cdFxuXHQgIHZhciBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlID0gQ29tcG9zaXRlRGlzcG9zYWJsZS5wcm90b3R5cGU7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEFkZHMgYSBkaXNwb3NhYmxlIHRvIHRoZSBDb21wb3NpdGVEaXNwb3NhYmxlIG9yIGRpc3Bvc2VzIHRoZSBkaXNwb3NhYmxlIGlmIHRoZSBDb21wb3NpdGVEaXNwb3NhYmxlIGlzIGRpc3Bvc2VkLlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IGl0ZW0gRGlzcG9zYWJsZSB0byBhZGQuXG5cdCAgICovXG5cdCAgQ29tcG9zaXRlRGlzcG9zYWJsZVByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoaXRlbSkge1xuXHQgICAgaWYgKHRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICBpdGVtLmRpc3Bvc2UoKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRoaXMuZGlzcG9zYWJsZXMucHVzaChpdGVtKTtcblx0ICAgICAgdGhpcy5sZW5ndGgrKztcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZW1vdmVzIGFuZCBkaXNwb3NlcyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhIGRpc3Bvc2FibGUgZnJvbSB0aGUgQ29tcG9zaXRlRGlzcG9zYWJsZS5cblx0ICAgKiBAcGFyYW0ge01peGVkfSBpdGVtIERpc3Bvc2FibGUgdG8gcmVtb3ZlLlxuXHQgICAqIEByZXR1cm5zIHtCb29sZWFufSB0cnVlIGlmIGZvdW5kOyBmYWxzZSBvdGhlcndpc2UuXG5cdCAgICovXG5cdCAgQ29tcG9zaXRlRGlzcG9zYWJsZVByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiAoaXRlbSkge1xuXHQgICAgdmFyIHNob3VsZERpc3Bvc2UgPSBmYWxzZTtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHZhciBpZHggPSB0aGlzLmRpc3Bvc2FibGVzLmluZGV4T2YoaXRlbSk7XG5cdCAgICAgIGlmIChpZHggIT09IC0xKSB7XG5cdCAgICAgICAgc2hvdWxkRGlzcG9zZSA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5kaXNwb3NhYmxlcy5zcGxpY2UoaWR4LCAxKTtcblx0ICAgICAgICB0aGlzLmxlbmd0aC0tO1xuXHQgICAgICAgIGl0ZW0uZGlzcG9zZSgpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gc2hvdWxkRGlzcG9zZTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgRGlzcG9zZXMgYWxsIGRpc3Bvc2FibGVzIGluIHRoZSBncm91cCBhbmQgcmVtb3ZlcyB0aGVtIGZyb20gdGhlIGdyb3VwLlxuXHQgICAqL1xuXHQgIENvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgIHZhciBsZW4gPSB0aGlzLmRpc3Bvc2FibGVzLmxlbmd0aCwgY3VycmVudERpc3Bvc2FibGVzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBjdXJyZW50RGlzcG9zYWJsZXNbaV0gPSB0aGlzLmRpc3Bvc2FibGVzW2ldOyB9XG5cdCAgICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBbXTtcblx0ICAgICAgdGhpcy5sZW5ndGggPSAwO1xuXHRcblx0ICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgY3VycmVudERpc3Bvc2FibGVzW2ldLmRpc3Bvc2UoKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFByb3ZpZGVzIGEgc2V0IG9mIHN0YXRpYyBtZXRob2RzIGZvciBjcmVhdGluZyBEaXNwb3NhYmxlcy5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBkaXNwb3NlIEFjdGlvbiB0byBydW4gZHVyaW5nIHRoZSBmaXJzdCBjYWxsIHRvIGRpc3Bvc2UuIFRoZSBhY3Rpb24gaXMgZ3VhcmFudGVlZCB0byBiZSBydW4gYXQgbW9zdCBvbmNlLlxuXHQgICAqL1xuXHQgIHZhciBEaXNwb3NhYmxlID0gUnguRGlzcG9zYWJsZSA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcblx0ICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgdGhpcy5hY3Rpb24gPSBhY3Rpb24gfHwgbm9vcDtcblx0ICB9O1xuXHRcblx0ICAvKiogUGVyZm9ybXMgdGhlIHRhc2sgb2YgY2xlYW5pbmcgdXAgcmVzb3VyY2VzLiAqL1xuXHQgIERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB0aGlzLmFjdGlvbigpO1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIENyZWF0ZXMgYSBkaXNwb3NhYmxlIG9iamVjdCB0aGF0IGludm9rZXMgdGhlIHNwZWNpZmllZCBhY3Rpb24gd2hlbiBkaXNwb3NlZC5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBkaXNwb3NlIEFjdGlvbiB0byBydW4gZHVyaW5nIHRoZSBmaXJzdCBjYWxsIHRvIGRpc3Bvc2UuIFRoZSBhY3Rpb24gaXMgZ3VhcmFudGVlZCB0byBiZSBydW4gYXQgbW9zdCBvbmNlLlxuXHQgICAqIEByZXR1cm4ge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB0aGF0IHJ1bnMgdGhlIGdpdmVuIGFjdGlvbiB1cG9uIGRpc3Bvc2FsLlxuXHQgICAqL1xuXHQgIHZhciBkaXNwb3NhYmxlQ3JlYXRlID0gRGlzcG9zYWJsZS5jcmVhdGUgPSBmdW5jdGlvbiAoYWN0aW9uKSB7IHJldHVybiBuZXcgRGlzcG9zYWJsZShhY3Rpb24pOyB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBHZXRzIHRoZSBkaXNwb3NhYmxlIHRoYXQgZG9lcyBub3RoaW5nIHdoZW4gZGlzcG9zZWQuXG5cdCAgICovXG5cdCAgdmFyIGRpc3Bvc2FibGVFbXB0eSA9IERpc3Bvc2FibGUuZW1wdHkgPSB7IGRpc3Bvc2U6IG5vb3AgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogVmFsaWRhdGVzIHdoZXRoZXIgdGhlIGdpdmVuIG9iamVjdCBpcyBhIGRpc3Bvc2FibGVcblx0ICAgKiBAcGFyYW0ge09iamVjdH0gT2JqZWN0IHRvIHRlc3Qgd2hldGhlciBpdCBoYXMgYSBkaXNwb3NlIG1ldGhvZFxuXHQgICAqIEByZXR1cm5zIHtCb29sZWFufSB0cnVlIGlmIGEgZGlzcG9zYWJsZSBvYmplY3QsIGVsc2UgZmFsc2UuXG5cdCAgICovXG5cdCAgdmFyIGlzRGlzcG9zYWJsZSA9IERpc3Bvc2FibGUuaXNEaXNwb3NhYmxlID0gZnVuY3Rpb24gKGQpIHtcblx0ICAgIHJldHVybiBkICYmIGlzRnVuY3Rpb24oZC5kaXNwb3NlKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgY2hlY2tEaXNwb3NlZCA9IERpc3Bvc2FibGUuY2hlY2tEaXNwb3NlZCA9IGZ1bmN0aW9uIChkaXNwb3NhYmxlKSB7XG5cdCAgICBpZiAoZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkKSB7IHRocm93IG5ldyBPYmplY3REaXNwb3NlZEVycm9yKCk7IH1cblx0ICB9O1xuXHRcblx0ICB2YXIgZGlzcG9zYWJsZUZpeHVwID0gRGlzcG9zYWJsZS5fZml4dXAgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG5cdCAgICByZXR1cm4gaXNEaXNwb3NhYmxlKHJlc3VsdCkgPyByZXN1bHQgOiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgfTtcblx0XG5cdCAgLy8gU2luZ2xlIGFzc2lnbm1lbnRcblx0ICB2YXIgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUgPSBSeC5TaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcblx0ICB9O1xuXHQgIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlLnByb3RvdHlwZS5nZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXMuY3VycmVudDtcblx0ICB9O1xuXHQgIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlLnByb3RvdHlwZS5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICBpZiAodGhpcy5jdXJyZW50KSB7IHRocm93IG5ldyBFcnJvcignRGlzcG9zYWJsZSBoYXMgYWxyZWFkeSBiZWVuIGFzc2lnbmVkJyk7IH1cblx0ICAgIHZhciBzaG91bGREaXNwb3NlID0gdGhpcy5pc0Rpc3Bvc2VkO1xuXHQgICAgIXNob3VsZERpc3Bvc2UgJiYgKHRoaXMuY3VycmVudCA9IHZhbHVlKTtcblx0ICAgIHNob3VsZERpc3Bvc2UgJiYgdmFsdWUgJiYgdmFsdWUuZGlzcG9zZSgpO1xuXHQgIH07XG5cdCAgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICB2YXIgb2xkID0gdGhpcy5jdXJyZW50O1xuXHQgICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuXHQgICAgICBvbGQgJiYgb2xkLmRpc3Bvc2UoKTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvLyBNdWx0aXBsZSBhc3NpZ25tZW50IGRpc3Bvc2FibGVcblx0ICB2YXIgU2VyaWFsRGlzcG9zYWJsZSA9IFJ4LlNlcmlhbERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG5cdCAgfTtcblx0ICBTZXJpYWxEaXNwb3NhYmxlLnByb3RvdHlwZS5nZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXMuY3VycmVudDtcblx0ICB9O1xuXHQgIFNlcmlhbERpc3Bvc2FibGUucHJvdG90eXBlLnNldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgIHZhciBzaG91bGREaXNwb3NlID0gdGhpcy5pc0Rpc3Bvc2VkO1xuXHQgICAgaWYgKCFzaG91bGREaXNwb3NlKSB7XG5cdCAgICAgIHZhciBvbGQgPSB0aGlzLmN1cnJlbnQ7XG5cdCAgICAgIHRoaXMuY3VycmVudCA9IHZhbHVlO1xuXHQgICAgfVxuXHQgICAgb2xkICYmIG9sZC5kaXNwb3NlKCk7XG5cdCAgICBzaG91bGREaXNwb3NlICYmIHZhbHVlICYmIHZhbHVlLmRpc3Bvc2UoKTtcblx0ICB9O1xuXHQgIFNlcmlhbERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICB2YXIgb2xkID0gdGhpcy5jdXJyZW50O1xuXHQgICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuXHQgICAgfVxuXHQgICAgb2xkICYmIG9sZC5kaXNwb3NlKCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIEJpbmFyeURpc3Bvc2FibGUgPSBSeC5CaW5hcnlEaXNwb3NhYmxlID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHtcblx0ICAgIHRoaXMuX2ZpcnN0ID0gZmlyc3Q7XG5cdCAgICB0aGlzLl9zZWNvbmQgPSBzZWNvbmQ7XG5cdCAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICB9O1xuXHRcblx0ICBCaW5hcnlEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgdmFyIG9sZDEgPSB0aGlzLl9maXJzdDtcblx0ICAgICAgdGhpcy5fZmlyc3QgPSBudWxsO1xuXHQgICAgICBvbGQxICYmIG9sZDEuZGlzcG9zZSgpO1xuXHQgICAgICB2YXIgb2xkMiA9IHRoaXMuX3NlY29uZDtcblx0ICAgICAgdGhpcy5fc2Vjb25kID0gbnVsbDtcblx0ICAgICAgb2xkMiAmJiBvbGQyLmRpc3Bvc2UoKTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICB2YXIgTkFyeURpc3Bvc2FibGUgPSBSeC5OQXJ5RGlzcG9zYWJsZSA9IGZ1bmN0aW9uIChkaXNwb3NhYmxlcykge1xuXHQgICAgdGhpcy5fZGlzcG9zYWJsZXMgPSBkaXNwb3NhYmxlcztcblx0ICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgIH07XG5cdFxuXHQgIE5BcnlEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2Rpc3Bvc2FibGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgdGhpcy5fZGlzcG9zYWJsZXNbaV0uZGlzcG9zZSgpO1xuXHQgICAgICB9XG5cdCAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmxlbmd0aCA9IDA7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmVwcmVzZW50cyBhIGRpc3Bvc2FibGUgcmVzb3VyY2UgdGhhdCBvbmx5IGRpc3Bvc2VzIGl0cyB1bmRlcmx5aW5nIGRpc3Bvc2FibGUgcmVzb3VyY2Ugd2hlbiBhbGwgZGVwZW5kZW50IGRpc3Bvc2FibGUgb2JqZWN0cyBoYXZlIGJlZW4gZGlzcG9zZWQuXG5cdCAgICovXG5cdCAgdmFyIFJlZkNvdW50RGlzcG9zYWJsZSA9IFJ4LlJlZkNvdW50RGlzcG9zYWJsZSA9IChmdW5jdGlvbiAoKSB7XG5cdFxuXHQgICAgZnVuY3Rpb24gSW5uZXJEaXNwb3NhYmxlKGRpc3Bvc2FibGUpIHtcblx0ICAgICAgdGhpcy5kaXNwb3NhYmxlID0gZGlzcG9zYWJsZTtcblx0ICAgICAgdGhpcy5kaXNwb3NhYmxlLmNvdW50Kys7XG5cdCAgICAgIHRoaXMuaXNJbm5lckRpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgSW5uZXJEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAoIXRoaXMuZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkICYmICF0aGlzLmlzSW5uZXJEaXNwb3NlZCkge1xuXHQgICAgICAgIHRoaXMuaXNJbm5lckRpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmRpc3Bvc2FibGUuY291bnQtLTtcblx0ICAgICAgICBpZiAodGhpcy5kaXNwb3NhYmxlLmNvdW50ID09PSAwICYmIHRoaXMuZGlzcG9zYWJsZS5pc1ByaW1hcnlEaXNwb3NlZCkge1xuXHQgICAgICAgICAgdGhpcy5kaXNwb3NhYmxlLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5kaXNwb3NhYmxlLnVuZGVybHlpbmdEaXNwb3NhYmxlLmRpc3Bvc2UoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBJbml0aWFsaXplcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgUmVmQ291bnREaXNwb3NhYmxlIHdpdGggdGhlIHNwZWNpZmllZCBkaXNwb3NhYmxlLlxuXHQgICAgICogQGNvbnN0cnVjdG9yXG5cdCAgICAgKiBAcGFyYW0ge0Rpc3Bvc2FibGV9IGRpc3Bvc2FibGUgVW5kZXJseWluZyBkaXNwb3NhYmxlLlxuXHQgICAgICAqL1xuXHQgICAgZnVuY3Rpb24gUmVmQ291bnREaXNwb3NhYmxlKGRpc3Bvc2FibGUpIHtcblx0ICAgICAgdGhpcy51bmRlcmx5aW5nRGlzcG9zYWJsZSA9IGRpc3Bvc2FibGU7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmlzUHJpbWFyeURpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuY291bnQgPSAwO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogRGlzcG9zZXMgdGhlIHVuZGVybHlpbmcgZGlzcG9zYWJsZSBvbmx5IHdoZW4gYWxsIGRlcGVuZGVudCBkaXNwb3NhYmxlcyBoYXZlIGJlZW4gZGlzcG9zZWRcblx0ICAgICAqL1xuXHQgICAgUmVmQ291bnREaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCAmJiAhdGhpcy5pc1ByaW1hcnlEaXNwb3NlZCkge1xuXHQgICAgICAgIHRoaXMuaXNQcmltYXJ5RGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgIGlmICh0aGlzLmNvdW50ID09PSAwKSB7XG5cdCAgICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy51bmRlcmx5aW5nRGlzcG9zYWJsZS5kaXNwb3NlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJucyBhIGRlcGVuZGVudCBkaXNwb3NhYmxlIHRoYXQgd2hlbiBkaXNwb3NlZCBkZWNyZWFzZXMgdGhlIHJlZmNvdW50IG9uIHRoZSB1bmRlcmx5aW5nIGRpc3Bvc2FibGUuXG5cdCAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkZXBlbmRlbnQgZGlzcG9zYWJsZSBjb250cmlidXRpbmcgdG8gdGhlIHJlZmVyZW5jZSBjb3VudCB0aGF0IG1hbmFnZXMgdGhlIHVuZGVybHlpbmcgZGlzcG9zYWJsZSdzIGxpZmV0aW1lLlxuXHQgICAgICovXG5cdCAgICBSZWZDb3VudERpc3Bvc2FibGUucHJvdG90eXBlLmdldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLmlzRGlzcG9zZWQgPyBkaXNwb3NhYmxlRW1wdHkgOiBuZXcgSW5uZXJEaXNwb3NhYmxlKHRoaXMpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUmVmQ291bnREaXNwb3NhYmxlO1xuXHQgIH0pKCk7XG5cdFxuXHQgIHZhciBTY2hlZHVsZWRJdGVtID0gUnguaW50ZXJuYWxzLlNjaGVkdWxlZEl0ZW0gPSBmdW5jdGlvbiAoc2NoZWR1bGVyLCBzdGF0ZSwgYWN0aW9uLCBkdWVUaW1lLCBjb21wYXJlcikge1xuXHQgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICB0aGlzLnN0YXRlID0gc3RhdGU7XG5cdCAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcblx0ICAgIHRoaXMuZHVlVGltZSA9IGR1ZVRpbWU7XG5cdCAgICB0aGlzLmNvbXBhcmVyID0gY29tcGFyZXIgfHwgZGVmYXVsdFN1YkNvbXBhcmVyO1xuXHQgICAgdGhpcy5kaXNwb3NhYmxlID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgfVxuXHRcblx0ICBTY2hlZHVsZWRJdGVtLnByb3RvdHlwZS5pbnZva2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0aGlzLmRpc3Bvc2FibGUuc2V0RGlzcG9zYWJsZSh0aGlzLmludm9rZUNvcmUoKSk7XG5cdCAgfTtcblx0XG5cdCAgU2NoZWR1bGVkSXRlbS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cdCAgICByZXR1cm4gdGhpcy5jb21wYXJlcih0aGlzLmR1ZVRpbWUsIG90aGVyLmR1ZVRpbWUpO1xuXHQgIH07XG5cdFxuXHQgIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmlzQ2FuY2VsbGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXMuZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkO1xuXHQgIH07XG5cdFxuXHQgIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmludm9rZUNvcmUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gZGlzcG9zYWJsZUZpeHVwKHRoaXMuYWN0aW9uKHRoaXMuc2NoZWR1bGVyLCB0aGlzLnN0YXRlKSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqIFByb3ZpZGVzIGEgc2V0IG9mIHN0YXRpYyBwcm9wZXJ0aWVzIHRvIGFjY2VzcyBjb21tb25seSB1c2VkIHNjaGVkdWxlcnMuICovXG5cdCAgdmFyIFNjaGVkdWxlciA9IFJ4LlNjaGVkdWxlciA9IChmdW5jdGlvbiAoKSB7XG5cdFxuXHQgICAgZnVuY3Rpb24gU2NoZWR1bGVyKCkgeyB9XG5cdFxuXHQgICAgLyoqIERldGVybWluZXMgd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgc2NoZWR1bGVyICovXG5cdCAgICBTY2hlZHVsZXIuaXNTY2hlZHVsZXIgPSBmdW5jdGlvbiAocykge1xuXHQgICAgICByZXR1cm4gcyBpbnN0YW5jZW9mIFNjaGVkdWxlcjtcblx0ICAgIH07XG5cdFxuXHQgICAgdmFyIHNjaGVkdWxlclByb3RvID0gU2NoZWR1bGVyLnByb3RvdHlwZTtcblx0XG5cdCAgICAvKipcblx0ICAgKiBTY2hlZHVsZXMgYW4gYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAqIEBwYXJhbSBzdGF0ZSBTdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCBhY3Rpb24gKGJlc3QgZWZmb3J0KS5cblx0ICAgKi9cblx0ICAgIHNjaGVkdWxlclByb3RvLnNjaGVkdWxlID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcblx0ICAgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXJyb3IoKTtcblx0ICAgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQgYWZ0ZXIgZHVlVGltZS5cblx0ICAgKiBAcGFyYW0gc3RhdGUgU3RhdGUgcGFzc2VkIHRvIHRoZSBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgKiBAcGFyYW0ge051bWJlcn0gZHVlVGltZSBSZWxhdGl2ZSB0aW1lIGFmdGVyIHdoaWNoIHRvIGV4ZWN1dGUgdGhlIGFjdGlvbi5cblx0ICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG5cdCAgICovXG5cdCAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZUZ1dHVyZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZHVlVGltZSwgYWN0aW9uKSB7XG5cdCAgICAgIHZhciBkdCA9IGR1ZVRpbWU7XG5cdCAgICAgIGR0IGluc3RhbmNlb2YgRGF0ZSAmJiAoZHQgPSBkdCAtIHRoaXMubm93KCkpO1xuXHQgICAgICBkdCA9IFNjaGVkdWxlci5ub3JtYWxpemUoZHQpO1xuXHRcblx0ICAgICAgaWYgKGR0ID09PSAwKSB7IHJldHVybiB0aGlzLnNjaGVkdWxlKHN0YXRlLCBhY3Rpb24pOyB9XG5cdFxuXHQgICAgICByZXR1cm4gdGhpcy5fc2NoZWR1bGVGdXR1cmUoc3RhdGUsIGR0LCBhY3Rpb24pO1xuXHQgICAgfTtcblx0XG5cdCAgICBzY2hlZHVsZXJQcm90by5fc2NoZWR1bGVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuXHQgICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKiogR2V0cyB0aGUgY3VycmVudCB0aW1lIGFjY29yZGluZyB0byB0aGUgbG9jYWwgbWFjaGluZSdzIHN5c3RlbSBjbG9jay4gKi9cblx0ICAgIFNjaGVkdWxlci5ub3cgPSBkZWZhdWx0Tm93O1xuXHRcblx0ICAgIC8qKiBHZXRzIHRoZSBjdXJyZW50IHRpbWUgYWNjb3JkaW5nIHRvIHRoZSBsb2NhbCBtYWNoaW5lJ3Mgc3lzdGVtIGNsb2NrLiAqL1xuXHQgICAgU2NoZWR1bGVyLnByb3RvdHlwZS5ub3cgPSBkZWZhdWx0Tm93O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTm9ybWFsaXplcyB0aGUgc3BlY2lmaWVkIFRpbWVTcGFuIHZhbHVlIHRvIGEgcG9zaXRpdmUgdmFsdWUuXG5cdCAgICAgKiBAcGFyYW0ge051bWJlcn0gdGltZVNwYW4gVGhlIHRpbWUgc3BhbiB2YWx1ZSB0byBub3JtYWxpemUuXG5cdCAgICAgKiBAcmV0dXJucyB7TnVtYmVyfSBUaGUgc3BlY2lmaWVkIFRpbWVTcGFuIHZhbHVlIGlmIGl0IGlzIHplcm8gb3IgcG9zaXRpdmU7IG90aGVyd2lzZSwgMFxuXHQgICAgICovXG5cdCAgICBTY2hlZHVsZXIubm9ybWFsaXplID0gZnVuY3Rpb24gKHRpbWVTcGFuKSB7XG5cdCAgICAgIHRpbWVTcGFuIDwgMCAmJiAodGltZVNwYW4gPSAwKTtcblx0ICAgICAgcmV0dXJuIHRpbWVTcGFuO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2NoZWR1bGVyO1xuXHQgIH0oKSk7XG5cdFxuXHQgIHZhciBub3JtYWxpemVUaW1lID0gU2NoZWR1bGVyLm5vcm1hbGl6ZSwgaXNTY2hlZHVsZXIgPSBTY2hlZHVsZXIuaXNTY2hlZHVsZXI7XG5cdFxuXHQgIChmdW5jdGlvbiAoc2NoZWR1bGVyUHJvdG8pIHtcblx0XG5cdCAgICBmdW5jdGlvbiBpbnZva2VSZWNJbW1lZGlhdGUoc2NoZWR1bGVyLCBwYWlyKSB7XG5cdCAgICAgIHZhciBzdGF0ZSA9IHBhaXJbMF0sIGFjdGlvbiA9IHBhaXJbMV0sIGdyb3VwID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcblx0ICAgICAgYWN0aW9uKHN0YXRlLCBpbm5lckFjdGlvbik7XG5cdCAgICAgIHJldHVybiBncm91cDtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGlubmVyQWN0aW9uKHN0YXRlMikge1xuXHQgICAgICAgIHZhciBpc0FkZGVkID0gZmFsc2UsIGlzRG9uZSA9IGZhbHNlO1xuXHRcblx0ICAgICAgICB2YXIgZCA9IHNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZTIsIHNjaGVkdWxlV29yayk7XG5cdCAgICAgICAgaWYgKCFpc0RvbmUpIHtcblx0ICAgICAgICAgIGdyb3VwLmFkZChkKTtcblx0ICAgICAgICAgIGlzQWRkZWQgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgZnVuY3Rpb24gc2NoZWR1bGVXb3JrKF8sIHN0YXRlMykge1xuXHQgICAgICAgICAgaWYgKGlzQWRkZWQpIHtcblx0ICAgICAgICAgICAgZ3JvdXAucmVtb3ZlKGQpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIGFjdGlvbihzdGF0ZTMsIGlubmVyQWN0aW9uKTtcblx0ICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gaW52b2tlUmVjRGF0ZShzY2hlZHVsZXIsIHBhaXIpIHtcblx0ICAgICAgdmFyIHN0YXRlID0gcGFpclswXSwgYWN0aW9uID0gcGFpclsxXSwgZ3JvdXAgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuXHQgICAgICBhY3Rpb24oc3RhdGUsIGlubmVyQWN0aW9uKTtcblx0ICAgICAgcmV0dXJuIGdyb3VwO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gaW5uZXJBY3Rpb24oc3RhdGUyLCBkdWVUaW1lMSkge1xuXHQgICAgICAgIHZhciBpc0FkZGVkID0gZmFsc2UsIGlzRG9uZSA9IGZhbHNlO1xuXHRcblx0ICAgICAgICB2YXIgZCA9IHNjaGVkdWxlci5zY2hlZHVsZUZ1dHVyZShzdGF0ZTIsIGR1ZVRpbWUxLCBzY2hlZHVsZVdvcmspO1xuXHQgICAgICAgIGlmICghaXNEb25lKSB7XG5cdCAgICAgICAgICBncm91cC5hZGQoZCk7XG5cdCAgICAgICAgICBpc0FkZGVkID0gdHJ1ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGZ1bmN0aW9uIHNjaGVkdWxlV29yayhfLCBzdGF0ZTMpIHtcblx0ICAgICAgICAgIGlmIChpc0FkZGVkKSB7XG5cdCAgICAgICAgICAgIGdyb3VwLnJlbW92ZShkKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBhY3Rpb24oc3RhdGUzLCBpbm5lckFjdGlvbik7XG5cdCAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2NoZWR1bGVzIGFuIGFjdGlvbiB0byBiZSBleGVjdXRlZCByZWN1cnNpdmVseS5cblx0ICAgICAqIEBwYXJhbSB7TWl4ZWR9IHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBleGVjdXRlIHJlY3Vyc2l2ZWx5LiBUaGUgbGFzdCBwYXJhbWV0ZXIgcGFzc2VkIHRvIHRoZSBhY3Rpb24gaXMgdXNlZCB0byB0cmlnZ2VyIHJlY3Vyc2l2ZSBzY2hlZHVsaW5nIG9mIHRoZSBhY3Rpb24sIHBhc3NpbmcgaW4gcmVjdXJzaXZlIGludm9jYXRpb24gc3RhdGUuXG5cdCAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG5cdCAgICAgKi9cblx0ICAgIHNjaGVkdWxlclByb3RvLnNjaGVkdWxlUmVjdXJzaXZlID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGUoW3N0YXRlLCBhY3Rpb25dLCBpbnZva2VSZWNJbW1lZGlhdGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQgcmVjdXJzaXZlbHkgYWZ0ZXIgYSBzcGVjaWZpZWQgcmVsYXRpdmUgb3IgYWJzb2x1dGUgZHVlIHRpbWUuXG5cdCAgICAgKiBAcGFyYW0ge01peGVkfSBzdGF0ZSBTdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gZXhlY3V0ZSByZWN1cnNpdmVseS4gVGhlIGxhc3QgcGFyYW1ldGVyIHBhc3NlZCB0byB0aGUgYWN0aW9uIGlzIHVzZWQgdG8gdHJpZ2dlciByZWN1cnNpdmUgc2NoZWR1bGluZyBvZiB0aGUgYWN0aW9uLCBwYXNzaW5nIGluIHRoZSByZWN1cnNpdmUgZHVlIHRpbWUgYW5kIGludm9jYXRpb24gc3RhdGUuXG5cdCAgICAgKiBAcGFyYW0ge051bWJlciB8IERhdGV9IGR1ZVRpbWUgUmVsYXRpdmUgb3IgYWJzb2x1dGUgdGltZSBhZnRlciB3aGljaCB0byBleGVjdXRlIHRoZSBhY3Rpb24gZm9yIHRoZSBmaXJzdCB0aW1lLlxuXHQgICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuXHQgICAgICovXG5cdCAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZVJlY3Vyc2l2ZUZ1dHVyZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZHVlVGltZSwgYWN0aW9uKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlRnV0dXJlKFtzdGF0ZSwgYWN0aW9uXSwgZHVlVGltZSwgaW52b2tlUmVjRGF0ZSk7XG5cdCAgICB9O1xuXHRcblx0ICB9KFNjaGVkdWxlci5wcm90b3R5cGUpKTtcblx0XG5cdCAgKGZ1bmN0aW9uIChzY2hlZHVsZXJQcm90bykge1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU2NoZWR1bGVzIGEgcGVyaW9kaWMgcGllY2Ugb2Ygd29yayBieSBkeW5hbWljYWxseSBkaXNjb3ZlcmluZyB0aGUgc2NoZWR1bGVyJ3MgY2FwYWJpbGl0aWVzLiBUaGUgcGVyaW9kaWMgdGFzayB3aWxsIGJlIHNjaGVkdWxlZCB1c2luZyB3aW5kb3cuc2V0SW50ZXJ2YWwgZm9yIHRoZSBiYXNlIGltcGxlbWVudGF0aW9uLlxuXHQgICAgICogQHBhcmFtIHtNaXhlZH0gc3RhdGUgSW5pdGlhbCBzdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB1cG9uIHRoZSBmaXJzdCBpdGVyYXRpb24uXG5cdCAgICAgKiBAcGFyYW0ge051bWJlcn0gcGVyaW9kIFBlcmlvZCBmb3IgcnVubmluZyB0aGUgd29yayBwZXJpb2RpY2FsbHkuXG5cdCAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGJlIGV4ZWN1dGVkLCBwb3RlbnRpYWxseSB1cGRhdGluZyB0aGUgc3RhdGUuXG5cdCAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgcmVjdXJyaW5nIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuXHQgICAgICovXG5cdCAgICBTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlUGVyaW9kaWMgPSBmdW5jdGlvbihzdGF0ZSwgcGVyaW9kLCBhY3Rpb24pIHtcblx0ICAgICAgaWYgKHR5cGVvZiByb290LnNldEludGVydmFsID09PSAndW5kZWZpbmVkJykgeyB0aHJvdyBuZXcgTm90U3VwcG9ydGVkRXJyb3IoKTsgfVxuXHQgICAgICBwZXJpb2QgPSBub3JtYWxpemVUaW1lKHBlcmlvZCk7XG5cdCAgICAgIHZhciBzID0gc3RhdGUsIGlkID0gcm9vdC5zZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7IHMgPSBhY3Rpb24ocyk7IH0sIHBlcmlvZCk7XG5cdCAgICAgIHJldHVybiBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHsgcm9vdC5jbGVhckludGVydmFsKGlkKTsgfSk7XG5cdCAgICB9O1xuXHRcblx0ICB9KFNjaGVkdWxlci5wcm90b3R5cGUpKTtcblx0XG5cdCAgLyoqIEdldHMgYSBzY2hlZHVsZXIgdGhhdCBzY2hlZHVsZXMgd29yayBpbW1lZGlhdGVseSBvbiB0aGUgY3VycmVudCB0aHJlYWQuICovXG5cdCAgIHZhciBJbW1lZGlhdGVTY2hlZHVsZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoSW1tZWRpYXRlU2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gSW1tZWRpYXRlU2NoZWR1bGVyKCkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBJbW1lZGlhdGVTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcblx0ICAgICAgcmV0dXJuIGRpc3Bvc2FibGVGaXh1cChhY3Rpb24odGhpcywgc3RhdGUpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEltbWVkaWF0ZVNjaGVkdWxlcjtcblx0ICB9KFNjaGVkdWxlcikpO1xuXHRcblx0ICB2YXIgaW1tZWRpYXRlU2NoZWR1bGVyID0gU2NoZWR1bGVyLmltbWVkaWF0ZSA9IG5ldyBJbW1lZGlhdGVTY2hlZHVsZXIoKTtcblx0XG5cdCAgLyoqXG5cdCAgICogR2V0cyBhIHNjaGVkdWxlciB0aGF0IHNjaGVkdWxlcyB3b3JrIGFzIHNvb24gYXMgcG9zc2libGUgb24gdGhlIGN1cnJlbnQgdGhyZWFkLlxuXHQgICAqL1xuXHQgIHZhciBDdXJyZW50VGhyZWFkU2NoZWR1bGVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIHZhciBxdWV1ZTtcblx0XG5cdCAgICBmdW5jdGlvbiBydW5UcmFtcG9saW5lICgpIHtcblx0ICAgICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICB2YXIgaXRlbSA9IHF1ZXVlLmRlcXVldWUoKTtcblx0ICAgICAgICAhaXRlbS5pc0NhbmNlbGxlZCgpICYmIGl0ZW0uaW52b2tlKCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBpbmhlcml0cyhDdXJyZW50VGhyZWFkU2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ3VycmVudFRocmVhZFNjaGVkdWxlcigpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgQ3VycmVudFRocmVhZFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuXHQgICAgICB2YXIgc2kgPSBuZXcgU2NoZWR1bGVkSXRlbSh0aGlzLCBzdGF0ZSwgYWN0aW9uLCB0aGlzLm5vdygpKTtcblx0XG5cdCAgICAgIGlmICghcXVldWUpIHtcblx0ICAgICAgICBxdWV1ZSA9IG5ldyBQcmlvcml0eVF1ZXVlKDQpO1xuXHQgICAgICAgIHF1ZXVlLmVucXVldWUoc2kpO1xuXHRcblx0ICAgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2gocnVuVHJhbXBvbGluZSkoKTtcblx0ICAgICAgICBxdWV1ZSA9IG51bGw7XG5cdCAgICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgdGhyb3dlcihyZXN1bHQuZSk7IH1cblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBxdWV1ZS5lbnF1ZXVlKHNpKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gc2kuZGlzcG9zYWJsZTtcblx0ICAgIH07XG5cdFxuXHQgICAgQ3VycmVudFRocmVhZFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGVSZXF1aXJlZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICFxdWV1ZTsgfTtcblx0XG5cdCAgICByZXR1cm4gQ3VycmVudFRocmVhZFNjaGVkdWxlcjtcblx0ICB9KFNjaGVkdWxlcikpO1xuXHRcblx0ICB2YXIgY3VycmVudFRocmVhZFNjaGVkdWxlciA9IFNjaGVkdWxlci5jdXJyZW50VGhyZWFkID0gbmV3IEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIoKTtcblx0XG5cdCAgdmFyIFNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUgPSBSeC5pbnRlcm5hbHMuU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZSA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBjcmVhdGVUaWNrKHNlbGYpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uIHRpY2soY29tbWFuZCwgcmVjdXJzZSkge1xuXHQgICAgICAgIHJlY3Vyc2UoMCwgc2VsZi5fcGVyaW9kKTtcblx0ICAgICAgICB2YXIgc3RhdGUgPSB0cnlDYXRjaChzZWxmLl9hY3Rpb24pKHNlbGYuX3N0YXRlKTtcblx0ICAgICAgICBpZiAoc3RhdGUgPT09IGVycm9yT2JqKSB7XG5cdCAgICAgICAgICBzZWxmLl9jYW5jZWwuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgdGhyb3dlcihzdGF0ZS5lKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgc2VsZi5fc3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBTY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlKHNjaGVkdWxlciwgc3RhdGUsIHBlcmlvZCwgYWN0aW9uKSB7XG5cdCAgICAgIHRoaXMuX3NjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgdGhpcy5fcGVyaW9kID0gcGVyaW9kO1xuXHQgICAgICB0aGlzLl9hY3Rpb24gPSBhY3Rpb247XG5cdCAgICB9XG5cdFxuXHQgICAgU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHRoaXMuX2NhbmNlbCA9IGQ7XG5cdCAgICAgIGQuc2V0RGlzcG9zYWJsZSh0aGlzLl9zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUoMCwgdGhpcy5fcGVyaW9kLCBjcmVhdGVUaWNrKHRoaXMpKSk7XG5cdFxuXHQgICAgICByZXR1cm4gZDtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmU7XG5cdCAgfSgpKTtcblx0XG5cdCAgdmFyIHNjaGVkdWxlTWV0aG9kLCBjbGVhck1ldGhvZDtcblx0XG5cdCAgdmFyIGxvY2FsVGltZXIgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGxvY2FsU2V0VGltZW91dCwgbG9jYWxDbGVhclRpbWVvdXQgPSBub29wO1xuXHQgICAgaWYgKCEhcm9vdC5zZXRUaW1lb3V0KSB7XG5cdCAgICAgIGxvY2FsU2V0VGltZW91dCA9IHJvb3Quc2V0VGltZW91dDtcblx0ICAgICAgbG9jYWxDbGVhclRpbWVvdXQgPSByb290LmNsZWFyVGltZW91dDtcblx0ICAgIH0gZWxzZSBpZiAoISFyb290LldTY3JpcHQpIHtcblx0ICAgICAgbG9jYWxTZXRUaW1lb3V0ID0gZnVuY3Rpb24gKGZuLCB0aW1lKSB7XG5cdCAgICAgICAgcm9vdC5XU2NyaXB0LlNsZWVwKHRpbWUpO1xuXHQgICAgICAgIGZuKCk7XG5cdCAgICAgIH07XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aHJvdyBuZXcgTm90U3VwcG9ydGVkRXJyb3IoKTtcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICBzZXRUaW1lb3V0OiBsb2NhbFNldFRpbWVvdXQsXG5cdCAgICAgIGNsZWFyVGltZW91dDogbG9jYWxDbGVhclRpbWVvdXRcblx0ICAgIH07XG5cdCAgfSgpKTtcblx0ICB2YXIgbG9jYWxTZXRUaW1lb3V0ID0gbG9jYWxUaW1lci5zZXRUaW1lb3V0LFxuXHQgICAgbG9jYWxDbGVhclRpbWVvdXQgPSBsb2NhbFRpbWVyLmNsZWFyVGltZW91dDtcblx0XG5cdCAgKGZ1bmN0aW9uICgpIHtcblx0XG5cdCAgICB2YXIgbmV4dEhhbmRsZSA9IDEsIHRhc2tzQnlIYW5kbGUgPSB7fSwgY3VycmVudGx5UnVubmluZyA9IGZhbHNlO1xuXHRcblx0ICAgIGNsZWFyTWV0aG9kID0gZnVuY3Rpb24gKGhhbmRsZSkge1xuXHQgICAgICBkZWxldGUgdGFza3NCeUhhbmRsZVtoYW5kbGVdO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBydW5UYXNrKGhhbmRsZSkge1xuXHQgICAgICBpZiAoY3VycmVudGx5UnVubmluZykge1xuXHQgICAgICAgIGxvY2FsU2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJ1blRhc2soaGFuZGxlKTsgfSwgMCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdmFyIHRhc2sgPSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG5cdCAgICAgICAgaWYgKHRhc2spIHtcblx0ICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmcgPSB0cnVlO1xuXHQgICAgICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRhc2spKCk7XG5cdCAgICAgICAgICBjbGVhck1ldGhvZChoYW5kbGUpO1xuXHQgICAgICAgICAgY3VycmVudGx5UnVubmluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgdGhyb3dlcihyZXN1bHQuZSk7IH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICB2YXIgcmVOYXRpdmUgPSBuZXcgUmVnRXhwKCdeJyArXG5cdCAgICAgIFN0cmluZyh0b1N0cmluZylcblx0ICAgICAgICAucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKVxuXHQgICAgICAgIC5yZXBsYWNlKC90b1N0cmluZ3wgZm9yIFteXFxdXSsvZywgJy4qPycpICsgJyQnXG5cdCAgICApO1xuXHRcblx0ICAgIHZhciBzZXRJbW1lZGlhdGUgPSB0eXBlb2YgKHNldEltbWVkaWF0ZSA9IGZyZWVHbG9iYWwgJiYgbW9kdWxlRXhwb3J0cyAmJiBmcmVlR2xvYmFsLnNldEltbWVkaWF0ZSkgPT0gJ2Z1bmN0aW9uJyAmJlxuXHQgICAgICAhcmVOYXRpdmUudGVzdChzZXRJbW1lZGlhdGUpICYmIHNldEltbWVkaWF0ZTtcblx0XG5cdCAgICBmdW5jdGlvbiBwb3N0TWVzc2FnZVN1cHBvcnRlZCAoKSB7XG5cdCAgICAgIC8vIEVuc3VyZSBub3QgaW4gYSB3b3JrZXJcblx0ICAgICAgaWYgKCFyb290LnBvc3RNZXNzYWdlIHx8IHJvb3QuaW1wb3J0U2NyaXB0cykgeyByZXR1cm4gZmFsc2U7IH1cblx0ICAgICAgdmFyIGlzQXN5bmMgPSBmYWxzZSwgb2xkSGFuZGxlciA9IHJvb3Qub25tZXNzYWdlO1xuXHQgICAgICAvLyBUZXN0IGZvciBhc3luY1xuXHQgICAgICByb290Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uICgpIHsgaXNBc3luYyA9IHRydWU7IH07XG5cdCAgICAgIHJvb3QucG9zdE1lc3NhZ2UoJycsICcqJyk7XG5cdCAgICAgIHJvb3Qub25tZXNzYWdlID0gb2xkSGFuZGxlcjtcblx0XG5cdCAgICAgIHJldHVybiBpc0FzeW5jO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIFVzZSBpbiBvcmRlciwgc2V0SW1tZWRpYXRlLCBuZXh0VGljaywgcG9zdE1lc3NhZ2UsIE1lc3NhZ2VDaGFubmVsLCBzY3JpcHQgcmVhZHlzdGF0ZWNoYW5nZWQsIHNldFRpbWVvdXRcblx0ICAgIGlmIChpc0Z1bmN0aW9uKHNldEltbWVkaWF0ZSkpIHtcblx0ICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG5cdCAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuXHQgICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuXHQgICAgICAgIHNldEltbWVkaWF0ZShmdW5jdGlvbiAoKSB7IHJ1blRhc2soaWQpOyB9KTtcblx0XG5cdCAgICAgICAgcmV0dXJuIGlkO1xuXHQgICAgICB9O1xuXHQgICAgfSBlbHNlIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYge30udG9TdHJpbmcuY2FsbChwcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nKSB7XG5cdCAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXHQgICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcblx0ICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcblx0ICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsgcnVuVGFzayhpZCk7IH0pO1xuXHRcblx0ICAgICAgICByZXR1cm4gaWQ7XG5cdCAgICAgIH07XG5cdCAgICB9IGVsc2UgaWYgKHBvc3RNZXNzYWdlU3VwcG9ydGVkKCkpIHtcblx0ICAgICAgdmFyIE1TR19QUkVGSVggPSAnbXMucnguc2NoZWR1bGUnICsgTWF0aC5yYW5kb20oKTtcblx0XG5cdCAgICAgIHZhciBvbkdsb2JhbFBvc3RNZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cdCAgICAgICAgLy8gT25seSBpZiB3ZSdyZSBhIG1hdGNoIHRvIGF2b2lkIGFueSBvdGhlciBnbG9iYWwgZXZlbnRzXG5cdCAgICAgICAgaWYgKHR5cGVvZiBldmVudC5kYXRhID09PSAnc3RyaW5nJyAmJiBldmVudC5kYXRhLnN1YnN0cmluZygwLCBNU0dfUFJFRklYLmxlbmd0aCkgPT09IE1TR19QUkVGSVgpIHtcblx0ICAgICAgICAgIHJ1blRhc2soZXZlbnQuZGF0YS5zdWJzdHJpbmcoTVNHX1BSRUZJWC5sZW5ndGgpKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICByb290LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBvbkdsb2JhbFBvc3RNZXNzYWdlLCBmYWxzZSk7XG5cdFxuXHQgICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcblx0ICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG5cdCAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG5cdCAgICAgICAgcm9vdC5wb3N0TWVzc2FnZShNU0dfUFJFRklYICsgY3VycmVudElkLCAnKicpO1xuXHQgICAgICAgIHJldHVybiBpZDtcblx0ICAgICAgfTtcblx0ICAgIH0gZWxzZSBpZiAoISFyb290Lk1lc3NhZ2VDaGFubmVsKSB7XG5cdCAgICAgIHZhciBjaGFubmVsID0gbmV3IHJvb3QuTWVzc2FnZUNoYW5uZWwoKTtcblx0XG5cdCAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsgcnVuVGFzayhlLmRhdGEpOyB9O1xuXHRcblx0ICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG5cdCAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuXHQgICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuXHQgICAgICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoaWQpO1xuXHQgICAgICAgIHJldHVybiBpZDtcblx0ICAgICAgfTtcblx0ICAgIH0gZWxzZSBpZiAoJ2RvY3VtZW50JyBpbiByb290ICYmICdvbnJlYWR5c3RhdGVjaGFuZ2UnIGluIHJvb3QuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0JykpIHtcblx0XG5cdCAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXHQgICAgICAgIHZhciBzY3JpcHRFbGVtZW50ID0gcm9vdC5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcblx0ICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG5cdCAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG5cdFxuXHQgICAgICAgIHNjcmlwdEVsZW1lbnQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgcnVuVGFzayhpZCk7XG5cdCAgICAgICAgICBzY3JpcHRFbGVtZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG5cdCAgICAgICAgICBzY3JpcHRFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0RWxlbWVudCk7XG5cdCAgICAgICAgICBzY3JpcHRFbGVtZW50ID0gbnVsbDtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHJvb3QuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKHNjcmlwdEVsZW1lbnQpO1xuXHQgICAgICAgIHJldHVybiBpZDtcblx0ICAgICAgfTtcblx0XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcblx0ICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG5cdCAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG5cdCAgICAgICAgbG9jYWxTZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIHJ1blRhc2soaWQpO1xuXHQgICAgICAgIH0sIDApO1xuXHRcblx0ICAgICAgICByZXR1cm4gaWQ7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfSgpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogR2V0cyBhIHNjaGVkdWxlciB0aGF0IHNjaGVkdWxlcyB3b3JrIHZpYSBhIHRpbWVkIGNhbGxiYWNrIGJhc2VkIHVwb24gcGxhdGZvcm0uXG5cdCAgICovXG5cdCAgIHZhciBEZWZhdWx0U2NoZWR1bGVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgICBpbmhlcml0cyhEZWZhdWx0U2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuXHQgICAgIGZ1bmN0aW9uIERlZmF1bHRTY2hlZHVsZXIoKSB7XG5cdCAgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICB9XG5cdFxuXHQgICAgIGZ1bmN0aW9uIHNjaGVkdWxlQWN0aW9uKGRpc3Bvc2FibGUsIGFjdGlvbiwgc2NoZWR1bGVyLCBzdGF0ZSkge1xuXHQgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNjaGVkdWxlKCkge1xuXHQgICAgICAgICAhZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkICYmIGRpc3Bvc2FibGUuc2V0RGlzcG9zYWJsZShEaXNwb3NhYmxlLl9maXh1cChhY3Rpb24oc2NoZWR1bGVyLCBzdGF0ZSkpKTtcblx0ICAgICAgIH07XG5cdCAgICAgfVxuXHRcblx0ICAgICBmdW5jdGlvbiBDbGVhckRpc3Bvc2FibGUobWV0aG9kLCBpZCkge1xuXHQgICAgICAgdGhpcy5faWQgPSBpZDtcblx0ICAgICAgIHRoaXMuX21ldGhvZCA9IG1ldGhvZDtcblx0ICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgIH1cblx0XG5cdCAgICAgQ2xlYXJEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICAgdGhpcy5fbWV0aG9kLmNhbGwobnVsbCwgdGhpcy5faWQpO1xuXHQgICAgICAgfVxuXHQgICAgIH07XG5cdFxuXHQgICAgRGVmYXVsdFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuXHQgICAgICB2YXIgZGlzcG9zYWJsZSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLFxuXHQgICAgICAgICAgaWQgPSBzY2hlZHVsZU1ldGhvZChzY2hlZHVsZUFjdGlvbihkaXNwb3NhYmxlLCBhY3Rpb24sIHRoaXMsIHN0YXRlKSk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShkaXNwb3NhYmxlLCBuZXcgQ2xlYXJEaXNwb3NhYmxlKGNsZWFyTWV0aG9kLCBpZCkpO1xuXHQgICAgfTtcblx0XG5cdCAgICBEZWZhdWx0U2NoZWR1bGVyLnByb3RvdHlwZS5fc2NoZWR1bGVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuXHQgICAgICBpZiAoZHVlVGltZSA9PT0gMCkgeyByZXR1cm4gdGhpcy5zY2hlZHVsZShzdGF0ZSwgYWN0aW9uKTsgfVxuXHQgICAgICB2YXIgZGlzcG9zYWJsZSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLFxuXHQgICAgICAgICAgaWQgPSBsb2NhbFNldFRpbWVvdXQoc2NoZWR1bGVBY3Rpb24oZGlzcG9zYWJsZSwgYWN0aW9uLCB0aGlzLCBzdGF0ZSksIGR1ZVRpbWUpO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoZGlzcG9zYWJsZSwgbmV3IENsZWFyRGlzcG9zYWJsZShsb2NhbENsZWFyVGltZW91dCwgaWQpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIERlZmF1bHRTY2hlZHVsZXI7XG5cdCAgfShTY2hlZHVsZXIpKTtcblx0XG5cdCAgdmFyIGRlZmF1bHRTY2hlZHVsZXIgPSBTY2hlZHVsZXJbJ2RlZmF1bHQnXSA9IFNjaGVkdWxlci5hc3luYyA9IG5ldyBEZWZhdWx0U2NoZWR1bGVyKCk7XG5cdFxuXHQgIGZ1bmN0aW9uIEluZGV4ZWRJdGVtKGlkLCB2YWx1ZSkge1xuXHQgICAgdGhpcy5pZCA9IGlkO1xuXHQgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXHQgIH1cblx0XG5cdCAgSW5kZXhlZEl0ZW0ucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xuXHQgICAgdmFyIGMgPSB0aGlzLnZhbHVlLmNvbXBhcmVUbyhvdGhlci52YWx1ZSk7XG5cdCAgICBjID09PSAwICYmIChjID0gdGhpcy5pZCAtIG90aGVyLmlkKTtcblx0ICAgIHJldHVybiBjO1xuXHQgIH07XG5cdFxuXHQgIHZhciBQcmlvcml0eVF1ZXVlID0gUnguaW50ZXJuYWxzLlByaW9yaXR5UXVldWUgPSBmdW5jdGlvbiAoY2FwYWNpdHkpIHtcblx0ICAgIHRoaXMuaXRlbXMgPSBuZXcgQXJyYXkoY2FwYWNpdHkpO1xuXHQgICAgdGhpcy5sZW5ndGggPSAwO1xuXHQgIH07XG5cdFxuXHQgIHZhciBwcmlvcml0eVByb3RvID0gUHJpb3JpdHlRdWV1ZS5wcm90b3R5cGU7XG5cdCAgcHJpb3JpdHlQcm90by5pc0hpZ2hlclByaW9yaXR5ID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XG5cdCAgICByZXR1cm4gdGhpcy5pdGVtc1tsZWZ0XS5jb21wYXJlVG8odGhpcy5pdGVtc1tyaWdodF0pIDwgMDtcblx0ICB9O1xuXHRcblx0ICBwcmlvcml0eVByb3RvLnBlcmNvbGF0ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuXHQgICAgaWYgKGluZGV4ID49IHRoaXMubGVuZ3RoIHx8IGluZGV4IDwgMCkgeyByZXR1cm47IH1cblx0ICAgIHZhciBwYXJlbnQgPSBpbmRleCAtIDEgPj4gMTtcblx0ICAgIGlmIChwYXJlbnQgPCAwIHx8IHBhcmVudCA9PT0gaW5kZXgpIHsgcmV0dXJuOyB9XG5cdCAgICBpZiAodGhpcy5pc0hpZ2hlclByaW9yaXR5KGluZGV4LCBwYXJlbnQpKSB7XG5cdCAgICAgIHZhciB0ZW1wID0gdGhpcy5pdGVtc1tpbmRleF07XG5cdCAgICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gdGhpcy5pdGVtc1twYXJlbnRdO1xuXHQgICAgICB0aGlzLml0ZW1zW3BhcmVudF0gPSB0ZW1wO1xuXHQgICAgICB0aGlzLnBlcmNvbGF0ZShwYXJlbnQpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIHByaW9yaXR5UHJvdG8uaGVhcGlmeSA9IGZ1bmN0aW9uIChpbmRleCkge1xuXHQgICAgK2luZGV4IHx8IChpbmRleCA9IDApO1xuXHQgICAgaWYgKGluZGV4ID49IHRoaXMubGVuZ3RoIHx8IGluZGV4IDwgMCkgeyByZXR1cm47IH1cblx0ICAgIHZhciBsZWZ0ID0gMiAqIGluZGV4ICsgMSxcblx0ICAgICAgICByaWdodCA9IDIgKiBpbmRleCArIDIsXG5cdCAgICAgICAgZmlyc3QgPSBpbmRleDtcblx0ICAgIGlmIChsZWZ0IDwgdGhpcy5sZW5ndGggJiYgdGhpcy5pc0hpZ2hlclByaW9yaXR5KGxlZnQsIGZpcnN0KSkge1xuXHQgICAgICBmaXJzdCA9IGxlZnQ7XG5cdCAgICB9XG5cdCAgICBpZiAocmlnaHQgPCB0aGlzLmxlbmd0aCAmJiB0aGlzLmlzSGlnaGVyUHJpb3JpdHkocmlnaHQsIGZpcnN0KSkge1xuXHQgICAgICBmaXJzdCA9IHJpZ2h0O1xuXHQgICAgfVxuXHQgICAgaWYgKGZpcnN0ICE9PSBpbmRleCkge1xuXHQgICAgICB2YXIgdGVtcCA9IHRoaXMuaXRlbXNbaW5kZXhdO1xuXHQgICAgICB0aGlzLml0ZW1zW2luZGV4XSA9IHRoaXMuaXRlbXNbZmlyc3RdO1xuXHQgICAgICB0aGlzLml0ZW1zW2ZpcnN0XSA9IHRlbXA7XG5cdCAgICAgIHRoaXMuaGVhcGlmeShmaXJzdCk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgcHJpb3JpdHlQcm90by5wZWVrID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5pdGVtc1swXS52YWx1ZTsgfTtcblx0XG5cdCAgcHJpb3JpdHlQcm90by5yZW1vdmVBdCA9IGZ1bmN0aW9uIChpbmRleCkge1xuXHQgICAgdGhpcy5pdGVtc1tpbmRleF0gPSB0aGlzLml0ZW1zWy0tdGhpcy5sZW5ndGhdO1xuXHQgICAgdGhpcy5pdGVtc1t0aGlzLmxlbmd0aF0gPSB1bmRlZmluZWQ7XG5cdCAgICB0aGlzLmhlYXBpZnkoKTtcblx0ICB9O1xuXHRcblx0ICBwcmlvcml0eVByb3RvLmRlcXVldWUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgcmVzdWx0ID0gdGhpcy5wZWVrKCk7XG5cdCAgICB0aGlzLnJlbW92ZUF0KDApO1xuXHQgICAgcmV0dXJuIHJlc3VsdDtcblx0ICB9O1xuXHRcblx0ICBwcmlvcml0eVByb3RvLmVucXVldWUgPSBmdW5jdGlvbiAoaXRlbSkge1xuXHQgICAgdmFyIGluZGV4ID0gdGhpcy5sZW5ndGgrKztcblx0ICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gbmV3IEluZGV4ZWRJdGVtKFByaW9yaXR5UXVldWUuY291bnQrKywgaXRlbSk7XG5cdCAgICB0aGlzLnBlcmNvbGF0ZShpbmRleCk7XG5cdCAgfTtcblx0XG5cdCAgcHJpb3JpdHlQcm90by5yZW1vdmUgPSBmdW5jdGlvbiAoaXRlbSkge1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIGlmICh0aGlzLml0ZW1zW2ldLnZhbHVlID09PSBpdGVtKSB7XG5cdCAgICAgICAgdGhpcy5yZW1vdmVBdChpKTtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIGZhbHNlO1xuXHQgIH07XG5cdCAgUHJpb3JpdHlRdWV1ZS5jb3VudCA9IDA7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXByZXNlbnRzIGEgbm90aWZpY2F0aW9uIHRvIGFuIG9ic2VydmVyLlxuXHQgICAqL1xuXHQgIHZhciBOb3RpZmljYXRpb24gPSBSeC5Ob3RpZmljYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gTm90aWZpY2F0aW9uKCkge1xuXHRcblx0ICAgIH1cblx0XG5cdCAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHQgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuXHQgICAgfTtcblx0XG5cdCAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHRPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXJyb3IoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBJbnZva2VzIHRoZSBkZWxlZ2F0ZSBjb3JyZXNwb25kaW5nIHRvIHRoZSBub3RpZmljYXRpb24gb3IgdGhlIG9ic2VydmVyJ3MgbWV0aG9kIGNvcnJlc3BvbmRpbmcgdG8gdGhlIG5vdGlmaWNhdGlvbiBhbmQgcmV0dXJucyB0aGUgcHJvZHVjZWQgcmVzdWx0LlxuXHQgICAgICpcblx0ICAgICAqIEBtZW1iZXJPZiBOb3RpZmljYXRpb25cblx0ICAgICAqIEBwYXJhbSB7QW55fSBvYnNlcnZlck9yT25OZXh0IERlbGVnYXRlIHRvIGludm9rZSBmb3IgYW4gT25OZXh0IG5vdGlmaWNhdGlvbiBvciBPYnNlcnZlciB0byBpbnZva2UgdGhlIG5vdGlmaWNhdGlvbiBvbi4uXG5cdCAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkVycm9yIERlbGVnYXRlIHRvIGludm9rZSBmb3IgYW4gT25FcnJvciBub3RpZmljYXRpb24uXG5cdCAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkNvbXBsZXRlZCBEZWxlZ2F0ZSB0byBpbnZva2UgZm9yIGFuIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbi5cblx0ICAgICAqIEByZXR1cm5zIHtBbnl9IFJlc3VsdCBwcm9kdWNlZCBieSB0aGUgb2JzZXJ2YXRpb24uXG5cdCAgICAgKi9cblx0ICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gKG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICAgIHJldHVybiBvYnNlcnZlck9yT25OZXh0ICYmIHR5cGVvZiBvYnNlcnZlck9yT25OZXh0ID09PSAnb2JqZWN0JyA/XG5cdCAgICAgICAgdGhpcy5fYWNjZXB0T2JzZXJ2YWJsZShvYnNlcnZlck9yT25OZXh0KSA6XG5cdCAgICAgICAgdGhpcy5fYWNjZXB0KG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCBhIHNpbmdsZSBub3RpZmljYXRpb24uXG5cdCAgICAgKlxuXHQgICAgICogQG1lbWJlck9mIE5vdGlmaWNhdGlvbnNcblx0ICAgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gc2VuZCBvdXQgdGhlIG5vdGlmaWNhdGlvbiBjYWxscyBvbi5cblx0ICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHN1cmZhY2VzIHRoZSBiZWhhdmlvciBvZiB0aGUgbm90aWZpY2F0aW9uIHVwb24gc3Vic2NyaXB0aW9uLlxuXHQgICAgICovXG5cdCAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLnRvT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChzY2hlZHVsZXIpIHtcblx0ICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXIpO1xuXHQgICAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKHNlbGYsIGZ1bmN0aW9uIChfLCBub3RpZmljYXRpb24pIHtcblx0ICAgICAgICAgIG5vdGlmaWNhdGlvbi5fYWNjZXB0T2JzZXJ2YWJsZShvKTtcblx0ICAgICAgICAgIG5vdGlmaWNhdGlvbi5raW5kID09PSAnTicgJiYgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9KTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE5vdGlmaWNhdGlvbjtcblx0ICB9KSgpO1xuXHRcblx0ICB2YXIgT25OZXh0Tm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE9uTmV4dE5vdGlmaWNhdGlvbiwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE9uTmV4dE5vdGlmaWNhdGlvbih2YWx1ZSkge1xuXHQgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cdCAgICAgIHRoaXMua2luZCA9ICdOJztcblx0ICAgIH1cblx0XG5cdCAgICBPbk5leHROb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHQgPSBmdW5jdGlvbiAob25OZXh0KSB7XG5cdCAgICAgIHJldHVybiBvbk5leHQodGhpcy52YWx1ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIE9uTmV4dE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gby5vbk5leHQodGhpcy52YWx1ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIE9uTmV4dE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiAnT25OZXh0KCcgKyB0aGlzLnZhbHVlICsgJyknO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gT25OZXh0Tm90aWZpY2F0aW9uO1xuXHQgIH0oTm90aWZpY2F0aW9uKSk7XG5cdFxuXHQgIHZhciBPbkVycm9yTm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE9uRXJyb3JOb3RpZmljYXRpb24sIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBPbkVycm9yTm90aWZpY2F0aW9uKGVycm9yKSB7XG5cdCAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblx0ICAgICAgdGhpcy5raW5kID0gJ0UnO1xuXHQgICAgfVxuXHRcblx0ICAgIE9uRXJyb3JOb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHQgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yKSB7XG5cdCAgICAgIHJldHVybiBvbkVycm9yKHRoaXMuZXJyb3IpO1xuXHQgICAgfTtcblx0XG5cdCAgICBPbkVycm9yTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiBvLm9uRXJyb3IodGhpcy5lcnJvcik7XG5cdCAgICB9O1xuXHRcblx0ICAgIE9uRXJyb3JOb3RpZmljYXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gJ09uRXJyb3IoJyArIHRoaXMuZXJyb3IgKyAnKSc7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBPbkVycm9yTm90aWZpY2F0aW9uO1xuXHQgIH0oTm90aWZpY2F0aW9uKSk7XG5cdFxuXHQgIHZhciBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbiwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uKCkge1xuXHQgICAgICB0aGlzLmtpbmQgPSAnQyc7XG5cdCAgICB9XG5cdFxuXHQgICAgT25Db21wbGV0ZWROb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHQgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgICByZXR1cm4gb25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgT25Db21wbGV0ZWROb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHRPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgT25Db21wbGV0ZWROb3RpZmljYXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gJ09uQ29tcGxldGVkKCknO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gT25Db21wbGV0ZWROb3RpZmljYXRpb247XG5cdCAgfShOb3RpZmljYXRpb24pKTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ3JlYXRlcyBhbiBvYmplY3QgdGhhdCByZXByZXNlbnRzIGFuIE9uTmV4dCBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG5cdCAgICogQHBhcmFtIHtBbnl9IHZhbHVlIFRoZSB2YWx1ZSBjb250YWluZWQgaW4gdGhlIG5vdGlmaWNhdGlvbi5cblx0ICAgKiBAcmV0dXJucyB7Tm90aWZpY2F0aW9ufSBUaGUgT25OZXh0IG5vdGlmaWNhdGlvbiBjb250YWluaW5nIHRoZSB2YWx1ZS5cblx0ICAgKi9cblx0ICB2YXIgbm90aWZpY2F0aW9uQ3JlYXRlT25OZXh0ID0gTm90aWZpY2F0aW9uLmNyZWF0ZU9uTmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgcmV0dXJuIG5ldyBPbk5leHROb3RpZmljYXRpb24odmFsdWUpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhbiBPbkVycm9yIG5vdGlmaWNhdGlvbiB0byBhbiBvYnNlcnZlci5cblx0ICAgKiBAcGFyYW0ge0FueX0gZXJyb3IgVGhlIGV4Y2VwdGlvbiBjb250YWluZWQgaW4gdGhlIG5vdGlmaWNhdGlvbi5cblx0ICAgKiBAcmV0dXJucyB7Tm90aWZpY2F0aW9ufSBUaGUgT25FcnJvciBub3RpZmljYXRpb24gY29udGFpbmluZyB0aGUgZXhjZXB0aW9uLlxuXHQgICAqL1xuXHQgIHZhciBub3RpZmljYXRpb25DcmVhdGVPbkVycm9yID0gTm90aWZpY2F0aW9uLmNyZWF0ZU9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgIHJldHVybiBuZXcgT25FcnJvck5vdGlmaWNhdGlvbihlcnJvcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ3JlYXRlcyBhbiBvYmplY3QgdGhhdCByZXByZXNlbnRzIGFuIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbiB0byBhbiBvYnNlcnZlci5cblx0ICAgKiBAcmV0dXJucyB7Tm90aWZpY2F0aW9ufSBUaGUgT25Db21wbGV0ZWQgbm90aWZpY2F0aW9uLlxuXHQgICAqL1xuXHQgIHZhciBub3RpZmljYXRpb25DcmVhdGVPbkNvbXBsZXRlZCA9IE5vdGlmaWNhdGlvbi5jcmVhdGVPbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgT25Db21wbGV0ZWROb3RpZmljYXRpb24oKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBTdXBwb3J0cyBwdXNoLXN0eWxlIGl0ZXJhdGlvbiBvdmVyIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgdmFyIE9ic2VydmVyID0gUnguT2JzZXJ2ZXIgPSBmdW5jdGlvbiAoKSB7IH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBDcmVhdGVzIGFuIG9ic2VydmVyIGZyb20gdGhlIHNwZWNpZmllZCBPbk5leHQsIGFsb25nIHdpdGggb3B0aW9uYWwgT25FcnJvciwgYW5kIE9uQ29tcGxldGVkIGFjdGlvbnMuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uTmV4dF0gT2JzZXJ2ZXIncyBPbk5leHQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkVycm9yXSBPYnNlcnZlcidzIE9uRXJyb3IgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkNvbXBsZXRlZF0gT2JzZXJ2ZXIncyBPbkNvbXBsZXRlZCBhY3Rpb24gaW1wbGVtZW50YXRpb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmVyfSBUaGUgb2JzZXJ2ZXIgb2JqZWN0IGltcGxlbWVudGVkIHVzaW5nIHRoZSBnaXZlbiBhY3Rpb25zLlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZlckNyZWF0ZSA9IE9ic2VydmVyLmNyZWF0ZSA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICBvbk5leHQgfHwgKG9uTmV4dCA9IG5vb3ApO1xuXHQgICAgb25FcnJvciB8fCAob25FcnJvciA9IGRlZmF1bHRFcnJvcik7XG5cdCAgICBvbkNvbXBsZXRlZCB8fCAob25Db21wbGV0ZWQgPSBub29wKTtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2ZXIob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQWJzdHJhY3QgYmFzZSBjbGFzcyBmb3IgaW1wbGVtZW50YXRpb25zIG9mIHRoZSBPYnNlcnZlciBjbGFzcy5cblx0ICAgKiBUaGlzIGJhc2UgY2xhc3MgZW5mb3JjZXMgdGhlIGdyYW1tYXIgb2Ygb2JzZXJ2ZXJzIHdoZXJlIE9uRXJyb3IgYW5kIE9uQ29tcGxldGVkIGFyZSB0ZXJtaW5hbCBtZXNzYWdlcy5cblx0ICAgKi9cblx0ICB2YXIgQWJzdHJhY3RPYnNlcnZlciA9IFJ4LmludGVybmFscy5BYnN0cmFjdE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEFic3RyYWN0T2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDcmVhdGVzIGEgbmV3IG9ic2VydmVyIGluIGEgbm9uLXN0b3BwZWQgc3RhdGUuXG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIEFic3RyYWN0T2JzZXJ2ZXIoKSB7XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gTXVzdCBiZSBpbXBsZW1lbnRlZCBieSBvdGhlciBvYnNlcnZlcnNcblx0ICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBub3RJbXBsZW1lbnRlZDtcblx0ICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gbm90SW1wbGVtZW50ZWQ7XG5cdCAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBub3RJbXBsZW1lbnRlZDtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIE5vdGlmaWVzIHRoZSBvYnNlcnZlciBvZiBhIG5ldyBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAqIEBwYXJhbSB7QW55fSB2YWx1ZSBOZXh0IGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuXHQgICAgICovXG5cdCAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgIXRoaXMuaXNTdG9wcGVkICYmIHRoaXMubmV4dCh2YWx1ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogTm90aWZpZXMgdGhlIG9ic2VydmVyIHRoYXQgYW4gZXhjZXB0aW9uIGhhcyBvY2N1cnJlZC5cblx0ICAgICAqIEBwYXJhbSB7QW55fSBlcnJvciBUaGUgZXJyb3IgdGhhdCBoYXMgb2NjdXJyZWQuXG5cdCAgICAgKi9cblx0ICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmVycm9yKGVycm9yKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIE5vdGlmaWVzIHRoZSBvYnNlcnZlciBvZiB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAqL1xuXHQgICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5jb21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIERpc3Bvc2VzIHRoZSBvYnNlcnZlciwgY2F1c2luZyBpdCB0byB0cmFuc2l0aW9uIHRvIHRoZSBzdG9wcGVkIHN0YXRlLlxuXHQgICAgICovXG5cdCAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cdFxuXHQgICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5lcnJvcihlKTtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQWJzdHJhY3RPYnNlcnZlcjtcblx0ICB9KE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIENsYXNzIHRvIGNyZWF0ZSBhbiBPYnNlcnZlciBpbnN0YW5jZSBmcm9tIGRlbGVnYXRlLWJhc2VkIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgb24qIG1ldGhvZHMuXG5cdCAgICovXG5cdCAgdmFyIEFub255bW91c09ic2VydmVyID0gUnguQW5vbnltb3VzT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQW5vbnltb3VzT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDcmVhdGVzIGFuIG9ic2VydmVyIGZyb20gdGhlIHNwZWNpZmllZCBPbk5leHQsIE9uRXJyb3IsIGFuZCBPbkNvbXBsZXRlZCBhY3Rpb25zLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IG9uTmV4dCBPYnNlcnZlcidzIE9uTmV4dCBhY3Rpb24gaW1wbGVtZW50YXRpb24uXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gb25FcnJvciBPYnNlcnZlcidzIE9uRXJyb3IgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IG9uQ29tcGxldGVkIE9ic2VydmVyJ3MgT25Db21wbGV0ZWQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBBbm9ueW1vdXNPYnNlcnZlcihvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLl9vbk5leHQgPSBvbk5leHQ7XG5cdCAgICAgIHRoaXMuX29uRXJyb3IgPSBvbkVycm9yO1xuXHQgICAgICB0aGlzLl9vbkNvbXBsZXRlZCA9IG9uQ29tcGxldGVkO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ2FsbHMgdGhlIG9uTmV4dCBhY3Rpb24uXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gdmFsdWUgTmV4dCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAqL1xuXHQgICAgQW5vbnltb3VzT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgdGhpcy5fb25OZXh0KHZhbHVlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDYWxscyB0aGUgb25FcnJvciBhY3Rpb24uXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gZXJyb3IgVGhlIGVycm9yIHRoYXQgaGFzIG9jY3VycmVkLlxuXHQgICAgICovXG5cdCAgICBBbm9ueW1vdXNPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgdGhpcy5fb25FcnJvcihlcnJvcik7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogIENhbGxzIHRoZSBvbkNvbXBsZXRlZCBhY3Rpb24uXG5cdCAgICAgKi9cblx0ICAgIEFub255bW91c09ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX29uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBBbm9ueW1vdXNPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgdmFyIG9ic2VydmFibGVQcm90bztcblx0XG5cdCAgLyoqXG5cdCAgICogUmVwcmVzZW50cyBhIHB1c2gtc3R5bGUgY29sbGVjdGlvbi5cblx0ICAgKi9cblx0ICB2YXIgT2JzZXJ2YWJsZSA9IFJ4Lk9ic2VydmFibGUgPSAoZnVuY3Rpb24gKCkge1xuXHRcblx0ICAgIGZ1bmN0aW9uIG1ha2VTdWJzY3JpYmUoc2VsZiwgc3Vic2NyaWJlKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAobykge1xuXHQgICAgICAgIHZhciBvbGRPbkVycm9yID0gby5vbkVycm9yO1xuXHQgICAgICAgIG8ub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgICBtYWtlU3RhY2tUcmFjZUxvbmcoZSwgc2VsZik7XG5cdCAgICAgICAgICBvbGRPbkVycm9yLmNhbGwobywgZSk7XG5cdCAgICAgICAgfTtcblx0XG5cdCAgICAgICAgcmV0dXJuIHN1YnNjcmliZS5jYWxsKHNlbGYsIG8pO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIE9ic2VydmFibGUoKSB7XG5cdCAgICAgIGlmIChSeC5jb25maWcubG9uZ1N0YWNrU3VwcG9ydCAmJiBoYXNTdGFja3MpIHtcblx0ICAgICAgICB2YXIgb2xkU3Vic2NyaWJlID0gdGhpcy5fc3Vic2NyaWJlO1xuXHQgICAgICAgIHZhciBlID0gdHJ5Q2F0Y2godGhyb3dlcikobmV3IEVycm9yKCkpLmU7XG5cdCAgICAgICAgdGhpcy5zdGFjayA9IGUuc3RhY2suc3Vic3RyaW5nKGUuc3RhY2suaW5kZXhPZignXFxuJykgKyAxKTtcblx0ICAgICAgICB0aGlzLl9zdWJzY3JpYmUgPSBtYWtlU3Vic2NyaWJlKHRoaXMsIG9sZFN1YnNjcmliZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBvYnNlcnZhYmxlUHJvdG8gPSBPYnNlcnZhYmxlLnByb3RvdHlwZTtcblx0XG5cdCAgICAvKipcblx0ICAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBnaXZlbiBvYmplY3QgaXMgYW4gT2JzZXJ2YWJsZVxuXHQgICAgKiBAcGFyYW0ge0FueX0gQW4gb2JqZWN0IHRvIGRldGVybWluZSB3aGV0aGVyIGl0IGlzIGFuIE9ic2VydmFibGVcblx0ICAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgaWYgYW4gT2JzZXJ2YWJsZSwgZWxzZSBmYWxzZS5cblx0ICAgICovXG5cdCAgICBPYnNlcnZhYmxlLmlzT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiBvICYmIGlzRnVuY3Rpb24oby5zdWJzY3JpYmUpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqICBTdWJzY3JpYmVzIGFuIG8gdG8gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICAgKiAgQHBhcmFtIHtNaXhlZH0gW29Pck9uTmV4dF0gVGhlIG9iamVjdCB0aGF0IGlzIHRvIHJlY2VpdmUgbm90aWZpY2F0aW9ucyBvciBhbiBhY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICAgKiAgQHBhcmFtIHtGdW5jdGlvbn0gW29uRXJyb3JdIEFjdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgICAqICBAcGFyYW0ge0Z1bmN0aW9ufSBbb25Db21wbGV0ZWRdIEFjdGlvbiB0byBpbnZva2UgdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgICAqICBAcmV0dXJucyB7RGlwb3NhYmxlfSBBIGRpc3Bvc2FibGUgaGFuZGxpbmcgdGhlIHN1YnNjcmlwdGlvbnMgYW5kIHVuc3Vic2NyaXB0aW9ucy5cblx0ICAgICAqL1xuXHQgICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZSA9IG9ic2VydmFibGVQcm90by5mb3JFYWNoID0gZnVuY3Rpb24gKG9Pck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZSh0eXBlb2Ygb09yT25OZXh0ID09PSAnb2JqZWN0JyA/XG5cdCAgICAgICAgb09yT25OZXh0IDpcblx0ICAgICAgICBvYnNlcnZlckNyZWF0ZShvT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU3Vic2NyaWJlcyB0byB0aGUgbmV4dCB2YWx1ZSBpbiB0aGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBcInRoaXNcIiBhcmd1bWVudC5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uTmV4dCBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIG9uIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IEEgZGlzcG9zYWJsZSBoYW5kbGluZyB0aGUgc3Vic2NyaXB0aW9ucyBhbmQgdW5zdWJzY3JpcHRpb25zLlxuXHQgICAgICovXG5cdCAgICBvYnNlcnZhYmxlUHJvdG8uc3Vic2NyaWJlT25OZXh0ID0gZnVuY3Rpb24gKG9uTmV4dCwgdGhpc0FyZykge1xuXHQgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKG9ic2VydmVyQ3JlYXRlKHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uKHgpIHsgb25OZXh0LmNhbGwodGhpc0FyZywgeCk7IH0gOiBvbk5leHQpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTdWJzY3JpYmVzIHRvIGFuIGV4Y2VwdGlvbmFsIGNvbmRpdGlvbiBpbiB0aGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBcInRoaXNcIiBhcmd1bWVudC5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRXJyb3IgVGhlIGZ1bmN0aW9uIHRvIGludm9rZSB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG5cdCAgICAgKi9cblx0ICAgIG9ic2VydmFibGVQcm90by5zdWJzY3JpYmVPbkVycm9yID0gZnVuY3Rpb24gKG9uRXJyb3IsIHRoaXNBcmcpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShvYnNlcnZlckNyZWF0ZShudWxsLCB0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbihlKSB7IG9uRXJyb3IuY2FsbCh0aGlzQXJnLCBlKTsgfSA6IG9uRXJyb3IpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTdWJzY3JpYmVzIHRvIHRoZSBuZXh0IHZhbHVlIGluIHRoZSBzZXF1ZW5jZSB3aXRoIGFuIG9wdGlvbmFsIFwidGhpc1wiIGFyZ3VtZW50LlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25Db21wbGV0ZWQgVGhlIGZ1bmN0aW9uIHRvIGludm9rZSB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG5cdCAgICAgKi9cblx0ICAgIG9ic2VydmFibGVQcm90by5zdWJzY3JpYmVPbkNvbXBsZXRlZCA9IGZ1bmN0aW9uIChvbkNvbXBsZXRlZCwgdGhpc0FyZykge1xuXHQgICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKG9ic2VydmVyQ3JlYXRlKG51bGwsIG51bGwsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uKCkgeyBvbkNvbXBsZXRlZC5jYWxsKHRoaXNBcmcpOyB9IDogb25Db21wbGV0ZWQpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE9ic2VydmFibGU7XG5cdCAgfSkoKTtcblx0XG5cdCAgdmFyIFNjaGVkdWxlZE9ic2VydmVyID0gUnguaW50ZXJuYWxzLlNjaGVkdWxlZE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNjaGVkdWxlZE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFNjaGVkdWxlZE9ic2VydmVyKHNjaGVkdWxlciwgb2JzZXJ2ZXIpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICAgIHRoaXMuaXNBY3F1aXJlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmhhc0ZhdWx0ZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuXHQgICAgICB0aGlzLmRpc3Bvc2FibGUgPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgdGhpcy5xdWV1ZS5wdXNoKGZ1bmN0aW9uICgpIHsgc2VsZi5vYnNlcnZlci5vbk5leHQodmFsdWUpOyB9KTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICB0aGlzLnF1ZXVlLnB1c2goZnVuY3Rpb24gKCkgeyBzZWxmLm9ic2VydmVyLm9uRXJyb3IoZSk7IH0pO1xuXHQgICAgfTtcblx0XG5cdCAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgIHRoaXMucXVldWUucHVzaChmdW5jdGlvbiAoKSB7IHNlbGYub2JzZXJ2ZXIub25Db21wbGV0ZWQoKTsgfSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5lbnN1cmVBY3RpdmUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciBpc093bmVyID0gZmFsc2U7XG5cdCAgICAgIGlmICghdGhpcy5oYXNGYXVsdGVkICYmIHRoaXMucXVldWUubGVuZ3RoID4gMCkge1xuXHQgICAgICAgIGlzT3duZXIgPSAhdGhpcy5pc0FjcXVpcmVkO1xuXHQgICAgICAgIHRoaXMuaXNBY3F1aXJlZCA9IHRydWU7XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKGlzT3duZXIpIHtcblx0ICAgICAgICB0aGlzLmRpc3Bvc2FibGUuc2V0RGlzcG9zYWJsZSh0aGlzLnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSh0aGlzLCBmdW5jdGlvbiAocGFyZW50LCBzZWxmKSB7XG5cdCAgICAgICAgICB2YXIgd29yaztcblx0ICAgICAgICAgIGlmIChwYXJlbnQucXVldWUubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgICB3b3JrID0gcGFyZW50LnF1ZXVlLnNoaWZ0KCk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBwYXJlbnQuaXNBY3F1aXJlZCA9IGZhbHNlO1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2god29yaykoKTtcblx0ICAgICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7XG5cdCAgICAgICAgICAgIHBhcmVudC5xdWV1ZSA9IFtdO1xuXHQgICAgICAgICAgICBwYXJlbnQuaGFzRmF1bHRlZCA9IHRydWU7XG5cdCAgICAgICAgICAgIHJldHVybiB0aHJvd2VyKHJlcy5lKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIHNlbGYocGFyZW50KTtcblx0ICAgICAgICB9KSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLmRpc3Bvc2FibGUuZGlzcG9zZSgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2NoZWR1bGVkT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIHZhciBPYnNlcnZhYmxlQmFzZSA9IFJ4Lk9ic2VydmFibGVCYXNlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE9ic2VydmFibGVCYXNlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIGZpeFN1YnNjcmliZXIoc3Vic2NyaWJlcikge1xuXHQgICAgICByZXR1cm4gc3Vic2NyaWJlciAmJiBpc0Z1bmN0aW9uKHN1YnNjcmliZXIuZGlzcG9zZSkgPyBzdWJzY3JpYmVyIDpcblx0ICAgICAgICBpc0Z1bmN0aW9uKHN1YnNjcmliZXIpID8gZGlzcG9zYWJsZUNyZWF0ZShzdWJzY3JpYmVyKSA6IGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzZXREaXNwb3NhYmxlKHMsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBhZG8gPSBzdGF0ZVswXSwgc2VsZiA9IHN0YXRlWzFdO1xuXHQgICAgICB2YXIgc3ViID0gdHJ5Q2F0Y2goc2VsZi5zdWJzY3JpYmVDb3JlKS5jYWxsKHNlbGYsIGFkbyk7XG5cdCAgICAgIGlmIChzdWIgPT09IGVycm9yT2JqICYmICFhZG8uZmFpbChlcnJvck9iai5lKSkgeyB0aHJvd2VyKGVycm9yT2JqLmUpOyB9XG5cdCAgICAgIGFkby5zZXREaXNwb3NhYmxlKGZpeFN1YnNjcmliZXIoc3ViKSk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gT2JzZXJ2YWJsZUJhc2UoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIE9ic2VydmFibGVCYXNlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGFkbyA9IG5ldyBBdXRvRGV0YWNoT2JzZXJ2ZXIobyksIHN0YXRlID0gW2FkbywgdGhpc107XG5cdFxuXHQgICAgICBpZiAoY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlcXVpcmVkKCkpIHtcblx0ICAgICAgICBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlKHN0YXRlLCBzZXREaXNwb3NhYmxlKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBzZXREaXNwb3NhYmxlKG51bGwsIHN0YXRlKTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gYWRvO1xuXHQgICAgfTtcblx0XG5cdCAgICBPYnNlcnZhYmxlQmFzZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IG5vdEltcGxlbWVudGVkO1xuXHRcblx0ICAgIHJldHVybiBPYnNlcnZhYmxlQmFzZTtcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdHZhciBGbGF0TWFwT2JzZXJ2YWJsZSA9IFJ4LkZsYXRNYXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHRcblx0ICAgIGluaGVyaXRzKEZsYXRNYXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIEZsYXRNYXBPYnNlcnZhYmxlKHNvdXJjZSwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdCAgICAgIHRoaXMucmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKHJlc3VsdFNlbGVjdG9yKSA/IHJlc3VsdFNlbGVjdG9yIDogbnVsbDtcblx0ICAgICAgdGhpcy5zZWxlY3RvciA9IGJpbmRDYWxsYmFjayhpc0Z1bmN0aW9uKHNlbGVjdG9yKSA/IHNlbGVjdG9yIDogZnVuY3Rpb24oKSB7IHJldHVybiBzZWxlY3RvcjsgfSwgdGhpc0FyZywgMyk7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBGbGF0TWFwT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnNlbGVjdG9yLCB0aGlzLnJlc3VsdFNlbGVjdG9yLCB0aGlzKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvYnNlcnZlciwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCBzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5pID0gMDtcblx0ICAgICAgdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yO1xuXHQgICAgICB0aGlzLnJlc3VsdFNlbGVjdG9yID0gcmVzdWx0U2VsZWN0b3I7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLm8gPSBvYnNlcnZlcjtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLl93cmFwUmVzdWx0ID0gZnVuY3Rpb24ocmVzdWx0LCB4LCBpKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnJlc3VsdFNlbGVjdG9yID9cblx0ICAgICAgICByZXN1bHQubWFwKGZ1bmN0aW9uKHksIGkyKSB7IHJldHVybiB0aGlzLnJlc3VsdFNlbGVjdG9yKHgsIHksIGksIGkyKTsgfSwgdGhpcykgOlxuXHQgICAgICAgIHJlc3VsdDtcblx0ICAgIH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHgpIHtcblx0ICAgICAgdmFyIGkgPSB0aGlzLmkrKztcblx0ICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuc2VsZWN0b3IpKHgsIGksIHRoaXMuc291cmNlKTtcblx0ICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuXHRcblx0ICAgICAgaXNQcm9taXNlKHJlc3VsdCkgJiYgKHJlc3VsdCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShyZXN1bHQpKTtcblx0ICAgICAgKGlzQXJyYXlMaWtlKHJlc3VsdCkgfHwgaXNJdGVyYWJsZShyZXN1bHQpKSAmJiAocmVzdWx0ID0gT2JzZXJ2YWJsZS5mcm9tKHJlc3VsdCkpO1xuXHQgICAgICB0aGlzLm8ub25OZXh0KHRoaXMuX3dyYXBSZXN1bHQocmVzdWx0LCB4LCBpKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24oZSkgeyB0aGlzLm8ub25FcnJvcihlKTsgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkgeyB0aGlzLm8ub25Db21wbGV0ZWQoKTsgfTtcblx0XG5cdCAgICByZXR1cm4gRmxhdE1hcE9ic2VydmFibGU7XG5cdFxuXHR9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBFbnVtZXJhYmxlID0gUnguaW50ZXJuYWxzLkVudW1lcmFibGUgPSBmdW5jdGlvbiAoKSB7IH07XG5cdFxuXHQgIGZ1bmN0aW9uIElzRGlzcG9zZWREaXNwb3NhYmxlKHN0YXRlKSB7XG5cdCAgICB0aGlzLl9zID0gc3RhdGU7XG5cdCAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICB9XG5cdFxuXHQgIElzRGlzcG9zZWREaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5fcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICB2YXIgQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlKHNvdXJjZXMpIHtcblx0ICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlcztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgc3RhdGUgPSB7IGlzRGlzcG9zZWQ6IGZhbHNlIH0sIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cdCAgICAgIHZhciBjYW5jZWxhYmxlID0gY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSh0aGlzLnNvdXJjZXNbJGl0ZXJhdG9yJF0oKSwgZnVuY3Rpb24gKGUsIHNlbGYpIHtcblx0ICAgICAgICBpZiAoc3RhdGUuaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSB0cnlDYXRjaChlLm5leHQpLmNhbGwoZSk7XG5cdCAgICAgICAgaWYgKGN1cnJlbnRJdGVtID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKGN1cnJlbnRJdGVtLmUpOyB9XG5cdFxuXHQgICAgICAgIGlmIChjdXJyZW50SXRlbS5kb25lKSB7XG5cdCAgICAgICAgICByZXR1cm4gby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gQ2hlY2sgaWYgcHJvbWlzZVxuXHQgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcblx0ICAgICAgICBpc1Byb21pc2UoY3VycmVudFZhbHVlKSAmJiAoY3VycmVudFZhbHVlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGN1cnJlbnRWYWx1ZSkpO1xuXHRcblx0ICAgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICAgIGQuc2V0RGlzcG9zYWJsZShjdXJyZW50VmFsdWUuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHNlbGYsIGUpKSk7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShbc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlLCBuZXcgSXNEaXNwb3NlZERpc3Bvc2FibGUoc3RhdGUpXSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBzLCBlKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9zID0gcztcblx0ICAgICAgdGhpcy5fZSA9IGU7XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KHgpOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9zKHRoaXMuX2UpOyB9O1xuXHRcblx0ICAgIHJldHVybiBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIEVudW1lcmFibGUucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUodGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIENhdGNoRXJyb3JPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ2F0Y2hFcnJvck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDYXRjaEVycm9yT2JzZXJ2YWJsZShzb3VyY2VzKSB7XG5cdCAgICAgIHRoaXMuc291cmNlcyA9IHNvdXJjZXM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIENhdGNoRXJyb3JPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGUgPSB0aGlzLnNvdXJjZXNbJGl0ZXJhdG9yJF0oKTtcblx0XG5cdCAgICAgIHZhciBzdGF0ZSA9IHsgaXNEaXNwb3NlZDogZmFsc2UgfSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblx0ICAgICAgdmFyIGNhbmNlbGFibGUgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKG51bGwsIGZ1bmN0aW9uIChsYXN0RXhjZXB0aW9uLCBzZWxmKSB7XG5cdCAgICAgICAgaWYgKHN0YXRlLmlzRGlzcG9zZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdmFyIGN1cnJlbnRJdGVtID0gdHJ5Q2F0Y2goZS5uZXh0KS5jYWxsKGUpO1xuXHQgICAgICAgIGlmIChjdXJyZW50SXRlbSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihjdXJyZW50SXRlbS5lKTsgfVxuXHRcblx0ICAgICAgICBpZiAoY3VycmVudEl0ZW0uZG9uZSkge1xuXHQgICAgICAgICAgcmV0dXJuIGxhc3RFeGNlcHRpb24gIT09IG51bGwgPyBvLm9uRXJyb3IobGFzdEV4Y2VwdGlvbikgOiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG5cdCAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGN1cnJlbnRJdGVtLnZhbHVlO1xuXHQgICAgICAgIGlzUHJvbWlzZShjdXJyZW50VmFsdWUpICYmIChjdXJyZW50VmFsdWUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoY3VycmVudFZhbHVlKSk7XG5cdFxuXHQgICAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgICAgZC5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgc2VsZikpKTtcblx0ICAgICAgfSk7XG5cdCAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoW3N1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSwgbmV3IElzRGlzcG9zZWREaXNwb3NhYmxlKHN0YXRlKV0pO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgcmVjdXJzZSkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcmVjdXJzZSA9IHJlY3Vyc2U7XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fby5vbk5leHQoeCk7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX3JlY3Vyc2UoZSk7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblx0XG5cdCAgICByZXR1cm4gQ2F0Y2hFcnJvck9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICBFbnVtZXJhYmxlLnByb3RvdHlwZS5jYXRjaEVycm9yID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBDYXRjaEVycm9yT2JzZXJ2YWJsZSh0aGlzKTtcblx0ICB9O1xuXHRcblx0ICBFbnVtZXJhYmxlLnByb3RvdHlwZS5jYXRjaEVycm9yV2hlbiA9IGZ1bmN0aW9uIChub3RpZmljYXRpb25IYW5kbGVyKSB7XG5cdCAgICB2YXIgc291cmNlcyA9IHRoaXM7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGV4Y2VwdGlvbnMgPSBuZXcgU3ViamVjdCgpLFxuXHQgICAgICAgIG5vdGlmaWVyID0gbmV3IFN1YmplY3QoKSxcblx0ICAgICAgICBoYW5kbGVkID0gbm90aWZpY2F0aW9uSGFuZGxlcihleGNlcHRpb25zKSxcblx0ICAgICAgICBub3RpZmljYXRpb25EaXNwb3NhYmxlID0gaGFuZGxlZC5zdWJzY3JpYmUobm90aWZpZXIpO1xuXHRcblx0ICAgICAgdmFyIGUgPSBzb3VyY2VzWyRpdGVyYXRvciRdKCk7XG5cdFxuXHQgICAgICB2YXIgc3RhdGUgPSB7IGlzRGlzcG9zZWQ6IGZhbHNlIH0sXG5cdCAgICAgICAgbGFzdEV4Y2VwdGlvbixcblx0ICAgICAgICBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXHQgICAgICB2YXIgY2FuY2VsYWJsZSA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUobnVsbCwgZnVuY3Rpb24gKF8sIHNlbGYpIHtcblx0ICAgICAgICBpZiAoc3RhdGUuaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSB0cnlDYXRjaChlLm5leHQpLmNhbGwoZSk7XG5cdCAgICAgICAgaWYgKGN1cnJlbnRJdGVtID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKGN1cnJlbnRJdGVtLmUpOyB9XG5cdFxuXHQgICAgICAgIGlmIChjdXJyZW50SXRlbS5kb25lKSB7XG5cdCAgICAgICAgICBpZiAobGFzdEV4Y2VwdGlvbikge1xuXHQgICAgICAgICAgICBvLm9uRXJyb3IobGFzdEV4Y2VwdGlvbik7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG5cdCAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGN1cnJlbnRJdGVtLnZhbHVlO1xuXHQgICAgICAgIGlzUHJvbWlzZShjdXJyZW50VmFsdWUpICYmIChjdXJyZW50VmFsdWUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoY3VycmVudFZhbHVlKSk7XG5cdFxuXHQgICAgICAgIHZhciBvdXRlciA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgIHZhciBpbm5lciA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG5ldyBCaW5hcnlEaXNwb3NhYmxlKGlubmVyLCBvdXRlcikpO1xuXHQgICAgICAgIG91dGVyLnNldERpc3Bvc2FibGUoY3VycmVudFZhbHVlLnN1YnNjcmliZShcblx0ICAgICAgICAgIGZ1bmN0aW9uKHgpIHsgby5vbk5leHQoeCk7IH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoZXhuKSB7XG5cdCAgICAgICAgICAgIGlubmVyLnNldERpc3Bvc2FibGUobm90aWZpZXIuc3Vic2NyaWJlKHNlbGYsIGZ1bmN0aW9uKGV4KSB7XG5cdCAgICAgICAgICAgICAgby5vbkVycm9yKGV4KTtcblx0ICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgICB9KSk7XG5cdFxuXHQgICAgICAgICAgICBleGNlcHRpb25zLm9uTmV4dChleG4pO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uKCkgeyBvLm9uQ29tcGxldGVkKCk7IH0pKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtub3RpZmljYXRpb25EaXNwb3NhYmxlLCBzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIG5ldyBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSldKTtcblx0ICAgIH0pO1xuXHQgIH07XG5cdFxuXHQgIHZhciBSZXBlYXRFbnVtZXJhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFJlcGVhdEVudW1lcmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gUmVwZWF0RW51bWVyYWJsZSh2LCBjKSB7XG5cdCAgICAgIHRoaXMudiA9IHY7XG5cdCAgICAgIHRoaXMuYyA9IGMgPT0gbnVsbCA/IC0xIDogYztcblx0ICAgIH1cblx0ICAgIFJlcGVhdEVudW1lcmFibGUucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gbmV3IFJlcGVhdEVudW1lcmF0b3IodGhpcyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIFJlcGVhdEVudW1lcmF0b3IocCkge1xuXHQgICAgICB0aGlzLnYgPSBwLnY7XG5cdCAgICAgIHRoaXMubCA9IHAuYztcblx0ICAgIH1cblx0ICAgIFJlcGVhdEVudW1lcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmICh0aGlzLmwgPT09IDApIHsgcmV0dXJuIGRvbmVFbnVtZXJhdG9yOyB9XG5cdCAgICAgIGlmICh0aGlzLmwgPiAwKSB7IHRoaXMubC0tOyB9XG5cdCAgICAgIHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogdGhpcy52IH07XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBSZXBlYXRFbnVtZXJhYmxlO1xuXHQgIH0oRW51bWVyYWJsZSkpO1xuXHRcblx0ICB2YXIgZW51bWVyYWJsZVJlcGVhdCA9IEVudW1lcmFibGUucmVwZWF0ID0gZnVuY3Rpb24gKHZhbHVlLCByZXBlYXRDb3VudCkge1xuXHQgICAgcmV0dXJuIG5ldyBSZXBlYXRFbnVtZXJhYmxlKHZhbHVlLCByZXBlYXRDb3VudCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIE9mRW51bWVyYWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE9mRW51bWVyYWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE9mRW51bWVyYWJsZShzLCBmbiwgdGhpc0FyZykge1xuXHQgICAgICB0aGlzLnMgPSBzO1xuXHQgICAgICB0aGlzLmZuID0gZm4gPyBiaW5kQ2FsbGJhY2soZm4sIHRoaXNBcmcsIDMpIDogbnVsbDtcblx0ICAgIH1cblx0ICAgIE9mRW51bWVyYWJsZS5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBuZXcgT2ZFbnVtZXJhdG9yKHRoaXMpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBPZkVudW1lcmF0b3IocCkge1xuXHQgICAgICB0aGlzLmkgPSAtMTtcblx0ICAgICAgdGhpcy5zID0gcC5zO1xuXHQgICAgICB0aGlzLmwgPSB0aGlzLnMubGVuZ3RoO1xuXHQgICAgICB0aGlzLmZuID0gcC5mbjtcblx0ICAgIH1cblx0ICAgIE9mRW51bWVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICByZXR1cm4gKyt0aGlzLmkgPCB0aGlzLmwgP1xuXHQgICAgICAgeyBkb25lOiBmYWxzZSwgdmFsdWU6ICF0aGlzLmZuID8gdGhpcy5zW3RoaXMuaV0gOiB0aGlzLmZuKHRoaXMuc1t0aGlzLmldLCB0aGlzLmksIHRoaXMucykgfSA6XG5cdCAgICAgICBkb25lRW51bWVyYXRvcjtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE9mRW51bWVyYWJsZTtcblx0ICB9KEVudW1lcmFibGUpKTtcblx0XG5cdCAgdmFyIGVudW1lcmFibGVPZiA9IEVudW1lcmFibGUub2YgPSBmdW5jdGlvbiAoc291cmNlLCBzZWxlY3RvciwgdGhpc0FyZykge1xuXHQgICAgcmV0dXJuIG5ldyBPZkVudW1lcmFibGUoc291cmNlLCBzZWxlY3RvciwgdGhpc0FyZyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRvQXJyYXlPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVG9BcnJheU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUb0FycmF5T2JzZXJ2YWJsZShzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRvQXJyYXlPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8pKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8pIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5hID0gW107XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0ICAgIFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuYS5wdXNoKHgpOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLm8ub25FcnJvcihlKTsgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuby5vbk5leHQodGhpcy5hKTsgdGhpcy5vLm9uQ29tcGxldGVkKCk7IH07XG5cdFxuXHQgICAgcmV0dXJuIFRvQXJyYXlPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiBDcmVhdGVzIGFuIGFycmF5IGZyb20gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgYSBzaW5nbGUgZWxlbWVudCB3aXRoIGEgbGlzdCBjb250YWluaW5nIGFsbCB0aGUgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50b0FycmF5ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBUb0FycmF5T2JzZXJ2YWJsZSh0aGlzKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgQ3JlYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGZyb20gYSBzcGVjaWZpZWQgc3Vic2NyaWJlIG1ldGhvZCBpbXBsZW1lbnRhdGlvbi5cblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IH0gKTtcblx0ICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuY3JlYXRlKGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gUnguRGlzcG9zYWJsZS5lbXB0eTsgfSApO1xuXHQgICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IH0gKTtcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWJzY3JpYmUgSW1wbGVtZW50YXRpb24gb2YgdGhlIHJlc3VsdGluZyBvYnNlcnZhYmxlIHNlcXVlbmNlJ3Mgc3Vic2NyaWJlIG1ldGhvZCwgcmV0dXJuaW5nIGEgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIHdyYXBwZWQgaW4gYSBEaXNwb3NhYmxlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIHRoZSBzcGVjaWZpZWQgaW1wbGVtZW50YXRpb24gZm9yIHRoZSBTdWJzY3JpYmUgbWV0aG9kLlxuXHQgICAqL1xuXHQgIE9ic2VydmFibGUuY3JlYXRlID0gZnVuY3Rpb24gKHN1YnNjcmliZSwgcGFyZW50KSB7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoc3Vic2NyaWJlLCBwYXJlbnQpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBEZWZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKERlZmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRGVmZXIoZmFjdG9yeSkge1xuXHQgICAgICB0aGlzLl9mID0gZmFjdG9yeTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRGVmZXIucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5fZikoKTtcblx0ICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG9ic2VydmFibGVUaHJvdyhyZXN1bHQuZSkuc3Vic2NyaWJlKG8pO31cblx0ICAgICAgaXNQcm9taXNlKHJlc3VsdCkgJiYgKHJlc3VsdCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShyZXN1bHQpKTtcblx0ICAgICAgcmV0dXJuIHJlc3VsdC5zdWJzY3JpYmUobyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBEZWZlcjtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpbnZva2VzIHRoZSBzcGVjaWZpZWQgZmFjdG9yeSBmdW5jdGlvbiB3aGVuZXZlciBhIG5ldyBvYnNlcnZlciBzdWJzY3JpYmVzLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuZGVmZXIoZnVuY3Rpb24gKCkgeyByZXR1cm4gUnguT2JzZXJ2YWJsZS5mcm9tQXJyYXkoWzEsMiwzXSk7IH0pO1xuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9ic2VydmFibGVGYWN0b3J5IE9ic2VydmFibGUgZmFjdG9yeSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggb2JzZXJ2ZXIgdGhhdCBzdWJzY3JpYmVzIHRvIHRoZSByZXN1bHRpbmcgc2VxdWVuY2Ugb3IgUHJvbWlzZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBvYnNlcnZlcnMgdHJpZ2dlciBhbiBpbnZvY2F0aW9uIG9mIHRoZSBnaXZlbiBvYnNlcnZhYmxlIGZhY3RvcnkgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVEZWZlciA9IE9ic2VydmFibGUuZGVmZXIgPSBmdW5jdGlvbiAob2JzZXJ2YWJsZUZhY3RvcnkpIHtcblx0ICAgIHJldHVybiBuZXcgRGVmZXIob2JzZXJ2YWJsZUZhY3RvcnkpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBFbXB0eU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhFbXB0eU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBFbXB0eU9ic2VydmFibGUoc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBFbXB0eU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgRW1wdHlTaW5rKG9ic2VydmVyLCB0aGlzLnNjaGVkdWxlcik7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBFbXB0eVNpbmsob2JzZXJ2ZXIsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNjaGVkdWxlSXRlbShzLCBzdGF0ZSkge1xuXHQgICAgICBzdGF0ZS5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgfVxuXHRcblx0ICAgIEVtcHR5U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgc3RhdGUgPSB0aGlzLm9ic2VydmVyO1xuXHQgICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZXIgPT09IGltbWVkaWF0ZVNjaGVkdWxlciA/XG5cdCAgICAgICAgc2NoZWR1bGVJdGVtKG51bGwsIHN0YXRlKSA6XG5cdCAgICAgICAgdGhpcy5zY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNjaGVkdWxlSXRlbSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBFbXB0eU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgRU1QVFlfT0JTRVJWQUJMRSA9IG5ldyBFbXB0eU9ic2VydmFibGUoaW1tZWRpYXRlU2NoZWR1bGVyKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgYW4gZW1wdHkgb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgdGhlIHNpbmdsZSBPbkNvbXBsZXRlZCBtZXNzYWdlLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuZW1wdHkoKTtcblx0ICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuZW1wdHkoUnguU2NoZWR1bGVyLnRpbWVvdXQpO1xuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gc2VuZCB0aGUgdGVybWluYXRpb24gY2FsbCBvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIG5vIGVsZW1lbnRzLlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlRW1wdHkgPSBPYnNlcnZhYmxlLmVtcHR5ID0gZnVuY3Rpb24gKHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBzY2hlZHVsZXIgPT09IGltbWVkaWF0ZVNjaGVkdWxlciA/IEVNUFRZX09CU0VSVkFCTEUgOiBuZXcgRW1wdHlPYnNlcnZhYmxlKHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIEZyb21PYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRnJvbU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBGcm9tT2JzZXJ2YWJsZShpdGVyYWJsZSwgbWFwcGVyLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5pdGVyYWJsZSA9IGl0ZXJhYmxlO1xuXHQgICAgICB0aGlzLm1hcHBlciA9IG1hcHBlcjtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEZyb21PYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgRnJvbVNpbmsobywgdGhpcyk7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRnJvbU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgRnJvbVNpbmsgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gRnJvbVNpbmsobywgcGFyZW50KSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgICAgfVxuXHRcblx0ICAgIEZyb21TaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciBsaXN0ID0gT2JqZWN0KHRoaXMucGFyZW50Lml0ZXJhYmxlKSxcblx0ICAgICAgICAgIGl0ID0gZ2V0SXRlcmFibGUobGlzdCksXG5cdCAgICAgICAgICBvID0gdGhpcy5vLFxuXHQgICAgICAgICAgbWFwcGVyID0gdGhpcy5wYXJlbnQubWFwcGVyO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShpLCByZWN1cnNlKSB7XG5cdCAgICAgICAgdmFyIG5leHQgPSB0cnlDYXRjaChpdC5uZXh0KS5jYWxsKGl0KTtcblx0ICAgICAgICBpZiAobmV4dCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihuZXh0LmUpOyB9XG5cdCAgICAgICAgaWYgKG5leHQuZG9uZSkgeyByZXR1cm4gby5vbkNvbXBsZXRlZCgpOyB9XG5cdFxuXHQgICAgICAgIHZhciByZXN1bHQgPSBuZXh0LnZhbHVlO1xuXHRcblx0ICAgICAgICBpZiAoaXNGdW5jdGlvbihtYXBwZXIpKSB7XG5cdCAgICAgICAgICByZXN1bHQgPSB0cnlDYXRjaChtYXBwZXIpKHJlc3VsdCwgaSk7XG5cdCAgICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgby5vbk5leHQocmVzdWx0KTtcblx0ICAgICAgICByZWN1cnNlKGkgKyAxKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBsb29wUmVjdXJzaXZlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEZyb21TaW5rO1xuXHQgIH0oKSk7XG5cdFxuXHQgIHZhciBtYXhTYWZlSW50ZWdlciA9IE1hdGgucG93KDIsIDUzKSAtIDE7XG5cdFxuXHQgIGZ1bmN0aW9uIFN0cmluZ0l0ZXJhYmxlKHMpIHtcblx0ICAgIHRoaXMuX3MgPSBzO1xuXHQgIH1cblx0XG5cdCAgU3RyaW5nSXRlcmFibGUucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBTdHJpbmdJdGVyYXRvcih0aGlzLl9zKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBTdHJpbmdJdGVyYXRvcihzKSB7XG5cdCAgICB0aGlzLl9zID0gcztcblx0ICAgIHRoaXMuX2wgPSBzLmxlbmd0aDtcblx0ICAgIHRoaXMuX2kgPSAwO1xuXHQgIH1cblx0XG5cdCAgU3RyaW5nSXRlcmF0b3IucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXM7XG5cdCAgfTtcblx0XG5cdCAgU3RyaW5nSXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcy5faSA8IHRoaXMuX2wgPyB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogdGhpcy5fcy5jaGFyQXQodGhpcy5faSsrKSB9IDogZG9uZUVudW1lcmF0b3I7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gQXJyYXlJdGVyYWJsZShhKSB7XG5cdCAgICB0aGlzLl9hID0gYTtcblx0ICB9XG5cdFxuXHQgIEFycmF5SXRlcmFibGUucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBBcnJheUl0ZXJhdG9yKHRoaXMuX2EpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIEFycmF5SXRlcmF0b3IoYSkge1xuXHQgICAgdGhpcy5fYSA9IGE7XG5cdCAgICB0aGlzLl9sID0gdG9MZW5ndGgoYSk7XG5cdCAgICB0aGlzLl9pID0gMDtcblx0ICB9XG5cdFxuXHQgIEFycmF5SXRlcmF0b3IucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXM7XG5cdCAgfTtcblx0XG5cdCAgQXJyYXlJdGVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzLl9pIDwgdGhpcy5fbCA/IHsgZG9uZTogZmFsc2UsIHZhbHVlOiB0aGlzLl9hW3RoaXMuX2krK10gfSA6IGRvbmVFbnVtZXJhdG9yO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIG51bWJlcklzRmluaXRlKHZhbHVlKSB7XG5cdCAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiByb290LmlzRmluaXRlKHZhbHVlKTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGlzTmFuKG4pIHtcblx0ICAgIHJldHVybiBuICE9PSBuO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gZ2V0SXRlcmFibGUobykge1xuXHQgICAgdmFyIGkgPSBvWyRpdGVyYXRvciRdLCBpdDtcblx0ICAgIGlmICghaSAmJiB0eXBlb2YgbyA9PT0gJ3N0cmluZycpIHtcblx0ICAgICAgaXQgPSBuZXcgU3RyaW5nSXRlcmFibGUobyk7XG5cdCAgICAgIHJldHVybiBpdFskaXRlcmF0b3IkXSgpO1xuXHQgICAgfVxuXHQgICAgaWYgKCFpICYmIG8ubGVuZ3RoICE9PSB1bmRlZmluZWQpIHtcblx0ICAgICAgaXQgPSBuZXcgQXJyYXlJdGVyYWJsZShvKTtcblx0ICAgICAgcmV0dXJuIGl0WyRpdGVyYXRvciRdKCk7XG5cdCAgICB9XG5cdCAgICBpZiAoIWkpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignT2JqZWN0IGlzIG5vdCBpdGVyYWJsZScpOyB9XG5cdCAgICByZXR1cm4gb1skaXRlcmF0b3IkXSgpO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gc2lnbih2YWx1ZSkge1xuXHQgICAgdmFyIG51bWJlciA9ICt2YWx1ZTtcblx0ICAgIGlmIChudW1iZXIgPT09IDApIHsgcmV0dXJuIG51bWJlcjsgfVxuXHQgICAgaWYgKGlzTmFOKG51bWJlcikpIHsgcmV0dXJuIG51bWJlcjsgfVxuXHQgICAgcmV0dXJuIG51bWJlciA8IDAgPyAtMSA6IDE7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiB0b0xlbmd0aChvKSB7XG5cdCAgICB2YXIgbGVuID0gK28ubGVuZ3RoO1xuXHQgICAgaWYgKGlzTmFOKGxlbikpIHsgcmV0dXJuIDA7IH1cblx0ICAgIGlmIChsZW4gPT09IDAgfHwgIW51bWJlcklzRmluaXRlKGxlbikpIHsgcmV0dXJuIGxlbjsgfVxuXHQgICAgbGVuID0gc2lnbihsZW4pICogTWF0aC5mbG9vcihNYXRoLmFicyhsZW4pKTtcblx0ICAgIGlmIChsZW4gPD0gMCkgeyByZXR1cm4gMDsgfVxuXHQgICAgaWYgKGxlbiA+IG1heFNhZmVJbnRlZ2VyKSB7IHJldHVybiBtYXhTYWZlSW50ZWdlcjsgfVxuXHQgICAgcmV0dXJuIGxlbjtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICogVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyBPYnNlcnZhYmxlIHNlcXVlbmNlIGZyb20gYW4gYXJyYXktbGlrZSBvciBpdGVyYWJsZSBvYmplY3QuXG5cdCAgKiBAcGFyYW0ge0FueX0gYXJyYXlMaWtlIEFuIGFycmF5LWxpa2Ugb3IgaXRlcmFibGUgb2JqZWN0IHRvIGNvbnZlcnQgdG8gYW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IFttYXBGbl0gTWFwIGZ1bmN0aW9uIHRvIGNhbGwgb24gZXZlcnkgZWxlbWVudCBvZiB0aGUgYXJyYXkuXG5cdCAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIFRoZSBjb250ZXh0IHRvIHVzZSBjYWxsaW5nIHRoZSBtYXBGbiBpZiBwcm92aWRlZC5cblx0ICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBPcHRpb25hbCBzY2hlZHVsZXIgdG8gdXNlIGZvciBzY2hlZHVsaW5nLiAgSWYgbm90IHByb3ZpZGVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuY3VycmVudFRocmVhZC5cblx0ICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlRnJvbSA9IE9ic2VydmFibGUuZnJvbSA9IGZ1bmN0aW9uIChpdGVyYWJsZSwgbWFwRm4sIHRoaXNBcmcsIHNjaGVkdWxlcikge1xuXHQgICAgaWYgKGl0ZXJhYmxlID09IG51bGwpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdpdGVyYWJsZSBjYW5ub3QgYmUgbnVsbC4nKVxuXHQgICAgfVxuXHQgICAgaWYgKG1hcEZuICYmICFpc0Z1bmN0aW9uKG1hcEZuKSkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoJ21hcEZuIHdoZW4gcHJvdmlkZWQgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cdCAgICB9XG5cdCAgICBpZiAobWFwRm4pIHtcblx0ICAgICAgdmFyIG1hcHBlciA9IGJpbmRDYWxsYmFjayhtYXBGbiwgdGhpc0FyZywgMik7XG5cdCAgICB9XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgRnJvbU9ic2VydmFibGUoaXRlcmFibGUsIG1hcHBlciwgc2NoZWR1bGVyKTtcblx0ICB9XG5cdFxuXHQgIHZhciBGcm9tQXJyYXlPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRnJvbUFycmF5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEZyb21BcnJheU9ic2VydmFibGUoYXJncywgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMuYXJncyA9IGFyZ3M7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBGcm9tQXJyYXlPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IEZyb21BcnJheVNpbmsob2JzZXJ2ZXIsIHRoaXMpO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEZyb21BcnJheU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICBmdW5jdGlvbiBGcm9tQXJyYXlTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcblx0ICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShhcmdzLCBvYnNlcnZlcikge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3MubGVuZ3RoO1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIGxvb3AgKGksIHJlY3Vyc2UpIHtcblx0ICAgICAgaWYgKGkgPCBsZW4pIHtcblx0ICAgICAgICBvYnNlcnZlci5vbk5leHQoYXJnc1tpXSk7XG5cdCAgICAgICAgcmVjdXJzZShpICsgMSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIEZyb21BcnJheVNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSh0aGlzLnBhcmVudC5hcmdzLCB0aGlzLm9ic2VydmVyKSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgQ29udmVydHMgYW4gYXJyYXkgdG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgdXNpbmcgYW4gb3B0aW9uYWwgc2NoZWR1bGVyIHRvIGVudW1lcmF0ZSB0aGUgYXJyYXkuXG5cdCAgKiBAZGVwcmVjYXRlZCB1c2UgT2JzZXJ2YWJsZS5mcm9tIG9yIE9ic2VydmFibGUub2Zcblx0ICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSBlbnVtZXJhdGlvbiBvZiB0aGUgaW5wdXQgc2VxdWVuY2Ugb24uXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2UgZWxlbWVudHMgYXJlIHB1bGxlZCBmcm9tIHRoZSBnaXZlbiBlbnVtZXJhYmxlIHNlcXVlbmNlLlxuXHQgICovXG5cdCAgdmFyIG9ic2VydmFibGVGcm9tQXJyYXkgPSBPYnNlcnZhYmxlLmZyb21BcnJheSA9IGZ1bmN0aW9uIChhcnJheSwgc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgRnJvbUFycmF5T2JzZXJ2YWJsZShhcnJheSwgc2NoZWR1bGVyKVxuXHQgIH07XG5cdFxuXHQgIHZhciBOZXZlck9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhOZXZlck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBOZXZlck9ic2VydmFibGUoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIE5ldmVyT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTmV2ZXJPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIE5FVkVSX09CU0VSVkFCTEUgPSBuZXcgTmV2ZXJPYnNlcnZhYmxlKCk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYSBub24tdGVybWluYXRpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgd2hpY2ggY2FuIGJlIHVzZWQgdG8gZGVub3RlIGFuIGluZmluaXRlIGR1cmF0aW9uIChlLmcuIHdoZW4gdXNpbmcgcmVhY3RpdmUgam9pbnMpLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIG9ic2VydmVycyB3aWxsIG5ldmVyIGdldCBjYWxsZWQuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVOZXZlciA9IE9ic2VydmFibGUubmV2ZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gTkVWRVJfT0JTRVJWQUJMRTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBvYnNlcnZhYmxlT2YgKHNjaGVkdWxlciwgYXJyYXkpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpO1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgKiAgVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyBPYnNlcnZhYmxlIGluc3RhbmNlIHdpdGggYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzLCByZWdhcmRsZXNzIG9mIG51bWJlciBvciB0eXBlIG9mIHRoZSBhcmd1bWVudHMuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2UgZWxlbWVudHMgYXJlIHB1bGxlZCBmcm9tIHRoZSBnaXZlbiBhcmd1bWVudHMuXG5cdCAgKi9cblx0ICBPYnNlcnZhYmxlLm9mID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICByZXR1cm4gbmV3IEZyb21BcnJheU9ic2VydmFibGUoYXJncywgY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyBPYnNlcnZhYmxlIGluc3RhbmNlIHdpdGggYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzLCByZWdhcmRsZXNzIG9mIG51bWJlciBvciB0eXBlIG9mIHRoZSBhcmd1bWVudHMuXG5cdCAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIEEgc2NoZWR1bGVyIHRvIHVzZSBmb3Igc2NoZWR1bGluZyB0aGUgYXJndW1lbnRzLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSBwdWxsZWQgZnJvbSB0aGUgZ2l2ZW4gYXJndW1lbnRzLlxuXHQgICovXG5cdCAgT2JzZXJ2YWJsZS5vZldpdGhTY2hlZHVsZXIgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4gLSAxKTtcblx0ICAgIGZvcih2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykgeyBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFBhaXJzT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFBhaXJzT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFBhaXJzT2JzZXJ2YWJsZShvYmosIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLm9iaiA9IG9iajtcblx0ICAgICAgdGhpcy5rZXlzID0gT2JqZWN0LmtleXMob2JqKTtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFBhaXJzT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBQYWlyc1Npbmsob2JzZXJ2ZXIsIHRoaXMpO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFBhaXJzT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIGZ1bmN0aW9uIFBhaXJzU2luayhvYnNlcnZlciwgcGFyZW50KSB7XG5cdCAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICB9XG5cdFxuXHQgIFBhaXJzU2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIG9ic2VydmVyID0gdGhpcy5vYnNlcnZlciwgb2JqID0gdGhpcy5wYXJlbnQub2JqLCBrZXlzID0gdGhpcy5wYXJlbnQua2V5cywgbGVuID0ga2V5cy5sZW5ndGg7XG5cdCAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGksIHJlY3Vyc2UpIHtcblx0ICAgICAgaWYgKGkgPCBsZW4pIHtcblx0ICAgICAgICB2YXIga2V5ID0ga2V5c1tpXTtcblx0ICAgICAgICBvYnNlcnZlci5vbk5leHQoW2tleSwgb2JqW2tleV1dKTtcblx0ICAgICAgICByZWN1cnNlKGkgKyAxKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBsb29wUmVjdXJzaXZlKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBDb252ZXJ0IGFuIG9iamVjdCBpbnRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2YgW2tleSwgdmFsdWVdIHBhaXJzLlxuXHQgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSBlbnVtZXJhdGlvbiBvZiB0aGUgaW5wdXQgc2VxdWVuY2Ugb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2YgW2tleSwgdmFsdWVdIHBhaXJzIGZyb20gdGhlIG9iamVjdC5cblx0ICAgKi9cblx0ICBPYnNlcnZhYmxlLnBhaXJzID0gZnVuY3Rpb24gKG9iaiwgc2NoZWR1bGVyKSB7XG5cdCAgICBzY2hlZHVsZXIgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBQYWlyc09ic2VydmFibGUob2JqLCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgICAgdmFyIFJhbmdlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFJhbmdlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFJhbmdlT2JzZXJ2YWJsZShzdGFydCwgY291bnQsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7XG5cdCAgICAgIHRoaXMucmFuZ2VDb3VudCA9IGNvdW50O1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgUmFuZ2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IFJhbmdlU2luayhvYnNlcnZlciwgdGhpcyk7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUmFuZ2VPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFJhbmdlU2luayA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBSYW5nZVNpbmsob2JzZXJ2ZXIsIHBhcmVudCkge1xuXHQgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGxvb3BSZWN1cnNpdmUoc3RhcnQsIGNvdW50LCBvYnNlcnZlcikge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gbG9vcCAoaSwgcmVjdXJzZSkge1xuXHQgICAgICAgIGlmIChpIDwgY291bnQpIHtcblx0ICAgICAgICAgIG9ic2VydmVyLm9uTmV4dChzdGFydCArIGkpO1xuXHQgICAgICAgICAgcmVjdXJzZShpICsgMSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIFJhbmdlU2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKFxuXHQgICAgICAgIDAsXG5cdCAgICAgICAgbG9vcFJlY3Vyc2l2ZSh0aGlzLnBhcmVudC5zdGFydCwgdGhpcy5wYXJlbnQucmFuZ2VDb3VudCwgdGhpcy5vYnNlcnZlcilcblx0ICAgICAgKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFJhbmdlU2luaztcblx0ICB9KCkpO1xuXHRcblx0ICAvKipcblx0ICAqICBHZW5lcmF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBpbnRlZ3JhbCBudW1iZXJzIHdpdGhpbiBhIHNwZWNpZmllZCByYW5nZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgb2JzZXJ2ZXIgbWVzc2FnZXMuXG5cdCAgKiBAcGFyYW0ge051bWJlcn0gc3RhcnQgVGhlIHZhbHVlIG9mIHRoZSBmaXJzdCBpbnRlZ2VyIGluIHRoZSBzZXF1ZW5jZS5cblx0ICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCBUaGUgbnVtYmVyIG9mIHNlcXVlbnRpYWwgaW50ZWdlcnMgdG8gZ2VuZXJhdGUuXG5cdCAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZ2VuZXJhdG9yIGxvb3Agb24uIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5jdXJyZW50VGhyZWFkLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyBhIHJhbmdlIG9mIHNlcXVlbnRpYWwgaW50ZWdyYWwgbnVtYmVycy5cblx0ICAqL1xuXHQgIE9ic2VydmFibGUucmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQsIGNvdW50LCBzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBSYW5nZU9ic2VydmFibGUoc3RhcnQsIGNvdW50LCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBSZXBlYXRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoUmVwZWF0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFJlcGVhdE9ic2VydmFibGUodmFsdWUsIHJlcGVhdENvdW50LCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXHQgICAgICB0aGlzLnJlcGVhdENvdW50ID0gcmVwZWF0Q291bnQgPT0gbnVsbCA/IC0xIDogcmVwZWF0Q291bnQ7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBSZXBlYXRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IFJlcGVhdFNpbmsob2JzZXJ2ZXIsIHRoaXMpO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFJlcGVhdE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICBmdW5jdGlvbiBSZXBlYXRTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcblx0ICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgIH1cblx0XG5cdCAgUmVwZWF0U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIG9ic2VydmVyID0gdGhpcy5vYnNlcnZlciwgdmFsdWUgPSB0aGlzLnBhcmVudC52YWx1ZTtcblx0ICAgIGZ1bmN0aW9uIGxvb3BSZWN1cnNpdmUoaSwgcmVjdXJzZSkge1xuXHQgICAgICBpZiAoaSA9PT0gLTEgfHwgaSA+IDApIHtcblx0ICAgICAgICBvYnNlcnZlci5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgIGkgPiAwICYmIGktLTtcblx0ICAgICAgfVxuXHQgICAgICBpZiAoaSA9PT0gMCkgeyByZXR1cm4gb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTsgfVxuXHQgICAgICByZWN1cnNlKGkpO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUodGhpcy5wYXJlbnQucmVwZWF0Q291bnQsIGxvb3BSZWN1cnNpdmUpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBHZW5lcmF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHJlcGVhdHMgdGhlIGdpdmVuIGVsZW1lbnQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IG9ic2VydmVyIG1lc3NhZ2VzLlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIEVsZW1lbnQgdG8gcmVwZWF0LlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSByZXBlYXRDb3VudCBbT3B0aW9uYV0gTnVtYmVyIG9mIHRpbWVzIHRvIHJlcGVhdCB0aGUgZWxlbWVudC4gSWYgbm90IHNwZWNpZmllZCwgcmVwZWF0cyBpbmRlZmluaXRlbHkuXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBTY2hlZHVsZXIgdG8gcnVuIHRoZSBwcm9kdWNlciBsb29wIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuaW1tZWRpYXRlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcmVwZWF0cyB0aGUgZ2l2ZW4gZWxlbWVudCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cblx0ICAgKi9cblx0ICBPYnNlcnZhYmxlLnJlcGVhdCA9IGZ1bmN0aW9uICh2YWx1ZSwgcmVwZWF0Q291bnQsIHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IFJlcGVhdE9ic2VydmFibGUodmFsdWUsIHJlcGVhdENvdW50LCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBKdXN0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEp1c3RPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gSnVzdE9ic2VydmFibGUodmFsdWUsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBKdXN0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBKdXN0U2luayhvYnNlcnZlciwgdGhpcy52YWx1ZSwgdGhpcy5zY2hlZHVsZXIpO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gSnVzdFNpbmsob2JzZXJ2ZXIsIHZhbHVlLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNjaGVkdWxlSXRlbShzLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgdmFsdWUgPSBzdGF0ZVswXSwgb2JzZXJ2ZXIgPSBzdGF0ZVsxXTtcblx0ICAgICAgb2JzZXJ2ZXIub25OZXh0KHZhbHVlKTtcblx0ICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcblx0ICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgIH1cblx0XG5cdCAgICBKdXN0U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgc3RhdGUgPSBbdGhpcy52YWx1ZSwgdGhpcy5vYnNlcnZlcl07XG5cdCAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlciA9PT0gaW1tZWRpYXRlU2NoZWR1bGVyID9cblx0ICAgICAgICBzY2hlZHVsZUl0ZW0obnVsbCwgc3RhdGUpIDpcblx0ICAgICAgICB0aGlzLnNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZSwgc2NoZWR1bGVJdGVtKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEp1c3RPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIGEgc2luZ2xlIGVsZW1lbnQsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IG9ic2VydmVyIG1lc3NhZ2VzLlxuXHQgICAqICBUaGVyZSBpcyBhbiBhbGlhcyBjYWxsZWQgJ2p1c3QnIG9yIGJyb3dzZXJzIDxJRTkuXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgU2luZ2xlIGVsZW1lbnQgaW4gdGhlIHJlc3VsdGluZyBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBzY2hlZHVsZXIgU2NoZWR1bGVyIHRvIHNlbmQgdGhlIHNpbmdsZSBlbGVtZW50IG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuaW1tZWRpYXRlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHNpbmdsZSBzcGVjaWZpZWQgZWxlbWVudC5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZVJldHVybiA9IE9ic2VydmFibGVbJ3JldHVybiddID0gT2JzZXJ2YWJsZS5qdXN0ID0gZnVuY3Rpb24gKHZhbHVlLCBzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IEp1c3RPYnNlcnZhYmxlKHZhbHVlLCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBUaHJvd09ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUaHJvd09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUaHJvd09ic2VydmFibGUoZXJyb3IsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUaHJvd09ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBUaHJvd1NpbmsobywgdGhpcyk7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBUaHJvd1NpbmsobywgcCkge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLnAgPSBwO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNjaGVkdWxlSXRlbShzLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgZSA9IHN0YXRlWzBdLCBvID0gc3RhdGVbMV07XG5cdCAgICAgIG8ub25FcnJvcihlKTtcblx0ICAgIH1cblx0XG5cdCAgICBUaHJvd1NpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMucC5zY2hlZHVsZXIuc2NoZWR1bGUoW3RoaXMucC5lcnJvciwgdGhpcy5vXSwgc2NoZWR1bGVJdGVtKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFRocm93T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCB0ZXJtaW5hdGVzIHdpdGggYW4gZXhjZXB0aW9uLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCB0aGUgc2luZ2xlIG9uRXJyb3IgbWVzc2FnZS5cblx0ICAgKiAgVGhlcmUgaXMgYW4gYWxpYXMgdG8gdGhpcyBtZXRob2QgY2FsbGVkICd0aHJvd0Vycm9yJyBmb3IgYnJvd3NlcnMgPElFOS5cblx0ICAgKiBAcGFyYW0ge01peGVkfSBlcnJvciBBbiBvYmplY3QgdXNlZCBmb3IgdGhlIHNlcXVlbmNlJ3MgdGVybWluYXRpb24uXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBTY2hlZHVsZXIgdG8gc2VuZCB0aGUgZXhjZXB0aW9uYWwgdGVybWluYXRpb24gY2FsbCBvbi4gSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmltbWVkaWF0ZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCB0ZXJtaW5hdGVzIGV4Y2VwdGlvbmFsbHkgd2l0aCB0aGUgc3BlY2lmaWVkIGV4Y2VwdGlvbiBvYmplY3QuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVUaHJvdyA9IE9ic2VydmFibGVbJ3Rocm93J10gPSBmdW5jdGlvbiAoZXJyb3IsIHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgVGhyb3dPYnNlcnZhYmxlKGVycm9yLCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBDYXRjaE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ2F0Y2hPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ2F0Y2hPYnNlcnZhYmxlKHNvdXJjZSwgZm4pIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2ZuID0gZm47XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIENhdGNoT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBkMSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXHQgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkMSk7XG5cdCAgICAgIGQxLnNldERpc3Bvc2FibGUodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBDYXRjaE9ic2VydmVyKG8sIHN1YnNjcmlwdGlvbiwgdGhpcy5fZm4pKSk7XG5cdCAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBDYXRjaE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgQ2F0Y2hPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENhdGNoT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDYXRjaE9ic2VydmVyKG8sIHMsIGZuKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9zID0gcztcblx0ICAgICAgdGhpcy5fZm4gPSBmbjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgQ2F0Y2hPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KHgpOyB9O1xuXHQgICAgQ2F0Y2hPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXHQgICAgQ2F0Y2hPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5fZm4pKGUpO1xuXHQgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuXHQgICAgICBpc1Byb21pc2UocmVzdWx0KSAmJiAocmVzdWx0ID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHJlc3VsdCkpO1xuXHRcblx0ICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgdGhpcy5fcy5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICBkLnNldERpc3Bvc2FibGUocmVzdWx0LnN1YnNjcmliZSh0aGlzLl9vKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBDYXRjaE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiBDb250aW51ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRlcm1pbmF0ZWQgYnkgYW4gZXhjZXB0aW9uIHdpdGggdGhlIG5leHQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcGFyYW0ge01peGVkfSBoYW5kbGVyT3JTZWNvbmQgRXhjZXB0aW9uIGhhbmRsZXIgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgZ2l2ZW4gdGhlIGVycm9yIHRoYXQgb2NjdXJyZWQgaW4gdGhlIGZpcnN0IHNlcXVlbmNlLCBvciBhIHNlY29uZCBvYnNlcnZhYmxlIHNlcXVlbmNlIHVzZWQgdG8gcHJvZHVjZSByZXN1bHRzIHdoZW4gYW4gZXJyb3Igb2NjdXJyZWQgaW4gdGhlIGZpcnN0IHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIGZpcnN0IHNlcXVlbmNlJ3MgZWxlbWVudHMsIGZvbGxvd2VkIGJ5IHRoZSBlbGVtZW50cyBvZiB0aGUgaGFuZGxlciBzZXF1ZW5jZSBpbiBjYXNlIGFuIGV4Y2VwdGlvbiBvY2N1cnJlZC5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG9bJ2NhdGNoJ10gPSBmdW5jdGlvbiAoaGFuZGxlck9yU2Vjb25kKSB7XG5cdCAgICByZXR1cm4gaXNGdW5jdGlvbihoYW5kbGVyT3JTZWNvbmQpID8gbmV3IENhdGNoT2JzZXJ2YWJsZSh0aGlzLCBoYW5kbGVyT3JTZWNvbmQpIDogb2JzZXJ2YWJsZUNhdGNoKFt0aGlzLCBoYW5kbGVyT3JTZWNvbmRdKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBDb250aW51ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRlcm1pbmF0ZWQgYnkgYW4gZXhjZXB0aW9uIHdpdGggdGhlIG5leHQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcGFyYW0ge0FycmF5IHwgQXJndW1lbnRzfSBhcmdzIEFyZ3VtZW50cyBvciBhbiBhcnJheSB0byB1c2UgYXMgdGhlIG5leHQgc2VxdWVuY2UgaWYgYW4gZXJyb3Igb2NjdXJzLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgZWxlbWVudHMgZnJvbSBjb25zZWN1dGl2ZSBzb3VyY2Ugc2VxdWVuY2VzIHVudGlsIGEgc291cmNlIHNlcXVlbmNlIHRlcm1pbmF0ZXMgc3VjY2Vzc2Z1bGx5LlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlQ2F0Y2ggPSBPYnNlcnZhYmxlWydjYXRjaCddID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGl0ZW1zO1xuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuXHQgICAgICBpdGVtcyA9IGFyZ3VtZW50c1swXTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuXHQgICAgICBpdGVtcyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgaXRlbXNbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIH1cblx0ICAgIHJldHVybiBlbnVtZXJhYmxlT2YoaXRlbXMpLmNhdGNoRXJyb3IoKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbnkgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIG9yIFByb21pc2VzIHByb2R1Y2VzIGFuIGVsZW1lbnQuXG5cdCAgICogVGhpcyBjYW4gYmUgaW4gdGhlIGZvcm0gb2YgYW4gYXJndW1lbnQgbGlzdCBvZiBvYnNlcnZhYmxlcyBvciBhbiBhcnJheS5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogMSAtIG9icyA9IG9ic2VydmFibGUuY29tYmluZUxhdGVzdChvYnMxLCBvYnMyLCBvYnMzLCBmdW5jdGlvbiAobzEsIG8yLCBvMykgeyByZXR1cm4gbzEgKyBvMiArIG8zOyB9KTtcblx0ICAgKiAyIC0gb2JzID0gb2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0KFtvYnMxLCBvYnMyLCBvYnMzXSwgZnVuY3Rpb24gKG8xLCBvMiwgbzMpIHsgcmV0dXJuIG8xICsgbzIgKyBvMzsgfSk7XG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgc291cmNlcyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJnc1swXSkpIHtcblx0ICAgICAgYXJnc1swXS51bnNoaWZ0KHRoaXMpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgYXJncy51bnNoaWZ0KHRoaXMpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIGNvbWJpbmVMYXRlc3QuYXBwbHkodGhpcywgYXJncyk7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gZmFsc2VGYWN0b3J5KCkgeyByZXR1cm4gZmFsc2U7IH1cblx0ICBmdW5jdGlvbiBhcmd1bWVudHNUb0FycmF5KCkge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICByZXR1cm4gYXJncztcblx0ICB9XG5cdFxuXHQgIHZhciBDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ29tYmluZUxhdGVzdE9ic2VydmFibGUocGFyYW1zLCBjYikge1xuXHQgICAgICB0aGlzLl9wYXJhbXMgPSBwYXJhbXM7XG5cdCAgICAgIHRoaXMuX2NiID0gY2I7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIGxlbiA9IHRoaXMuX3BhcmFtcy5sZW5ndGgsXG5cdCAgICAgICAgICBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KGxlbik7XG5cdFxuXHQgICAgICB2YXIgc3RhdGUgPSB7XG5cdCAgICAgICAgaGFzVmFsdWU6IGFycmF5SW5pdGlhbGl6ZShsZW4sIGZhbHNlRmFjdG9yeSksXG5cdCAgICAgICAgaGFzVmFsdWVBbGw6IGZhbHNlLFxuXHQgICAgICAgIGlzRG9uZTogYXJyYXlJbml0aWFsaXplKGxlbiwgZmFsc2VGYWN0b3J5KSxcblx0ICAgICAgICB2YWx1ZXM6IG5ldyBBcnJheShsZW4pXG5cdCAgICAgIH07XG5cdFxuXHQgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgdmFyIHNvdXJjZSA9IHRoaXMuX3BhcmFtc1tpXSwgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcblx0ICAgICAgICBpc1Byb21pc2Uoc291cmNlKSAmJiAoc291cmNlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHNvdXJjZSkpO1xuXHQgICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUobmV3IENvbWJpbmVMYXRlc3RPYnNlcnZlcihvYnNlcnZlciwgaSwgdGhpcy5fY2IsIHN0YXRlKSkpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbnMpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQ29tYmluZUxhdGVzdE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgQ29tYmluZUxhdGVzdE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENvbWJpbmVMYXRlc3RPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENvbWJpbmVMYXRlc3RPYnNlcnZlcihvLCBpLCBjYiwgc3RhdGUpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX2kgPSBpO1xuXHQgICAgICB0aGlzLl9jYiA9IGNiO1xuXHQgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBub3RUaGVTYW1lKGkpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uICh4LCBqKSB7XG5cdCAgICAgICAgcmV0dXJuIGogIT09IGk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgQ29tYmluZUxhdGVzdE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5fc3RhdGUudmFsdWVzW3RoaXMuX2ldID0geDtcblx0ICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVbdGhpcy5faV0gPSB0cnVlO1xuXHQgICAgICBpZiAodGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwgfHwgKHRoaXMuX3N0YXRlLmhhc1ZhbHVlQWxsID0gdGhpcy5fc3RhdGUuaGFzVmFsdWUuZXZlcnkoaWRlbnRpdHkpKSkge1xuXHQgICAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl9jYikuYXBwbHkobnVsbCwgdGhpcy5fc3RhdGUudmFsdWVzKTtcblx0ICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICAgIHRoaXMuX28ub25OZXh0KHJlcyk7XG5cdCAgICAgIH0gZWxzZSBpZiAodGhpcy5fc3RhdGUuaXNEb25lLmZpbHRlcihub3RUaGVTYW1lKHRoaXMuX2kpKS5ldmVyeShpZGVudGl0eSkpIHtcblx0ICAgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgQ29tYmluZUxhdGVzdE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgQ29tYmluZUxhdGVzdE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmlzRG9uZVt0aGlzLl9pXSA9IHRydWU7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmlzRG9uZS5ldmVyeShpZGVudGl0eSkgJiYgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQ29tYmluZUxhdGVzdE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFueSBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgb3IgUHJvbWlzZXMgcHJvZHVjZXMgYW4gZWxlbWVudC5cblx0ICAqXG5cdCAgKiBAZXhhbXBsZVxuXHQgICogMSAtIG9icyA9IFJ4Lk9ic2VydmFibGUuY29tYmluZUxhdGVzdChvYnMxLCBvYnMyLCBvYnMzLCBmdW5jdGlvbiAobzEsIG8yLCBvMykgeyByZXR1cm4gbzEgKyBvMiArIG8zOyB9KTtcblx0ICAqIDIgLSBvYnMgPSBSeC5PYnNlcnZhYmxlLmNvbWJpbmVMYXRlc3QoW29iczEsIG9iczIsIG9iczNdLCBmdW5jdGlvbiAobzEsIG8yLCBvMykgeyByZXR1cm4gbzEgKyBvMiArIG8zOyB9KTtcblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgKi9cblx0ICB2YXIgY29tYmluZUxhdGVzdCA9IE9ic2VydmFibGUuY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuXHQgICAgQXJyYXkuaXNBcnJheShhcmdzWzBdKSAmJiAoYXJncyA9IGFyZ3NbMF0pO1xuXHQgICAgcmV0dXJuIG5ldyBDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZShhcmdzLCByZXN1bHRTZWxlY3Rvcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ29uY2F0ZW5hdGVzIGFsbCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuICBUaGlzIHRha2VzIGluIGVpdGhlciBhbiBhcnJheSBvciB2YXJpYWJsZSBhcmd1bWVudHMgdG8gY29uY2F0ZW5hdGUuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgZWFjaCBnaXZlbiBzZXF1ZW5jZSwgaW4gc2VxdWVudGlhbCBvcmRlci5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uY29uY2F0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgZm9yKHZhciBhcmdzID0gW10sIGkgPSAwLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cblx0ICAgIGFyZ3MudW5zaGlmdCh0aGlzKTtcblx0ICAgIHJldHVybiBvYnNlcnZhYmxlQ29uY2F0LmFwcGx5KG51bGwsIGFyZ3MpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBDb25jYXRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ29uY2F0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENvbmNhdE9ic2VydmFibGUoc291cmNlcykge1xuXHQgICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBDb25jYXRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBDb25jYXRTaW5rKHRoaXMuc291cmNlcywgbyk7XG5cdCAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBDb25jYXRTaW5rKHNvdXJjZXMsIG8pIHtcblx0ICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlcztcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgIH1cblx0ICAgIENvbmNhdFNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIGlzRGlzcG9zZWQsIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksIHNvdXJjZXMgPSB0aGlzLnNvdXJjZXMsIGxlbmd0aCA9IHNvdXJjZXMubGVuZ3RoLCBvID0gdGhpcy5vO1xuXHQgICAgICB2YXIgY2FuY2VsYWJsZSA9IGltbWVkaWF0ZVNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBmdW5jdGlvbiAoaSwgc2VsZikge1xuXHQgICAgICAgIGlmIChpc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIGlmIChpID09PSBsZW5ndGgpIHtcblx0ICAgICAgICAgIHJldHVybiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG5cdCAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IHNvdXJjZXNbaV07XG5cdCAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblx0XG5cdCAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgICBkLnNldERpc3Bvc2FibGUoY3VycmVudFZhbHVlLnN1YnNjcmliZShcblx0ICAgICAgICAgIGZ1bmN0aW9uICh4KSB7IG8ub25OZXh0KHgpOyB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKCkgeyBzZWxmKGkgKyAxKTsgfVxuXHQgICAgICAgICkpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHJldHVybiBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICB9KSk7XG5cdCAgICB9O1xuXHRcblx0XG5cdCAgICByZXR1cm4gQ29uY2F0T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIENvbmNhdGVuYXRlcyBhbGwgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzLlxuXHQgICAqIEBwYXJhbSB7QXJyYXkgfCBBcmd1bWVudHN9IGFyZ3MgQXJndW1lbnRzIG9yIGFuIGFycmF5IHRvIGNvbmNhdCB0byB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBlYWNoIGdpdmVuIHNlcXVlbmNlLCBpbiBzZXF1ZW50aWFsIG9yZGVyLlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlQ29uY2F0ID0gT2JzZXJ2YWJsZS5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgYXJncztcblx0ICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3VtZW50c1swXSkpIHtcblx0ICAgICAgYXJncyA9IGFyZ3VtZW50c1swXTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCk7XG5cdCAgICAgIGZvcih2YXIgaSA9IDAsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gbmV3IENvbmNhdE9ic2VydmFibGUoYXJncyk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ29uY2F0ZW5hdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgZWFjaCBvYnNlcnZlZCBpbm5lciBzZXF1ZW5jZSwgaW4gc2VxdWVudGlhbCBvcmRlci5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uY29uY2F0QWxsID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXMubWVyZ2UoMSk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIE1lcmdlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhNZXJnZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gTWVyZ2VPYnNlcnZhYmxlKHNvdXJjZSwgbWF4Q29uY3VycmVudCkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5tYXhDb25jdXJyZW50ID0gbWF4Q29uY3VycmVudDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgTWVyZ2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIGcgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuXHQgICAgICBnLmFkZCh0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IE1lcmdlT2JzZXJ2ZXIob2JzZXJ2ZXIsIHRoaXMubWF4Q29uY3VycmVudCwgZykpKTtcblx0ICAgICAgcmV0dXJuIGc7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBNZXJnZU9ic2VydmFibGU7XG5cdFxuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIE1lcmdlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gTWVyZ2VPYnNlcnZlcihvLCBtYXgsIGcpIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5tYXggPSBtYXg7XG5cdCAgICAgIHRoaXMuZyA9IGc7XG5cdCAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuXHQgICAgICB0aGlzLnEgPSBbXTtcblx0ICAgICAgdGhpcy5hY3RpdmVDb3VudCA9IDA7XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICB9XG5cdCAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5oYW5kbGVTdWJzY3JpYmUgPSBmdW5jdGlvbiAoeHMpIHtcblx0ICAgICAgdmFyIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICB0aGlzLmcuYWRkKHNhZCk7XG5cdCAgICAgIGlzUHJvbWlzZSh4cykgJiYgKHhzID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHhzKSk7XG5cdCAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHhzLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcih0aGlzLCBzYWQpKSk7XG5cdCAgICB9O1xuXHQgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKGlubmVyU291cmNlKSB7XG5cdCAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICBpZih0aGlzLmFjdGl2ZUNvdW50IDwgdGhpcy5tYXgpIHtcblx0ICAgICAgICAgIHRoaXMuYWN0aXZlQ291bnQrKztcblx0ICAgICAgICAgIHRoaXMuaGFuZGxlU3Vic2NyaWJlKGlubmVyU291cmNlKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgdGhpcy5xLnB1c2goaW5uZXJTb3VyY2UpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5hY3RpdmVDb3VudCA9PT0gMCAmJiB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuXHQgICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9O1xuXHRcblx0ICAgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihwYXJlbnQsIHNhZCkge1xuXHQgICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgICAgICAgIHRoaXMuc2FkID0gc2FkO1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICAgIH1cblx0ICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKHgpIHsgaWYoIXRoaXMuaXNTdG9wcGVkKSB7IHRoaXMucGFyZW50Lm8ub25OZXh0KHgpOyB9IH07XG5cdCAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuXHQgICAgICAgICAgcGFyZW50LmcucmVtb3ZlKHRoaXMuc2FkKTtcblx0ICAgICAgICAgIGlmIChwYXJlbnQucS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgICAgIHBhcmVudC5oYW5kbGVTdWJzY3JpYmUocGFyZW50LnEuc2hpZnQoKSk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBwYXJlbnQuYWN0aXZlQ291bnQtLTtcblx0ICAgICAgICAgICAgcGFyZW50LmRvbmUgJiYgcGFyZW50LmFjdGl2ZUNvdW50ID09PSAwICYmIHBhcmVudC5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcblx0ICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuXHQgICAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICByZXR1cm4gTWVyZ2VPYnNlcnZlcjtcblx0ICB9KCkpO1xuXHRcblx0XG5cdFxuXHRcblx0XG5cdCAgLyoqXG5cdCAgKiBNZXJnZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UsIGxpbWl0aW5nIHRoZSBudW1iZXIgb2YgY29uY3VycmVudCBzdWJzY3JpcHRpb25zIHRvIGlubmVyIHNlcXVlbmNlcy5cblx0ICAqIE9yIG1lcmdlcyB0d28gb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhIHNpbmdsZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICpcblx0ICAqIEBleGFtcGxlXG5cdCAgKiAxIC0gbWVyZ2VkID0gc291cmNlcy5tZXJnZSgxKTtcblx0ICAqIDIgLSBtZXJnZWQgPSBzb3VyY2UubWVyZ2Uob3RoZXJTb3VyY2UpO1xuXHQgICogQHBhcmFtIHtNaXhlZH0gW21heENvbmN1cnJlbnRPck90aGVyXSBNYXhpbXVtIG51bWJlciBvZiBpbm5lciBvYnNlcnZhYmxlIHNlcXVlbmNlcyBiZWluZyBzdWJzY3JpYmVkIHRvIGNvbmN1cnJlbnRseSBvciB0aGUgc2Vjb25kIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBtZXJnZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBpbm5lciBzZXF1ZW5jZXMuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ubWVyZ2UgPSBmdW5jdGlvbiAobWF4Q29uY3VycmVudE9yT3RoZXIpIHtcblx0ICAgIHJldHVybiB0eXBlb2YgbWF4Q29uY3VycmVudE9yT3RoZXIgIT09ICdudW1iZXInID9cblx0ICAgICAgb2JzZXJ2YWJsZU1lcmdlKHRoaXMsIG1heENvbmN1cnJlbnRPck90aGVyKSA6XG5cdCAgICAgIG5ldyBNZXJnZU9ic2VydmFibGUodGhpcywgbWF4Q29uY3VycmVudE9yT3RoZXIpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIE1lcmdlcyBhbGwgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYSBzaW5nbGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBUaGUgc2NoZWR1bGVyIGlzIG9wdGlvbmFsIGFuZCBpZiBub3Qgc3BlY2lmaWVkLCB0aGUgaW1tZWRpYXRlIHNjaGVkdWxlciBpcyB1c2VkLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IG1lcmdlcyB0aGUgZWxlbWVudHMgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzLlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlTWVyZ2UgPSBPYnNlcnZhYmxlLm1lcmdlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIHNjaGVkdWxlciwgc291cmNlcyA9IFtdLCBpLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuXHQgICAgaWYgKCFhcmd1bWVudHNbMF0pIHtcblx0ICAgICAgc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyO1xuXHQgICAgICBmb3IoaSA9IDE7IGkgPCBsZW47IGkrKykgeyBzb3VyY2VzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuXHQgICAgfSBlbHNlIGlmIChpc1NjaGVkdWxlcihhcmd1bWVudHNbMF0pKSB7XG5cdCAgICAgIHNjaGVkdWxlciA9IGFyZ3VtZW50c1swXTtcblx0ICAgICAgZm9yKGkgPSAxOyBpIDwgbGVuOyBpKyspIHsgc291cmNlcy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcjtcblx0ICAgICAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgc291cmNlcy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cblx0ICAgIH1cblx0ICAgIGlmIChBcnJheS5pc0FycmF5KHNvdXJjZXNbMF0pKSB7XG5cdCAgICAgIHNvdXJjZXMgPSBzb3VyY2VzWzBdO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIG9ic2VydmFibGVPZihzY2hlZHVsZXIsIHNvdXJjZXMpLm1lcmdlQWxsKCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIENvbXBvc2l0ZUVycm9yID0gUnguQ29tcG9zaXRlRXJyb3IgPSBmdW5jdGlvbihlcnJvcnMpIHtcblx0ICAgIHRoaXMuaW5uZXJFcnJvcnMgPSBlcnJvcnM7XG5cdCAgICB0aGlzLm1lc3NhZ2UgPSAnVGhpcyBjb250YWlucyBtdWx0aXBsZSBlcnJvcnMuIENoZWNrIHRoZSBpbm5lckVycm9ycyc7XG5cdCAgICBFcnJvci5jYWxsKHRoaXMpO1xuXHQgIH07XG5cdCAgQ29tcG9zaXRlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuXHQgIENvbXBvc2l0ZUVycm9yLnByb3RvdHlwZS5uYW1lID0gJ0NvbXBvc2l0ZUVycm9yJztcblx0XG5cdCAgdmFyIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZShzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgZ3JvdXAgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpLFxuXHQgICAgICAgIG0gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcblx0ICAgICAgICBzdGF0ZSA9IHsgaXNTdG9wcGVkOiBmYWxzZSwgZXJyb3JzOiBbXSwgbzogbyB9O1xuXHRcblx0ICAgICAgZ3JvdXAuYWRkKG0pO1xuXHQgICAgICBtLnNldERpc3Bvc2FibGUodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNZXJnZURlbGF5RXJyb3JPYnNlcnZlcihncm91cCwgc3RhdGUpKSk7XG5cdFxuXHQgICAgICByZXR1cm4gZ3JvdXA7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBNZXJnZURlbGF5RXJyb3JPYnNlcnZlcihncm91cCwgc3RhdGUpIHtcblx0ICAgICAgdGhpcy5fZ3JvdXAgPSBncm91cDtcblx0ICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2V0Q29tcGxldGlvbihvLCBlcnJvcnMpIHtcblx0ICAgICAgaWYgKGVycm9ycy5sZW5ndGggPT09IDApIHtcblx0ICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH0gZWxzZSBpZiAoZXJyb3JzLmxlbmd0aCA9PT0gMSkge1xuXHQgICAgICAgIG8ub25FcnJvcihlcnJvcnNbMF0pO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIG8ub25FcnJvcihuZXcgQ29tcG9zaXRlRXJyb3IoZXJyb3JzKSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHZhciBpbm5lciA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICB0aGlzLl9ncm91cC5hZGQoaW5uZXIpO1xuXHRcblx0ICAgICAgLy8gQ2hlY2sgZm9yIHByb21pc2VzIHN1cHBvcnRcblx0ICAgICAgaXNQcm9taXNlKHgpICYmICh4ID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHgpKTtcblx0ICAgICAgaW5uZXIuc2V0RGlzcG9zYWJsZSh4LnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihpbm5lciwgdGhpcy5fZ3JvdXAsIHRoaXMuX3N0YXRlKSkpO1xuXHQgICAgfTtcblx0XG5cdCAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9zdGF0ZS5lcnJvcnMucHVzaChlKTtcblx0ICAgICAgdGhpcy5fc3RhdGUuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5fZ3JvdXAubGVuZ3RoID09PSAxICYmIHNldENvbXBsZXRpb24odGhpcy5fc3RhdGUubywgdGhpcy5fc3RhdGUuZXJyb3JzKTtcblx0ICAgIH07XG5cdFxuXHQgICAgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fc3RhdGUuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5fZ3JvdXAubGVuZ3RoID09PSAxICYmIHNldENvbXBsZXRpb24odGhpcy5fc3RhdGUubywgdGhpcy5fc3RhdGUuZXJyb3JzKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIoaW5uZXIsIGdyb3VwLCBzdGF0ZSkge1xuXHQgICAgICB0aGlzLl9pbm5lciA9IGlubmVyO1xuXHQgICAgICB0aGlzLl9ncm91cCA9IGdyb3VwO1xuXHQgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fc3RhdGUuby5vbk5leHQoeCk7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmVycm9ycy5wdXNoKGUpO1xuXHQgICAgICB0aGlzLl9ncm91cC5yZW1vdmUodGhpcy5faW5uZXIpO1xuXHQgICAgICB0aGlzLl9zdGF0ZS5pc1N0b3BwZWQgJiYgdGhpcy5fZ3JvdXAubGVuZ3RoID09PSAxICYmIHNldENvbXBsZXRpb24odGhpcy5fc3RhdGUubywgdGhpcy5fc3RhdGUuZXJyb3JzKTtcblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX2dyb3VwLnJlbW92ZSh0aGlzLl9pbm5lcik7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCAmJiB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogRmxhdHRlbnMgYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIE9ic2VydmFibGVzIGludG8gb25lIE9ic2VydmFibGUsIGluIGEgd2F5IHRoYXQgYWxsb3dzIGFuIE9ic2VydmVyIHRvXG5cdCAgKiByZWNlaXZlIGFsbCBzdWNjZXNzZnVsbHkgZW1pdHRlZCBpdGVtcyBmcm9tIGFsbCBvZiB0aGUgc291cmNlIE9ic2VydmFibGVzIHdpdGhvdXQgYmVpbmcgaW50ZXJydXB0ZWQgYnlcblx0ICAqIGFuIGVycm9yIG5vdGlmaWNhdGlvbiBmcm9tIG9uZSBvZiB0aGVtLlxuXHQgICpcblx0ICAqIFRoaXMgYmVoYXZlcyBsaWtlIE9ic2VydmFibGUucHJvdG90eXBlLm1lcmdlQWxsIGV4Y2VwdCB0aGF0IGlmIGFueSBvZiB0aGUgbWVyZ2VkIE9ic2VydmFibGVzIG5vdGlmeSBvZiBhblxuXHQgICogZXJyb3IgdmlhIHRoZSBPYnNlcnZlcidzIG9uRXJyb3IsIG1lcmdlRGVsYXlFcnJvciB3aWxsIHJlZnJhaW4gZnJvbSBwcm9wYWdhdGluZyB0aGF0XG5cdCAgKiBlcnJvciBub3RpZmljYXRpb24gdW50aWwgYWxsIG9mIHRoZSBtZXJnZWQgT2JzZXJ2YWJsZXMgaGF2ZSBmaW5pc2hlZCBlbWl0dGluZyBpdGVtcy5cblx0ICAqIEBwYXJhbSB7QXJyYXkgfCBBcmd1bWVudHN9IGFyZ3MgQXJndW1lbnRzIG9yIGFuIGFycmF5IHRvIG1lcmdlLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBhbGwgb2YgdGhlIGl0ZW1zIGVtaXR0ZWQgYnkgdGhlIE9ic2VydmFibGVzIGVtaXR0ZWQgYnkgdGhlIE9ic2VydmFibGVcblx0ICAqL1xuXHQgIE9ic2VydmFibGUubWVyZ2VEZWxheUVycm9yID0gZnVuY3Rpb24oKSB7XG5cdCAgICB2YXIgYXJncztcblx0ICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3VtZW50c1swXSkpIHtcblx0ICAgICAgYXJncyA9IGFyZ3VtZW50c1swXTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuXHQgICAgICBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICB9XG5cdCAgICB2YXIgc291cmNlID0gb2JzZXJ2YWJsZU9mKG51bGwsIGFyZ3MpO1xuXHQgICAgcmV0dXJuIG5ldyBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlKHNvdXJjZSk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIE1lcmdlQWxsT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhNZXJnZUFsbE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gTWVyZ2VBbGxPYnNlcnZhYmxlKHNvdXJjZSkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgTWVyZ2VBbGxPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBnID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKSwgbSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICBnLmFkZChtKTtcblx0ICAgICAgbS5zZXREaXNwb3NhYmxlKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgTWVyZ2VBbGxPYnNlcnZlcihvYnNlcnZlciwgZykpKTtcblx0ICAgICAgcmV0dXJuIGc7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIE1lcmdlQWxsT2JzZXJ2ZXIobywgZykge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLmcgPSBnO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcblx0ICAgIH1cblx0ICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uKGlubmVyU291cmNlKSB7XG5cdCAgICAgIGlmKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICB2YXIgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHRoaXMuZy5hZGQoc2FkKTtcblx0XG5cdCAgICAgIGlzUHJvbWlzZShpbm5lclNvdXJjZSkgJiYgKGlubmVyU291cmNlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGlubmVyU291cmNlKSk7XG5cdFxuXHQgICAgICBzYWQuc2V0RGlzcG9zYWJsZShpbm5lclNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIodGhpcywgc2FkKSkpO1xuXHQgICAgfTtcblx0ICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5nLmxlbmd0aCA9PT0gMSAmJiB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuXHQgICAgTWVyZ2VBbGxPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihwYXJlbnQsIHNhZCkge1xuXHQgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICAgICAgdGhpcy5zYWQgPSBzYWQ7XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICB9XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoeCkgeyBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7IHRoaXMucGFyZW50Lm8ub25OZXh0KHgpOyB9IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHBhcmVudC5nLnJlbW92ZSh0aGlzLnNhZCk7XG5cdCAgICAgICAgcGFyZW50LmRvbmUgJiYgcGFyZW50LmcubGVuZ3RoID09PSAxICYmIHBhcmVudC5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTWVyZ2VBbGxPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiBNZXJnZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBtZXJnZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBpbm5lciBzZXF1ZW5jZXMuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ubWVyZ2VBbGwgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IE1lcmdlQWxsT2JzZXJ2YWJsZSh0aGlzKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgU2tpcFVudGlsT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNraXBVbnRpbE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gU2tpcFVudGlsT2JzZXJ2YWJsZShzb3VyY2UsIG90aGVyKSB7XG5cdCAgICAgIHRoaXMuX3MgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX28gPSBpc1Byb21pc2Uob3RoZXIpID8gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKG90aGVyKSA6IG90aGVyO1xuXHQgICAgICB0aGlzLl9vcGVuID0gZmFsc2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNraXBVbnRpbE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG5cdCAgICAgIHZhciBsZWZ0U3Vic2NyaXB0aW9uID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIGxlZnRTdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZSh0aGlzLl9zLnN1YnNjcmliZShuZXcgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIobywgdGhpcykpKTtcblx0XG5cdCAgICAgIGlzUHJvbWlzZSh0aGlzLl9vKSAmJiAodGhpcy5fbyA9IG9ic2VydmFibGVGcm9tUHJvbWlzZSh0aGlzLl9vKSk7XG5cdFxuXHQgICAgICB2YXIgcmlnaHRTdWJzY3JpcHRpb24gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgcmlnaHRTdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZSh0aGlzLl9vLnN1YnNjcmliZShuZXcgU2tpcFVudGlsT3RoZXJPYnNlcnZlcihvLCB0aGlzLCByaWdodFN1YnNjcmlwdGlvbikpKTtcblx0XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShsZWZ0U3Vic2NyaXB0aW9uLCByaWdodFN1YnNjcmlwdGlvbik7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTa2lwVW50aWxPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTa2lwVW50aWxTb3VyY2VPYnNlcnZlcihvLCBwKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9wID0gcDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLl9wLl9vcGVuICYmIHRoaXMuX28ub25OZXh0KHgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTa2lwVW50aWxTb3VyY2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlcnIpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTa2lwVW50aWxTb3VyY2VPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX3AuX29wZW4gJiYgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2tpcFVudGlsU291cmNlT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIHZhciBTa2lwVW50aWxPdGhlck9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2tpcFVudGlsT3RoZXJPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIobywgcCwgcikge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcCA9IHA7XG5cdCAgICAgIHRoaXMuX3IgPSByO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTa2lwVW50aWxPdGhlck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9wLl9vcGVuID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5fci5kaXNwb3NlKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZXJyKTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2tpcFVudGlsT3RoZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX3IuZGlzcG9zZSgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2tpcFVudGlsT3RoZXJPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyB0aGUgdmFsdWVzIGZyb20gdGhlIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIG9ubHkgYWZ0ZXIgdGhlIG90aGVyIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjZXMgYSB2YWx1ZS5cblx0ICAgKiBAcGFyYW0ge09ic2VydmFibGUgfCBQcm9taXNlfSBvdGhlciBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvciBQcm9taXNlIHRoYXQgdHJpZ2dlcnMgcHJvcGFnYXRpb24gb2YgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlIHN0YXJ0aW5nIGZyb20gdGhlIHBvaW50IHRoZSBvdGhlciBzZXF1ZW5jZSB0cmlnZ2VyZWQgcHJvcGFnYXRpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNraXBVbnRpbCA9IGZ1bmN0aW9uIChvdGhlcikge1xuXHQgICAgcmV0dXJuIG5ldyBTa2lwVW50aWxPYnNlcnZhYmxlKHRoaXMsIG90aGVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgU3dpdGNoT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFN3aXRjaE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTd2l0Y2hPYnNlcnZhYmxlKHNvdXJjZSkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU3dpdGNoT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBpbm5lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksIHMgPSB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFN3aXRjaE9ic2VydmVyKG8sIGlubmVyKSk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzLCBpbm5lcik7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKFN3aXRjaE9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIFN3aXRjaE9ic2VydmVyKG8sIGlubmVyKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMuaW5uZXIgPSBpbm5lcjtcblx0ICAgICAgdGhpcy5zdG9wcGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMubGF0ZXN0ID0gMDtcblx0ICAgICAgdGhpcy5oYXNMYXRlc3QgPSBmYWxzZTtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFN3aXRjaE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKGlubmVyU291cmNlKSB7XG5cdCAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIGlkID0gKyt0aGlzLmxhdGVzdDtcblx0ICAgICAgdGhpcy5oYXNMYXRlc3QgPSB0cnVlO1xuXHQgICAgICB0aGlzLmlubmVyLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgIGlzUHJvbWlzZShpbm5lclNvdXJjZSkgJiYgKGlubmVyU291cmNlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGlubmVyU291cmNlKSk7XG5cdCAgICAgIGQuc2V0RGlzcG9zYWJsZShpbm5lclNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIodGhpcywgaWQpKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFN3aXRjaE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTd2l0Y2hPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLnN0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAhdGhpcy5oYXNMYXRlc3QgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihwYXJlbnQsIGlkKSB7XG5cdCAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuXHQgICAgICB0aGlzLmlkID0gaWQ7XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLnBhcmVudC5sYXRlc3QgPT09IHRoaXMuaWQgJiYgdGhpcy5wYXJlbnQuby5vbk5leHQoeCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5wYXJlbnQubGF0ZXN0ID09PSB0aGlzLmlkICYmIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAodGhpcy5wYXJlbnQubGF0ZXN0ID09PSB0aGlzLmlkKSB7XG5cdCAgICAgICAgdGhpcy5wYXJlbnQuaGFzTGF0ZXN0ID0gZmFsc2U7XG5cdCAgICAgICAgdGhpcy5wYXJlbnQuaXNTdG9wcGVkICYmIHRoaXMucGFyZW50Lm8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU3dpdGNoT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogVHJhbnNmb3JtcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNpbmcgdmFsdWVzIG9ubHkgZnJvbSB0aGUgbW9zdCByZWNlbnQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGF0IGFueSBwb2ludCBpbiB0aW1lIHByb2R1Y2VzIHRoZSBlbGVtZW50cyBvZiB0aGUgbW9zdCByZWNlbnQgaW5uZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGhhcyBiZWVuIHJlY2VpdmVkLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvWydzd2l0Y2gnXSA9IG9ic2VydmFibGVQcm90by5zd2l0Y2hMYXRlc3QgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IFN3aXRjaE9ic2VydmFibGUodGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRha2VVbnRpbE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUYWtlVW50aWxPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFRha2VVbnRpbE9ic2VydmFibGUoc291cmNlLCBvdGhlcikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5vdGhlciA9IGlzUHJvbWlzZShvdGhlcikgPyBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpIDogb3RoZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRha2VVbnRpbE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShcblx0ICAgICAgICB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobyksXG5cdCAgICAgICAgdGhpcy5vdGhlci5zdWJzY3JpYmUobmV3IFRha2VVbnRpbE9ic2VydmVyKG8pKVxuXHQgICAgICApO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gVGFrZVVudGlsT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBUYWtlVW50aWxPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRha2VVbnRpbE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVGFrZVVudGlsT2JzZXJ2ZXIobykge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGFrZVVudGlsT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgVGFrZVVudGlsT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZXJyKTtcblx0ICAgIH07XG5cdFxuXHQgICAgVGFrZVVudGlsT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gbm9vcDtcblx0XG5cdCAgICByZXR1cm4gVGFrZVVudGlsT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgdGhlIHZhbHVlcyBmcm9tIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1bnRpbCB0aGUgb3RoZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNlcyBhIHZhbHVlLlxuXHQgICAqIEBwYXJhbSB7T2JzZXJ2YWJsZSB8IFByb21pc2V9IG90aGVyIE9ic2VydmFibGUgc2VxdWVuY2Ugb3IgUHJvbWlzZSB0aGF0IHRlcm1pbmF0ZXMgcHJvcGFnYXRpb24gb2YgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlIHVwIHRvIHRoZSBwb2ludCB0aGUgb3RoZXIgc2VxdWVuY2UgaW50ZXJydXB0ZWQgZnVydGhlciBwcm9wYWdhdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udGFrZVVudGlsID0gZnVuY3Rpb24gKG90aGVyKSB7XG5cdCAgICByZXR1cm4gbmV3IFRha2VVbnRpbE9ic2VydmFibGUodGhpcywgb3RoZXIpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGZhbHNlRmFjdG9yeSgpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdCAgZnVuY3Rpb24gYXJndW1lbnRzVG9BcnJheSgpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgcmV0dXJuIGFyZ3M7XG5cdCAgfVxuXHRcblx0ICB2YXIgV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlKHNvdXJjZSwgc291cmNlcywgcmVzdWx0U2VsZWN0b3IpIHtcblx0ICAgICAgdGhpcy5fcyA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fc3MgPSBzb3VyY2VzO1xuXHQgICAgICB0aGlzLl9jYiA9IHJlc3VsdFNlbGVjdG9yO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgbGVuID0gdGhpcy5fc3MubGVuZ3RoO1xuXHQgICAgICB2YXIgc3RhdGUgPSB7XG5cdCAgICAgICAgaGFzVmFsdWU6IGFycmF5SW5pdGlhbGl6ZShsZW4sIGZhbHNlRmFjdG9yeSksXG5cdCAgICAgICAgaGFzVmFsdWVBbGw6IGZhbHNlLFxuXHQgICAgICAgIHZhbHVlczogbmV3IEFycmF5KGxlbilcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIHZhciBuID0gdGhpcy5fc3MubGVuZ3RoLCBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KG4gKyAxKTtcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHtcblx0ICAgICAgICB2YXIgb3RoZXIgPSB0aGlzLl9zc1tpXSwgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgaXNQcm9taXNlKG90aGVyKSAmJiAob3RoZXIgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpKTtcblx0ICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShvdGhlci5zdWJzY3JpYmUobmV3IFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlcihvLCBpLCBzdGF0ZSkpKTtcblx0ICAgICAgICBzdWJzY3JpcHRpb25zW2ldID0gc2FkO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICB2YXIgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHRoaXMuX3Muc3Vic2NyaWJlKG5ldyBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyKG8sIHRoaXMuX2NiLCBzdGF0ZSkpKTtcblx0ICAgICAgc3Vic2NyaXB0aW9uc1tuXSA9IHNhZDtcblx0XG5cdCAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlcihvLCBpLCBzdGF0ZSkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5faSA9IGk7XG5cdCAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMuX3N0YXRlLnZhbHVlc1t0aGlzLl9pXSA9IHg7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmhhc1ZhbHVlW3RoaXMuX2ldID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwgPSB0aGlzLl9zdGF0ZS5oYXNWYWx1ZS5ldmVyeShpZGVudGl0eSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gbm9vcDtcblx0XG5cdCAgICByZXR1cm4gV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICB2YXIgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlcihvLCBjYiwgc3RhdGUpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX2NiID0gY2I7XG5cdCAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB2YXIgYWxsVmFsdWVzID0gW3hdLmNvbmNhdCh0aGlzLl9zdGF0ZS52YWx1ZXMpO1xuXHQgICAgICBpZiAoIXRoaXMuX3N0YXRlLmhhc1ZhbHVlQWxsKSB7IHJldHVybjsgfVxuXHQgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5fY2IpLmFwcGx5KG51bGwsIGFsbFZhbHVlcyk7XG5cdCAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgIHRoaXMuX28ub25OZXh0KHJlcyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIG9ubHkgd2hlbiB0aGUgKGZpcnN0KSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNlcyBhbiBlbGVtZW50LlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLndpdGhMYXRlc3RGcm9tID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFyZ3VtZW50cycpOyB9XG5cdFxuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKGFyZ3NbbGVuIC0gMV0pID8gYXJncy5wb3AoKSA6IGFyZ3VtZW50c1RvQXJyYXk7XG5cdCAgICBBcnJheS5pc0FycmF5KGFyZ3NbMF0pICYmIChhcmdzID0gYXJnc1swXSk7XG5cdFxuXHQgICAgcmV0dXJuIG5ldyBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUodGhpcywgYXJncywgcmVzdWx0U2VsZWN0b3IpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGZhbHNlRmFjdG9yeSgpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdCAgZnVuY3Rpb24gZW1wdHlBcnJheUZhY3RvcnkoKSB7IHJldHVybiBbXTsgfVxuXHRcblx0ICB2YXIgWmlwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFppcE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBaaXBPYnNlcnZhYmxlKHNvdXJjZXMsIHJlc3VsdFNlbGVjdG9yKSB7XG5cdCAgICAgIHRoaXMuX3MgPSBzb3VyY2VzO1xuXHQgICAgICB0aGlzLl9jYiA9IHJlc3VsdFNlbGVjdG9yO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBaaXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIG4gPSB0aGlzLl9zLmxlbmd0aCxcblx0ICAgICAgICAgIHN1YnNjcmlwdGlvbnMgPSBuZXcgQXJyYXkobik7XG5cdCAgICAgICAgICBkb25lID0gYXJyYXlJbml0aWFsaXplKG4sIGZhbHNlRmFjdG9yeSksXG5cdCAgICAgICAgICBxID0gYXJyYXlJbml0aWFsaXplKG4sIGVtcHR5QXJyYXlGYWN0b3J5KTtcblx0XG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSB7XG5cdCAgICAgICAgdmFyIHNvdXJjZSA9IHRoaXMuX3NbaV0sIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbnNbaV0gPSBzYWQ7XG5cdCAgICAgICAgaXNQcm9taXNlKHNvdXJjZSkgJiYgKHNvdXJjZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShzb3VyY2UpKTtcblx0ICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKG5ldyBaaXBPYnNlcnZlcihvYnNlcnZlciwgaSwgdGhpcywgcSwgZG9uZSkpKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb25zKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFppcE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgWmlwT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoWmlwT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBaaXBPYnNlcnZlcihvLCBpLCBwLCBxLCBkKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9pID0gaTtcblx0ICAgICAgdGhpcy5fcCA9IHA7XG5cdCAgICAgIHRoaXMuX3EgPSBxO1xuXHQgICAgICB0aGlzLl9kID0gZDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbm90RW1wdHkoeCkgeyByZXR1cm4geC5sZW5ndGggPiAwOyB9XG5cdCAgICBmdW5jdGlvbiBzaGlmdEVhY2goeCkgeyByZXR1cm4geC5zaGlmdCgpOyB9XG5cdCAgICBmdW5jdGlvbiBub3RUaGVTYW1lKGkpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uICh4LCBqKSB7XG5cdCAgICAgICAgcmV0dXJuIGogIT09IGk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgWmlwT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLl9xW3RoaXMuX2ldLnB1c2goeCk7XG5cdCAgICAgIGlmICh0aGlzLl9xLmV2ZXJ5KG5vdEVtcHR5KSkge1xuXHQgICAgICAgIHZhciBxdWV1ZWRWYWx1ZXMgPSB0aGlzLl9xLm1hcChzaGlmdEVhY2gpO1xuXHQgICAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl9wLl9jYikuYXBwbHkobnVsbCwgcXVldWVkVmFsdWVzKTtcblx0ICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICAgIHRoaXMuX28ub25OZXh0KHJlcyk7XG5cdCAgICAgIH0gZWxzZSBpZiAodGhpcy5fZC5maWx0ZXIobm90VGhlU2FtZSh0aGlzLl9pKSkuZXZlcnkoaWRlbnRpdHkpKSB7XG5cdCAgICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIFppcE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgWmlwT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fZFt0aGlzLl9pXSA9IHRydWU7XG5cdCAgICAgIHRoaXMuX2QuZXZlcnkoaWRlbnRpdHkpICYmIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFppcE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbGwgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIG9yIGFuIGFycmF5IGhhdmUgcHJvZHVjZWQgYW4gZWxlbWVudCBhdCBhIGNvcnJlc3BvbmRpbmcgaW5kZXguXG5cdCAgICogVGhlIGxhc3QgZWxlbWVudCBpbiB0aGUgYXJndW1lbnRzIG11c3QgYmUgYSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggc2VyaWVzIG9mIGVsZW1lbnRzIGF0IGNvcnJlc3BvbmRpbmcgaW5kZXhlcyBpbiB0aGUgYXJncy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBhcmdzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by56aXAgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgYXJndW1lbnRzJyk7IH1cblx0XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHZhciByZXN1bHRTZWxlY3RvciA9IGlzRnVuY3Rpb24oYXJnc1tsZW4gLSAxXSkgPyBhcmdzLnBvcCgpIDogYXJndW1lbnRzVG9BcnJheTtcblx0ICAgIEFycmF5LmlzQXJyYXkoYXJnc1swXSkgJiYgKGFyZ3MgPSBhcmdzWzBdKTtcblx0XG5cdCAgICB2YXIgcGFyZW50ID0gdGhpcztcblx0ICAgIGFyZ3MudW5zaGlmdChwYXJlbnQpO1xuXHRcblx0ICAgIHJldHVybiBuZXcgWmlwT2JzZXJ2YWJsZShhcmdzLCByZXN1bHRTZWxlY3Rvcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYWxsIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBoYXZlIHByb2R1Y2VkIGFuIGVsZW1lbnQgYXQgYSBjb3JyZXNwb25kaW5nIGluZGV4LlxuXHQgICAqIEBwYXJhbSBhcmd1bWVudHMgT2JzZXJ2YWJsZSBzb3VyY2VzLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IHJlc3VsdFNlbGVjdG9yIEZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBzZXJpZXMgb2YgZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzIGluIHRoZSBzb3VyY2VzLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgT2JzZXJ2YWJsZS56aXAgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NbMF0pKSB7XG5cdCAgICAgIGFyZ3MgPSBpc0Z1bmN0aW9uKGFyZ3NbMV0pID8gYXJnc1swXS5jb25jYXQoYXJnc1sxXSkgOiBhcmdzWzBdO1xuXHQgICAgfVxuXHQgICAgdmFyIGZpcnN0ID0gYXJncy5zaGlmdCgpO1xuXHQgICAgcmV0dXJuIGZpcnN0LnppcC5hcHBseShmaXJzdCwgYXJncyk7XG5cdCAgfTtcblx0XG5cdGZ1bmN0aW9uIGZhbHNlRmFjdG9yeSgpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdGZ1bmN0aW9uIGVtcHR5QXJyYXlGYWN0b3J5KCkgeyByZXR1cm4gW107IH1cblx0ZnVuY3Rpb24gYXJndW1lbnRzVG9BcnJheSgpIHtcblx0ICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgcmV0dXJuIGFyZ3M7XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbGwgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIG9yIGFuIGFycmF5IGhhdmUgcHJvZHVjZWQgYW4gZWxlbWVudCBhdCBhIGNvcnJlc3BvbmRpbmcgaW5kZXguXG5cdCAqIFRoZSBsYXN0IGVsZW1lbnQgaW4gdGhlIGFyZ3VtZW50cyBtdXN0IGJlIGEgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIHNlcmllcyBvZiBlbGVtZW50cyBhdCBjb3JyZXNwb25kaW5nIGluZGV4ZXMgaW4gdGhlIGFyZ3MuXG5cdCAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIGFyZ3MgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAqL1xuXHRvYnNlcnZhYmxlUHJvdG8uemlwSXRlcmFibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFyZ3VtZW50cycpOyB9XG5cdFxuXHQgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKGFyZ3NbbGVuIC0gMV0pID8gYXJncy5wb3AoKSA6IGFyZ3VtZW50c1RvQXJyYXk7XG5cdFxuXHQgIHZhciBwYXJlbnQgPSB0aGlzO1xuXHQgIGFyZ3MudW5zaGlmdChwYXJlbnQpO1xuXHQgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgdmFyIG4gPSBhcmdzLmxlbmd0aCxcblx0ICAgICAgcXVldWVzID0gYXJyYXlJbml0aWFsaXplKG4sIGVtcHR5QXJyYXlGYWN0b3J5KSxcblx0ICAgICAgaXNEb25lID0gYXJyYXlJbml0aWFsaXplKG4sIGZhbHNlRmFjdG9yeSk7XG5cdFxuXHQgICAgdmFyIHN1YnNjcmlwdGlvbnMgPSBuZXcgQXJyYXkobik7XG5cdCAgICBmb3IgKHZhciBpZHggPSAwOyBpZHggPCBuOyBpZHgrKykge1xuXHQgICAgICAoZnVuY3Rpb24gKGkpIHtcblx0ICAgICAgICB2YXIgc291cmNlID0gYXJnc1tpXSwgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdFxuXHQgICAgICAgIChpc0FycmF5TGlrZShzb3VyY2UpIHx8IGlzSXRlcmFibGUoc291cmNlKSkgJiYgKHNvdXJjZSA9IG9ic2VydmFibGVGcm9tKHNvdXJjZSkpO1xuXHRcblx0ICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgICBxdWV1ZXNbaV0ucHVzaCh4KTtcblx0ICAgICAgICAgIGlmIChxdWV1ZXMuZXZlcnkoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgubGVuZ3RoID4gMDsgfSkpIHtcblx0ICAgICAgICAgICAgdmFyIHF1ZXVlZFZhbHVlcyA9IHF1ZXVlcy5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguc2hpZnQoKTsgfSksXG5cdCAgICAgICAgICAgICAgICByZXMgPSB0cnlDYXRjaChyZXN1bHRTZWxlY3RvcikuYXBwbHkocGFyZW50LCBxdWV1ZWRWYWx1ZXMpO1xuXHQgICAgICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICAgICAgICBvLm9uTmV4dChyZXMpO1xuXHQgICAgICAgICAgfSBlbHNlIGlmIChpc0RvbmUuZmlsdGVyKGZ1bmN0aW9uICh4LCBqKSB7IHJldHVybiBqICE9PSBpOyB9KS5ldmVyeShpZGVudGl0eSkpIHtcblx0ICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgaXNEb25lW2ldID0gdHJ1ZTtcblx0ICAgICAgICAgIGlzRG9uZS5ldmVyeShpZGVudGl0eSkgJiYgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH0pKTtcblx0ICAgICAgICBzdWJzY3JpcHRpb25zW2ldID0gc2FkO1xuXHQgICAgICB9KShpZHgpO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZShzdWJzY3JpcHRpb25zKTtcblx0ICB9LCBwYXJlbnQpO1xuXHR9O1xuXHRcblx0ICBmdW5jdGlvbiBhc09ic2VydmFibGUoc291cmNlKSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24gc3Vic2NyaWJlKG8pIHsgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobyk7IH07XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiAgSGlkZXMgdGhlIGlkZW50aXR5IG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBoaWRlcyB0aGUgaWRlbnRpdHkgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uYXNPYnNlcnZhYmxlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGFzT2JzZXJ2YWJsZSh0aGlzKSwgdGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUoc291cmNlKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IERlbWF0ZXJpYWxpemVPYnNlcnZlcihvKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRGVtYXRlcmlhbGl6ZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIERlbWF0ZXJpYWxpemVPYnNlcnZlcihvKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB4LmFjY2VwdCh0aGlzLl9vKTsgfTtcblx0ICAgIERlbWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG5cdCAgICBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXHRcblx0ICAgIHJldHVybiBEZW1hdGVyaWFsaXplT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIERlbWF0ZXJpYWxpemVzIHRoZSBleHBsaWNpdCBub3RpZmljYXRpb24gdmFsdWVzIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgaW1wbGljaXQgbm90aWZpY2F0aW9ucy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBleGhpYml0aW5nIHRoZSBiZWhhdmlvciBjb3JyZXNwb25kaW5nIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UncyBub3RpZmljYXRpb24gdmFsdWVzLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5kZW1hdGVyaWFsaXplID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZSh0aGlzKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlKHNvdXJjZSwga2V5Rm4sIGNvbXBhcmVyKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLmtleUZuID0ga2V5Rm47XG5cdCAgICAgIHRoaXMuY29tcGFyZXIgPSBjb21wYXJlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlcihvLCB0aGlzLmtleUZuLCB0aGlzLmNvbXBhcmVyKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyKG8sIGtleUZuLCBjb21wYXJlcikge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLmtleUZuID0ga2V5Rm47XG5cdCAgICAgIHRoaXMuY29tcGFyZXIgPSBjb21wYXJlcjtcblx0ICAgICAgdGhpcy5oYXNDdXJyZW50S2V5ID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuY3VycmVudEtleSA9IG51bGw7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB2YXIga2V5ID0geCwgY29tcGFyZXJFcXVhbHM7XG5cdCAgICAgIGlmIChpc0Z1bmN0aW9uKHRoaXMua2V5Rm4pKSB7XG5cdCAgICAgICAga2V5ID0gdHJ5Q2F0Y2godGhpcy5rZXlGbikoeCk7XG5cdCAgICAgICAgaWYgKGtleSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKGtleS5lKTsgfVxuXHQgICAgICB9XG5cdCAgICAgIGlmICh0aGlzLmhhc0N1cnJlbnRLZXkpIHtcblx0ICAgICAgICBjb21wYXJlckVxdWFscyA9IHRyeUNhdGNoKHRoaXMuY29tcGFyZXIpKHRoaXMuY3VycmVudEtleSwga2V5KTtcblx0ICAgICAgICBpZiAoY29tcGFyZXJFcXVhbHMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihjb21wYXJlckVxdWFscy5lKTsgfVxuXHQgICAgICB9XG5cdCAgICAgIGlmICghdGhpcy5oYXNDdXJyZW50S2V5IHx8ICFjb21wYXJlckVxdWFscykge1xuXHQgICAgICAgIHRoaXMuaGFzQ3VycmVudEtleSA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5jdXJyZW50S2V5ID0ga2V5O1xuXHQgICAgICAgIHRoaXMuby5vbk5leHQoeCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHQgICAgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIG9ubHkgZGlzdGluY3QgY29udGlndW91cyBlbGVtZW50cyBhY2NvcmRpbmcgdG8gdGhlIGtleUZuIGFuZCB0aGUgY29tcGFyZXIuXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBba2V5Rm5dIEEgZnVuY3Rpb24gdG8gY29tcHV0ZSB0aGUgY29tcGFyaXNvbiBrZXkgZm9yIGVhY2ggZWxlbWVudC4gSWYgbm90IHByb3ZpZGVkLCBpdCBwcm9qZWN0cyB0aGUgdmFsdWUuXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGFyZXJdIEVxdWFsaXR5IGNvbXBhcmVyIGZvciBjb21wdXRlZCBrZXkgdmFsdWVzLiBJZiBub3QgcHJvdmlkZWQsIGRlZmF1bHRzIHRvIGFuIGVxdWFsaXR5IGNvbXBhcmVyIGZ1bmN0aW9uLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb25seSBjb250YWluaW5nIHRoZSBkaXN0aW5jdCBjb250aWd1b3VzIGVsZW1lbnRzLCBiYXNlZCBvbiBhIGNvbXB1dGVkIGtleSB2YWx1ZSwgZnJvbSB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmRpc3RpbmN0VW50aWxDaGFuZ2VkID0gZnVuY3Rpb24gKGtleUZuLCBjb21wYXJlcikge1xuXHQgICAgY29tcGFyZXIgfHwgKGNvbXBhcmVyID0gZGVmYXVsdENvbXBhcmVyKTtcblx0ICAgIHJldHVybiBuZXcgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlKHRoaXMsIGtleUZuLCBjb21wYXJlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRhcE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUYXBPYnNlcnZhYmxlLF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUYXBPYnNlcnZhYmxlKHNvdXJjZSwgb2JzZXJ2ZXJPck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX29OID0gb2JzZXJ2ZXJPck9uTmV4dDtcblx0ICAgICAgdGhpcy5fb0UgPSBvbkVycm9yO1xuXHQgICAgICB0aGlzLl9vQyA9IG9uQ29tcGxldGVkO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUYXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHApIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy50ID0gIXAuX29OIHx8IGlzRnVuY3Rpb24ocC5fb04pID9cblx0ICAgICAgICBvYnNlcnZlckNyZWF0ZShwLl9vTiB8fCBub29wLCBwLl9vRSB8fCBub29wLCBwLl9vQyB8fCBub29wKSA6XG5cdCAgICAgICAgcC5fb047XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbih4KSB7XG5cdCAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLnQub25OZXh0KS5jYWxsKHRoaXMudCwgeCk7XG5cdCAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24oZXJyKSB7XG5cdCAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLnQub25FcnJvcikuY2FsbCh0aGlzLnQsIGVycik7XG5cdCAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgdGhpcy5vLm9uRXJyb3IoZXJyKTtcblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMudC5vbkNvbXBsZXRlZCkuY2FsbCh0aGlzLnQpO1xuXHQgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gVGFwT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogIEludm9rZXMgYW4gYWN0aW9uIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIGludm9rZXMgYW4gYWN0aW9uIHVwb24gZ3JhY2VmdWwgb3IgZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiAgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZywgbG9nZ2luZywgZXRjLiBvZiBxdWVyeSBiZWhhdmlvciBieSBpbnRlcmNlcHRpbmcgdGhlIG1lc3NhZ2Ugc3RyZWFtIHRvIHJ1biBhcmJpdHJhcnkgYWN0aW9ucyBmb3IgbWVzc2FnZXMgb24gdGhlIHBpcGVsaW5lLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbiB8IE9ic2VydmVyfSBvYnNlcnZlck9yT25OZXh0IEFjdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvciBhbiBvLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uRXJyb3JdICBBY3Rpb24gdG8gaW52b2tlIHVwb24gZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuIFVzZWQgaWYgb25seSB0aGUgb2JzZXJ2ZXJPck9uTmV4dCBwYXJhbWV0ZXIgaXMgYWxzbyBhIGZ1bmN0aW9uLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uQ29tcGxldGVkXSAgQWN0aW9uIHRvIGludm9rZSB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLiBVc2VkIGlmIG9ubHkgdGhlIG9ic2VydmVyT3JPbk5leHQgcGFyYW1ldGVyIGlzIGFsc28gYSBmdW5jdGlvbi5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG9bJ2RvJ10gPSBvYnNlcnZhYmxlUHJvdG8udGFwID0gb2JzZXJ2YWJsZVByb3RvLmRvQWN0aW9uID0gZnVuY3Rpb24gKG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICByZXR1cm4gbmV3IFRhcE9ic2VydmFibGUodGhpcywgb2JzZXJ2ZXJPck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICogIEludm9rZXMgYW4gYWN0aW9uIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiAgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZywgbG9nZ2luZywgZXRjLiBvZiBxdWVyeSBiZWhhdmlvciBieSBpbnRlcmNlcHRpbmcgdGhlIG1lc3NhZ2Ugc3RyZWFtIHRvIHJ1biBhcmJpdHJhcnkgYWN0aW9ucyBmb3IgbWVzc2FnZXMgb24gdGhlIHBpcGVsaW5lLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gb25OZXh0IEFjdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5kb09uTmV4dCA9IG9ic2VydmFibGVQcm90by50YXBPbk5leHQgPSBmdW5jdGlvbiAob25OZXh0LCB0aGlzQXJnKSB7XG5cdCAgICByZXR1cm4gdGhpcy50YXAodHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24gKHgpIHsgb25OZXh0LmNhbGwodGhpc0FyZywgeCk7IH0gOiBvbk5leHQpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICogIEludm9rZXMgYW4gYWN0aW9uIHVwb24gZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiAgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZywgbG9nZ2luZywgZXRjLiBvZiBxdWVyeSBiZWhhdmlvciBieSBpbnRlcmNlcHRpbmcgdGhlIG1lc3NhZ2Ugc3RyZWFtIHRvIHJ1biBhcmJpdHJhcnkgYWN0aW9ucyBmb3IgbWVzc2FnZXMgb24gdGhlIHBpcGVsaW5lLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gb25FcnJvciBBY3Rpb24gdG8gaW52b2tlIHVwb24gZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uZG9PbkVycm9yID0gb2JzZXJ2YWJsZVByb3RvLnRhcE9uRXJyb3IgPSBmdW5jdGlvbiAob25FcnJvciwgdGhpc0FyZykge1xuXHQgICAgcmV0dXJuIHRoaXMudGFwKG5vb3AsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uIChlKSB7IG9uRXJyb3IuY2FsbCh0aGlzQXJnLCBlKTsgfSA6IG9uRXJyb3IpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICogIEludm9rZXMgYW4gYWN0aW9uIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiAgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZywgbG9nZ2luZywgZXRjLiBvZiBxdWVyeSBiZWhhdmlvciBieSBpbnRlcmNlcHRpbmcgdGhlIG1lc3NhZ2Ugc3RyZWFtIHRvIHJ1biBhcmJpdHJhcnkgYWN0aW9ucyBmb3IgbWVzc2FnZXMgb24gdGhlIHBpcGVsaW5lLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gb25Db21wbGV0ZWQgQWN0aW9uIHRvIGludm9rZSB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoIHRoZSBzaWRlLWVmZmVjdGluZyBiZWhhdmlvciBhcHBsaWVkLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmRvT25Db21wbGV0ZWQgPSBvYnNlcnZhYmxlUHJvdG8udGFwT25Db21wbGV0ZWQgPSBmdW5jdGlvbiAob25Db21wbGV0ZWQsIHRoaXNBcmcpIHtcblx0ICAgIHJldHVybiB0aGlzLnRhcChub29wLCBudWxsLCB0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbiAoKSB7IG9uQ29tcGxldGVkLmNhbGwodGhpc0FyZyk7IH0gOiBvbkNvbXBsZXRlZCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIEludm9rZXMgYSBzcGVjaWZpZWQgYWN0aW9uIGFmdGVyIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0ZXJtaW5hdGVzIGdyYWNlZnVsbHkgb3IgZXhjZXB0aW9uYWxseS5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmaW5hbGx5QWN0aW9uIEFjdGlvbiB0byBpbnZva2UgYWZ0ZXIgdGhlIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRlcm1pbmF0ZXMuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFNvdXJjZSBzZXF1ZW5jZSB3aXRoIHRoZSBhY3Rpb24taW52b2tpbmcgdGVybWluYXRpb24gYmVoYXZpb3IgYXBwbGllZC5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG9bJ2ZpbmFsbHknXSA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcblx0ICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gdHJ5Q2F0Y2goc291cmNlLnN1YnNjcmliZSkuY2FsbChzb3VyY2UsIG9ic2VydmVyKTtcblx0ICAgICAgaWYgKHN1YnNjcmlwdGlvbiA9PT0gZXJyb3JPYmopIHtcblx0ICAgICAgICBhY3Rpb24oKTtcblx0ICAgICAgICByZXR1cm4gdGhyb3dlcihzdWJzY3JpcHRpb24uZSk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHZhciByID0gdHJ5Q2F0Y2goc3Vic2NyaXB0aW9uLmRpc3Bvc2UpLmNhbGwoc3Vic2NyaXB0aW9uKTtcblx0ICAgICAgICBhY3Rpb24oKTtcblx0ICAgICAgICByID09PSBlcnJvck9iaiAmJiB0aHJvd2VyKHIuZSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfSwgdGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBJZ25vcmVFbGVtZW50c09ic2VydmFibGUoc291cmNlKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBJZ25vcmVFbGVtZW50c09ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8pKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICB9XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBub29wO1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuby5vbkVycm9yKGVycik7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm9ic2VydmVyLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBJZ25vcmVzIGFsbCBlbGVtZW50cyBpbiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGxlYXZpbmcgb25seSB0aGUgdGVybWluYXRpb24gbWVzc2FnZXMuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIGVtcHR5IG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaWduYWxzIHRlcm1pbmF0aW9uLCBzdWNjZXNzZnVsIG9yIGV4Y2VwdGlvbmFsLCBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5pZ25vcmVFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlKHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBNYXRlcmlhbGl6ZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTWF0ZXJpYWxpemVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gTWF0ZXJpYWxpemVPYnNlcnZhYmxlKHNvdXJjZSwgZm4pIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIE1hdGVyaWFsaXplT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IE1hdGVyaWFsaXplT2JzZXJ2ZXIobykpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTWF0ZXJpYWxpemVPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIE1hdGVyaWFsaXplT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTWF0ZXJpYWxpemVPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBNYXRlcmlhbGl6ZU9ic2VydmVyKG8pIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIE1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLl9vLm9uTmV4dChub3RpZmljYXRpb25DcmVhdGVPbk5leHQoeCkpIH07XG5cdCAgICBNYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25OZXh0KG5vdGlmaWNhdGlvbkNyZWF0ZU9uRXJyb3IoZSkpOyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cdCAgICBNYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX28ub25OZXh0KG5vdGlmaWNhdGlvbkNyZWF0ZU9uQ29tcGxldGVkKCkpOyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cdFxuXHQgICAgcmV0dXJuIE1hdGVyaWFsaXplT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBNYXRlcmlhbGl6ZXMgdGhlIGltcGxpY2l0IG5vdGlmaWNhdGlvbnMgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyBleHBsaWNpdCBub3RpZmljYXRpb24gdmFsdWVzLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIG1hdGVyaWFsaXplZCBub3RpZmljYXRpb24gdmFsdWVzIGZyb20gdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ubWF0ZXJpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IE1hdGVyaWFsaXplT2JzZXJ2YWJsZSh0aGlzKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmVwZWF0cyB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuIElmIHRoZSByZXBlYXQgY291bnQgaXMgbm90IHNwZWNpZmllZCwgdGhlIHNlcXVlbmNlIHJlcGVhdHMgaW5kZWZpbml0ZWx5LlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBbcmVwZWF0Q291bnRdICBOdW1iZXIgb2YgdGltZXMgdG8gcmVwZWF0IHRoZSBzZXF1ZW5jZS4gSWYgbm90IHByb3ZpZGVkLCByZXBlYXRzIHRoZSBzZXF1ZW5jZSBpbmRlZmluaXRlbHkuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2luZyB0aGUgZWxlbWVudHMgb2YgdGhlIGdpdmVuIHNlcXVlbmNlIHJlcGVhdGVkbHkuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnJlcGVhdCA9IGZ1bmN0aW9uIChyZXBlYXRDb3VudCkge1xuXHQgICAgcmV0dXJuIGVudW1lcmFibGVSZXBlYXQodGhpcywgcmVwZWF0Q291bnQpLmNvbmNhdCgpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXBlYXRzIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcyBvciB1bnRpbCBpdCBzdWNjZXNzZnVsbHkgdGVybWluYXRlcy4gSWYgdGhlIHJldHJ5IGNvdW50IGlzIG5vdCBzcGVjaWZpZWQsIGl0IHJldHJpZXMgaW5kZWZpbml0ZWx5LlxuXHQgICAqICBOb3RlIGlmIHlvdSBlbmNvdW50ZXIgYW4gZXJyb3IgYW5kIHdhbnQgaXQgdG8gcmV0cnkgb25jZSwgdGhlbiB5b3UgbXVzdCB1c2UgLnJldHJ5KDIpO1xuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAgdmFyIHJlcyA9IHJldHJpZWQgPSByZXRyeS5yZXBlYXQoKTtcblx0ICAgKiAgdmFyIHJlcyA9IHJldHJpZWQgPSByZXRyeS5yZXBlYXQoMik7XG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IFtyZXRyeUNvdW50XSAgTnVtYmVyIG9mIHRpbWVzIHRvIHJldHJ5IHRoZSBzZXF1ZW5jZS4gSWYgbm90IHByb3ZpZGVkLCByZXRyeSB0aGUgc2VxdWVuY2UgaW5kZWZpbml0ZWx5LlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2luZyB0aGUgZWxlbWVudHMgb2YgdGhlIGdpdmVuIHNlcXVlbmNlIHJlcGVhdGVkbHkgdW50aWwgaXQgdGVybWluYXRlcyBzdWNjZXNzZnVsbHkuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnJldHJ5ID0gZnVuY3Rpb24gKHJldHJ5Q291bnQpIHtcblx0ICAgIHJldHVybiBlbnVtZXJhYmxlUmVwZWF0KHRoaXMsIHJldHJ5Q291bnQpLmNhdGNoRXJyb3IoKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmVwZWF0cyB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdXBvbiBlcnJvciBlYWNoIHRpbWUgdGhlIG5vdGlmaWVyIGVtaXRzIG9yIHVudGlsIGl0IHN1Y2Nlc3NmdWxseSB0ZXJtaW5hdGVzLiBcblx0ICAgKiAgaWYgdGhlIG5vdGlmaWVyIGNvbXBsZXRlcywgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgY29tcGxldGVzLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAgdmFyIHRpbWVyID0gT2JzZXJ2YWJsZS50aW1lcig1MDApO1xuXHQgICAqICB2YXIgc291cmNlID0gb2JzZXJ2YWJsZS5yZXRyeVdoZW4odGltZXIpO1xuXHQgICAqIEBwYXJhbSB7T2JzZXJ2YWJsZX0gW25vdGlmaWVyXSBBbiBvYnNlcnZhYmxlIHRoYXQgdHJpZ2dlcnMgdGhlIHJldHJpZXMgb3IgY29tcGxldGVzIHRoZSBvYnNlcnZhYmxlIHdpdGggb25OZXh0IG9yIG9uQ29tcGxldGVkIHJlc3BlY3RpdmVseS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNpbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBzZXF1ZW5jZSByZXBlYXRlZGx5IHVudGlsIGl0IHRlcm1pbmF0ZXMgc3VjY2Vzc2Z1bGx5LlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5yZXRyeVdoZW4gPSBmdW5jdGlvbiAobm90aWZpZXIpIHtcblx0ICAgIHJldHVybiBlbnVtZXJhYmxlUmVwZWF0KHRoaXMpLmNhdGNoRXJyb3JXaGVuKG5vdGlmaWVyKTtcblx0ICB9O1xuXHQgIHZhciBTY2FuT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNjYW5PYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU2Nhbk9ic2VydmFibGUoc291cmNlLCBhY2N1bXVsYXRvciwgaGFzU2VlZCwgc2VlZCkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5hY2N1bXVsYXRvciA9IGFjY3VtdWxhdG9yO1xuXHQgICAgICB0aGlzLmhhc1NlZWQgPSBoYXNTZWVkO1xuXHQgICAgICB0aGlzLnNlZWQgPSBzZWVkO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTY2FuT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgU2Nhbk9ic2VydmVyKG8sdGhpcykpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2Nhbk9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgU2Nhbk9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNjYW5PYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFNjYW5PYnNlcnZlcihvLCBwYXJlbnQpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3AgPSBwYXJlbnQ7XG5cdCAgICAgIHRoaXMuX2ZuID0gcGFyZW50LmFjY3VtdWxhdG9yO1xuXHQgICAgICB0aGlzLl9ocyA9IHBhcmVudC5oYXNTZWVkO1xuXHQgICAgICB0aGlzLl9zID0gcGFyZW50LnNlZWQ7XG5cdCAgICAgIHRoaXMuX2hhID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuX2EgPSBudWxsO1xuXHQgICAgICB0aGlzLl9odiA9IGZhbHNlO1xuXHQgICAgICB0aGlzLl9pID0gMDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2Nhbk9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgIXRoaXMuX2h2ICYmICh0aGlzLl9odiA9IHRydWUpO1xuXHQgICAgICBpZiAodGhpcy5faGEpIHtcblx0ICAgICAgICB0aGlzLl9hID0gdHJ5Q2F0Y2godGhpcy5fZm4pKHRoaXMuX2EsIHgsIHRoaXMuX2ksIHRoaXMuX3ApO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHRoaXMuX2EgPSB0aGlzLl9ocyA/IHRyeUNhdGNoKHRoaXMuX2ZuKSh0aGlzLl9zLCB4LCB0aGlzLl9pLCB0aGlzLl9wKSA6IHg7XG5cdCAgICAgICAgdGhpcy5faGEgPSB0cnVlO1xuXHQgICAgICB9XG5cdCAgICAgIGlmICh0aGlzLl9hID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHRoaXMuX2EuZSk7IH1cblx0ICAgICAgdGhpcy5fby5vbk5leHQodGhpcy5fYSk7XG5cdCAgICAgIHRoaXMuX2krKztcblx0ICAgIH07XG5cdFxuXHQgICAgU2Nhbk9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2Nhbk9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICF0aGlzLl9odiAmJiB0aGlzLl9ocyAmJiB0aGlzLl9vLm9uTmV4dCh0aGlzLl9zKTtcblx0ICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2Nhbk9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAqICBBcHBsaWVzIGFuIGFjY3VtdWxhdG9yIGZ1bmN0aW9uIG92ZXIgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhbmQgcmV0dXJucyBlYWNoIGludGVybWVkaWF0ZSByZXN1bHQuIFRoZSBvcHRpb25hbCBzZWVkIHZhbHVlIGlzIHVzZWQgYXMgdGhlIGluaXRpYWwgYWNjdW11bGF0b3IgdmFsdWUuXG5cdCAgKiAgRm9yIGFnZ3JlZ2F0aW9uIGJlaGF2aW9yIHdpdGggbm8gaW50ZXJtZWRpYXRlIHJlc3VsdHMsIHNlZSBPYnNlcnZhYmxlLmFnZ3JlZ2F0ZS5cblx0ICAqIEBwYXJhbSB7TWl4ZWR9IFtzZWVkXSBUaGUgaW5pdGlhbCBhY2N1bXVsYXRvciB2YWx1ZS5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjY3VtdWxhdG9yIEFuIGFjY3VtdWxhdG9yIGZ1bmN0aW9uIHRvIGJlIGludm9rZWQgb24gZWFjaCBlbGVtZW50LlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgYWNjdW11bGF0ZWQgdmFsdWVzLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNjYW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgaGFzU2VlZCA9IGZhbHNlLCBzZWVkLCBhY2N1bXVsYXRvciA9IGFyZ3VtZW50c1swXTtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG5cdCAgICAgIGhhc1NlZWQgPSB0cnVlO1xuXHQgICAgICBzZWVkID0gYXJndW1lbnRzWzFdO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIG5ldyBTY2FuT2JzZXJ2YWJsZSh0aGlzLCBhY2N1bXVsYXRvciwgaGFzU2VlZCwgc2VlZCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFNraXBMYXN0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTa2lwTGFzdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTa2lwTGFzdE9ic2VydmFibGUoc291cmNlLCBjKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9jID0gYztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2tpcExhc3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgU2tpcExhc3RPYnNlcnZlcihvLCB0aGlzLl9jKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTa2lwTGFzdE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgU2tpcExhc3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTa2lwTGFzdE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU2tpcExhc3RPYnNlcnZlcihvLCBjKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9jID0gYztcblx0ICAgICAgdGhpcy5fcSA9IFtdO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTa2lwTGFzdE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5fcS5wdXNoKHgpO1xuXHQgICAgICB0aGlzLl9xLmxlbmd0aCA+IHRoaXMuX2MgJiYgdGhpcy5fby5vbk5leHQodGhpcy5fcS5zaGlmdCgpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2tpcExhc3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNraXBMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2tpcExhc3RPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIEJ5cGFzc2VzIGEgc3BlY2lmaWVkIG51bWJlciBvZiBlbGVtZW50cyBhdCB0aGUgZW5kIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQGRlc2NyaXB0aW9uXG5cdCAgICogIFRoaXMgb3BlcmF0b3IgYWNjdW11bGF0ZXMgYSBxdWV1ZSB3aXRoIGEgbGVuZ3RoIGVub3VnaCB0byBzdG9yZSB0aGUgZmlyc3QgYGNvdW50YCBlbGVtZW50cy4gQXMgbW9yZSBlbGVtZW50cyBhcmVcblx0ICAgKiAgcmVjZWl2ZWQsIGVsZW1lbnRzIGFyZSB0YWtlbiBmcm9tIHRoZSBmcm9udCBvZiB0aGUgcXVldWUgYW5kIHByb2R1Y2VkIG9uIHRoZSByZXN1bHQgc2VxdWVuY2UuIFRoaXMgY2F1c2VzIGVsZW1lbnRzIHRvIGJlIGRlbGF5ZWQuXG5cdCAgICogQHBhcmFtIGNvdW50IE51bWJlciBvZiBlbGVtZW50cyB0byBieXBhc3MgYXQgdGhlIGVuZCBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSBlbGVtZW50cyBleGNlcHQgZm9yIHRoZSBieXBhc3NlZCBvbmVzIGF0IHRoZSBlbmQuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNraXBMYXN0ID0gZnVuY3Rpb24gKGNvdW50KSB7XG5cdCAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG5cdCAgICByZXR1cm4gbmV3IFNraXBMYXN0T2JzZXJ2YWJsZSh0aGlzLCBjb3VudCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFByZXBlbmRzIGEgc2VxdWVuY2Ugb2YgdmFsdWVzIHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBzY2hlZHVsZXIgYW5kIGFuIGFyZ3VtZW50IGxpc3Qgb2YgdmFsdWVzIHRvIHByZXBlbmQuXG5cdCAgICogIEBleGFtcGxlXG5cdCAgICogIHZhciByZXMgPSBzb3VyY2Uuc3RhcnRXaXRoKDEsIDIsIDMpO1xuXHQgICAqICB2YXIgcmVzID0gc291cmNlLnN0YXJ0V2l0aChSeC5TY2hlZHVsZXIudGltZW91dCwgMSwgMiwgMyk7XG5cdCAgICogQHBhcmFtIHtBcmd1bWVudHN9IGFyZ3MgVGhlIHNwZWNpZmllZCB2YWx1ZXMgdG8gcHJlcGVuZCB0byB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZVxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHByZXBlbmRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWVzLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5zdGFydFdpdGggPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgdmFsdWVzLCBzY2hlZHVsZXIsIHN0YXJ0ID0gMDtcblx0ICAgIGlmICghIWFyZ3VtZW50cy5sZW5ndGggJiYgaXNTY2hlZHVsZXIoYXJndW1lbnRzWzBdKSkge1xuXHQgICAgICBzY2hlZHVsZXIgPSBhcmd1bWVudHNbMF07XG5cdCAgICAgIHN0YXJ0ID0gMTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcjtcblx0ICAgIH1cblx0ICAgIGZvcih2YXIgYXJncyA9IFtdLCBpID0gc3RhcnQsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuXHQgICAgcmV0dXJuIGVudW1lcmFibGVPZihbb2JzZXJ2YWJsZUZyb21BcnJheShhcmdzLCBzY2hlZHVsZXIpLCB0aGlzXSkuY29uY2F0KCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRha2VMYXN0T2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGFrZUxhc3RPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRha2VMYXN0T2JzZXJ2ZXIobywgYykge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fYyA9IGM7XG5cdCAgICAgIHRoaXMuX3EgPSBbXTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGFrZUxhc3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMuX3EucHVzaCh4KTtcblx0ICAgICAgdGhpcy5fcS5sZW5ndGggPiB0aGlzLl9jICYmIHRoaXMuX3Euc2hpZnQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgVGFrZUxhc3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFRha2VMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgd2hpbGUgKHRoaXMuX3EubGVuZ3RoID4gMCkgeyB0aGlzLl9vLm9uTmV4dCh0aGlzLl9xLnNoaWZ0KCkpOyB9XG5cdCAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFRha2VMYXN0T2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGEgc3BlY2lmaWVkIG51bWJlciBvZiBjb250aWd1b3VzIGVsZW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqICBUaGlzIG9wZXJhdG9yIGFjY3VtdWxhdGVzIGEgYnVmZmVyIHdpdGggYSBsZW5ndGggZW5vdWdoIHRvIHN0b3JlIGVsZW1lbnRzIGNvdW50IGVsZW1lbnRzLiBVcG9uIGNvbXBsZXRpb24gb2Zcblx0ICAgKiAgdGhlIHNvdXJjZSBzZXF1ZW5jZSwgdGhpcyBidWZmZXIgaXMgZHJhaW5lZCBvbiB0aGUgcmVzdWx0IHNlcXVlbmNlLiBUaGlzIGNhdXNlcyB0aGUgZWxlbWVudHMgdG8gYmUgZGVsYXllZC5cblx0ICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgTnVtYmVyIG9mIGVsZW1lbnRzIHRvIHRha2UgZnJvbSB0aGUgZW5kIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udGFrZUxhc3QgPSBmdW5jdGlvbiAoY291bnQpIHtcblx0ICAgIGlmIChjb3VudCA8IDApIHsgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yKCk7IH1cblx0ICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBUYWtlTGFzdE9ic2VydmVyKG8sIGNvdW50KSk7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH07XG5cdFxuXHRvYnNlcnZhYmxlUHJvdG8uZmxhdE1hcENvbmNhdCA9IG9ic2VydmFibGVQcm90by5jb25jYXRNYXAgPSBmdW5jdGlvbihzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0ICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5tZXJnZSgxKTtcblx0fTtcblx0ICB2YXIgTWFwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhNYXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIE1hcE9ic2VydmFibGUoc291cmNlLCBzZWxlY3RvciwgdGhpc0FyZykge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5zZWxlY3RvciA9IGJpbmRDYWxsYmFjayhzZWxlY3RvciwgdGhpc0FyZywgMyk7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGlubmVyTWFwKHNlbGVjdG9yLCBzZWxmKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAoeCwgaSwgbykgeyByZXR1cm4gc2VsZWN0b3IuY2FsbCh0aGlzLCBzZWxmLnNlbGVjdG9yKHgsIGksIG8pLCBpLCBvKTsgfVxuXHQgICAgfVxuXHRcblx0ICAgIE1hcE9ic2VydmFibGUucHJvdG90eXBlLmludGVybmFsTWFwID0gZnVuY3Rpb24gKHNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdCAgICAgIHJldHVybiBuZXcgTWFwT2JzZXJ2YWJsZSh0aGlzLnNvdXJjZSwgaW5uZXJNYXAoc2VsZWN0b3IsIHRoaXMpLCB0aGlzQXJnKTtcblx0ICAgIH07XG5cdFxuXHQgICAgTWFwT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgdGhpcy5zZWxlY3RvciwgdGhpcykpO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgc2VsZWN0b3IsIHNvdXJjZSkge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLmkgPSAwO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHgpIHtcblx0ICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuc2VsZWN0b3IpKHgsIHRoaXMuaSsrLCB0aGlzLnNvdXJjZSk7XG5cdCAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihyZXN1bHQuZSk7IH1cblx0ICAgICAgdGhpcy5vLm9uTmV4dChyZXN1bHQpO1xuXHQgICAgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTWFwT2JzZXJ2YWJsZTtcblx0XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAqIFByb2plY3RzIGVhY2ggZWxlbWVudCBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGludG8gYSBuZXcgZm9ybSBieSBpbmNvcnBvcmF0aW5nIHRoZSBlbGVtZW50J3MgaW5kZXguXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzZWxlY3RvciBBIHRyYW5zZm9ybSBmdW5jdGlvbiB0byBhcHBseSB0byBlYWNoIHNvdXJjZSBlbGVtZW50OyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuXHQgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgdHJhbnNmb3JtIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCBvZiBzb3VyY2UuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ubWFwID0gb2JzZXJ2YWJsZVByb3RvLnNlbGVjdCA9IGZ1bmN0aW9uIChzZWxlY3RvciwgdGhpc0FyZykge1xuXHQgICAgdmFyIHNlbGVjdG9yRm4gPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICdmdW5jdGlvbicgPyBzZWxlY3RvciA6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGVjdG9yOyB9O1xuXHQgICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBNYXBPYnNlcnZhYmxlID9cblx0ICAgICAgdGhpcy5pbnRlcm5hbE1hcChzZWxlY3RvckZuLCB0aGlzQXJnKSA6XG5cdCAgICAgIG5ldyBNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yRm4sIHRoaXNBcmcpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIHBsdWNrZXIoYXJncywgbGVuKSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24gbWFwcGVyKHgpIHtcblx0ICAgICAgdmFyIGN1cnJlbnRQcm9wID0geDtcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgIHZhciBwID0gY3VycmVudFByb3BbYXJnc1tpXV07XG5cdCAgICAgICAgaWYgKHR5cGVvZiBwICE9PSAndW5kZWZpbmVkJykge1xuXHQgICAgICAgICAgY3VycmVudFByb3AgPSBwO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gY3VycmVudFByb3A7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiBSZXRyaWV2ZXMgdGhlIHZhbHVlIG9mIGEgc3BlY2lmaWVkIG5lc3RlZCBwcm9wZXJ0eSBmcm9tIGFsbCBlbGVtZW50cyBpblxuXHQgICAqIHRoZSBPYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBwYXJhbSB7QXJndW1lbnRzfSBhcmd1bWVudHMgVGhlIG5lc3RlZCBwcm9wZXJ0aWVzIHRvIHBsdWNrLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBSZXR1cm5zIGEgbmV3IE9ic2VydmFibGUgc2VxdWVuY2Ugb2YgcHJvcGVydHkgdmFsdWVzLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5wbHVjayA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBpZiAobGVuID09PSAwKSB7IHRocm93IG5ldyBFcnJvcignTGlzdCBvZiBwcm9wZXJ0aWVzIGNhbm5vdCBiZSBlbXB0eS4nKTsgfVxuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHJldHVybiB0aGlzLm1hcChwbHVja2VyKGFyZ3MsIGxlbikpO1xuXHQgIH07XG5cdFxuXHRvYnNlcnZhYmxlUHJvdG8uZmxhdE1hcCA9IG9ic2VydmFibGVQcm90by5zZWxlY3RNYW55ID0gZnVuY3Rpb24oc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdCAgICByZXR1cm4gbmV3IEZsYXRNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykubWVyZ2VBbGwoKTtcblx0fTtcblx0XG5cdFxuXHQvL1xuXHQvL1J4Lk9ic2VydmFibGUucHJvdG90eXBlLmZsYXRNYXBXaXRoTWF4Q29uY3VycmVudCA9IGZ1bmN0aW9uKGxpbWl0LCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0Ly8gICAgcmV0dXJuIG5ldyBGbGF0TWFwT2JzZXJ2YWJsZSh0aGlzLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpLm1lcmdlKGxpbWl0KTtcblx0Ly99O1xuXHQvL1xuXHRcblx0UnguT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcExhdGVzdCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuXHQgICAgcmV0dXJuIG5ldyBGbGF0TWFwT2JzZXJ2YWJsZSh0aGlzLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpLnN3aXRjaExhdGVzdCgpO1xuXHR9O1xuXHQgIHZhciBTa2lwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNraXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU2tpcE9ic2VydmFibGUoc291cmNlLCBjb3VudCkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5za2lwQ291bnQgPSBjb3VudDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdCAgICBcblx0ICAgIFNraXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnNraXBDb3VudCkpO1xuXHQgICAgfTtcblx0ICAgIFxuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBjKSB7XG5cdCAgICAgIHRoaXMuYyA9IGM7XG5cdCAgICAgIHRoaXMuciA9IGM7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICB9XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgIGlmICh0aGlzLnIgPD0gMCkgeyBcblx0ICAgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHRoaXMuci0tO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IHRoaXMuby5vbkVycm9yKGUpOyB9XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IHRoaXMuby5vbkNvbXBsZXRlZCgpOyB9XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24oZSkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH07XG5cdCAgICBcblx0ICAgIHJldHVybiBTa2lwT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7ICBcblx0ICBcblx0ICAvKipcblx0ICAgKiBCeXBhc3NlcyBhIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMgaW4gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhbmQgdGhlbiByZXR1cm5zIHRoZSByZW1haW5pbmcgZWxlbWVudHMuXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gc2tpcCBiZWZvcmUgcmV0dXJuaW5nIHRoZSByZW1haW5pbmcgZWxlbWVudHMuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgdGhhdCBvY2N1ciBhZnRlciB0aGUgc3BlY2lmaWVkIGluZGV4IGluIHRoZSBpbnB1dCBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2tpcCA9IGZ1bmN0aW9uIChjb3VudCkge1xuXHQgICAgaWYgKGNvdW50IDwgMCkgeyB0aHJvdyBuZXcgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IoKTsgfVxuXHQgICAgcmV0dXJuIG5ldyBTa2lwT2JzZXJ2YWJsZSh0aGlzLCBjb3VudCk7XG5cdCAgfTtcblx0ICB2YXIgU2tpcFdoaWxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTa2lwV2hpbGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU2tpcFdoaWxlT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9mbiA9IGZuO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTa2lwV2hpbGVPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgU2tpcFdoaWxlT2JzZXJ2ZXIobywgdGhpcykpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2tpcFdoaWxlT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBTa2lwV2hpbGVPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTa2lwV2hpbGVPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBTa2lwV2hpbGVPYnNlcnZlcihvLCBwKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9wID0gcDtcblx0ICAgICAgdGhpcy5faSA9IDA7XG5cdCAgICAgIHRoaXMuX3IgPSBmYWxzZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2tpcFdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICBpZiAoIXRoaXMuX3IpIHtcblx0ICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5fcC5fZm4pKHgsIHRoaXMuX2krKywgdGhpcy5fcCk7XG5cdCAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgICB0aGlzLl9yID0gIXJlcztcblx0ICAgICAgfVxuXHQgICAgICB0aGlzLl9yICYmIHRoaXMuX28ub25OZXh0KHgpO1xuXHQgICAgfTtcblx0ICAgIFNraXBXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcblx0ICAgIFNraXBXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblx0XG5cdCAgICByZXR1cm4gU2tpcFdoaWxlT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBCeXBhc3NlcyBlbGVtZW50cyBpbiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIGxvbmcgYXMgYSBzcGVjaWZpZWQgY29uZGl0aW9uIGlzIHRydWUgYW5kIHRoZW4gcmV0dXJucyB0aGUgcmVtYWluaW5nIGVsZW1lbnRzLlxuXHQgICAqICBUaGUgZWxlbWVudCdzIGluZGV4IGlzIHVzZWQgaW4gdGhlIGxvZ2ljIG9mIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24uXG5cdCAgICpcblx0ICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5za2lwV2hpbGUoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB2YWx1ZSA8IDEwOyB9KTtcblx0ICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5za2lwV2hpbGUoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgeyByZXR1cm4gdmFsdWUgPCAxMCB8fCBpbmRleCA8IDEwOyB9KTtcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgQSBmdW5jdGlvbiB0byB0ZXN0IGVhY2ggZWxlbWVudCBmb3IgYSBjb25kaXRpb247IHRoZSBzZWNvbmQgcGFyYW1ldGVyIG9mIHRoZSBmdW5jdGlvbiByZXByZXNlbnRzIHRoZSBpbmRleCBvZiB0aGUgc291cmNlIGVsZW1lbnQuXG5cdCAgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgZnJvbSB0aGUgaW5wdXQgc2VxdWVuY2Ugc3RhcnRpbmcgYXQgdGhlIGZpcnN0IGVsZW1lbnQgaW4gdGhlIGxpbmVhciBzZXJpZXMgdGhhdCBkb2VzIG5vdCBwYXNzIHRoZSB0ZXN0IHNwZWNpZmllZCBieSBwcmVkaWNhdGUuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNraXBXaGlsZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHRoaXNBcmcpIHtcblx0ICAgIHZhciBmbiA9IGJpbmRDYWxsYmFjayhwcmVkaWNhdGUsIHRoaXNBcmcsIDMpO1xuXHQgICAgcmV0dXJuIG5ldyBTa2lwV2hpbGVPYnNlcnZhYmxlKHRoaXMsIGZuKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgVGFrZU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUYWtlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIFxuXHQgICAgZnVuY3Rpb24gVGFrZU9ic2VydmFibGUoc291cmNlLCBjb3VudCkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy50YWtlQ291bnQgPSBjb3VudDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdCAgICBcblx0ICAgIFRha2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnRha2VDb3VudCkpO1xuXHQgICAgfTtcblx0ICAgIFxuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBjKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMuYyA9IGM7XG5cdCAgICAgIHRoaXMuciA9IGM7XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICB9XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZSA9IHtcblx0ICAgICAgb25OZXh0OiBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICBpZiAodGhpcy5yLS0gPiAwKSB7XG5cdCAgICAgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuXHQgICAgICAgICAgdGhpcy5yIDw9IDAgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZXJyKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfSxcblx0ICAgICAgZmFpbDogZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBcblx0ICAgIHJldHVybiBUYWtlT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7ICBcblx0ICBcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBhIHNwZWNpZmllZCBudW1iZXIgb2YgY29udGlndW91cyBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciBmb3IgdGhlIGVkZ2UgY2FzZSBvZiB0YWtlKDApLlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHJldHVybi5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHVzZWQgdG8gcHJvZHVjZSBhbiBPbkNvbXBsZXRlZCBtZXNzYWdlIGluIGNhc2UgPHBhcmFtcmVmIG5hbWU9XCJjb3VudCBjb3VudDwvcGFyYW1yZWY+IGlzIHNldCB0byAwLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgdGhlIGlucHV0IHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50YWtlID0gZnVuY3Rpb24gKGNvdW50LCBzY2hlZHVsZXIpIHtcblx0ICAgIGlmIChjb3VudCA8IDApIHsgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yKCk7IH1cblx0ICAgIGlmIChjb3VudCA9PT0gMCkgeyByZXR1cm4gb2JzZXJ2YWJsZUVtcHR5KHNjaGVkdWxlcik7IH1cblx0ICAgIHJldHVybiBuZXcgVGFrZU9ic2VydmFibGUodGhpcywgY291bnQpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBUYWtlV2hpbGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRha2VXaGlsZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUYWtlV2hpbGVPYnNlcnZhYmxlKHNvdXJjZSwgZm4pIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2ZuID0gZm47XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRha2VXaGlsZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBUYWtlV2hpbGVPYnNlcnZlcihvLCB0aGlzKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBUYWtlV2hpbGVPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFRha2VXaGlsZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRha2VXaGlsZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFRha2VXaGlsZU9ic2VydmVyKG8sIHApIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3AgPSBwO1xuXHQgICAgICB0aGlzLl9pID0gMDtcblx0ICAgICAgdGhpcy5fciA9IHRydWU7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRha2VXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgaWYgKHRoaXMuX3IpIHtcblx0ICAgICAgICB0aGlzLl9yID0gdHJ5Q2F0Y2godGhpcy5fcC5fZm4pKHgsIHRoaXMuX2krKywgdGhpcy5fcCk7XG5cdCAgICAgICAgaWYgKHRoaXMuX3IgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IodGhpcy5fci5lKTsgfVxuXHQgICAgICB9XG5cdCAgICAgIGlmICh0aGlzLl9yKSB7XG5cdCAgICAgICAgdGhpcy5fby5vbk5leHQoeCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgVGFrZVdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fby5vbkVycm9yKGUpOyB9O1xuXHQgICAgVGFrZVdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXHRcblx0ICAgIHJldHVybiBUYWtlV2hpbGVPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgZWxlbWVudHMgZnJvbSBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIGxvbmcgYXMgYSBzcGVjaWZpZWQgY29uZGl0aW9uIGlzIHRydWUuXG5cdCAgICogIFRoZSBlbGVtZW50J3MgaW5kZXggaXMgdXNlZCBpbiB0aGUgbG9naWMgb2YgdGhlIHByZWRpY2F0ZSBmdW5jdGlvbi5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgQSBmdW5jdGlvbiB0byB0ZXN0IGVhY2ggZWxlbWVudCBmb3IgYSBjb25kaXRpb247IHRoZSBzZWNvbmQgcGFyYW1ldGVyIG9mIHRoZSBmdW5jdGlvbiByZXByZXNlbnRzIHRoZSBpbmRleCBvZiB0aGUgc291cmNlIGVsZW1lbnQuXG5cdCAgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgZnJvbSB0aGUgaW5wdXQgc2VxdWVuY2UgdGhhdCBvY2N1ciBiZWZvcmUgdGhlIGVsZW1lbnQgYXQgd2hpY2ggdGhlIHRlc3Qgbm8gbG9uZ2VyIHBhc3Nlcy5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udGFrZVdoaWxlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhpc0FyZykge1xuXHQgICAgdmFyIGZuID0gYmluZENhbGxiYWNrKHByZWRpY2F0ZSwgdGhpc0FyZywgMyk7XG5cdCAgICByZXR1cm4gbmV3IFRha2VXaGlsZU9ic2VydmFibGUodGhpcywgZm4pO1xuXHQgIH07XG5cdFxuXHQgIHZhciBGaWx0ZXJPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEZpbHRlck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gRmlsdGVyT2JzZXJ2YWJsZShzb3VyY2UsIHByZWRpY2F0ZSwgdGhpc0FyZykge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5wcmVkaWNhdGUgPSBiaW5kQ2FsbGJhY2socHJlZGljYXRlLCB0aGlzQXJnLCAzKTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRmlsdGVyT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgdGhpcy5wcmVkaWNhdGUsIHRoaXMpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gaW5uZXJQcmVkaWNhdGUocHJlZGljYXRlLCBzZWxmKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbih4LCBpLCBvKSB7IHJldHVybiBzZWxmLnByZWRpY2F0ZSh4LCBpLCBvKSAmJiBwcmVkaWNhdGUuY2FsbCh0aGlzLCB4LCBpLCBvKTsgfVxuXHQgICAgfVxuXHRcblx0ICAgIEZpbHRlck9ic2VydmFibGUucHJvdG90eXBlLmludGVybmFsRmlsdGVyID0gZnVuY3Rpb24ocHJlZGljYXRlLCB0aGlzQXJnKSB7XG5cdCAgICAgIHJldHVybiBuZXcgRmlsdGVyT2JzZXJ2YWJsZSh0aGlzLnNvdXJjZSwgaW5uZXJQcmVkaWNhdGUocHJlZGljYXRlLCB0aGlzKSwgdGhpc0FyZyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBwcmVkaWNhdGUsIHNvdXJjZSkge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLnByZWRpY2F0ZSA9IHByZWRpY2F0ZTtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuaSA9IDA7XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuXHQgICAgICB2YXIgc2hvdWxkWWllbGQgPSB0cnlDYXRjaCh0aGlzLnByZWRpY2F0ZSkoeCwgdGhpcy5pKyssIHRoaXMuc291cmNlKTtcblx0ICAgICAgaWYgKHNob3VsZFlpZWxkID09PSBlcnJvck9iaikge1xuXHQgICAgICAgIHJldHVybiB0aGlzLm8ub25FcnJvcihzaG91bGRZaWVsZC5lKTtcblx0ICAgICAgfVxuXHQgICAgICBzaG91bGRZaWVsZCAmJiB0aGlzLm8ub25OZXh0KHgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRmlsdGVyT2JzZXJ2YWJsZTtcblx0XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAqICBGaWx0ZXJzIHRoZSBlbGVtZW50cyBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGJhc2VkIG9uIGEgcHJlZGljYXRlIGJ5IGluY29ycG9yYXRpbmcgdGhlIGVsZW1lbnQncyBpbmRleC5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWRpY2F0ZSBBIGZ1bmN0aW9uIHRvIHRlc3QgZWFjaCBzb3VyY2UgZWxlbWVudCBmb3IgYSBjb25kaXRpb247IHRoZSBzZWNvbmQgcGFyYW1ldGVyIG9mIHRoZSBmdW5jdGlvbiByZXByZXNlbnRzIHRoZSBpbmRleCBvZiB0aGUgc291cmNlIGVsZW1lbnQuXG5cdCAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgZWxlbWVudHMgZnJvbSB0aGUgaW5wdXQgc2VxdWVuY2UgdGhhdCBzYXRpc2Z5IHRoZSBjb25kaXRpb24uXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uZmlsdGVyID0gb2JzZXJ2YWJsZVByb3RvLndoZXJlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhpc0FyZykge1xuXHQgICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBGaWx0ZXJPYnNlcnZhYmxlID8gdGhpcy5pbnRlcm5hbEZpbHRlcihwcmVkaWNhdGUsIHRoaXNBcmcpIDpcblx0ICAgICAgbmV3IEZpbHRlck9ic2VydmFibGUodGhpcywgcHJlZGljYXRlLCB0aGlzQXJnKTtcblx0ICB9O1xuXHRcblx0ZnVuY3Rpb24gY3JlYXRlQ2JPYnNlcnZhYmxlKGZuLCBjdHgsIHNlbGVjdG9yLCBhcmdzKSB7XG5cdCAgdmFyIG8gPSBuZXcgQXN5bmNTdWJqZWN0KCk7XG5cdFxuXHQgIGFyZ3MucHVzaChjcmVhdGVDYkhhbmRsZXIobywgY3R4LCBzZWxlY3RvcikpO1xuXHQgIGZuLmFwcGx5KGN0eCwgYXJncyk7XG5cdFxuXHQgIHJldHVybiBvLmFzT2JzZXJ2YWJsZSgpO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVDYkhhbmRsZXIobywgY3R4LCBzZWxlY3Rvcikge1xuXHQgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyICgpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCByZXN1bHRzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgcmVzdWx0c1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHRcblx0ICAgIGlmIChpc0Z1bmN0aW9uKHNlbGVjdG9yKSkge1xuXHQgICAgICByZXN1bHRzID0gdHJ5Q2F0Y2goc2VsZWN0b3IpLmFwcGx5KGN0eCwgcmVzdWx0cyk7XG5cdCAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cblx0ICAgICAgby5vbk5leHQocmVzdWx0cyk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBpZiAocmVzdWx0cy5sZW5ndGggPD0gMSkge1xuXHQgICAgICAgIG8ub25OZXh0KHJlc3VsdHNbMF0pO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgIH07XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAqXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIEZ1bmN0aW9uIHdpdGggYSBjYWxsYmFjayBhcyB0aGUgbGFzdCBwYXJhbWV0ZXIgdG8gY29udmVydCB0byBhbiBPYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgKiBAcGFyYW0ge01peGVkfSBbY3R4XSBUaGUgY29udGV4dCBmb3IgdGhlIGZ1bmMgcGFyYW1ldGVyIHRvIGJlIGV4ZWN1dGVkLiAgSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gdW5kZWZpbmVkLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBjYWxsYmFjayB0byBwcm9kdWNlIGEgc2luZ2xlIGl0ZW0gdG8geWllbGQgb24gbmV4dC5cblx0ICogQHJldHVybnMge0Z1bmN0aW9ufSBBIGZ1bmN0aW9uLCB3aGVuIGV4ZWN1dGVkIHdpdGggdGhlIHJlcXVpcmVkIHBhcmFtZXRlcnMgbWludXMgdGhlIGNhbGxiYWNrLCBwcm9kdWNlcyBhbiBPYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggYSBzaW5nbGUgdmFsdWUgb2YgdGhlIGFyZ3VtZW50cyB0byB0aGUgY2FsbGJhY2sgYXMgYW4gYXJyYXkuXG5cdCAqL1xuXHRPYnNlcnZhYmxlLmZyb21DYWxsYmFjayA9IGZ1bmN0aW9uIChmbiwgY3R4LCBzZWxlY3Rvcikge1xuXHQgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICB0eXBlb2YgY3R4ID09PSAndW5kZWZpbmVkJyAmJiAoY3R4ID0gdGhpcyk7IFxuXHRcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbilcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICByZXR1cm4gY3JlYXRlQ2JPYnNlcnZhYmxlKGZuLCBjdHgsIHNlbGVjdG9yLCBhcmdzKTtcblx0ICB9O1xuXHR9O1xuXHRcblx0ZnVuY3Rpb24gY3JlYXRlTm9kZU9ic2VydmFibGUoZm4sIGN0eCwgc2VsZWN0b3IsIGFyZ3MpIHtcblx0ICB2YXIgbyA9IG5ldyBBc3luY1N1YmplY3QoKTtcblx0XG5cdCAgYXJncy5wdXNoKGNyZWF0ZU5vZGVIYW5kbGVyKG8sIGN0eCwgc2VsZWN0b3IpKTtcblx0ICBmbi5hcHBseShjdHgsIGFyZ3MpO1xuXHRcblx0ICByZXR1cm4gby5hc09ic2VydmFibGUoKTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gY3JlYXRlTm9kZUhhbmRsZXIobywgY3R4LCBzZWxlY3Rvcikge1xuXHQgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyICgpIHtcblx0ICAgIHZhciBlcnIgPSBhcmd1bWVudHNbMF07XG5cdCAgICBpZiAoZXJyKSB7IHJldHVybiBvLm9uRXJyb3IoZXJyKTsgfVxuXHRcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCByZXN1bHRzID0gW107XG5cdCAgICBmb3IodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHsgcmVzdWx0c1tpIC0gMV0gPSBhcmd1bWVudHNbaV07IH1cblx0XG5cdCAgICBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHtcblx0ICAgICAgdmFyIHJlc3VsdHMgPSB0cnlDYXRjaChzZWxlY3RvcikuYXBwbHkoY3R4LCByZXN1bHRzKTtcblx0ICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuXHQgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA8PSAxKSB7XG5cdCAgICAgICAgby5vbk5leHQocmVzdWx0c1swXSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgby5vbk5leHQocmVzdWx0cyk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgfTtcblx0fVxuXHRcblx0LyoqXG5cdCAqIENvbnZlcnRzIGEgTm9kZS5qcyBjYWxsYmFjayBzdHlsZSBmdW5jdGlvbiB0byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLiAgVGhpcyBtdXN0IGJlIGluIGZ1bmN0aW9uIChlcnIsIC4uLikgZm9ybWF0LlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY2FsbFxuXHQgKiBAcGFyYW0ge01peGVkfSBbY3R4XSBUaGUgY29udGV4dCBmb3IgdGhlIGZ1bmMgcGFyYW1ldGVyIHRvIGJlIGV4ZWN1dGVkLiAgSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gdW5kZWZpbmVkLlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBjYWxsYmFjayBtaW51cyB0aGUgZXJyb3IgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG5cdCAqIEByZXR1cm5zIHtGdW5jdGlvbn0gQW4gYXN5bmMgZnVuY3Rpb24gd2hpY2ggd2hlbiBhcHBsaWVkLCByZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCB0aGUgY2FsbGJhY2sgYXJndW1lbnRzIGFzIGFuIGFycmF5LlxuXHQgKi9cblx0T2JzZXJ2YWJsZS5mcm9tTm9kZUNhbGxiYWNrID0gZnVuY3Rpb24gKGZuLCBjdHgsIHNlbGVjdG9yKSB7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgIHR5cGVvZiBjdHggPT09ICd1bmRlZmluZWQnICYmIChjdHggPSB0aGlzKTsgXG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHJldHVybiBjcmVhdGVOb2RlT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncyk7XG5cdCAgfTtcblx0fTtcblx0XG5cdCAgZnVuY3Rpb24gaXNOb2RlTGlzdChlbCkge1xuXHQgICAgaWYgKHJvb3QuU3RhdGljTm9kZUxpc3QpIHtcblx0ICAgICAgLy8gSUU4IFNwZWNpZmljXG5cdCAgICAgIC8vIGluc3RhbmNlb2YgaXMgc2xvd2VyIHRoYW4gT2JqZWN0I3RvU3RyaW5nLCBidXQgT2JqZWN0I3RvU3RyaW5nIHdpbGwgbm90IHdvcmsgYXMgaW50ZW5kZWQgaW4gSUU4XG5cdCAgICAgIHJldHVybiBlbCBpbnN0YW5jZW9mIHJvb3QuU3RhdGljTm9kZUxpc3QgfHwgZWwgaW5zdGFuY2VvZiByb290Lk5vZGVMaXN0O1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlbCkgPT09ICdbb2JqZWN0IE5vZGVMaXN0XSc7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBMaXN0ZW5EaXNwb3NhYmxlKGUsIG4sIGZuKSB7XG5cdCAgICB0aGlzLl9lID0gZTtcblx0ICAgIHRoaXMuX24gPSBuO1xuXHQgICAgdGhpcy5fZm4gPSBmbjtcblx0ICAgIHRoaXMuX2UuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLl9uLCB0aGlzLl9mbiwgZmFsc2UpO1xuXHQgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgfVxuXHQgIExpc3RlbkRpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB0aGlzLl9lLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fbiwgdGhpcy5fZm4sIGZhbHNlKTtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBjcmVhdGVFdmVudExpc3RlbmVyIChlbCwgZXZlbnROYW1lLCBoYW5kbGVyKSB7XG5cdCAgICB2YXIgZGlzcG9zYWJsZXMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuXHRcblx0ICAgIC8vIEFzdW1lIE5vZGVMaXN0IG9yIEhUTUxDb2xsZWN0aW9uXG5cdCAgICB2YXIgZWxlbVRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGVsKTtcblx0ICAgIGlmIChpc05vZGVMaXN0KGVsKSB8fCBlbGVtVG9TdHJpbmcgPT09ICdbb2JqZWN0IEhUTUxDb2xsZWN0aW9uXScpIHtcblx0ICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGVsLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgZGlzcG9zYWJsZXMuYWRkKGNyZWF0ZUV2ZW50TGlzdGVuZXIoZWwuaXRlbShpKSwgZXZlbnROYW1lLCBoYW5kbGVyKSk7XG5cdCAgICAgIH1cblx0ICAgIH0gZWxzZSBpZiAoZWwpIHtcblx0ICAgICAgZGlzcG9zYWJsZXMuYWRkKG5ldyBMaXN0ZW5EaXNwb3NhYmxlKGVsLCBldmVudE5hbWUsIGhhbmRsZXIpKTtcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gZGlzcG9zYWJsZXM7XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiBDb25maWd1cmF0aW9uIG9wdGlvbiB0byBkZXRlcm1pbmUgd2hldGhlciB0byB1c2UgbmF0aXZlIGV2ZW50cyBvbmx5XG5cdCAgICovXG5cdCAgUnguY29uZmlnLnVzZU5hdGl2ZUV2ZW50cyA9IGZhbHNlO1xuXHRcblx0ICB2YXIgRXZlbnRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRXZlbnRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRXZlbnRPYnNlcnZhYmxlKGVsLCBuYW1lLCBmbikge1xuXHQgICAgICB0aGlzLl9lbCA9IGVsO1xuXHQgICAgICB0aGlzLl9uID0gbmFtZTtcblx0ICAgICAgdGhpcy5fZm4gPSBmbjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gY3JlYXRlSGFuZGxlcihvLCBmbikge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gaGFuZGxlciAoKSB7XG5cdCAgICAgICAgdmFyIHJlc3VsdHMgPSBhcmd1bWVudHNbMF07XG5cdCAgICAgICAgaWYgKGlzRnVuY3Rpb24oZm4pKSB7XG5cdCAgICAgICAgICByZXN1bHRzID0gdHJ5Q2F0Y2goZm4pLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdCAgICAgICAgICBpZiAocmVzdWx0cyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXN1bHRzLmUpOyB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIEV2ZW50T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiBjcmVhdGVFdmVudExpc3RlbmVyKFxuXHQgICAgICAgIHRoaXMuX2VsLFxuXHQgICAgICAgIHRoaXMuX24sXG5cdCAgICAgICAgY3JlYXRlSGFuZGxlcihvLCB0aGlzLl9mbikpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRXZlbnRPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ3JlYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IGFkZGluZyBhbiBldmVudCBsaXN0ZW5lciB0byB0aGUgbWF0Y2hpbmcgRE9NRWxlbWVudCBvciBlYWNoIGl0ZW0gaW4gdGhlIE5vZGVMaXN0LlxuXHQgICAqIEBwYXJhbSB7T2JqZWN0fSBlbGVtZW50IFRoZSBET01FbGVtZW50IG9yIE5vZGVMaXN0IHRvIGF0dGFjaCBhIGxpc3RlbmVyLlxuXHQgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgVGhlIGV2ZW50IG5hbWUgdG8gYXR0YWNoIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gQSBzZWxlY3RvciB3aGljaCB0YWtlcyB0aGUgYXJndW1lbnRzIGZyb20gdGhlIGV2ZW50IGhhbmRsZXIgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2YgZXZlbnRzIGZyb20gdGhlIHNwZWNpZmllZCBlbGVtZW50IGFuZCB0aGUgc3BlY2lmaWVkIGV2ZW50LlxuXHQgICAqL1xuXHQgIE9ic2VydmFibGUuZnJvbUV2ZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50TmFtZSwgc2VsZWN0b3IpIHtcblx0ICAgIC8vIE5vZGUuanMgc3BlY2lmaWNcblx0ICAgIGlmIChlbGVtZW50LmFkZExpc3RlbmVyKSB7XG5cdCAgICAgIHJldHVybiBmcm9tRXZlbnRQYXR0ZXJuKFxuXHQgICAgICAgIGZ1bmN0aW9uIChoKSB7IGVsZW1lbnQuYWRkTGlzdGVuZXIoZXZlbnROYW1lLCBoKTsgfSxcblx0ICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50LnJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgaCk7IH0sXG5cdCAgICAgICAgc2VsZWN0b3IpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIFVzZSBvbmx5IGlmIG5vbi1uYXRpdmUgZXZlbnRzIGFyZSBhbGxvd2VkXG5cdCAgICBpZiAoIVJ4LmNvbmZpZy51c2VOYXRpdmVFdmVudHMpIHtcblx0ICAgICAgLy8gSGFuZGxlcyBqcSwgQW5ndWxhci5qcywgWmVwdG8sIE1hcmlvbmV0dGUsIEVtYmVyLmpzXG5cdCAgICAgIGlmICh0eXBlb2YgZWxlbWVudC5vbiA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgZWxlbWVudC5vZmYgPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICByZXR1cm4gZnJvbUV2ZW50UGF0dGVybihcblx0ICAgICAgICAgIGZ1bmN0aW9uIChoKSB7IGVsZW1lbnQub24oZXZlbnROYW1lLCBoKTsgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uIChoKSB7IGVsZW1lbnQub2ZmKGV2ZW50TmFtZSwgaCk7IH0sXG5cdCAgICAgICAgICBzZWxlY3Rvcik7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gbmV3IEV2ZW50T2JzZXJ2YWJsZShlbGVtZW50LCBldmVudE5hbWUsIHNlbGVjdG9yKS5wdWJsaXNoKCkucmVmQ291bnQoKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEV2ZW50UGF0dGVybk9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBFdmVudFBhdHRlcm5PYnNlcnZhYmxlKGFkZCwgZGVsLCBmbikge1xuXHQgICAgICB0aGlzLl9hZGQgPSBhZGQ7XG5cdCAgICAgIHRoaXMuX2RlbCA9IGRlbDtcblx0ICAgICAgdGhpcy5fZm4gPSBmbjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gY3JlYXRlSGFuZGxlcihvLCBmbikge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gaGFuZGxlciAoKSB7XG5cdCAgICAgICAgdmFyIHJlc3VsdHMgPSBhcmd1bWVudHNbMF07XG5cdCAgICAgICAgaWYgKGlzRnVuY3Rpb24oZm4pKSB7XG5cdCAgICAgICAgICByZXN1bHRzID0gdHJ5Q2F0Y2goZm4pLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdCAgICAgICAgICBpZiAocmVzdWx0cyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXN1bHRzLmUpOyB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIEV2ZW50UGF0dGVybk9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgZm4gPSBjcmVhdGVIYW5kbGVyKG8sIHRoaXMuX2ZuKTtcblx0ICAgICAgdmFyIHJldHVyblZhbHVlID0gdGhpcy5fYWRkKGZuKTtcblx0ICAgICAgcmV0dXJuIG5ldyBFdmVudFBhdHRlcm5EaXNwb3NhYmxlKHRoaXMuX2RlbCwgZm4sIHJldHVyblZhbHVlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gRXZlbnRQYXR0ZXJuRGlzcG9zYWJsZShkZWwsIGZuLCByZXQpIHtcblx0ICAgICAgdGhpcy5fZGVsID0gZGVsO1xuXHQgICAgICB0aGlzLl9mbiA9IGZuO1xuXHQgICAgICB0aGlzLl9yZXQgPSByZXQ7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIEV2ZW50UGF0dGVybkRpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgICBpc0Z1bmN0aW9uKHRoaXMuX2RlbCkgJiYgdGhpcy5fZGVsKHRoaXMuX2ZuLCB0aGlzLl9yZXQpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBFdmVudFBhdHRlcm5PYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ3JlYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGZyb20gYW4gZXZlbnQgZW1pdHRlciB2aWEgYW4gYWRkSGFuZGxlci9yZW1vdmVIYW5kbGVyIHBhaXIuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWRkSGFuZGxlciBUaGUgZnVuY3Rpb24gdG8gYWRkIGEgaGFuZGxlciB0byB0aGUgZW1pdHRlci5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVtb3ZlSGFuZGxlcl0gVGhlIG9wdGlvbmFsIGZ1bmN0aW9uIHRvIHJlbW92ZSBhIGhhbmRsZXIgZnJvbSBhbiBlbWl0dGVyLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gQSBzZWxlY3RvciB3aGljaCB0YWtlcyB0aGUgYXJndW1lbnRzIGZyb20gdGhlIGV2ZW50IGhhbmRsZXIgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggd3JhcHMgYW4gZXZlbnQgZnJvbSBhbiBldmVudCBlbWl0dGVyXG5cdCAgICovXG5cdCAgdmFyIGZyb21FdmVudFBhdHRlcm4gPSBPYnNlcnZhYmxlLmZyb21FdmVudFBhdHRlcm4gPSBmdW5jdGlvbiAoYWRkSGFuZGxlciwgcmVtb3ZlSGFuZGxlciwgc2VsZWN0b3IpIHtcblx0ICAgIHJldHVybiBuZXcgRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZShhZGRIYW5kbGVyLCByZW1vdmVIYW5kbGVyLCBzZWxlY3RvcikucHVibGlzaCgpLnJlZkNvdW50KCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIEZyb21Qcm9taXNlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEZyb21Qcm9taXNlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEZyb21Qcm9taXNlT2JzZXJ2YWJsZShwLCBzKSB7XG5cdCAgICAgIHRoaXMuX3AgPSBwO1xuXHQgICAgICB0aGlzLl9zID0gcztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2NoZWR1bGVOZXh0KHMsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBvID0gc3RhdGVbMF0sIGRhdGEgPSBzdGF0ZVsxXTtcblx0ICAgICAgby5vbk5leHQoZGF0YSk7XG5cdCAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzY2hlZHVsZUVycm9yKHMsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBvID0gc3RhdGVbMF0sIGVyciA9IHN0YXRlWzFdO1xuXHQgICAgICBvLm9uRXJyb3IoZXJyKTtcblx0ICAgIH1cblx0XG5cdCAgICBGcm9tUHJvbWlzZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG5cdCAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSwgc2VsZiA9IHRoaXM7XG5cdFxuXHQgICAgICB0aGlzLl9wXG5cdCAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblx0ICAgICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNlbGYuX3Muc2NoZWR1bGUoW28sIGRhdGFdLCBzY2hlZHVsZU5leHQpKTtcblx0ICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShzZWxmLl9zLnNjaGVkdWxlKFtvLCBlcnJdLCBzY2hlZHVsZUVycm9yKSk7XG5cdCAgICAgICAgfSk7XG5cdFxuXHQgICAgICByZXR1cm4gc2FkO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRnJvbVByb21pc2VPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiBDb252ZXJ0cyBhIFByb21pc2UgdG8gYW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZVxuXHQgICogQHBhcmFtIHtQcm9taXNlfSBBbiBFUzYgQ29tcGxpYW50IHByb21pc2UuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB3cmFwcyB0aGUgZXhpc3RpbmcgcHJvbWlzZSBzdWNjZXNzIGFuZCBmYWlsdXJlLlxuXHQgICovXG5cdCAgdmFyIG9ic2VydmFibGVGcm9tUHJvbWlzZSA9IE9ic2VydmFibGUuZnJvbVByb21pc2UgPSBmdW5jdGlvbiAocHJvbWlzZSwgc2NoZWR1bGVyKSB7XG5cdCAgICBzY2hlZHVsZXIgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBGcm9tUHJvbWlzZU9ic2VydmFibGUocHJvbWlzZSwgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICAvKlxuXHQgICAqIENvbnZlcnRzIGFuIGV4aXN0aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgdG8gYW4gRVM2IENvbXBhdGlibGUgUHJvbWlzZVxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHByb21pc2UgPSBSeC5PYnNlcnZhYmxlLnJldHVybig0MikudG9Qcm9taXNlKFJTVlAuUHJvbWlzZSk7XG5cdCAgICpcblx0ICAgKiAvLyBXaXRoIGNvbmZpZ1xuXHQgICAqIFJ4LmNvbmZpZy5Qcm9taXNlID0gUlNWUC5Qcm9taXNlO1xuXHQgICAqIHZhciBwcm9taXNlID0gUnguT2JzZXJ2YWJsZS5yZXR1cm4oNDIpLnRvUHJvbWlzZSgpO1xuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtwcm9taXNlQ3Rvcl0gVGhlIGNvbnN0cnVjdG9yIG9mIHRoZSBwcm9taXNlLiBJZiBub3QgcHJvdmlkZWQsIGl0IGxvb2tzIGZvciBpdCBpbiBSeC5jb25maWcuUHJvbWlzZS5cblx0ICAgKiBAcmV0dXJucyB7UHJvbWlzZX0gQW4gRVM2IGNvbXBhdGlibGUgcHJvbWlzZSB3aXRoIHRoZSBsYXN0IHZhbHVlIGZyb20gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRvUHJvbWlzZSA9IGZ1bmN0aW9uIChwcm9taXNlQ3Rvcikge1xuXHQgICAgcHJvbWlzZUN0b3IgfHwgKHByb21pc2VDdG9yID0gUnguY29uZmlnLlByb21pc2UpO1xuXHQgICAgaWYgKCFwcm9taXNlQ3RvcikgeyB0aHJvdyBuZXcgTm90U3VwcG9ydGVkRXJyb3IoJ1Byb21pc2UgdHlwZSBub3QgcHJvdmlkZWQgbm9yIGluIFJ4LmNvbmZpZy5Qcm9taXNlJyk7IH1cblx0ICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuXHQgICAgcmV0dXJuIG5ldyBwcm9taXNlQ3RvcihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgIC8vIE5vIGNhbmNlbGxhdGlvbiBjYW4gYmUgZG9uZVxuXHQgICAgICB2YXIgdmFsdWU7XG5cdCAgICAgIHNvdXJjZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHYpIHtcblx0ICAgICAgICB2YWx1ZSA9IHY7XG5cdCAgICAgIH0sIHJlamVjdCwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJlc29sdmUodmFsdWUpO1xuXHQgICAgICB9KTtcblx0ICAgIH0pO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEludm9rZXMgdGhlIGFzeW5jaHJvbm91cyBmdW5jdGlvbiwgc3VyZmFjaW5nIHRoZSByZXN1bHQgdGhyb3VnaCBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmN0aW9uQXN5bmMgQXN5bmNocm9ub3VzIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYSBQcm9taXNlIHRvIHJ1bi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBleHBvc2luZyB0aGUgZnVuY3Rpb24ncyByZXN1bHQgdmFsdWUsIG9yIGFuIGV4Y2VwdGlvbi5cblx0ICAgKi9cblx0ICBPYnNlcnZhYmxlLnN0YXJ0QXN5bmMgPSBmdW5jdGlvbiAoZnVuY3Rpb25Bc3luYykge1xuXHQgICAgdmFyIHByb21pc2UgPSB0cnlDYXRjaChmdW5jdGlvbkFzeW5jKSgpO1xuXHQgICAgaWYgKHByb21pc2UgPT09IGVycm9yT2JqKSB7IHJldHVybiBvYnNlcnZhYmxlVGhyb3cocHJvbWlzZS5lKTsgfVxuXHQgICAgcmV0dXJuIG9ic2VydmFibGVGcm9tUHJvbWlzZShwcm9taXNlKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgTXVsdGljYXN0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhNdWx0aWNhc3RPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gTXVsdGljYXN0T2JzZXJ2YWJsZShzb3VyY2UsIGZuMSwgZm4yKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9mbjEgPSBmbjE7XG5cdCAgICAgIHRoaXMuX2ZuMiA9IGZuMjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgTXVsdGljYXN0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBjb25uZWN0YWJsZSA9IHRoaXMuc291cmNlLm11bHRpY2FzdCh0aGlzLl9mbjEoKSk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZSh0aGlzLl9mbjIoY29ubmVjdGFibGUpLnN1YnNjcmliZShvKSwgY29ubmVjdGFibGUuY29ubmVjdCgpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE11bHRpY2FzdE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBNdWx0aWNhc3RzIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugbm90aWZpY2F0aW9ucyB0aHJvdWdoIGFuIGluc3RhbnRpYXRlZCBzdWJqZWN0IGludG8gYWxsIHVzZXMgb2YgdGhlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLiBFYWNoXG5cdCAgICogc3Vic2NyaXB0aW9uIHRvIHRoZSByZXN1bHRpbmcgc2VxdWVuY2UgY2F1c2VzIGEgc2VwYXJhdGUgbXVsdGljYXN0IGludm9jYXRpb24sIGV4cG9zaW5nIHRoZSBzZXF1ZW5jZSByZXN1bHRpbmcgZnJvbSB0aGUgc2VsZWN0b3IgZnVuY3Rpb24nc1xuXHQgICAqIGludm9jYXRpb24uIEZvciBzcGVjaWFsaXphdGlvbnMgd2l0aCBmaXhlZCBzdWJqZWN0IHR5cGVzLCBzZWUgUHVibGlzaCwgUHVibGlzaExhc3QsIGFuZCBSZXBsYXkuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIDEgLSByZXMgPSBzb3VyY2UubXVsdGljYXN0KG9ic2VydmFibGUpO1xuXHQgICAqIDIgLSByZXMgPSBzb3VyY2UubXVsdGljYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBTdWJqZWN0KCk7IH0sIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb258U3ViamVjdH0gc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yXG5cdCAgICogRmFjdG9yeSBmdW5jdGlvbiB0byBjcmVhdGUgYW4gaW50ZXJtZWRpYXRlIHN1YmplY3QgdGhyb3VnaCB3aGljaCB0aGUgc291cmNlIHNlcXVlbmNlJ3MgZWxlbWVudHMgd2lsbCBiZSBtdWx0aWNhc3QgdG8gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqIE9yOlxuXHQgICAqIFN1YmplY3QgdG8gcHVzaCBzb3VyY2UgZWxlbWVudHMgaW50by5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gT3B0aW9uYWwgc2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIHN1YmplY3QgdG8gdGhlIHBvbGljaWVzIGVuZm9yY2VkIGJ5IHRoZSBjcmVhdGVkIHN1YmplY3QuIFNwZWNpZmllZCBvbmx5IGlmIDxwYXJhbXJlZiBuYW1lPVwic3ViamVjdE9yU3ViamVjdFNlbGVjdG9yXCIgaXMgYSBmYWN0b3J5IGZ1bmN0aW9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLm11bHRpY2FzdCA9IGZ1bmN0aW9uIChzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IsIHNlbGVjdG9yKSB7XG5cdCAgICByZXR1cm4gaXNGdW5jdGlvbihzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IpID9cblx0ICAgICAgbmV3IE11bHRpY2FzdE9ic2VydmFibGUodGhpcywgc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yLCBzZWxlY3RvcikgOlxuXHQgICAgICBuZXcgQ29ubmVjdGFibGVPYnNlcnZhYmxlKHRoaXMsIHN1YmplY3RPclN1YmplY3RTZWxlY3Rvcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgc2VsZWN0b3Igb24gYSBjb25uZWN0YWJsZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cblx0ICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgTXVsdGljYXN0IHVzaW5nIGEgcmVndWxhciBTdWJqZWN0LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgcmVzcmVzID0gc291cmNlLnB1Ymxpc2goKTtcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2goZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuXHQgICAqXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBTZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2UgYXMgbWFueSB0aW1lcyBhcyBuZWVkZWQsIHdpdGhvdXQgY2F1c2luZyBtdWx0aXBsZSBzdWJzY3JpcHRpb25zIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UuIFN1YnNjcmliZXJzIHRvIHRoZSBnaXZlbiBzb3VyY2Ugd2lsbCByZWNlaXZlIGFsbCBub3RpZmljYXRpb25zIG9mIHRoZSBzb3VyY2UgZnJvbSB0aGUgdGltZSBvZiB0aGUgc3Vic2NyaXB0aW9uIG9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2ggPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcblx0ICAgIHJldHVybiBzZWxlY3RvciAmJiBpc0Z1bmN0aW9uKHNlbGVjdG9yKSA/XG5cdCAgICAgIHRoaXMubXVsdGljYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBTdWJqZWN0KCk7IH0sIHNlbGVjdG9yKSA6XG5cdCAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBTdWJqZWN0KCkpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG5cdCAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIHB1Ymxpc2ggd2hpY2ggY3JlYXRlcyBhIHN1YnNjcmlwdGlvbiB3aGVuIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIGdvZXMgZnJvbSB6ZXJvIHRvIG9uZSwgdGhlbiBzaGFyZXMgdGhhdCBzdWJzY3JpcHRpb24gd2l0aCBhbGwgc3Vic2VxdWVudCBvYnNlcnZlcnMgdW50aWwgdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgcmV0dXJucyB0byB6ZXJvLCBhdCB3aGljaCBwb2ludCB0aGUgc3Vic2NyaXB0aW9uIGlzIGRpc3Bvc2VkLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNoYXJlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXMucHVibGlzaCgpLnJlZkNvdW50KCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgc2VsZWN0b3Igb24gYSBjb25uZWN0YWJsZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSBjb250YWluaW5nIG9ubHkgdGhlIGxhc3Qgbm90aWZpY2F0aW9uLlxuXHQgICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBNdWx0aWNhc3QgdXNpbmcgYSBBc3luY1N1YmplY3QuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucHVibGlzaExhc3QoKTtcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hMYXN0KGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcblx0ICAgKlxuXHQgICAqIEBwYXJhbSBzZWxlY3RvciBbT3B0aW9uYWxdIFNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBhcyBtYW55IHRpbWVzIGFzIG5lZWRlZCwgd2l0aG91dCBjYXVzaW5nIG11bHRpcGxlIHN1YnNjcmlwdGlvbnMgdG8gdGhlIHNvdXJjZSBzZXF1ZW5jZS4gU3Vic2NyaWJlcnMgdG8gdGhlIGdpdmVuIHNvdXJjZSB3aWxsIG9ubHkgcmVjZWl2ZSB0aGUgbGFzdCBub3RpZmljYXRpb24gb2YgdGhlIHNvdXJjZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5wdWJsaXNoTGFzdCA9IGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuXHQgICAgcmV0dXJuIHNlbGVjdG9yICYmIGlzRnVuY3Rpb24oc2VsZWN0b3IpID9cblx0ICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IEFzeW5jU3ViamVjdCgpOyB9LCBzZWxlY3RvcikgOlxuXHQgICAgICB0aGlzLm11bHRpY2FzdChuZXcgQXN5bmNTdWJqZWN0KCkpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgYW5kIHN0YXJ0cyB3aXRoIGluaXRpYWxWYWx1ZS5cblx0ICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgTXVsdGljYXN0IHVzaW5nIGEgQmVoYXZpb3JTdWJqZWN0LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hWYWx1ZSg0Mik7XG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoVmFsdWUoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHguc2VsZWN0KGZ1bmN0aW9uICh5KSB7IHJldHVybiB5ICogeTsgfSkgfSwgNDIpO1xuXHQgICAqXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBPcHRpb25hbCBzZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2UgYXMgbWFueSB0aW1lcyBhcyBuZWVkZWQsIHdpdGhvdXQgY2F1c2luZyBtdWx0aXBsZSBzdWJzY3JpcHRpb25zIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UuIFN1YnNjcmliZXJzIHRvIHRoZSBnaXZlbiBzb3VyY2Ugd2lsbCByZWNlaXZlIGltbWVkaWF0ZWx5IHJlY2VpdmUgdGhlIGluaXRpYWwgdmFsdWUsIGZvbGxvd2VkIGJ5IGFsbCBub3RpZmljYXRpb25zIG9mIHRoZSBzb3VyY2UgZnJvbSB0aGUgdGltZSBvZiB0aGUgc3Vic2NyaXB0aW9uIG9uLlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IGluaXRpYWxWYWx1ZSBJbml0aWFsIHZhbHVlIHJlY2VpdmVkIGJ5IG9ic2VydmVycyB1cG9uIHN1YnNjcmlwdGlvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5wdWJsaXNoVmFsdWUgPSBmdW5jdGlvbiAoaW5pdGlhbFZhbHVlT3JTZWxlY3RvciwgaW5pdGlhbFZhbHVlKSB7XG5cdCAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMiA/XG5cdCAgICAgIHRoaXMubXVsdGljYXN0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IEJlaGF2aW9yU3ViamVjdChpbml0aWFsVmFsdWUpO1xuXHQgICAgICB9LCBpbml0aWFsVmFsdWVPclNlbGVjdG9yKSA6XG5cdCAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBCZWhhdmlvclN1YmplY3QoaW5pdGlhbFZhbHVlT3JTZWxlY3RvcikpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgYW5kIHN0YXJ0cyB3aXRoIGFuIGluaXRpYWxWYWx1ZS5cblx0ICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgcHVibGlzaFZhbHVlIHdoaWNoIGNyZWF0ZXMgYSBzdWJzY3JpcHRpb24gd2hlbiB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyBnb2VzIGZyb20gemVybyB0byBvbmUsIHRoZW4gc2hhcmVzIHRoYXQgc3Vic2NyaXB0aW9uIHdpdGggYWxsIHN1YnNlcXVlbnQgb2JzZXJ2ZXJzIHVudGlsIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIHJldHVybnMgdG8gemVybywgYXQgd2hpY2ggcG9pbnQgdGhlIHN1YnNjcmlwdGlvbiBpcyBkaXNwb3NlZC5cblx0ICAgKiBAcGFyYW0ge01peGVkfSBpbml0aWFsVmFsdWUgSW5pdGlhbCB2YWx1ZSByZWNlaXZlZCBieSBvYnNlcnZlcnMgdXBvbiBzdWJzY3JpcHRpb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2hhcmVWYWx1ZSA9IGZ1bmN0aW9uIChpbml0aWFsVmFsdWUpIHtcblx0ICAgIHJldHVybiB0aGlzLnB1Ymxpc2hWYWx1ZShpbml0aWFsVmFsdWUpLnJlZkNvdW50KCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgc2VsZWN0b3Igb24gYSBjb25uZWN0YWJsZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSByZXBsYXlpbmcgbm90aWZpY2F0aW9ucyBzdWJqZWN0IHRvIGEgbWF4aW11bSB0aW1lIGxlbmd0aCBmb3IgdGhlIHJlcGxheSBidWZmZXIuXG5cdCAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIFJlcGxheVN1YmplY3QuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucmVwbGF5KG51bGwsIDMpO1xuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucmVwbGF5KG51bGwsIDMsIDUwMCk7XG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5yZXBsYXkobnVsbCwgMywgNTAwLCBzY2hlZHVsZXIpO1xuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucmVwbGF5KGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRha2UoNikucmVwZWF0KCk7IH0sIDMsIDUwMCwgc2NoZWR1bGVyKTtcblx0ICAgKlxuXHQgICAqIEBwYXJhbSBzZWxlY3RvciBbT3B0aW9uYWxdIFNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBhcyBtYW55IHRpbWVzIGFzIG5lZWRlZCwgd2l0aG91dCBjYXVzaW5nIG11bHRpcGxlIHN1YnNjcmlwdGlvbnMgdG8gdGhlIHNvdXJjZSBzZXF1ZW5jZS4gU3Vic2NyaWJlcnMgdG8gdGhlIGdpdmVuIHNvdXJjZSB3aWxsIHJlY2VpdmUgYWxsIHRoZSBub3RpZmljYXRpb25zIG9mIHRoZSBzb3VyY2Ugc3ViamVjdCB0byB0aGUgc3BlY2lmaWVkIHJlcGxheSBidWZmZXIgdHJpbW1pbmcgcG9saWN5LlxuXHQgICAqIEBwYXJhbSBidWZmZXJTaXplIFtPcHRpb25hbF0gTWF4aW11bSBlbGVtZW50IGNvdW50IG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuXHQgICAqIEBwYXJhbSB3aW5kb3dTaXplIFtPcHRpb25hbF0gTWF4aW11bSB0aW1lIGxlbmd0aCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cblx0ICAgKiBAcGFyYW0gc2NoZWR1bGVyIFtPcHRpb25hbF0gU2NoZWR1bGVyIHdoZXJlIGNvbm5lY3RlZCBvYnNlcnZlcnMgd2l0aGluIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucmVwbGF5ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpIHtcblx0ICAgIHJldHVybiBzZWxlY3RvciAmJiBpc0Z1bmN0aW9uKHNlbGVjdG9yKSA/XG5cdCAgICAgIHRoaXMubXVsdGljYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBSZXBsYXlTdWJqZWN0KGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcik7IH0sIHNlbGVjdG9yKSA6XG5cdCAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBSZXBsYXlTdWJqZWN0KGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgcmVwbGF5aW5nIG5vdGlmaWNhdGlvbnMgc3ViamVjdCB0byBhIG1heGltdW0gdGltZSBsZW5ndGggZm9yIHRoZSByZXBsYXkgYnVmZmVyLlxuXHQgICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiByZXBsYXkgd2hpY2ggY3JlYXRlcyBhIHN1YnNjcmlwdGlvbiB3aGVuIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIGdvZXMgZnJvbSB6ZXJvIHRvIG9uZSwgdGhlbiBzaGFyZXMgdGhhdCBzdWJzY3JpcHRpb24gd2l0aCBhbGwgc3Vic2VxdWVudCBvYnNlcnZlcnMgdW50aWwgdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgcmV0dXJucyB0byB6ZXJvLCBhdCB3aGljaCBwb2ludCB0aGUgc3Vic2NyaXB0aW9uIGlzIGRpc3Bvc2VkLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnNoYXJlUmVwbGF5KDMpO1xuXHQgICAqIHZhciByZXMgPSBzb3VyY2Uuc2hhcmVSZXBsYXkoMywgNTAwKTtcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnNoYXJlUmVwbGF5KDMsIDUwMCwgc2NoZWR1bGVyKTtcblx0ICAgKlxuXHRcblx0ICAgKiBAcGFyYW0gYnVmZmVyU2l6ZSBbT3B0aW9uYWxdIE1heGltdW0gZWxlbWVudCBjb3VudCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cblx0ICAgKiBAcGFyYW0gd2luZG93IFtPcHRpb25hbF0gTWF4aW11bSB0aW1lIGxlbmd0aCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cblx0ICAgKiBAcGFyYW0gc2NoZWR1bGVyIFtPcHRpb25hbF0gU2NoZWR1bGVyIHdoZXJlIGNvbm5lY3RlZCBvYnNlcnZlcnMgd2l0aGluIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc2hhcmVSZXBsYXkgPSBmdW5jdGlvbiAoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSB7XG5cdCAgICByZXR1cm4gdGhpcy5yZXBsYXkobnVsbCwgYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKS5yZWZDb3VudCgpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBSZWZDb3VudE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoUmVmQ291bnRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gUmVmQ291bnRPYnNlcnZhYmxlKHNvdXJjZSkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fY291bnQgPSAwO1xuXHQgICAgICB0aGlzLl9jb25uZWN0YWJsZVN1YnNjcmlwdGlvbiA9IG51bGw7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFJlZkNvdW50T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBzaG91bGRDb25uZWN0ID0gKyt0aGlzLl9jb3VudCA9PT0gMSwgc3Vic2NyaXB0aW9uID0gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG8pO1xuXHQgICAgICBzaG91bGRDb25uZWN0ICYmICh0aGlzLl9jb25uZWN0YWJsZVN1YnNjcmlwdGlvbiA9IHRoaXMuc291cmNlLmNvbm5lY3QoKSk7XG5cdCAgICAgIHJldHVybiBuZXcgUmVmQ291bnREaXNwb3NhYmxlKHRoaXMsIHN1YnNjcmlwdGlvbik7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIFJlZkNvdW50RGlzcG9zYWJsZShwLCBzKSB7XG5cdCAgICAgIHRoaXMuX3AgPSBwO1xuXHQgICAgICB0aGlzLl9zID0gcztcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgUmVmQ291bnREaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5fcy5kaXNwb3NlKCk7XG5cdCAgICAgICAgLS10aGlzLl9wLl9jb3VudCA9PT0gMCAmJiB0aGlzLl9wLl9jb25uZWN0YWJsZVN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFJlZkNvdW50T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBDb25uZWN0YWJsZU9ic2VydmFibGUgPSBSeC5Db25uZWN0YWJsZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ29ubmVjdGFibGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ29ubmVjdGFibGVPYnNlcnZhYmxlKHNvdXJjZSwgc3ViamVjdCkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5faGFzU3Vic2NyaXB0aW9uICA9IGZhbHNlO1xuXHQgICAgICB0aGlzLl9zdWJzY3JpcHRpb24gPSBudWxsO1xuXHQgICAgICB0aGlzLl9zb3VyY2VPYnNlcnZhYmxlID0gc291cmNlLmFzT2JzZXJ2YWJsZSgpO1xuXHQgICAgICB0aGlzLl9zdWJqZWN0ID0gc3ViamVjdDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gQ29ubmVjdERpc3Bvc2FibGUocGFyZW50KSB7XG5cdCAgICAgIHRoaXMuX3AgPSBwYXJlbnQ7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIENvbm5lY3REaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5fcC5faGFzU3Vic2NyaXB0aW9uID0gZmFsc2U7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgQ29ubmVjdGFibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5jb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAoIXRoaXMuX2hhc1N1YnNjcmlwdGlvbikge1xuXHQgICAgICAgIHRoaXMuX2hhc1N1YnNjcmlwdGlvbiA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5fc3Vic2NyaXB0aW9uID0gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG5cdCAgICAgICAgICB0aGlzLl9zb3VyY2VPYnNlcnZhYmxlLnN1YnNjcmliZSh0aGlzLl9zdWJqZWN0KSxcblx0ICAgICAgICAgIG5ldyBDb25uZWN0RGlzcG9zYWJsZSh0aGlzKVxuXHQgICAgICAgICk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmlwdGlvbjtcblx0ICAgIH07XG5cdFxuXHQgICAgQ29ubmVjdGFibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuX3N1YmplY3Quc3Vic2NyaWJlKG8pO1xuXHQgICAgfTtcblx0XG5cdCAgICBDb25uZWN0YWJsZU9ic2VydmFibGUucHJvdG90eXBlLnJlZkNvdW50ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gbmV3IFJlZkNvdW50T2JzZXJ2YWJsZSh0aGlzKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIENvbm5lY3RhYmxlT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgdmFyIFRpbWVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRpbWVyT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRpbWVyT2JzZXJ2YWJsZShkdCwgcykge1xuXHQgICAgICB0aGlzLl9kdCA9IGR0O1xuXHQgICAgICB0aGlzLl9zID0gcztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGltZXJPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuX3Muc2NoZWR1bGVGdXR1cmUobywgdGhpcy5fZHQsIHNjaGVkdWxlTWV0aG9kKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gc2NoZWR1bGVNZXRob2Qocywgbykge1xuXHQgICAgICBvLm9uTmV4dCgwKTtcblx0ICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiBUaW1lck9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICBmdW5jdGlvbiBfb2JzZXJ2YWJsZVRpbWVyKGR1ZVRpbWUsIHNjaGVkdWxlcikge1xuXHQgICAgcmV0dXJuIG5ldyBUaW1lck9ic2VydmFibGUoZHVlVGltZSwgc2NoZWR1bGVyKTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIG9ic2VydmFibGVUaW1lckRhdGVBbmRQZXJpb2QoZHVlVGltZSwgcGVyaW9kLCBzY2hlZHVsZXIpIHtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIGQgPSBkdWVUaW1lLCBwID0gbm9ybWFsaXplVGltZShwZXJpb2QpO1xuXHQgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlKDAsIGQsIGZ1bmN0aW9uIChjb3VudCwgc2VsZikge1xuXHQgICAgICAgIGlmIChwID4gMCkge1xuXHQgICAgICAgICAgdmFyIG5vdyA9IHNjaGVkdWxlci5ub3coKTtcblx0ICAgICAgICAgIGQgPSBuZXcgRGF0ZShkLmdldFRpbWUoKSArIHApO1xuXHQgICAgICAgICAgZC5nZXRUaW1lKCkgPD0gbm93ICYmIChkID0gbmV3IERhdGUobm93ICsgcCkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBvYnNlcnZlci5vbk5leHQoY291bnQpO1xuXHQgICAgICAgIHNlbGYoY291bnQgKyAxLCBuZXcgRGF0ZShkKSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfSk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZChkdWVUaW1lLCBwZXJpb2QsIHNjaGVkdWxlcikge1xuXHQgICAgcmV0dXJuIGR1ZVRpbWUgPT09IHBlcmlvZCA/XG5cdCAgICAgIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICAgIHJldHVybiBzY2hlZHVsZXIuc2NoZWR1bGVQZXJpb2RpYygwLCBwZXJpb2QsIGZ1bmN0aW9uIChjb3VudCkge1xuXHQgICAgICAgICAgb2JzZXJ2ZXIub25OZXh0KGNvdW50KTtcblx0ICAgICAgICAgIHJldHVybiBjb3VudCArIDE7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0pIDpcblx0ICAgICAgb2JzZXJ2YWJsZURlZmVyKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZChuZXcgRGF0ZShzY2hlZHVsZXIubm93KCkgKyBkdWVUaW1lKSwgcGVyaW9kLCBzY2hlZHVsZXIpO1xuXHQgICAgICB9KTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBwcm9kdWNlcyBhIHZhbHVlIGFmdGVyIGVhY2ggcGVyaW9kLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAgMSAtIHJlcyA9IFJ4Lk9ic2VydmFibGUuaW50ZXJ2YWwoMTAwMCk7XG5cdCAgICogIDIgLSByZXMgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMDAsIFJ4LlNjaGVkdWxlci50aW1lb3V0KTtcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBwZXJpb2QgUGVyaW9kIGZvciBwcm9kdWNpbmcgdGhlIHZhbHVlcyBpbiB0aGUgcmVzdWx0aW5nIHNlcXVlbmNlIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpLlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSB0aW1lciBvbi4gSWYgbm90IHNwZWNpZmllZCwgUnguU2NoZWR1bGVyLnRpbWVvdXQgaXMgdXNlZC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZWFjaCBwZXJpb2QuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVpbnRlcnZhbCA9IE9ic2VydmFibGUuaW50ZXJ2YWwgPSBmdW5jdGlvbiAocGVyaW9kLCBzY2hlZHVsZXIpIHtcblx0ICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZChwZXJpb2QsIHBlcmlvZCwgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSA/IHNjaGVkdWxlciA6IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBwcm9kdWNlcyBhIHZhbHVlIGFmdGVyIGR1ZVRpbWUgaGFzIGVsYXBzZWQgYW5kIHRoZW4gYWZ0ZXIgZWFjaCBwZXJpb2QuXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IGR1ZVRpbWUgQWJzb2x1dGUgKHNwZWNpZmllZCBhcyBhIERhdGUgb2JqZWN0KSBvciByZWxhdGl2ZSB0aW1lIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpIGF0IHdoaWNoIHRvIHByb2R1Y2UgdGhlIGZpcnN0IHZhbHVlLlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IFtwZXJpb2RPclNjaGVkdWxlcl0gIFBlcmlvZCB0byBwcm9kdWNlIHN1YnNlcXVlbnQgdmFsdWVzIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpLCBvciB0aGUgc2NoZWR1bGVyIHRvIHJ1biB0aGUgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSByZXN1bHRpbmcgdGltZXIgaXMgbm90IHJlY3VycmluZy5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gIFNjaGVkdWxlciB0byBydW4gdGhlIHRpbWVyIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgdGltZW91dCBzY2hlZHVsZXIgaXMgdXNlZC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZHVlIHRpbWUgaGFzIGVsYXBzZWQgYW5kIHRoZW4gZWFjaCBwZXJpb2QuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVUaW1lciA9IE9ic2VydmFibGUudGltZXIgPSBmdW5jdGlvbiAoZHVlVGltZSwgcGVyaW9kT3JTY2hlZHVsZXIsIHNjaGVkdWxlcikge1xuXHQgICAgdmFyIHBlcmlvZDtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHQgICAgaWYgKHBlcmlvZE9yU2NoZWR1bGVyICE9IG51bGwgJiYgdHlwZW9mIHBlcmlvZE9yU2NoZWR1bGVyID09PSAnbnVtYmVyJykge1xuXHQgICAgICBwZXJpb2QgPSBwZXJpb2RPclNjaGVkdWxlcjtcblx0ICAgIH0gZWxzZSBpZiAoaXNTY2hlZHVsZXIocGVyaW9kT3JTY2hlZHVsZXIpKSB7XG5cdCAgICAgIHNjaGVkdWxlciA9IHBlcmlvZE9yU2NoZWR1bGVyO1xuXHQgICAgfVxuXHQgICAgaWYgKChkdWVUaW1lIGluc3RhbmNlb2YgRGF0ZSB8fCB0eXBlb2YgZHVlVGltZSA9PT0gJ251bWJlcicpICYmIHBlcmlvZCA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgIHJldHVybiBfb2JzZXJ2YWJsZVRpbWVyKGR1ZVRpbWUsIHNjaGVkdWxlcik7XG5cdCAgICB9XG5cdCAgICBpZiAoZHVlVGltZSBpbnN0YW5jZW9mIERhdGUgJiYgcGVyaW9kICE9PSB1bmRlZmluZWQpIHtcblx0ICAgICAgcmV0dXJuIG9ic2VydmFibGVUaW1lckRhdGVBbmRQZXJpb2QoZHVlVGltZS5nZXRUaW1lKCksIHBlcmlvZE9yU2NoZWR1bGVyLCBzY2hlZHVsZXIpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIG9ic2VydmFibGVUaW1lclRpbWVTcGFuQW5kUGVyaW9kKGR1ZVRpbWUsIHBlcmlvZCwgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBvYnNlcnZhYmxlRGVsYXlSZWxhdGl2ZShzb3VyY2UsIGR1ZVRpbWUsIHNjaGVkdWxlcikge1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBhY3RpdmUgPSBmYWxzZSxcblx0ICAgICAgICBjYW5jZWxhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSxcblx0ICAgICAgICBleGNlcHRpb24gPSBudWxsLFxuXHQgICAgICAgIHEgPSBbXSxcblx0ICAgICAgICBydW5uaW5nID0gZmFsc2UsXG5cdCAgICAgICAgc3Vic2NyaXB0aW9uO1xuXHQgICAgICBzdWJzY3JpcHRpb24gPSBzb3VyY2UubWF0ZXJpYWxpemUoKS50aW1lc3RhbXAoc2NoZWR1bGVyKS5zdWJzY3JpYmUoZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuXHQgICAgICAgIHZhciBkLCBzaG91bGRSdW47XG5cdCAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi52YWx1ZS5raW5kID09PSAnRScpIHtcblx0ICAgICAgICAgIHEgPSBbXTtcblx0ICAgICAgICAgIHEucHVzaChub3RpZmljYXRpb24pO1xuXHQgICAgICAgICAgZXhjZXB0aW9uID0gbm90aWZpY2F0aW9uLnZhbHVlLmVycm9yO1xuXHQgICAgICAgICAgc2hvdWxkUnVuID0gIXJ1bm5pbmc7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHEucHVzaCh7IHZhbHVlOiBub3RpZmljYXRpb24udmFsdWUsIHRpbWVzdGFtcDogbm90aWZpY2F0aW9uLnRpbWVzdGFtcCArIGR1ZVRpbWUgfSk7XG5cdCAgICAgICAgICBzaG91bGRSdW4gPSAhYWN0aXZlO1xuXHQgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKHNob3VsZFJ1bikge1xuXHQgICAgICAgICAgaWYgKGV4Y2VwdGlvbiAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICBvLm9uRXJyb3IoZXhjZXB0aW9uKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICAgICAgY2FuY2VsYWJsZS5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICAgICAgICBkLnNldERpc3Bvc2FibGUoc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlKG51bGwsIGR1ZVRpbWUsIGZ1bmN0aW9uIChfLCBzZWxmKSB7XG5cdCAgICAgICAgICAgICAgdmFyIGUsIHJlY3Vyc2VEdWVUaW1lLCByZXN1bHQsIHNob3VsZFJlY3Vyc2U7XG5cdCAgICAgICAgICAgICAgaWYgKGV4Y2VwdGlvbiAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICBydW5uaW5nID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICBkbyB7XG5cdCAgICAgICAgICAgICAgICByZXN1bHQgPSBudWxsO1xuXHQgICAgICAgICAgICAgICAgaWYgKHEubGVuZ3RoID4gMCAmJiBxWzBdLnRpbWVzdGFtcCAtIHNjaGVkdWxlci5ub3coKSA8PSAwKSB7XG5cdCAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHEuc2hpZnQoKS52YWx1ZTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgICAgICAgcmVzdWx0LmFjY2VwdChvKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICB9IHdoaWxlIChyZXN1bHQgIT09IG51bGwpO1xuXHQgICAgICAgICAgICAgIHNob3VsZFJlY3Vyc2UgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICByZWN1cnNlRHVlVGltZSA9IDA7XG5cdCAgICAgICAgICAgICAgaWYgKHEubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgICAgICAgc2hvdWxkUmVjdXJzZSA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICByZWN1cnNlRHVlVGltZSA9IE1hdGgubWF4KDAsIHFbMF0udGltZXN0YW1wIC0gc2NoZWR1bGVyLm5vdygpKTtcblx0ICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgYWN0aXZlID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIGUgPSBleGNlcHRpb247XG5cdCAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIGlmIChlICE9PSBudWxsKSB7XG5cdCAgICAgICAgICAgICAgICBvLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgICAgICAgfSBlbHNlIGlmIChzaG91bGRSZWN1cnNlKSB7XG5cdCAgICAgICAgICAgICAgICBzZWxmKG51bGwsIHJlY3Vyc2VEdWVUaW1lKTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBvYnNlcnZhYmxlRGVsYXlBYnNvbHV0ZShzb3VyY2UsIGR1ZVRpbWUsIHNjaGVkdWxlcikge1xuXHQgICAgcmV0dXJuIG9ic2VydmFibGVEZWZlcihmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBvYnNlcnZhYmxlRGVsYXlSZWxhdGl2ZShzb3VyY2UsIGR1ZVRpbWUgLSBzY2hlZHVsZXIubm93KCksIHNjaGVkdWxlcik7XG5cdCAgICB9KTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGRlbGF5V2l0aFNlbGVjdG9yKHNvdXJjZSwgc3Vic2NyaXB0aW9uRGVsYXksIGRlbGF5RHVyYXRpb25TZWxlY3Rvcikge1xuXHQgICAgdmFyIHN1YkRlbGF5LCBzZWxlY3Rvcjtcblx0ICAgIGlmIChpc0Z1bmN0aW9uKHN1YnNjcmlwdGlvbkRlbGF5KSkge1xuXHQgICAgICBzZWxlY3RvciA9IHN1YnNjcmlwdGlvbkRlbGF5O1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgc3ViRGVsYXkgPSBzdWJzY3JpcHRpb25EZWxheTtcblx0ICAgICAgc2VsZWN0b3IgPSBkZWxheUR1cmF0aW9uU2VsZWN0b3I7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGRlbGF5cyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCksIGF0RW5kID0gZmFsc2UsIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBzdGFydCgpIHtcblx0ICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKFxuXHQgICAgICAgICAgZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICAgICAgdmFyIGRlbGF5ID0gdHJ5Q2F0Y2goc2VsZWN0b3IpKHgpO1xuXHQgICAgICAgICAgICBpZiAoZGVsYXkgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IoZGVsYXkuZSk7IH1cblx0ICAgICAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICAgICAgZGVsYXlzLmFkZChkKTtcblx0ICAgICAgICAgICAgZC5zZXREaXNwb3NhYmxlKGRlbGF5LnN1YnNjcmliZShcblx0ICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICBvLm9uTmV4dCh4KTtcblx0ICAgICAgICAgICAgICAgIGRlbGF5cy5yZW1vdmUoZCk7XG5cdCAgICAgICAgICAgICAgICBkb25lKCk7XG5cdCAgICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG5cdCAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgby5vbk5leHQoeCk7XG5cdCAgICAgICAgICAgICAgICBkZWxheXMucmVtb3ZlKGQpO1xuXHQgICAgICAgICAgICAgICAgZG9uZSgpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgKSk7XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICBhdEVuZCA9IHRydWU7XG5cdCAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XG5cdCAgICAgICAgICAgIGRvbmUoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICApKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgZnVuY3Rpb24gZG9uZSAoKSB7XG5cdCAgICAgICAgYXRFbmQgJiYgZGVsYXlzLmxlbmd0aCA9PT0gMCAmJiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmICghc3ViRGVsYXkpIHtcblx0ICAgICAgICBzdGFydCgpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHN1YkRlbGF5LnN1YnNjcmliZShzdGFydCwgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LCBzdGFydCkpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCBkZWxheXMpO1xuXHQgICAgfSwgdGhpcyk7XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiAgVGltZSBzaGlmdHMgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgZHVlVGltZS5cblx0ICAgKiAgVGhlIHJlbGF0aXZlIHRpbWUgaW50ZXJ2YWxzIGJldHdlZW4gdGhlIHZhbHVlcyBhcmUgcHJlc2VydmVkLlxuXHQgICAqXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IGR1ZVRpbWUgQWJzb2x1dGUgKHNwZWNpZmllZCBhcyBhIERhdGUgb2JqZWN0KSBvciByZWxhdGl2ZSB0aW1lIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpIGJ5IHdoaWNoIHRvIHNoaWZ0IHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSBkZWxheSB0aW1lcnMgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB0aW1lb3V0IHNjaGVkdWxlciBpcyB1c2VkLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaW1lLXNoaWZ0ZWQgc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmRlbGF5ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGZpcnN0QXJnID0gYXJndW1lbnRzWzBdO1xuXHQgICAgaWYgKHR5cGVvZiBmaXJzdEFyZyA9PT0gJ251bWJlcicgfHwgZmlyc3RBcmcgaW5zdGFuY2VvZiBEYXRlKSB7XG5cdCAgICAgIHZhciBkdWVUaW1lID0gZmlyc3RBcmcsIHNjaGVkdWxlciA9IGFyZ3VtZW50c1sxXTtcblx0ICAgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cdCAgICAgIHJldHVybiBkdWVUaW1lIGluc3RhbmNlb2YgRGF0ZSA/XG5cdCAgICAgICAgb2JzZXJ2YWJsZURlbGF5QWJzb2x1dGUodGhpcywgZHVlVGltZSwgc2NoZWR1bGVyKSA6XG5cdCAgICAgICAgb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUodGhpcywgZHVlVGltZSwgc2NoZWR1bGVyKTtcblx0ICAgIH0gZWxzZSBpZiAoT2JzZXJ2YWJsZS5pc09ic2VydmFibGUoZmlyc3RBcmcpIHx8IGlzRnVuY3Rpb24oZmlyc3RBcmcpKSB7XG5cdCAgICAgIHJldHVybiBkZWxheVdpdGhTZWxlY3Rvcih0aGlzLCBmaXJzdEFyZywgYXJndW1lbnRzWzFdKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhcmd1bWVudHMnKTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICB2YXIgRGVib3VuY2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKERlYm91bmNlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIERlYm91bmNlT2JzZXJ2YWJsZShzb3VyY2UsIGR0LCBzKSB7XG5cdCAgICAgIGlzU2NoZWR1bGVyKHMpIHx8IChzID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9kdCA9IGR0O1xuXHQgICAgICB0aGlzLl9zID0gcztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRGVib3VuY2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGNhbmNlbGFibGUgPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG5cdCAgICAgICAgdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBEZWJvdW5jZU9ic2VydmVyKG8sIHRoaXMuc291cmNlLCB0aGlzLl9kdCwgdGhpcy5fcywgY2FuY2VsYWJsZSkpLFxuXHQgICAgICAgIGNhbmNlbGFibGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRGVib3VuY2VPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIERlYm91bmNlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRGVib3VuY2VPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIERlYm91bmNlT2JzZXJ2ZXIob2JzZXJ2ZXIsIHNvdXJjZSwgZHVlVGltZSwgc2NoZWR1bGVyLCBjYW5jZWxhYmxlKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvYnNlcnZlcjtcblx0ICAgICAgdGhpcy5fcyA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fZCA9IGR1ZVRpbWU7XG5cdCAgICAgIHRoaXMuX3NjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgdGhpcy5fYyA9IGNhbmNlbGFibGU7XG5cdCAgICAgIHRoaXMuX3YgPSBudWxsO1xuXHQgICAgICB0aGlzLl9odiA9IGZhbHNlO1xuXHQgICAgICB0aGlzLl9pZCA9IDA7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIERlYm91bmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLl9odiA9IHRydWU7XG5cdCAgICAgIHRoaXMuX3YgPSB4O1xuXHQgICAgICB2YXIgY3VycmVudElkID0gKyt0aGlzLl9pZCwgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICB0aGlzLl9jLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgIGQuc2V0RGlzcG9zYWJsZSh0aGlzLl9zY2hlZHVsZXIuc2NoZWR1bGVGdXR1cmUodGhpcywgdGhpcy5fZCwgZnVuY3Rpb24gKF8sIHNlbGYpIHtcblx0ICAgICAgICBzZWxmLl9odiAmJiBzZWxmLl9pZCA9PT0gY3VycmVudElkICYmIHNlbGYuX28ub25OZXh0KHgpO1xuXHQgICAgICAgIHNlbGYuX2h2ID0gZmFsc2U7XG5cdCAgICAgIH0pKTtcblx0ICAgIH07XG5cdFxuXHQgICAgRGVib3VuY2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9jLmRpc3Bvc2UoKTtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgICB0aGlzLl9odiA9IGZhbHNlO1xuXHQgICAgICB0aGlzLl9pZCsrO1xuXHQgICAgfTtcblx0XG5cdCAgICBEZWJvdW5jZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX2MuZGlzcG9zZSgpO1xuXHQgICAgICB0aGlzLl9odiAmJiB0aGlzLl9vLm9uTmV4dCh0aGlzLl92KTtcblx0ICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB0aGlzLl9odiA9IGZhbHNlO1xuXHQgICAgICB0aGlzLl9pZCsrO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRGVib3VuY2VPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgZnVuY3Rpb24gZGVib3VuY2VXaXRoU2VsZWN0b3Ioc291cmNlLCBkdXJhdGlvblNlbGVjdG9yKSB7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIHZhbHVlLCBoYXNWYWx1ZSA9IGZhbHNlLCBjYW5jZWxhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSwgaWQgPSAwO1xuXHQgICAgICB2YXIgc3Vic2NyaXB0aW9uID0gc291cmNlLnN1YnNjcmliZShcblx0ICAgICAgICBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgICAgdmFyIHRocm90dGxlID0gdHJ5Q2F0Y2goZHVyYXRpb25TZWxlY3RvcikoeCk7XG5cdCAgICAgICAgICBpZiAodGhyb3R0bGUgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IodGhyb3R0bGUuZSk7IH1cblx0XG5cdCAgICAgICAgICBpc1Byb21pc2UodGhyb3R0bGUpICYmICh0aHJvdHRsZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZSh0aHJvdHRsZSkpO1xuXHRcblx0ICAgICAgICAgIGhhc1ZhbHVlID0gdHJ1ZTtcblx0ICAgICAgICAgIHZhbHVlID0geDtcblx0ICAgICAgICAgIGlkKys7XG5cdCAgICAgICAgICB2YXIgY3VycmVudGlkID0gaWQsIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICAgIGNhbmNlbGFibGUuc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgICAgIGQuc2V0RGlzcG9zYWJsZSh0aHJvdHRsZS5zdWJzY3JpYmUoXG5cdCAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICBoYXNWYWx1ZSAmJiBpZCA9PT0gY3VycmVudGlkICYmIG8ub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICAgICAgICBoYXNWYWx1ZSA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIGQuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG5cdCAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICBoYXNWYWx1ZSAmJiBpZCA9PT0gY3VycmVudGlkICYmIG8ub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICAgICAgICBoYXNWYWx1ZSA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIGQuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICApKTtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgICBjYW5jZWxhYmxlLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgIG8ub25FcnJvcihlKTtcblx0ICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG5cdCAgICAgICAgICBpZCsrO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgY2FuY2VsYWJsZS5kaXNwb3NlKCk7XG5cdCAgICAgICAgICBoYXNWYWx1ZSAmJiBvLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICBoYXNWYWx1ZSA9IGZhbHNlO1xuXHQgICAgICAgICAgaWQrKztcblx0ICAgICAgICB9XG5cdCAgICAgICk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUpO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9XG5cdFxuXHQgIG9ic2VydmFibGVQcm90by5kZWJvdW5jZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmIChpc0Z1bmN0aW9uIChhcmd1bWVudHNbMF0pKSB7XG5cdCAgICAgIHJldHVybiBkZWJvdW5jZVdpdGhTZWxlY3Rvcih0aGlzLCBhcmd1bWVudHNbMF0pO1xuXHQgICAgfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnbnVtYmVyJykge1xuXHQgICAgICByZXR1cm4gbmV3IERlYm91bmNlT2JzZXJ2YWJsZSh0aGlzLCBhcmd1bWVudHNbMF0sIGFyZ3VtZW50c1sxXSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYXJndW1lbnRzJyk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRpbWVzdGFtcE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGltZXN0YW1wT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRpbWVzdGFtcE9ic2VydmFibGUoc291cmNlLCBzKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9zID0gcztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGltZXN0YW1wT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFRpbWVzdGFtcE9ic2VydmVyKG8sIHRoaXMuX3MpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFRpbWVzdGFtcE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgVGltZXN0YW1wT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGltZXN0YW1wT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUaW1lc3RhbXBPYnNlcnZlcihvLCBzKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9zID0gcztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGltZXN0YW1wT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLl9vLm9uTmV4dCh7IHZhbHVlOiB4LCB0aW1lc3RhbXA6IHRoaXMuX3Mubm93KCkgfSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFRpbWVzdGFtcE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgVGltZXN0YW1wT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gVGltZXN0YW1wT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZWNvcmRzIHRoZSB0aW1lc3RhbXAgZm9yIGVhY2ggdmFsdWUgaW4gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogIDEgLSByZXMgPSBzb3VyY2UudGltZXN0YW1wKCk7IC8vIHByb2R1Y2VzIHsgdmFsdWU6IHgsIHRpbWVzdGFtcDogdHMgfVxuXHQgICAqICAyIC0gcmVzID0gc291cmNlLnRpbWVzdGFtcChSeC5TY2hlZHVsZXIuZGVmYXVsdCk7XG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gIFNjaGVkdWxlciB1c2VkIHRvIGNvbXB1dGUgdGltZXN0YW1wcy4gSWYgbm90IHNwZWNpZmllZCwgdGhlIGRlZmF1bHQgc2NoZWR1bGVyIGlzIHVzZWQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCB0aW1lc3RhbXAgaW5mb3JtYXRpb24gb24gdmFsdWVzLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50aW1lc3RhbXAgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgVGltZXN0YW1wT2JzZXJ2YWJsZSh0aGlzLCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIHNhbXBsZU9ic2VydmFibGUoc291cmNlLCBzYW1wbGVyKSB7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGF0RW5kID0gZmFsc2UsIHZhbHVlLCBoYXNWYWx1ZSA9IGZhbHNlO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gc2FtcGxlU3Vic2NyaWJlKCkge1xuXHQgICAgICAgIGlmIChoYXNWYWx1ZSkge1xuXHQgICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcblx0ICAgICAgICAgIG8ub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgYXRFbmQgJiYgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICB2YXIgc291cmNlU3Vic2NyaXB0aW9uID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHNvdXJjZVN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoXG5cdCAgICAgICAgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG5cdCAgICAgICAgICBoYXNWYWx1ZSA9IHRydWU7XG5cdCAgICAgICAgICB2YWx1ZSA9IG5ld1ZhbHVlO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuXHQgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIGF0RW5kID0gdHJ1ZTtcblx0ICAgICAgICAgIHNvdXJjZVN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICApKTtcblx0XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShcblx0ICAgICAgICBzb3VyY2VTdWJzY3JpcHRpb24sXG5cdCAgICAgICAgc2FtcGxlci5zdWJzY3JpYmUoc2FtcGxlU3Vic2NyaWJlLCBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIHNhbXBsZVN1YnNjcmliZSlcblx0ICAgICAgKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiAgU2FtcGxlcyB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhdCBlYWNoIGludGVydmFsLlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAgMSAtIHJlcyA9IHNvdXJjZS5zYW1wbGUoc2FtcGxlT2JzZXJ2YWJsZSk7IC8vIFNhbXBsZXIgdGljayBzZXF1ZW5jZVxuXHQgICAqICAyIC0gcmVzID0gc291cmNlLnNhbXBsZSg1MDAwKTsgLy8gNSBzZWNvbmRzXG5cdCAgICogIDIgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKDUwMDAsIFJ4LlNjaGVkdWxlci50aW1lb3V0KTsgLy8gNSBzZWNvbmRzXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge01peGVkfSBpbnRlcnZhbE9yU2FtcGxlciBJbnRlcnZhbCBhdCB3aGljaCB0byBzYW1wbGUgKHNwZWNpZmllZCBhcyBhbiBpbnRlZ2VyIGRlbm90aW5nIG1pbGxpc2Vjb25kcykgb3IgU2FtcGxlciBPYnNlcnZhYmxlLlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHRvIHJ1biB0aGUgc2FtcGxpbmcgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB0aW1lb3V0IHNjaGVkdWxlciBpcyB1c2VkLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBTYW1wbGVkIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNhbXBsZSA9IG9ic2VydmFibGVQcm90by50aHJvdHRsZUxhdGVzdCA9IGZ1bmN0aW9uIChpbnRlcnZhbE9yU2FtcGxlciwgc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiB0eXBlb2YgaW50ZXJ2YWxPclNhbXBsZXIgPT09ICdudW1iZXInID9cblx0ICAgICAgc2FtcGxlT2JzZXJ2YWJsZSh0aGlzLCBvYnNlcnZhYmxlaW50ZXJ2YWwoaW50ZXJ2YWxPclNhbXBsZXIsIHNjaGVkdWxlcikpIDpcblx0ICAgICAgc2FtcGxlT2JzZXJ2YWJsZSh0aGlzLCBpbnRlcnZhbE9yU2FtcGxlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRpbWVvdXRFcnJvciA9IFJ4LlRpbWVvdXRFcnJvciA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcblx0ICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgJ1RpbWVvdXQgaGFzIG9jY3VycmVkJztcblx0ICAgIHRoaXMubmFtZSA9ICdUaW1lb3V0RXJyb3InO1xuXHQgICAgRXJyb3IuY2FsbCh0aGlzKTtcblx0ICB9O1xuXHQgIFRpbWVvdXRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cdFxuXHQgIGZ1bmN0aW9uIHRpbWVvdXRXaXRoU2VsZWN0b3Ioc291cmNlLCBmaXJzdFRpbWVvdXQsIHRpbWVvdXREdXJhdGlvblNlbGVjdG9yLCBvdGhlcikge1xuXHQgICAgaWYgKGlzRnVuY3Rpb24oZmlyc3RUaW1lb3V0KSkge1xuXHQgICAgICBvdGhlciA9IHRpbWVvdXREdXJhdGlvblNlbGVjdG9yO1xuXHQgICAgICB0aW1lb3V0RHVyYXRpb25TZWxlY3RvciA9IGZpcnN0VGltZW91dDtcblx0ICAgICAgZmlyc3RUaW1lb3V0ID0gb2JzZXJ2YWJsZU5ldmVyKCk7XG5cdCAgICB9XG5cdCAgICBvdGhlciB8fCAob3RoZXIgPSBvYnNlcnZhYmxlVGhyb3cobmV3IFRpbWVvdXRFcnJvcigpKSk7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG5cdCAgICAgICAgdGltZXIgPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLFxuXHQgICAgICAgIG9yaWdpbmFsID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdFxuXHQgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShvcmlnaW5hbCk7XG5cdFxuXHQgICAgICB2YXIgaWQgPSAwLCBzd2l0Y2hlZCA9IGZhbHNlO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gc2V0VGltZXIodGltZW91dCkge1xuXHQgICAgICAgIHZhciBteUlkID0gaWQsIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0XG5cdCAgICAgICAgZnVuY3Rpb24gdGltZXJXaW5zKCkge1xuXHQgICAgICAgICAgc3dpdGNoZWQgPSAobXlJZCA9PT0gaWQpO1xuXHQgICAgICAgICAgcmV0dXJuIHN3aXRjaGVkO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGltZXIuc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgICBkLnNldERpc3Bvc2FibGUodGltZW91dC5zdWJzY3JpYmUoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgdGltZXJXaW5zKCkgJiYgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG8pKTtcblx0ICAgICAgICAgIGQuZGlzcG9zZSgpO1xuXHQgICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgICB0aW1lcldpbnMoKSAmJiBvLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgfSwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgdGltZXJXaW5zKCkgJiYgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG8pKTtcblx0ICAgICAgICB9KSk7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICBzZXRUaW1lcihmaXJzdFRpbWVvdXQpO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gb1dpbnMoKSB7XG5cdCAgICAgICAgdmFyIHJlcyA9ICFzd2l0Y2hlZDtcblx0ICAgICAgICBpZiAocmVzKSB7IGlkKys7IH1cblx0ICAgICAgICByZXR1cm4gcmVzO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBvcmlnaW5hbC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICBpZiAob1dpbnMoKSkge1xuXHQgICAgICAgICAgby5vbk5leHQoeCk7XG5cdCAgICAgICAgICB2YXIgdGltZW91dCA9IHRyeUNhdGNoKHRpbWVvdXREdXJhdGlvblNlbGVjdG9yKSh4KTtcblx0ICAgICAgICAgIGlmICh0aW1lb3V0ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHRpbWVvdXQuZSk7IH1cblx0ICAgICAgICAgIHNldFRpbWVyKGlzUHJvbWlzZSh0aW1lb3V0KSA/IG9ic2VydmFibGVGcm9tUHJvbWlzZSh0aW1lb3V0KSA6IHRpbWVvdXQpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBvV2lucygpICYmIG8ub25FcnJvcihlKTtcblx0ICAgICAgfSwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIG9XaW5zKCkgJiYgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9KSk7XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIHRpbWVyKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiB0aW1lb3V0KHNvdXJjZSwgZHVlVGltZSwgb3RoZXIsIHNjaGVkdWxlcikge1xuXHQgICAgaWYgKGlzU2NoZWR1bGVyKG90aGVyKSkge1xuXHQgICAgICBzY2hlZHVsZXIgPSBvdGhlcjtcblx0ICAgICAgb3RoZXIgPSBvYnNlcnZhYmxlVGhyb3cobmV3IFRpbWVvdXRFcnJvcigpKTtcblx0ICAgIH1cblx0ICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEVycm9yKSB7IG90aGVyID0gb2JzZXJ2YWJsZVRocm93KG90aGVyKTsgfVxuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cdFxuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBpZCA9IDAsXG5cdCAgICAgICAgb3JpZ2luYWwgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcblx0ICAgICAgICBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLFxuXHQgICAgICAgIHN3aXRjaGVkID0gZmFsc2UsXG5cdCAgICAgICAgdGltZXIgPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXHRcblx0ICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3JpZ2luYWwpO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gY3JlYXRlVGltZXIoKSB7XG5cdCAgICAgICAgdmFyIG15SWQgPSBpZDtcblx0ICAgICAgICB0aW1lci5zZXREaXNwb3NhYmxlKHNjaGVkdWxlci5zY2hlZHVsZUZ1dHVyZShudWxsLCBkdWVUaW1lLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBzd2l0Y2hlZCA9IGlkID09PSBteUlkO1xuXHQgICAgICAgICAgaWYgKHN3aXRjaGVkKSB7XG5cdCAgICAgICAgICAgIGlzUHJvbWlzZShvdGhlcikgJiYgKG90aGVyID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKG90aGVyKSk7XG5cdCAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG90aGVyLnN1YnNjcmliZShvKSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSkpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBjcmVhdGVUaW1lcigpO1xuXHRcblx0ICAgICAgb3JpZ2luYWwuc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgaWYgKCFzd2l0Y2hlZCkge1xuXHQgICAgICAgICAgaWQrKztcblx0ICAgICAgICAgIG8ub25OZXh0KHgpO1xuXHQgICAgICAgICAgY3JlYXRlVGltZXIoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgaWYgKCFzd2l0Y2hlZCkge1xuXHQgICAgICAgICAgaWQrKztcblx0ICAgICAgICAgIG8ub25FcnJvcihlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIXN3aXRjaGVkKSB7XG5cdCAgICAgICAgICBpZCsrO1xuXHQgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSkpO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCB0aW1lcik7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH1cblx0XG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgZmlyc3RBcmcgPSBhcmd1bWVudHNbMF07XG5cdCAgICBpZiAoZmlyc3RBcmcgaW5zdGFuY2VvZiBEYXRlIHx8IHR5cGVvZiBmaXJzdEFyZyA9PT0gJ251bWJlcicpIHtcblx0ICAgICAgcmV0dXJuIHRpbWVvdXQodGhpcywgZmlyc3RBcmcsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcblx0ICAgIH0gZWxzZSBpZiAoT2JzZXJ2YWJsZS5pc09ic2VydmFibGUoZmlyc3RBcmcpIHx8IGlzRnVuY3Rpb24oZmlyc3RBcmcpKSB7XG5cdCAgICAgIHJldHVybiB0aW1lb3V0V2l0aFNlbGVjdG9yKHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYXJndW1lbnRzJyk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmV0dXJucyBhbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgb25seSB0aGUgZmlyc3QgaXRlbSBlbWl0dGVkIGJ5IHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSBkdXJpbmcgc2VxdWVudGlhbCB0aW1lIHdpbmRvd3Mgb2YgYSBzcGVjaWZpZWQgZHVyYXRpb24uXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IHdpbmRvd0R1cmF0aW9uIHRpbWUgdG8gd2FpdCBiZWZvcmUgZW1pdHRpbmcgYW5vdGhlciBpdGVtIGFmdGVyIGVtaXR0aW5nIHRoZSBsYXN0IGl0ZW1cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gdGhlIFNjaGVkdWxlciB0byB1c2UgaW50ZXJuYWxseSB0byBtYW5hZ2UgdGhlIHRpbWVycyB0aGF0IGhhbmRsZSB0aW1lb3V0IGZvciBlYWNoIGl0ZW0uIElmIG5vdCBwcm92aWRlZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLnRpbWVvdXQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIE9ic2VydmFibGUgdGhhdCBwZXJmb3JtcyB0aGUgdGhyb3R0bGUgb3BlcmF0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50aHJvdHRsZSA9IGZ1bmN0aW9uICh3aW5kb3dEdXJhdGlvbiwgc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcblx0ICAgIHZhciBkdXJhdGlvbiA9ICt3aW5kb3dEdXJhdGlvbiB8fCAwO1xuXHQgICAgaWYgKGR1cmF0aW9uIDw9IDApIHsgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3dpbmRvd0R1cmF0aW9uIGNhbm5vdCBiZSBsZXNzIG9yIGVxdWFsIHplcm8uJyk7IH1cblx0ICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBsYXN0T25OZXh0ID0gMDtcblx0ICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUoXG5cdCAgICAgICAgZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICAgIHZhciBub3cgPSBzY2hlZHVsZXIubm93KCk7XG5cdCAgICAgICAgICBpZiAobGFzdE9uTmV4dCA9PT0gMCB8fCBub3cgLSBsYXN0T25OZXh0ID49IGR1cmF0aW9uKSB7XG5cdCAgICAgICAgICAgIGxhc3RPbk5leHQgPSBub3c7XG5cdCAgICAgICAgICAgIG8ub25OZXh0KHgpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0sZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LCBmdW5jdGlvbiAoKSB7IG8ub25Db21wbGV0ZWQoKTsgfVxuXHQgICAgICApO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgUGF1c2FibGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFBhdXNhYmxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFBhdXNhYmxlT2JzZXJ2YWJsZShzb3VyY2UsIHBhdXNlcikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5jb250cm9sbGVyID0gbmV3IFN1YmplY3QoKTtcblx0XG5cdCAgICAgIGlmIChwYXVzZXIgJiYgcGF1c2VyLnN1YnNjcmliZSkge1xuXHQgICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyLm1lcmdlKHBhdXNlcik7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdGhpcy5wYXVzZXIgPSB0aGlzLmNvbnRyb2xsZXI7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFBhdXNhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBjb25uID0gdGhpcy5zb3VyY2UucHVibGlzaCgpLFxuXHQgICAgICAgIHN1YnNjcmlwdGlvbiA9IGNvbm4uc3Vic2NyaWJlKG8pLFxuXHQgICAgICAgIGNvbm5lY3Rpb24gPSBkaXNwb3NhYmxlRW1wdHk7XG5cdFxuXHQgICAgICB2YXIgcGF1c2FibGUgPSB0aGlzLnBhdXNlci5kaXN0aW5jdFVudGlsQ2hhbmdlZCgpLnN1YnNjcmliZShmdW5jdGlvbiAoYikge1xuXHQgICAgICAgIGlmIChiKSB7XG5cdCAgICAgICAgICBjb25uZWN0aW9uID0gY29ubi5jb25uZWN0KCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGNvbm5lY3Rpb24uZGlzcG9zZSgpO1xuXHQgICAgICAgICAgY29ubmVjdGlvbiA9IGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShbc3Vic2NyaXB0aW9uLCBjb25uZWN0aW9uLCBwYXVzYWJsZV0pO1xuXHQgICAgfTtcblx0XG5cdCAgICBQYXVzYWJsZU9ic2VydmFibGUucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLmNvbnRyb2xsZXIub25OZXh0KGZhbHNlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgUGF1c2FibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuY29udHJvbGxlci5vbk5leHQodHJ1ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBQYXVzYWJsZU9ic2VydmFibGU7XG5cdFxuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBQYXVzZXMgdGhlIHVuZGVybHlpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBiYXNlZCB1cG9uIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIHlpZWxkcyB0cnVlL2ZhbHNlLlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHBhdXNlciA9IG5ldyBSeC5TdWJqZWN0KCk7XG5cdCAgICogdmFyIHNvdXJjZSA9IFJ4Lk9ic2VydmFibGUuaW50ZXJ2YWwoMTAwKS5wYXVzYWJsZShwYXVzZXIpO1xuXHQgICAqIEBwYXJhbSB7T2JzZXJ2YWJsZX0gcGF1c2VyIFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHVzZWQgdG8gcGF1c2UgdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIGlzIHBhdXNlZCBiYXNlZCB1cG9uIHRoZSBwYXVzZXIuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnBhdXNhYmxlID0gZnVuY3Rpb24gKHBhdXNlcikge1xuXHQgICAgcmV0dXJuIG5ldyBQYXVzYWJsZU9ic2VydmFibGUodGhpcywgcGF1c2VyKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBjb21iaW5lTGF0ZXN0U291cmNlKHNvdXJjZSwgc3ViamVjdCwgcmVzdWx0U2VsZWN0b3IpIHtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgaGFzVmFsdWUgPSBbZmFsc2UsIGZhbHNlXSxcblx0ICAgICAgICBoYXNWYWx1ZUFsbCA9IGZhbHNlLFxuXHQgICAgICAgIGlzRG9uZSA9IGZhbHNlLFxuXHQgICAgICAgIHZhbHVlcyA9IG5ldyBBcnJheSgyKSxcblx0ICAgICAgICBlcnI7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBuZXh0KHgsIGkpIHtcblx0ICAgICAgICB2YWx1ZXNbaV0gPSB4O1xuXHQgICAgICAgIGhhc1ZhbHVlW2ldID0gdHJ1ZTtcblx0ICAgICAgICBpZiAoaGFzVmFsdWVBbGwgfHwgKGhhc1ZhbHVlQWxsID0gaGFzVmFsdWUuZXZlcnkoaWRlbnRpdHkpKSkge1xuXHQgICAgICAgICAgaWYgKGVycikgeyByZXR1cm4gby5vbkVycm9yKGVycik7IH1cblx0ICAgICAgICAgIHZhciByZXMgPSB0cnlDYXRjaChyZXN1bHRTZWxlY3RvcikuYXBwbHkobnVsbCwgdmFsdWVzKTtcblx0ICAgICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgICAgICBvLm9uTmV4dChyZXMpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpc0RvbmUgJiYgdmFsdWVzWzFdICYmIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuXHQgICAgICAgIHNvdXJjZS5zdWJzY3JpYmUoXG5cdCAgICAgICAgICBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgICAgICBuZXh0KHgsIDApO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgICAgIGlmICh2YWx1ZXNbMV0pIHtcblx0ICAgICAgICAgICAgICBvLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgZXJyID0gZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcblx0ICAgICAgICAgICAgdmFsdWVzWzFdICYmIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgIH0pLFxuXHQgICAgICAgIHN1YmplY3Quc3Vic2NyaWJlKFxuXHQgICAgICAgICAgZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICAgICAgbmV4dCh4LCAxKTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG5cdCAgICAgICAgICAgIG5leHQodHJ1ZSwgMSk7XG5cdCAgICAgICAgICB9KVxuXHQgICAgICAgICk7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH1cblx0XG5cdCAgdmFyIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUoc291cmNlLCBwYXVzZXIpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuY29udHJvbGxlciA9IG5ldyBTdWJqZWN0KCk7XG5cdFxuXHQgICAgICBpZiAocGF1c2VyICYmIHBhdXNlci5zdWJzY3JpYmUpIHtcblx0ICAgICAgICB0aGlzLnBhdXNlciA9IHRoaXMuY29udHJvbGxlci5tZXJnZShwYXVzZXIpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBxID0gW10sIHByZXZpb3VzU2hvdWxkRmlyZTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGRyYWluUXVldWUoKSB7IHdoaWxlIChxLmxlbmd0aCA+IDApIHsgby5vbk5leHQocS5zaGlmdCgpKTsgfSB9XG5cdFxuXHQgICAgICB2YXIgc3Vic2NyaXB0aW9uID1cblx0ICAgICAgICBjb21iaW5lTGF0ZXN0U291cmNlKFxuXHQgICAgICAgICAgdGhpcy5zb3VyY2UsXG5cdCAgICAgICAgICB0aGlzLnBhdXNlci5zdGFydFdpdGgoZmFsc2UpLmRpc3RpbmN0VW50aWxDaGFuZ2VkKCksXG5cdCAgICAgICAgICBmdW5jdGlvbiAoZGF0YSwgc2hvdWxkRmlyZSkge1xuXHQgICAgICAgICAgICByZXR1cm4geyBkYXRhOiBkYXRhLCBzaG91bGRGaXJlOiBzaG91bGRGaXJlIH07XG5cdCAgICAgICAgICB9KVxuXHQgICAgICAgICAgLnN1YnNjcmliZShcblx0ICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdHMpIHtcblx0ICAgICAgICAgICAgICBpZiAocHJldmlvdXNTaG91bGRGaXJlICE9PSB1bmRlZmluZWQgJiYgcmVzdWx0cy5zaG91bGRGaXJlICE9PSBwcmV2aW91c1Nob3VsZEZpcmUpIHtcblx0ICAgICAgICAgICAgICAgIHByZXZpb3VzU2hvdWxkRmlyZSA9IHJlc3VsdHMuc2hvdWxkRmlyZTtcblx0ICAgICAgICAgICAgICAgIC8vIGNoYW5nZSBpbiBzaG91bGRGaXJlXG5cdCAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5zaG91bGRGaXJlKSB7IGRyYWluUXVldWUoKTsgfVxuXHQgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBwcmV2aW91c1Nob3VsZEZpcmUgPSByZXN1bHRzLnNob3VsZEZpcmU7XG5cdCAgICAgICAgICAgICAgICAvLyBuZXcgZGF0YVxuXHQgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMuc2hvdWxkRmlyZSkge1xuXHQgICAgICAgICAgICAgICAgICBvLm9uTmV4dChyZXN1bHRzLmRhdGEpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgcS5wdXNoKHJlc3VsdHMuZGF0YSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgICAgICAgICAgZHJhaW5RdWV1ZSgpO1xuXHQgICAgICAgICAgICAgIG8ub25FcnJvcihlcnIpO1xuXHQgICAgICAgICAgICB9LFxuXHQgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgZHJhaW5RdWV1ZSgpO1xuXHQgICAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgKTtcblx0ICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjsgICAgICBcblx0ICAgIH07XG5cdFxuXHQgICAgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLmNvbnRyb2xsZXIub25OZXh0KGZhbHNlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dCh0cnVlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlO1xuXHRcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgYmFzZWQgdXBvbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB5aWVsZHMgdHJ1ZS9mYWxzZSxcblx0ICAgKiBhbmQgeWllbGRzIHRoZSB2YWx1ZXMgdGhhdCB3ZXJlIGJ1ZmZlcmVkIHdoaWxlIHBhdXNlZC5cblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciBwYXVzZXIgPSBuZXcgUnguU3ViamVjdCgpO1xuXHQgICAqIHZhciBzb3VyY2UgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMCkucGF1c2FibGVCdWZmZXJlZChwYXVzZXIpO1xuXHQgICAqIEBwYXJhbSB7T2JzZXJ2YWJsZX0gcGF1c2VyIFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHVzZWQgdG8gcGF1c2UgdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIGlzIHBhdXNlZCBiYXNlZCB1cG9uIHRoZSBwYXVzZXIuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnBhdXNhYmxlQnVmZmVyZWQgPSBmdW5jdGlvbiAoc3ViamVjdCkge1xuXHQgICAgcmV0dXJuIG5ldyBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSh0aGlzLCBzdWJqZWN0KTtcblx0ICB9O1xuXHRcblx0ICB2YXIgQ29udHJvbGxlZE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ29udHJvbGxlZE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDb250cm9sbGVkT2JzZXJ2YWJsZSAoc291cmNlLCBlbmFibGVRdWV1ZSwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLnN1YmplY3QgPSBuZXcgQ29udHJvbGxlZFN1YmplY3QoZW5hYmxlUXVldWUsIHNjaGVkdWxlcik7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlLm11bHRpY2FzdCh0aGlzLnN1YmplY3QpLnJlZkNvdW50KCk7XG5cdCAgICB9XG5cdFxuXHQgICAgQ29udHJvbGxlZE9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG8pO1xuXHQgICAgfTtcblx0XG5cdCAgICBDb250cm9sbGVkT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVxdWVzdCA9IGZ1bmN0aW9uIChudW1iZXJPZkl0ZW1zKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnN1YmplY3QucmVxdWVzdChudW1iZXJPZkl0ZW1zID09IG51bGwgPyAtMSA6IG51bWJlck9mSXRlbXMpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQ29udHJvbGxlZE9ic2VydmFibGU7XG5cdFxuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICB2YXIgQ29udHJvbGxlZFN1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ29udHJvbGxlZFN1YmplY3QsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDb250cm9sbGVkU3ViamVjdChlbmFibGVRdWV1ZSwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIGVuYWJsZVF1ZXVlID09IG51bGwgJiYgKGVuYWJsZVF1ZXVlID0gdHJ1ZSk7XG5cdFxuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5zdWJqZWN0ID0gbmV3IFN1YmplY3QoKTtcblx0ICAgICAgdGhpcy5lbmFibGVRdWV1ZSA9IGVuYWJsZVF1ZXVlO1xuXHQgICAgICB0aGlzLnF1ZXVlID0gZW5hYmxlUXVldWUgPyBbXSA6IG51bGw7XG5cdCAgICAgIHRoaXMucmVxdWVzdGVkQ291bnQgPSAwO1xuXHQgICAgICB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUgPSBudWxsO1xuXHQgICAgICB0aGlzLmVycm9yID0gbnVsbDtcblx0ICAgICAgdGhpcy5oYXNGYWlsZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5oYXNDb21wbGV0ZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXIgfHwgY3VycmVudFRocmVhZFNjaGVkdWxlcjtcblx0ICAgIH1cblx0XG5cdCAgICBhZGRQcm9wZXJ0aWVzKENvbnRyb2xsZWRTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIsIHtcblx0ICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5zdWJqZWN0LnN1YnNjcmliZShvKTtcblx0ICAgICAgfSxcblx0ICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IHRydWU7XG5cdCAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVF1ZXVlIHx8IHRoaXMucXVldWUubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgICAgICB0aGlzLnN1YmplY3Qub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRoaXMucXVldWUucHVzaChOb3RpZmljYXRpb24uY3JlYXRlT25Db21wbGV0ZWQoKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICB0aGlzLmhhc0ZhaWxlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXHQgICAgICAgIGlmICghdGhpcy5lbmFibGVRdWV1ZSB8fCB0aGlzLnF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgICAgdGhpcy5zdWJqZWN0Lm9uRXJyb3IoZXJyb3IpO1xuXHQgICAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgdGhpcy5xdWV1ZS5wdXNoKE5vdGlmaWNhdGlvbi5jcmVhdGVPbkVycm9yKGVycm9yKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIGlmICh0aGlzLnJlcXVlc3RlZENvdW50IDw9IDApIHtcblx0ICAgICAgICAgIHRoaXMuZW5hYmxlUXVldWUgJiYgdGhpcy5xdWV1ZS5wdXNoKE5vdGlmaWNhdGlvbi5jcmVhdGVPbk5leHQodmFsdWUpKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgKHRoaXMucmVxdWVzdGVkQ291bnQtLSA9PT0gMCkgJiYgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcblx0ICAgICAgICAgIHRoaXMuc3ViamVjdC5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgX3Byb2Nlc3NSZXF1ZXN0OiBmdW5jdGlvbiAobnVtYmVyT2ZJdGVtcykge1xuXHQgICAgICAgIGlmICh0aGlzLmVuYWJsZVF1ZXVlKSB7XG5cdCAgICAgICAgICB3aGlsZSAodGhpcy5xdWV1ZS5sZW5ndGggPiAwICYmIChudW1iZXJPZkl0ZW1zID4gMCB8fCB0aGlzLnF1ZXVlWzBdLmtpbmQgIT09ICdOJykpIHtcblx0ICAgICAgICAgICAgdmFyIGZpcnN0ID0gdGhpcy5xdWV1ZS5zaGlmdCgpO1xuXHQgICAgICAgICAgICBmaXJzdC5hY2NlcHQodGhpcy5zdWJqZWN0KTtcblx0ICAgICAgICAgICAgaWYgKGZpcnN0LmtpbmQgPT09ICdOJykge1xuXHQgICAgICAgICAgICAgIG51bWJlck9mSXRlbXMtLTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICB0aGlzLmRpc3Bvc2VDdXJyZW50UmVxdWVzdCgpO1xuXHQgICAgICAgICAgICAgIHRoaXMucXVldWUgPSBbXTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIG51bWJlck9mSXRlbXM7XG5cdCAgICAgIH0sXG5cdCAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChudW1iZXIpIHtcblx0ICAgICAgICB0aGlzLmRpc3Bvc2VDdXJyZW50UmVxdWVzdCgpO1xuXHQgICAgICAgIHZhciBzZWxmID0gdGhpcztcblx0XG5cdCAgICAgICAgdGhpcy5yZXF1ZXN0ZWREaXNwb3NhYmxlID0gdGhpcy5zY2hlZHVsZXIuc2NoZWR1bGUobnVtYmVyLFxuXHQgICAgICAgIGZ1bmN0aW9uKHMsIGkpIHtcblx0ICAgICAgICAgIHZhciByZW1haW5pbmcgPSBzZWxmLl9wcm9jZXNzUmVxdWVzdChpKTtcblx0ICAgICAgICAgIHZhciBzdG9wcGVkID0gc2VsZi5oYXNDb21wbGV0ZWQgfHwgc2VsZi5oYXNGYWlsZWQ7XG5cdCAgICAgICAgICBpZiAoIXN0b3BwZWQgJiYgcmVtYWluaW5nID4gMCkge1xuXHQgICAgICAgICAgICBzZWxmLnJlcXVlc3RlZENvdW50ID0gcmVtYWluaW5nO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgIHNlbGYucmVxdWVzdGVkQ291bnQgPSAwO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgICAvLyBTY2hlZHVsZWQgaXRlbSBpcyBzdGlsbCBpbiBwcm9ncmVzcy4gUmV0dXJuIGEgbmV3XG5cdCAgICAgICAgICAgICAgLy8gZGlzcG9zYWJsZSB0byBhbGxvdyB0aGUgcmVxdWVzdCB0byBiZSBpbnRlcnJ1cHRlZFxuXHQgICAgICAgICAgICAgIC8vIHZpYSBkaXNwb3NlLlxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICByZXR1cm4gdGhpcy5yZXF1ZXN0ZWREaXNwb3NhYmxlO1xuXHQgICAgICB9LFxuXHQgICAgICBkaXNwb3NlQ3VycmVudFJlcXVlc3Q6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAodGhpcy5yZXF1ZXN0ZWREaXNwb3NhYmxlKSB7XG5cdCAgICAgICAgICB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgdGhpcy5yZXF1ZXN0ZWREaXNwb3NhYmxlID0gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHRcblx0ICAgIHJldHVybiBDb250cm9sbGVkU3ViamVjdDtcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogQXR0YWNoZXMgYSBjb250cm9sbGVyIHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGhlIGFiaWxpdHkgdG8gcXVldWUuXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgc291cmNlID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDApLmNvbnRyb2xsZWQoKTtcblx0ICAgKiBzb3VyY2UucmVxdWVzdCgzKTsgLy8gUmVhZHMgMyB2YWx1ZXNcblx0ICAgKiBAcGFyYW0ge2Jvb2x9IGVuYWJsZVF1ZXVlIHRydXRoeSB2YWx1ZSB0byBkZXRlcm1pbmUgaWYgdmFsdWVzIHNob3VsZCBiZSBxdWV1ZWQgcGVuZGluZyB0aGUgbmV4dCByZXF1ZXN0XG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBkZXRlcm1pbmVzIGhvdyB0aGUgcmVxdWVzdHMgd2lsbCBiZSBzY2hlZHVsZWRcblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggb25seSBwcm9wYWdhdGVzIHZhbHVlcyBvbiByZXF1ZXN0LlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5jb250cm9sbGVkID0gZnVuY3Rpb24gKGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpIHtcblx0XG5cdCAgICBpZiAoZW5hYmxlUXVldWUgJiYgaXNTY2hlZHVsZXIoZW5hYmxlUXVldWUpKSB7XG5cdCAgICAgIHNjaGVkdWxlciA9IGVuYWJsZVF1ZXVlO1xuXHQgICAgICBlbmFibGVRdWV1ZSA9IHRydWU7XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKGVuYWJsZVF1ZXVlID09IG51bGwpIHsgIGVuYWJsZVF1ZXVlID0gdHJ1ZTsgfVxuXHQgICAgcmV0dXJuIG5ldyBDb250cm9sbGVkT2JzZXJ2YWJsZSh0aGlzLCBlbmFibGVRdWV1ZSwgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBQaXBlcyB0aGUgZXhpc3RpbmcgT2JzZXJ2YWJsZSBzZXF1ZW5jZSBpbnRvIGEgTm9kZS5qcyBTdHJlYW0uXG5cdCAgICogQHBhcmFtIHtTdHJlYW19IGRlc3QgVGhlIGRlc3RpbmF0aW9uIE5vZGUuanMgc3RyZWFtLlxuXHQgICAqIEByZXR1cm5zIHtTdHJlYW19IFRoZSBkZXN0aW5hdGlvbiBzdHJlYW0uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnBpcGUgPSBmdW5jdGlvbiAoZGVzdCkge1xuXHQgICAgdmFyIHNvdXJjZSA9IHRoaXMucGF1c2FibGVCdWZmZXJlZCgpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIG9uRHJhaW4oKSB7XG5cdCAgICAgIHNvdXJjZS5yZXN1bWUoKTtcblx0ICAgIH1cblx0XG5cdCAgICBkZXN0LmFkZExpc3RlbmVyKCdkcmFpbicsIG9uRHJhaW4pO1xuXHRcblx0ICAgIHNvdXJjZS5zdWJzY3JpYmUoXG5cdCAgICAgIGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgIWRlc3Qud3JpdGUoU3RyaW5nKHgpKSAmJiBzb3VyY2UucGF1c2UoKTtcblx0ICAgICAgfSxcblx0ICAgICAgZnVuY3Rpb24gKGVycikge1xuXHQgICAgICAgIGRlc3QuZW1pdCgnZXJyb3InLCBlcnIpO1xuXHQgICAgICB9LFxuXHQgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgLy8gSGFjayBjaGVjayBiZWNhdXNlIFNURElPIGlzIG5vdCBjbG9zYWJsZVxuXHQgICAgICAgICFkZXN0Ll9pc1N0ZGlvICYmIGRlc3QuZW5kKCk7XG5cdCAgICAgICAgZGVzdC5yZW1vdmVMaXN0ZW5lcignZHJhaW4nLCBvbkRyYWluKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgc291cmNlLnJlc3VtZSgpO1xuXHRcblx0ICAgIHJldHVybiBkZXN0O1xuXHQgIH07XG5cdFxuXHQgIHZhciBUcmFuc2R1Y2VPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUcmFuc2R1Y2VPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRyYW5zZHVjZU9ic2VydmVyKG8sIHhmb3JtKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl94Zm9ybSA9IHhmb3JtO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl94Zm9ybVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSkuY2FsbCh0aGlzLl94Zm9ybSwgdGhpcy5fbywgeCk7XG5cdCAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHRoaXMuX28ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgIH07XG5cdFxuXHQgICAgVHJhbnNkdWNlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fby5vbkVycm9yKGUpOyB9O1xuXHRcblx0ICAgIFRyYW5zZHVjZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX3hmb3JtWydAQHRyYW5zZHVjZXIvcmVzdWx0J10odGhpcy5fbyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBUcmFuc2R1Y2VPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgZnVuY3Rpb24gdHJhbnNmb3JtRm9yT2JzZXJ2ZXIobykge1xuXHQgICAgcmV0dXJuIHtcblx0ICAgICAgJ0BAdHJhbnNkdWNlci9pbml0JzogZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgcmV0dXJuIG87XG5cdCAgICAgIH0sXG5cdCAgICAgICdAQHRyYW5zZHVjZXIvc3RlcCc6IGZ1bmN0aW9uKG9icywgaW5wdXQpIHtcblx0ICAgICAgICByZXR1cm4gb2JzLm9uTmV4dChpbnB1dCk7XG5cdCAgICAgIH0sXG5cdCAgICAgICdAQHRyYW5zZHVjZXIvcmVzdWx0JzogZnVuY3Rpb24ob2JzKSB7XG5cdCAgICAgICAgcmV0dXJuIG9icy5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogRXhlY3V0ZXMgYSB0cmFuc2R1Y2VyIHRvIHRyYW5zZm9ybSB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZVxuXHQgICAqIEBwYXJhbSB7VHJhbnNkdWNlcn0gdHJhbnNkdWNlciBBIHRyYW5zZHVjZXIgdG8gZXhlY3V0ZVxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdHMgZnJvbSB0aGUgdHJhbnNkdWNlci5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udHJhbnNkdWNlID0gZnVuY3Rpb24odHJhbnNkdWNlcikge1xuXHQgICAgdmFyIHNvdXJjZSA9IHRoaXM7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24obykge1xuXHQgICAgICB2YXIgeGZvcm0gPSB0cmFuc2R1Y2VyKHRyYW5zZm9ybUZvck9ic2VydmVyKG8pKTtcblx0ICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IFRyYW5zZHVjZU9ic2VydmVyKG8sIHhmb3JtKSk7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBBbm9ueW1vdXNPYnNlcnZhYmxlID0gUnguQW5vbnltb3VzT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhBbm9ueW1vdXNPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIC8vIEZpeCBzdWJzY3JpYmVyIHRvIGNoZWNrIGZvciB1bmRlZmluZWQgb3IgZnVuY3Rpb24gcmV0dXJuZWQgdG8gZGVjb3JhdGUgYXMgRGlzcG9zYWJsZVxuXHQgICAgZnVuY3Rpb24gZml4U3Vic2NyaWJlcihzdWJzY3JpYmVyKSB7XG5cdCAgICAgIHJldHVybiBzdWJzY3JpYmVyICYmIGlzRnVuY3Rpb24oc3Vic2NyaWJlci5kaXNwb3NlKSA/IHN1YnNjcmliZXIgOlxuXHQgICAgICAgIGlzRnVuY3Rpb24oc3Vic2NyaWJlcikgPyBkaXNwb3NhYmxlQ3JlYXRlKHN1YnNjcmliZXIpIDogZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNldERpc3Bvc2FibGUocywgc3RhdGUpIHtcblx0ICAgICAgdmFyIGFkbyA9IHN0YXRlWzBdLCBzZWxmID0gc3RhdGVbMV07XG5cdCAgICAgIHZhciBzdWIgPSB0cnlDYXRjaChzZWxmLl9fc3Vic2NyaWJlKS5jYWxsKHNlbGYsIGFkbyk7XG5cdCAgICAgIGlmIChzdWIgPT09IGVycm9yT2JqICYmICFhZG8uZmFpbChlcnJvck9iai5lKSkgeyB0aHJvd2VyKGVycm9yT2JqLmUpOyB9XG5cdCAgICAgIGFkby5zZXREaXNwb3NhYmxlKGZpeFN1YnNjcmliZXIoc3ViKSk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gQW5vbnltb3VzT2JzZXJ2YWJsZShzdWJzY3JpYmUsIHBhcmVudCkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHBhcmVudDtcblx0ICAgICAgdGhpcy5fX3N1YnNjcmliZSA9IHN1YnNjcmliZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgQW5vbnltb3VzT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBhZG8gPSBuZXcgQXV0b0RldGFjaE9ic2VydmVyKG8pLCBzdGF0ZSA9IFthZG8sIHRoaXNdO1xuXHRcblx0ICAgICAgaWYgKGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZXF1aXJlZCgpKSB7XG5cdCAgICAgICAgY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZSwgc2V0RGlzcG9zYWJsZSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc2V0RGlzcG9zYWJsZShudWxsLCBzdGF0ZSk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGFkbztcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEFub255bW91c09ic2VydmFibGU7XG5cdFxuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICB2YXIgQXV0b0RldGFjaE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEF1dG9EZXRhY2hPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBBdXRvRGV0YWNoT2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgICAgdGhpcy5tID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZSA9IEF1dG9EZXRhY2hPYnNlcnZlci5wcm90b3R5cGU7XG5cdFxuXHQgICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25OZXh0KS5jYWxsKHRoaXMub2JzZXJ2ZXIsIHZhbHVlKTtcblx0ICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHtcblx0ICAgICAgICB0aGlzLmRpc3Bvc2UoKTtcblx0ICAgICAgICB0aHJvd2VyKHJlc3VsdC5lKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLm9ic2VydmVyLm9uRXJyb3IpLmNhbGwodGhpcy5vYnNlcnZlciwgZXJyKTtcblx0ICAgICAgdGhpcy5kaXNwb3NlKCk7XG5cdCAgICAgIHJlc3VsdCA9PT0gZXJyb3JPYmogJiYgdGhyb3dlcihyZXN1bHQuZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLm9ic2VydmVyLm9uQ29tcGxldGVkKS5jYWxsKHRoaXMub2JzZXJ2ZXIpO1xuXHQgICAgICB0aGlzLmRpc3Bvc2UoKTtcblx0ICAgICAgcmVzdWx0ID09PSBlcnJvck9iaiAmJiB0aHJvd2VyKHJlc3VsdC5lKTtcblx0ICAgIH07XG5cdFxuXHQgICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLnNldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAodmFsdWUpIHsgdGhpcy5tLnNldERpc3Bvc2FibGUodmFsdWUpOyB9O1xuXHQgICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLmdldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm0uZ2V0RGlzcG9zYWJsZSgpOyB9O1xuXHRcblx0ICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBfX3N1cGVyX18ucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5tLmRpc3Bvc2UoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEF1dG9EZXRhY2hPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgdmFyIElubmVyU3Vic2NyaXB0aW9uID0gZnVuY3Rpb24gKHMsIG8pIHtcblx0ICAgIHRoaXMuX3MgPSBzO1xuXHQgICAgdGhpcy5fbyA9IG87XG5cdCAgfTtcblx0XG5cdCAgSW5uZXJTdWJzY3JpcHRpb24ucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuX3MuaXNEaXNwb3NlZCAmJiB0aGlzLl9vICE9PSBudWxsKSB7XG5cdCAgICAgIHZhciBpZHggPSB0aGlzLl9zLm9ic2VydmVycy5pbmRleE9mKHRoaXMuX28pO1xuXHQgICAgICB0aGlzLl9zLm9ic2VydmVycy5zcGxpY2UoaWR4LCAxKTtcblx0ICAgICAgdGhpcy5fbyA9IG51bGw7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJlcHJlc2VudHMgYW4gb2JqZWN0IHRoYXQgaXMgYm90aCBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIHdlbGwgYXMgYW4gb2JzZXJ2ZXIuXG5cdCAgICogIEVhY2ggbm90aWZpY2F0aW9uIGlzIGJyb2FkY2FzdGVkIHRvIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycy5cblx0ICAgKi9cblx0ICB2YXIgU3ViamVjdCA9IFJ4LlN1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU3ViamVjdCwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFN1YmplY3QoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcblx0ICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIGFkZFByb3BlcnRpZXMoU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuXHQgICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvKTtcblx0ICAgICAgICAgIHJldHVybiBuZXcgSW5uZXJTdWJzY3JpcHRpb24odGhpcywgbyk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG5cdCAgICAgICAgICBvLm9uRXJyb3IodGhpcy5lcnJvcik7XG5cdCAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgICAgIH1cblx0ICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cblx0ICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cblx0ICAgICAgICovXG5cdCAgICAgIGhhc09ic2VydmVyczogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5vYnNlcnZlcnMubGVuZ3RoID4gMDsgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAgICovXG5cdCAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgICAgb3NbaV0ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXhjZXB0aW9uLlxuXHQgICAgICAgKiBAcGFyYW0ge01peGVkfSBlcnJvciBUaGUgZXhjZXB0aW9uIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cblx0ICAgICAgICovXG5cdCAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXHQgICAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgICAgb3NbaV0ub25FcnJvcihlcnJvcik7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGFycml2YWwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cblx0ICAgICAgICovXG5cdCAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgICAgb3NbaV0ub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBVbnN1YnNjcmliZSBhbGwgb2JzZXJ2ZXJzIGFuZCByZWxlYXNlIHJlc291cmNlcy5cblx0ICAgICAgICovXG5cdCAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBDcmVhdGVzIGEgc3ViamVjdCBmcm9tIHRoZSBzcGVjaWZpZWQgb2JzZXJ2ZXIgYW5kIG9ic2VydmFibGUuXG5cdCAgICAgKiBAcGFyYW0ge09ic2VydmVyfSBvYnNlcnZlciBUaGUgb2JzZXJ2ZXIgdXNlZCB0byBzZW5kIG1lc3NhZ2VzIHRvIHRoZSBzdWJqZWN0LlxuXHQgICAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBvYnNlcnZhYmxlIFRoZSBvYnNlcnZhYmxlIHVzZWQgdG8gc3Vic2NyaWJlIHRvIG1lc3NhZ2VzIHNlbnQgZnJvbSB0aGUgc3ViamVjdC5cblx0ICAgICAqIEByZXR1cm5zIHtTdWJqZWN0fSBTdWJqZWN0IGltcGxlbWVudGVkIHVzaW5nIHRoZSBnaXZlbiBvYnNlcnZlciBhbmQgb2JzZXJ2YWJsZS5cblx0ICAgICAqL1xuXHQgICAgU3ViamVjdC5jcmVhdGUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIsIG9ic2VydmFibGUpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNTdWJqZWN0KG9ic2VydmVyLCBvYnNlcnZhYmxlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFN1YmplY3Q7XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXByZXNlbnRzIHRoZSByZXN1bHQgb2YgYW4gYXN5bmNocm9ub3VzIG9wZXJhdGlvbi5cblx0ICAgKiAgVGhlIGxhc3QgdmFsdWUgYmVmb3JlIHRoZSBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24sIG9yIHRoZSBlcnJvciByZWNlaXZlZCB0aHJvdWdoIE9uRXJyb3IsIGlzIHNlbnQgdG8gYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzLlxuXHQgICAqL1xuXHQgIHZhciBBc3luY1N1YmplY3QgPSBSeC5Bc3luY1N1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQXN5bmNTdWJqZWN0LCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ3JlYXRlcyBhIHN1YmplY3QgdGhhdCBjYW4gb25seSByZWNlaXZlIG9uZSB2YWx1ZSBhbmQgdGhhdCB2YWx1ZSBpcyBjYWNoZWQgZm9yIGFsbCBmdXR1cmUgb2JzZXJ2YXRpb25zLlxuXHQgICAgICogQGNvbnN0cnVjdG9yXG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIEFzeW5jU3ViamVjdCgpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmhhc1ZhbHVlID0gZmFsc2U7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG5cdCAgICAgIHRoaXMuaGFzRXJyb3IgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICBhZGRQcm9wZXJ0aWVzKEFzeW5jU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuXHQgICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdFxuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gobyk7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IElubmVyU3Vic2NyaXB0aW9uKHRoaXMsIG8pO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3IpIHtcblx0ICAgICAgICAgIG8ub25FcnJvcih0aGlzLmVycm9yKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaGFzVmFsdWUpIHtcblx0ICAgICAgICAgIG8ub25OZXh0KHRoaXMudmFsdWUpO1xuXHQgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuXHQgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuXHQgICAgICAgKi9cblx0ICAgICAgaGFzT2JzZXJ2ZXJzOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICByZXR1cm4gdGhpcy5vYnNlcnZlcnMubGVuZ3RoID4gMDtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZSwgYWxzbyBjYXVzaW5nIHRoZSBsYXN0IHJlY2VpdmVkIHZhbHVlIHRvIGJlIHNlbnQgb3V0IChpZiBhbnkpLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgaSwgbGVuO1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdmFyIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDtcblx0XG5cdCAgICAgICAgICBpZiAodGhpcy5oYXNWYWx1ZSkge1xuXHQgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgICAgICB2YXIgbyA9IG9zW2ldO1xuXHQgICAgICAgICAgICAgIG8ub25OZXh0KHRoaXMudmFsdWUpO1xuXHQgICAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICAgICAgb3NbaV0ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlcnJvci5cblx0ICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIEVycm9yIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cblx0ICAgICAgICovXG5cdCAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG5cdFxuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICAgIG9zW2ldLm9uRXJyb3IoZXJyb3IpO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogU2VuZHMgYSB2YWx1ZSB0byB0aGUgc3ViamVjdC4gVGhlIGxhc3QgdmFsdWUgcmVjZWl2ZWQgYmVmb3JlIHN1Y2Nlc3NmdWwgdGVybWluYXRpb24gd2lsbCBiZSBzZW50IHRvIGFsbCBzdWJzY3JpYmVkIGFuZCBmdXR1cmUgb2JzZXJ2ZXJzLlxuXHQgICAgICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc3RvcmUgaW4gdGhlIHN1YmplY3QuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0ICAgICAgICB0aGlzLmhhc1ZhbHVlID0gdHJ1ZTtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuXHQgICAgICAgKi9cblx0ICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBudWxsO1xuXHQgICAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xuXHQgICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICByZXR1cm4gQXN5bmNTdWJqZWN0O1xuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICB2YXIgQW5vbnltb3VzU3ViamVjdCA9IFJ4LkFub255bW91c1N1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQW5vbnltb3VzU3ViamVjdCwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEFub255bW91c1N1YmplY3Qob2JzZXJ2ZXIsIG9ic2VydmFibGUpIHtcblx0ICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgICB0aGlzLm9ic2VydmFibGUgPSBvYnNlcnZhYmxlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBhZGRQcm9wZXJ0aWVzKEFub255bW91c1N1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcblx0ICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5vYnNlcnZhYmxlLnN1YnNjcmliZShvKTtcblx0ICAgICAgfSxcblx0ICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLm9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH0sXG5cdCAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXIub25FcnJvcihlcnJvcik7XG5cdCAgICAgIH0sXG5cdCAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlci5vbk5leHQodmFsdWUpO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICByZXR1cm4gQW5vbnltb3VzU3ViamVjdDtcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJlcHJlc2VudHMgYSB2YWx1ZSB0aGF0IGNoYW5nZXMgb3ZlciB0aW1lLlxuXHQgICAqICBPYnNlcnZlcnMgY2FuIHN1YnNjcmliZSB0byB0aGUgc3ViamVjdCB0byByZWNlaXZlIHRoZSBsYXN0IChvciBpbml0aWFsKSB2YWx1ZSBhbmQgYWxsIHN1YnNlcXVlbnQgbm90aWZpY2F0aW9ucy5cblx0ICAgKi9cblx0ICB2YXIgQmVoYXZpb3JTdWJqZWN0ID0gUnguQmVoYXZpb3JTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEJlaGF2aW9yU3ViamVjdCwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEJlaGF2aW9yU3ViamVjdCh2YWx1ZSkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXHQgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIGFkZFByb3BlcnRpZXMoQmVoYXZpb3JTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG5cdCAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG8pO1xuXHQgICAgICAgICAgby5vbk5leHQodGhpcy52YWx1ZSk7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IElubmVyU3Vic2NyaXB0aW9uKHRoaXMsIG8pO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuXHQgICAgICAgICAgby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBHZXRzIHRoZSBjdXJyZW50IHZhbHVlIG9yIHRocm93cyBhbiBleGNlcHRpb24uXG5cdCAgICAgICAqIFZhbHVlIGlzIGZyb3plbiBhZnRlciBvbkNvbXBsZXRlZCBpcyBjYWxsZWQuXG5cdCAgICAgICAqIEFmdGVyIG9uRXJyb3IgaXMgY2FsbGVkIGFsd2F5cyB0aHJvd3MgdGhlIHNwZWNpZmllZCBleGNlcHRpb24uXG5cdCAgICAgICAqIEFuIGV4Y2VwdGlvbiBpcyBhbHdheXMgdGhyb3duIGFmdGVyIGRpc3Bvc2UgaXMgY2FsbGVkLlxuXHQgICAgICAgKiBAcmV0dXJucyB7TWl4ZWR9IFRoZSBpbml0aWFsIHZhbHVlIHBhc3NlZCB0byB0aGUgY29uc3RydWN0b3IgdW50aWwgb25OZXh0IGlzIGNhbGxlZDsgYWZ0ZXIgd2hpY2gsIHRoZSBsYXN0IHZhbHVlIHBhc3NlZCB0byBvbk5leHQuXG5cdCAgICAgICAqL1xuXHQgICAgICBnZXRWYWx1ZTogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG5cdCAgICAgICAgICAgICAgdGhyb3cgdGhpcy5lcnJvcjtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuXHQgICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuXHQgICAgICAgKi9cblx0ICAgICAgaGFzT2JzZXJ2ZXJzOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm9ic2VydmVycy5sZW5ndGggPiAwOyB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICBvc1tpXS5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXhjZXB0aW9uLlxuXHQgICAgICAgKiBAcGFyYW0ge01peGVkfSBlcnJvciBUaGUgZXhjZXB0aW9uIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cblx0ICAgICAgICovXG5cdCAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG5cdFxuXHQgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgb3NbaV0ub25FcnJvcihlcnJvcik7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBhcnJpdmFsIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgIG9zW2ldLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogVW5zdWJzY3JpYmUgYWxsIG9ic2VydmVycyBhbmQgcmVsZWFzZSByZXNvdXJjZXMuXG5cdCAgICAgICAqL1xuXHQgICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm9ic2VydmVycyA9IG51bGw7XG5cdCAgICAgICAgdGhpcy52YWx1ZSA9IG51bGw7XG5cdCAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHRcblx0ICAgIHJldHVybiBCZWhhdmlvclN1YmplY3Q7XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJlcHJlc2VudHMgYW4gb2JqZWN0IHRoYXQgaXMgYm90aCBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIHdlbGwgYXMgYW4gb2JzZXJ2ZXIuXG5cdCAgICogRWFjaCBub3RpZmljYXRpb24gaXMgYnJvYWRjYXN0ZWQgdG8gYWxsIHN1YnNjcmliZWQgYW5kIGZ1dHVyZSBvYnNlcnZlcnMsIHN1YmplY3QgdG8gYnVmZmVyIHRyaW1taW5nIHBvbGljaWVzLlxuXHQgICAqL1xuXHQgIHZhciBSZXBsYXlTdWJqZWN0ID0gUnguUmVwbGF5U3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdFxuXHQgICAgdmFyIG1heFNhZmVJbnRlZ2VyID0gTWF0aC5wb3coMiwgNTMpIC0gMTtcblx0XG5cdCAgICBmdW5jdGlvbiBjcmVhdGVSZW1vdmFibGVEaXNwb3NhYmxlKHN1YmplY3QsIG9ic2VydmVyKSB7XG5cdCAgICAgIHJldHVybiBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBvYnNlcnZlci5kaXNwb3NlKCk7XG5cdCAgICAgICAgIXN1YmplY3QuaXNEaXNwb3NlZCAmJiBzdWJqZWN0Lm9ic2VydmVycy5zcGxpY2Uoc3ViamVjdC5vYnNlcnZlcnMuaW5kZXhPZihvYnNlcnZlciksIDEpO1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0XG5cdCAgICBpbmhlcml0cyhSZXBsYXlTdWJqZWN0LCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogIEluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBSZXBsYXlTdWJqZWN0IGNsYXNzIHdpdGggdGhlIHNwZWNpZmllZCBidWZmZXIgc2l6ZSwgd2luZG93IHNpemUgYW5kIHNjaGVkdWxlci5cblx0ICAgICAqICBAcGFyYW0ge051bWJlcn0gW2J1ZmZlclNpemVdIE1heGltdW0gZWxlbWVudCBjb3VudCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cblx0ICAgICAqICBAcGFyYW0ge051bWJlcn0gW3dpbmRvd1NpemVdIE1heGltdW0gdGltZSBsZW5ndGggb2YgdGhlIHJlcGxheSBidWZmZXIuXG5cdCAgICAgKiAgQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0aGUgb2JzZXJ2ZXJzIGFyZSBpbnZva2VkIG9uLlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBSZXBsYXlTdWJqZWN0KGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLmJ1ZmZlclNpemUgPSBidWZmZXJTaXplID09IG51bGwgPyBtYXhTYWZlSW50ZWdlciA6IGJ1ZmZlclNpemU7XG5cdCAgICAgIHRoaXMud2luZG93U2l6ZSA9IHdpbmRvd1NpemUgPT0gbnVsbCA/IG1heFNhZmVJbnRlZ2VyIDogd2luZG93U2l6ZTtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXIgfHwgY3VycmVudFRocmVhZFNjaGVkdWxlcjtcblx0ICAgICAgdGhpcy5xID0gW107XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmhhc0Vycm9yID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBhZGRQcm9wZXJ0aWVzKFJlcGxheVN1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcblx0ICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIHZhciBzbyA9IG5ldyBTY2hlZHVsZWRPYnNlcnZlcih0aGlzLnNjaGVkdWxlciwgbyksIHN1YnNjcmlwdGlvbiA9IGNyZWF0ZVJlbW92YWJsZURpc3Bvc2FibGUodGhpcywgc28pO1xuXHRcblx0ICAgICAgICB0aGlzLl90cmltKHRoaXMuc2NoZWR1bGVyLm5vdygpKTtcblx0ICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKHNvKTtcblx0XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMucS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgc28ub25OZXh0KHRoaXMucVtpXS52YWx1ZSk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuXHQgICAgICAgICAgc28ub25FcnJvcih0aGlzLmVycm9yKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICBzby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgc28uZW5zdXJlQWN0aXZlKCk7XG5cdCAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cblx0ICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cblx0ICAgICAgICovXG5cdCAgICAgIGhhc09ic2VydmVyczogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLm9ic2VydmVycy5sZW5ndGggPiAwO1xuXHQgICAgICB9LFxuXHQgICAgICBfdHJpbTogZnVuY3Rpb24gKG5vdykge1xuXHQgICAgICAgIHdoaWxlICh0aGlzLnEubGVuZ3RoID4gdGhpcy5idWZmZXJTaXplKSB7XG5cdCAgICAgICAgICB0aGlzLnEuc2hpZnQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgd2hpbGUgKHRoaXMucS5sZW5ndGggPiAwICYmIChub3cgLSB0aGlzLnFbMF0uaW50ZXJ2YWwpID4gdGhpcy53aW5kb3dTaXplKSB7XG5cdCAgICAgICAgICB0aGlzLnEuc2hpZnQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGFycml2YWwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cblx0ICAgICAgICovXG5cdCAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdmFyIG5vdyA9IHRoaXMuc2NoZWR1bGVyLm5vdygpO1xuXHQgICAgICAgIHRoaXMucS5wdXNoKHsgaW50ZXJ2YWw6IG5vdywgdmFsdWU6IHZhbHVlIH0pO1xuXHQgICAgICAgIHRoaXMuX3RyaW0obm93KTtcblx0XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBvc1tpXTtcblx0ICAgICAgICAgIG9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgICBvYnNlcnZlci5lbnN1cmVBY3RpdmUoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGV4Y2VwdGlvbi5cblx0ICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIGV4Y2VwdGlvbiB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXHQgICAgICAgIHRoaXMuaGFzRXJyb3IgPSB0cnVlO1xuXHQgICAgICAgIHZhciBub3cgPSB0aGlzLnNjaGVkdWxlci5ub3coKTtcblx0ICAgICAgICB0aGlzLl90cmltKG5vdyk7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBvc1tpXTtcblx0ICAgICAgICAgIG9ic2VydmVyLm9uRXJyb3IoZXJyb3IpO1xuXHQgICAgICAgICAgb2JzZXJ2ZXIuZW5zdXJlQWN0aXZlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB2YXIgbm93ID0gdGhpcy5zY2hlZHVsZXIubm93KCk7XG5cdCAgICAgICAgdGhpcy5fdHJpbShub3cpO1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgdmFyIG9ic2VydmVyID0gb3NbaV07XG5cdCAgICAgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgb2JzZXJ2ZXIuZW5zdXJlQWN0aXZlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBVbnN1YnNjcmliZSBhbGwgb2JzZXJ2ZXJzIGFuZCByZWxlYXNlIHJlc291cmNlcy5cblx0ICAgICAgICovXG5cdCAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIFJlcGxheVN1YmplY3Q7XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogVXNlZCB0byBwYXVzZSBhbmQgcmVzdW1lIHN0cmVhbXMuXG5cdCAgKi9cblx0ICBSeC5QYXVzZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoUGF1c2VyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gUGF1c2VyKCkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFBhdXNlcyB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cblx0ICAgICAqL1xuXHQgICAgUGF1c2VyLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5vbk5leHQoZmFsc2UpOyB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgKiBSZXN1bWVzIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuXHQgICAgKi9cblx0ICAgIFBhdXNlci5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgeyB0aGlzLm9uTmV4dCh0cnVlKTsgfTtcblx0XG5cdCAgICByZXR1cm4gUGF1c2VyO1xuXHQgIH0oU3ViamVjdCkpO1xuXHRcblx0ICBpZiAodHJ1ZSkge1xuXHQgICAgcm9vdC5SeCA9IFJ4O1xuXHRcblx0ICAgICEoX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIFJ4O1xuXHQgICAgfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18sIGV4cG9ydHMsIG1vZHVsZSksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblx0ICB9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUpIHtcblx0ICAgIC8vIGluIE5vZGUuanMgb3IgUmluZ29KU1xuXHQgICAgaWYgKG1vZHVsZUV4cG9ydHMpIHtcblx0ICAgICAgKGZyZWVNb2R1bGUuZXhwb3J0cyA9IFJ4KS5SeCA9IFJ4O1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgZnJlZUV4cG9ydHMuUnggPSBSeDtcblx0ICAgIH1cblx0ICB9IGVsc2Uge1xuXHQgICAgLy8gaW4gYSBicm93c2VyIG9yIFJoaW5vXG5cdCAgICByb290LlJ4ID0gUng7XG5cdCAgfVxuXHRcblx0ICAvLyBBbGwgY29kZSBiZWZvcmUgdGhpcyBwb2ludCB3aWxsIGJlIGZpbHRlcmVkIGZyb20gc3RhY2sgdHJhY2VzLlxuXHQgIHZhciByRW5kaW5nTGluZSA9IGNhcHR1cmVMaW5lKCk7XG5cdFxuXHR9LmNhbGwodGhpcykpO1xuXHRcblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMzcpKG1vZHVsZSksIChmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0oKSksIF9fd2VicGFja19yZXF1aXJlX18oOSkpKVxuXG4vKioqLyB9LFxuLyogMTcgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpKCk7XG5cdC8vIGltcG9ydHNcblx0XG5cdFxuXHQvLyBtb2R1bGVcblx0ZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiLmNsaW1iX193YWxse3dpZHRoOjEwMCU7cGFkZGluZzowO21hcmdpbjowOy13ZWJraXQtanVzdGlmeS1jb250ZW50OmNlbnRlcjstbXMtZmxleC1wYWNrOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOy13ZWJraXQtZmxleC1kaXJlY3Rpb246cm93Oy1tcy1mbGV4LWRpcmVjdGlvbjpyb3c7ZmxleC1kaXJlY3Rpb246cm93Oy13ZWJraXQtZmxleC13cmFwOndyYXA7LW1zLWZsZXgtd3JhcDp3cmFwO2ZsZXgtd3JhcDp3cmFwO2ZvbnQtc2l6ZToxMDAlfS5jbGltYl9fdGlsZSwuY2xpbWJfX3dhbGx7ZGlzcGxheTotd2Via2l0LWZsZXg7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXh9LmNsaW1iX190aWxley13ZWJraXQtZmxleC1zaHJpbms6MDstbXMtZmxleC1uZWdhdGl2ZTowO2ZsZXgtc2hyaW5rOjA7aGVpZ2h0OjQyNXB4O2JveC1zaXppbmc6Ym9yZGVyLWJveDstd2Via2l0LWp1c3RpZnktY29udGVudDpmbGV4LWVuZDstbXMtZmxleC1wYWNrOmVuZDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQ7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpjb2x1bW47LW1zLWZsZXgtZGlyZWN0aW9uOmNvbHVtbjtmbGV4LWRpcmVjdGlvbjpjb2x1bW47bWFyZ2luLWJvdHRvbToyMHB4O292ZXJmbG93OmhpZGRlbjt0ZXh0LWFsaWduOmxlZnQ7Ym9yZGVyLXJhZGl1czo3cHg7YmFja2dyb3VuZC1jb2xvcjojZjZmNmY2Oy13ZWJraXQtYmFja2ZhY2UtdmlzaWJpbGl0eTpoaWRkZW47YmFja2ZhY2UtdmlzaWJpbGl0eTpoaWRkZW47LXdlYmtpdC1wZXJzcGVjdGl2ZToxMDAwcHg7cGVyc3BlY3RpdmU6MTAwMHB4fS5jbGltYl9fdGlsZV9fY29udGVudHt6LWluZGV4OjE7cGFkZGluZzoyNnB4O2JhY2tncm91bmQtY29sb3I6I2Y2ZjZmNn0uY2xpbWJfX3RpbGUtLWhhcy1uby1pbWFnZSAuY2xpbWJfX3RpbGVfX2NvbnRlbnR7aGVpZ2h0OjEwMCU7ZGlzcGxheTotd2Via2l0LWZsZXg7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpjb2x1bW47LW1zLWZsZXgtZGlyZWN0aW9uOmNvbHVtbjtmbGV4LWRpcmVjdGlvbjpjb2x1bW47LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjstbXMtZmxleC1wYWNrOmp1c3RpZnk7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47Ym94LXNpemluZzpib3JkZXItYm94fS5jbGltYl9faW1hZ2V7ZGlzcGxheTpibG9jazttYXgtd2lkdGg6MTAwJX0uY2xpbWJfX3RpbGUgLmNsaW1iX19pbWFnZXtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjdweDtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czo3cHh9LmNsaW1iX190aWxlX19tZXNzYWdle3otaW5kZXg6MTttYXJnaW4tYm90dG9tOjI0cHh9LmNsaW1iX190aWxlX19tZXNzYWdlPmF7d2hpdGUtc3BhY2U6bm93cmFwO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzO21heC13aWR0aDoyNjBweDtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjpib3R0b219LmNsaW1iX190aWxlLS1oYXMtbm8taW1hZ2UgLmNsaW1iX190aWxlX19tZXNzYWdle2ZvbnQtc2l6ZToxODUlfS5jbGltYl9fdGlsZV9fYXV0aG9ye2Rpc3BsYXk6YmxvY2s7bWFyZ2luOi0xMHB4fS5jbGltYl9fdGlsZV9fYXV0aG9yIGltZ3tib3JkZXItcmFkaXVzOjI1cHg7d2lkdGg6MzRweH0uY2xpbWJfX3RpbGVfX2F1dGhvciAuY2xpbWJfX3RpbGVfX2F1dGhvcl9fdXNlcm5hbWV7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luOjAgMCAwIDEwcHg7bGluZS1oZWlnaHQ6MzRweDt2ZXJ0aWNhbC1hbGlnbjp0b3B9LmNsaW1iLXNvY2lhbC1iYWRnZXtwb3NpdGlvbjpmaXhlZDtib3R0b206MjBweDtyaWdodDoyMHB4O3otaW5kZXg6OTtiYWNrZ3JvdW5kLWNvbG9yOiNhOWNhZTI7d2lkdGg6MjAwcHg7aGVpZ2h0OjY2cHg7Ym9yZGVyLXJhZGl1czo1cHh9LmNsaW1iLXNvY2lhbC1iYWRnZT5zcGFue3Bvc2l0aW9uOmFic29sdXRlIWltcG9ydGFudDt0b3A6LTk5OTlweCFpbXBvcnRhbnQ7bGVmdDotOTk5OXB4IWltcG9ydGFudH0uY2xpbWItc2xpZGVzaG93e2hlaWdodDoxMDB2aDtkaXNwbGF5Oi13ZWJraXQtZmxleDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstd2Via2l0LWZsZXgtZGlyZWN0aW9uOnJvdzstbXMtZmxleC1kaXJlY3Rpb246cm93O2ZsZXgtZGlyZWN0aW9uOnJvdzstd2Via2l0LWFsaWduLWl0ZW1zOmNlbnRlcjstbXMtZmxleC1hbGlnbjpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyOy13ZWJraXQtanVzdGlmeS1jb250ZW50OmNlbnRlcjstbXMtZmxleC1wYWNrOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5jbGltYi1zbGlkZXNob3dfX3NsaWRle2Rpc3BsYXk6YmxvY2s7d2lkdGg6NzAlO21hcmdpbjowIGF1dG87YmFja2dyb3VuZC1jb2xvcjojZjZmNmY2fVwiLCBcIlwiXSk7XG5cdFxuXHQvLyBleHBvcnRzXG5cblxuLyoqKi8gfSxcbi8qIDE4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKlxyXG5cdFx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuXHRcdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuXHQqL1xyXG5cdC8vIGNzcyBiYXNlIGNvZGUsIGluamVjdGVkIGJ5IHRoZSBjc3MtbG9hZGVyXHJcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBsaXN0ID0gW107XHJcblx0XHJcblx0XHQvLyByZXR1cm4gdGhlIGxpc3Qgb2YgbW9kdWxlcyBhcyBjc3Mgc3RyaW5nXHJcblx0XHRsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XHJcblx0XHRcdHZhciByZXN1bHQgPSBbXTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgaXRlbSA9IHRoaXNbaV07XHJcblx0XHRcdFx0aWYoaXRlbVsyXSkge1xyXG5cdFx0XHRcdFx0cmVzdWx0LnB1c2goXCJAbWVkaWEgXCIgKyBpdGVtWzJdICsgXCJ7XCIgKyBpdGVtWzFdICsgXCJ9XCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyZXN1bHQucHVzaChpdGVtWzFdKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHJlc3VsdC5qb2luKFwiXCIpO1xyXG5cdFx0fTtcclxuXHRcclxuXHRcdC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XHJcblx0XHRsaXN0LmkgPSBmdW5jdGlvbihtb2R1bGVzLCBtZWRpYVF1ZXJ5KSB7XHJcblx0XHRcdGlmKHR5cGVvZiBtb2R1bGVzID09PSBcInN0cmluZ1wiKVxyXG5cdFx0XHRcdG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsIFwiXCJdXTtcclxuXHRcdFx0dmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgaWQgPSB0aGlzW2ldWzBdO1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBpZCA9PT0gXCJudW1iZXJcIilcclxuXHRcdFx0XHRcdGFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaWRdID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIGl0ZW0gPSBtb2R1bGVzW2ldO1xyXG5cdFx0XHRcdC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcclxuXHRcdFx0XHQvLyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIG5vdCAxMDAlIHBlcmZlY3QgZm9yIHdlaXJkIG1lZGlhIHF1ZXJ5IGNvbWJpbmF0aW9uc1xyXG5cdFx0XHRcdC8vICB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXHJcblx0XHRcdFx0Ly8gIEkgaG9wZSB0aGlzIHdpbGwgbmV2ZXIgb2NjdXIgKEhleSB0aGlzIHdheSB3ZSBoYXZlIHNtYWxsZXIgYnVuZGxlcylcclxuXHRcdFx0XHRpZih0eXBlb2YgaXRlbVswXSAhPT0gXCJudW1iZXJcIiB8fCAhYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpdGVtWzBdXSkge1xyXG5cdFx0XHRcdFx0aWYobWVkaWFRdWVyeSAmJiAhaXRlbVsyXSkge1xyXG5cdFx0XHRcdFx0XHRpdGVtWzJdID0gbWVkaWFRdWVyeTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZihtZWRpYVF1ZXJ5KSB7XHJcblx0XHRcdFx0XHRcdGl0ZW1bMl0gPSBcIihcIiArIGl0ZW1bMl0gKyBcIikgYW5kIChcIiArIG1lZGlhUXVlcnkgKyBcIilcIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGxpc3QucHVzaChpdGVtKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gbGlzdDtcclxuXHR9O1xyXG5cblxuLyoqKi8gfSxcbi8qIDE5ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHQgIGlmICh0cnVlKSB7XG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbZXhwb3J0cywgbW9kdWxlXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID0gKGZhY3RvcnkpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9ICh0eXBlb2YgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID09PSAnZnVuY3Rpb24nID8gKF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXy5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSkgOiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgIGZhY3RvcnkoZXhwb3J0cywgbW9kdWxlKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgdmFyIG1vZCA9IHtcblx0ICAgICAgZXhwb3J0czoge31cblx0ICAgIH07XG5cdCAgICBmYWN0b3J5KG1vZC5leHBvcnRzLCBtb2QpO1xuXHQgICAgZ2xvYmFsLmZldGNoSnNvbnAgPSBtb2QuZXhwb3J0cztcblx0ICB9XG5cdH0pKHRoaXMsIGZ1bmN0aW9uIChleHBvcnRzLCBtb2R1bGUpIHtcblx0ICAndXNlIHN0cmljdCc7XG5cdFxuXHQgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcblx0ICAgIHRpbWVvdXQ6IDUwMDAsXG5cdCAgICBqc29ucENhbGxiYWNrOiAnY2FsbGJhY2snXG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gZ2VuZXJhdGVDYWxsYmFja0Z1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuICdqc29ucF8nICsgRGF0ZS5ub3coKSArICdfJyArIE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTAwMDAwKTtcblx0ICB9XG5cdFxuXHQgIC8vIEtub3duIGlzc3VlOiBXaWxsIHRocm93ICdVbmNhdWdodCBSZWZlcmVuY2VFcnJvcjogY2FsbGJhY2tfKioqIGlzIG5vdCBkZWZpbmVkJyBlcnJvciBpZiByZXF1ZXN0IHRpbWVvdXRcblx0ICBmdW5jdGlvbiBjbGVhckZ1bmN0aW9uKGZ1bmN0aW9uTmFtZSkge1xuXHQgICAgLy8gSUU4IHRocm93cyBhbiBleGNlcHRpb24gd2hlbiB5b3UgdHJ5IHRvIGRlbGV0ZSBhIHByb3BlcnR5IG9uIHdpbmRvd1xuXHQgICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTgyNDIyOC83NTEwODlcblx0ICAgIHRyeSB7XG5cdCAgICAgIGRlbGV0ZSB3aW5kb3dbZnVuY3Rpb25OYW1lXTtcblx0ICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgd2luZG93W2Z1bmN0aW9uTmFtZV0gPSB1bmRlZmluZWQ7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiByZW1vdmVTY3JpcHQoc2NyaXB0SWQpIHtcblx0ICAgIHZhciBzY3JpcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzY3JpcHRJZCk7XG5cdCAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0ucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcblx0ICB9XG5cdFxuXHQgIHZhciBmZXRjaEpzb25wID0gZnVuY3Rpb24gZmV0Y2hKc29ucCh1cmwpIHtcblx0ICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07XG5cdFxuXHQgICAgdmFyIHRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQgIT0gbnVsbCA/IG9wdGlvbnMudGltZW91dCA6IGRlZmF1bHRPcHRpb25zLnRpbWVvdXQ7XG5cdCAgICB2YXIganNvbnBDYWxsYmFjayA9IG9wdGlvbnMuanNvbnBDYWxsYmFjayAhPSBudWxsID8gb3B0aW9ucy5qc29ucENhbGxiYWNrIDogZGVmYXVsdE9wdGlvbnMuanNvbnBDYWxsYmFjaztcblx0XG5cdCAgICB2YXIgdGltZW91dElkID0gdW5kZWZpbmVkO1xuXHRcblx0ICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgIHZhciBjYWxsYmFja0Z1bmN0aW9uID0gZ2VuZXJhdGVDYWxsYmFja0Z1bmN0aW9uKCk7XG5cdFxuXHQgICAgICB3aW5kb3dbY2FsbGJhY2tGdW5jdGlvbl0gPSBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblx0ICAgICAgICByZXNvbHZlKHtcblx0ICAgICAgICAgIG9rOiB0cnVlLFxuXHQgICAgICAgICAgLy8ga2VlcCBjb25zaXN0ZW50IHdpdGggZmV0Y2ggQVBJXG5cdCAgICAgICAgICBqc29uOiBmdW5jdGlvbiBqc29uKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3BvbnNlKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgaWYgKHRpbWVvdXRJZCkgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG5cdFxuXHQgICAgICAgIHJlbW92ZVNjcmlwdChqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbik7XG5cdFxuXHQgICAgICAgIGNsZWFyRnVuY3Rpb24oY2FsbGJhY2tGdW5jdGlvbik7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICAvLyBDaGVjayBpZiB0aGUgdXNlciBzZXQgdGhlaXIgb3duIHBhcmFtcywgYW5kIGlmIG5vdCBhZGQgYSA/IHRvIHN0YXJ0IGEgbGlzdCBvZiBwYXJhbXNcblx0ICAgICAgdXJsICs9IHVybC5pbmRleE9mKCc/JykgPT09IC0xID8gJz8nIDogJyYnO1xuXHRcblx0ICAgICAgdmFyIGpzb25wU2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cdCAgICAgIGpzb25wU2NyaXB0LnNldEF0dHJpYnV0ZShcInNyY1wiLCB1cmwgKyBqc29ucENhbGxiYWNrICsgJz0nICsgY2FsbGJhY2tGdW5jdGlvbik7XG5cdCAgICAgIGpzb25wU2NyaXB0LmlkID0ganNvbnBDYWxsYmFjayArICdfJyArIGNhbGxiYWNrRnVuY3Rpb247XG5cdCAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5hcHBlbmRDaGlsZChqc29ucFNjcmlwdCk7XG5cdFxuXHQgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZWplY3QobmV3IEVycm9yKCdKU09OUCByZXF1ZXN0IHRvICcgKyB1cmwgKyAnIHRpbWVkIG91dCcpKTtcblx0XG5cdCAgICAgICAgY2xlYXJGdW5jdGlvbihjYWxsYmFja0Z1bmN0aW9uKTtcblx0ICAgICAgICByZW1vdmVTY3JpcHQoanNvbnBDYWxsYmFjayArICdfJyArIGNhbGxiYWNrRnVuY3Rpb24pO1xuXHQgICAgICB9LCB0aW1lb3V0KTtcblx0ICAgIH0pO1xuXHQgIH07XG5cdFxuXHQgIC8vIGV4cG9ydCBhcyBnbG9iYWwgZnVuY3Rpb25cblx0ICAvKlxuXHQgIGxldCBsb2NhbDtcblx0ICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgIGxvY2FsID0gZ2xvYmFsO1xuXHQgIH0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG5cdCAgICBsb2NhbCA9IHNlbGY7XG5cdCAgfSBlbHNlIHtcblx0ICAgIHRyeSB7XG5cdCAgICAgIGxvY2FsID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0ICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb2x5ZmlsbCBmYWlsZWQgYmVjYXVzZSBnbG9iYWwgb2JqZWN0IGlzIHVuYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKTtcblx0ICAgIH1cblx0ICB9XG5cdCAgXG5cdCAgbG9jYWwuZmV0Y2hKc29ucCA9IGZldGNoSnNvbnA7XG5cdCAgKi9cblx0XG5cdCAgbW9kdWxlLmV4cG9ydHMgPSBmZXRjaEpzb25wO1xuXHR9KTtcblxuLyoqKi8gfSxcbi8qIDIwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzWydkZWZhdWx0J10gPSBjb25maWdBbmltYXRpb247XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX3BlcmZvcm1hbmNlTm93ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0XG5cdHZhciBfcGVyZm9ybWFuY2VOb3cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGVyZm9ybWFuY2VOb3cpO1xuXHRcblx0dmFyIF9yYWYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMzKTtcblx0XG5cdHZhciBfcmFmMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JhZik7XG5cdFxuXHRmdW5jdGlvbiBjb25maWdBbmltYXRpb24oKSB7XG5cdCAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzBdO1xuXHQgIHZhciBfY29uZmlnJHRpbWVTdGVwID0gY29uZmlnLnRpbWVTdGVwO1xuXHQgIHZhciB0aW1lU3RlcCA9IF9jb25maWckdGltZVN0ZXAgPT09IHVuZGVmaW5lZCA/IDEgLyA2MCAqIDEwMDAgOiBfY29uZmlnJHRpbWVTdGVwO1xuXHQgIHZhciBfY29uZmlnJHRpbWVTY2FsZSA9IGNvbmZpZy50aW1lU2NhbGU7XG5cdCAgdmFyIHRpbWVTY2FsZSA9IF9jb25maWckdGltZVNjYWxlID09PSB1bmRlZmluZWQgPyAxIDogX2NvbmZpZyR0aW1lU2NhbGU7XG5cdCAgdmFyIF9jb25maWckbWF4U3RlcHMgPSBjb25maWcubWF4U3RlcHM7XG5cdCAgdmFyIG1heFN0ZXBzID0gX2NvbmZpZyRtYXhTdGVwcyA9PT0gdW5kZWZpbmVkID8gMTAgOiBfY29uZmlnJG1heFN0ZXBzO1xuXHQgIHZhciBfY29uZmlnJHJhZiA9IGNvbmZpZy5yYWY7XG5cdCAgdmFyIHJhZiA9IF9jb25maWckcmFmID09PSB1bmRlZmluZWQgPyBfcmFmMlsnZGVmYXVsdCddIDogX2NvbmZpZyRyYWY7XG5cdCAgdmFyIF9jb25maWckbm93ID0gY29uZmlnLm5vdztcblx0ICB2YXIgbm93ID0gX2NvbmZpZyRub3cgPT09IHVuZGVmaW5lZCA/IF9wZXJmb3JtYW5jZU5vdzJbJ2RlZmF1bHQnXSA6IF9jb25maWckbm93O1xuXHRcblx0ICB2YXIgYW5pbVJ1bm5pbmcgPSBbXTtcblx0ICB2YXIgcnVubmluZyA9IGZhbHNlO1xuXHQgIHZhciBwcmV2VGltZSA9IDA7XG5cdCAgdmFyIGFjY3VtdWxhdGVkVGltZSA9IDA7XG5cdFxuXHQgIGZ1bmN0aW9uIGxvb3AoKSB7XG5cdCAgICB2YXIgY3VycmVudFRpbWUgPSBub3coKTtcblx0ICAgIHZhciBmcmFtZVRpbWUgPSBjdXJyZW50VGltZSAtIHByZXZUaW1lOyAvLyBkZWx0YVxuXHRcblx0ICAgIHByZXZUaW1lID0gY3VycmVudFRpbWU7XG5cdCAgICBhY2N1bXVsYXRlZFRpbWUgKz0gZnJhbWVUaW1lICogdGltZVNjYWxlO1xuXHRcblx0ICAgIGlmIChhY2N1bXVsYXRlZFRpbWUgPiB0aW1lU3RlcCAqIG1heFN0ZXBzKSB7XG5cdCAgICAgIGFjY3VtdWxhdGVkVGltZSA9IDA7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIGZyYW1lTnVtYmVyID0gTWF0aC5jZWlsKGFjY3VtdWxhdGVkVGltZSAvIHRpbWVTdGVwKTtcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbVJ1bm5pbmcubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgdmFyIF9hbmltUnVubmluZyRpID0gYW5pbVJ1bm5pbmdbaV07XG5cdCAgICAgIHZhciBhY3RpdmUgPSBfYW5pbVJ1bm5pbmckaS5hY3RpdmU7XG5cdCAgICAgIHZhciBhbmltYXRpb25TdGVwID0gX2FuaW1SdW5uaW5nJGkuYW5pbWF0aW9uU3RlcDtcblx0ICAgICAgdmFyIHByZXZQcmV2U3RhdGUgPSBfYW5pbVJ1bm5pbmckaS5wcmV2U3RhdGU7XG5cdCAgICAgIHZhciBwcmV2TmV4dFN0YXRlID0gYW5pbVJ1bm5pbmdbaV0ubmV4dFN0YXRlO1xuXHRcblx0ICAgICAgaWYgKCFhY3RpdmUpIHtcblx0ICAgICAgICBjb250aW51ZTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gU2VlbXMgbGlrZSBiZWNhdXNlIHRoZSBUUyBzZXRzIGRlc3RWYWxzIGFzIGVudGVyVmFscyBmb3IgdGhlIGZpcnN0XG5cdCAgICAgIC8vIHRpY2ssIHdlIG1pZ2h0IHJlbmRlciB0aGF0IHZhbHVlIHR3aWNlLiBXZSByZW5kZXIgaXQgb25jZSwgY3VyclZhbHVlIGlzXG5cdCAgICAgIC8vIGVudGVyVmFsIGFuZCBkZXN0VmFsIGlzIGVudGVyVmFsLiBUaGUgbmV4dCB0aWNrIGlzIGZhc3RlciB0aGFuIDE2bXMsXG5cdCAgICAgIC8vIHNvIGFjY3VtdWxhdGVkVGltZSAod2hpY2ggd291bGQgYmUgYWJvdXQgLTE2bXMgZnJvbSB0aGUgcHJldmlvdXMgdGljaylcblx0ICAgICAgLy8gaXMgbmVnYXRpdmUgKC0xNm1zICsgYW55IG51bWJlciBsZXNzIHRoYW4gMTZtcyA8IDApLiBTbyB3ZSBqdXN0IHJlbmRlclxuXHQgICAgICAvLyBwYXJ0IHdheXMgdG93YXJkcyB0aGUgbmV4dFN0YXRlLCBidXQgdGhhdCdzIGVudGVyVmFsIHN0aWxsLiBXZSByZW5kZXJcblx0ICAgICAgLy8gc2F5IDc1JSBiZXR3ZWVuIGN1cnJWYWx1ZSAoPT09IGVudGVyVmFsKSBhbmQgZGVzdFZhbHVlICg9PT0gZW50ZXJWYWwpLlxuXHQgICAgICAvLyBTbyB3ZSByZW5kZXIgdGhlIHNhbWUgdmFsdWUgYSBzZWNvbmQgdGltZS5cblx0ICAgICAgLy8gVGhlIHNvbHV0aW9uIGJlbG93IGlzIHRvIHJlY2FsY3VsYXRlIHRoZSBkZXN0aW5hdGlvbiBzdGF0ZSBldmVuIHdoZW5cblx0ICAgICAgLy8geW91J3JlIG1vdmluZyBwYXJ0aWFsbHkgdG93YXJkcyBpdC5cblx0ICAgICAgaWYgKGFjY3VtdWxhdGVkVGltZSA8PSAwKSB7XG5cdCAgICAgICAgYW5pbVJ1bm5pbmdbaV0ubmV4dFN0YXRlID0gYW5pbWF0aW9uU3RlcCh0aW1lU3RlcCAvIDEwMDAsIHByZXZQcmV2U3RhdGUpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZnJhbWVOdW1iZXI7IGorKykge1xuXHQgICAgICAgICAgYW5pbVJ1bm5pbmdbaV0ubmV4dFN0YXRlID0gYW5pbWF0aW9uU3RlcCh0aW1lU3RlcCAvIDEwMDAsIHByZXZOZXh0U3RhdGUpO1xuXHQgICAgICAgICAgdmFyIF9yZWYgPSBbcHJldk5leHRTdGF0ZSwgYW5pbVJ1bm5pbmdbaV0ubmV4dFN0YXRlXTtcblx0ICAgICAgICAgIGFuaW1SdW5uaW5nW2ldLnByZXZTdGF0ZSA9IF9yZWZbMF07XG5cdCAgICAgICAgICBwcmV2TmV4dFN0YXRlID0gX3JlZlsxXTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICBhY2N1bXVsYXRlZFRpbWUgPSBhY2N1bXVsYXRlZFRpbWUgLSBmcmFtZU51bWJlciAqIHRpbWVTdGVwO1xuXHRcblx0ICAgIC8vIFJlbmRlciBhbmQgZmlsdGVyIGluIG9uZSBpdGVyYXRpb24uXG5cdCAgICB2YXIgYWxwaGEgPSAxICsgYWNjdW11bGF0ZWRUaW1lIC8gdGltZVN0ZXA7XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1SdW5uaW5nLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIHZhciBfYW5pbVJ1bm5pbmckaTIgPSBhbmltUnVubmluZ1tpXTtcblx0ICAgICAgdmFyIGFuaW1hdGlvblJlbmRlciA9IF9hbmltUnVubmluZyRpMi5hbmltYXRpb25SZW5kZXI7XG5cdCAgICAgIHZhciBuZXh0U3RhdGUgPSBfYW5pbVJ1bm5pbmckaTIubmV4dFN0YXRlO1xuXHQgICAgICB2YXIgcHJldlN0YXRlID0gX2FuaW1SdW5uaW5nJGkyLnByZXZTdGF0ZTtcblx0XG5cdCAgICAgIC8vIE1pZ2h0IG11dGF0ZSBhbmltUnVubmluZy4uLi4uLi4uXG5cdCAgICAgIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpO1xuXHQgICAgfVxuXHRcblx0ICAgIGFuaW1SdW5uaW5nID0gYW5pbVJ1bm5pbmcuZmlsdGVyKGZ1bmN0aW9uIChfcmVmMikge1xuXHQgICAgICB2YXIgYWN0aXZlID0gX3JlZjIuYWN0aXZlO1xuXHQgICAgICByZXR1cm4gYWN0aXZlO1xuXHQgICAgfSk7XG5cdFxuXHQgICAgaWYgKGFuaW1SdW5uaW5nLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICBydW5uaW5nID0gZmFsc2U7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByYWYobG9vcCk7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBzdGFydCgpIHtcblx0ICAgIGlmICghcnVubmluZykge1xuXHQgICAgICBydW5uaW5nID0gdHJ1ZTtcblx0ICAgICAgcHJldlRpbWUgPSBub3coKTtcblx0ICAgICAgYWNjdW11bGF0ZWRUaW1lID0gMDtcblx0ICAgICAgcmFmKGxvb3ApO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgcmV0dXJuIGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW9uKHN0YXRlLCBhbmltYXRpb25TdGVwLCBhbmltYXRpb25SZW5kZXIpIHtcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbVJ1bm5pbmcubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgdmFyIHZhbCA9IGFuaW1SdW5uaW5nW2ldO1xuXHQgICAgICBpZiAodmFsLmFuaW1hdGlvblN0ZXAgPT09IGFuaW1hdGlvblN0ZXApIHtcblx0ICAgICAgICB2YWwuYWN0aXZlID0gdHJ1ZTtcblx0ICAgICAgICB2YWwucHJldlN0YXRlID0gc3RhdGU7XG5cdCAgICAgICAgc3RhcnQoKTtcblx0ICAgICAgICByZXR1cm4gdmFsLnN0b3A7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICB2YXIgbmV3QW5pbSA9IHtcblx0ICAgICAgYW5pbWF0aW9uU3RlcDogYW5pbWF0aW9uU3RlcCxcblx0ICAgICAgYW5pbWF0aW9uUmVuZGVyOiBhbmltYXRpb25SZW5kZXIsXG5cdCAgICAgIHByZXZTdGF0ZTogc3RhdGUsXG5cdCAgICAgIG5leHRTdGF0ZTogc3RhdGUsXG5cdCAgICAgIGFjdGl2ZTogdHJ1ZVxuXHQgICAgfTtcblx0XG5cdCAgICBuZXdBbmltLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBuZXdBbmltLmFjdGl2ZSA9IGZhbHNlO1xuXHQgICAgfTtcblx0ICAgIGFuaW1SdW5uaW5nLnB1c2gobmV3QW5pbSk7XG5cdFxuXHQgICAgc3RhcnQoKTtcblx0XG5cdCAgICByZXR1cm4gbmV3QW5pbS5zdG9wO1xuXHQgIH07XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogMjEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdFxuXHR2YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gY29tcG9uZW50cztcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdHZhciBfbm9WZWxvY2l0eSA9IF9fd2VicGFja19yZXF1aXJlX18oMjUpO1xuXHRcblx0dmFyIF9ub1ZlbG9jaXR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX25vVmVsb2NpdHkpO1xuXHRcblx0dmFyIF9oYXNSZWFjaGVkU3R5bGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTtcblx0XG5cdHZhciBfaGFzUmVhY2hlZFN0eWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhc1JlYWNoZWRTdHlsZSk7XG5cdFxuXHR2YXIgX21lcmdlRGlmZiA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpO1xuXHRcblx0dmFyIF9tZXJnZURpZmYyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVyZ2VEaWZmKTtcblx0XG5cdHZhciBfYW5pbWF0aW9uTG9vcCA9IF9fd2VicGFja19yZXF1aXJlX18oMjApO1xuXHRcblx0dmFyIF9hbmltYXRpb25Mb29wMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FuaW1hdGlvbkxvb3ApO1xuXHRcblx0dmFyIF96ZXJvID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMik7XG5cdFxuXHR2YXIgX3plcm8yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfemVybyk7XG5cdFxuXHR2YXIgX3VwZGF0ZVRyZWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMxKTtcblx0XG5cdHZhciBfZGVwcmVjYXRlZFNwcmluZ3MyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMik7XG5cdFxuXHR2YXIgX2RlcHJlY2F0ZWRTcHJpbmdzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlcHJlY2F0ZWRTcHJpbmdzMik7XG5cdFxuXHR2YXIgX3N0cmlwU3R5bGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKTtcblx0XG5cdHZhciBfc3RyaXBTdHlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdHJpcFN0eWxlKTtcblx0XG5cdHZhciBzdGFydEFuaW1hdGlvbiA9IF9hbmltYXRpb25Mb29wMlsnZGVmYXVsdCddKCk7XG5cdFxuXHRmdW5jdGlvbiBtYXBPYmplY3QoZiwgb2JqKSB7XG5cdCAgdmFyIHJldCA9IHt9O1xuXHQgIGZvciAodmFyIGtleSBpbiBvYmopIHtcblx0ICAgIGlmICghb2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICByZXRba2V5XSA9IGYob2JqW2tleV0sIGtleSk7XG5cdCAgfVxuXHQgIHJldHVybiByZXQ7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGV2ZXJ5T2JqKGYsIG9iaikge1xuXHQgIGZvciAodmFyIGtleSBpbiBvYmopIHtcblx0ICAgIGlmICghb2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICBpZiAoIWYob2JqW2tleV0sIGtleSkpIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHQgIH1cblx0ICByZXR1cm4gdHJ1ZTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gY29tcG9uZW50cyhSZWFjdCkge1xuXHQgIHZhciBQcm9wVHlwZXMgPSBSZWFjdC5Qcm9wVHlwZXM7XG5cdFxuXHQgIHZhciBNb3Rpb24gPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgICBkaXNwbGF5TmFtZTogJ01vdGlvbicsXG5cdFxuXHQgICAgcHJvcFR5cGVzOiB7XG5cdCAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGEgY29uZmlnIGluIGhlcmVcblx0ICAgICAgZGVmYXVsdFZhbHVlOiBmdW5jdGlvbiBkZWZhdWx0VmFsdWUocHJvcCwgcHJvcE5hbWUpIHtcblx0ICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcblx0ICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1NwcmluZ1xcJ3MgYGRlZmF1bHRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgZGVmYXVsdFN0eWxlYC4gJyArICdJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpIGNoYW5nZXMgYXMgd2VsbC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGVuZFZhbHVlOiBmdW5jdGlvbiBlbmRWYWx1ZShwcm9wLCBwcm9wTmFtZSkge1xuXHQgICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignU3ByaW5nXFwncyBgZW5kVmFsdWVgIGhhcyBiZWVuIGNoYW5nZWQgdG8gYHN0eWxlYC4gSXRzIGZvcm1hdCAnICsgJ3JlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpIGNoYW5nZXMgYXMgd2VsbC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGRlZmF1bHRTdHlsZTogUHJvcFR5cGVzLm9iamVjdCxcblx0ICAgICAgc3R5bGU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcblx0ICAgICAgY2hpbGRyZW46IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWRcblx0ICAgIH0sXG5cdFxuXHQgICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG5cdCAgICAgIHZhciBfcHJvcHMgPSB0aGlzLnByb3BzO1xuXHQgICAgICB2YXIgZGVmYXVsdFN0eWxlID0gX3Byb3BzLmRlZmF1bHRTdHlsZTtcblx0ICAgICAgdmFyIHN0eWxlID0gX3Byb3BzLnN0eWxlO1xuXHRcblx0ICAgICAgdmFyIGN1cnJlbnRTdHlsZSA9IGRlZmF1bHRTdHlsZSB8fCBzdHlsZTtcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBjdXJyZW50U3R5bGU6IGN1cnJlbnRTdHlsZSxcblx0ICAgICAgICBjdXJyZW50VmVsb2NpdHk6IG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgY3VycmVudFN0eWxlKVxuXHQgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG5cdCAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcygpIHtcblx0ICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuXHQgICAgfSxcblx0XG5cdCAgICBhbmltYXRpb25TdGVwOiBmdW5jdGlvbiBhbmltYXRpb25TdGVwKHRpbWVzdGVwLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgY3VycmVudFN0eWxlID0gc3RhdGUuY3VycmVudFN0eWxlO1xuXHQgICAgICB2YXIgY3VycmVudFZlbG9jaXR5ID0gc3RhdGUuY3VycmVudFZlbG9jaXR5O1xuXHQgICAgICB2YXIgc3R5bGUgPSB0aGlzLnByb3BzLnN0eWxlO1xuXHRcblx0ICAgICAgdmFyIG5ld0N1cnJlbnRTdHlsZSA9IF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRTdHlsZSh0aW1lc3RlcCwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdHksIHN0eWxlKTtcblx0ICAgICAgdmFyIG5ld0N1cnJlbnRWZWxvY2l0eSA9IF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRWZWxvY2l0eSh0aW1lc3RlcCwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdHksIHN0eWxlKTtcblx0XG5cdCAgICAgIC8vIFRPT0Q6IHRoaXMgaXNuJ3QgbmVjZXNzYXJ5IGFueW1vcmUuIEl0IHdhcyB1c2VkIG9ubHkgYWdhaW5zdCBlbmRWYWx1ZSBmdW5jXG5cdCAgICAgIGlmIChfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXShjdXJyZW50VmVsb2NpdHksIG5ld0N1cnJlbnRTdHlsZSkgJiYgX25vVmVsb2NpdHkyWydkZWZhdWx0J10obmV3Q3VycmVudFZlbG9jaXR5LCBuZXdDdXJyZW50U3R5bGUpKSB7XG5cdCAgICAgICAgLy8gY2hlY2sgZXhwbGFuYXRpb24gaW4gYE1vdGlvbi5hbmltYXRpb25SZW5kZXJgXG5cdCAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7IC8vIE5hc3R5IHNpZGUgZWZmZWN0cy4uLi5cblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBjdXJyZW50U3R5bGU6IG5ld0N1cnJlbnRTdHlsZSxcblx0ICAgICAgICBjdXJyZW50VmVsb2NpdHk6IG5ld0N1cnJlbnRWZWxvY2l0eVxuXHQgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICBzdG9wQW5pbWF0aW9uOiBudWxsLFxuXHRcblx0ICAgIC8vIHVzZWQgaW4gYW5pbWF0aW9uUmVuZGVyXG5cdCAgICBoYXNVbm1vdW50ZWQ6IGZhbHNlLFxuXHRcblx0ICAgIGNvbXBvbmVudFdpbGxVbm1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcblx0ICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG5cdCAgICAgIHRoaXMuaGFzVW5tb3VudGVkID0gdHJ1ZTtcblx0ICAgIH0sXG5cdFxuXHQgICAgc3RhcnRBbmltYXRpbmc6IGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW5nKCkge1xuXHQgICAgICAvLyBJcyBzbWFydCBlbm91Z2ggdG8gbm90IHN0YXJ0IGl0IHR3aWNlXG5cdCAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbiA9IHN0YXJ0QW5pbWF0aW9uKHRoaXMuc3RhdGUsIHRoaXMuYW5pbWF0aW9uU3RlcCwgdGhpcy5hbmltYXRpb25SZW5kZXIpO1xuXHQgICAgfSxcblx0XG5cdCAgICBhbmltYXRpb25SZW5kZXI6IGZ1bmN0aW9uIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpIHtcblx0ICAgICAgLy8gYHRoaXMuaGFzVW5tb3VudGVkYCBtaWdodCBiZSB0cnVlIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uOlxuXHQgICAgICAvLyB1c2VyIGRvZXMgc29tZSBjaGVja3MgaW4gYHN0eWxlYCBhbmQgY2FsbHMgYW4gb3duZXIgaGFuZGxlclxuXHQgICAgICAvLyBvd25lciBzZXRzIHN0YXRlIGluIHRoZSBjYWxsYmFjaywgdHJpZ2dlcmluZyBhIHJlLXJlbmRlclxuXHQgICAgICAvLyB1bm1vdW50cyBNb3Rpb25cblx0ICAgICAgaWYgKCF0aGlzLmhhc1VubW91bnRlZCkge1xuXHQgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuXHQgICAgICAgICAgY3VycmVudFN0eWxlOiBfdXBkYXRlVHJlZS5pbnRlcnBvbGF0ZVZhbHVlKGFscGhhLCBuZXh0U3RhdGUuY3VycmVudFN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlKSxcblx0ICAgICAgICAgIGN1cnJlbnRWZWxvY2l0eTogbmV4dFN0YXRlLmN1cnJlbnRWZWxvY2l0eVxuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgICB2YXIgc3RyaXBwZWRTdHlsZSA9IF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddKHRoaXMuc3RhdGUuY3VycmVudFN0eWxlKTtcblx0ICAgICAgdmFyIHJlbmRlcmVkQ2hpbGRyZW4gPSB0aGlzLnByb3BzLmNoaWxkcmVuKHN0cmlwcGVkU3R5bGUpO1xuXHQgICAgICByZXR1cm4gcmVuZGVyZWRDaGlsZHJlbiAmJiBSZWFjdC5DaGlsZHJlbi5vbmx5KHJlbmRlcmVkQ2hpbGRyZW4pO1xuXHQgICAgfVxuXHQgIH0pO1xuXHRcblx0ICB2YXIgU3RhZ2dlcmVkTW90aW9uID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXHQgICAgZGlzcGxheU5hbWU6ICdTdGFnZ2VyZWRNb3Rpb24nLFxuXHRcblx0ICAgIHByb3BUeXBlczoge1xuXHQgICAgICBkZWZhdWx0U3R5bGU6IGZ1bmN0aW9uIGRlZmF1bHRTdHlsZShwcm9wLCBwcm9wTmFtZSkge1xuXHQgICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignWW91IGZvcmdvdCB0aGUgXCJzXCIgZm9yIGBTdGFnZ2VyZWRNb3Rpb25gXFwncyBgZGVmYXVsdFN0eWxlc2AuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBzdHlsZTogZnVuY3Rpb24gc3R5bGUocHJvcCwgcHJvcE5hbWUpIHtcblx0ICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcblx0ICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgU3RhZ2dlcmVkTW90aW9uYFxcJ3MgYHN0eWxlc2AuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvLyBUT09EOiB3YXJuIGFnYWluc3QgcHV0dGluZyBjb25maWdzIGluIGhlcmVcblx0ICAgICAgZGVmYXVsdFN0eWxlczogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLm9iamVjdCksXG5cdCAgICAgIHN0eWxlczogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcblx0ICAgICAgY2hpbGRyZW46IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWRcblx0ICAgIH0sXG5cdFxuXHQgICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG5cdCAgICAgIHZhciBfcHJvcHMyID0gdGhpcy5wcm9wcztcblx0ICAgICAgdmFyIHN0eWxlcyA9IF9wcm9wczIuc3R5bGVzO1xuXHQgICAgICB2YXIgZGVmYXVsdFN0eWxlcyA9IF9wcm9wczIuZGVmYXVsdFN0eWxlcztcblx0XG5cdCAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gZGVmYXVsdFN0eWxlcyA/IGRlZmF1bHRTdHlsZXMgOiBzdHlsZXMoKTtcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuXHQgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBjdXJyZW50U3R5bGVzLm1hcChmdW5jdGlvbiAocykge1xuXHQgICAgICAgICAgcmV0dXJuIG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgcyk7XG5cdCAgICAgICAgfSlcblx0ICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuXHQgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKSB7XG5cdCAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgYW5pbWF0aW9uU3RlcDogZnVuY3Rpb24gYW5pbWF0aW9uU3RlcCh0aW1lc3RlcCwgc3RhdGUpIHtcblx0ICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBzdGF0ZS5jdXJyZW50U3R5bGVzO1xuXHQgICAgICB2YXIgY3VycmVudFZlbG9jaXRpZXMgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdGllcztcblx0XG5cdCAgICAgIHZhciBzdHlsZXMgPSB0aGlzLnByb3BzLnN0eWxlcyhjdXJyZW50U3R5bGVzLm1hcChfc3RyaXBTdHlsZTJbJ2RlZmF1bHQnXSkpO1xuXHRcblx0ICAgICAgdmFyIG5ld0N1cnJlbnRTdHlsZXMgPSBjdXJyZW50U3R5bGVzLm1hcChmdW5jdGlvbiAoY3VycmVudFN0eWxlLCBpKSB7XG5cdCAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRTdHlsZSh0aW1lc3RlcCwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdGllc1tpXSwgc3R5bGVzW2ldKTtcblx0ICAgICAgfSk7XG5cdCAgICAgIHZhciBuZXdDdXJyZW50VmVsb2NpdGllcyA9IGN1cnJlbnRTdHlsZXMubWFwKGZ1bmN0aW9uIChjdXJyZW50U3R5bGUsIGkpIHtcblx0ICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFZlbG9jaXR5KHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0aWVzW2ldLCBzdHlsZXNbaV0pO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIC8vIFRPRE86IGlzIHRoaXMgcmlnaHQ/XG5cdCAgICAgIGlmIChjdXJyZW50VmVsb2NpdGllcy5ldmVyeShmdW5jdGlvbiAodiwgaykge1xuXHQgICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBjdXJyZW50U3R5bGVzW2tdKTtcblx0ICAgICAgfSkgJiYgbmV3Q3VycmVudFZlbG9jaXRpZXMuZXZlcnkoZnVuY3Rpb24gKHYsIGspIHtcblx0ICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgbmV3Q3VycmVudFN0eWxlc1trXSk7XG5cdCAgICAgIH0pKSB7XG5cdCAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgY3VycmVudFN0eWxlczogbmV3Q3VycmVudFN0eWxlcyxcblx0ICAgICAgICBjdXJyZW50VmVsb2NpdGllczogbmV3Q3VycmVudFZlbG9jaXRpZXNcblx0ICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgc3RvcEFuaW1hdGlvbjogbnVsbCxcblx0XG5cdCAgICAvLyB1c2VkIGluIGFuaW1hdGlvblJlbmRlclxuXHQgICAgaGFzVW5tb3VudGVkOiBmYWxzZSxcblx0XG5cdCAgICBjb21wb25lbnRXaWxsVW5tb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG5cdCAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuXHQgICAgICB0aGlzLmhhc1VubW91bnRlZCA9IHRydWU7XG5cdCAgICB9LFxuXHRcblx0ICAgIHN0YXJ0QW5pbWF0aW5nOiBmdW5jdGlvbiBzdGFydEFuaW1hdGluZygpIHtcblx0ICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uID0gc3RhcnRBbmltYXRpb24odGhpcy5zdGF0ZSwgdGhpcy5hbmltYXRpb25TdGVwLCB0aGlzLmFuaW1hdGlvblJlbmRlcik7XG5cdCAgICB9LFxuXHRcblx0ICAgIGFuaW1hdGlvblJlbmRlcjogZnVuY3Rpb24gYW5pbWF0aW9uUmVuZGVyKGFscGhhLCBuZXh0U3RhdGUsIHByZXZTdGF0ZSkge1xuXHQgICAgICAvLyBTZWUgY29tbWVudCBpbiBNb3Rpb24uXG5cdCAgICAgIGlmICghdGhpcy5oYXNVbm1vdW50ZWQpIHtcblx0ICAgICAgICB2YXIgY3VycmVudFN0eWxlcyA9IG5leHRTdGF0ZS5jdXJyZW50U3R5bGVzLm1hcChmdW5jdGlvbiAoc3R5bGUsIGkpIHtcblx0ICAgICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS5pbnRlcnBvbGF0ZVZhbHVlKGFscGhhLCBzdHlsZSwgcHJldlN0YXRlLmN1cnJlbnRTdHlsZXNbaV0pO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuXHQgICAgICAgICAgY3VycmVudFN0eWxlczogY3VycmVudFN0eWxlcyxcblx0ICAgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXh0U3RhdGUuY3VycmVudFZlbG9jaXRpZXNcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSB0aGlzLnN0YXRlLmN1cnJlbnRTdHlsZXMubWFwKF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddKTtcblx0ICAgICAgdmFyIHJlbmRlcmVkQ2hpbGRyZW4gPSB0aGlzLnByb3BzLmNoaWxkcmVuKHN0cmlwcGVkU3R5bGUpO1xuXHQgICAgICByZXR1cm4gcmVuZGVyZWRDaGlsZHJlbiAmJiBSZWFjdC5DaGlsZHJlbi5vbmx5KHJlbmRlcmVkQ2hpbGRyZW4pO1xuXHQgICAgfVxuXHQgIH0pO1xuXHRcblx0ICB2YXIgVHJhbnNpdGlvbk1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0ICAgIGRpc3BsYXlOYW1lOiAnVHJhbnNpdGlvbk1vdGlvbicsXG5cdFxuXHQgICAgcHJvcFR5cGVzOiB7XG5cdCAgICAgIGRlZmF1bHRWYWx1ZTogZnVuY3Rpb24gZGVmYXVsdFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG5cdCAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdUcmFuc2l0aW9uU3ByaW5nXFwncyBgZGVmYXVsdFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvICcgKyAnYGRlZmF1bHRTdHlsZXNgLiBJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpICcgKyAnY2hhbmdlcyBhcyB3ZWxsLicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZW5kVmFsdWU6IGZ1bmN0aW9uIGVuZFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG5cdCAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdUcmFuc2l0aW9uU3ByaW5nXFwncyBgZW5kVmFsdWVgIGhhcyBiZWVuIGNoYW5nZWQgdG8gYHN0eWxlc2AuICcgKyAnSXRzIGZvcm1hdCByZWNlaXZlZCBhIGZldyAoZWFzeSB0byB1cGRhdGUhKSBjaGFuZ2VzIGFzIHdlbGwuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBkZWZhdWx0U3R5bGU6IGZ1bmN0aW9uIGRlZmF1bHRTdHlsZShwcm9wLCBwcm9wTmFtZSkge1xuXHQgICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignWW91IGZvcmdvdCB0aGUgXCJzXCIgZm9yIGBUcmFuc2l0aW9uTW90aW9uYFxcJ3MgYGRlZmF1bHRTdHlsZXNgLicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgc3R5bGU6IGZ1bmN0aW9uIHN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG5cdCAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdZb3UgZm9yZ290IHRoZSBcInNcIiBmb3IgYFRyYW5zaXRpb25Nb3Rpb25gXFwncyBgc3R5bGVzYC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGNvbmZpZ3MgaW4gaGVyZVxuXHQgICAgICBkZWZhdWx0U3R5bGVzOiBQcm9wVHlwZXMub2JqZWN0T2YoUHJvcFR5cGVzLmFueSksXG5cdCAgICAgIHN0eWxlczogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmZ1bmMsIFByb3BUeXBlcy5vYmplY3RPZihQcm9wVHlwZXMuYW55LmlzUmVxdWlyZWQpXSkuaXNSZXF1aXJlZCxcblx0ICAgICAgd2lsbExlYXZlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuY10pLFxuXHQgICAgICAvLyBUT09EOiB3YXJuIGFnYWluc3QgcHV0dGluZyBjb25maWdzIGluIGhlcmVcblx0ICAgICAgd2lsbEVudGVyOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuY10pLFxuXHQgICAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxuXHQgICAgfSxcblx0XG5cdCAgICBnZXREZWZhdWx0UHJvcHM6IGZ1bmN0aW9uIGdldERlZmF1bHRQcm9wcygpIHtcblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICB3aWxsRW50ZXI6IGZ1bmN0aW9uIHdpbGxFbnRlcihrZXksIHZhbHVlKSB7XG5cdCAgICAgICAgICByZXR1cm4gdmFsdWU7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICB3aWxsTGVhdmU6IGZ1bmN0aW9uIHdpbGxMZWF2ZSgpIHtcblx0ICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG5cdCAgICAgIHZhciBfcHJvcHMzID0gdGhpcy5wcm9wcztcblx0ICAgICAgdmFyIHN0eWxlcyA9IF9wcm9wczMuc3R5bGVzO1xuXHQgICAgICB2YXIgZGVmYXVsdFN0eWxlcyA9IF9wcm9wczMuZGVmYXVsdFN0eWxlcztcblx0XG5cdCAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gdW5kZWZpbmVkO1xuXHQgICAgICBpZiAoZGVmYXVsdFN0eWxlcyA9PSBudWxsKSB7XG5cdCAgICAgICAgaWYgKHR5cGVvZiBzdHlsZXMgPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICAgIGN1cnJlbnRTdHlsZXMgPSBzdHlsZXMoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgY3VycmVudFN0eWxlcyA9IHN0eWxlcztcblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgY3VycmVudFN0eWxlcyA9IGRlZmF1bHRTdHlsZXM7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuXHQgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBtYXBPYmplY3QoZnVuY3Rpb24gKHMpIHtcblx0ICAgICAgICAgIHJldHVybiBtYXBPYmplY3QoX3plcm8yWydkZWZhdWx0J10sIHMpO1xuXHQgICAgICAgIH0sIGN1cnJlbnRTdHlsZXMpXG5cdCAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcblx0ICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuXHQgICAgfSxcblx0XG5cdCAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKCkge1xuXHQgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIGFuaW1hdGlvblN0ZXA6IGZ1bmN0aW9uIGFuaW1hdGlvblN0ZXAodGltZXN0ZXAsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gc3RhdGUuY3VycmVudFN0eWxlcztcblx0ICAgICAgdmFyIGN1cnJlbnRWZWxvY2l0aWVzID0gc3RhdGUuY3VycmVudFZlbG9jaXRpZXM7XG5cdCAgICAgIHZhciBfcHJvcHM0ID0gdGhpcy5wcm9wcztcblx0ICAgICAgdmFyIHN0eWxlcyA9IF9wcm9wczQuc3R5bGVzO1xuXHQgICAgICB2YXIgd2lsbEVudGVyID0gX3Byb3BzNC53aWxsRW50ZXI7XG5cdCAgICAgIHZhciB3aWxsTGVhdmUgPSBfcHJvcHM0LndpbGxMZWF2ZTtcblx0XG5cdCAgICAgIGlmICh0eXBlb2Ygc3R5bGVzID09PSAnZnVuY3Rpb24nKSB7XG5cdCAgICAgICAgc3R5bGVzID0gc3R5bGVzKGN1cnJlbnRTdHlsZXMpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBUT0RPOiBodWg/XG5cdCAgICAgIHZhciBtZXJnZWRTdHlsZXMgPSBzdHlsZXM7IC8vIHNldCBtZXJnZWRTdHlsZXMgdG8gc3R5bGVzIGFzIHRoZSBkZWZhdWx0XG5cdCAgICAgIHZhciBoYXNOZXdLZXkgPSBmYWxzZTtcblx0XG5cdCAgICAgIG1lcmdlZFN0eWxlcyA9IF9tZXJnZURpZmYyWydkZWZhdWx0J10oY3VycmVudFN0eWxlcywgc3R5bGVzLFxuXHQgICAgICAvLyBUT0RPOiBzdG9wIGFsbG9jYXRpbmcgbGlrZSBjcmF6eSBpbiB0aGlzIHdob2xlIGNvZGUgcGF0aFxuXHQgICAgICBmdW5jdGlvbiAoa2V5KSB7XG5cdCAgICAgICAgdmFyIHJlcyA9IHdpbGxMZWF2ZShrZXksIGN1cnJlbnRTdHlsZXNba2V5XSwgc3R5bGVzLCBjdXJyZW50U3R5bGVzLCBjdXJyZW50VmVsb2NpdGllcyk7XG5cdCAgICAgICAgaWYgKHJlcyA9PSBudWxsKSB7XG5cdCAgICAgICAgICAvLyBGb3IgbGVnYWN5IHJlYXNvbi4gV2Ugd29uJ3QgYWxsb3cgcmV0dXJuaW5nIG51bGwgc29vblxuXHQgICAgICAgICAgLy8gVE9ETzogcmVtb3ZlLCBhZnRlciBuZXh0IHJlbGVhc2Vcblx0ICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKGN1cnJlbnRWZWxvY2l0aWVzW2tleV0sIGN1cnJlbnRTdHlsZXNba2V5XSkgJiYgX2hhc1JlYWNoZWRTdHlsZTJbJ2RlZmF1bHQnXShjdXJyZW50U3R5bGVzW2tleV0sIHJlcykpIHtcblx0ICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gcmVzO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIE9iamVjdC5rZXlzKG1lcmdlZFN0eWxlcykuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHtcblx0ICAgICAgICByZXR1cm4gIWN1cnJlbnRTdHlsZXMuaGFzT3duUHJvcGVydHkoa2V5KTtcblx0ICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG5cdCAgICAgICAgdmFyIF9leHRlbmRzMiwgX2V4dGVuZHMzO1xuXHRcblx0ICAgICAgICBoYXNOZXdLZXkgPSB0cnVlO1xuXHQgICAgICAgIHZhciBlbnRlclN0eWxlID0gd2lsbEVudGVyKGtleSwgbWVyZ2VkU3R5bGVzW2tleV0sIHN0eWxlcywgY3VycmVudFN0eWxlcywgY3VycmVudFZlbG9jaXRpZXMpO1xuXHRcblx0ICAgICAgICAvLyBXZSBjYW4gbXV0YXRlIHRoaXMgaGVyZSBiZWNhdXNlIG1lcmdlRGlmZiByZXR1cm5zIGEgbmV3IE9ialxuXHQgICAgICAgIG1lcmdlZFN0eWxlc1trZXldID0gZW50ZXJTdHlsZTtcblx0XG5cdCAgICAgICAgY3VycmVudFN0eWxlcyA9IF9leHRlbmRzKHt9LCBjdXJyZW50U3R5bGVzLCAoX2V4dGVuZHMyID0ge30sIF9leHRlbmRzMltrZXldID0gZW50ZXJTdHlsZSwgX2V4dGVuZHMyKSk7XG5cdCAgICAgICAgY3VycmVudFZlbG9jaXRpZXMgPSBfZXh0ZW5kcyh7fSwgY3VycmVudFZlbG9jaXRpZXMsIChfZXh0ZW5kczMgPSB7fSwgX2V4dGVuZHMzW2tleV0gPSBtYXBPYmplY3QoX3plcm8yWydkZWZhdWx0J10sIGVudGVyU3R5bGUpLCBfZXh0ZW5kczMpKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICB2YXIgbmV3Q3VycmVudFN0eWxlcyA9IG1hcE9iamVjdChmdW5jdGlvbiAobWVyZ2VkU3R5bGUsIGtleSkge1xuXHQgICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50U3R5bGUodGltZXN0ZXAsIGN1cnJlbnRTdHlsZXNba2V5XSwgY3VycmVudFZlbG9jaXRpZXNba2V5XSwgbWVyZ2VkU3R5bGUpO1xuXHQgICAgICB9LCBtZXJnZWRTdHlsZXMpO1xuXHQgICAgICB2YXIgbmV3Q3VycmVudFZlbG9jaXRpZXMgPSBtYXBPYmplY3QoZnVuY3Rpb24gKG1lcmdlZFN0eWxlLCBrZXkpIHtcblx0ICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFZlbG9jaXR5KHRpbWVzdGVwLCBjdXJyZW50U3R5bGVzW2tleV0sIGN1cnJlbnRWZWxvY2l0aWVzW2tleV0sIG1lcmdlZFN0eWxlKTtcblx0ICAgICAgfSwgbWVyZ2VkU3R5bGVzKTtcblx0XG5cdCAgICAgIGlmICghaGFzTmV3S2V5ICYmIGV2ZXJ5T2JqKGZ1bmN0aW9uICh2LCBrKSB7XG5cdCAgICAgICAgcmV0dXJuIF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKHYsIGN1cnJlbnRTdHlsZXNba10pO1xuXHQgICAgICB9LCBjdXJyZW50VmVsb2NpdGllcykgJiYgZXZlcnlPYmooZnVuY3Rpb24gKHYsIGspIHtcblx0ICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgbmV3Q3VycmVudFN0eWxlc1trXSk7XG5cdCAgICAgIH0sIG5ld0N1cnJlbnRWZWxvY2l0aWVzKSkge1xuXHQgICAgICAgIC8vIGNoZWNrIGV4cGxhbmF0aW9uIGluIGBNb3Rpb24uYW5pbWF0aW9uUmVuZGVyYFxuXHQgICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpOyAvLyBOYXN0eSBzaWRlIGVmZmVjdHMuLi4uXG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgY3VycmVudFN0eWxlczogbmV3Q3VycmVudFN0eWxlcyxcblx0ICAgICAgICBjdXJyZW50VmVsb2NpdGllczogbmV3Q3VycmVudFZlbG9jaXRpZXNcblx0ICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgc3RvcEFuaW1hdGlvbjogbnVsbCxcblx0XG5cdCAgICAvLyB1c2VkIGluIGFuaW1hdGlvblJlbmRlclxuXHQgICAgaGFzVW5tb3VudGVkOiBmYWxzZSxcblx0XG5cdCAgICBjb21wb25lbnRXaWxsVW5tb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG5cdCAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuXHQgICAgICB0aGlzLmhhc1VubW91bnRlZCA9IHRydWU7XG5cdCAgICB9LFxuXHRcblx0ICAgIHN0YXJ0QW5pbWF0aW5nOiBmdW5jdGlvbiBzdGFydEFuaW1hdGluZygpIHtcblx0ICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uID0gc3RhcnRBbmltYXRpb24odGhpcy5zdGF0ZSwgdGhpcy5hbmltYXRpb25TdGVwLCB0aGlzLmFuaW1hdGlvblJlbmRlcik7XG5cdCAgICB9LFxuXHRcblx0ICAgIGFuaW1hdGlvblJlbmRlcjogZnVuY3Rpb24gYW5pbWF0aW9uUmVuZGVyKGFscGhhLCBuZXh0U3RhdGUsIHByZXZTdGF0ZSkge1xuXHQgICAgICAvLyBTZWUgY29tbWVudCBpbiBNb3Rpb24uXG5cdCAgICAgIGlmICghdGhpcy5oYXNVbm1vdW50ZWQpIHtcblx0ICAgICAgICB2YXIgY3VycmVudFN0eWxlcyA9IG1hcE9iamVjdChmdW5jdGlvbiAoc3R5bGUsIGtleSkge1xuXHQgICAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLmludGVycG9sYXRlVmFsdWUoYWxwaGEsIHN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlc1trZXldKTtcblx0ICAgICAgICB9LCBuZXh0U3RhdGUuY3VycmVudFN0eWxlcyk7XG5cdCAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG5cdCAgICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuXHQgICAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5leHRTdGF0ZS5jdXJyZW50VmVsb2NpdGllc1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgICB2YXIgc3RyaXBwZWRTdHlsZSA9IG1hcE9iamVjdChfc3RyaXBTdHlsZTJbJ2RlZmF1bHQnXSwgdGhpcy5zdGF0ZS5jdXJyZW50U3R5bGVzKTtcblx0ICAgICAgdmFyIHJlbmRlcmVkQ2hpbGRyZW4gPSB0aGlzLnByb3BzLmNoaWxkcmVuKHN0cmlwcGVkU3R5bGUpO1xuXHQgICAgICByZXR1cm4gcmVuZGVyZWRDaGlsZHJlbiAmJiBSZWFjdC5DaGlsZHJlbi5vbmx5KHJlbmRlcmVkQ2hpbGRyZW4pO1xuXHQgICAgfVxuXHQgIH0pO1xuXHRcblx0ICB2YXIgX2RlcHJlY2F0ZWRTcHJpbmdzID0gX2RlcHJlY2F0ZWRTcHJpbmdzM1snZGVmYXVsdCddKFJlYWN0KTtcblx0XG5cdCAgdmFyIFNwcmluZyA9IF9kZXByZWNhdGVkU3ByaW5ncy5TcHJpbmc7XG5cdCAgdmFyIFRyYW5zaXRpb25TcHJpbmcgPSBfZGVwcmVjYXRlZFNwcmluZ3MuVHJhbnNpdGlvblNwcmluZztcblx0XG5cdCAgcmV0dXJuIHsgU3ByaW5nOiBTcHJpbmcsIFRyYW5zaXRpb25TcHJpbmc6IFRyYW5zaXRpb25TcHJpbmcsIE1vdGlvbjogTW90aW9uLCBTdGFnZ2VyZWRNb3Rpb246IFN0YWdnZXJlZE1vdGlvbiwgVHJhbnNpdGlvbk1vdGlvbjogVHJhbnNpdGlvbk1vdGlvbiB9O1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDIyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzWydkZWZhdWx0J10gPSBkZXByZWNhdGVkU3ByaW5ncztcblx0dmFyIGhhc1dhcm5lZEZvclNwcmluZyA9IHt9O1xuXHR2YXIgaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZyA9IHt9O1xuXHRcblx0ZnVuY3Rpb24gZGVwcmVjYXRlZFNwcmluZ3MoUmVhY3QpIHtcblx0ICB2YXIgU3ByaW5nID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXHQgICAgZGlzcGxheU5hbWU6ICdTcHJpbmcnLFxuXHRcblx0ICAgIGNvbXBvbmVudFdpbGxNb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50KCkge1xuXHQgICAgICBpZiAoZmFsc2UpIHtcblx0ICAgICAgICB2YXIgb3duZXJOYW1lID0gdGhpcy5fcmVhY3RJbnRlcm5hbEluc3RhbmNlLl9jdXJyZW50RWxlbWVudC5fb3duZXIgJiYgdGhpcy5fcmVhY3RJbnRlcm5hbEluc3RhbmNlLl9jdXJyZW50RWxlbWVudC5fb3duZXIuZ2V0TmFtZSgpO1xuXHQgICAgICAgIGlmICghaGFzV2FybmVkRm9yU3ByaW5nW293bmVyTmFtZV0pIHtcblx0ICAgICAgICAgIGhhc1dhcm5lZEZvclNwcmluZ1tvd25lck5hbWVdID0gdHJ1ZTtcblx0ICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NwcmluZyAodXNlZCBpbiAlc3JlbmRlcikgaGFzIG5vdyBiZWVuIHJlbmFtZWQgdG8gTW90aW9uLiAnICsgJ1BsZWFzZSBzZWUgdGhlIHJlbGVhc2Ugbm90ZSBmb3IgdGhlIHVwZ3JhZGUgcGF0aC4gVGhhbmsgeW91IScsIG93bmVyTmFtZSA/IG93bmVyTmFtZSArICdcXCdzICcgOiAnUmVhY3QuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgICByZXR1cm4gbnVsbDtcblx0ICAgIH1cblx0ICB9KTtcblx0XG5cdCAgdmFyIFRyYW5zaXRpb25TcHJpbmcgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgICBkaXNwbGF5TmFtZTogJ1RyYW5zaXRpb25TcHJpbmcnLFxuXHRcblx0ICAgIGNvbXBvbmVudFdpbGxNb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50KCkge1xuXHQgICAgICBpZiAoZmFsc2UpIHtcblx0ICAgICAgICB2YXIgb3duZXJOYW1lID0gdGhpcy5fcmVhY3RJbnRlcm5hbEluc3RhbmNlLl9jdXJyZW50RWxlbWVudC5fb3duZXIgJiYgdGhpcy5fcmVhY3RJbnRlcm5hbEluc3RhbmNlLl9jdXJyZW50RWxlbWVudC5fb3duZXIuZ2V0TmFtZSgpO1xuXHQgICAgICAgIGlmICghaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZ1tvd25lck5hbWVdKSB7XG5cdCAgICAgICAgICBoYXNXYXJuZWRGb3JUcmFuc2l0aW9uU3ByaW5nW293bmVyTmFtZV0gPSB0cnVlO1xuXHQgICAgICAgICAgY29uc29sZS5lcnJvcignVHJhbnNpdGlvblNwcmluZyAodXNlZCBpbiAlc3JlbmRlcikgaGFzIG5vdyBiZWVuIHJlbmFtZWQgdG8gJyArICdUcmFuc2l0aW9uTW90aW9uLiBQbGVhc2Ugc2VlIHRoZSByZWxlYXNlIG5vdGUgZm9yIHRoZSB1cGdyYWRlICcgKyAncGF0aC4gVGhhbmsgeW91IScsIG93bmVyTmFtZSA/IG93bmVyTmFtZSArICdcXCdzICcgOiAnUmVhY3QuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9LFxuXHRcblx0ICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgICByZXR1cm4gbnVsbDtcblx0ICAgIH1cblx0ICB9KTtcblx0XG5cdCAgcmV0dXJuIHsgU3ByaW5nOiBTcHJpbmcsIFRyYW5zaXRpb25TcHJpbmc6IFRyYW5zaXRpb25TcHJpbmcgfTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAyMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IGhhc1JlYWNoZWRTdHlsZTtcblx0XG5cdGZ1bmN0aW9uIGhhc1JlYWNoZWRTdHlsZShjdXJyZW50U3R5bGUsIHN0eWxlKSB7XG5cdCAgZm9yICh2YXIga2V5IGluIHN0eWxlKSB7XG5cdCAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICB2YXIgY3VycmVudFZhbHVlID0gY3VycmVudFN0eWxlW2tleV07XG5cdCAgICB2YXIgZGVzdFZhbHVlID0gc3R5bGVba2V5XTtcblx0ICAgIGlmICghZGVzdFZhbHVlLmNvbmZpZykge1xuXHQgICAgICAvLyBub3QgYSBzcHJpbmcgY29uZmlnXG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgaWYgKGN1cnJlbnRWYWx1ZS5jb25maWcgJiYgY3VycmVudFZhbHVlLnZhbCAhPT0gZGVzdFZhbHVlLnZhbCkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdCAgICBpZiAoIWN1cnJlbnRWYWx1ZS5jb25maWcgJiYgY3VycmVudFZhbHVlICE9PSBkZXN0VmFsdWUudmFsKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIHJldHVybiB0cnVlO1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogMjQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIHRoaXMgZnVuY3Rpb24gaXMgYWxsb2NhdGlvbi1sZXNzIHRoYW5rcyB0byBiYWJlbCwgd2hpY2ggdHJhbnNmb3JtcyB0aGUgdGFpbFxuXHQvLyBjYWxscyBpbnRvIGxvb3BzXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBtZXJnZURpZmY7XG5cdGZ1bmN0aW9uIG1lcmdlRGlmZkFycihfeCwgX3gyLCBfeDMsIF94NCwgX3g1LCBfeDYsIF94Nykge1xuXHQgIHZhciBfYWdhaW4gPSB0cnVlO1xuXHRcblx0ICBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHtcblx0ICAgIHZhciBhcnJBID0gX3gsXG5cdCAgICAgICAgYXJyQiA9IF94Mixcblx0ICAgICAgICBjb2xsQiA9IF94Myxcblx0ICAgICAgICBpbmRleEEgPSBfeDQsXG5cdCAgICAgICAgaW5kZXhCID0gX3g1LFxuXHQgICAgICAgIG9uUmVtb3ZlID0gX3g2LFxuXHQgICAgICAgIGFjY3VtID0gX3g3O1xuXHQgICAgZW5kQSA9IGVuZEIgPSBrZXlBID0ga2V5QiA9IGZpbGwgPSBmaWxsID0gdW5kZWZpbmVkO1xuXHQgICAgX2FnYWluID0gZmFsc2U7XG5cdFxuXHQgICAgdmFyIGVuZEEgPSBpbmRleEEgPT09IGFyckEubGVuZ3RoO1xuXHQgICAgdmFyIGVuZEIgPSBpbmRleEIgPT09IGFyckIubGVuZ3RoO1xuXHQgICAgdmFyIGtleUEgPSBhcnJBW2luZGV4QV07XG5cdCAgICB2YXIga2V5QiA9IGFyckJbaW5kZXhCXTtcblx0ICAgIGlmIChlbmRBICYmIGVuZEIpIHtcblx0ICAgICAgLy8gcmV0dXJuaW5nIG51bGwgaGVyZSwgb3RoZXJ3aXNlIGxpbnQgY29tcGxhaW5zIHRoYXQgd2UncmUgbm90IGV4cGVjdGluZ1xuXHQgICAgICAvLyBhIHJldHVybiB2YWx1ZSBpbiBzdWJzZXF1ZW50IGNhbGxzLiBXZSBrbm93IHdoYXQgd2UncmUgZG9pbmcuXG5cdCAgICAgIHJldHVybiBudWxsO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChlbmRBKSB7XG5cdCAgICAgIGFjY3VtW2tleUJdID0gY29sbEJba2V5Ql07XG5cdCAgICAgIF94ID0gYXJyQTtcblx0ICAgICAgX3gyID0gYXJyQjtcblx0ICAgICAgX3gzID0gY29sbEI7XG5cdCAgICAgIF94NCA9IGluZGV4QTtcblx0ICAgICAgX3g1ID0gaW5kZXhCICsgMTtcblx0ICAgICAgX3g2ID0gb25SZW1vdmU7XG5cdCAgICAgIF94NyA9IGFjY3VtO1xuXHQgICAgICBfYWdhaW4gPSB0cnVlO1xuXHQgICAgICBjb250aW51ZSBfZnVuY3Rpb247XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKGVuZEIpIHtcblx0ICAgICAgdmFyIGZpbGwgPSBvblJlbW92ZShrZXlBKTtcblx0ICAgICAgaWYgKGZpbGwgIT0gbnVsbCkge1xuXHQgICAgICAgIGFjY3VtW2tleUFdID0gZmlsbDtcblx0ICAgICAgfVxuXHQgICAgICBfeCA9IGFyckE7XG5cdCAgICAgIF94MiA9IGFyckI7XG5cdCAgICAgIF94MyA9IGNvbGxCO1xuXHQgICAgICBfeDQgPSBpbmRleEEgKyAxO1xuXHQgICAgICBfeDUgPSBpbmRleEI7XG5cdCAgICAgIF94NiA9IG9uUmVtb3ZlO1xuXHQgICAgICBfeDcgPSBhY2N1bTtcblx0ICAgICAgX2FnYWluID0gdHJ1ZTtcblx0ICAgICAgY29udGludWUgX2Z1bmN0aW9uO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChrZXlBID09PSBrZXlCKSB7XG5cdCAgICAgIGFjY3VtW2tleUFdID0gY29sbEJba2V5QV07XG5cdCAgICAgIF94ID0gYXJyQTtcblx0ICAgICAgX3gyID0gYXJyQjtcblx0ICAgICAgX3gzID0gY29sbEI7XG5cdCAgICAgIF94NCA9IGluZGV4QSArIDE7XG5cdCAgICAgIF94NSA9IGluZGV4QiArIDE7XG5cdCAgICAgIF94NiA9IG9uUmVtb3ZlO1xuXHQgICAgICBfeDcgPSBhY2N1bTtcblx0ICAgICAgX2FnYWluID0gdHJ1ZTtcblx0ICAgICAgY29udGludWUgX2Z1bmN0aW9uO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmICghY29sbEIuaGFzT3duUHJvcGVydHkoa2V5QSkpIHtcblx0ICAgICAgdmFyIGZpbGwgPSBvblJlbW92ZShrZXlBKTtcblx0ICAgICAgaWYgKGZpbGwgIT0gbnVsbCkge1xuXHQgICAgICAgIGFjY3VtW2tleUFdID0gZmlsbDtcblx0ICAgICAgfVxuXHQgICAgICBfeCA9IGFyckE7XG5cdCAgICAgIF94MiA9IGFyckI7XG5cdCAgICAgIF94MyA9IGNvbGxCO1xuXHQgICAgICBfeDQgPSBpbmRleEEgKyAxO1xuXHQgICAgICBfeDUgPSBpbmRleEI7XG5cdCAgICAgIF94NiA9IG9uUmVtb3ZlO1xuXHQgICAgICBfeDcgPSBhY2N1bTtcblx0ICAgICAgX2FnYWluID0gdHJ1ZTtcblx0ICAgICAgY29udGludWUgX2Z1bmN0aW9uO1xuXHQgICAgfVxuXHRcblx0ICAgIF94ID0gYXJyQTtcblx0ICAgIF94MiA9IGFyckI7XG5cdCAgICBfeDMgPSBjb2xsQjtcblx0ICAgIF94NCA9IGluZGV4QSArIDE7XG5cdCAgICBfeDUgPSBpbmRleEI7XG5cdCAgICBfeDYgPSBvblJlbW92ZTtcblx0ICAgIF94NyA9IGFjY3VtO1xuXHQgICAgX2FnYWluID0gdHJ1ZTtcblx0ICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcblx0ICB9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIG1lcmdlRGlmZihhLCBiLCBvblJlbW92ZSkge1xuXHQgIHZhciByZXQgPSB7fTtcblx0ICAvLyBpZiBhbnlvbmUgY2FuIG1ha2UgdGhpcyB3b3JrIHdpdGhvdXQgYWxsb2NhdGluZyB0aGUgYXJyYXlzIGhlcmUsIHdlJ2xsXG5cdCAgLy8gZ2l2ZSB5b3UgYSBtZWRhbFxuXHQgIG1lcmdlRGlmZkFycihPYmplY3Qua2V5cyhhKSwgT2JqZWN0LmtleXMoYiksIGIsIDAsIDAsIG9uUmVtb3ZlLCByZXQpO1xuXHQgIHJldHVybiByZXQ7XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiAyNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0Ly8gY3VycmVudFN0eWxlIGtlZXBzIHRoZSBpbmZvIGFib3V0IHdoZXRoZXIgYSBwcm9wIGlzIGNvbmZpZ3VyZWQgYXMgYSBzcHJpbmdcblx0Ly8gb3IgaWYgaXQncyBqdXN0IGEgcmFuZG9tIHByb3AgdGhhdCBoYXBwZW5zIHRvIGJlIHByZXNlbnQgb24gdGhlIHN0eWxlXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBub1ZlbG9jaXR5O1xuXHRcblx0ZnVuY3Rpb24gbm9WZWxvY2l0eShjdXJyZW50VmVsb2NpdHksIGN1cnJlbnRTdHlsZSkge1xuXHQgIGZvciAodmFyIGtleSBpbiBjdXJyZW50VmVsb2NpdHkpIHtcblx0ICAgIGlmICghY3VycmVudFZlbG9jaXR5Lmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICBpZiAoY3VycmVudFN0eWxlW2tleV0uY29uZmlnICYmIGN1cnJlbnRWZWxvY2l0eVtrZXldICE9PSAwKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0ICB9XG5cdCAgcmV0dXJuIHRydWU7XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiAyNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgX2NvbXBvbmVudHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMSk7XG5cdFxuXHR2YXIgX2NvbXBvbmVudHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcG9uZW50czIpO1xuXHRcblx0dmFyIF9yZW9yZGVyS2V5cyA9IF9fd2VicGFja19yZXF1aXJlX18oMjcpO1xuXHRcblx0dmFyIF9yZW9yZGVyS2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW9yZGVyS2V5cyk7XG5cdFxuXHR2YXIgX2NvbXBvbmVudHMgPSBfY29tcG9uZW50czNbJ2RlZmF1bHQnXShfcmVhY3QyWydkZWZhdWx0J10pO1xuXHRcblx0dmFyIFNwcmluZyA9IF9jb21wb25lbnRzLlNwcmluZztcblx0dmFyIFRyYW5zaXRpb25TcHJpbmcgPSBfY29tcG9uZW50cy5UcmFuc2l0aW9uU3ByaW5nO1xuXHR2YXIgTW90aW9uID0gX2NvbXBvbmVudHMuTW90aW9uO1xuXHR2YXIgU3RhZ2dlcmVkTW90aW9uID0gX2NvbXBvbmVudHMuU3RhZ2dlcmVkTW90aW9uO1xuXHR2YXIgVHJhbnNpdGlvbk1vdGlvbiA9IF9jb21wb25lbnRzLlRyYW5zaXRpb25Nb3Rpb247XG5cdGV4cG9ydHMuU3ByaW5nID0gU3ByaW5nO1xuXHRleHBvcnRzLlRyYW5zaXRpb25TcHJpbmcgPSBUcmFuc2l0aW9uU3ByaW5nO1xuXHRleHBvcnRzLk1vdGlvbiA9IE1vdGlvbjtcblx0ZXhwb3J0cy5TdGFnZ2VyZWRNb3Rpb24gPSBTdGFnZ2VyZWRNb3Rpb247XG5cdGV4cG9ydHMuVHJhbnNpdGlvbk1vdGlvbiA9IFRyYW5zaXRpb25Nb3Rpb247XG5cdFxuXHR2YXIgX3NwcmluZzIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI4KTtcblx0XG5cdHZhciBfc3ByaW5nMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NwcmluZzIpO1xuXHRcblx0ZXhwb3J0cy5zcHJpbmcgPSBfc3ByaW5nM1snZGVmYXVsdCddO1xuXHRcblx0dmFyIF9wcmVzZXRzMiA9IF9fd2VicGFja19yZXF1aXJlX18oNyk7XG5cdFxuXHR2YXIgX3ByZXNldHMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJlc2V0czIpO1xuXHRcblx0ZXhwb3J0cy5wcmVzZXRzID0gX3ByZXNldHMzWydkZWZhdWx0J107XG5cdHZhciB1dGlscyA9IHtcblx0ICByZW9yZGVyS2V5czogX3Jlb3JkZXJLZXlzMlsnZGVmYXVsdCddXG5cdH07XG5cdGV4cG9ydHMudXRpbHMgPSB1dGlscztcblxuLyoqKi8gfSxcbi8qIDI3ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gcmVvcmRlcktleXM7XG5cdFxuXHRmdW5jdGlvbiByZW9yZGVyS2V5cyhvYmosIGYpIHtcblx0ICB2YXIgbmV3S2V5cyA9IGYoT2JqZWN0LmtleXMob2JqKSk7XG5cdCAgdmFyIHJldCA9IHt9O1xuXHQgIGZvciAodmFyIGkgPSAwOyBpIDwgbmV3S2V5cy5sZW5ndGg7IGkrKykge1xuXHQgICAgdmFyIGtleSA9IG5ld0tleXNbaV07XG5cdCAgICByZXRba2V5XSA9IG9ialtrZXldO1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHJldDtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDI4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzWydkZWZhdWx0J10gPSBzcHJpbmc7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX3ByZXNldHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpO1xuXHRcblx0dmFyIF9wcmVzZXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ByZXNldHMpO1xuXHRcblx0Ly8gaW5zdGVhZCBvZiBleHBvc2luZyB7dmFsOiBibGEsIGNvbmZpZzogYmxhfSwgdXNlIGEgaGVscGVyXG5cdFxuXHRmdW5jdGlvbiBzcHJpbmcodmFsKSB7XG5cdCAgdmFyIGNvbmZpZyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IF9wcmVzZXRzMlsnZGVmYXVsdCddLm5vV29iYmxlIDogYXJndW1lbnRzWzFdO1xuXHRcblx0ICByZXR1cm4geyB2YWw6IHZhbCwgY29uZmlnOiBjb25maWcgfTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAyOSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzW1wiZGVmYXVsdFwiXSA9IHN0ZXBwZXI7XG5cdHZhciBlcnJvck1hcmdpbiA9IDAuMDAwMTtcblx0XG5cdGZ1bmN0aW9uIHN0ZXBwZXIoZnJhbWVSYXRlLCB4LCB2LCBkZXN0WCwgaywgYikge1xuXHQgIC8vIFNwcmluZyBzdGlmZm5lc3MsIGluIGtnIC8gc14yXG5cdFxuXHQgIC8vIGZvciBhbmltYXRpb25zLCBkZXN0WCBpcyByZWFsbHkgc3ByaW5nIGxlbmd0aCAoc3ByaW5nIGF0IHJlc3QpLiBpbml0aWFsXG5cdCAgLy8gcG9zaXRpb24gaXMgY29uc2lkZXJlZCBhcyB0aGUgc3RyZXRjaGVkL2NvbXByZXNzZWQgcG9zaXRpb24gb2YgYSBzcHJpbmdcblx0ICB2YXIgRnNwcmluZyA9IC1rICogKHggLSBkZXN0WCk7XG5cdFxuXHQgIC8vIERhbXBpbmcsIGluIGtnIC8gc1xuXHQgIHZhciBGZGFtcGVyID0gLWIgKiB2O1xuXHRcblx0ICAvLyB1c3VhbGx5IHdlIHB1dCBtYXNzIGhlcmUsIGJ1dCBmb3IgYW5pbWF0aW9uIHB1cnBvc2VzLCBzcGVjaWZ5aW5nIG1hc3MgaXMgYVxuXHQgIC8vIGJpdCByZWR1bmRhbnQuIHlvdSBjb3VsZCBzaW1wbHkgYWRqdXN0IGsgYW5kIGIgYWNjb3JkaW5nbHlcblx0ICAvLyBsZXQgYSA9IChGc3ByaW5nICsgRmRhbXBlcikgLyBtYXNzO1xuXHQgIHZhciBhID0gRnNwcmluZyArIEZkYW1wZXI7XG5cdFxuXHQgIHZhciBuZXdWID0gdiArIGEgKiBmcmFtZVJhdGU7XG5cdCAgdmFyIG5ld1ggPSB4ICsgbmV3ViAqIGZyYW1lUmF0ZTtcblx0XG5cdCAgaWYgKE1hdGguYWJzKG5ld1YgLSB2KSA8IGVycm9yTWFyZ2luICYmIE1hdGguYWJzKG5ld1ggLSB4KSA8IGVycm9yTWFyZ2luKSB7XG5cdCAgICByZXR1cm4gW2Rlc3RYLCAwXTtcblx0ICB9XG5cdFxuXHQgIHJldHVybiBbbmV3WCwgbmV3Vl07XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiAzMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0Ly8gdHVybiB7eDoge3ZhbDogMSwgY29uZmlnOiBbMSwgMl19LCB5OiAyfSBpbnRvIHt4OiAxLCB5OiAyfVxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gc3RyaXBTdHlsZTtcblx0XG5cdGZ1bmN0aW9uIHN0cmlwU3R5bGUoc3R5bGUpIHtcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgZm9yICh2YXIga2V5IGluIHN0eWxlKSB7XG5cdCAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICByZXRba2V5XSA9IHN0eWxlW2tleV0udmFsID09IG51bGwgPyBzdHlsZVtrZXldIDogc3R5bGVba2V5XS52YWw7XG5cdCAgfVxuXHQgIHJldHVybiByZXQ7XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiAzMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0cy5pbnRlcnBvbGF0ZVZhbHVlID0gaW50ZXJwb2xhdGVWYWx1ZTtcblx0ZXhwb3J0cy51cGRhdGVDdXJyZW50U3R5bGUgPSB1cGRhdGVDdXJyZW50U3R5bGU7XG5cdGV4cG9ydHMudXBkYXRlQ3VycmVudFZlbG9jaXR5ID0gdXBkYXRlQ3VycmVudFZlbG9jaXR5O1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0dmFyIF9zdGVwcGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOSk7XG5cdFxuXHR2YXIgX3N0ZXBwZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RlcHBlcik7XG5cdFxuXHQvLyBUT0RPOiByZWZhY3RvciBjb21tb24gbG9naWMgd2l0aCB1cGRhdGVDdXJyVmFsdWUgYW5kIHVwZGF0ZUN1cnJWZWxvY2l0eVxuXHRcblx0ZnVuY3Rpb24gaW50ZXJwb2xhdGVWYWx1ZShhbHBoYSwgbmV4dFN0eWxlLCBwcmV2U3R5bGUpIHtcblx0ICAvLyBtaWdodCBiZSB1c2VkIGJ5IGEgVHJhbnNpdGlvbk1vdGlvbiwgd2hlcmUgcHJldlN0eWxlIG1pZ2h0IG5vdCBleGlzdCBhbnltb3JlXG5cdCAgaWYgKCFwcmV2U3R5bGUpIHtcblx0ICAgIHJldHVybiBuZXh0U3R5bGU7XG5cdCAgfVxuXHRcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgZm9yICh2YXIga2V5IGluIG5leHRTdHlsZSkge1xuXHQgICAgaWYgKCFuZXh0U3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoIW5leHRTdHlsZVtrZXldLmNvbmZpZykge1xuXHQgICAgICByZXRba2V5XSA9IG5leHRTdHlsZVtrZXldO1xuXHQgICAgICAvLyBub3QgYSBzcHJpbmcgY29uZmlnLCBub3Qgc29tZXRoaW5nIHdlIHdhbnQgdG8gaW50ZXJwb2xhdGVcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICB2YXIgcHJldlZhbHVlID0gcHJldlN0eWxlW2tleV0uY29uZmlnID8gcHJldlN0eWxlW2tleV0udmFsIDogcHJldlN0eWxlW2tleV07XG5cdCAgICByZXRba2V5XSA9IHtcblx0ICAgICAgdmFsOiBuZXh0U3R5bGVba2V5XS52YWwgKiBhbHBoYSArIHByZXZWYWx1ZSAqICgxIC0gYWxwaGEpLFxuXHQgICAgICBjb25maWc6IG5leHRTdHlsZVtrZXldLmNvbmZpZ1xuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIHJldHVybiByZXQ7XG5cdH1cblx0XG5cdC8vIFRPRE86IHJlZmFjdG9yIGNvbW1vbiBsb2dpYyB3aXRoIHVwZGF0ZUN1cnJlbnRWZWxvY2l0eVxuXHRcblx0ZnVuY3Rpb24gdXBkYXRlQ3VycmVudFN0eWxlKGZyYW1lUmF0ZSwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdHksIHN0eWxlKSB7XG5cdCAgdmFyIHJldCA9IHt9O1xuXHQgIGZvciAodmFyIGtleSBpbiBzdHlsZSkge1xuXHQgICAgaWYgKCFzdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgaWYgKCFzdHlsZVtrZXldLmNvbmZpZykge1xuXHQgICAgICByZXRba2V5XSA9IHN0eWxlW2tleV07XG5cdCAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWcsIG5vdCBzb21ldGhpbmcgd2Ugd2FudCB0byBpbnRlcnBvbGF0ZVxuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIHZhciBfc3R5bGUka2V5JGNvbmZpZyA9IHN0eWxlW2tleV0uY29uZmlnO1xuXHQgICAgdmFyIGsgPSBfc3R5bGUka2V5JGNvbmZpZ1swXTtcblx0ICAgIHZhciBiID0gX3N0eWxlJGtleSRjb25maWdbMV07XG5cdFxuXHQgICAgdmFyIHZhbCA9IF9zdGVwcGVyMlsnZGVmYXVsdCddKGZyYW1lUmF0ZSxcblx0ICAgIC8vIG1pZ2h0IGhhdmUgYmVlbiBhIG5vbi1zcHJpbmdlZCBwcm9wIHRoYXQganVzdCBiZWNhbWUgb25lXG5cdCAgICBjdXJyZW50U3R5bGVba2V5XS52YWwgPT0gbnVsbCA/IGN1cnJlbnRTdHlsZVtrZXldIDogY3VycmVudFN0eWxlW2tleV0udmFsLCBjdXJyZW50VmVsb2NpdHlba2V5XSwgc3R5bGVba2V5XS52YWwsIGssIGIpWzBdO1xuXHQgICAgcmV0W2tleV0gPSB7XG5cdCAgICAgIHZhbDogdmFsLFxuXHQgICAgICBjb25maWc6IHN0eWxlW2tleV0uY29uZmlnXG5cdCAgICB9O1xuXHQgIH1cblx0ICByZXR1cm4gcmV0O1xuXHR9XG5cdFxuXHRmdW5jdGlvbiB1cGRhdGVDdXJyZW50VmVsb2NpdHkoZnJhbWVSYXRlLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpIHtcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgZm9yICh2YXIga2V5IGluIHN0eWxlKSB7XG5cdCAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICBpZiAoIXN0eWxlW2tleV0uY29uZmlnKSB7XG5cdCAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWcsIG5vdCBzb21ldGhpbmcgd2Ugd2FudCB0byBpbnRlcnBvbGF0ZVxuXHQgICAgICByZXRba2V5XSA9IDA7XG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgdmFyIF9zdHlsZSRrZXkkY29uZmlnMiA9IHN0eWxlW2tleV0uY29uZmlnO1xuXHQgICAgdmFyIGsgPSBfc3R5bGUka2V5JGNvbmZpZzJbMF07XG5cdCAgICB2YXIgYiA9IF9zdHlsZSRrZXkkY29uZmlnMlsxXTtcblx0XG5cdCAgICB2YXIgdmFsID0gX3N0ZXBwZXIyWydkZWZhdWx0J10oZnJhbWVSYXRlLFxuXHQgICAgLy8gbWlnaHQgaGF2ZSBiZWVuIGEgbm9uLXNwcmluZ2VkIHByb3AgdGhhdCBqdXN0IGJlY2FtZSBvbmVcblx0ICAgIGN1cnJlbnRTdHlsZVtrZXldLnZhbCA9PSBudWxsID8gY3VycmVudFN0eWxlW2tleV0gOiBjdXJyZW50U3R5bGVba2V5XS52YWwsIGN1cnJlbnRWZWxvY2l0eVtrZXldLCBzdHlsZVtrZXldLnZhbCwgaywgYilbMV07XG5cdCAgICByZXRba2V5XSA9IHZhbDtcblx0ICB9XG5cdCAgcmV0dXJuIHJldDtcblx0fVxuXG4vKioqLyB9LFxuLyogMzIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIHVzZWQgYnkgdGhlIHRyZWUtd2Fsa2luZyB1cGRhdGVzIGFuZCBzcHJpbmdzLiBBdm9pZHMgc29tZSBhbGxvY2F0aW9uc1xuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gemVybztcblx0XG5cdGZ1bmN0aW9uIHplcm8oKSB7XG5cdCAgcmV0dXJuIDA7XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cbi8qKiovIH0sXG4vKiAzMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIG5vdyA9IF9fd2VicGFja19yZXF1aXJlX18oOClcblx0ICAsIGdsb2JhbCA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnID8ge30gOiB3aW5kb3dcblx0ICAsIHZlbmRvcnMgPSBbJ21veicsICd3ZWJraXQnXVxuXHQgICwgc3VmZml4ID0gJ0FuaW1hdGlvbkZyYW1lJ1xuXHQgICwgcmFmID0gZ2xvYmFsWydyZXF1ZXN0JyArIHN1ZmZpeF1cblx0ICAsIGNhZiA9IGdsb2JhbFsnY2FuY2VsJyArIHN1ZmZpeF0gfHwgZ2xvYmFsWydjYW5jZWxSZXF1ZXN0JyArIHN1ZmZpeF1cblx0XG5cdGZvcih2YXIgaSA9IDA7IGkgPCB2ZW5kb3JzLmxlbmd0aCAmJiAhcmFmOyBpKyspIHtcblx0ICByYWYgPSBnbG9iYWxbdmVuZG9yc1tpXSArICdSZXF1ZXN0JyArIHN1ZmZpeF1cblx0ICBjYWYgPSBnbG9iYWxbdmVuZG9yc1tpXSArICdDYW5jZWwnICsgc3VmZml4XVxuXHQgICAgICB8fCBnbG9iYWxbdmVuZG9yc1tpXSArICdDYW5jZWxSZXF1ZXN0JyArIHN1ZmZpeF1cblx0fVxuXHRcblx0Ly8gU29tZSB2ZXJzaW9ucyBvZiBGRiBoYXZlIHJBRiBidXQgbm90IGNBRlxuXHRpZighcmFmIHx8ICFjYWYpIHtcblx0ICB2YXIgbGFzdCA9IDBcblx0ICAgICwgaWQgPSAwXG5cdCAgICAsIHF1ZXVlID0gW11cblx0ICAgICwgZnJhbWVEdXJhdGlvbiA9IDEwMDAgLyA2MFxuXHRcblx0ICByYWYgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuXHQgICAgaWYocXVldWUubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgIHZhciBfbm93ID0gbm93KClcblx0ICAgICAgICAsIG5leHQgPSBNYXRoLm1heCgwLCBmcmFtZUR1cmF0aW9uIC0gKF9ub3cgLSBsYXN0KSlcblx0ICAgICAgbGFzdCA9IG5leHQgKyBfbm93XG5cdCAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGNwID0gcXVldWUuc2xpY2UoMClcblx0ICAgICAgICAvLyBDbGVhciBxdWV1ZSBoZXJlIHRvIHByZXZlbnRcblx0ICAgICAgICAvLyBjYWxsYmFja3MgZnJvbSBhcHBlbmRpbmcgbGlzdGVuZXJzXG5cdCAgICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgZnJhbWUncyBxdWV1ZVxuXHQgICAgICAgIHF1ZXVlLmxlbmd0aCA9IDBcblx0ICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY3AubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgIGlmKCFjcFtpXS5jYW5jZWxsZWQpIHtcblx0ICAgICAgICAgICAgdHJ5e1xuXHQgICAgICAgICAgICAgIGNwW2ldLmNhbGxiYWNrKGxhc3QpXG5cdCAgICAgICAgICAgIH0gY2F0Y2goZSkge1xuXHQgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IHRocm93IGUgfSwgMClcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfSwgTWF0aC5yb3VuZChuZXh0KSlcblx0ICAgIH1cblx0ICAgIHF1ZXVlLnB1c2goe1xuXHQgICAgICBoYW5kbGU6ICsraWQsXG5cdCAgICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcblx0ICAgICAgY2FuY2VsbGVkOiBmYWxzZVxuXHQgICAgfSlcblx0ICAgIHJldHVybiBpZFxuXHQgIH1cblx0XG5cdCAgY2FmID0gZnVuY3Rpb24oaGFuZGxlKSB7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgaWYocXVldWVbaV0uaGFuZGxlID09PSBoYW5kbGUpIHtcblx0ICAgICAgICBxdWV1ZVtpXS5jYW5jZWxsZWQgPSB0cnVlXG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4pIHtcblx0ICAvLyBXcmFwIGluIGEgbmV3IGZ1bmN0aW9uIHRvIHByZXZlbnRcblx0ICAvLyBgY2FuY2VsYCBwb3RlbnRpYWxseSBiZWluZyBhc3NpZ25lZFxuXHQgIC8vIHRvIHRoZSBuYXRpdmUgckFGIGZ1bmN0aW9uXG5cdCAgcmV0dXJuIHJhZi5jYWxsKGdsb2JhbCwgZm4pXG5cdH1cblx0bW9kdWxlLmV4cG9ydHMuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG5cdCAgY2FmLmFwcGx5KGdsb2JhbCwgYXJndW1lbnRzKVxuXHR9XG5cblxuLyoqKi8gfSxcbi8qIDM0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKlxyXG5cdFx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuXHRcdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuXHQqL1xyXG5cdHZhciBzdHlsZXNJbkRvbSA9IHt9LFxyXG5cdFx0bWVtb2l6ZSA9IGZ1bmN0aW9uKGZuKSB7XHJcblx0XHRcdHZhciBtZW1vO1xyXG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdGlmICh0eXBlb2YgbWVtbyA9PT0gXCJ1bmRlZmluZWRcIikgbWVtbyA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdFx0cmV0dXJuIG1lbW87XHJcblx0XHRcdH07XHJcblx0XHR9LFxyXG5cdFx0aXNPbGRJRSA9IG1lbW9pemUoZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiAvbXNpZSBbNi05XVxcYi8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKTtcclxuXHRcdH0pLFxyXG5cdFx0Z2V0SGVhZEVsZW1lbnQgPSBtZW1vaXplKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdO1xyXG5cdFx0fSksXHJcblx0XHRzaW5nbGV0b25FbGVtZW50ID0gbnVsbCxcclxuXHRcdHNpbmdsZXRvbkNvdW50ZXIgPSAwO1xyXG5cdFxyXG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obGlzdCwgb3B0aW9ucykge1xyXG5cdFx0aWYodHJ1ZSkge1xyXG5cdFx0XHRpZih0eXBlb2YgZG9jdW1lbnQgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBFcnJvcihcIlRoZSBzdHlsZS1sb2FkZXIgY2Fubm90IGJlIHVzZWQgaW4gYSBub24tYnJvd3NlciBlbnZpcm9ubWVudFwiKTtcclxuXHRcdH1cclxuXHRcclxuXHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG5cdFx0Ly8gRm9yY2Ugc2luZ2xlLXRhZyBzb2x1dGlvbiBvbiBJRTYtOSwgd2hpY2ggaGFzIGEgaGFyZCBsaW1pdCBvbiB0aGUgIyBvZiA8c3R5bGU+XHJcblx0XHQvLyB0YWdzIGl0IHdpbGwgYWxsb3cgb24gYSBwYWdlXHJcblx0XHRpZiAodHlwZW9mIG9wdGlvbnMuc2luZ2xldG9uID09PSBcInVuZGVmaW5lZFwiKSBvcHRpb25zLnNpbmdsZXRvbiA9IGlzT2xkSUUoKTtcclxuXHRcclxuXHRcdHZhciBzdHlsZXMgPSBsaXN0VG9TdHlsZXMobGlzdCk7XHJcblx0XHRhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpO1xyXG5cdFxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZShuZXdMaXN0KSB7XHJcblx0XHRcdHZhciBtYXlSZW1vdmUgPSBbXTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xyXG5cdFx0XHRcdHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdO1xyXG5cdFx0XHRcdGRvbVN0eWxlLnJlZnMtLTtcclxuXHRcdFx0XHRtYXlSZW1vdmUucHVzaChkb21TdHlsZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYobmV3TGlzdCkge1xyXG5cdFx0XHRcdHZhciBuZXdTdHlsZXMgPSBsaXN0VG9TdHlsZXMobmV3TGlzdCk7XHJcblx0XHRcdFx0YWRkU3R5bGVzVG9Eb20obmV3U3R5bGVzLCBvcHRpb25zKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbWF5UmVtb3ZlLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIGRvbVN0eWxlID0gbWF5UmVtb3ZlW2ldO1xyXG5cdFx0XHRcdGlmKGRvbVN0eWxlLnJlZnMgPT09IDApIHtcclxuXHRcdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKylcclxuXHRcdFx0XHRcdFx0ZG9tU3R5bGUucGFydHNbal0oKTtcclxuXHRcdFx0XHRcdGRlbGV0ZSBzdHlsZXNJbkRvbVtkb21TdHlsZS5pZF07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpIHtcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XHJcblx0XHRcdHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdO1xyXG5cdFx0XHRpZihkb21TdHlsZSkge1xyXG5cdFx0XHRcdGRvbVN0eWxlLnJlZnMrKztcclxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdGRvbVN0eWxlLnBhcnRzW2pdKGl0ZW0ucGFydHNbal0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRmb3IoOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0ZG9tU3R5bGUucGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHZhciBwYXJ0cyA9IFtdO1xyXG5cdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBpdGVtLnBhcnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0c3R5bGVzSW5Eb21baXRlbS5pZF0gPSB7aWQ6IGl0ZW0uaWQsIHJlZnM6IDEsIHBhcnRzOiBwYXJ0c307XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gbGlzdFRvU3R5bGVzKGxpc3QpIHtcclxuXHRcdHZhciBzdHlsZXMgPSBbXTtcclxuXHRcdHZhciBuZXdTdHlsZXMgPSB7fTtcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBpdGVtID0gbGlzdFtpXTtcclxuXHRcdFx0dmFyIGlkID0gaXRlbVswXTtcclxuXHRcdFx0dmFyIGNzcyA9IGl0ZW1bMV07XHJcblx0XHRcdHZhciBtZWRpYSA9IGl0ZW1bMl07XHJcblx0XHRcdHZhciBzb3VyY2VNYXAgPSBpdGVtWzNdO1xyXG5cdFx0XHR2YXIgcGFydCA9IHtjc3M6IGNzcywgbWVkaWE6IG1lZGlhLCBzb3VyY2VNYXA6IHNvdXJjZU1hcH07XHJcblx0XHRcdGlmKCFuZXdTdHlsZXNbaWRdKVxyXG5cdFx0XHRcdHN0eWxlcy5wdXNoKG5ld1N0eWxlc1tpZF0gPSB7aWQ6IGlkLCBwYXJ0czogW3BhcnRdfSk7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRuZXdTdHlsZXNbaWRdLnBhcnRzLnB1c2gocGFydCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gc3R5bGVzO1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBjcmVhdGVTdHlsZUVsZW1lbnQoKSB7XHJcblx0XHR2YXIgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xyXG5cdFx0dmFyIGhlYWQgPSBnZXRIZWFkRWxlbWVudCgpO1xyXG5cdFx0c3R5bGVFbGVtZW50LnR5cGUgPSBcInRleHQvY3NzXCI7XHJcblx0XHRoZWFkLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0XHRyZXR1cm4gc3R5bGVFbGVtZW50O1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBjcmVhdGVMaW5rRWxlbWVudCgpIHtcclxuXHRcdHZhciBsaW5rRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xyXG5cdFx0dmFyIGhlYWQgPSBnZXRIZWFkRWxlbWVudCgpO1xyXG5cdFx0bGlua0VsZW1lbnQucmVsID0gXCJzdHlsZXNoZWV0XCI7XHJcblx0XHRoZWFkLmFwcGVuZENoaWxkKGxpbmtFbGVtZW50KTtcclxuXHRcdHJldHVybiBsaW5rRWxlbWVudDtcclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gYWRkU3R5bGUob2JqLCBvcHRpb25zKSB7XHJcblx0XHR2YXIgc3R5bGVFbGVtZW50LCB1cGRhdGUsIHJlbW92ZTtcclxuXHRcclxuXHRcdGlmIChvcHRpb25zLnNpbmdsZXRvbikge1xyXG5cdFx0XHR2YXIgc3R5bGVJbmRleCA9IHNpbmdsZXRvbkNvdW50ZXIrKztcclxuXHRcdFx0c3R5bGVFbGVtZW50ID0gc2luZ2xldG9uRWxlbWVudCB8fCAoc2luZ2xldG9uRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudCgpKTtcclxuXHRcdFx0dXBkYXRlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCwgc3R5bGVJbmRleCwgZmFsc2UpO1xyXG5cdFx0XHRyZW1vdmUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50LCBzdHlsZUluZGV4LCB0cnVlKTtcclxuXHRcdH0gZWxzZSBpZihvYmouc291cmNlTWFwICYmXHJcblx0XHRcdHR5cGVvZiBVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxyXG5cdFx0XHR0eXBlb2YgVVJMLmNyZWF0ZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHRcdHR5cGVvZiBVUkwucmV2b2tlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdFx0dHlwZW9mIEJsb2IgPT09IFwiZnVuY3Rpb25cIiAmJlxyXG5cdFx0XHR0eXBlb2YgYnRvYSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudCA9IGNyZWF0ZUxpbmtFbGVtZW50KCk7XHJcblx0XHRcdHVwZGF0ZSA9IHVwZGF0ZUxpbmsuYmluZChudWxsLCBzdHlsZUVsZW1lbnQpO1xyXG5cdFx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdFx0XHRcdGlmKHN0eWxlRWxlbWVudC5ocmVmKVxyXG5cdFx0XHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChzdHlsZUVsZW1lbnQuaHJlZik7XHJcblx0XHRcdH07XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQoKTtcclxuXHRcdFx0dXBkYXRlID0gYXBwbHlUb1RhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRcdHJlbW92ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHN0eWxlRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0XHJcblx0XHR1cGRhdGUob2JqKTtcclxuXHRcclxuXHRcdHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmopIHtcclxuXHRcdFx0aWYobmV3T2JqKSB7XHJcblx0XHRcdFx0aWYobmV3T2JqLmNzcyA9PT0gb2JqLmNzcyAmJiBuZXdPYmoubWVkaWEgPT09IG9iai5tZWRpYSAmJiBuZXdPYmouc291cmNlTWFwID09PSBvYmouc291cmNlTWFwKVxyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdHVwZGF0ZShvYmogPSBuZXdPYmopO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHJlbW92ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH1cclxuXHRcclxuXHR2YXIgcmVwbGFjZVRleHQgPSAoZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHRleHRTdG9yZSA9IFtdO1xyXG5cdFxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIChpbmRleCwgcmVwbGFjZW1lbnQpIHtcclxuXHRcdFx0dGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xyXG5cdFx0XHRyZXR1cm4gdGV4dFN0b3JlLmZpbHRlcihCb29sZWFuKS5qb2luKCdcXG4nKTtcclxuXHRcdH07XHJcblx0fSkoKTtcclxuXHRcclxuXHRmdW5jdGlvbiBhcHBseVRvU2luZ2xldG9uVGFnKHN0eWxlRWxlbWVudCwgaW5kZXgsIHJlbW92ZSwgb2JqKSB7XHJcblx0XHR2YXIgY3NzID0gcmVtb3ZlID8gXCJcIiA6IG9iai5jc3M7XHJcblx0XHJcblx0XHRpZiAoc3R5bGVFbGVtZW50LnN0eWxlU2hlZXQpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dmFyIGNzc05vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpO1xyXG5cdFx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlRWxlbWVudC5jaGlsZE5vZGVzO1xyXG5cdFx0XHRpZiAoY2hpbGROb2Rlc1tpbmRleF0pIHN0eWxlRWxlbWVudC5yZW1vdmVDaGlsZChjaGlsZE5vZGVzW2luZGV4XSk7XHJcblx0XHRcdGlmIChjaGlsZE5vZGVzLmxlbmd0aCkge1xyXG5cdFx0XHRcdHN0eWxlRWxlbWVudC5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHN0eWxlRWxlbWVudC5hcHBlbmRDaGlsZChjc3NOb2RlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBhcHBseVRvVGFnKHN0eWxlRWxlbWVudCwgb2JqKSB7XHJcblx0XHR2YXIgY3NzID0gb2JqLmNzcztcclxuXHRcdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcclxuXHRcdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xyXG5cdFxyXG5cdFx0aWYobWVkaWEpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1lZGlhXCIsIG1lZGlhKVxyXG5cdFx0fVxyXG5cdFxyXG5cdFx0aWYoc3R5bGVFbGVtZW50LnN0eWxlU2hlZXQpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHdoaWxlKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKSB7XHJcblx0XHRcdFx0c3R5bGVFbGVtZW50LnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIHVwZGF0ZUxpbmsobGlua0VsZW1lbnQsIG9iaikge1xyXG5cdFx0dmFyIGNzcyA9IG9iai5jc3M7XHJcblx0XHR2YXIgbWVkaWEgPSBvYmoubWVkaWE7XHJcblx0XHR2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcclxuXHRcclxuXHRcdGlmKHNvdXJjZU1hcCkge1xyXG5cdFx0XHQvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yNjYwMzg3NVxyXG5cdFx0XHRjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArIFwiICovXCI7XHJcblx0XHR9XHJcblx0XHJcblx0XHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3NdLCB7IHR5cGU6IFwidGV4dC9jc3NcIiB9KTtcclxuXHRcclxuXHRcdHZhciBvbGRTcmMgPSBsaW5rRWxlbWVudC5ocmVmO1xyXG5cdFxyXG5cdFx0bGlua0VsZW1lbnQuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcblx0XHJcblx0XHRpZihvbGRTcmMpXHJcblx0XHRcdFVSTC5yZXZva2VPYmplY3RVUkwob2xkU3JjKTtcclxuXHR9XHJcblxuXG4vKioqLyB9LFxuLyogMzUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cdFxuXHQvLyBsb2FkIHRoZSBzdHlsZXNcblx0dmFyIGNvbnRlbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTtcblx0aWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5cdC8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cblx0dmFyIHVwZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oMzQpKGNvbnRlbnQsIHt9KTtcblx0aWYoY29udGVudC5sb2NhbHMpIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHM7XG5cdC8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcblx0aWYoZmFsc2UpIHtcblx0XHQvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFnc1xuXHRcdGlmKCFjb250ZW50LmxvY2Fscykge1xuXHRcdFx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhLi8uLi8uLi9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcz9icm93c2Vycz1sYXN0IDIgdmVyc2lvbiEuLy4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9pbmRleC5qcyEuL21haW4uc2Nzc1wiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2F1dG9wcmVmaXhlci1sb2FkZXIvaW5kZXguanM/YnJvd3NlcnM9bGFzdCAyIHZlcnNpb24hLi8uLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhLi9tYWluLnNjc3NcIik7XG5cdFx0XHRcdGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuXHRcdFx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0Ly8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuXHRcdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xuXHR9XG5cbi8qKiovIH0sXG4vKiAzNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgdmlld0JveD1cXFwiMCAwIDI2ODEgODE0XFxcIiB2ZXJzaW9uPVxcXCIxLjFcXFwiIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgeG1sbnM6eGxpbms9XFxcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcXFwiIHhtbG5zOnNrZXRjaD1cXFwiaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoL25zXFxcIj48dGl0bGU+Q2xpbWIgTG9nbyBCZXRhPC90aXRsZT48ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz48ZGVmcz48L2RlZnM+PGcgaWQ9XFxcIlBhZ2UtMVxcXCIgc3Ryb2tlPVxcXCJub25lXFxcIiBzdHJva2Utd2lkdGg9XFxcIjFcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgc2tldGNoOnR5cGU9XFxcIk1TUGFnZVxcXCI+PGcgaWQ9XFxcIkNsaW1iLUxvZ28tQmV0YVxcXCIgc2tldGNoOnR5cGU9XFxcIk1TQXJ0Ym9hcmRHcm91cFxcXCIgZmlsbD1cXFwiIzE5Mzc0RFxcXCI+PGcgaWQ9XFxcImNsaS0tLS1iLnNvY2lhbC0rLVBhdGgtQ29weS0rLVR5cGUtc29tZXRoaW5nLUNvcHktQ29weS1Db3B5LUNvcHktQ29weVxcXCIgc2tldGNoOnR5cGU9XFxcIk1TTGF5ZXJHcm91cFxcXCIgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMjA2LjAwMDAwMCwgMjQ5LjAwMDAwMClcXFwiPjxnIGlkPVxcXCJjbGktLS0tYi5zb2NpYWwtKy1QYXRoLUNvcHlcXFwiIHNrZXRjaDp0eXBlPVxcXCJNU1NoYXBlR3JvdXBcXFwiPjxwYXRoIGQ9XFxcIk03MjMuMzc0MjA3LDE4Ny40NDIyMTEgTDc2Ny4wMjc2NDEsMzM3LjM4MzU3NSBDNzY3LjUxMDg4OSwzNDEuMjY1NTUyIDc3MS44NjAxMjQsMzQ1LjE0NzUyOSA3NzYuMjA5MzU5LDM0NS4xNDc1MjkgTDgzMy4yMzI2NjQsMzQ1LjE0NzUyOSBDODM5LjAzMTY0NCwzNDUuMTQ3NTI5IDg0My4zODA4NzksMzQwLjc4MDMwNSA4NDIuNDE0MzgzLDMzNC40NzIwOTIgTDczOS40ODI0ODUsOC4zODYwMTk4MiBDNzM4Ljk5OTIzNyw0LjAxODc5NTY0IDczNC42NTAwMDIsMC42MjIwNjU3MjggNzMwLjc4NDAxNSwwLjYyMjA2NTcyOCBMNzIzLjA1MjA0MSwwLjYyMjA2NTcyOCBDNzIwLjYzNTgsMC42MjIwNjU3MjggNzE2LjI4NjU2NSwyLjU2MzA1NDI1IDcxNC44MzY4Miw1LjQ3NDUzNzA0IEw2NDMuNTE0MzAyLDIwOS4wMTkwNjIgTDU3Ni40OTQwMDMsMTA1LjQzMTc4OCBDNTczLjcyMTA1OCwxMDEuMTQ1ODk1IDU2Ny4zNDI1MzksOTcuNjcxNDkxOSA1NjIuMjU1Niw5Ny42NzE0OTE5IEw1NTIuMTc5MDMzLDk3LjY3MTQ5MTkgQzU0Ny4wODgzMjYsOTcuNjcxNDkxOSA1NDEuNTI5Mzg0LDEwMS41NTg3NDkgNTM5Ljc3MDA2MSwxMDYuMzM0MTg3IEw0NTQuOTgwMDY4LDMzNi40ODQ4MzMgQzQ1My4yMTc0OSwzNDEuMjY5MTA4IDQ1NS45MjcwODYsMzQ1LjE0NzUyOSA0NjEuMDE0MTAyLDM0NS4xNDc1MjkgTDUyMi4xMzgwNjcsMzQ1LjE0NzUyOSBDNTI3LjIzMzE1LDM0NS4xNDc1MjkgNTMyLjc5MTA1NCwzNDEuMjYxNzMzIDUzNC41NTI3OTcsMzM2LjQ2NjE3MSBMNTcxLjQ3MzE0NCwyMzUuOTY2OTI0IEw2NDIuMTA4NTI4LDM0Ni4xMDc3MTIgQzY0My40ODcxNDEsMzQ4LjI1NzM2MyA2NDYuNjY3MDkyLDM1MCA2NDkuMjEyMzA3LDM1MCBMNjU5Ljk3MTQxMiwzNTAgQzY2Mi41MTYxMDgsMzUwIDY2NS4yODIwNDQsMzQ4LjA0NTA3OCA2NjYuMTQxOTgyLDM0NS42NTM5MTggTDY4My44MjcyNjEsMjk2LjQ3Nzg3MiBMNzIzLjM3NDIwNywxODcuNDQyMjExIFpcXFwiIGlkPVxcXCJQYXRoLUNvcHlcXFwiPjwvcGF0aD48cGF0aCBkPVxcXCJNMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBDMC4xNDUyMTM0NDEsMzA1LjIzNDA0IDQ5LjA4NzIzNzcsMzQ4Ljg0NTc0NSAxMDQuMzI4NzMsMzQ4Ljg0NTc0NSBDMTM5LjIxODA5NCwzNDguODQ1NzQ1IDE2NC40MTU5NjgsMzM1LjI3NzY1OSAxODIuMzQ1MjI0LDMwOC4xNDE0ODcgQzE4NS43MzcyNDYsMzAzLjI5NTc0MiAxODMuMzE0MzczLDI5OC40NDk5OTcgMTc4Ljk1MzIwMywyOTQuNTczNDAxIEwxNDkuODc4NzMzLDI2OS4zNzU1MjcgQzE0Ni45NzEyODYsMjY2Ljk1MjY1NSAxNDIuNjEwMTE2LDI2Ny45MjE4MDQgMTM5LjIxODA5NCwyNzEuMzEzODI1IEMxMzEuNDY0OTAyLDI3OS4wNjcwMTcgMTIzLjIyNzEzNiwyODYuMzM1NjM1IDEwNi4yNjcwMjgsMjg2LjMzNTYzNSBDODQuOTQ1NzUwNSwyODYuMzM1NjM1IDY4LjQ3MDIxNzYsMjY4Ljg5MDk1MyA2OC40NzAyMTc2LDI0Ny4wODUxMDEgQzY4LjQ3MDIxNzYsMjI1Ljc2MzgyMyA4NS45MTQ4OTk1LDIwNy44MzQ1NjYgMTA3LjIzNjE3NywyMDcuODM0NTY2IEMxMTguMzgxMzkxLDIwNy44MzQ1NjYgMTI4LjU1NzQ1NSwyMTMuMTY0ODg2IDEzNS4zNDE0OTgsMjIwLjQzMzUwMyBDMTM3Ljc2NDM3MSwyMjIuODU2Mzc2IDE0My41NzkyNjUsMjIzLjgyNTUyNSAxNDYuMDAyMTM3LDIyMS40MDI2NTIgTDE3NS4wNzY2MDcsMTkzLjc4MTkwNiBDMTc5LjQzNzc3NywxODkuOTA1MzEgMTgwLjg5MTUwMSwxODQuNTc0OTkgMTc3LjQ5OTQ4LDE4MC4yMTM4MiBDMTU5LjA4NTY0OSwxNTcuOTIzMzkzIDEzNS4zNDE0OTgsMTQ1LjMyNDQ1NiAxMDQuODEzMzA1LDE0NS4zMjQ0NTYgQzQ5LjU3MTgxMjIsMTQ1LjMyNDQ1NiAwLjE0NTIxMzQ0MSwxODkuOTA1MzEgMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBMMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBaIE0yMTguNjg4MzEyLDMzNC43OTMwODUgQzIxOC42ODgzMTIsMzM5LjYzODgzIDIyMy4wNDk0ODIsMzQ0IDIyNy44OTUyMjcsMzQ0IEwyODEuMTk4NDIyLDM0NCBDMjg2LjA0NDE2NywzNDQgMjkwLjQwNTMzNywzMzkuNjM4ODMgMjkwLjQwNTMzNywzMzQuNzkzMDg1IEwyOTAuNDA1MzM3LDE0LjAwNDc2NzIgQzI5MC40MDUzMzcsOS4xNTkwMjIyNiAyODYuMDQ0MTY3LDQuNzk3ODUxNzkgMjgxLjE5ODQyMiw0Ljc5Nzg1MTc5IEwyMjcuODk1MjI3LDQuNzk3ODUxNzkgQzIyMy4wNDk0ODIsNC43OTc4NTE3OSAyMTguNjg4MzEyLDkuMTU5MDIyMjYgMjE4LjY4ODMxMiwxNC4wMDQ3NjcyIEwyMTguNjg4MzEyLDMzNC43OTMwODUgWiBNMzc4LjExMzMyMSw5MS41MzY2ODY4IEMzOTkuNDM0NTk5LDkxLjUzNjY4NjggNDE2Ljg3OTI4MSw3NC41NzY1Nzk0IDQxNi44NzkyODEsNTMuMjU1MzAxNSBDNDE2Ljg3OTI4MSwzMS45MzQwMjM2IDM5OS40MzQ1OTksMTQuNDg5MzQxNyAzNzguMTEzMzIxLDE0LjQ4OTM0MTcgQzM1Ni43OTIwNDQsMTQuNDg5MzQxNyAzMzkuODMxOTM2LDMxLjkzNDAyMzYgMzM5LjgzMTkzNiw1My4yNTUzMDE1IEMzMzkuODMxOTM2LDc0LjU3NjU3OTQgMzU2Ljc5MjA0NCw5MS41MzY2ODY4IDM3OC4xMTMzMjEsOTEuNTM2Njg2OCBMMzc4LjExMzMyMSw5MS41MzY2ODY4IFogTTM0Mi43MzkzODMsMzM0Ljc5MzA4NSBDMzQyLjczOTM4MywzMzkuNjM4ODMgMzQ3LjEwMDU1NCwzNDQgMzUxLjk0NjI5OSwzNDQgTDQwNS4yNDk0OTMsMzQ0IEM0MTAuMDk1MjM4LDM0NCA0MTQuNDU2NDA5LDMzOS42Mzg4MyA0MTQuNDU2NDA5LDMzNC43OTMwODUgTDQxNC40NTY0MDksMTU5LjM3NzExNiBDNDE0LjQ1NjQwOSwxNTQuMDQ2Nzk3IDQxMC4wOTUyMzgsMTUwLjE3MDIwMSA0MDUuMjQ5NDkzLDE1MC4xNzAyMDEgTDM1MS45NDYyOTksMTUwLjE3MDIwMSBDMzQ3LjEwMDU1NCwxNTAuMTcwMjAxIDM0Mi43MzkzODMsMTU0LjA0Njc5NyAzNDIuNzM5MzgzLDE1OS4zNzcxMTYgTDM0Mi43MzkzODMsMzM0Ljc5MzA4NSBaIE04ODkuMTU0MzEsMzM0Ljc5MzA4NSBDODg5LjE1NDMxLDMzOS42Mzg4MyA4OTMuNTE1NDgxLDM0NCA4OTguMzYxMjI2LDM0NCBMOTIxLjEzNjIyNywzNDQgQzkyNS45ODE5NzIsMzQ0IDkyOS4zNzM5OTQsMzM5LjYzODgzIDkzMS4zMTIyOTIsMzM0LjMwODUxIEw5MzcuMTI3MTg1LDMxOC4zMTc1NTIgQzkzNy4xMjcxODUsMzE4LjMxNzU1MiA5NTkuNDE3NjEyLDM0OC44NDU3NDUgMTAwMi4wNjAxNywzNDguODQ1NzQ1IEMxMDU2LjgxNzA5LDM0OC44NDU3NDUgMTA5OC4wMDU5MiwzMDIuODExMTY4IDEwOTguMDA1OTIsMjQ3LjA4NTEwMSBDMTA5OC4wMDU5MiwxNzguNzYwMDk2IDEwNTMuNDI1MDYsMTQ1LjMyNDQ1NiAxMDAxLjU3NTU5LDE0NS4zMjQ0NTYgQzk4NS4xMDAwNjEsMTQ1LjMyNDQ1NiA5NjcuMTcwODA0LDE1MS4xMzkzNSA5NjEuMzU1OTEsMTU0LjUzMTM3MSBMOTYxLjM1NTkxLDE0LjAwNDc2NzIgQzk2MS4zNTU5MSw5LjE1OTAyMjI2IDk1Ni45OTQ3NCw0Ljc5Nzg1MTc5IDk1Mi4xNDg5OTUsNC43OTc4NTE3OSBMODk4LjM2MTIyNiw0Ljc5Nzg1MTc5IEM4OTMuNTE1NDgxLDQuNzk3ODUxNzkgODg5LjE1NDMxLDkuMTU5MDIyMjYgODg5LjE1NDMxLDE0LjAwNDc2NzIgTDg4OS4xNTQzMSwzMzQuNzkzMDg1IFogTTk1My42MDI3MTgsMjQ2LjYwMDUyNiBDOTUzLjYwMjcxOCwyMjQuNzk0Njc0IDk3MC4wNzgyNTEsMjA3LjgzNDU2NiA5OTIuMzY4Njc4LDIwNy44MzQ1NjYgQzEwMTQuNjU5MTEsMjA3LjgzNDU2NiAxMDMxLjYxOTIxLDIyNC43OTQ2NzQgMTAzMS42MTkyMSwyNDYuNjAwNTI2IEMxMDMxLjYxOTIxLDI2OC44OTA5NTMgMTAxNC42NTkxMSwyODYuMzM1NjM1IDk5Mi4zNjg2NzgsMjg2LjMzNTYzNSBDOTcwLjA3ODI1MSwyODYuMzM1NjM1IDk1My42MDI3MTgsMjY4Ljg5MDk1MyA5NTMuNjAyNzE4LDI0Ni42MDA1MjYgTDk1My42MDI3MTgsMjQ2LjYwMDUyNiBaIE0xMTM0LjI1NjQ1LDMyMS4yMjQ5OTkgQzExMzQuMjU2NDUsMzM2LjI0NjgwOCAxMTQ2Ljg1NTM5LDM0OC44NDU3NDUgMTE2MS44NzcyLDM0OC44NDU3NDUgQzExNzcuMzgzNTgsMzQ4Ljg0NTc0NSAxMTg5LjQ5Nzk1LDMzNi4yNDY4MDggMTE4OS40OTc5NSwzMjEuMjI0OTk5IEMxMTg5LjQ5Nzk1LDMwNS43MTg2MTUgMTE3Ny4zODM1OCwyOTMuNjA0MjUyIDExNjEuODc3MiwyOTMuNjA0MjUyIEMxMTQ2Ljg1NTM5LDI5My42MDQyNTIgMTEzNC4yNTY0NSwzMDUuNzE4NjE1IDExMzQuMjU2NDUsMzIxLjIyNDk5OSBMMTEzNC4yNTY0NSwzMjEuMjI0OTk5IFogTTEyMzYuMDE3MSwzMzIuODU0Nzg3IEMxMjQ1LjcwODU5LDM0MC42MDc5NzkgMTI2OS45MzczMSwzNDguODQ1NzQ1IDEzMDEuOTE5MjMsMzQ4Ljg0NTc0NSBDMTM1Ni42NzYxNSwzNDguODQ1NzQ1IDEzODMuODEyMzIsMzIxLjIyNDk5OSAxMzgzLjgxMjMyLDI4Ny4zMDQ3ODQgQzEzODMuODEyMzIsMjQ4LjUzODgyNCAxMzU2LjY3NjE1LDIzMy4wMzI0NCAxMzE3LjQyNTYxLDIxOS40NjQzNTQgQzEzMDAuOTUwMDgsMjEzLjY0OTQ2IDEyOTUuNjE5NzYsMjA4LjgwMzcxNSAxMjk1LjYxOTc2LDIwMy45NTc5NyBDMTI5NS42MTk3NiwxOTguNjI3NjUxIDEyOTkuOTgwOTMsMTk3LjE3MzkyNyAxMzA2LjI4MDQsMTk3LjE3MzkyNyBDMTMyNS4xNzg4LDE5Ny4xNzM5MjcgMTM0Ny40NjkyMywyMDguMzE5MTQxIDEzNDcuNDY5MjMsMjA4LjMxOTE0MSBDMTM1MS4zNDU4MywyMDkuNzcyODY0IDEzNTYuMTkxNTcsMjA4LjMxOTE0MSAxMzU3LjY0NTMsMjA1LjQxMTY5NCBMMTM3NS41NzQ1NSwxNzIuNDYwNjI4IEMxMzc4LjQ4MiwxNjcuNjE0ODgzIDEzNzUuMDg5OTgsMTYzLjI1MzcxMiAxMzcwLjcyODgxLDE2MC4zNDYyNjUgQzEzNjAuMDY4MTcsMTUzLjU2MjIyMyAxMzM2LjgwODU5LDE0NS4zMjQ0NTYgMTMwNi4yODA0LDE0NS4zMjQ0NTYgQzEyNTMuOTQ2MzUsMTQ1LjMyNDQ1NiAxMjMwLjY4Njc4LDE3MS40OTE0NzkgMTIzMC42ODY3OCwyMDMuOTU3OTcgQzEyMzAuNjg2NzgsMjM0LjAwMTU4OSAxMjQ3LjE2MjMxLDI1NS44MDc0NDEgMTI4NC45NTkxMiwyNjguODkwOTUzIEMxMzA5LjY3MjQyLDI3Ny42MTMyOTQgMTMxMi41Nzk4NywyODQuMzk3MzM3IDEzMTIuNTc5ODcsMjg5LjI0MzA4MiBDMTMxMi41Nzk4NywyOTUuMDU3OTc2IDEzMDguMjE4NywyOTcuOTY1NDIzIDEzMDMuMzcyOTUsMjk3Ljk2NTQyMyBDMTI4Mi41MzYyNSwyOTcuOTY1NDIzIDEyNTkuNzYxMjUsMjg1LjM2NjQ4NiAxMjU5Ljc2MTI1LDI4NS4zNjY0ODYgQzEyNTUuODg0NjUsMjgzLjQyODE4OCAxMjUxLjAzODkxLDI4Ni4zMzU2MzUgMTI0OS41ODUxOCwyODkuMjQzMDgyIEwxMjMyLjYyNTA4LDMyMi42Nzg3MjIgQzEyMzAuMjAyMiwzMjcuMDM5ODkzIDEyMzIuNjI1MDgsMzI5Ljk0NzM0IDEyMzYuMDE3MSwzMzIuODU0Nzg3IEwxMjM2LjAxNzEsMzMyLjg1NDc4NyBaIE0xNDA3LjU1NjQ3LDI0Ni42MDA1MjYgQzE0MDcuNTU2NDcsMzAyLjMyNjU5MyAxNDUzLjEwNjQ3LDM0OC44NDU3NDUgMTUwOC4zNDc5NiwzNDguODQ1NzQ1IEMxNTYzLjU4OTQ2LDM0OC44NDU3NDUgMTYwOS4xMzk0NiwzMDIuMzI2NTkzIDE2MDkuMTM5NDYsMjQ2LjYwMDUyNiBDMTYwOS4xMzk0NiwxOTEuODQzNjA4IDE1NjMuNTg5NDYsMTQ1LjMyNDQ1NiAxNTA4LjM0Nzk2LDE0NS4zMjQ0NTYgQzE0NTMuMTA2NDcsMTQ1LjMyNDQ1NiAxNDA3LjU1NjQ3LDE5MS44NDM2MDggMTQwNy41NTY0NywyNDYuNjAwNTI2IEwxNDA3LjU1NjQ3LDI0Ni42MDA1MjYgWiBNMTQ3MC4wNjY1OCwyNDYuNjAwNTI2IEMxNDcwLjA2NjU4LDIyNS4yNzkyNDggMTQ4Ny4wMjY2OSwyMDcuODM0NTY2IDE1MDguMzQ3OTYsMjA3LjgzNDU2NiBDMTUyOS42NjkyNCwyMDcuODM0NTY2IDE1NDYuNjI5MzUsMjI1LjI3OTI0OCAxNTQ2LjYyOTM1LDI0Ni42MDA1MjYgQzE1NDYuNjI5MzUsMjY4LjQwNjM3OCAxNTI5LjY2OTI0LDI4Ni4zMzU2MzUgMTUwOC4zNDc5NiwyODYuMzM1NjM1IEMxNDg3LjAyNjY5LDI4Ni4zMzU2MzUgMTQ3MC4wNjY1OCwyNjguNDA2Mzc4IDE0NzAuMDY2NTgsMjQ2LjYwMDUyNiBMMTQ3MC4wNjY1OCwyNDYuNjAwNTI2IFogTTE2MzEuNDI5ODksMjQ3LjA4NTEwMSBDMTYzMS40Mjk4OSwzMDUuMjM0MDQgMTY4MC4zNzE5MSwzNDguODQ1NzQ1IDE3MzUuNjEzNCwzNDguODQ1NzQ1IEMxNzcwLjUwMjc3LDM0OC44NDU3NDUgMTc5NS43MDA2NCwzMzUuMjc3NjU5IDE4MTMuNjI5OSwzMDguMTQxNDg3IEMxODE3LjAyMTkyLDMwMy4yOTU3NDIgMTgxNC41OTkwNSwyOTguNDQ5OTk3IDE4MTAuMjM3ODgsMjk0LjU3MzQwMSBMMTc4MS4xNjM0MSwyNjkuMzc1NTI3IEMxNzc4LjI1NTk2LDI2Ni45NTI2NTUgMTc3My44OTQ3OSwyNjcuOTIxODA0IDE3NzAuNTAyNzcsMjcxLjMxMzgyNSBDMTc2Mi43NDk1OCwyNzkuMDY3MDE3IDE3NTQuNTExODEsMjg2LjMzNTYzNSAxNzM3LjU1MTcsMjg2LjMzNTYzNSBDMTcxNi4yMzA0MiwyODYuMzM1NjM1IDE2OTkuNzU0ODksMjY4Ljg5MDk1MyAxNjk5Ljc1NDg5LDI0Ny4wODUxMDEgQzE2OTkuNzU0ODksMjI1Ljc2MzgyMyAxNzE3LjE5OTU3LDIwNy44MzQ1NjYgMTczOC41MjA4NSwyMDcuODM0NTY2IEMxNzQ5LjY2NjA2LDIwNy44MzQ1NjYgMTc1OS44NDIxMywyMTMuMTY0ODg2IDE3NjYuNjI2MTcsMjIwLjQzMzUwMyBDMTc2OS4wNDkwNCwyMjIuODU2Mzc2IDE3NzQuODYzOTQsMjIzLjgyNTUyNSAxNzc3LjI4NjgxLDIyMS40MDI2NTIgTDE4MDYuMzYxMjgsMTkzLjc4MTkwNiBDMTgxMC43MjI0NSwxODkuOTA1MzEgMTgxMi4xNzYxNywxODQuNTc0OTkgMTgwOC43ODQxNSwxODAuMjEzODIgQzE3OTAuMzcwMzIsMTU3LjkyMzM5MyAxNzY2LjYyNjE3LDE0NS4zMjQ0NTYgMTczNi4wOTc5OCwxNDUuMzI0NDU2IEMxNjgwLjg1NjQ5LDE0NS4zMjQ0NTYgMTYzMS40Mjk4OSwxODkuOTA1MzEgMTYzMS40Mjk4OSwyNDcuMDg1MTAxIEwxNjMxLjQyOTg5LDI0Ny4wODUxMDEgWiBNMTg4NS4zNDY5Miw5MS41MzY2ODY4IEMxOTA2LjY2ODIsOTEuNTM2Njg2OCAxOTI0LjExMjg4LDc0LjU3NjU3OTQgMTkyNC4xMTI4OCw1My4yNTUzMDE1IEMxOTI0LjExMjg4LDMxLjkzNDAyMzYgMTkwNi42NjgyLDE0LjQ4OTM0MTcgMTg4NS4zNDY5MiwxNC40ODkzNDE3IEMxODY0LjAyNTY1LDE0LjQ4OTM0MTcgMTg0Ny4wNjU1NCwzMS45MzQwMjM2IDE4NDcuMDY1NTQsNTMuMjU1MzAxNSBDMTg0Ny4wNjU1NCw3NC41NzY1Nzk0IDE4NjQuMDI1NjUsOTEuNTM2Njg2OCAxODg1LjM0NjkyLDkxLjUzNjY4NjggTDE4ODUuMzQ2OTIsOTEuNTM2Njg2OCBaIE0xODQ5Ljk3Mjk5LDMzNC43OTMwODUgQzE4NDkuOTcyOTksMzM5LjYzODgzIDE4NTQuMzM0MTYsMzQ0IDE4NTkuMTc5OSwzNDQgTDE5MTIuNDgzMSwzNDQgQzE5MTcuMzI4ODQsMzQ0IDE5MjEuNjkwMDEsMzM5LjYzODgzIDE5MjEuNjkwMDEsMzM0Ljc5MzA4NSBMMTkyMS42OTAwMSwxNTkuMzc3MTE2IEMxOTIxLjY5MDAxLDE1NC4wNDY3OTcgMTkxNy4zMjg4NCwxNTAuMTcwMjAxIDE5MTIuNDgzMSwxNTAuMTcwMjAxIEwxODU5LjE3OTksMTUwLjE3MDIwMSBDMTg1NC4zMzQxNiwxNTAuMTcwMjAxIDE4NDkuOTcyOTksMTU0LjA0Njc5NyAxODQ5Ljk3Mjk5LDE1OS4zNzcxMTYgTDE4NDkuOTcyOTksMzM0Ljc5MzA4NSBaIE0xOTYwLjk0MDU1LDI4NC44ODE5MTEgQzE5NjAuOTQwNTUsMzIzLjE2MzI5NyAxOTg5LjUzMDQ0LDM0OC44NDU3NDUgMjAyNy44MTE4MywzNDguODQ1NzQ1IEMyMDU4LjM0MDAyLDM0OC44NDU3NDUgMjA3NS4zMDAxMywzMzQuNzkzMDg1IDIwODYuNDQ1MzQsMzI0LjYxNzAyIEwyMDkzLjIyOTM4LDMzNy43MDA1MzIgQzIwOTUuNjUyMjYsMzQzLjAzMDg1MSAyMDk5LjA0NDI4LDM0NCAyMTAxLjk1MTcyLDM0NCBMMjEyMy4yNzMsMzQ0IEMyMTI4LjExODc1LDM0NCAyMTMyLjQ3OTkyLDMzOS42Mzg4MyAyMTMyLjQ3OTkyLDMzNC43OTMwODUgTDIxMzIuNDc5OTIsMjI3LjcwMjEyMSBDMjEzMi40Nzk5MiwxNzAuNTIyMzMgMjExMC42NzQwNywxNDUuMzI0NDU2IDIwNTAuNTg2ODMsMTQ1LjMyNDQ1NiBDMjAyNC40MTk4LDE0NS4zMjQ0NTYgMTk5MC40OTk1OSwxNTEuMTM5MzUgMTk4Ni4xMzg0MiwxNTIuNTkzMDc0IEMxOTgxLjc3NzI1LDE1NC4wNDY3OTcgMTk3Ny40MTYwOCwxNTcuNDM4ODE4IDE5NzguODY5OCwxNjUuNjc2NTg1IEwxOTgzLjIzMDk3LDE5Ni4yMDQ3NzggQzE5ODQuMjAwMTIsMjAzLjQ3MzM5NiAxOTg3LjU5MjE0LDIwOC44MDM3MTUgMTk5NC44NjA3NiwyMDYuMzgwODQzIEMyMDA3LjQ1OTcsMjAyLjUwNDI0NyAyMDMwLjIzNDcsMTk5LjExMjIyNSAyMDQzLjMxODIxLDE5OS4xMTIyMjUgQzIwNjYuNTc3NzksMTk5LjExMjIyNSAyMDY5LjQ4NTIzLDIwOC44MDM3MTUgMjA2OS40ODUyMywyMjcuNzAyMTIxIEMyMDY5LjQ4NTIzLDIyNy43MDIxMjEgMjA1My45Nzg4NSwyMTkuOTQ4OTI5IDIwMzIuMTczLDIxOS45NDg5MjkgQzE5ODguMDc2NzIsMjE5Ljk0ODkyOSAxOTYwLjk0MDU1LDI0Ny41Njk2NzUgMTk2MC45NDA1NSwyODQuODgxOTExIEwxOTYwLjk0MDU1LDI4NC44ODE5MTEgWiBNMjAyMy45MzUyMywyODAuMDM2MTY2IEMyMDIzLjkzNTIzLDI2OC44OTA5NTMgMjAzMy4xNDIxNSwyNTkuNjg0MDM3IDIwNDQuNzcxOTMsMjU5LjY4NDAzNyBDMjA1Ni40MDE3MiwyNTkuNjg0MDM3IDIwNjUuNjA4NjQsMjY4Ljg5MDk1MyAyMDY2LjA5MzIxLDI4MC4wMzYxNjYgQzIwNjYuMDkzMjEsMjkxLjY2NTk1NCAyMDU2LjQwMTcyLDMwMS4zNTc0NDQgMjA0NC43NzE5MywzMDEuMzU3NDQ0IEMyMDMzLjE0MjE1LDMwMS4zNTc0NDQgMjAyMy45MzUyMywyOTEuNjY1OTU0IDIwMjMuOTM1MjMsMjgwLjAzNjE2NiBMMjAyMy45MzUyMywyODAuMDM2MTY2IFogTTIxODEuOTA2NTIsMzM0Ljc5MzA4NSBDMjE4MS45MDY1MiwzMzkuNjM4ODMgMjE4Ni4yNjc2OSwzNDQgMjE5MS4xMTM0MywzNDQgTDIyNDQuNDE2NjMsMzQ0IEMyMjQ5LjI2MjM3LDM0NCAyMjUzLjYyMzU0LDMzOS42Mzg4MyAyMjUzLjYyMzU0LDMzNC43OTMwODUgTDIyNTMuNjIzNTQsMTQuMDA0NzY3MiBDMjI1My42MjM1NCw5LjE1OTAyMjI2IDIyNDkuMjYyMzcsNC43OTc4NTE3OSAyMjQ0LjQxNjYzLDQuNzk3ODUxNzkgTDIxOTEuMTEzNDMsNC43OTc4NTE3OSBDMjE4Ni4yNjc2OSw0Ljc5Nzg1MTc5IDIxODEuOTA2NTIsOS4xNTkwMjIyNiAyMTgxLjkwNjUyLDE0LjAwNDc2NzIgTDIxODEuOTA2NTIsMzM0Ljc5MzA4NSBaXFxcIiBpZD1cXFwiY2xpLS0tLWIuc29jaWFsXFxcIj48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPlwiXG5cbi8qKiovIH0sXG4vKiAzNyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHtcclxuXHRcdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XHJcblx0XHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0XHRtb2R1bGUucGF0aHMgPSBbXTtcclxuXHRcdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XHJcblx0XHRcdG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0XHRtb2R1bGUud2VicGFja1BvbHlmaWxsID0gMTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBtb2R1bGU7XHJcblx0fVxyXG5cblxuLyoqKi8gfSxcbi8qIDM4ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMzhfXztcblxuLyoqKi8gfVxuLyoqKioqKi8gXSlcbn0pO1xuO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHJlYWN0LWNsaW1iLXNvY2lhbC5taW4uanNcbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL2Jvb3RzdHJhcCAyMzRhZWM5NGZiN2Y5YzVjYmZkYlxuICoqLyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJztcblxuaW1wb3J0IFdhbGxDb250YWluZXIgZnJvbSAnLi9jb21wb25lbnRzL3dhbGwvV2FsbENvbnRhaW5lcic7XG5pbXBvcnQgU2xpZGVzaG93Q29udGFpbmVyIGZyb20gJy4vY29tcG9uZW50cy9zbGlkZXNob3cvU2xpZGVzaG93Q29udGFpbmVyJztcblxuaW1wb3J0ICcuL3N0eWxlL21haW4uc2Nzcyc7XG5cbmlmICh3aW5kb3cpIHtcbiAgICB3aW5kb3cuQ2xpbWIgPSB3aW5kb3cuQ2xpbWIgfHwge307XG5cbiAgICBjb25zdCAkd2FsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2xpbWItd2FsbCcpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAkd2FsbHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgY29uc3QgJGl0ZW0gPSAkd2FsbHNbaV07XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25JZCA9ICRpdGVtLmRhdGFzZXQuY29sbGVjdGlvbklkO1xuICAgICAgICBjb25zdCBsaW1pdCA9ICRpdGVtLmRhdGFzZXQubGltaXQ7XG5cbiAgICAgICAgUmVhY3RET00ucmVuZGVyKFxuICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChXYWxsQ29udGFpbmVyLCB7Y29sbGVjdGlvbklkLCBsaW1pdH0pLFxuICAgICAgICAgICAgJGl0ZW1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCAkc2xpZGVzaG93cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbGltYi1zbGlkZXNob3cnKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgJHNsaWRlc2hvd3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgY29uc3QgJGl0ZW0gPSAkc2xpZGVzaG93c1tpXTtcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbklkID0gJGl0ZW0uZGF0YXNldC5jb2xsZWN0aW9uSWQ7XG5cbiAgICAgICAgUmVhY3RET00ucmVuZGVyKFxuICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChTbGlkZXNob3dDb250YWluZXIsIHtjb2xsZWN0aW9uSWR9KSxcbiAgICAgICAgICAgICRpdGVtXG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQge1dhbGxDb250YWluZXJ9O1xuZXhwb3J0IHtXYWxsfSBmcm9tICcuL2NvbXBvbmVudHMvd2FsbC9XYWxsJztcbmV4cG9ydCB7VGlsZX0gZnJvbSAnLi9jb21wb25lbnRzL3dhbGwvVGlsZSc7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9pbmRleC5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xX187XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCB7XCJyb290XCI6XCJSZWFjdFwiLFwiY29tbW9uanMyXCI6XCJyZWFjdFwiLFwiY29tbW9uanNcIjpcInJlYWN0XCIsXCJhbWRcIjpcInJlYWN0XCJ9XG4gKiogbW9kdWxlIGlkID0gMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuXG5jbGFzcyBJbWFnZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8aW1nIGNsYXNzTmFtZT1cImNsaW1iX19pbWFnZVwiXG4gICAgICAgICAgICAgICAgIHNyYz17IHRoaXMucHJvcHMuc3JjIH0gZGF0YS13aWR0aD17IHRoaXMucHJvcHMud2lkdGggfSBkYXRhLWhlaWdodD17IHRoaXMucHJvcHMuaGVpZ2h0IH0vPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuSW1hZ2UucHJvcFR5cGVzID0ge1xuICAgIHNyYzogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIHdpZHRoOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLFxuICAgIGhlaWdodDogUmVhY3QuUHJvcFR5cGVzLm51bWJlclxufTtcblxuZXhwb3J0IGRlZmF1bHQgSW1hZ2U7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL2NvbW1vbi9JbWFnZS5qc3hcbiAqKi8iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5cbmNsYXNzIE1lc3NhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuXG4gICAgcmVuZGVyKCkge1xuXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnByb3BzLmJvZHlcbiAgICAgICAgICAgIC5yZXBsYWNlKC88YSBocmVmPVwiaHR0cDpcXC9cXC9waWMudHdpdHRlci5jb21cXC9bXj5dKj4oW148XSspPFxcL2E+L2csICcnKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjbGltYl9fdGlsZV9fbWVzc2FnZVwiXG4gICAgICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBtZXNzYWdlfX0+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbk1lc3NhZ2UucHJvcFR5cGVzID0ge1xuICAgIGJvZHk6IFJlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxufTtcblxuZXhwb3J0IGRlZmF1bHQgTWVzc2FnZTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvY29tbW9uL01lc3NhZ2UuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBJbWFnZSBmcm9tICcuLy4uL2NvbW1vbi9JbWFnZSc7XG5pbXBvcnQgTWVzc2FnZSBmcm9tICcuLy4uL2NvbW1vbi9NZXNzYWdlJztcbmltcG9ydCBBdXRob3IgZnJvbSAnLi8uLi9jb21tb24vQXV0aG9yJztcblxuXG5jbGFzcyBUaWxlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG5cbiAgICBjcmVhdGVJbWFnZSgpIHtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pbWFnZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3Qge3VybDogc3JjLCB3aWR0aCwgaGVpZ2h0fSA9IHRoaXMucHJvcHMuaW1hZ2U7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxJbWFnZSBzcmM9eyBzcmMgfVxuICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD17IHdpZHRoIH1cbiAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXsgaGVpZ2h0IH0vPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjcmVhdGVNZXNzYWdlKCkge1xuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPE1lc3NhZ2UgYm9keT17IHRoaXMucHJvcHMubWVzc2FnZSB9Lz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY3JlYXRlQ2xhc3NTdHJpbmcoKSB7XG5cbiAgICAgICAgbGV0IGNsYXNzU3RyaW5nID0gYGNsaW1iX190aWxlIGNsaW1iX190aWxlLS0ke3RoaXMucHJvcHMuc291cmNlX3R5cGV9YDtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pbWFnZSkge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW1lZGlhIGNsaW1iX190aWxlLS1oYXMtaW1hZ2UnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW5vLWltYWdlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLnZpZGVvX3VybCkge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW1lZGlhIGNsaW1iX190aWxlLS1oYXMtdmlkZW8nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW5vLXZpZGVvJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGFzc1N0cmluZztcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG5cbiAgICAgICAgY29uc3QgaW1hZ2UgPSB0aGlzLmNyZWF0ZUltYWdlKCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmNyZWF0ZU1lc3NhZ2UoKTtcbiAgICAgICAgY29uc3QgY2xhc3NTdHJpbmcgPSB0aGlzLmNyZWF0ZUNsYXNzU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IHthdXRob3J9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9eyBjbGFzc1N0cmluZyB9XG4gICAgICAgICAgICAgICAgIHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfT5cblxuICAgICAgICAgICAgICAgIDxhIGhyZWY9eyB0aGlzLnByb3BzLmxpbmsgfT5cbiAgICAgICAgICAgICAgICAgICAgeyBpbWFnZSB9XG4gICAgICAgICAgICAgICAgPC9hPlxuXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjbGltYl9fdGlsZV9fY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICB7IG1lc3NhZ2UgfVxuXG4gICAgICAgICAgICAgICAgICAgIDxBdXRob3Igey4uLmF1dGhvcn0gLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuXG5UaWxlLnByb3BUeXBlcyA9IHtcblxuICAgIC8vIFJlcXVpcmVkIGF0dHJzXG4gICAgbGluazogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIHNvdXJjZV90eXBlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgdGltZXN0YW1wOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgYXV0aG9yOiBSZWFjdC5Qcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICB1c2VybmFtZTogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgICBwaWN0dXJlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIGxpbms6IFJlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuICAgIH0pLFxuXG4gICAgLy8gT3B0aW9uYWwgYXR0cnNcbiAgICBtZXNzYWdlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLFxuICAgIHZpZGVvX3NyYzogUmVhY3QuUHJvcFR5cGVzLnN0cmluZyxcbiAgICBpbWFnZTogUmVhY3QuUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgdXJsOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIHdpZHRoOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgICAgIGhlaWdodDogUmVhY3QuUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkXG4gICAgfSlcblxufTtcblxuZXhwb3J0IGRlZmF1bHQgVGlsZTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvd2FsbC9UaWxlLmpzeFxuICoqLyIsImltcG9ydCBSZWFjdCwge0NvbXBvbmVudCwgUHJvcFR5cGVzfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgVGlsZSBmcm9tICcuL1RpbGUnO1xuaW1wb3J0IHtUcmFuc2l0aW9uTW90aW9uLCBzcHJpbmd9IGZyb20gJ3JlYWN0LW1vdGlvbic7XG5cblxuY2xhc3MgV2FsbCBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBpdGVtczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIGdldFN0eWxlcygpIHtcbiAgICAgICAgY29uc3QgY29uZmlncyA9IHt9O1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnByb3BzLml0ZW1zKS5tYXAoa2V5ID0+IHtcbiAgICAgICAgICAgIGNvbmZpZ3Nba2V5XSA9IHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiBzcHJpbmcoMSksXG4gICAgICAgICAgICAgICAgd2lkdGg6IHNwcmluZygzMCksXG4gICAgICAgICAgICAgICAgbWFyZ2luOiBzcHJpbmcoMSksXG4gICAgICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvbmZpZ3M7XG4gICAgfVxuXG4gICAgd2lsbEVudGVyKGtleSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgb3BhY2l0eTogc3ByaW5nKDApLFxuICAgICAgICAgICAgd2lkdGg6IHNwcmluZygwKSxcbiAgICAgICAgICAgIG1hcmdpbjogc3ByaW5nKDApLFxuICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgd2lsbExlYXZlKGtleSwgc3R5bGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IHNwcmluZygwKSxcbiAgICAgICAgICAgIHdpZHRoOiBzcHJpbmcoMCksXG4gICAgICAgICAgICBtYXJnaW46IHNwcmluZygwKSxcbiAgICAgICAgICAgIGl0ZW06IHN0eWxlLml0ZW1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZW5kZXJUaWxlKGtleSwgaXRlbVZhbHVlcykge1xuXG4gICAgICAgIGNvbnN0IHtpdGVtLCAuLi5zdHlsZUNvbmZpZ30gPSBpdGVtVmFsdWVzO1xuICAgICAgICBjb25zdCB7Li4uaXRlbVByb3BzfSA9IGl0ZW07XG5cbiAgICAgICAgY29uc3Qgc3R5bGUgPSB7XG4gICAgICAgICAgICBvcGFjaXR5OiBzdHlsZUNvbmZpZy5vcGFjaXR5LFxuICAgICAgICAgICAgd2lkdGg6IGAke3N0eWxlQ29uZmlnLndpZHRofSVgLFxuICAgICAgICAgICAgbWFyZ2luTGVmdDogYCR7c3R5bGVDb25maWcubWFyZ2lufSVgLFxuICAgICAgICAgICAgbWFyZ2luUmlnaHQ6IGAke3N0eWxlQ29uZmlnLm1hcmdpbn0lYFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8VGlsZSBrZXk9e2tleX1cbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtzdHlsZX1cbiAgICAgICAgICAgICAgICB7Li4uaXRlbVByb3BzIH0gLz5cbiAgICAgICAgKTtcblxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxUcmFuc2l0aW9uTW90aW9uXG4gICAgICAgICAgICAgICAgc3R5bGVzPXt0aGlzLmdldFN0eWxlcy5iaW5kKHRoaXMpKCl9XG4gICAgICAgICAgICAgICAgd2lsbEVudGVyPXt0aGlzLndpbGxFbnRlci5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgIHdpbGxMZWF2ZT17dGhpcy53aWxsTGVhdmUuYmluZCh0aGlzKX0+XG4gICAgICAgICAgICAgICAge3ZhbHVlcyA9PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNsaW1iX193YWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7T2JqZWN0LmtleXModmFsdWVzKS5tYXAoa2V5ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtVmFsdWVzID0gdmFsdWVzW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyVGlsZShrZXksIGl0ZW1WYWx1ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvVHJhbnNpdGlvbk1vdGlvbj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFdhbGw7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL3dhbGwvV2FsbC5qc3hcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblxudmFyIF9yeExpdGUgPSByZXF1aXJlKCdyeC1saXRlJyk7XG5cbnZhciBfZmV0Y2hKc29ucCA9IHJlcXVpcmUoJ2ZldGNoLWpzb25wJyk7XG5cbnZhciBfZmV0Y2hKc29ucDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mZXRjaEpzb25wKTtcblxudmFyIGdldFN0cmVhbSA9IGZ1bmN0aW9uIGdldFN0cmVhbShjb2xsZWN0aW9uSWQpIHtcblxuICAgIHZhciBwb2xsUmF0ZSA9IDUgKiAxMDAwO1xuXG4gICAgdmFyIHJlcXVlc3RTdHJlYW0gPSBfcnhMaXRlLk9ic2VydmFibGUuanVzdCgnaHR0cDovL2FwcC5jbGltYi5zb2NpYWwvYXBpL3YxL2NvbGxlY3Rpb25zLycgKyBjb2xsZWN0aW9uSWQpO1xuXG4gICAgdmFyIHVwZGF0ZVN0cmVhbSA9IF9yeExpdGUuT2JzZXJ2YWJsZS5pbnRlcnZhbChwb2xsUmF0ZSkuc3RhcnRXaXRoKG51bGwpO1xuXG4gICAgdmFyIHJlc3BvbnNlU3RyZWFtID0gdXBkYXRlU3RyZWFtLmNvbWJpbmVMYXRlc3QocmVxdWVzdFN0cmVhbSwgZnVuY3Rpb24gKHRpY2ssIHVybCkge1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH0pLmZsYXRNYXAoZnVuY3Rpb24gKGJhc2VVcmwpIHtcblxuICAgICAgICB2YXIgcmVxdWVzdFVybCA9ICcnICsgYmFzZVVybDtcblxuICAgICAgICByZXR1cm4gX3J4TGl0ZS5PYnNlcnZhYmxlLmZyb21Qcm9taXNlKCgwLCBfZmV0Y2hKc29ucDJbJ2RlZmF1bHQnXSkocmVxdWVzdFVybCkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3AuanNvbigpO1xuICAgICAgICB9KSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzcG9uc2VTdHJlYW07XG59O1xuXG5leHBvcnRzWydkZWZhdWx0J10gPSB7XG4gICAgZ2V0U3RyZWFtOiBnZXRTdHJlYW1cbn07XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2NsaW1iLXNvY2lhbC9kaXN0L2luZGV4LmpzXG4gKiogbW9kdWxlIGlkID0gNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gW3N0aWZmbmVzcywgZGFtcGluZ11cblwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB7XG4gIG5vV29iYmxlOiBbMTcwLCAyNl0sIC8vIHRoZSBkZWZhdWx0XG4gIGdlbnRsZTogWzEyMCwgMTRdLFxuICB3b2JibHk6IFsxODAsIDEyXSxcbiAgc3RpZmY6IFsyMTAsIDIwXVxufTtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9wcmVzZXRzLmpzXG4gKiogbW9kdWxlIGlkID0gN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjcuMVxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2V0TmFub1NlY29uZHMsIGhydGltZSwgbG9hZFRpbWU7XG5cbiAgaWYgKCh0eXBlb2YgcGVyZm9ybWFuY2UgIT09IFwidW5kZWZpbmVkXCIgJiYgcGVyZm9ybWFuY2UgIT09IG51bGwpICYmIHBlcmZvcm1hbmNlLm5vdykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgfTtcbiAgfSBlbHNlIGlmICgodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2VzcyAhPT0gbnVsbCkgJiYgcHJvY2Vzcy5ocnRpbWUpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIChnZXROYW5vU2Vjb25kcygpIC0gbG9hZFRpbWUpIC8gMWU2O1xuICAgIH07XG4gICAgaHJ0aW1lID0gcHJvY2Vzcy5ocnRpbWU7XG4gICAgZ2V0TmFub1NlY29uZHMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBocjtcbiAgICAgIGhyID0gaHJ0aW1lKCk7XG4gICAgICByZXR1cm4gaHJbMF0gKiAxZTkgKyBoclsxXTtcbiAgICB9O1xuICAgIGxvYWRUaW1lID0gZ2V0TmFub1NlY29uZHMoKTtcbiAgfSBlbHNlIGlmIChEYXRlLm5vdykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gRGF0ZS5ub3coKSAtIGxvYWRUaW1lO1xuICAgIH07XG4gICAgbG9hZFRpbWUgPSBEYXRlLm5vdygpO1xuICB9IGVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCkgLSBsb2FkVGltZTtcbiAgICB9O1xuICAgIGxvYWRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gIH1cblxufSkuY2FsbCh0aGlzKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9+L3BlcmZvcm1hbmNlLW5vdy9saWIvcGVyZm9ybWFuY2Utbm93LmpzXG4gKiogbW9kdWxlIGlkID0gOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG5cbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZHJhaW5RdWV1ZSwgMCk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqICh3ZWJwYWNrKS9+L25vZGUtbGlicy1icm93c2VyL34vcHJvY2Vzcy9icm93c2VyLmpzXG4gKiogbW9kdWxlIGlkID0gOVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuXG5jbGFzcyBBdXRob3IgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuXG4gICAgcmVuZGVyKCkge1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJjbGltYl9fdGlsZV9fYXV0aG9yXCJcbiAgICAgICAgICAgICAgIGhyZWY9eyB0aGlzLnByb3BzLmxpbmsgfT5cblxuICAgICAgICAgICAgICAgIDxpbWcgc3JjPXsgdGhpcy5wcm9wcy5waWN0dXJlfVxuICAgICAgICAgICAgICAgICAgICAgYWx0PXsgYFByb2ZpbGUgcGljIG9mICR7dGhpcy5wcm9wcy5uYW1lfWAgfS8+XG5cbiAgICAgICAgICAgICAgICA8aDQgY2xhc3NOYW1lPVwiY2xpbWJfX3RpbGVfX2F1dGhvcl9fdXNlcm5hbWVcIj5cbiAgICAgICAgICAgICAgICAgICAgeyB0aGlzLnByb3BzLnVzZXJuYW1lIH1cbiAgICAgICAgICAgICAgICA8L2g0PlxuICAgICAgICAgICAgPC9hPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuQXV0aG9yLnByb3BUeXBlcyA9IHt9O1xuXG5leHBvcnQgZGVmYXVsdCBBdXRob3I7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL2NvbW1vbi9BdXRob3IuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50LCBQcm9wVHlwZXN9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBTbGlkZSBmcm9tICcuL3NsaWRlJztcblxuXG5jbGFzcyBTbGlkZXNob3cgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgIH1cblxuICAgIHN0YXRlID0ge1xuICAgICAgICBjdXJyZW50SXRlbUluZGV4OiAwXG4gICAgfTtcblxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGl0ZW1zOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgICAgIGRlbGF5OiBQcm9wVHlwZXMubnVtYmVyXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGRlbGF5OiAzXG4gICAgfTtcblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICBjb25zdCB7ZGVsYXl9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKHRoaXMubmV4dFNsaWRlLmJpbmQodGhpcyksIGRlbGF5ICogMTAwMCk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XG4gICAgfVxuXG4gICAgbmV4dFNsaWRlKCkge1xuICAgICAgICBjb25zdCBzbGlkZXNob3dMZW5ndGggPSBPYmplY3Qua2V5cyh0aGlzLnByb3BzLml0ZW1zKS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IG5ld0luZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc2xpZGVzaG93TGVuZ3RoKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBjdXJyZW50SXRlbUluZGV4OiBuZXdJbmRleFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG5cbiAgICAgICAgY29uc3Qga2V5ID0gT2JqZWN0LmtleXModGhpcy5wcm9wcy5pdGVtcylbdGhpcy5zdGF0ZS5jdXJyZW50SXRlbUluZGV4XTtcblxuICAgICAgICBpZiAoIWtleSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5wcm9wcy5pdGVtc1trZXldO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxTbGlkZSBrZXk9e2tleX0gaXRlbT17aXRlbX0gLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2xpZGVzaG93O1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9zbGlkZXNob3cvU2xpZGVzaG93LmpzeFxuICoqLyIsImltcG9ydCBSZWFjdCwge0NvbXBvbmVudCwgUHJvcFR5cGVzfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY2xpbWIgZnJvbSAnY2xpbWItc29jaWFsJztcbmltcG9ydCBTbGlkZXNob3cgZnJvbSAnLi9TbGlkZXNob3cnO1xuXG5cbmNsYXNzIFNsaWRlc2hvd0NvbnRhaW5lciBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgfVxuXG4gICAgc3RhdGUgPSB7XG4gICAgICAgIGl0ZW1zOiB7fVxuICAgIH07XG5cbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBjb2xsZWN0aW9uSWQ6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuICAgIH07XG5cbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBjb2xsZWN0aW9uSWQ6ICc1NjFiYTYzNDQ1Mjg0ZTE3NDBlMDE2ZjcnXG4gICAgfTtcblxuICAgIGluaXQoKSB7XG5cbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmNvbGxlY3Rpb25JZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY2xpbWJcbiAgICAgICAgICAgIC5nZXRTdHJlYW0odGhpcy5wcm9wcy5jb2xsZWN0aW9uSWQpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKGl0ZW1zID0+IHtcblxuICAgICAgICAgICAgICAgIGNvbnN0IG1hcHBlZEl0ZW1zID0ge307XG4gICAgICAgICAgICAgICAgaXRlbXMubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBtYXBwZWRJdGVtc1tpdGVtLmlkXSA9IGl0ZW07XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbXM6IG1hcHBlZEl0ZW1zXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLmluaXQoKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8U2xpZGVzaG93IGl0ZW1zPXt0aGlzLnN0YXRlLml0ZW1zfS8+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTbGlkZXNob3dDb250YWluZXI7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL3NsaWRlc2hvdy9TbGlkZXNob3dDb250YWluZXIuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50LCBQcm9wVHlwZXN9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBNZXNzYWdlIGZyb20gJy4uL2NvbW1vbi9NZXNzYWdlJztcbmltcG9ydCBJbWFnZSBmcm9tICcuLi9jb21tb24vSW1hZ2UnO1xuXG5cbmNsYXNzIFNsaWRlIGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBpdGVtOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWRcbiAgICB9O1xuXG4gICAgY3JlYXRlSW1hZ2UoKSB7XG5cbiAgICAgICAgY29uc3Qge2ltYWdlfSA9IHRoaXMucHJvcHMuaXRlbTtcblxuICAgICAgICBpZiAoaW1hZ2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbnN0IHt1cmw6IHNyYywgd2lkdGgsIGhlaWdodH0gPSBpbWFnZTtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPEltYWdlIHNyYz17IHNyYyB9XG4gICAgICAgICAgICAgICAgICAgICAgIHdpZHRoPXsgd2lkdGggfVxuICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ9eyBoZWlnaHQgfS8+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcblxuICAgICAgICBjb25zdCB7aXRlbX0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCBpbWFnZSA9IHRoaXMuY3JlYXRlSW1hZ2UoKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjbGltYi1zbGlkZXNob3dfX3NsaWRlXCI+XG4gICAgICAgICAgICAgICAge2ltYWdlfVxuICAgICAgICAgICAgICAgIDxNZXNzYWdlIGJvZHk9eyBpdGVtLm1lc3NhZ2UgfS8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNsaWRlO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy9zbGlkZXNob3cvc2xpZGUuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50fSBmcm9tICdyZWFjdCc7XG5cblxuY2xhc3MgQ2xpbWJCYWRnZSBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICByZW5kZXIoKSB7XG5cbiAgICAgICAgY29uc3QgbG9nbyA9IHJlcXVpcmUoJy4uLy4uL2ltZy9jbGltYl9sb2dvLnN2ZycpO1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8YSBocmVmPVwiaHR0cDovL2NsaW1iLnNvY2lhbC9cIlxuICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiY2xpbWItc29jaWFsLWJhZGdlXCJcbiAgICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBsb2dvfX0+XG4gICAgICAgICAgICA8L2E+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBDbGltYkJhZGdlO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy93YWxsL0NsaW1iQmFkZ2UuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50LCBQcm9wVHlwZXN9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBjbGltYiBmcm9tICdjbGltYi1zb2NpYWwnO1xuaW1wb3J0IFdhbGwgZnJvbSAnLi9XYWxsJztcbmltcG9ydCBCYWRnZSBmcm9tICcuL0NsaW1iQmFkZ2UnO1xuXG5cbmNsYXNzIFdhbGxDb250YWluZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgIH1cblxuICAgIHN0YXRlID0ge1xuICAgICAgICBpdGVtczoge31cbiAgICB9O1xuXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgY29sbGVjdGlvbklkOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIGxpbWl0OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtcbiAgICAgICAgICAgIFByb3BUeXBlcy5udW1iZXIsXG4gICAgICAgICAgICBQcm9wVHlwZXMuc3RyaW5nXG4gICAgICAgIF0pXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGNvbGxlY3Rpb25JZDogJzU2MWJhNjM0NDUyODRlMTc0MGUwMTZmNycsXG4gICAgICAgIGxpbWl0OiAzMFxuICAgIH07XG5cbiAgICBpbml0KCkge1xuXG4gICAgICAgIGlmICghdGhpcy5wcm9wcy5jb2xsZWN0aW9uSWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNsaW1iXG4gICAgICAgICAgICAuZ2V0U3RyZWFtKHRoaXMucHJvcHMuY29sbGVjdGlvbklkKVxuICAgICAgICAgICAgLnN1YnNjcmliZShpdGVtcyA9PiB7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtYXhTaXplID0gcGFyc2VJbnQodGhpcy5wcm9wcy5saW1pdCwgMCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBtYXBwZWRJdGVtcyA9IHt9O1xuICAgICAgICAgICAgICAgIGl0ZW1zLnNwbGljZSgwLCBtYXhTaXplKS5tYXAoaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG1hcHBlZEl0ZW1zW2l0ZW0uaWRdID0gaXRlbTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBpdGVtczogbWFwcGVkSXRlbXNcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIHRoaXMuaW5pdCgpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZFVwZGF0ZSgpIHtcbiAgICAgICAgbGV0IGNiO1xuICAgICAgICBpZiAod2luZG93LkNsaW1iICYmIHdpbmRvdy5DbGltYi5vblVwZGF0ZSkge1xuICAgICAgICAgICAgY2IgPSB3aW5kb3cuQ2xpbWIub25VcGRhdGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBub29wXG4gICAgICAgICAgICBjYiA9ICgpID0+IHtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY2IoKTtcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICAgIDxXYWxsIGl0ZW1zPXt0aGlzLnN0YXRlLml0ZW1zfS8+XG4gICAgICAgICAgICAgICAgPEJhZGdlIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFdhbGxDb250YWluZXI7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL3dhbGwvV2FsbENvbnRhaW5lci5qc3hcbiAqKi8iLCIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCwgQWxsIHJpZ2h0cyByZXNlcnZlZC4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG5cbjsoZnVuY3Rpb24gKHVuZGVmaW5lZCkge1xuXG4gIHZhciBvYmplY3RUeXBlcyA9IHtcbiAgICAnZnVuY3Rpb24nOiB0cnVlLFxuICAgICdvYmplY3QnOiB0cnVlXG4gIH07XG5cbiAgZnVuY3Rpb24gY2hlY2tHbG9iYWwodmFsdWUpIHtcbiAgICByZXR1cm4gKHZhbHVlICYmIHZhbHVlLk9iamVjdCA9PT0gT2JqZWN0KSA/IHZhbHVlIDogbnVsbDtcbiAgfVxuXG4gIHZhciBmcmVlRXhwb3J0cyA9IChvYmplY3RUeXBlc1t0eXBlb2YgZXhwb3J0c10gJiYgZXhwb3J0cyAmJiAhZXhwb3J0cy5ub2RlVHlwZSkgPyBleHBvcnRzIDogbnVsbDtcbiAgdmFyIGZyZWVNb2R1bGUgPSAob2JqZWN0VHlwZXNbdHlwZW9mIG1vZHVsZV0gJiYgbW9kdWxlICYmICFtb2R1bGUubm9kZVR5cGUpID8gbW9kdWxlIDogbnVsbDtcbiAgdmFyIGZyZWVHbG9iYWwgPSBjaGVja0dsb2JhbChmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlICYmIHR5cGVvZiBnbG9iYWwgPT09ICdvYmplY3QnICYmIGdsb2JhbCk7XG4gIHZhciBmcmVlU2VsZiA9IGNoZWNrR2xvYmFsKG9iamVjdFR5cGVzW3R5cGVvZiBzZWxmXSAmJiBzZWxmKTtcbiAgdmFyIGZyZWVXaW5kb3cgPSBjaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2Ygd2luZG93XSAmJiB3aW5kb3cpO1xuICB2YXIgbW9kdWxlRXhwb3J0cyA9IChmcmVlTW9kdWxlICYmIGZyZWVNb2R1bGUuZXhwb3J0cyA9PT0gZnJlZUV4cG9ydHMpID8gZnJlZUV4cG9ydHMgOiBudWxsO1xuICB2YXIgdGhpc0dsb2JhbCA9IGNoZWNrR2xvYmFsKG9iamVjdFR5cGVzW3R5cGVvZiB0aGlzXSAmJiB0aGlzKTtcbiAgdmFyIHJvb3QgPSBmcmVlR2xvYmFsIHx8ICgoZnJlZVdpbmRvdyAhPT0gKHRoaXNHbG9iYWwgJiYgdGhpc0dsb2JhbC53aW5kb3cpKSAmJiBmcmVlV2luZG93KSB8fCBmcmVlU2VsZiB8fCB0aGlzR2xvYmFsIHx8IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cbiAgdmFyIFJ4ID0ge1xuICAgIGludGVybmFsczoge30sXG4gICAgY29uZmlnOiB7XG4gICAgICBQcm9taXNlOiByb290LlByb21pc2VcbiAgICB9LFxuICAgIGhlbHBlcnM6IHsgfVxuICB9O1xuXG4gIC8vIERlZmF1bHRzXG4gIHZhciBub29wID0gUnguaGVscGVycy5ub29wID0gZnVuY3Rpb24gKCkgeyB9LFxuICAgIGlkZW50aXR5ID0gUnguaGVscGVycy5pZGVudGl0eSA9IGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9LFxuICAgIGRlZmF1bHROb3cgPSBSeC5oZWxwZXJzLmRlZmF1bHROb3cgPSBEYXRlLm5vdyxcbiAgICBkZWZhdWx0Q29tcGFyZXIgPSBSeC5oZWxwZXJzLmRlZmF1bHRDb21wYXJlciA9IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiBpc0VxdWFsKHgsIHkpOyB9LFxuICAgIGRlZmF1bHRTdWJDb21wYXJlciA9IFJ4LmhlbHBlcnMuZGVmYXVsdFN1YkNvbXBhcmVyID0gZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIHggPiB5ID8gMSA6ICh4IDwgeSA/IC0xIDogMCk7IH0sXG4gICAgZGVmYXVsdEtleVNlcmlhbGl6ZXIgPSBSeC5oZWxwZXJzLmRlZmF1bHRLZXlTZXJpYWxpemVyID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgudG9TdHJpbmcoKTsgfSxcbiAgICBkZWZhdWx0RXJyb3IgPSBSeC5oZWxwZXJzLmRlZmF1bHRFcnJvciA9IGZ1bmN0aW9uIChlcnIpIHsgdGhyb3cgZXJyOyB9LFxuICAgIGlzUHJvbWlzZSA9IFJ4LmhlbHBlcnMuaXNQcm9taXNlID0gZnVuY3Rpb24gKHApIHsgcmV0dXJuICEhcCAmJiB0eXBlb2YgcC5zdWJzY3JpYmUgIT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIHAudGhlbiA9PT0gJ2Z1bmN0aW9uJzsgfSxcbiAgICBpc0Z1bmN0aW9uID0gUnguaGVscGVycy5pc0Z1bmN0aW9uID0gKGZ1bmN0aW9uICgpIHtcblxuICAgICAgdmFyIGlzRm4gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnZnVuY3Rpb24nIHx8IGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyBmYWxsYmFjayBmb3Igb2xkZXIgdmVyc2lvbnMgb2YgQ2hyb21lIGFuZCBTYWZhcmlcbiAgICAgIGlmIChpc0ZuKC94LykpIHtcbiAgICAgICAgaXNGbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnZnVuY3Rpb24nICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBpc0ZuO1xuICAgIH0oKSk7XG5cbiAgICBmdW5jdGlvbiBjbG9uZUFycmF5KGFycikge1xuICAgICAgdmFyIGxlbiA9IGFyci5sZW5ndGgsIGEgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhW2ldID0gYXJyW2ldOyB9XG4gICAgICByZXR1cm4gYTtcbiAgICB9XG5cbiAgdmFyIGVycm9yT2JqID0ge2U6IHt9fTtcbiAgXG4gIGZ1bmN0aW9uIHRyeUNhdGNoZXJHZW4odHJ5Q2F0Y2hUYXJnZXQpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gdHJ5Q2F0Y2hlcigpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiB0cnlDYXRjaFRhcmdldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBlcnJvck9iai5lID0gZTtcbiAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICB2YXIgdHJ5Q2F0Y2ggPSBSeC5pbnRlcm5hbHMudHJ5Q2F0Y2ggPSBmdW5jdGlvbiB0cnlDYXRjaChmbikge1xuICAgIGlmICghaXNGdW5jdGlvbihmbikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignZm4gbXVzdCBiZSBhIGZ1bmN0aW9uJyk7IH1cbiAgICByZXR1cm4gdHJ5Q2F0Y2hlckdlbihmbik7XG4gIH07XG5cbiAgZnVuY3Rpb24gdGhyb3dlcihlKSB7XG4gICAgdGhyb3cgZTtcbiAgfVxuXG4gIFJ4LmNvbmZpZy5sb25nU3RhY2tTdXBwb3J0ID0gZmFsc2U7XG4gIHZhciBoYXNTdGFja3MgPSBmYWxzZSwgc3RhY2tzID0gdHJ5Q2F0Y2goZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgRXJyb3IoKTsgfSkoKTtcbiAgaGFzU3RhY2tzID0gISFzdGFja3MuZSAmJiAhIXN0YWNrcy5lLnN0YWNrO1xuXG4gIC8vIEFsbCBjb2RlIGFmdGVyIHRoaXMgcG9pbnQgd2lsbCBiZSBmaWx0ZXJlZCBmcm9tIHN0YWNrIHRyYWNlcyByZXBvcnRlZCBieSBSeEpTXG4gIHZhciByU3RhcnRpbmdMaW5lID0gY2FwdHVyZUxpbmUoKSwgckZpbGVOYW1lO1xuXG4gIHZhciBTVEFDS19KVU1QX1NFUEFSQVRPUiA9ICdGcm9tIHByZXZpb3VzIGV2ZW50Oic7XG5cbiAgZnVuY3Rpb24gbWFrZVN0YWNrVHJhY2VMb25nKGVycm9yLCBvYnNlcnZhYmxlKSB7XG4gICAgLy8gSWYgcG9zc2libGUsIHRyYW5zZm9ybSB0aGUgZXJyb3Igc3RhY2sgdHJhY2UgYnkgcmVtb3ZpbmcgTm9kZSBhbmQgUnhKU1xuICAgIC8vIGNydWZ0LCB0aGVuIGNvbmNhdGVuYXRpbmcgd2l0aCB0aGUgc3RhY2sgdHJhY2Ugb2YgYG9ic2VydmFibGVgLlxuICAgIGlmIChoYXNTdGFja3MgJiZcbiAgICAgICAgb2JzZXJ2YWJsZS5zdGFjayAmJlxuICAgICAgICB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnICYmXG4gICAgICAgIGVycm9yICE9PSBudWxsICYmXG4gICAgICAgIGVycm9yLnN0YWNrICYmXG4gICAgICAgIGVycm9yLnN0YWNrLmluZGV4T2YoU1RBQ0tfSlVNUF9TRVBBUkFUT1IpID09PSAtMVxuICAgICkge1xuICAgICAgdmFyIHN0YWNrcyA9IFtdO1xuICAgICAgZm9yICh2YXIgbyA9IG9ic2VydmFibGU7ICEhbzsgbyA9IG8uc291cmNlKSB7XG4gICAgICAgIGlmIChvLnN0YWNrKSB7XG4gICAgICAgICAgc3RhY2tzLnVuc2hpZnQoby5zdGFjayk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHN0YWNrcy51bnNoaWZ0KGVycm9yLnN0YWNrKTtcblxuICAgICAgdmFyIGNvbmNhdGVkU3RhY2tzID0gc3RhY2tzLmpvaW4oJ1xcbicgKyBTVEFDS19KVU1QX1NFUEFSQVRPUiArICdcXG4nKTtcbiAgICAgIGVycm9yLnN0YWNrID0gZmlsdGVyU3RhY2tTdHJpbmcoY29uY2F0ZWRTdGFja3MpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbHRlclN0YWNrU3RyaW5nKHN0YWNrU3RyaW5nKSB7XG4gICAgdmFyIGxpbmVzID0gc3RhY2tTdHJpbmcuc3BsaXQoJ1xcbicpLCBkZXNpcmVkTGluZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbGluZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHZhciBsaW5lID0gbGluZXNbaV07XG5cbiAgICAgIGlmICghaXNJbnRlcm5hbEZyYW1lKGxpbmUpICYmICFpc05vZGVGcmFtZShsaW5lKSAmJiBsaW5lKSB7XG4gICAgICAgIGRlc2lyZWRMaW5lcy5wdXNoKGxpbmUpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGVzaXJlZExpbmVzLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNJbnRlcm5hbEZyYW1lKHN0YWNrTGluZSkge1xuICAgIHZhciBmaWxlTmFtZUFuZExpbmVOdW1iZXIgPSBnZXRGaWxlTmFtZUFuZExpbmVOdW1iZXIoc3RhY2tMaW5lKTtcbiAgICBpZiAoIWZpbGVOYW1lQW5kTGluZU51bWJlcikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB2YXIgZmlsZU5hbWUgPSBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMF0sIGxpbmVOdW1iZXIgPSBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMV07XG5cbiAgICByZXR1cm4gZmlsZU5hbWUgPT09IHJGaWxlTmFtZSAmJlxuICAgICAgbGluZU51bWJlciA+PSByU3RhcnRpbmdMaW5lICYmXG4gICAgICBsaW5lTnVtYmVyIDw9IHJFbmRpbmdMaW5lO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNOb2RlRnJhbWUoc3RhY2tMaW5lKSB7XG4gICAgcmV0dXJuIHN0YWNrTGluZS5pbmRleE9mKCcobW9kdWxlLmpzOicpICE9PSAtMSB8fFxuICAgICAgc3RhY2tMaW5lLmluZGV4T2YoJyhub2RlLmpzOicpICE9PSAtMTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNhcHR1cmVMaW5lKCkge1xuICAgIGlmICghaGFzU3RhY2tzKSB7IHJldHVybjsgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHZhciBsaW5lcyA9IGUuc3RhY2suc3BsaXQoJ1xcbicpO1xuICAgICAgdmFyIGZpcnN0TGluZSA9IGxpbmVzWzBdLmluZGV4T2YoJ0AnKSA+IDAgPyBsaW5lc1sxXSA6IGxpbmVzWzJdO1xuICAgICAgdmFyIGZpbGVOYW1lQW5kTGluZU51bWJlciA9IGdldEZpbGVOYW1lQW5kTGluZU51bWJlcihmaXJzdExpbmUpO1xuICAgICAgaWYgKCFmaWxlTmFtZUFuZExpbmVOdW1iZXIpIHsgcmV0dXJuOyB9XG5cbiAgICAgIHJGaWxlTmFtZSA9IGZpbGVOYW1lQW5kTGluZU51bWJlclswXTtcbiAgICAgIHJldHVybiBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMV07XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0RmlsZU5hbWVBbmRMaW5lTnVtYmVyKHN0YWNrTGluZSkge1xuICAgIC8vIE5hbWVkIGZ1bmN0aW9uczogJ2F0IGZ1bmN0aW9uTmFtZSAoZmlsZW5hbWU6bGluZU51bWJlcjpjb2x1bW5OdW1iZXIpJ1xuICAgIHZhciBhdHRlbXB0MSA9IC9hdCAuKyBcXCgoLispOihcXGQrKTooPzpcXGQrKVxcKSQvLmV4ZWMoc3RhY2tMaW5lKTtcbiAgICBpZiAoYXR0ZW1wdDEpIHsgcmV0dXJuIFthdHRlbXB0MVsxXSwgTnVtYmVyKGF0dGVtcHQxWzJdKV07IH1cblxuICAgIC8vIEFub255bW91cyBmdW5jdGlvbnM6ICdhdCBmaWxlbmFtZTpsaW5lTnVtYmVyOmNvbHVtbk51bWJlcidcbiAgICB2YXIgYXR0ZW1wdDIgPSAvYXQgKFteIF0rKTooXFxkKyk6KD86XFxkKykkLy5leGVjKHN0YWNrTGluZSk7XG4gICAgaWYgKGF0dGVtcHQyKSB7IHJldHVybiBbYXR0ZW1wdDJbMV0sIE51bWJlcihhdHRlbXB0MlsyXSldOyB9XG5cbiAgICAvLyBGaXJlZm94IHN0eWxlOiAnZnVuY3Rpb25AZmlsZW5hbWU6bGluZU51bWJlciBvciBAZmlsZW5hbWU6bGluZU51bWJlcidcbiAgICB2YXIgYXR0ZW1wdDMgPSAvLipAKC4rKTooXFxkKykkLy5leGVjKHN0YWNrTGluZSk7XG4gICAgaWYgKGF0dGVtcHQzKSB7IHJldHVybiBbYXR0ZW1wdDNbMV0sIE51bWJlcihhdHRlbXB0M1syXSldOyB9XG4gIH1cblxuICB2YXIgRW1wdHlFcnJvciA9IFJ4LkVtcHR5RXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSAnU2VxdWVuY2UgY29udGFpbnMgbm8gZWxlbWVudHMuJztcbiAgICBFcnJvci5jYWxsKHRoaXMpO1xuICB9O1xuICBFbXB0eUVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgRW1wdHlFcnJvci5wcm90b3R5cGUubmFtZSA9ICdFbXB0eUVycm9yJztcblxuICB2YXIgT2JqZWN0RGlzcG9zZWRFcnJvciA9IFJ4Lk9iamVjdERpc3Bvc2VkRXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSAnT2JqZWN0IGhhcyBiZWVuIGRpc3Bvc2VkJztcbiAgICBFcnJvci5jYWxsKHRoaXMpO1xuICB9O1xuICBPYmplY3REaXNwb3NlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgT2JqZWN0RGlzcG9zZWRFcnJvci5wcm90b3R5cGUubmFtZSA9ICdPYmplY3REaXNwb3NlZEVycm9yJztcblxuICB2YXIgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IgPSBSeC5Bcmd1bWVudE91dE9mUmFuZ2VFcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSAnQXJndW1lbnQgb3V0IG9mIHJhbmdlJztcbiAgICBFcnJvci5jYWxsKHRoaXMpO1xuICB9O1xuICBBcmd1bWVudE91dE9mUmFuZ2VFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG4gIEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yLnByb3RvdHlwZS5uYW1lID0gJ0FyZ3VtZW50T3V0T2ZSYW5nZUVycm9yJztcblxuICB2YXIgTm90U3VwcG9ydGVkRXJyb3IgPSBSeC5Ob3RTdXBwb3J0ZWRFcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVGhpcyBvcGVyYXRpb24gaXMgbm90IHN1cHBvcnRlZCc7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgTm90U3VwcG9ydGVkRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuICBOb3RTdXBwb3J0ZWRFcnJvci5wcm90b3R5cGUubmFtZSA9ICdOb3RTdXBwb3J0ZWRFcnJvcic7XG5cbiAgdmFyIE5vdEltcGxlbWVudGVkRXJyb3IgPSBSeC5Ob3RJbXBsZW1lbnRlZEVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlIHx8ICdUaGlzIG9wZXJhdGlvbiBpcyBub3QgaW1wbGVtZW50ZWQnO1xuICAgIEVycm9yLmNhbGwodGhpcyk7XG4gIH07XG4gIE5vdEltcGxlbWVudGVkRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuICBOb3RJbXBsZW1lbnRlZEVycm9yLnByb3RvdHlwZS5uYW1lID0gJ05vdEltcGxlbWVudGVkRXJyb3InO1xuXG4gIHZhciBub3RJbXBsZW1lbnRlZCA9IFJ4LmhlbHBlcnMubm90SW1wbGVtZW50ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXJyb3IoKTtcbiAgfTtcblxuICB2YXIgbm90U3VwcG9ydGVkID0gUnguaGVscGVycy5ub3RTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhyb3cgbmV3IE5vdFN1cHBvcnRlZEVycm9yKCk7XG4gIH07XG5cbiAgLy8gU2hpbSBpbiBpdGVyYXRvciBzdXBwb3J0XG4gIHZhciAkaXRlcmF0b3IkID0gKHR5cGVvZiBTeW1ib2wgPT09ICdmdW5jdGlvbicgJiYgU3ltYm9sLml0ZXJhdG9yKSB8fFxuICAgICdfZXM2c2hpbV9pdGVyYXRvcl8nO1xuICAvLyBCdWcgZm9yIG1vemlsbGEgdmVyc2lvblxuICBpZiAocm9vdC5TZXQgJiYgdHlwZW9mIG5ldyByb290LlNldCgpWydAQGl0ZXJhdG9yJ10gPT09ICdmdW5jdGlvbicpIHtcbiAgICAkaXRlcmF0b3IkID0gJ0BAaXRlcmF0b3InO1xuICB9XG5cbiAgdmFyIGRvbmVFbnVtZXJhdG9yID0gUnguZG9uZUVudW1lcmF0b3IgPSB7IGRvbmU6IHRydWUsIHZhbHVlOiB1bmRlZmluZWQgfTtcblxuICB2YXIgaXNJdGVyYWJsZSA9IFJ4LmhlbHBlcnMuaXNJdGVyYWJsZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgcmV0dXJuIG8gJiYgb1skaXRlcmF0b3IkXSAhPT0gdW5kZWZpbmVkO1xuICB9O1xuXG4gIHZhciBpc0FycmF5TGlrZSA9IFJ4LmhlbHBlcnMuaXNBcnJheUxpa2UgPSBmdW5jdGlvbiAobykge1xuICAgIHJldHVybiBvICYmIG8ubGVuZ3RoICE9PSB1bmRlZmluZWQ7XG4gIH07XG5cbiAgUnguaGVscGVycy5pdGVyYXRvciA9ICRpdGVyYXRvciQ7XG5cbiAgdmFyIGJpbmRDYWxsYmFjayA9IFJ4LmludGVybmFscy5iaW5kQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZnVuYywgdGhpc0FyZywgYXJnQ291bnQpIHtcbiAgICBpZiAodHlwZW9mIHRoaXNBcmcgPT09ICd1bmRlZmluZWQnKSB7IHJldHVybiBmdW5jOyB9XG4gICAgc3dpdGNoKGFyZ0NvdW50KSB7XG4gICAgICBjYXNlIDA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcpXG4gICAgICAgIH07XG4gICAgICBjYXNlIDE6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihhcmcpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIGFyZyk7XG4gICAgICAgIH1cbiAgICAgIGNhc2UgMjpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkge1xuICAgICAgICAgIHJldHVybiBmdW5jLmNhbGwodGhpc0FyZywgdmFsdWUsIGluZGV4KTtcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICAgIHJldHVybiBmdW5jLmNhbGwodGhpc0FyZywgdmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzQXJnLCBhcmd1bWVudHMpO1xuICAgIH07XG4gIH07XG5cbiAgLyoqIFVzZWQgdG8gZGV0ZXJtaW5lIGlmIHZhbHVlcyBhcmUgb2YgdGhlIGxhbmd1YWdlIHR5cGUgT2JqZWN0ICovXG4gIHZhciBkb250RW51bXMgPSBbJ3RvU3RyaW5nJyxcbiAgICAndG9Mb2NhbGVTdHJpbmcnLFxuICAgICd2YWx1ZU9mJyxcbiAgICAnaGFzT3duUHJvcGVydHknLFxuICAgICdpc1Byb3RvdHlwZU9mJyxcbiAgICAncHJvcGVydHlJc0VudW1lcmFibGUnLFxuICAgICdjb25zdHJ1Y3RvciddLFxuICBkb250RW51bXNMZW5ndGggPSBkb250RW51bXMubGVuZ3RoO1xuXG4gIC8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgc2hvcnRjdXRzICovXG4gIHZhciBhcmdzQ2xhc3MgPSAnW29iamVjdCBBcmd1bWVudHNdJyxcbiAgICBhcnJheUNsYXNzID0gJ1tvYmplY3QgQXJyYXldJyxcbiAgICBib29sQ2xhc3MgPSAnW29iamVjdCBCb29sZWFuXScsXG4gICAgZGF0ZUNsYXNzID0gJ1tvYmplY3QgRGF0ZV0nLFxuICAgIGVycm9yQ2xhc3MgPSAnW29iamVjdCBFcnJvcl0nLFxuICAgIGZ1bmNDbGFzcyA9ICdbb2JqZWN0IEZ1bmN0aW9uXScsXG4gICAgbnVtYmVyQ2xhc3MgPSAnW29iamVjdCBOdW1iZXJdJyxcbiAgICBvYmplY3RDbGFzcyA9ICdbb2JqZWN0IE9iamVjdF0nLFxuICAgIHJlZ2V4cENsYXNzID0gJ1tvYmplY3QgUmVnRXhwXScsXG4gICAgc3RyaW5nQ2xhc3MgPSAnW29iamVjdCBTdHJpbmddJztcblxuICB2YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLFxuICAgIGhhc093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxcbiAgICBzdXBwb3J0c0FyZ3NDbGFzcyA9IHRvU3RyaW5nLmNhbGwoYXJndW1lbnRzKSA9PSBhcmdzQ2xhc3MsIC8vIEZvciBsZXNzIDxJRTkgJiYgRkY8NFxuICAgIHN1cHBvcnROb2RlQ2xhc3MsXG4gICAgZXJyb3JQcm90byA9IEVycm9yLnByb3RvdHlwZSxcbiAgICBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGUsXG4gICAgc3RyaW5nUHJvdG8gPSBTdHJpbmcucHJvdG90eXBlLFxuICAgIHByb3BlcnR5SXNFbnVtZXJhYmxlID0gb2JqZWN0UHJvdG8ucHJvcGVydHlJc0VudW1lcmFibGU7XG5cbiAgdHJ5IHtcbiAgICBzdXBwb3J0Tm9kZUNsYXNzID0gISh0b1N0cmluZy5jYWxsKGRvY3VtZW50KSA9PSBvYmplY3RDbGFzcyAmJiAhKHsgJ3RvU3RyaW5nJzogMCB9ICsgJycpKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHN1cHBvcnROb2RlQ2xhc3MgPSB0cnVlO1xuICB9XG5cbiAgdmFyIG5vbkVudW1Qcm9wcyA9IHt9O1xuICBub25FbnVtUHJvcHNbYXJyYXlDbGFzc10gPSBub25FbnVtUHJvcHNbZGF0ZUNsYXNzXSA9IG5vbkVudW1Qcm9wc1tudW1iZXJDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUsICd0b0xvY2FsZVN0cmluZyc6IHRydWUsICd0b1N0cmluZyc6IHRydWUsICd2YWx1ZU9mJzogdHJ1ZSB9O1xuICBub25FbnVtUHJvcHNbYm9vbENsYXNzXSA9IG5vbkVudW1Qcm9wc1tzdHJpbmdDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUsICd0b1N0cmluZyc6IHRydWUsICd2YWx1ZU9mJzogdHJ1ZSB9O1xuICBub25FbnVtUHJvcHNbZXJyb3JDbGFzc10gPSBub25FbnVtUHJvcHNbZnVuY0NsYXNzXSA9IG5vbkVudW1Qcm9wc1tyZWdleHBDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUsICd0b1N0cmluZyc6IHRydWUgfTtcbiAgbm9uRW51bVByb3BzW29iamVjdENsYXNzXSA9IHsgJ2NvbnN0cnVjdG9yJzogdHJ1ZSB9O1xuXG4gIHZhciBzdXBwb3J0ID0ge307XG4gIChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGN0b3IgPSBmdW5jdGlvbigpIHsgdGhpcy54ID0gMTsgfSxcbiAgICAgIHByb3BzID0gW107XG5cbiAgICBjdG9yLnByb3RvdHlwZSA9IHsgJ3ZhbHVlT2YnOiAxLCAneSc6IDEgfTtcbiAgICBmb3IgKHZhciBrZXkgaW4gbmV3IGN0b3IpIHsgcHJvcHMucHVzaChrZXkpOyB9XG4gICAgZm9yIChrZXkgaW4gYXJndW1lbnRzKSB7IH1cblxuICAgIC8vIERldGVjdCBpZiBgbmFtZWAgb3IgYG1lc3NhZ2VgIHByb3BlcnRpZXMgb2YgYEVycm9yLnByb3RvdHlwZWAgYXJlIGVudW1lcmFibGUgYnkgZGVmYXVsdC5cbiAgICBzdXBwb3J0LmVudW1FcnJvclByb3BzID0gcHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlcnJvclByb3RvLCAnbWVzc2FnZScpIHx8IHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZXJyb3JQcm90bywgJ25hbWUnKTtcblxuICAgIC8vIERldGVjdCBpZiBgcHJvdG90eXBlYCBwcm9wZXJ0aWVzIGFyZSBlbnVtZXJhYmxlIGJ5IGRlZmF1bHQuXG4gICAgc3VwcG9ydC5lbnVtUHJvdG90eXBlcyA9IHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoY3RvciwgJ3Byb3RvdHlwZScpO1xuXG4gICAgLy8gRGV0ZWN0IGlmIGBhcmd1bWVudHNgIG9iamVjdCBpbmRleGVzIGFyZSBub24tZW51bWVyYWJsZVxuICAgIHN1cHBvcnQubm9uRW51bUFyZ3MgPSBrZXkgIT0gMDtcblxuICAgIC8vIERldGVjdCBpZiBwcm9wZXJ0aWVzIHNoYWRvd2luZyB0aG9zZSBvbiBgT2JqZWN0LnByb3RvdHlwZWAgYXJlIG5vbi1lbnVtZXJhYmxlLlxuICAgIHN1cHBvcnQubm9uRW51bVNoYWRvd3MgPSAhL3ZhbHVlT2YvLnRlc3QocHJvcHMpO1xuICB9KDEpKTtcblxuICB2YXIgaXNPYmplY3QgPSBSeC5pbnRlcm5hbHMuaXNPYmplY3QgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuICAgIHJldHVybiB2YWx1ZSAmJiAodHlwZSA9PSAnZnVuY3Rpb24nIHx8IHR5cGUgPT0gJ29iamVjdCcpIHx8IGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGtleXNJbihvYmplY3QpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgaWYgKCFpc09iamVjdChvYmplY3QpKSB7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBpZiAoc3VwcG9ydC5ub25FbnVtQXJncyAmJiBvYmplY3QubGVuZ3RoICYmIGlzQXJndW1lbnRzKG9iamVjdCkpIHtcbiAgICAgIG9iamVjdCA9IHNsaWNlLmNhbGwob2JqZWN0KTtcbiAgICB9XG4gICAgdmFyIHNraXBQcm90byA9IHN1cHBvcnQuZW51bVByb3RvdHlwZXMgJiYgdHlwZW9mIG9iamVjdCA9PSAnZnVuY3Rpb24nLFxuICAgICAgICBza2lwRXJyb3JQcm9wcyA9IHN1cHBvcnQuZW51bUVycm9yUHJvcHMgJiYgKG9iamVjdCA9PT0gZXJyb3JQcm90byB8fCBvYmplY3QgaW5zdGFuY2VvZiBFcnJvcik7XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICBpZiAoIShza2lwUHJvdG8gJiYga2V5ID09ICdwcm90b3R5cGUnKSAmJlxuICAgICAgICAgICEoc2tpcEVycm9yUHJvcHMgJiYgKGtleSA9PSAnbWVzc2FnZScgfHwga2V5ID09ICduYW1lJykpKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHN1cHBvcnQubm9uRW51bVNoYWRvd3MgJiYgb2JqZWN0ICE9PSBvYmplY3RQcm90bykge1xuICAgICAgdmFyIGN0b3IgPSBvYmplY3QuY29uc3RydWN0b3IsXG4gICAgICAgICAgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBkb250RW51bXNMZW5ndGg7XG5cbiAgICAgIGlmIChvYmplY3QgPT09IChjdG9yICYmIGN0b3IucHJvdG90eXBlKSkge1xuICAgICAgICB2YXIgY2xhc3NOYW1lID0gb2JqZWN0ID09PSBzdHJpbmdQcm90byA/IHN0cmluZ0NsYXNzIDogb2JqZWN0ID09PSBlcnJvclByb3RvID8gZXJyb3JDbGFzcyA6IHRvU3RyaW5nLmNhbGwob2JqZWN0KSxcbiAgICAgICAgICAgIG5vbkVudW0gPSBub25FbnVtUHJvcHNbY2xhc3NOYW1lXTtcbiAgICAgIH1cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIGtleSA9IGRvbnRFbnVtc1tpbmRleF07XG4gICAgICAgIGlmICghKG5vbkVudW0gJiYgbm9uRW51bVtrZXldKSAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwga2V5KSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGludGVybmFsRm9yKG9iamVjdCwgY2FsbGJhY2ssIGtleXNGdW5jKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICBwcm9wcyA9IGtleXNGdW5jKG9iamVjdCksXG4gICAgICBsZW5ndGggPSBwcm9wcy5sZW5ndGg7XG5cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgdmFyIGtleSA9IHByb3BzW2luZGV4XTtcbiAgICAgIGlmIChjYWxsYmFjayhvYmplY3Rba2V5XSwga2V5LCBvYmplY3QpID09PSBmYWxzZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9iamVjdDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGludGVybmFsRm9ySW4ob2JqZWN0LCBjYWxsYmFjaykge1xuICAgIHJldHVybiBpbnRlcm5hbEZvcihvYmplY3QsIGNhbGxiYWNrLCBrZXlzSW4pO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNOb2RlKHZhbHVlKSB7XG4gICAgLy8gSUUgPCA5IHByZXNlbnRzIERPTSBub2RlcyBhcyBgT2JqZWN0YCBvYmplY3RzIGV4Y2VwdCB0aGV5IGhhdmUgYHRvU3RyaW5nYFxuICAgIC8vIG1ldGhvZHMgdGhhdCBhcmUgYHR5cGVvZmAgXCJzdHJpbmdcIiBhbmQgc3RpbGwgY2FuIGNvZXJjZSBub2RlcyB0byBzdHJpbmdzXG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZS50b1N0cmluZyAhPSAnZnVuY3Rpb24nICYmIHR5cGVvZiAodmFsdWUgKyAnJykgPT0gJ3N0cmluZyc7XG4gIH1cblxuICB2YXIgaXNBcmd1bWVudHMgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgIHJldHVybiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnKSA/IHRvU3RyaW5nLmNhbGwodmFsdWUpID09IGFyZ3NDbGFzcyA6IGZhbHNlO1xuICB9XG5cbiAgLy8gZmFsbGJhY2sgZm9yIGJyb3dzZXJzIHRoYXQgY2FuJ3QgZGV0ZWN0IGBhcmd1bWVudHNgIG9iamVjdHMgYnkgW1tDbGFzc11dXG4gIGlmICghc3VwcG9ydHNBcmdzQ2xhc3MpIHtcbiAgICBpc0FyZ3VtZW50cyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JykgPyBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCAnY2FsbGVlJykgOiBmYWxzZTtcbiAgICB9O1xuICB9XG5cbiAgdmFyIGlzRXF1YWwgPSBSeC5pbnRlcm5hbHMuaXNFcXVhbCA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgcmV0dXJuIGRlZXBFcXVhbHMoeCwgeSwgW10sIFtdKTtcbiAgfTtcblxuICAvKiogQHByaXZhdGVcbiAgICogVXNlZCBmb3IgZGVlcCBjb21wYXJpc29uXG4gICAqKi9cbiAgZnVuY3Rpb24gZGVlcEVxdWFscyhhLCBiLCBzdGFja0EsIHN0YWNrQikge1xuICAgIC8vIGV4aXQgZWFybHkgZm9yIGlkZW50aWNhbCB2YWx1ZXNcbiAgICBpZiAoYSA9PT0gYikge1xuICAgICAgLy8gdHJlYXQgYCswYCB2cy4gYC0wYCBhcyBub3QgZXF1YWxcbiAgICAgIHJldHVybiBhICE9PSAwIHx8ICgxIC8gYSA9PSAxIC8gYik7XG4gICAgfVxuXG4gICAgdmFyIHR5cGUgPSB0eXBlb2YgYSxcbiAgICAgICAgb3RoZXJUeXBlID0gdHlwZW9mIGI7XG5cbiAgICAvLyBleGl0IGVhcmx5IGZvciB1bmxpa2UgcHJpbWl0aXZlIHZhbHVlc1xuICAgIGlmIChhID09PSBhICYmIChhID09IG51bGwgfHwgYiA9PSBudWxsIHx8XG4gICAgICAgICh0eXBlICE9ICdmdW5jdGlvbicgJiYgdHlwZSAhPSAnb2JqZWN0JyAmJiBvdGhlclR5cGUgIT0gJ2Z1bmN0aW9uJyAmJiBvdGhlclR5cGUgIT0gJ29iamVjdCcpKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIGNvbXBhcmUgW1tDbGFzc11dIG5hbWVzXG4gICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSksXG4gICAgICAgIG90aGVyQ2xhc3MgPSB0b1N0cmluZy5jYWxsKGIpO1xuXG4gICAgaWYgKGNsYXNzTmFtZSA9PSBhcmdzQ2xhc3MpIHtcbiAgICAgIGNsYXNzTmFtZSA9IG9iamVjdENsYXNzO1xuICAgIH1cbiAgICBpZiAob3RoZXJDbGFzcyA9PSBhcmdzQ2xhc3MpIHtcbiAgICAgIG90aGVyQ2xhc3MgPSBvYmplY3RDbGFzcztcbiAgICB9XG4gICAgaWYgKGNsYXNzTmFtZSAhPSBvdGhlckNsYXNzKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICBjYXNlIGJvb2xDbGFzczpcbiAgICAgIGNhc2UgZGF0ZUNsYXNzOlxuICAgICAgICAvLyBjb2VyY2UgZGF0ZXMgYW5kIGJvb2xlYW5zIHRvIG51bWJlcnMsIGRhdGVzIHRvIG1pbGxpc2Vjb25kcyBhbmQgYm9vbGVhbnNcbiAgICAgICAgLy8gdG8gYDFgIG9yIGAwYCB0cmVhdGluZyBpbnZhbGlkIGRhdGVzIGNvZXJjZWQgdG8gYE5hTmAgYXMgbm90IGVxdWFsXG4gICAgICAgIHJldHVybiArYSA9PSArYjtcblxuICAgICAgY2FzZSBudW1iZXJDbGFzczpcbiAgICAgICAgLy8gdHJlYXQgYE5hTmAgdnMuIGBOYU5gIGFzIGVxdWFsXG4gICAgICAgIHJldHVybiAoYSAhPSArYSkgP1xuICAgICAgICAgIGIgIT0gK2IgOlxuICAgICAgICAgIC8vIGJ1dCB0cmVhdCBgLTBgIHZzLiBgKzBgIGFzIG5vdCBlcXVhbFxuICAgICAgICAgIChhID09IDAgPyAoMSAvIGEgPT0gMSAvIGIpIDogYSA9PSArYik7XG5cbiAgICAgIGNhc2UgcmVnZXhwQ2xhc3M6XG4gICAgICBjYXNlIHN0cmluZ0NsYXNzOlxuICAgICAgICAvLyBjb2VyY2UgcmVnZXhlcyB0byBzdHJpbmdzIChodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDE1LjEwLjYuNClcbiAgICAgICAgLy8gdHJlYXQgc3RyaW5nIHByaW1pdGl2ZXMgYW5kIHRoZWlyIGNvcnJlc3BvbmRpbmcgb2JqZWN0IGluc3RhbmNlcyBhcyBlcXVhbFxuICAgICAgICByZXR1cm4gYSA9PSBTdHJpbmcoYik7XG4gICAgfVxuICAgIHZhciBpc0FyciA9IGNsYXNzTmFtZSA9PSBhcnJheUNsYXNzO1xuICAgIGlmICghaXNBcnIpIHtcblxuICAgICAgLy8gZXhpdCBmb3IgZnVuY3Rpb25zIGFuZCBET00gbm9kZXNcbiAgICAgIGlmIChjbGFzc05hbWUgIT0gb2JqZWN0Q2xhc3MgfHwgKCFzdXBwb3J0Lm5vZGVDbGFzcyAmJiAoaXNOb2RlKGEpIHx8IGlzTm9kZShiKSkpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIGluIG9sZGVyIHZlcnNpb25zIG9mIE9wZXJhLCBgYXJndW1lbnRzYCBvYmplY3RzIGhhdmUgYEFycmF5YCBjb25zdHJ1Y3RvcnNcbiAgICAgIHZhciBjdG9yQSA9ICFzdXBwb3J0LmFyZ3NPYmplY3QgJiYgaXNBcmd1bWVudHMoYSkgPyBPYmplY3QgOiBhLmNvbnN0cnVjdG9yLFxuICAgICAgICAgIGN0b3JCID0gIXN1cHBvcnQuYXJnc09iamVjdCAmJiBpc0FyZ3VtZW50cyhiKSA/IE9iamVjdCA6IGIuY29uc3RydWN0b3I7XG5cbiAgICAgIC8vIG5vbiBgT2JqZWN0YCBvYmplY3QgaW5zdGFuY2VzIHdpdGggZGlmZmVyZW50IGNvbnN0cnVjdG9ycyBhcmUgbm90IGVxdWFsXG4gICAgICBpZiAoY3RvckEgIT0gY3RvckIgJiZcbiAgICAgICAgICAgICEoaGFzT3duUHJvcGVydHkuY2FsbChhLCAnY29uc3RydWN0b3InKSAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGIsICdjb25zdHJ1Y3RvcicpKSAmJlxuICAgICAgICAgICAgIShpc0Z1bmN0aW9uKGN0b3JBKSAmJiBjdG9yQSBpbnN0YW5jZW9mIGN0b3JBICYmIGlzRnVuY3Rpb24oY3RvckIpICYmIGN0b3JCIGluc3RhbmNlb2YgY3RvckIpICYmXG4gICAgICAgICAgICAoJ2NvbnN0cnVjdG9yJyBpbiBhICYmICdjb25zdHJ1Y3RvcicgaW4gYilcbiAgICAgICAgICApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICAvLyBhc3N1bWUgY3ljbGljIHN0cnVjdHVyZXMgYXJlIGVxdWFsXG4gICAgLy8gdGhlIGFsZ29yaXRobSBmb3IgZGV0ZWN0aW5nIGN5Y2xpYyBzdHJ1Y3R1cmVzIGlzIGFkYXB0ZWQgZnJvbSBFUyA1LjFcbiAgICAvLyBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gIChodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDE1LjEyLjMpXG4gICAgdmFyIGluaXRlZFN0YWNrID0gIXN0YWNrQTtcbiAgICBzdGFja0EgfHwgKHN0YWNrQSA9IFtdKTtcbiAgICBzdGFja0IgfHwgKHN0YWNrQiA9IFtdKTtcblxuICAgIHZhciBsZW5ndGggPSBzdGFja0EubGVuZ3RoO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgaWYgKHN0YWNrQVtsZW5ndGhdID09IGEpIHtcbiAgICAgICAgcmV0dXJuIHN0YWNrQltsZW5ndGhdID09IGI7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciBzaXplID0gMDtcbiAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcblxuICAgIC8vIGFkZCBgYWAgYW5kIGBiYCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHNcbiAgICBzdGFja0EucHVzaChhKTtcbiAgICBzdGFja0IucHVzaChiKTtcblxuICAgIC8vIHJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyBhbmQgYXJyYXlzIChzdXNjZXB0aWJsZSB0byBjYWxsIHN0YWNrIGxpbWl0cylcbiAgICBpZiAoaXNBcnIpIHtcbiAgICAgIC8vIGNvbXBhcmUgbGVuZ3RocyB0byBkZXRlcm1pbmUgaWYgYSBkZWVwIGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5XG4gICAgICBsZW5ndGggPSBhLmxlbmd0aDtcbiAgICAgIHNpemUgPSBiLmxlbmd0aDtcbiAgICAgIHJlc3VsdCA9IHNpemUgPT0gbGVuZ3RoO1xuXG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIC8vIGRlZXAgY29tcGFyZSB0aGUgY29udGVudHMsIGlnbm9yaW5nIG5vbi1udW1lcmljIHByb3BlcnRpZXNcbiAgICAgICAgd2hpbGUgKHNpemUtLSkge1xuICAgICAgICAgIHZhciBpbmRleCA9IGxlbmd0aCxcbiAgICAgICAgICAgICAgdmFsdWUgPSBiW3NpemVdO1xuXG4gICAgICAgICAgaWYgKCEocmVzdWx0ID0gZGVlcEVxdWFscyhhW3NpemVdLCB2YWx1ZSwgc3RhY2tBLCBzdGFja0IpKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gZGVlcCBjb21wYXJlIG9iamVjdHMgdXNpbmcgYGZvckluYCwgaW5zdGVhZCBvZiBgZm9yT3duYCwgdG8gYXZvaWQgYE9iamVjdC5rZXlzYFxuICAgICAgLy8gd2hpY2gsIGluIHRoaXMgY2FzZSwgaXMgbW9yZSBjb3N0bHlcbiAgICAgIGludGVybmFsRm9ySW4oYiwgZnVuY3Rpb24odmFsdWUsIGtleSwgYikge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChiLCBrZXkpKSB7XG4gICAgICAgICAgLy8gY291bnQgdGhlIG51bWJlciBvZiBwcm9wZXJ0aWVzLlxuICAgICAgICAgIHNpemUrKztcbiAgICAgICAgICAvLyBkZWVwIGNvbXBhcmUgZWFjaCBwcm9wZXJ0eSB2YWx1ZS5cbiAgICAgICAgICByZXR1cm4gKHJlc3VsdCA9IGhhc093blByb3BlcnR5LmNhbGwoYSwga2V5KSAmJiBkZWVwRXF1YWxzKGFba2V5XSwgdmFsdWUsIHN0YWNrQSwgc3RhY2tCKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIC8vIGVuc3VyZSBib3RoIG9iamVjdHMgaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2YgcHJvcGVydGllc1xuICAgICAgICBpbnRlcm5hbEZvckluKGEsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGEpIHtcbiAgICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChhLCBrZXkpKSB7XG4gICAgICAgICAgICAvLyBgc2l6ZWAgd2lsbCBiZSBgLTFgIGlmIGBhYCBoYXMgbW9yZSBwcm9wZXJ0aWVzIHRoYW4gYGJgXG4gICAgICAgICAgICByZXR1cm4gKHJlc3VsdCA9IC0tc2l6ZSA+IC0xKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBzdGFja0EucG9wKCk7XG4gICAgc3RhY2tCLnBvcCgpO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHZhciBoYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXG4gICAgICBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcblxuICB2YXIgaW5oZXJpdHMgPSBSeC5pbnRlcm5hbHMuaW5oZXJpdHMgPSBmdW5jdGlvbiAoY2hpbGQsIHBhcmVudCkge1xuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH1cbiAgICBfXy5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlO1xuICAgIGNoaWxkLnByb3RvdHlwZSA9IG5ldyBfXygpO1xuICB9O1xuXG4gIHZhciBhZGRQcm9wZXJ0aWVzID0gUnguaW50ZXJuYWxzLmFkZFByb3BlcnRpZXMgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgZm9yKHZhciBzb3VyY2VzID0gW10sIGkgPSAxLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsgc291cmNlcy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cbiAgICBmb3IgKHZhciBpZHggPSAwLCBsbiA9IHNvdXJjZXMubGVuZ3RoOyBpZHggPCBsbjsgaWR4KyspIHtcbiAgICAgIHZhciBzb3VyY2UgPSBzb3VyY2VzW2lkeF07XG4gICAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xuICAgICAgICBvYmpbcHJvcF0gPSBzb3VyY2VbcHJvcF07XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIFJ4IFV0aWxzXG4gIHZhciBhZGRSZWYgPSBSeC5pbnRlcm5hbHMuYWRkUmVmID0gZnVuY3Rpb24gKHhzLCByKSB7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHIuZ2V0RGlzcG9zYWJsZSgpLCB4cy5zdWJzY3JpYmUob2JzZXJ2ZXIpKTtcbiAgICB9KTtcbiAgfTtcblxuICBmdW5jdGlvbiBhcnJheUluaXRpYWxpemUoY291bnQsIGZhY3RvcnkpIHtcbiAgICB2YXIgYSA9IG5ldyBBcnJheShjb3VudCk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICBhW2ldID0gZmFjdG9yeSgpO1xuICAgIH1cbiAgICByZXR1cm4gYTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXByZXNlbnRzIGEgZ3JvdXAgb2YgZGlzcG9zYWJsZSByZXNvdXJjZXMgdGhhdCBhcmUgZGlzcG9zZWQgdG9nZXRoZXIuXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKi9cbiAgdmFyIENvbXBvc2l0ZURpc3Bvc2FibGUgPSBSeC5Db21wb3NpdGVEaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBhcmdzID0gW10sIGksIGxlbjtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG4gICAgICBhcmdzID0gYXJndW1lbnRzWzBdO1xuICAgICAgbGVuID0gYXJncy5sZW5ndGg7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICBhcmdzID0gbmV3IEFycmF5KGxlbik7XG4gICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgfVxuICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBhcmdzO1xuICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIHRoaXMubGVuZ3RoID0gYXJncy5sZW5ndGg7XG4gIH07XG5cbiAgdmFyIENvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUgPSBDb21wb3NpdGVEaXNwb3NhYmxlLnByb3RvdHlwZTtcblxuICAvKipcbiAgICogQWRkcyBhIGRpc3Bvc2FibGUgdG8gdGhlIENvbXBvc2l0ZURpc3Bvc2FibGUgb3IgZGlzcG9zZXMgdGhlIGRpc3Bvc2FibGUgaWYgdGhlIENvbXBvc2l0ZURpc3Bvc2FibGUgaXMgZGlzcG9zZWQuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGl0ZW0gRGlzcG9zYWJsZSB0byBhZGQuXG4gICAqL1xuICBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaWYgKHRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgaXRlbS5kaXNwb3NlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGlzcG9zYWJsZXMucHVzaChpdGVtKTtcbiAgICAgIHRoaXMubGVuZ3RoKys7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGFuZCBkaXNwb3NlcyB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBhIGRpc3Bvc2FibGUgZnJvbSB0aGUgQ29tcG9zaXRlRGlzcG9zYWJsZS5cbiAgICogQHBhcmFtIHtNaXhlZH0gaXRlbSBEaXNwb3NhYmxlIHRvIHJlbW92ZS5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgaWYgZm91bmQ7IGZhbHNlIG90aGVyd2lzZS5cbiAgICovXG4gIENvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgc2hvdWxkRGlzcG9zZSA9IGZhbHNlO1xuICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICB2YXIgaWR4ID0gdGhpcy5kaXNwb3NhYmxlcy5pbmRleE9mKGl0ZW0pO1xuICAgICAgaWYgKGlkeCAhPT0gLTEpIHtcbiAgICAgICAgc2hvdWxkRGlzcG9zZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZGlzcG9zYWJsZXMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgIHRoaXMubGVuZ3RoLS07XG4gICAgICAgIGl0ZW0uZGlzcG9zZSgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2hvdWxkRGlzcG9zZTtcbiAgfTtcblxuICAvKipcbiAgICogIERpc3Bvc2VzIGFsbCBkaXNwb3NhYmxlcyBpbiB0aGUgZ3JvdXAgYW5kIHJlbW92ZXMgdGhlbSBmcm9tIHRoZSBncm91cC5cbiAgICovXG4gIENvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIHZhciBsZW4gPSB0aGlzLmRpc3Bvc2FibGVzLmxlbmd0aCwgY3VycmVudERpc3Bvc2FibGVzID0gbmV3IEFycmF5KGxlbik7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgY3VycmVudERpc3Bvc2FibGVzW2ldID0gdGhpcy5kaXNwb3NhYmxlc1tpXTsgfVxuICAgICAgdGhpcy5kaXNwb3NhYmxlcyA9IFtdO1xuICAgICAgdGhpcy5sZW5ndGggPSAwO1xuXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY3VycmVudERpc3Bvc2FibGVzW2ldLmRpc3Bvc2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIGEgc2V0IG9mIHN0YXRpYyBtZXRob2RzIGZvciBjcmVhdGluZyBEaXNwb3NhYmxlcy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZGlzcG9zZSBBY3Rpb24gdG8gcnVuIGR1cmluZyB0aGUgZmlyc3QgY2FsbCB0byBkaXNwb3NlLiBUaGUgYWN0aW9uIGlzIGd1YXJhbnRlZWQgdG8gYmUgcnVuIGF0IG1vc3Qgb25jZS5cbiAgICovXG4gIHZhciBEaXNwb3NhYmxlID0gUnguRGlzcG9zYWJsZSA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbiB8fCBub29wO1xuICB9O1xuXG4gIC8qKiBQZXJmb3JtcyB0aGUgdGFzayBvZiBjbGVhbmluZyB1cCByZXNvdXJjZXMuICovXG4gIERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIHRoaXMuYWN0aW9uKCk7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGRpc3Bvc2FibGUgb2JqZWN0IHRoYXQgaW52b2tlcyB0aGUgc3BlY2lmaWVkIGFjdGlvbiB3aGVuIGRpc3Bvc2VkLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBkaXNwb3NlIEFjdGlvbiB0byBydW4gZHVyaW5nIHRoZSBmaXJzdCBjYWxsIHRvIGRpc3Bvc2UuIFRoZSBhY3Rpb24gaXMgZ3VhcmFudGVlZCB0byBiZSBydW4gYXQgbW9zdCBvbmNlLlxuICAgKiBAcmV0dXJuIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdGhhdCBydW5zIHRoZSBnaXZlbiBhY3Rpb24gdXBvbiBkaXNwb3NhbC5cbiAgICovXG4gIHZhciBkaXNwb3NhYmxlQ3JlYXRlID0gRGlzcG9zYWJsZS5jcmVhdGUgPSBmdW5jdGlvbiAoYWN0aW9uKSB7IHJldHVybiBuZXcgRGlzcG9zYWJsZShhY3Rpb24pOyB9O1xuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBkaXNwb3NhYmxlIHRoYXQgZG9lcyBub3RoaW5nIHdoZW4gZGlzcG9zZWQuXG4gICAqL1xuICB2YXIgZGlzcG9zYWJsZUVtcHR5ID0gRGlzcG9zYWJsZS5lbXB0eSA9IHsgZGlzcG9zZTogbm9vcCB9O1xuXG4gIC8qKlxuICAgKiBWYWxpZGF0ZXMgd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgZGlzcG9zYWJsZVxuICAgKiBAcGFyYW0ge09iamVjdH0gT2JqZWN0IHRvIHRlc3Qgd2hldGhlciBpdCBoYXMgYSBkaXNwb3NlIG1ldGhvZFxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gdHJ1ZSBpZiBhIGRpc3Bvc2FibGUgb2JqZWN0LCBlbHNlIGZhbHNlLlxuICAgKi9cbiAgdmFyIGlzRGlzcG9zYWJsZSA9IERpc3Bvc2FibGUuaXNEaXNwb3NhYmxlID0gZnVuY3Rpb24gKGQpIHtcbiAgICByZXR1cm4gZCAmJiBpc0Z1bmN0aW9uKGQuZGlzcG9zZSk7XG4gIH07XG5cbiAgdmFyIGNoZWNrRGlzcG9zZWQgPSBEaXNwb3NhYmxlLmNoZWNrRGlzcG9zZWQgPSBmdW5jdGlvbiAoZGlzcG9zYWJsZSkge1xuICAgIGlmIChkaXNwb3NhYmxlLmlzRGlzcG9zZWQpIHsgdGhyb3cgbmV3IE9iamVjdERpc3Bvc2VkRXJyb3IoKTsgfVxuICB9O1xuXG4gIHZhciBkaXNwb3NhYmxlRml4dXAgPSBEaXNwb3NhYmxlLl9maXh1cCA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICByZXR1cm4gaXNEaXNwb3NhYmxlKHJlc3VsdCkgPyByZXN1bHQgOiBkaXNwb3NhYmxlRW1wdHk7XG4gIH07XG5cbiAgLy8gU2luZ2xlIGFzc2lnbm1lbnRcbiAgdmFyIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlID0gUnguU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcbiAgfTtcbiAgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUucHJvdG90eXBlLmdldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudDtcbiAgfTtcbiAgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUucHJvdG90eXBlLnNldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICBpZiAodGhpcy5jdXJyZW50KSB7IHRocm93IG5ldyBFcnJvcignRGlzcG9zYWJsZSBoYXMgYWxyZWFkeSBiZWVuIGFzc2lnbmVkJyk7IH1cbiAgICB2YXIgc2hvdWxkRGlzcG9zZSA9IHRoaXMuaXNEaXNwb3NlZDtcbiAgICAhc2hvdWxkRGlzcG9zZSAmJiAodGhpcy5jdXJyZW50ID0gdmFsdWUpO1xuICAgIHNob3VsZERpc3Bvc2UgJiYgdmFsdWUgJiYgdmFsdWUuZGlzcG9zZSgpO1xuICB9O1xuICBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIHZhciBvbGQgPSB0aGlzLmN1cnJlbnQ7XG4gICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuICAgICAgb2xkICYmIG9sZC5kaXNwb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIE11bHRpcGxlIGFzc2lnbm1lbnQgZGlzcG9zYWJsZVxuICB2YXIgU2VyaWFsRGlzcG9zYWJsZSA9IFJ4LlNlcmlhbERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcbiAgfTtcbiAgU2VyaWFsRGlzcG9zYWJsZS5wcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50O1xuICB9O1xuICBTZXJpYWxEaXNwb3NhYmxlLnByb3RvdHlwZS5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgdmFyIHNob3VsZERpc3Bvc2UgPSB0aGlzLmlzRGlzcG9zZWQ7XG4gICAgaWYgKCFzaG91bGREaXNwb3NlKSB7XG4gICAgICB2YXIgb2xkID0gdGhpcy5jdXJyZW50O1xuICAgICAgdGhpcy5jdXJyZW50ID0gdmFsdWU7XG4gICAgfVxuICAgIG9sZCAmJiBvbGQuZGlzcG9zZSgpO1xuICAgIHNob3VsZERpc3Bvc2UgJiYgdmFsdWUgJiYgdmFsdWUuZGlzcG9zZSgpO1xuICB9O1xuICBTZXJpYWxEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgdmFyIG9sZCA9IHRoaXMuY3VycmVudDtcbiAgICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG4gICAgfVxuICAgIG9sZCAmJiBvbGQuZGlzcG9zZSgpO1xuICB9O1xuXG4gIHZhciBCaW5hcnlEaXNwb3NhYmxlID0gUnguQmluYXJ5RGlzcG9zYWJsZSA9IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgdGhpcy5fZmlyc3QgPSBmaXJzdDtcbiAgICB0aGlzLl9zZWNvbmQgPSBzZWNvbmQ7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gIH07XG5cbiAgQmluYXJ5RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIHZhciBvbGQxID0gdGhpcy5fZmlyc3Q7XG4gICAgICB0aGlzLl9maXJzdCA9IG51bGw7XG4gICAgICBvbGQxICYmIG9sZDEuZGlzcG9zZSgpO1xuICAgICAgdmFyIG9sZDIgPSB0aGlzLl9zZWNvbmQ7XG4gICAgICB0aGlzLl9zZWNvbmQgPSBudWxsO1xuICAgICAgb2xkMiAmJiBvbGQyLmRpc3Bvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIE5BcnlEaXNwb3NhYmxlID0gUnguTkFyeURpc3Bvc2FibGUgPSBmdW5jdGlvbiAoZGlzcG9zYWJsZXMpIHtcbiAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IGRpc3Bvc2FibGVzO1xuICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICB9O1xuXG4gIE5BcnlEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2Rpc3Bvc2FibGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzW2ldLmRpc3Bvc2UoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmxlbmd0aCA9IDA7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBSZXByZXNlbnRzIGEgZGlzcG9zYWJsZSByZXNvdXJjZSB0aGF0IG9ubHkgZGlzcG9zZXMgaXRzIHVuZGVybHlpbmcgZGlzcG9zYWJsZSByZXNvdXJjZSB3aGVuIGFsbCBkZXBlbmRlbnQgZGlzcG9zYWJsZSBvYmplY3RzIGhhdmUgYmVlbiBkaXNwb3NlZC5cbiAgICovXG4gIHZhciBSZWZDb3VudERpc3Bvc2FibGUgPSBSeC5SZWZDb3VudERpc3Bvc2FibGUgPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgZnVuY3Rpb24gSW5uZXJEaXNwb3NhYmxlKGRpc3Bvc2FibGUpIHtcbiAgICAgIHRoaXMuZGlzcG9zYWJsZSA9IGRpc3Bvc2FibGU7XG4gICAgICB0aGlzLmRpc3Bvc2FibGUuY291bnQrKztcbiAgICAgIHRoaXMuaXNJbm5lckRpc3Bvc2VkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgSW5uZXJEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCF0aGlzLmRpc3Bvc2FibGUuaXNEaXNwb3NlZCAmJiAhdGhpcy5pc0lubmVyRGlzcG9zZWQpIHtcbiAgICAgICAgdGhpcy5pc0lubmVyRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmRpc3Bvc2FibGUuY291bnQtLTtcbiAgICAgICAgaWYgKHRoaXMuZGlzcG9zYWJsZS5jb3VudCA9PT0gMCAmJiB0aGlzLmRpc3Bvc2FibGUuaXNQcmltYXJ5RGlzcG9zZWQpIHtcbiAgICAgICAgICB0aGlzLmRpc3Bvc2FibGUuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5kaXNwb3NhYmxlLnVuZGVybHlpbmdEaXNwb3NhYmxlLmRpc3Bvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgUmVmQ291bnREaXNwb3NhYmxlIHdpdGggdGhlIHNwZWNpZmllZCBkaXNwb3NhYmxlLlxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7RGlzcG9zYWJsZX0gZGlzcG9zYWJsZSBVbmRlcmx5aW5nIGRpc3Bvc2FibGUuXG4gICAgICAqL1xuICAgIGZ1bmN0aW9uIFJlZkNvdW50RGlzcG9zYWJsZShkaXNwb3NhYmxlKSB7XG4gICAgICB0aGlzLnVuZGVybHlpbmdEaXNwb3NhYmxlID0gZGlzcG9zYWJsZTtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pc1ByaW1hcnlEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5jb3VudCA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGlzcG9zZXMgdGhlIHVuZGVybHlpbmcgZGlzcG9zYWJsZSBvbmx5IHdoZW4gYWxsIGRlcGVuZGVudCBkaXNwb3NhYmxlcyBoYXZlIGJlZW4gZGlzcG9zZWRcbiAgICAgKi9cbiAgICBSZWZDb3VudERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCAmJiAhdGhpcy5pc1ByaW1hcnlEaXNwb3NlZCkge1xuICAgICAgICB0aGlzLmlzUHJpbWFyeURpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMuY291bnQgPT09IDApIHtcbiAgICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMudW5kZXJseWluZ0Rpc3Bvc2FibGUuZGlzcG9zZSgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBkZXBlbmRlbnQgZGlzcG9zYWJsZSB0aGF0IHdoZW4gZGlzcG9zZWQgZGVjcmVhc2VzIHRoZSByZWZjb3VudCBvbiB0aGUgdW5kZXJseWluZyBkaXNwb3NhYmxlLlxuICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBBIGRlcGVuZGVudCBkaXNwb3NhYmxlIGNvbnRyaWJ1dGluZyB0byB0aGUgcmVmZXJlbmNlIGNvdW50IHRoYXQgbWFuYWdlcyB0aGUgdW5kZXJseWluZyBkaXNwb3NhYmxlJ3MgbGlmZXRpbWUuXG4gICAgICovXG4gICAgUmVmQ291bnREaXNwb3NhYmxlLnByb3RvdHlwZS5nZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNEaXNwb3NlZCA/IGRpc3Bvc2FibGVFbXB0eSA6IG5ldyBJbm5lckRpc3Bvc2FibGUodGhpcyk7XG4gICAgfTtcblxuICAgIHJldHVybiBSZWZDb3VudERpc3Bvc2FibGU7XG4gIH0pKCk7XG5cbiAgdmFyIFNjaGVkdWxlZEl0ZW0gPSBSeC5pbnRlcm5hbHMuU2NoZWR1bGVkSXRlbSA9IGZ1bmN0aW9uIChzY2hlZHVsZXIsIHN0YXRlLCBhY3Rpb24sIGR1ZVRpbWUsIGNvbXBhcmVyKSB7XG4gICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgIHRoaXMuYWN0aW9uID0gYWN0aW9uO1xuICAgIHRoaXMuZHVlVGltZSA9IGR1ZVRpbWU7XG4gICAgdGhpcy5jb21wYXJlciA9IGNvbXBhcmVyIHx8IGRlZmF1bHRTdWJDb21wYXJlcjtcbiAgICB0aGlzLmRpc3Bvc2FibGUgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgfVxuXG4gIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmludm9rZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmRpc3Bvc2FibGUuc2V0RGlzcG9zYWJsZSh0aGlzLmludm9rZUNvcmUoKSk7XG4gIH07XG5cbiAgU2NoZWR1bGVkSXRlbS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgcmV0dXJuIHRoaXMuY29tcGFyZXIodGhpcy5kdWVUaW1lLCBvdGhlci5kdWVUaW1lKTtcbiAgfTtcblxuICBTY2hlZHVsZWRJdGVtLnByb3RvdHlwZS5pc0NhbmNlbGxlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5kaXNwb3NhYmxlLmlzRGlzcG9zZWQ7XG4gIH07XG5cbiAgU2NoZWR1bGVkSXRlbS5wcm90b3R5cGUuaW52b2tlQ29yZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZGlzcG9zYWJsZUZpeHVwKHRoaXMuYWN0aW9uKHRoaXMuc2NoZWR1bGVyLCB0aGlzLnN0YXRlKSk7XG4gIH07XG5cbiAgLyoqIFByb3ZpZGVzIGEgc2V0IG9mIHN0YXRpYyBwcm9wZXJ0aWVzIHRvIGFjY2VzcyBjb21tb25seSB1c2VkIHNjaGVkdWxlcnMuICovXG4gIHZhciBTY2hlZHVsZXIgPSBSeC5TY2hlZHVsZXIgPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgZnVuY3Rpb24gU2NoZWR1bGVyKCkgeyB9XG5cbiAgICAvKiogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBnaXZlbiBvYmplY3QgaXMgYSBzY2hlZHVsZXIgKi9cbiAgICBTY2hlZHVsZXIuaXNTY2hlZHVsZXIgPSBmdW5jdGlvbiAocykge1xuICAgICAgcmV0dXJuIHMgaW5zdGFuY2VvZiBTY2hlZHVsZXI7XG4gICAgfTtcblxuICAgIHZhciBzY2hlZHVsZXJQcm90byA9IFNjaGVkdWxlci5wcm90b3R5cGU7XG5cbiAgICAvKipcbiAgICogU2NoZWR1bGVzIGFuIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cbiAgICogQHBhcmFtIHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG4gICAqL1xuICAgIHNjaGVkdWxlclByb3RvLnNjaGVkdWxlID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcbiAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gICAgfTtcblxuICAvKipcbiAgICogU2NoZWR1bGVzIGFuIGFjdGlvbiB0byBiZSBleGVjdXRlZCBhZnRlciBkdWVUaW1lLlxuICAgKiBAcGFyYW0gc3RhdGUgU3RhdGUgcGFzc2VkIHRvIHRoZSBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBkdWVUaW1lIFJlbGF0aXZlIHRpbWUgYWZ0ZXIgd2hpY2ggdG8gZXhlY3V0ZSB0aGUgYWN0aW9uLlxuICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG4gICAqL1xuICAgIHNjaGVkdWxlclByb3RvLnNjaGVkdWxlRnV0dXJlID0gZnVuY3Rpb24gKHN0YXRlLCBkdWVUaW1lLCBhY3Rpb24pIHtcbiAgICAgIHZhciBkdCA9IGR1ZVRpbWU7XG4gICAgICBkdCBpbnN0YW5jZW9mIERhdGUgJiYgKGR0ID0gZHQgLSB0aGlzLm5vdygpKTtcbiAgICAgIGR0ID0gU2NoZWR1bGVyLm5vcm1hbGl6ZShkdCk7XG5cbiAgICAgIGlmIChkdCA9PT0gMCkgeyByZXR1cm4gdGhpcy5zY2hlZHVsZShzdGF0ZSwgYWN0aW9uKTsgfVxuXG4gICAgICByZXR1cm4gdGhpcy5fc2NoZWR1bGVGdXR1cmUoc3RhdGUsIGR0LCBhY3Rpb24pO1xuICAgIH07XG5cbiAgICBzY2hlZHVsZXJQcm90by5fc2NoZWR1bGVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuICAgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXJyb3IoKTtcbiAgICB9O1xuXG4gICAgLyoqIEdldHMgdGhlIGN1cnJlbnQgdGltZSBhY2NvcmRpbmcgdG8gdGhlIGxvY2FsIG1hY2hpbmUncyBzeXN0ZW0gY2xvY2suICovXG4gICAgU2NoZWR1bGVyLm5vdyA9IGRlZmF1bHROb3c7XG5cbiAgICAvKiogR2V0cyB0aGUgY3VycmVudCB0aW1lIGFjY29yZGluZyB0byB0aGUgbG9jYWwgbWFjaGluZSdzIHN5c3RlbSBjbG9jay4gKi9cbiAgICBTY2hlZHVsZXIucHJvdG90eXBlLm5vdyA9IGRlZmF1bHROb3c7XG5cbiAgICAvKipcbiAgICAgKiBOb3JtYWxpemVzIHRoZSBzcGVjaWZpZWQgVGltZVNwYW4gdmFsdWUgdG8gYSBwb3NpdGl2ZSB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gdGltZVNwYW4gVGhlIHRpbWUgc3BhbiB2YWx1ZSB0byBub3JtYWxpemUuXG4gICAgICogQHJldHVybnMge051bWJlcn0gVGhlIHNwZWNpZmllZCBUaW1lU3BhbiB2YWx1ZSBpZiBpdCBpcyB6ZXJvIG9yIHBvc2l0aXZlOyBvdGhlcndpc2UsIDBcbiAgICAgKi9cbiAgICBTY2hlZHVsZXIubm9ybWFsaXplID0gZnVuY3Rpb24gKHRpbWVTcGFuKSB7XG4gICAgICB0aW1lU3BhbiA8IDAgJiYgKHRpbWVTcGFuID0gMCk7XG4gICAgICByZXR1cm4gdGltZVNwYW47XG4gICAgfTtcblxuICAgIHJldHVybiBTY2hlZHVsZXI7XG4gIH0oKSk7XG5cbiAgdmFyIG5vcm1hbGl6ZVRpbWUgPSBTY2hlZHVsZXIubm9ybWFsaXplLCBpc1NjaGVkdWxlciA9IFNjaGVkdWxlci5pc1NjaGVkdWxlcjtcblxuICAoZnVuY3Rpb24gKHNjaGVkdWxlclByb3RvKSB7XG5cbiAgICBmdW5jdGlvbiBpbnZva2VSZWNJbW1lZGlhdGUoc2NoZWR1bGVyLCBwYWlyKSB7XG4gICAgICB2YXIgc3RhdGUgPSBwYWlyWzBdLCBhY3Rpb24gPSBwYWlyWzFdLCBncm91cCA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG4gICAgICBhY3Rpb24oc3RhdGUsIGlubmVyQWN0aW9uKTtcbiAgICAgIHJldHVybiBncm91cDtcblxuICAgICAgZnVuY3Rpb24gaW5uZXJBY3Rpb24oc3RhdGUyKSB7XG4gICAgICAgIHZhciBpc0FkZGVkID0gZmFsc2UsIGlzRG9uZSA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBkID0gc2NoZWR1bGVyLnNjaGVkdWxlKHN0YXRlMiwgc2NoZWR1bGVXb3JrKTtcbiAgICAgICAgaWYgKCFpc0RvbmUpIHtcbiAgICAgICAgICBncm91cC5hZGQoZCk7XG4gICAgICAgICAgaXNBZGRlZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzY2hlZHVsZVdvcmsoXywgc3RhdGUzKSB7XG4gICAgICAgICAgaWYgKGlzQWRkZWQpIHtcbiAgICAgICAgICAgIGdyb3VwLnJlbW92ZShkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWN0aW9uKHN0YXRlMywgaW5uZXJBY3Rpb24pO1xuICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnZva2VSZWNEYXRlKHNjaGVkdWxlciwgcGFpcikge1xuICAgICAgdmFyIHN0YXRlID0gcGFpclswXSwgYWN0aW9uID0gcGFpclsxXSwgZ3JvdXAgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuICAgICAgYWN0aW9uKHN0YXRlLCBpbm5lckFjdGlvbik7XG4gICAgICByZXR1cm4gZ3JvdXA7XG5cbiAgICAgIGZ1bmN0aW9uIGlubmVyQWN0aW9uKHN0YXRlMiwgZHVlVGltZTEpIHtcbiAgICAgICAgdmFyIGlzQWRkZWQgPSBmYWxzZSwgaXNEb25lID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIGQgPSBzY2hlZHVsZXIuc2NoZWR1bGVGdXR1cmUoc3RhdGUyLCBkdWVUaW1lMSwgc2NoZWR1bGVXb3JrKTtcbiAgICAgICAgaWYgKCFpc0RvbmUpIHtcbiAgICAgICAgICBncm91cC5hZGQoZCk7XG4gICAgICAgICAgaXNBZGRlZCA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzY2hlZHVsZVdvcmsoXywgc3RhdGUzKSB7XG4gICAgICAgICAgaWYgKGlzQWRkZWQpIHtcbiAgICAgICAgICAgIGdyb3VwLnJlbW92ZShkKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYWN0aW9uKHN0YXRlMywgaW5uZXJBY3Rpb24pO1xuICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTY2hlZHVsZXMgYW4gYWN0aW9uIHRvIGJlIGV4ZWN1dGVkIHJlY3Vyc2l2ZWx5LlxuICAgICAqIEBwYXJhbSB7TWl4ZWR9IHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gZXhlY3V0ZSByZWN1cnNpdmVseS4gVGhlIGxhc3QgcGFyYW1ldGVyIHBhc3NlZCB0byB0aGUgYWN0aW9uIGlzIHVzZWQgdG8gdHJpZ2dlciByZWN1cnNpdmUgc2NoZWR1bGluZyBvZiB0aGUgYWN0aW9uLCBwYXNzaW5nIGluIHJlY3Vyc2l2ZSBpbnZvY2F0aW9uIHN0YXRlLlxuICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCBhY3Rpb24gKGJlc3QgZWZmb3J0KS5cbiAgICAgKi9cbiAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZVJlY3Vyc2l2ZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG4gICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZShbc3RhdGUsIGFjdGlvbl0sIGludm9rZVJlY0ltbWVkaWF0ZSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQgcmVjdXJzaXZlbHkgYWZ0ZXIgYSBzcGVjaWZpZWQgcmVsYXRpdmUgb3IgYWJzb2x1dGUgZHVlIHRpbWUuXG4gICAgICogQHBhcmFtIHtNaXhlZH0gc3RhdGUgU3RhdGUgcGFzc2VkIHRvIHRoZSBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBleGVjdXRlIHJlY3Vyc2l2ZWx5LiBUaGUgbGFzdCBwYXJhbWV0ZXIgcGFzc2VkIHRvIHRoZSBhY3Rpb24gaXMgdXNlZCB0byB0cmlnZ2VyIHJlY3Vyc2l2ZSBzY2hlZHVsaW5nIG9mIHRoZSBhY3Rpb24sIHBhc3NpbmcgaW4gdGhlIHJlY3Vyc2l2ZSBkdWUgdGltZSBhbmQgaW52b2NhdGlvbiBzdGF0ZS5cbiAgICAgKiBAcGFyYW0ge051bWJlciB8IERhdGV9IGR1ZVRpbWUgUmVsYXRpdmUgb3IgYWJzb2x1dGUgdGltZSBhZnRlciB3aGljaCB0byBleGVjdXRlIHRoZSBhY3Rpb24gZm9yIHRoZSBmaXJzdCB0aW1lLlxuICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCBhY3Rpb24gKGJlc3QgZWZmb3J0KS5cbiAgICAgKi9cbiAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZVJlY3Vyc2l2ZUZ1dHVyZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZHVlVGltZSwgYWN0aW9uKSB7XG4gICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZUZ1dHVyZShbc3RhdGUsIGFjdGlvbl0sIGR1ZVRpbWUsIGludm9rZVJlY0RhdGUpO1xuICAgIH07XG5cbiAgfShTY2hlZHVsZXIucHJvdG90eXBlKSk7XG5cbiAgKGZ1bmN0aW9uIChzY2hlZHVsZXJQcm90bykge1xuXG4gICAgLyoqXG4gICAgICogU2NoZWR1bGVzIGEgcGVyaW9kaWMgcGllY2Ugb2Ygd29yayBieSBkeW5hbWljYWxseSBkaXNjb3ZlcmluZyB0aGUgc2NoZWR1bGVyJ3MgY2FwYWJpbGl0aWVzLiBUaGUgcGVyaW9kaWMgdGFzayB3aWxsIGJlIHNjaGVkdWxlZCB1c2luZyB3aW5kb3cuc2V0SW50ZXJ2YWwgZm9yIHRoZSBiYXNlIGltcGxlbWVudGF0aW9uLlxuICAgICAqIEBwYXJhbSB7TWl4ZWR9IHN0YXRlIEluaXRpYWwgc3RhdGUgcGFzc2VkIHRvIHRoZSBhY3Rpb24gdXBvbiB0aGUgZmlyc3QgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBwZXJpb2QgUGVyaW9kIGZvciBydW5uaW5nIHRoZSB3b3JrIHBlcmlvZGljYWxseS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGJlIGV4ZWN1dGVkLCBwb3RlbnRpYWxseSB1cGRhdGluZyB0aGUgc3RhdGUuXG4gICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIHJlY3VycmluZyBhY3Rpb24gKGJlc3QgZWZmb3J0KS5cbiAgICAgKi9cbiAgICBTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlUGVyaW9kaWMgPSBmdW5jdGlvbihzdGF0ZSwgcGVyaW9kLCBhY3Rpb24pIHtcbiAgICAgIGlmICh0eXBlb2Ygcm9vdC5zZXRJbnRlcnZhbCA9PT0gJ3VuZGVmaW5lZCcpIHsgdGhyb3cgbmV3IE5vdFN1cHBvcnRlZEVycm9yKCk7IH1cbiAgICAgIHBlcmlvZCA9IG5vcm1hbGl6ZVRpbWUocGVyaW9kKTtcbiAgICAgIHZhciBzID0gc3RhdGUsIGlkID0gcm9vdC5zZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7IHMgPSBhY3Rpb24ocyk7IH0sIHBlcmlvZCk7XG4gICAgICByZXR1cm4gZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7IHJvb3QuY2xlYXJJbnRlcnZhbChpZCk7IH0pO1xuICAgIH07XG5cbiAgfShTY2hlZHVsZXIucHJvdG90eXBlKSk7XG5cbiAgLyoqIEdldHMgYSBzY2hlZHVsZXIgdGhhdCBzY2hlZHVsZXMgd29yayBpbW1lZGlhdGVseSBvbiB0aGUgY3VycmVudCB0aHJlYWQuICovXG4gICB2YXIgSW1tZWRpYXRlU2NoZWR1bGVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhJbW1lZGlhdGVTY2hlZHVsZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gSW1tZWRpYXRlU2NoZWR1bGVyKCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSW1tZWRpYXRlU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG4gICAgICByZXR1cm4gZGlzcG9zYWJsZUZpeHVwKGFjdGlvbih0aGlzLCBzdGF0ZSkpO1xuICAgIH07XG5cbiAgICByZXR1cm4gSW1tZWRpYXRlU2NoZWR1bGVyO1xuICB9KFNjaGVkdWxlcikpO1xuXG4gIHZhciBpbW1lZGlhdGVTY2hlZHVsZXIgPSBTY2hlZHVsZXIuaW1tZWRpYXRlID0gbmV3IEltbWVkaWF0ZVNjaGVkdWxlcigpO1xuXG4gIC8qKlxuICAgKiBHZXRzIGEgc2NoZWR1bGVyIHRoYXQgc2NoZWR1bGVzIHdvcmsgYXMgc29vbiBhcyBwb3NzaWJsZSBvbiB0aGUgY3VycmVudCB0aHJlYWQuXG4gICAqL1xuICB2YXIgQ3VycmVudFRocmVhZFNjaGVkdWxlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgdmFyIHF1ZXVlO1xuXG4gICAgZnVuY3Rpb24gcnVuVHJhbXBvbGluZSAoKSB7XG4gICAgICB3aGlsZSAocXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICB2YXIgaXRlbSA9IHF1ZXVlLmRlcXVldWUoKTtcbiAgICAgICAgIWl0ZW0uaXNDYW5jZWxsZWQoKSAmJiBpdGVtLmludm9rZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGluaGVyaXRzKEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ3VycmVudFRocmVhZFNjaGVkdWxlcigpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcbiAgICAgIHZhciBzaSA9IG5ldyBTY2hlZHVsZWRJdGVtKHRoaXMsIHN0YXRlLCBhY3Rpb24sIHRoaXMubm93KCkpO1xuXG4gICAgICBpZiAoIXF1ZXVlKSB7XG4gICAgICAgIHF1ZXVlID0gbmV3IFByaW9yaXR5UXVldWUoNCk7XG4gICAgICAgIHF1ZXVlLmVucXVldWUoc2kpO1xuXG4gICAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaChydW5UcmFtcG9saW5lKSgpO1xuICAgICAgICBxdWV1ZSA9IG51bGw7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHRocm93ZXIocmVzdWx0LmUpOyB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZS5lbnF1ZXVlKHNpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzaS5kaXNwb3NhYmxlO1xuICAgIH07XG5cbiAgICBDdXJyZW50VGhyZWFkU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZVJlcXVpcmVkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gIXF1ZXVlOyB9O1xuXG4gICAgcmV0dXJuIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXI7XG4gIH0oU2NoZWR1bGVyKSk7XG5cbiAgdmFyIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIgPSBTY2hlZHVsZXIuY3VycmVudFRocmVhZCA9IG5ldyBDdXJyZW50VGhyZWFkU2NoZWR1bGVyKCk7XG5cbiAgdmFyIFNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUgPSBSeC5pbnRlcm5hbHMuU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gY3JlYXRlVGljayhzZWxmKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gdGljayhjb21tYW5kLCByZWN1cnNlKSB7XG4gICAgICAgIHJlY3Vyc2UoMCwgc2VsZi5fcGVyaW9kKTtcbiAgICAgICAgdmFyIHN0YXRlID0gdHJ5Q2F0Y2goc2VsZi5fYWN0aW9uKShzZWxmLl9zdGF0ZSk7XG4gICAgICAgIGlmIChzdGF0ZSA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICBzZWxmLl9jYW5jZWwuZGlzcG9zZSgpO1xuICAgICAgICAgIHRocm93ZXIoc3RhdGUuZSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZShzY2hlZHVsZXIsIHN0YXRlLCBwZXJpb2QsIGFjdGlvbikge1xuICAgICAgdGhpcy5fc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgIHRoaXMuX3BlcmlvZCA9IHBlcmlvZDtcbiAgICAgIHRoaXMuX2FjdGlvbiA9IGFjdGlvbjtcbiAgICB9XG5cbiAgICBTY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICB0aGlzLl9jYW5jZWwgPSBkO1xuICAgICAgZC5zZXREaXNwb3NhYmxlKHRoaXMuX3NjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZUZ1dHVyZSgwLCB0aGlzLl9wZXJpb2QsIGNyZWF0ZVRpY2sodGhpcykpKTtcblxuICAgICAgcmV0dXJuIGQ7XG4gICAgfTtcblxuICAgIHJldHVybiBTY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlO1xuICB9KCkpO1xuXG4gIHZhciBzY2hlZHVsZU1ldGhvZCwgY2xlYXJNZXRob2Q7XG5cbiAgdmFyIGxvY2FsVGltZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBsb2NhbFNldFRpbWVvdXQsIGxvY2FsQ2xlYXJUaW1lb3V0ID0gbm9vcDtcbiAgICBpZiAoISFyb290LnNldFRpbWVvdXQpIHtcbiAgICAgIGxvY2FsU2V0VGltZW91dCA9IHJvb3Quc2V0VGltZW91dDtcbiAgICAgIGxvY2FsQ2xlYXJUaW1lb3V0ID0gcm9vdC5jbGVhclRpbWVvdXQ7XG4gICAgfSBlbHNlIGlmICghIXJvb3QuV1NjcmlwdCkge1xuICAgICAgbG9jYWxTZXRUaW1lb3V0ID0gZnVuY3Rpb24gKGZuLCB0aW1lKSB7XG4gICAgICAgIHJvb3QuV1NjcmlwdC5TbGVlcCh0aW1lKTtcbiAgICAgICAgZm4oKTtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcigpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzZXRUaW1lb3V0OiBsb2NhbFNldFRpbWVvdXQsXG4gICAgICBjbGVhclRpbWVvdXQ6IGxvY2FsQ2xlYXJUaW1lb3V0XG4gICAgfTtcbiAgfSgpKTtcbiAgdmFyIGxvY2FsU2V0VGltZW91dCA9IGxvY2FsVGltZXIuc2V0VGltZW91dCxcbiAgICBsb2NhbENsZWFyVGltZW91dCA9IGxvY2FsVGltZXIuY2xlYXJUaW1lb3V0O1xuXG4gIChmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgbmV4dEhhbmRsZSA9IDEsIHRhc2tzQnlIYW5kbGUgPSB7fSwgY3VycmVudGx5UnVubmluZyA9IGZhbHNlO1xuXG4gICAgY2xlYXJNZXRob2QgPSBmdW5jdGlvbiAoaGFuZGxlKSB7XG4gICAgICBkZWxldGUgdGFza3NCeUhhbmRsZVtoYW5kbGVdO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBydW5UYXNrKGhhbmRsZSkge1xuICAgICAgaWYgKGN1cnJlbnRseVJ1bm5pbmcpIHtcbiAgICAgICAgbG9jYWxTZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcnVuVGFzayhoYW5kbGUpOyB9LCAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciB0YXNrID0gdGFza3NCeUhhbmRsZVtoYW5kbGVdO1xuICAgICAgICBpZiAodGFzaykge1xuICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0YXNrKSgpO1xuICAgICAgICAgIGNsZWFyTWV0aG9kKGhhbmRsZSk7XG4gICAgICAgICAgY3VycmVudGx5UnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHRocm93ZXIocmVzdWx0LmUpOyB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgcmVOYXRpdmUgPSBuZXcgUmVnRXhwKCdeJyArXG4gICAgICBTdHJpbmcodG9TdHJpbmcpXG4gICAgICAgIC5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpXG4gICAgICAgIC5yZXBsYWNlKC90b1N0cmluZ3wgZm9yIFteXFxdXSsvZywgJy4qPycpICsgJyQnXG4gICAgKTtcblxuICAgIHZhciBzZXRJbW1lZGlhdGUgPSB0eXBlb2YgKHNldEltbWVkaWF0ZSA9IGZyZWVHbG9iYWwgJiYgbW9kdWxlRXhwb3J0cyAmJiBmcmVlR2xvYmFsLnNldEltbWVkaWF0ZSkgPT0gJ2Z1bmN0aW9uJyAmJlxuICAgICAgIXJlTmF0aXZlLnRlc3Qoc2V0SW1tZWRpYXRlKSAmJiBzZXRJbW1lZGlhdGU7XG5cbiAgICBmdW5jdGlvbiBwb3N0TWVzc2FnZVN1cHBvcnRlZCAoKSB7XG4gICAgICAvLyBFbnN1cmUgbm90IGluIGEgd29ya2VyXG4gICAgICBpZiAoIXJvb3QucG9zdE1lc3NhZ2UgfHwgcm9vdC5pbXBvcnRTY3JpcHRzKSB7IHJldHVybiBmYWxzZTsgfVxuICAgICAgdmFyIGlzQXN5bmMgPSBmYWxzZSwgb2xkSGFuZGxlciA9IHJvb3Qub25tZXNzYWdlO1xuICAgICAgLy8gVGVzdCBmb3IgYXN5bmNcbiAgICAgIHJvb3Qub25tZXNzYWdlID0gZnVuY3Rpb24gKCkgeyBpc0FzeW5jID0gdHJ1ZTsgfTtcbiAgICAgIHJvb3QucG9zdE1lc3NhZ2UoJycsICcqJyk7XG4gICAgICByb290Lm9ubWVzc2FnZSA9IG9sZEhhbmRsZXI7XG5cbiAgICAgIHJldHVybiBpc0FzeW5jO1xuICAgIH1cblxuICAgIC8vIFVzZSBpbiBvcmRlciwgc2V0SW1tZWRpYXRlLCBuZXh0VGljaywgcG9zdE1lc3NhZ2UsIE1lc3NhZ2VDaGFubmVsLCBzY3JpcHQgcmVhZHlzdGF0ZWNoYW5nZWQsIHNldFRpbWVvdXRcbiAgICBpZiAoaXNGdW5jdGlvbihzZXRJbW1lZGlhdGUpKSB7XG4gICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcbiAgICAgICAgc2V0SW1tZWRpYXRlKGZ1bmN0aW9uICgpIHsgcnVuVGFzayhpZCk7IH0pO1xuXG4gICAgICAgIHJldHVybiBpZDtcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYge30udG9TdHJpbmcuY2FsbChwcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nKSB7XG4gICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcbiAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7IHJ1blRhc2soaWQpOyB9KTtcblxuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAocG9zdE1lc3NhZ2VTdXBwb3J0ZWQoKSkge1xuICAgICAgdmFyIE1TR19QUkVGSVggPSAnbXMucnguc2NoZWR1bGUnICsgTWF0aC5yYW5kb20oKTtcblxuICAgICAgdmFyIG9uR2xvYmFsUG9zdE1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gT25seSBpZiB3ZSdyZSBhIG1hdGNoIHRvIGF2b2lkIGFueSBvdGhlciBnbG9iYWwgZXZlbnRzXG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnQuZGF0YSA9PT0gJ3N0cmluZycgJiYgZXZlbnQuZGF0YS5zdWJzdHJpbmcoMCwgTVNHX1BSRUZJWC5sZW5ndGgpID09PSBNU0dfUFJFRklYKSB7XG4gICAgICAgICAgcnVuVGFzayhldmVudC5kYXRhLnN1YnN0cmluZyhNU0dfUFJFRklYLmxlbmd0aCkpO1xuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICByb290LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBvbkdsb2JhbFBvc3RNZXNzYWdlLCBmYWxzZSk7XG5cbiAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG4gICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuICAgICAgICByb290LnBvc3RNZXNzYWdlKE1TR19QUkVGSVggKyBjdXJyZW50SWQsICcqJyk7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmICghIXJvb3QuTWVzc2FnZUNoYW5uZWwpIHtcbiAgICAgIHZhciBjaGFubmVsID0gbmV3IHJvb3QuTWVzc2FnZUNoYW5uZWwoKTtcblxuICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkgeyBydW5UYXNrKGUuZGF0YSk7IH07XG5cbiAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG4gICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuICAgICAgICBjaGFubmVsLnBvcnQyLnBvc3RNZXNzYWdlKGlkKTtcbiAgICAgICAgcmV0dXJuIGlkO1xuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKCdkb2N1bWVudCcgaW4gcm9vdCAmJiAnb25yZWFkeXN0YXRlY2hhbmdlJyBpbiByb290LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpKSB7XG5cbiAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICB2YXIgc2NyaXB0RWxlbWVudCA9IHJvb3QuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcbiAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG5cbiAgICAgICAgc2NyaXB0RWxlbWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcnVuVGFzayhpZCk7XG4gICAgICAgICAgc2NyaXB0RWxlbWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgIHNjcmlwdEVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzY3JpcHRFbGVtZW50KTtcbiAgICAgICAgICBzY3JpcHRFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgcm9vdC5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoc2NyaXB0RWxlbWVudCk7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICAgIH07XG5cbiAgICB9IGVsc2Uge1xuICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcbiAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG4gICAgICAgIGxvY2FsU2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcnVuVGFzayhpZCk7XG4gICAgICAgIH0sIDApO1xuXG4gICAgICAgIHJldHVybiBpZDtcbiAgICAgIH07XG4gICAgfVxuICB9KCkpO1xuXG4gIC8qKlxuICAgKiBHZXRzIGEgc2NoZWR1bGVyIHRoYXQgc2NoZWR1bGVzIHdvcmsgdmlhIGEgdGltZWQgY2FsbGJhY2sgYmFzZWQgdXBvbiBwbGF0Zm9ybS5cbiAgICovXG4gICB2YXIgRGVmYXVsdFNjaGVkdWxlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgIGluaGVyaXRzKERlZmF1bHRTY2hlZHVsZXIsIF9fc3VwZXJfXyk7XG4gICAgIGZ1bmN0aW9uIERlZmF1bHRTY2hlZHVsZXIoKSB7XG4gICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgIH1cblxuICAgICBmdW5jdGlvbiBzY2hlZHVsZUFjdGlvbihkaXNwb3NhYmxlLCBhY3Rpb24sIHNjaGVkdWxlciwgc3RhdGUpIHtcbiAgICAgICByZXR1cm4gZnVuY3Rpb24gc2NoZWR1bGUoKSB7XG4gICAgICAgICAhZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkICYmIGRpc3Bvc2FibGUuc2V0RGlzcG9zYWJsZShEaXNwb3NhYmxlLl9maXh1cChhY3Rpb24oc2NoZWR1bGVyLCBzdGF0ZSkpKTtcbiAgICAgICB9O1xuICAgICB9XG5cbiAgICAgZnVuY3Rpb24gQ2xlYXJEaXNwb3NhYmxlKG1ldGhvZCwgaWQpIHtcbiAgICAgICB0aGlzLl9pZCA9IGlkO1xuICAgICAgIHRoaXMuX21ldGhvZCA9IG1ldGhvZDtcbiAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgfVxuXG4gICAgIENsZWFyRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgIHRoaXMuX21ldGhvZC5jYWxsKG51bGwsIHRoaXMuX2lkKTtcbiAgICAgICB9XG4gICAgIH07XG5cbiAgICBEZWZhdWx0U2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG4gICAgICB2YXIgZGlzcG9zYWJsZSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLFxuICAgICAgICAgIGlkID0gc2NoZWR1bGVNZXRob2Qoc2NoZWR1bGVBY3Rpb24oZGlzcG9zYWJsZSwgYWN0aW9uLCB0aGlzLCBzdGF0ZSkpO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKGRpc3Bvc2FibGUsIG5ldyBDbGVhckRpc3Bvc2FibGUoY2xlYXJNZXRob2QsIGlkKSk7XG4gICAgfTtcblxuICAgIERlZmF1bHRTY2hlZHVsZXIucHJvdG90eXBlLl9zY2hlZHVsZUZ1dHVyZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZHVlVGltZSwgYWN0aW9uKSB7XG4gICAgICBpZiAoZHVlVGltZSA9PT0gMCkgeyByZXR1cm4gdGhpcy5zY2hlZHVsZShzdGF0ZSwgYWN0aW9uKTsgfVxuICAgICAgdmFyIGRpc3Bvc2FibGUgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcbiAgICAgICAgICBpZCA9IGxvY2FsU2V0VGltZW91dChzY2hlZHVsZUFjdGlvbihkaXNwb3NhYmxlLCBhY3Rpb24sIHRoaXMsIHN0YXRlKSwgZHVlVGltZSk7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoZGlzcG9zYWJsZSwgbmV3IENsZWFyRGlzcG9zYWJsZShsb2NhbENsZWFyVGltZW91dCwgaWQpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERlZmF1bHRTY2hlZHVsZXI7XG4gIH0oU2NoZWR1bGVyKSk7XG5cbiAgdmFyIGRlZmF1bHRTY2hlZHVsZXIgPSBTY2hlZHVsZXJbJ2RlZmF1bHQnXSA9IFNjaGVkdWxlci5hc3luYyA9IG5ldyBEZWZhdWx0U2NoZWR1bGVyKCk7XG5cbiAgZnVuY3Rpb24gSW5kZXhlZEl0ZW0oaWQsIHZhbHVlKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxuXG4gIEluZGV4ZWRJdGVtLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICB2YXIgYyA9IHRoaXMudmFsdWUuY29tcGFyZVRvKG90aGVyLnZhbHVlKTtcbiAgICBjID09PSAwICYmIChjID0gdGhpcy5pZCAtIG90aGVyLmlkKTtcbiAgICByZXR1cm4gYztcbiAgfTtcblxuICB2YXIgUHJpb3JpdHlRdWV1ZSA9IFJ4LmludGVybmFscy5Qcmlvcml0eVF1ZXVlID0gZnVuY3Rpb24gKGNhcGFjaXR5KSB7XG4gICAgdGhpcy5pdGVtcyA9IG5ldyBBcnJheShjYXBhY2l0eSk7XG4gICAgdGhpcy5sZW5ndGggPSAwO1xuICB9O1xuXG4gIHZhciBwcmlvcml0eVByb3RvID0gUHJpb3JpdHlRdWV1ZS5wcm90b3R5cGU7XG4gIHByaW9yaXR5UHJvdG8uaXNIaWdoZXJQcmlvcml0eSA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xuICAgIHJldHVybiB0aGlzLml0ZW1zW2xlZnRdLmNvbXBhcmVUbyh0aGlzLml0ZW1zW3JpZ2h0XSkgPCAwO1xuICB9O1xuXG4gIHByaW9yaXR5UHJvdG8ucGVyY29sYXRlID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgaWYgKGluZGV4ID49IHRoaXMubGVuZ3RoIHx8IGluZGV4IDwgMCkgeyByZXR1cm47IH1cbiAgICB2YXIgcGFyZW50ID0gaW5kZXggLSAxID4+IDE7XG4gICAgaWYgKHBhcmVudCA8IDAgfHwgcGFyZW50ID09PSBpbmRleCkgeyByZXR1cm47IH1cbiAgICBpZiAodGhpcy5pc0hpZ2hlclByaW9yaXR5KGluZGV4LCBwYXJlbnQpKSB7XG4gICAgICB2YXIgdGVtcCA9IHRoaXMuaXRlbXNbaW5kZXhdO1xuICAgICAgdGhpcy5pdGVtc1tpbmRleF0gPSB0aGlzLml0ZW1zW3BhcmVudF07XG4gICAgICB0aGlzLml0ZW1zW3BhcmVudF0gPSB0ZW1wO1xuICAgICAgdGhpcy5wZXJjb2xhdGUocGFyZW50KTtcbiAgICB9XG4gIH07XG5cbiAgcHJpb3JpdHlQcm90by5oZWFwaWZ5ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgK2luZGV4IHx8IChpbmRleCA9IDApO1xuICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCB8fCBpbmRleCA8IDApIHsgcmV0dXJuOyB9XG4gICAgdmFyIGxlZnQgPSAyICogaW5kZXggKyAxLFxuICAgICAgICByaWdodCA9IDIgKiBpbmRleCArIDIsXG4gICAgICAgIGZpcnN0ID0gaW5kZXg7XG4gICAgaWYgKGxlZnQgPCB0aGlzLmxlbmd0aCAmJiB0aGlzLmlzSGlnaGVyUHJpb3JpdHkobGVmdCwgZmlyc3QpKSB7XG4gICAgICBmaXJzdCA9IGxlZnQ7XG4gICAgfVxuICAgIGlmIChyaWdodCA8IHRoaXMubGVuZ3RoICYmIHRoaXMuaXNIaWdoZXJQcmlvcml0eShyaWdodCwgZmlyc3QpKSB7XG4gICAgICBmaXJzdCA9IHJpZ2h0O1xuICAgIH1cbiAgICBpZiAoZmlyc3QgIT09IGluZGV4KSB7XG4gICAgICB2YXIgdGVtcCA9IHRoaXMuaXRlbXNbaW5kZXhdO1xuICAgICAgdGhpcy5pdGVtc1tpbmRleF0gPSB0aGlzLml0ZW1zW2ZpcnN0XTtcbiAgICAgIHRoaXMuaXRlbXNbZmlyc3RdID0gdGVtcDtcbiAgICAgIHRoaXMuaGVhcGlmeShmaXJzdCk7XG4gICAgfVxuICB9O1xuXG4gIHByaW9yaXR5UHJvdG8ucGVlayA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuaXRlbXNbMF0udmFsdWU7IH07XG5cbiAgcHJpb3JpdHlQcm90by5yZW1vdmVBdCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gdGhpcy5pdGVtc1stLXRoaXMubGVuZ3RoXTtcbiAgICB0aGlzLml0ZW1zW3RoaXMubGVuZ3RoXSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhlYXBpZnkoKTtcbiAgfTtcblxuICBwcmlvcml0eVByb3RvLmRlcXVldWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHJlc3VsdCA9IHRoaXMucGVlaygpO1xuICAgIHRoaXMucmVtb3ZlQXQoMCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBwcmlvcml0eVByb3RvLmVucXVldWUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBpbmRleCA9IHRoaXMubGVuZ3RoKys7XG4gICAgdGhpcy5pdGVtc1tpbmRleF0gPSBuZXcgSW5kZXhlZEl0ZW0oUHJpb3JpdHlRdWV1ZS5jb3VudCsrLCBpdGVtKTtcbiAgICB0aGlzLnBlcmNvbGF0ZShpbmRleCk7XG4gIH07XG5cbiAgcHJpb3JpdHlQcm90by5yZW1vdmUgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMuaXRlbXNbaV0udmFsdWUgPT09IGl0ZW0pIHtcbiAgICAgICAgdGhpcy5yZW1vdmVBdChpKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbiAgUHJpb3JpdHlRdWV1ZS5jb3VudCA9IDA7XG5cbiAgLyoqXG4gICAqICBSZXByZXNlbnRzIGEgbm90aWZpY2F0aW9uIHRvIGFuIG9ic2VydmVyLlxuICAgKi9cbiAgdmFyIE5vdGlmaWNhdGlvbiA9IFJ4Lk5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTm90aWZpY2F0aW9uKCkge1xuXG4gICAgfVxuXG4gICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0ID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gICAgfTtcblxuICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuICAgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXJyb3IoKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW52b2tlcyB0aGUgZGVsZWdhdGUgY29ycmVzcG9uZGluZyB0byB0aGUgbm90aWZpY2F0aW9uIG9yIHRoZSBvYnNlcnZlcidzIG1ldGhvZCBjb3JyZXNwb25kaW5nIHRvIHRoZSBub3RpZmljYXRpb24gYW5kIHJldHVybnMgdGhlIHByb2R1Y2VkIHJlc3VsdC5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBOb3RpZmljYXRpb25cbiAgICAgKiBAcGFyYW0ge0FueX0gb2JzZXJ2ZXJPck9uTmV4dCBEZWxlZ2F0ZSB0byBpbnZva2UgZm9yIGFuIE9uTmV4dCBub3RpZmljYXRpb24gb3IgT2JzZXJ2ZXIgdG8gaW52b2tlIHRoZSBub3RpZmljYXRpb24gb24uLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRXJyb3IgRGVsZWdhdGUgdG8gaW52b2tlIGZvciBhbiBPbkVycm9yIG5vdGlmaWNhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkNvbXBsZXRlZCBEZWxlZ2F0ZSB0byBpbnZva2UgZm9yIGFuIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7QW55fSBSZXN1bHQgcHJvZHVjZWQgYnkgdGhlIG9ic2VydmF0aW9uLlxuICAgICAqL1xuICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuYWNjZXB0ID0gZnVuY3Rpb24gKG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICByZXR1cm4gb2JzZXJ2ZXJPck9uTmV4dCAmJiB0eXBlb2Ygb2JzZXJ2ZXJPck9uTmV4dCA9PT0gJ29iamVjdCcgP1xuICAgICAgICB0aGlzLl9hY2NlcHRPYnNlcnZhYmxlKG9ic2VydmVyT3JPbk5leHQpIDpcbiAgICAgICAgdGhpcy5fYWNjZXB0KG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggYSBzaW5nbGUgbm90aWZpY2F0aW9uLlxuICAgICAqXG4gICAgICogQG1lbWJlck9mIE5vdGlmaWNhdGlvbnNcbiAgICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHNlbmQgb3V0IHRoZSBub3RpZmljYXRpb24gY2FsbHMgb24uXG4gICAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc3VyZmFjZXMgdGhlIGJlaGF2aW9yIG9mIHRoZSBub3RpZmljYXRpb24gdXBvbiBzdWJzY3JpcHRpb24uXG4gICAgICovXG4gICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS50b09ic2VydmFibGUgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXIpO1xuICAgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIHJldHVybiBzY2hlZHVsZXIuc2NoZWR1bGUoc2VsZiwgZnVuY3Rpb24gKF8sIG5vdGlmaWNhdGlvbikge1xuICAgICAgICAgIG5vdGlmaWNhdGlvbi5fYWNjZXB0T2JzZXJ2YWJsZShvKTtcbiAgICAgICAgICBub3RpZmljYXRpb24ua2luZCA9PT0gJ04nICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE5vdGlmaWNhdGlvbjtcbiAgfSkoKTtcblxuICB2YXIgT25OZXh0Tm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhPbk5leHROb3RpZmljYXRpb24sIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gT25OZXh0Tm90aWZpY2F0aW9uKHZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICB0aGlzLmtpbmQgPSAnTic7XG4gICAgfVxuXG4gICAgT25OZXh0Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0ID0gZnVuY3Rpb24gKG9uTmV4dCkge1xuICAgICAgcmV0dXJuIG9uTmV4dCh0aGlzLnZhbHVlKTtcbiAgICB9O1xuXG4gICAgT25OZXh0Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gby5vbk5leHQodGhpcy52YWx1ZSk7XG4gICAgfTtcblxuICAgIE9uTmV4dE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gJ09uTmV4dCgnICsgdGhpcy52YWx1ZSArICcpJztcbiAgICB9O1xuXG4gICAgcmV0dXJuIE9uTmV4dE5vdGlmaWNhdGlvbjtcbiAgfShOb3RpZmljYXRpb24pKTtcblxuICB2YXIgT25FcnJvck5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoT25FcnJvck5vdGlmaWNhdGlvbiwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBPbkVycm9yTm90aWZpY2F0aW9uKGVycm9yKSB7XG4gICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICB0aGlzLmtpbmQgPSAnRSc7XG4gICAgfVxuXG4gICAgT25FcnJvck5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IpIHtcbiAgICAgIHJldHVybiBvbkVycm9yKHRoaXMuZXJyb3IpO1xuICAgIH07XG5cbiAgICBPbkVycm9yTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuICAgIH07XG5cbiAgICBPbkVycm9yTm90aWZpY2F0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAnT25FcnJvcignICsgdGhpcy5lcnJvciArICcpJztcbiAgICB9O1xuXG4gICAgcmV0dXJuIE9uRXJyb3JOb3RpZmljYXRpb247XG4gIH0oTm90aWZpY2F0aW9uKSk7XG5cbiAgdmFyIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbiwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbigpIHtcbiAgICAgIHRoaXMua2luZCA9ICdDJztcbiAgICB9XG5cbiAgICBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICByZXR1cm4gb25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgT25Db21wbGV0ZWROb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHRPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiBvLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiAnT25Db21wbGV0ZWQoKSc7XG4gICAgfTtcblxuICAgIHJldHVybiBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbjtcbiAgfShOb3RpZmljYXRpb24pKTtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBvYmplY3QgdGhhdCByZXByZXNlbnRzIGFuIE9uTmV4dCBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG4gICAqIEBwYXJhbSB7QW55fSB2YWx1ZSBUaGUgdmFsdWUgY29udGFpbmVkIGluIHRoZSBub3RpZmljYXRpb24uXG4gICAqIEByZXR1cm5zIHtOb3RpZmljYXRpb259IFRoZSBPbk5leHQgbm90aWZpY2F0aW9uIGNvbnRhaW5pbmcgdGhlIHZhbHVlLlxuICAgKi9cbiAgdmFyIG5vdGlmaWNhdGlvbkNyZWF0ZU9uTmV4dCA9IE5vdGlmaWNhdGlvbi5jcmVhdGVPbk5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICByZXR1cm4gbmV3IE9uTmV4dE5vdGlmaWNhdGlvbih2YWx1ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhbiBPbkVycm9yIG5vdGlmaWNhdGlvbiB0byBhbiBvYnNlcnZlci5cbiAgICogQHBhcmFtIHtBbnl9IGVycm9yIFRoZSBleGNlcHRpb24gY29udGFpbmVkIGluIHRoZSBub3RpZmljYXRpb24uXG4gICAqIEByZXR1cm5zIHtOb3RpZmljYXRpb259IFRoZSBPbkVycm9yIG5vdGlmaWNhdGlvbiBjb250YWluaW5nIHRoZSBleGNlcHRpb24uXG4gICAqL1xuICB2YXIgbm90aWZpY2F0aW9uQ3JlYXRlT25FcnJvciA9IE5vdGlmaWNhdGlvbi5jcmVhdGVPbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgcmV0dXJuIG5ldyBPbkVycm9yTm90aWZpY2F0aW9uKGVycm9yKTtcbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBvYmplY3QgdGhhdCByZXByZXNlbnRzIGFuIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbiB0byBhbiBvYnNlcnZlci5cbiAgICogQHJldHVybnMge05vdGlmaWNhdGlvbn0gVGhlIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbi5cbiAgICovXG4gIHZhciBub3RpZmljYXRpb25DcmVhdGVPbkNvbXBsZXRlZCA9IE5vdGlmaWNhdGlvbi5jcmVhdGVPbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IE9uQ29tcGxldGVkTm90aWZpY2F0aW9uKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFN1cHBvcnRzIHB1c2gtc3R5bGUgaXRlcmF0aW9uIG92ZXIgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICovXG4gIHZhciBPYnNlcnZlciA9IFJ4Lk9ic2VydmVyID0gZnVuY3Rpb24gKCkgeyB9O1xuXG4gIC8qKlxuICAgKiAgQ3JlYXRlcyBhbiBvYnNlcnZlciBmcm9tIHRoZSBzcGVjaWZpZWQgT25OZXh0LCBhbG9uZyB3aXRoIG9wdGlvbmFsIE9uRXJyb3IsIGFuZCBPbkNvbXBsZXRlZCBhY3Rpb25zLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25OZXh0XSBPYnNlcnZlcidzIE9uTmV4dCBhY3Rpb24gaW1wbGVtZW50YXRpb24uXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkVycm9yXSBPYnNlcnZlcidzIE9uRXJyb3IgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25Db21wbGV0ZWRdIE9ic2VydmVyJ3MgT25Db21wbGV0ZWQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2ZXJ9IFRoZSBvYnNlcnZlciBvYmplY3QgaW1wbGVtZW50ZWQgdXNpbmcgdGhlIGdpdmVuIGFjdGlvbnMuXG4gICAqL1xuICB2YXIgb2JzZXJ2ZXJDcmVhdGUgPSBPYnNlcnZlci5jcmVhdGUgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuICAgIG9uTmV4dCB8fCAob25OZXh0ID0gbm9vcCk7XG4gICAgb25FcnJvciB8fCAob25FcnJvciA9IGRlZmF1bHRFcnJvcik7XG4gICAgb25Db21wbGV0ZWQgfHwgKG9uQ29tcGxldGVkID0gbm9vcCk7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZlcihvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKTtcbiAgfTtcblxuICAvKipcbiAgICogQWJzdHJhY3QgYmFzZSBjbGFzcyBmb3IgaW1wbGVtZW50YXRpb25zIG9mIHRoZSBPYnNlcnZlciBjbGFzcy5cbiAgICogVGhpcyBiYXNlIGNsYXNzIGVuZm9yY2VzIHRoZSBncmFtbWFyIG9mIG9ic2VydmVycyB3aGVyZSBPbkVycm9yIGFuZCBPbkNvbXBsZXRlZCBhcmUgdGVybWluYWwgbWVzc2FnZXMuXG4gICAqL1xuICB2YXIgQWJzdHJhY3RPYnNlcnZlciA9IFJ4LmludGVybmFscy5BYnN0cmFjdE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBYnN0cmFjdE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBvYnNlcnZlciBpbiBhIG5vbi1zdG9wcGVkIHN0YXRlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEFic3RyYWN0T2JzZXJ2ZXIoKSB7XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8vIE11c3QgYmUgaW1wbGVtZW50ZWQgYnkgb3RoZXIgb2JzZXJ2ZXJzXG4gICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IG5vdEltcGxlbWVudGVkO1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gbm90SW1wbGVtZW50ZWQ7XG4gICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gbm90SW1wbGVtZW50ZWQ7XG5cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyB0aGUgb2JzZXJ2ZXIgb2YgYSBuZXcgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG4gICAgICogQHBhcmFtIHtBbnl9IHZhbHVlIE5leHQgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG4gICAgICovXG4gICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAhdGhpcy5pc1N0b3BwZWQgJiYgdGhpcy5uZXh0KHZhbHVlKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogTm90aWZpZXMgdGhlIG9ic2VydmVyIHRoYXQgYW4gZXhjZXB0aW9uIGhhcyBvY2N1cnJlZC5cbiAgICAgKiBAcGFyYW0ge0FueX0gZXJyb3IgVGhlIGVycm9yIHRoYXQgaGFzIG9jY3VycmVkLlxuICAgICAqL1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmVycm9yKGVycm9yKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogTm90aWZpZXMgdGhlIG9ic2VydmVyIG9mIHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuICAgICAqL1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuY29tcGxldGVkKCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIERpc3Bvc2VzIHRoZSBvYnNlcnZlciwgY2F1c2luZyBpdCB0byB0cmFuc2l0aW9uIHRvIHRoZSBzdG9wcGVkIHN0YXRlLlxuICAgICAqL1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcblxuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZXJyb3IoZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIHJldHVybiBBYnN0cmFjdE9ic2VydmVyO1xuICB9KE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICAqIENsYXNzIHRvIGNyZWF0ZSBhbiBPYnNlcnZlciBpbnN0YW5jZSBmcm9tIGRlbGVnYXRlLWJhc2VkIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgb24qIG1ldGhvZHMuXG4gICAqL1xuICB2YXIgQW5vbnltb3VzT2JzZXJ2ZXIgPSBSeC5Bbm9ueW1vdXNPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQW5vbnltb3VzT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIG9ic2VydmVyIGZyb20gdGhlIHNwZWNpZmllZCBPbk5leHQsIE9uRXJyb3IsIGFuZCBPbkNvbXBsZXRlZCBhY3Rpb25zLlxuICAgICAqIEBwYXJhbSB7QW55fSBvbk5leHQgT2JzZXJ2ZXIncyBPbk5leHQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgICAqIEBwYXJhbSB7QW55fSBvbkVycm9yIE9ic2VydmVyJ3MgT25FcnJvciBhY3Rpb24gaW1wbGVtZW50YXRpb24uXG4gICAgICogQHBhcmFtIHtBbnl9IG9uQ29tcGxldGVkIE9ic2VydmVyJ3MgT25Db21wbGV0ZWQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEFub255bW91c09ic2VydmVyKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5fb25OZXh0ID0gb25OZXh0O1xuICAgICAgdGhpcy5fb25FcnJvciA9IG9uRXJyb3I7XG4gICAgICB0aGlzLl9vbkNvbXBsZXRlZCA9IG9uQ29tcGxldGVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxzIHRoZSBvbk5leHQgYWN0aW9uLlxuICAgICAqIEBwYXJhbSB7QW55fSB2YWx1ZSBOZXh0IGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuICAgICAqL1xuICAgIEFub255bW91c09ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICB0aGlzLl9vbk5leHQodmFsdWUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDYWxscyB0aGUgb25FcnJvciBhY3Rpb24uXG4gICAgICogQHBhcmFtIHtBbnl9IGVycm9yIFRoZSBlcnJvciB0aGF0IGhhcyBvY2N1cnJlZC5cbiAgICAgKi9cbiAgICBBbm9ueW1vdXNPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgIHRoaXMuX29uRXJyb3IoZXJyb3IpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiAgQ2FsbHMgdGhlIG9uQ29tcGxldGVkIGFjdGlvbi5cbiAgICAgKi9cbiAgICBBbm9ueW1vdXNPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fb25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEFub255bW91c09ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICB2YXIgb2JzZXJ2YWJsZVByb3RvO1xuXG4gIC8qKlxuICAgKiBSZXByZXNlbnRzIGEgcHVzaC1zdHlsZSBjb2xsZWN0aW9uLlxuICAgKi9cbiAgdmFyIE9ic2VydmFibGUgPSBSeC5PYnNlcnZhYmxlID0gKGZ1bmN0aW9uICgpIHtcblxuICAgIGZ1bmN0aW9uIG1ha2VTdWJzY3JpYmUoc2VsZiwgc3Vic2NyaWJlKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgdmFyIG9sZE9uRXJyb3IgPSBvLm9uRXJyb3I7XG4gICAgICAgIG8ub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgbWFrZVN0YWNrVHJhY2VMb25nKGUsIHNlbGYpO1xuICAgICAgICAgIG9sZE9uRXJyb3IuY2FsbChvLCBlKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc3Vic2NyaWJlLmNhbGwoc2VsZiwgbyk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIE9ic2VydmFibGUoKSB7XG4gICAgICBpZiAoUnguY29uZmlnLmxvbmdTdGFja1N1cHBvcnQgJiYgaGFzU3RhY2tzKSB7XG4gICAgICAgIHZhciBvbGRTdWJzY3JpYmUgPSB0aGlzLl9zdWJzY3JpYmU7XG4gICAgICAgIHZhciBlID0gdHJ5Q2F0Y2godGhyb3dlcikobmV3IEVycm9yKCkpLmU7XG4gICAgICAgIHRoaXMuc3RhY2sgPSBlLnN0YWNrLnN1YnN0cmluZyhlLnN0YWNrLmluZGV4T2YoJ1xcbicpICsgMSk7XG4gICAgICAgIHRoaXMuX3N1YnNjcmliZSA9IG1ha2VTdWJzY3JpYmUodGhpcywgb2xkU3Vic2NyaWJlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBvYnNlcnZhYmxlUHJvdG8gPSBPYnNlcnZhYmxlLnByb3RvdHlwZTtcblxuICAgIC8qKlxuICAgICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBnaXZlbiBvYmplY3QgaXMgYW4gT2JzZXJ2YWJsZVxuICAgICogQHBhcmFtIHtBbnl9IEFuIG9iamVjdCB0byBkZXRlcm1pbmUgd2hldGhlciBpdCBpcyBhbiBPYnNlcnZhYmxlXG4gICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gdHJ1ZSBpZiBhbiBPYnNlcnZhYmxlLCBlbHNlIGZhbHNlLlxuICAgICovXG4gICAgT2JzZXJ2YWJsZS5pc09ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIG8gJiYgaXNGdW5jdGlvbihvLnN1YnNjcmliZSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqICBTdWJzY3JpYmVzIGFuIG8gdG8gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAgICogIEBwYXJhbSB7TWl4ZWR9IFtvT3JPbk5leHRdIFRoZSBvYmplY3QgdGhhdCBpcyB0byByZWNlaXZlIG5vdGlmaWNhdGlvbnMgb3IgYW4gYWN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgICAqICBAcGFyYW0ge0Z1bmN0aW9ufSBbb25FcnJvcl0gQWN0aW9uIHRvIGludm9rZSB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgICAqICBAcGFyYW0ge0Z1bmN0aW9ufSBbb25Db21wbGV0ZWRdIEFjdGlvbiB0byBpbnZva2UgdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiAgQHJldHVybnMge0RpcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG4gICAgICovXG4gICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZSA9IG9ic2VydmFibGVQcm90by5mb3JFYWNoID0gZnVuY3Rpb24gKG9Pck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUodHlwZW9mIG9Pck9uTmV4dCA9PT0gJ29iamVjdCcgP1xuICAgICAgICBvT3JPbk5leHQgOlxuICAgICAgICBvYnNlcnZlckNyZWF0ZShvT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFN1YnNjcmliZXMgdG8gdGhlIG5leHQgdmFsdWUgaW4gdGhlIHNlcXVlbmNlIHdpdGggYW4gb3B0aW9uYWwgXCJ0aGlzXCIgYXJndW1lbnQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25OZXh0IFRoZSBmdW5jdGlvbiB0byBpbnZva2Ugb24gZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBBIGRpc3Bvc2FibGUgaGFuZGxpbmcgdGhlIHN1YnNjcmlwdGlvbnMgYW5kIHVuc3Vic2NyaXB0aW9ucy5cbiAgICAgKi9cbiAgICBvYnNlcnZhYmxlUHJvdG8uc3Vic2NyaWJlT25OZXh0ID0gZnVuY3Rpb24gKG9uTmV4dCwgdGhpc0FyZykge1xuICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShvYnNlcnZlckNyZWF0ZSh0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbih4KSB7IG9uTmV4dC5jYWxsKHRoaXNBcmcsIHgpOyB9IDogb25OZXh0KSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFN1YnNjcmliZXMgdG8gYW4gZXhjZXB0aW9uYWwgY29uZGl0aW9uIGluIHRoZSBzZXF1ZW5jZSB3aXRoIGFuIG9wdGlvbmFsIFwidGhpc1wiIGFyZ3VtZW50LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRXJyb3IgVGhlIGZ1bmN0aW9uIHRvIGludm9rZSB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBBIGRpc3Bvc2FibGUgaGFuZGxpbmcgdGhlIHN1YnNjcmlwdGlvbnMgYW5kIHVuc3Vic2NyaXB0aW9ucy5cbiAgICAgKi9cbiAgICBvYnNlcnZhYmxlUHJvdG8uc3Vic2NyaWJlT25FcnJvciA9IGZ1bmN0aW9uIChvbkVycm9yLCB0aGlzQXJnKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKG9ic2VydmVyQ3JlYXRlKG51bGwsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uKGUpIHsgb25FcnJvci5jYWxsKHRoaXNBcmcsIGUpOyB9IDogb25FcnJvcikpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmVzIHRvIHRoZSBuZXh0IHZhbHVlIGluIHRoZSBzZXF1ZW5jZSB3aXRoIGFuIG9wdGlvbmFsIFwidGhpc1wiIGFyZ3VtZW50LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uQ29tcGxldGVkIFRoZSBmdW5jdGlvbiB0byBpbnZva2UgdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG4gICAgICovXG4gICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZU9uQ29tcGxldGVkID0gZnVuY3Rpb24gKG9uQ29tcGxldGVkLCB0aGlzQXJnKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKG9ic2VydmVyQ3JlYXRlKG51bGwsIG51bGwsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uKCkgeyBvbkNvbXBsZXRlZC5jYWxsKHRoaXNBcmcpOyB9IDogb25Db21wbGV0ZWQpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE9ic2VydmFibGU7XG4gIH0pKCk7XG5cbiAgdmFyIFNjaGVkdWxlZE9ic2VydmVyID0gUnguaW50ZXJuYWxzLlNjaGVkdWxlZE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTY2hlZHVsZWRPYnNlcnZlciwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIFNjaGVkdWxlZE9ic2VydmVyKHNjaGVkdWxlciwgb2JzZXJ2ZXIpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICB0aGlzLmlzQWNxdWlyZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaGFzRmF1bHRlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgdGhpcy5kaXNwb3NhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcbiAgICB9XG5cbiAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5xdWV1ZS5wdXNoKGZ1bmN0aW9uICgpIHsgc2VsZi5vYnNlcnZlci5vbk5leHQodmFsdWUpOyB9KTtcbiAgICB9O1xuXG4gICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHRoaXMucXVldWUucHVzaChmdW5jdGlvbiAoKSB7IHNlbGYub2JzZXJ2ZXIub25FcnJvcihlKTsgfSk7XG4gICAgfTtcblxuICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB0aGlzLnF1ZXVlLnB1c2goZnVuY3Rpb24gKCkgeyBzZWxmLm9ic2VydmVyLm9uQ29tcGxldGVkKCk7IH0pO1xuICAgIH07XG5cbiAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUuZW5zdXJlQWN0aXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGlzT3duZXIgPSBmYWxzZTtcbiAgICAgIGlmICghdGhpcy5oYXNGYXVsdGVkICYmIHRoaXMucXVldWUubGVuZ3RoID4gMCkge1xuICAgICAgICBpc093bmVyID0gIXRoaXMuaXNBY3F1aXJlZDtcbiAgICAgICAgdGhpcy5pc0FjcXVpcmVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChpc093bmVyKSB7XG4gICAgICAgIHRoaXMuZGlzcG9zYWJsZS5zZXREaXNwb3NhYmxlKHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKHRoaXMsIGZ1bmN0aW9uIChwYXJlbnQsIHNlbGYpIHtcbiAgICAgICAgICB2YXIgd29yaztcbiAgICAgICAgICBpZiAocGFyZW50LnF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHdvcmsgPSBwYXJlbnQucXVldWUuc2hpZnQoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGFyZW50LmlzQWNxdWlyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHdvcmspKCk7XG4gICAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgICAgIHBhcmVudC5xdWV1ZSA9IFtdO1xuICAgICAgICAgICAgcGFyZW50Lmhhc0ZhdWx0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHRocm93ZXIocmVzLmUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzZWxmKHBhcmVudCk7XG4gICAgICAgIH0pKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBfX3N1cGVyX18ucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuZGlzcG9zYWJsZS5kaXNwb3NlKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBTY2hlZHVsZWRPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgdmFyIE9ic2VydmFibGVCYXNlID0gUnguT2JzZXJ2YWJsZUJhc2UgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE9ic2VydmFibGVCYXNlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gZml4U3Vic2NyaWJlcihzdWJzY3JpYmVyKSB7XG4gICAgICByZXR1cm4gc3Vic2NyaWJlciAmJiBpc0Z1bmN0aW9uKHN1YnNjcmliZXIuZGlzcG9zZSkgPyBzdWJzY3JpYmVyIDpcbiAgICAgICAgaXNGdW5jdGlvbihzdWJzY3JpYmVyKSA/IGRpc3Bvc2FibGVDcmVhdGUoc3Vic2NyaWJlcikgOiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0RGlzcG9zYWJsZShzLCBzdGF0ZSkge1xuICAgICAgdmFyIGFkbyA9IHN0YXRlWzBdLCBzZWxmID0gc3RhdGVbMV07XG4gICAgICB2YXIgc3ViID0gdHJ5Q2F0Y2goc2VsZi5zdWJzY3JpYmVDb3JlKS5jYWxsKHNlbGYsIGFkbyk7XG4gICAgICBpZiAoc3ViID09PSBlcnJvck9iaiAmJiAhYWRvLmZhaWwoZXJyb3JPYmouZSkpIHsgdGhyb3dlcihlcnJvck9iai5lKTsgfVxuICAgICAgYWRvLnNldERpc3Bvc2FibGUoZml4U3Vic2NyaWJlcihzdWIpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlQmFzZSgpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE9ic2VydmFibGVCYXNlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBhZG8gPSBuZXcgQXV0b0RldGFjaE9ic2VydmVyKG8pLCBzdGF0ZSA9IFthZG8sIHRoaXNdO1xuXG4gICAgICBpZiAoY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlcXVpcmVkKCkpIHtcbiAgICAgICAgY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZSwgc2V0RGlzcG9zYWJsZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXREaXNwb3NhYmxlKG51bGwsIHN0YXRlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhZG87XG4gICAgfTtcblxuICAgIE9ic2VydmFibGVCYXNlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gbm90SW1wbGVtZW50ZWQ7XG5cbiAgICByZXR1cm4gT2JzZXJ2YWJsZUJhc2U7XG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG52YXIgRmxhdE1hcE9ic2VydmFibGUgPSBSeC5GbGF0TWFwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblxuICAgIGluaGVyaXRzKEZsYXRNYXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gRmxhdE1hcE9ic2VydmFibGUoc291cmNlLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpIHtcbiAgICAgIHRoaXMucmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKHJlc3VsdFNlbGVjdG9yKSA/IHJlc3VsdFNlbGVjdG9yIDogbnVsbDtcbiAgICAgIHRoaXMuc2VsZWN0b3IgPSBiaW5kQ2FsbGJhY2soaXNGdW5jdGlvbihzZWxlY3RvcikgPyBzZWxlY3RvciA6IGZ1bmN0aW9uKCkgeyByZXR1cm4gc2VsZWN0b3I7IH0sIHRoaXNBcmcsIDMpO1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBGbGF0TWFwT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgdGhpcy5zZWxlY3RvciwgdGhpcy5yZXN1bHRTZWxlY3RvciwgdGhpcykpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG9ic2VydmVyLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHNvdXJjZSkge1xuICAgICAgdGhpcy5pID0gMDtcbiAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgIHRoaXMucmVzdWx0U2VsZWN0b3IgPSByZXN1bHRTZWxlY3RvcjtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5vID0gb2JzZXJ2ZXI7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuX3dyYXBSZXN1bHQgPSBmdW5jdGlvbihyZXN1bHQsIHgsIGkpIHtcbiAgICAgIHJldHVybiB0aGlzLnJlc3VsdFNlbGVjdG9yID9cbiAgICAgICAgcmVzdWx0Lm1hcChmdW5jdGlvbih5LCBpMikgeyByZXR1cm4gdGhpcy5yZXN1bHRTZWxlY3Rvcih4LCB5LCBpLCBpMik7IH0sIHRoaXMpIDpcbiAgICAgICAgcmVzdWx0O1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuICAgICAgdmFyIGkgPSB0aGlzLmkrKztcbiAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLnNlbGVjdG9yKSh4LCBpLCB0aGlzLnNvdXJjZSk7XG4gICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzdWx0LmUpOyB9XG5cbiAgICAgIGlzUHJvbWlzZShyZXN1bHQpICYmIChyZXN1bHQgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UocmVzdWx0KSk7XG4gICAgICAoaXNBcnJheUxpa2UocmVzdWx0KSB8fCBpc0l0ZXJhYmxlKHJlc3VsdCkpICYmIChyZXN1bHQgPSBPYnNlcnZhYmxlLmZyb20ocmVzdWx0KSk7XG4gICAgICB0aGlzLm8ub25OZXh0KHRoaXMuX3dyYXBSZXN1bHQocmVzdWx0LCB4LCBpKSk7XG4gICAgfTtcblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24oZSkgeyB0aGlzLm8ub25FcnJvcihlKTsgfTtcblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24oKSB7IHRoaXMuby5vbkNvbXBsZXRlZCgpOyB9O1xuXG4gICAgcmV0dXJuIEZsYXRNYXBPYnNlcnZhYmxlO1xuXG59KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIEVudW1lcmFibGUgPSBSeC5pbnRlcm5hbHMuRW51bWVyYWJsZSA9IGZ1bmN0aW9uICgpIHsgfTtcblxuICBmdW5jdGlvbiBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSkge1xuICAgIHRoaXMuX3MgPSBzdGF0ZTtcbiAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgfVxuXG4gIElzRGlzcG9zZWREaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlKHNvdXJjZXMpIHtcbiAgICAgIHRoaXMuc291cmNlcyA9IHNvdXJjZXM7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgc3RhdGUgPSB7IGlzRGlzcG9zZWQ6IGZhbHNlIH0sIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG4gICAgICB2YXIgY2FuY2VsYWJsZSA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUodGhpcy5zb3VyY2VzWyRpdGVyYXRvciRdKCksIGZ1bmN0aW9uIChlLCBzZWxmKSB7XG4gICAgICAgIGlmIChzdGF0ZS5pc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSB0cnlDYXRjaChlLm5leHQpLmNhbGwoZSk7XG4gICAgICAgIGlmIChjdXJyZW50SXRlbSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihjdXJyZW50SXRlbS5lKTsgfVxuXG4gICAgICAgIGlmIChjdXJyZW50SXRlbS5kb25lKSB7XG4gICAgICAgICAgcmV0dXJuIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHByb21pc2VcbiAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGN1cnJlbnRJdGVtLnZhbHVlO1xuICAgICAgICBpc1Byb21pc2UoY3VycmVudFZhbHVlKSAmJiAoY3VycmVudFZhbHVlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGN1cnJlbnRWYWx1ZSkpO1xuXG4gICAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgICBkLnNldERpc3Bvc2FibGUoY3VycmVudFZhbHVlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCBzZWxmLCBlKSkpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoW3N1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSwgbmV3IElzRGlzcG9zZWREaXNwb3NhYmxlKHN0YXRlKV0pO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHMsIGUpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcyA9IHM7XG4gICAgICB0aGlzLl9lID0gZTtcbiAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fby5vbk5leHQoeCk7IH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fcyh0aGlzLl9lKTsgfTtcblxuICAgIHJldHVybiBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIEVudW1lcmFibGUucHJvdG90eXBlLmNvbmNhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlKHRoaXMpO1xuICB9O1xuXG4gIHZhciBDYXRjaEVycm9yT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhDYXRjaEVycm9yT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDYXRjaEVycm9yT2JzZXJ2YWJsZShzb3VyY2VzKSB7XG4gICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgQ2F0Y2hFcnJvck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGUgPSB0aGlzLnNvdXJjZXNbJGl0ZXJhdG9yJF0oKTtcblxuICAgICAgdmFyIHN0YXRlID0geyBpc0Rpc3Bvc2VkOiBmYWxzZSB9LCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuICAgICAgdmFyIGNhbmNlbGFibGUgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKG51bGwsIGZ1bmN0aW9uIChsYXN0RXhjZXB0aW9uLCBzZWxmKSB7XG4gICAgICAgIGlmIChzdGF0ZS5pc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSB0cnlDYXRjaChlLm5leHQpLmNhbGwoZSk7XG4gICAgICAgIGlmIChjdXJyZW50SXRlbSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihjdXJyZW50SXRlbS5lKTsgfVxuXG4gICAgICAgIGlmIChjdXJyZW50SXRlbS5kb25lKSB7XG4gICAgICAgICAgcmV0dXJuIGxhc3RFeGNlcHRpb24gIT09IG51bGwgPyBvLm9uRXJyb3IobGFzdEV4Y2VwdGlvbikgOiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcbiAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblxuICAgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgICAgZC5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgc2VsZikpKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShbc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlLCBuZXcgSXNEaXNwb3NlZERpc3Bvc2FibGUoc3RhdGUpXSk7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgcmVjdXJzZSkge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9yZWN1cnNlID0gcmVjdXJzZTtcbiAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fby5vbk5leHQoeCk7IH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9yZWN1cnNlKGUpOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXG4gICAgcmV0dXJuIENhdGNoRXJyb3JPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgRW51bWVyYWJsZS5wcm90b3R5cGUuY2F0Y2hFcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IENhdGNoRXJyb3JPYnNlcnZhYmxlKHRoaXMpO1xuICB9O1xuXG4gIEVudW1lcmFibGUucHJvdG90eXBlLmNhdGNoRXJyb3JXaGVuID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbkhhbmRsZXIpIHtcbiAgICB2YXIgc291cmNlcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgZXhjZXB0aW9ucyA9IG5ldyBTdWJqZWN0KCksXG4gICAgICAgIG5vdGlmaWVyID0gbmV3IFN1YmplY3QoKSxcbiAgICAgICAgaGFuZGxlZCA9IG5vdGlmaWNhdGlvbkhhbmRsZXIoZXhjZXB0aW9ucyksXG4gICAgICAgIG5vdGlmaWNhdGlvbkRpc3Bvc2FibGUgPSBoYW5kbGVkLnN1YnNjcmliZShub3RpZmllcik7XG5cbiAgICAgIHZhciBlID0gc291cmNlc1skaXRlcmF0b3IkXSgpO1xuXG4gICAgICB2YXIgc3RhdGUgPSB7IGlzRGlzcG9zZWQ6IGZhbHNlIH0sXG4gICAgICAgIGxhc3RFeGNlcHRpb24sXG4gICAgICAgIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG4gICAgICB2YXIgY2FuY2VsYWJsZSA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUobnVsbCwgZnVuY3Rpb24gKF8sIHNlbGYpIHtcbiAgICAgICAgaWYgKHN0YXRlLmlzRGlzcG9zZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIHZhciBjdXJyZW50SXRlbSA9IHRyeUNhdGNoKGUubmV4dCkuY2FsbChlKTtcbiAgICAgICAgaWYgKGN1cnJlbnRJdGVtID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKGN1cnJlbnRJdGVtLmUpOyB9XG5cbiAgICAgICAgaWYgKGN1cnJlbnRJdGVtLmRvbmUpIHtcbiAgICAgICAgICBpZiAobGFzdEV4Y2VwdGlvbikge1xuICAgICAgICAgICAgby5vbkVycm9yKGxhc3RFeGNlcHRpb24pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHByb21pc2VcbiAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGN1cnJlbnRJdGVtLnZhbHVlO1xuICAgICAgICBpc1Byb21pc2UoY3VycmVudFZhbHVlKSAmJiAoY3VycmVudFZhbHVlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGN1cnJlbnRWYWx1ZSkpO1xuXG4gICAgICAgIHZhciBvdXRlciA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgICB2YXIgaW5uZXIgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUobmV3IEJpbmFyeURpc3Bvc2FibGUoaW5uZXIsIG91dGVyKSk7XG4gICAgICAgIG91dGVyLnNldERpc3Bvc2FibGUoY3VycmVudFZhbHVlLnN1YnNjcmliZShcbiAgICAgICAgICBmdW5jdGlvbih4KSB7IG8ub25OZXh0KHgpOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uIChleG4pIHtcbiAgICAgICAgICAgIGlubmVyLnNldERpc3Bvc2FibGUobm90aWZpZXIuc3Vic2NyaWJlKHNlbGYsIGZ1bmN0aW9uKGV4KSB7XG4gICAgICAgICAgICAgIG8ub25FcnJvcihleCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgICAgICBleGNlcHRpb25zLm9uTmV4dChleG4pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZnVuY3Rpb24oKSB7IG8ub25Db21wbGV0ZWQoKTsgfSkpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoW25vdGlmaWNhdGlvbkRpc3Bvc2FibGUsIHN1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSwgbmV3IElzRGlzcG9zZWREaXNwb3NhYmxlKHN0YXRlKV0pO1xuICAgIH0pO1xuICB9O1xuXG4gIHZhciBSZXBlYXRFbnVtZXJhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhSZXBlYXRFbnVtZXJhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gUmVwZWF0RW51bWVyYWJsZSh2LCBjKSB7XG4gICAgICB0aGlzLnYgPSB2O1xuICAgICAgdGhpcy5jID0gYyA9PSBudWxsID8gLTEgOiBjO1xuICAgIH1cbiAgICBSZXBlYXRFbnVtZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBuZXcgUmVwZWF0RW51bWVyYXRvcih0aGlzKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gUmVwZWF0RW51bWVyYXRvcihwKSB7XG4gICAgICB0aGlzLnYgPSBwLnY7XG4gICAgICB0aGlzLmwgPSBwLmM7XG4gICAgfVxuICAgIFJlcGVhdEVudW1lcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5sID09PSAwKSB7IHJldHVybiBkb25lRW51bWVyYXRvcjsgfVxuICAgICAgaWYgKHRoaXMubCA+IDApIHsgdGhpcy5sLS07IH1cbiAgICAgIHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogdGhpcy52IH07XG4gICAgfTtcblxuICAgIHJldHVybiBSZXBlYXRFbnVtZXJhYmxlO1xuICB9KEVudW1lcmFibGUpKTtcblxuICB2YXIgZW51bWVyYWJsZVJlcGVhdCA9IEVudW1lcmFibGUucmVwZWF0ID0gZnVuY3Rpb24gKHZhbHVlLCByZXBlYXRDb3VudCkge1xuICAgIHJldHVybiBuZXcgUmVwZWF0RW51bWVyYWJsZSh2YWx1ZSwgcmVwZWF0Q291bnQpO1xuICB9O1xuXG4gIHZhciBPZkVudW1lcmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoT2ZFbnVtZXJhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE9mRW51bWVyYWJsZShzLCBmbiwgdGhpc0FyZykge1xuICAgICAgdGhpcy5zID0gcztcbiAgICAgIHRoaXMuZm4gPSBmbiA/IGJpbmRDYWxsYmFjayhmbiwgdGhpc0FyZywgMykgOiBudWxsO1xuICAgIH1cbiAgICBPZkVudW1lcmFibGUucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG5ldyBPZkVudW1lcmF0b3IodGhpcyk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIE9mRW51bWVyYXRvcihwKSB7XG4gICAgICB0aGlzLmkgPSAtMTtcbiAgICAgIHRoaXMucyA9IHAucztcbiAgICAgIHRoaXMubCA9IHRoaXMucy5sZW5ndGg7XG4gICAgICB0aGlzLmZuID0gcC5mbjtcbiAgICB9XG4gICAgT2ZFbnVtZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICByZXR1cm4gKyt0aGlzLmkgPCB0aGlzLmwgP1xuICAgICAgIHsgZG9uZTogZmFsc2UsIHZhbHVlOiAhdGhpcy5mbiA/IHRoaXMuc1t0aGlzLmldIDogdGhpcy5mbih0aGlzLnNbdGhpcy5pXSwgdGhpcy5pLCB0aGlzLnMpIH0gOlxuICAgICAgIGRvbmVFbnVtZXJhdG9yO1xuICAgIH07XG5cbiAgICByZXR1cm4gT2ZFbnVtZXJhYmxlO1xuICB9KEVudW1lcmFibGUpKTtcblxuICB2YXIgZW51bWVyYWJsZU9mID0gRW51bWVyYWJsZS5vZiA9IGZ1bmN0aW9uIChzb3VyY2UsIHNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIG5ldyBPZkVudW1lcmFibGUoc291cmNlLCBzZWxlY3RvciwgdGhpc0FyZyk7XG4gIH07XG5cbiAgdmFyIFRvQXJyYXlPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRvQXJyYXlPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFRvQXJyYXlPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUb0FycmF5T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobykpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8pIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmEgPSBbXTtcbiAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuYS5wdXNoKHgpOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5vLm9uRXJyb3IoZSk7ICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5vLm9uTmV4dCh0aGlzLmEpOyB0aGlzLm8ub25Db21wbGV0ZWQoKTsgfTtcblxuICAgIHJldHVybiBUb0FycmF5T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqIENyZWF0ZXMgYW4gYXJyYXkgZnJvbSBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgYSBzaW5nbGUgZWxlbWVudCB3aXRoIGEgbGlzdCBjb250YWluaW5nIGFsbCB0aGUgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnRvQXJyYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBUb0FycmF5T2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBmcm9tIGEgc3BlY2lmaWVkIHN1YnNjcmliZSBtZXRob2QgaW1wbGVtZW50YXRpb24uXG4gICAqIEBleGFtcGxlXG4gICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBmdW5jdGlvbiAoKSB7IH0gKTtcbiAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmNyZWF0ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIFJ4LkRpc3Bvc2FibGUuZW1wdHk7IH0gKTtcbiAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmNyZWF0ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgfSApO1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWJzY3JpYmUgSW1wbGVtZW50YXRpb24gb2YgdGhlIHJlc3VsdGluZyBvYnNlcnZhYmxlIHNlcXVlbmNlJ3Mgc3Vic2NyaWJlIG1ldGhvZCwgcmV0dXJuaW5nIGEgZnVuY3Rpb24gdGhhdCB3aWxsIGJlIHdyYXBwZWQgaW4gYSBEaXNwb3NhYmxlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCB0aGUgc3BlY2lmaWVkIGltcGxlbWVudGF0aW9uIGZvciB0aGUgU3Vic2NyaWJlIG1ldGhvZC5cbiAgICovXG4gIE9ic2VydmFibGUuY3JlYXRlID0gZnVuY3Rpb24gKHN1YnNjcmliZSwgcGFyZW50KSB7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKHN1YnNjcmliZSwgcGFyZW50KTtcbiAgfTtcblxuICB2YXIgRGVmZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRGVmZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gRGVmZXIoZmFjdG9yeSkge1xuICAgICAgdGhpcy5fZiA9IGZhY3Rvcnk7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBEZWZlci5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5fZikoKTtcbiAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiBvYnNlcnZhYmxlVGhyb3cocmVzdWx0LmUpLnN1YnNjcmliZShvKTt9XG4gICAgICBpc1Byb21pc2UocmVzdWx0KSAmJiAocmVzdWx0ID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHJlc3VsdCkpO1xuICAgICAgcmV0dXJuIHJlc3VsdC5zdWJzY3JpYmUobyk7XG4gICAgfTtcblxuICAgIHJldHVybiBEZWZlcjtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaW52b2tlcyB0aGUgc3BlY2lmaWVkIGZhY3RvcnkgZnVuY3Rpb24gd2hlbmV2ZXIgYSBuZXcgb2JzZXJ2ZXIgc3Vic2NyaWJlcy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmRlZmVyKGZ1bmN0aW9uICgpIHsgcmV0dXJuIFJ4Lk9ic2VydmFibGUuZnJvbUFycmF5KFsxLDIsM10pOyB9KTtcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb2JzZXJ2YWJsZUZhY3RvcnkgT2JzZXJ2YWJsZSBmYWN0b3J5IGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBvYnNlcnZlciB0aGF0IHN1YnNjcmliZXMgdG8gdGhlIHJlc3VsdGluZyBzZXF1ZW5jZSBvciBQcm9taXNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBvYnNlcnZlcnMgdHJpZ2dlciBhbiBpbnZvY2F0aW9uIG9mIHRoZSBnaXZlbiBvYnNlcnZhYmxlIGZhY3RvcnkgZnVuY3Rpb24uXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZURlZmVyID0gT2JzZXJ2YWJsZS5kZWZlciA9IGZ1bmN0aW9uIChvYnNlcnZhYmxlRmFjdG9yeSkge1xuICAgIHJldHVybiBuZXcgRGVmZXIob2JzZXJ2YWJsZUZhY3RvcnkpO1xuICB9O1xuXG4gIHZhciBFbXB0eU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRW1wdHlPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEVtcHR5T2JzZXJ2YWJsZShzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRW1wdHlPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICB2YXIgc2luayA9IG5ldyBFbXB0eVNpbmsob2JzZXJ2ZXIsIHRoaXMuc2NoZWR1bGVyKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBFbXB0eVNpbmsob2JzZXJ2ZXIsIHNjaGVkdWxlcikge1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVJdGVtKHMsIHN0YXRlKSB7XG4gICAgICBzdGF0ZS5vbkNvbXBsZXRlZCgpO1xuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcbiAgICB9XG5cbiAgICBFbXB0eVNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzdGF0ZSA9IHRoaXMub2JzZXJ2ZXI7XG4gICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZXIgPT09IGltbWVkaWF0ZVNjaGVkdWxlciA/XG4gICAgICAgIHNjaGVkdWxlSXRlbShudWxsLCBzdGF0ZSkgOlxuICAgICAgICB0aGlzLnNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZSwgc2NoZWR1bGVJdGVtKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEVtcHR5T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBFTVBUWV9PQlNFUlZBQkxFID0gbmV3IEVtcHR5T2JzZXJ2YWJsZShpbW1lZGlhdGVTY2hlZHVsZXIpO1xuXG4gIC8qKlxuICAgKiAgUmV0dXJucyBhbiBlbXB0eSBvYnNlcnZhYmxlIHNlcXVlbmNlLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCB0aGUgc2luZ2xlIE9uQ29tcGxldGVkIG1lc3NhZ2UuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5lbXB0eSgpO1xuICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuZW1wdHkoUnguU2NoZWR1bGVyLnRpbWVvdXQpO1xuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHNlbmQgdGhlIHRlcm1pbmF0aW9uIGNhbGwgb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggbm8gZWxlbWVudHMuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZUVtcHR5ID0gT2JzZXJ2YWJsZS5lbXB0eSA9IGZ1bmN0aW9uIChzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXIpO1xuICAgIHJldHVybiBzY2hlZHVsZXIgPT09IGltbWVkaWF0ZVNjaGVkdWxlciA/IEVNUFRZX09CU0VSVkFCTEUgOiBuZXcgRW1wdHlPYnNlcnZhYmxlKHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIEZyb21PYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEZyb21PYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEZyb21PYnNlcnZhYmxlKGl0ZXJhYmxlLCBtYXBwZXIsIHNjaGVkdWxlcikge1xuICAgICAgdGhpcy5pdGVyYWJsZSA9IGl0ZXJhYmxlO1xuICAgICAgdGhpcy5tYXBwZXIgPSBtYXBwZXI7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIEZyb21PYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IEZyb21TaW5rKG8sIHRoaXMpO1xuICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBGcm9tT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBGcm9tU2luayA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRnJvbVNpbmsobywgcGFyZW50KSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgfVxuXG4gICAgRnJvbVNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBsaXN0ID0gT2JqZWN0KHRoaXMucGFyZW50Lml0ZXJhYmxlKSxcbiAgICAgICAgICBpdCA9IGdldEl0ZXJhYmxlKGxpc3QpLFxuICAgICAgICAgIG8gPSB0aGlzLm8sXG4gICAgICAgICAgbWFwcGVyID0gdGhpcy5wYXJlbnQubWFwcGVyO1xuXG4gICAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGksIHJlY3Vyc2UpIHtcbiAgICAgICAgdmFyIG5leHQgPSB0cnlDYXRjaChpdC5uZXh0KS5jYWxsKGl0KTtcbiAgICAgICAgaWYgKG5leHQgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IobmV4dC5lKTsgfVxuICAgICAgICBpZiAobmV4dC5kb25lKSB7IHJldHVybiBvLm9uQ29tcGxldGVkKCk7IH1cblxuICAgICAgICB2YXIgcmVzdWx0ID0gbmV4dC52YWx1ZTtcblxuICAgICAgICBpZiAoaXNGdW5jdGlvbihtYXBwZXIpKSB7XG4gICAgICAgICAgcmVzdWx0ID0gdHJ5Q2F0Y2gobWFwcGVyKShyZXN1bHQsIGkpO1xuICAgICAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0LmUpOyB9XG4gICAgICAgIH1cblxuICAgICAgICBvLm9uTmV4dChyZXN1bHQpO1xuICAgICAgICByZWN1cnNlKGkgKyAxKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBsb29wUmVjdXJzaXZlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEZyb21TaW5rO1xuICB9KCkpO1xuXG4gIHZhciBtYXhTYWZlSW50ZWdlciA9IE1hdGgucG93KDIsIDUzKSAtIDE7XG5cbiAgZnVuY3Rpb24gU3RyaW5nSXRlcmFibGUocykge1xuICAgIHRoaXMuX3MgPSBzO1xuICB9XG5cbiAgU3RyaW5nSXRlcmFibGUucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgU3RyaW5nSXRlcmF0b3IodGhpcy5fcyk7XG4gIH07XG5cbiAgZnVuY3Rpb24gU3RyaW5nSXRlcmF0b3Iocykge1xuICAgIHRoaXMuX3MgPSBzO1xuICAgIHRoaXMuX2wgPSBzLmxlbmd0aDtcbiAgICB0aGlzLl9pID0gMDtcbiAgfVxuXG4gIFN0cmluZ0l0ZXJhdG9yLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBTdHJpbmdJdGVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5faSA8IHRoaXMuX2wgPyB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogdGhpcy5fcy5jaGFyQXQodGhpcy5faSsrKSB9IDogZG9uZUVudW1lcmF0b3I7XG4gIH07XG5cbiAgZnVuY3Rpb24gQXJyYXlJdGVyYWJsZShhKSB7XG4gICAgdGhpcy5fYSA9IGE7XG4gIH1cblxuICBBcnJheUl0ZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IEFycmF5SXRlcmF0b3IodGhpcy5fYSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gQXJyYXlJdGVyYXRvcihhKSB7XG4gICAgdGhpcy5fYSA9IGE7XG4gICAgdGhpcy5fbCA9IHRvTGVuZ3RoKGEpO1xuICAgIHRoaXMuX2kgPSAwO1xuICB9XG5cbiAgQXJyYXlJdGVyYXRvci5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgQXJyYXlJdGVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5faSA8IHRoaXMuX2wgPyB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogdGhpcy5fYVt0aGlzLl9pKytdIH0gOiBkb25lRW51bWVyYXRvcjtcbiAgfTtcblxuICBmdW5jdGlvbiBudW1iZXJJc0Zpbml0ZSh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIHJvb3QuaXNGaW5pdGUodmFsdWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gaXNOYW4obikge1xuICAgIHJldHVybiBuICE9PSBuO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0SXRlcmFibGUobykge1xuICAgIHZhciBpID0gb1skaXRlcmF0b3IkXSwgaXQ7XG4gICAgaWYgKCFpICYmIHR5cGVvZiBvID09PSAnc3RyaW5nJykge1xuICAgICAgaXQgPSBuZXcgU3RyaW5nSXRlcmFibGUobyk7XG4gICAgICByZXR1cm4gaXRbJGl0ZXJhdG9yJF0oKTtcbiAgICB9XG4gICAgaWYgKCFpICYmIG8ubGVuZ3RoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGl0ID0gbmV3IEFycmF5SXRlcmFibGUobyk7XG4gICAgICByZXR1cm4gaXRbJGl0ZXJhdG9yJF0oKTtcbiAgICB9XG4gICAgaWYgKCFpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdCBpcyBub3QgaXRlcmFibGUnKTsgfVxuICAgIHJldHVybiBvWyRpdGVyYXRvciRdKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzaWduKHZhbHVlKSB7XG4gICAgdmFyIG51bWJlciA9ICt2YWx1ZTtcbiAgICBpZiAobnVtYmVyID09PSAwKSB7IHJldHVybiBudW1iZXI7IH1cbiAgICBpZiAoaXNOYU4obnVtYmVyKSkgeyByZXR1cm4gbnVtYmVyOyB9XG4gICAgcmV0dXJuIG51bWJlciA8IDAgPyAtMSA6IDE7XG4gIH1cblxuICBmdW5jdGlvbiB0b0xlbmd0aChvKSB7XG4gICAgdmFyIGxlbiA9ICtvLmxlbmd0aDtcbiAgICBpZiAoaXNOYU4obGVuKSkgeyByZXR1cm4gMDsgfVxuICAgIGlmIChsZW4gPT09IDAgfHwgIW51bWJlcklzRmluaXRlKGxlbikpIHsgcmV0dXJuIGxlbjsgfVxuICAgIGxlbiA9IHNpZ24obGVuKSAqIE1hdGguZmxvb3IoTWF0aC5hYnMobGVuKSk7XG4gICAgaWYgKGxlbiA8PSAwKSB7IHJldHVybiAwOyB9XG4gICAgaWYgKGxlbiA+IG1heFNhZmVJbnRlZ2VyKSB7IHJldHVybiBtYXhTYWZlSW50ZWdlcjsgfVxuICAgIHJldHVybiBsZW47XG4gIH1cblxuICAvKipcbiAgKiBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgbmV3IE9ic2VydmFibGUgc2VxdWVuY2UgZnJvbSBhbiBhcnJheS1saWtlIG9yIGl0ZXJhYmxlIG9iamVjdC5cbiAgKiBAcGFyYW0ge0FueX0gYXJyYXlMaWtlIEFuIGFycmF5LWxpa2Ugb3IgaXRlcmFibGUgb2JqZWN0IHRvIGNvbnZlcnQgdG8gYW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbbWFwRm5dIE1hcCBmdW5jdGlvbiB0byBjYWxsIG9uIGV2ZXJ5IGVsZW1lbnQgb2YgdGhlIGFycmF5LlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gVGhlIGNvbnRleHQgdG8gdXNlIGNhbGxpbmcgdGhlIG1hcEZuIGlmIHByb3ZpZGVkLlxuICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBPcHRpb25hbCBzY2hlZHVsZXIgdG8gdXNlIGZvciBzY2hlZHVsaW5nLiAgSWYgbm90IHByb3ZpZGVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuY3VycmVudFRocmVhZC5cbiAgKi9cbiAgdmFyIG9ic2VydmFibGVGcm9tID0gT2JzZXJ2YWJsZS5mcm9tID0gZnVuY3Rpb24gKGl0ZXJhYmxlLCBtYXBGbiwgdGhpc0FyZywgc2NoZWR1bGVyKSB7XG4gICAgaWYgKGl0ZXJhYmxlID09IG51bGwpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignaXRlcmFibGUgY2Fubm90IGJlIG51bGwuJylcbiAgICB9XG4gICAgaWYgKG1hcEZuICYmICFpc0Z1bmN0aW9uKG1hcEZuKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdtYXBGbiB3aGVuIHByb3ZpZGVkIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cbiAgICBpZiAobWFwRm4pIHtcbiAgICAgIHZhciBtYXBwZXIgPSBiaW5kQ2FsbGJhY2sobWFwRm4sIHRoaXNBcmcsIDIpO1xuICAgIH1cbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IEZyb21PYnNlcnZhYmxlKGl0ZXJhYmxlLCBtYXBwZXIsIHNjaGVkdWxlcik7XG4gIH1cblxuICB2YXIgRnJvbUFycmF5T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhGcm9tQXJyYXlPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEZyb21BcnJheU9ic2VydmFibGUoYXJncywgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLmFyZ3MgPSBhcmdzO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBGcm9tQXJyYXlPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICB2YXIgc2luayA9IG5ldyBGcm9tQXJyYXlTaW5rKG9ic2VydmVyLCB0aGlzKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRnJvbUFycmF5T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIGZ1bmN0aW9uIEZyb21BcnJheVNpbmsob2JzZXJ2ZXIsIHBhcmVudCkge1xuICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxvb3BSZWN1cnNpdmUoYXJncywgb2JzZXJ2ZXIpIHtcbiAgICB2YXIgbGVuID0gYXJncy5sZW5ndGg7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIGxvb3AgKGksIHJlY3Vyc2UpIHtcbiAgICAgIGlmIChpIDwgbGVuKSB7XG4gICAgICAgIG9ic2VydmVyLm9uTmV4dChhcmdzW2ldKTtcbiAgICAgICAgcmVjdXJzZShpICsgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBGcm9tQXJyYXlTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBsb29wUmVjdXJzaXZlKHRoaXMucGFyZW50LmFyZ3MsIHRoaXMub2JzZXJ2ZXIpKTtcbiAgfTtcblxuICAvKipcbiAgKiAgQ29udmVydHMgYW4gYXJyYXkgdG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgdXNpbmcgYW4gb3B0aW9uYWwgc2NoZWR1bGVyIHRvIGVudW1lcmF0ZSB0aGUgYXJyYXkuXG4gICogQGRlcHJlY2F0ZWQgdXNlIE9ic2VydmFibGUuZnJvbSBvciBPYnNlcnZhYmxlLm9mXG4gICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIGVudW1lcmF0aW9uIG9mIHRoZSBpbnB1dCBzZXF1ZW5jZSBvbi5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2UgZWxlbWVudHMgYXJlIHB1bGxlZCBmcm9tIHRoZSBnaXZlbiBlbnVtZXJhYmxlIHNlcXVlbmNlLlxuICAqL1xuICB2YXIgb2JzZXJ2YWJsZUZyb21BcnJheSA9IE9ic2VydmFibGUuZnJvbUFycmF5ID0gZnVuY3Rpb24gKGFycmF5LCBzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IEZyb21BcnJheU9ic2VydmFibGUoYXJyYXksIHNjaGVkdWxlcilcbiAgfTtcblxuICB2YXIgTmV2ZXJPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE5ldmVyT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBOZXZlck9ic2VydmFibGUoKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBOZXZlck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgfTtcblxuICAgIHJldHVybiBOZXZlck9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgTkVWRVJfT0JTRVJWQUJMRSA9IG5ldyBOZXZlck9ic2VydmFibGUoKTtcblxuICAvKipcbiAgICogUmV0dXJucyBhIG5vbi10ZXJtaW5hdGluZyBvYnNlcnZhYmxlIHNlcXVlbmNlLCB3aGljaCBjYW4gYmUgdXNlZCB0byBkZW5vdGUgYW4gaW5maW5pdGUgZHVyYXRpb24gKGUuZy4gd2hlbiB1c2luZyByZWFjdGl2ZSBqb2lucykuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIG9ic2VydmVycyB3aWxsIG5ldmVyIGdldCBjYWxsZWQuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZU5ldmVyID0gT2JzZXJ2YWJsZS5uZXZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gTkVWRVJfT0JTRVJWQUJMRTtcbiAgfTtcblxuICBmdW5jdGlvbiBvYnNlcnZhYmxlT2YgKHNjaGVkdWxlciwgYXJyYXkpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IEZyb21BcnJheU9ic2VydmFibGUoYXJyYXksIHNjaGVkdWxlcik7XG4gIH1cblxuICAvKipcbiAgKiAgVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyBPYnNlcnZhYmxlIGluc3RhbmNlIHdpdGggYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzLCByZWdhcmRsZXNzIG9mIG51bWJlciBvciB0eXBlIG9mIHRoZSBhcmd1bWVudHMuXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSBwdWxsZWQgZnJvbSB0aGUgZ2l2ZW4gYXJndW1lbnRzLlxuICAqL1xuICBPYnNlcnZhYmxlLm9mID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICByZXR1cm4gbmV3IEZyb21BcnJheU9ic2VydmFibGUoYXJncywgY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gIH07XG5cbiAgLyoqXG4gICogIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgT2JzZXJ2YWJsZSBpbnN0YW5jZSB3aXRoIGEgdmFyaWFibGUgbnVtYmVyIG9mIGFyZ3VtZW50cywgcmVnYXJkbGVzcyBvZiBudW1iZXIgb3IgdHlwZSBvZiB0aGUgYXJndW1lbnRzLlxuICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBzY2hlZHVsZXIgQSBzY2hlZHVsZXIgdG8gdXNlIGZvciBzY2hlZHVsaW5nIHRoZSBhcmd1bWVudHMuXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSBwdWxsZWQgZnJvbSB0aGUgZ2l2ZW4gYXJndW1lbnRzLlxuICAqL1xuICBPYnNlcnZhYmxlLm9mV2l0aFNjaGVkdWxlciA9IGZ1bmN0aW9uIChzY2hlZHVsZXIpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4gLSAxKTtcbiAgICBmb3IodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICByZXR1cm4gbmV3IEZyb21BcnJheU9ic2VydmFibGUoYXJncywgc2NoZWR1bGVyKTtcbiAgfTtcblxuICB2YXIgUGFpcnNPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFBhaXJzT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBQYWlyc09ic2VydmFibGUob2JqLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMub2JqID0gb2JqO1xuICAgICAgdGhpcy5rZXlzID0gT2JqZWN0LmtleXMob2JqKTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgUGFpcnNPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICB2YXIgc2luayA9IG5ldyBQYWlyc1Npbmsob2JzZXJ2ZXIsIHRoaXMpO1xuICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBQYWlyc09ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICBmdW5jdGlvbiBQYWlyc1Npbmsob2JzZXJ2ZXIsIHBhcmVudCkge1xuICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgfVxuXG4gIFBhaXJzU2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBvYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXIsIG9iaiA9IHRoaXMucGFyZW50Lm9iaiwga2V5cyA9IHRoaXMucGFyZW50LmtleXMsIGxlbiA9IGtleXMubGVuZ3RoO1xuICAgIGZ1bmN0aW9uIGxvb3BSZWN1cnNpdmUoaSwgcmVjdXJzZSkge1xuICAgICAgaWYgKGkgPCBsZW4pIHtcbiAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICAgIG9ic2VydmVyLm9uTmV4dChba2V5LCBvYmpba2V5XV0pO1xuICAgICAgICByZWN1cnNlKGkgKyAxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBsb29wUmVjdXJzaXZlKTtcbiAgfTtcblxuICAvKipcbiAgICogQ29udmVydCBhbiBvYmplY3QgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIFtrZXksIHZhbHVlXSBwYWlycy5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSBlbnVtZXJhdGlvbiBvZiB0aGUgaW5wdXQgc2VxdWVuY2Ugb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIFtrZXksIHZhbHVlXSBwYWlycyBmcm9tIHRoZSBvYmplY3QuXG4gICAqL1xuICBPYnNlcnZhYmxlLnBhaXJzID0gZnVuY3Rpb24gKG9iaiwgc2NoZWR1bGVyKSB7XG4gICAgc2NoZWR1bGVyIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IFBhaXJzT2JzZXJ2YWJsZShvYmosIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgICB2YXIgUmFuZ2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFJhbmdlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBSYW5nZU9ic2VydmFibGUoc3RhcnQsIGNvdW50LCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuc3RhcnQgPSBzdGFydDtcbiAgICAgIHRoaXMucmFuZ2VDb3VudCA9IGNvdW50O1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBSYW5nZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IFJhbmdlU2luayhvYnNlcnZlciwgdGhpcyk7XG4gICAgICByZXR1cm4gc2luay5ydW4oKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFJhbmdlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBSYW5nZVNpbmsgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJhbmdlU2luayhvYnNlcnZlciwgcGFyZW50KSB7XG4gICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKHN0YXJ0LCBjb3VudCwgb2JzZXJ2ZXIpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiBsb29wIChpLCByZWN1cnNlKSB7XG4gICAgICAgIGlmIChpIDwgY291bnQpIHtcbiAgICAgICAgICBvYnNlcnZlci5vbk5leHQoc3RhcnQgKyBpKTtcbiAgICAgICAgICByZWN1cnNlKGkgKyAxKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIFJhbmdlU2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZShcbiAgICAgICAgMCxcbiAgICAgICAgbG9vcFJlY3Vyc2l2ZSh0aGlzLnBhcmVudC5zdGFydCwgdGhpcy5wYXJlbnQucmFuZ2VDb3VudCwgdGhpcy5vYnNlcnZlcilcbiAgICAgICk7XG4gICAgfTtcblxuICAgIHJldHVybiBSYW5nZVNpbms7XG4gIH0oKSk7XG5cbiAgLyoqXG4gICogIEdlbmVyYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIGludGVncmFsIG51bWJlcnMgd2l0aGluIGEgc3BlY2lmaWVkIHJhbmdlLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCBvYnNlcnZlciBtZXNzYWdlcy5cbiAgKiBAcGFyYW0ge051bWJlcn0gc3RhcnQgVGhlIHZhbHVlIG9mIHRoZSBmaXJzdCBpbnRlZ2VyIGluIHRoZSBzZXF1ZW5jZS5cbiAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBzZXF1ZW50aWFsIGludGVnZXJzIHRvIGdlbmVyYXRlLlxuICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSBnZW5lcmF0b3IgbG9vcCBvbi4gSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmN1cnJlbnRUaHJlYWQuXG4gICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyBhIHJhbmdlIG9mIHNlcXVlbnRpYWwgaW50ZWdyYWwgbnVtYmVycy5cbiAgKi9cbiAgT2JzZXJ2YWJsZS5yYW5nZSA9IGZ1bmN0aW9uIChzdGFydCwgY291bnQsIHNjaGVkdWxlcikge1xuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuICAgIHJldHVybiBuZXcgUmFuZ2VPYnNlcnZhYmxlKHN0YXJ0LCBjb3VudCwgc2NoZWR1bGVyKTtcbiAgfTtcblxuICB2YXIgUmVwZWF0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhSZXBlYXRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFJlcGVhdE9ic2VydmFibGUodmFsdWUsIHJlcGVhdENvdW50LCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgIHRoaXMucmVwZWF0Q291bnQgPSByZXBlYXRDb3VudCA9PSBudWxsID8gLTEgOiByZXBlYXRDb3VudDtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgUmVwZWF0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgUmVwZWF0U2luayhvYnNlcnZlciwgdGhpcyk7XG4gICAgICByZXR1cm4gc2luay5ydW4oKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFJlcGVhdE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICBmdW5jdGlvbiBSZXBlYXRTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcbiAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIH1cblxuICBSZXBlYXRTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9ic2VydmVyID0gdGhpcy5vYnNlcnZlciwgdmFsdWUgPSB0aGlzLnBhcmVudC52YWx1ZTtcbiAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGksIHJlY3Vyc2UpIHtcbiAgICAgIGlmIChpID09PSAtMSB8fCBpID4gMCkge1xuICAgICAgICBvYnNlcnZlci5vbk5leHQodmFsdWUpO1xuICAgICAgICBpID4gMCAmJiBpLS07XG4gICAgICB9XG4gICAgICBpZiAoaSA9PT0gMCkgeyByZXR1cm4gb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTsgfVxuICAgICAgcmVjdXJzZShpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5wYXJlbnQuc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKHRoaXMucGFyZW50LnJlcGVhdENvdW50LCBsb29wUmVjdXJzaXZlKTtcbiAgfTtcblxuICAvKipcbiAgICogIEdlbmVyYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcmVwZWF0cyB0aGUgZ2l2ZW4gZWxlbWVudCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcywgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgb2JzZXJ2ZXIgbWVzc2FnZXMuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIEVsZW1lbnQgdG8gcmVwZWF0LlxuICAgKiBAcGFyYW0ge051bWJlcn0gcmVwZWF0Q291bnQgW09wdGlvbmFdIE51bWJlciBvZiB0aW1lcyB0byByZXBlYXQgdGhlIGVsZW1lbnQuIElmIG5vdCBzcGVjaWZpZWQsIHJlcGVhdHMgaW5kZWZpbml0ZWx5LlxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIFNjaGVkdWxlciB0byBydW4gdGhlIHByb2R1Y2VyIGxvb3Agb24uIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5pbW1lZGlhdGUuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcmVwZWF0cyB0aGUgZ2l2ZW4gZWxlbWVudCB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcy5cbiAgICovXG4gIE9ic2VydmFibGUucmVwZWF0ID0gZnVuY3Rpb24gKHZhbHVlLCByZXBlYXRDb3VudCwgc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBSZXBlYXRPYnNlcnZhYmxlKHZhbHVlLCByZXBlYXRDb3VudCwgc2NoZWR1bGVyKTtcbiAgfTtcblxuICB2YXIgSnVzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoSnVzdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gSnVzdE9ic2VydmFibGUodmFsdWUsIHNjaGVkdWxlcikge1xuICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBKdXN0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgSnVzdFNpbmsob2JzZXJ2ZXIsIHRoaXMudmFsdWUsIHRoaXMuc2NoZWR1bGVyKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBKdXN0U2luayhvYnNlcnZlciwgdmFsdWUsIHNjaGVkdWxlcikge1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVJdGVtKHMsIHN0YXRlKSB7XG4gICAgICB2YXIgdmFsdWUgPSBzdGF0ZVswXSwgb2JzZXJ2ZXIgPSBzdGF0ZVsxXTtcbiAgICAgIG9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7XG4gICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcbiAgICB9XG5cbiAgICBKdXN0U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHN0YXRlID0gW3RoaXMudmFsdWUsIHRoaXMub2JzZXJ2ZXJdO1xuICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVyID09PSBpbW1lZGlhdGVTY2hlZHVsZXIgP1xuICAgICAgICBzY2hlZHVsZUl0ZW0obnVsbCwgc3RhdGUpIDpcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNjaGVkdWxlSXRlbSk7XG4gICAgfTtcblxuICAgIHJldHVybiBKdXN0T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgYSBzaW5nbGUgZWxlbWVudCwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgb2JzZXJ2ZXIgbWVzc2FnZXMuXG4gICAqICBUaGVyZSBpcyBhbiBhbGlhcyBjYWxsZWQgJ2p1c3QnIG9yIGJyb3dzZXJzIDxJRTkuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFNpbmdsZSBlbGVtZW50IGluIHRoZSByZXN1bHRpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBTY2hlZHVsZXIgdG8gc2VuZCB0aGUgc2luZ2xlIGVsZW1lbnQgb24uIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5pbW1lZGlhdGUuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHNpbmdsZSBzcGVjaWZpZWQgZWxlbWVudC5cbiAgICovXG4gIHZhciBvYnNlcnZhYmxlUmV0dXJuID0gT2JzZXJ2YWJsZVsncmV0dXJuJ10gPSBPYnNlcnZhYmxlLmp1c3QgPSBmdW5jdGlvbiAodmFsdWUsIHNjaGVkdWxlcikge1xuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBKdXN0T2JzZXJ2YWJsZSh2YWx1ZSwgc2NoZWR1bGVyKTtcbiAgfTtcblxuICB2YXIgVGhyb3dPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRocm93T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUaHJvd09ic2VydmFibGUoZXJyb3IsIHNjaGVkdWxlcikge1xuICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUaHJvd09ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgVGhyb3dTaW5rKG8sIHRoaXMpO1xuICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFRocm93U2luayhvLCBwKSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy5wID0gcDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzY2hlZHVsZUl0ZW0ocywgc3RhdGUpIHtcbiAgICAgIHZhciBlID0gc3RhdGVbMF0sIG8gPSBzdGF0ZVsxXTtcbiAgICAgIG8ub25FcnJvcihlKTtcbiAgICB9XG5cbiAgICBUaHJvd1NpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnAuc2NoZWR1bGVyLnNjaGVkdWxlKFt0aGlzLnAuZXJyb3IsIHRoaXMub10sIHNjaGVkdWxlSXRlbSk7XG4gICAgfTtcblxuICAgIHJldHVybiBUaHJvd09ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHRlcm1pbmF0ZXMgd2l0aCBhbiBleGNlcHRpb24sIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IHRoZSBzaW5nbGUgb25FcnJvciBtZXNzYWdlLlxuICAgKiAgVGhlcmUgaXMgYW4gYWxpYXMgdG8gdGhpcyBtZXRob2QgY2FsbGVkICd0aHJvd0Vycm9yJyBmb3IgYnJvd3NlcnMgPElFOS5cbiAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgQW4gb2JqZWN0IHVzZWQgZm9yIHRoZSBzZXF1ZW5jZSdzIHRlcm1pbmF0aW9uLlxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIFNjaGVkdWxlciB0byBzZW5kIHRoZSBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBjYWxsIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuaW1tZWRpYXRlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCB0ZXJtaW5hdGVzIGV4Y2VwdGlvbmFsbHkgd2l0aCB0aGUgc3BlY2lmaWVkIGV4Y2VwdGlvbiBvYmplY3QuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZVRocm93ID0gT2JzZXJ2YWJsZVsndGhyb3cnXSA9IGZ1bmN0aW9uIChlcnJvciwgc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IFRocm93T2JzZXJ2YWJsZShlcnJvciwgc2NoZWR1bGVyKTtcbiAgfTtcblxuICB2YXIgQ2F0Y2hPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhDYXRjaE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ2F0Y2hPYnNlcnZhYmxlKHNvdXJjZSwgZm4pIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fZm4gPSBmbjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIENhdGNoT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgZDEgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcbiAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKGQxKTtcbiAgICAgIGQxLnNldERpc3Bvc2FibGUodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBDYXRjaE9ic2VydmVyKG8sIHN1YnNjcmlwdGlvbiwgdGhpcy5fZm4pKSk7XG4gICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuICAgIH07XG5cbiAgICByZXR1cm4gQ2F0Y2hPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIENhdGNoT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ2F0Y2hPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDYXRjaE9ic2VydmVyKG8sIHMsIGZuKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgdGhpcy5fZm4gPSBmbjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIENhdGNoT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLl9vLm9uTmV4dCh4KTsgfTtcbiAgICBDYXRjaE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG4gICAgQ2F0Y2hPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuX2ZuKShlKTtcbiAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzdWx0LmUpOyB9XG4gICAgICBpc1Byb21pc2UocmVzdWx0KSAmJiAocmVzdWx0ID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHJlc3VsdCkpO1xuXG4gICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgdGhpcy5fcy5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgZC5zZXREaXNwb3NhYmxlKHJlc3VsdC5zdWJzY3JpYmUodGhpcy5fbykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gQ2F0Y2hPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICAqIENvbnRpbnVlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGVybWluYXRlZCBieSBhbiBleGNlcHRpb24gd2l0aCB0aGUgbmV4dCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKiBAcGFyYW0ge01peGVkfSBoYW5kbGVyT3JTZWNvbmQgRXhjZXB0aW9uIGhhbmRsZXIgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgZ2l2ZW4gdGhlIGVycm9yIHRoYXQgb2NjdXJyZWQgaW4gdGhlIGZpcnN0IHNlcXVlbmNlLCBvciBhIHNlY29uZCBvYnNlcnZhYmxlIHNlcXVlbmNlIHVzZWQgdG8gcHJvZHVjZSByZXN1bHRzIHdoZW4gYW4gZXJyb3Igb2NjdXJyZWQgaW4gdGhlIGZpcnN0IHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBmaXJzdCBzZXF1ZW5jZSdzIGVsZW1lbnRzLCBmb2xsb3dlZCBieSB0aGUgZWxlbWVudHMgb2YgdGhlIGhhbmRsZXIgc2VxdWVuY2UgaW4gY2FzZSBhbiBleGNlcHRpb24gb2NjdXJyZWQuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG9bJ2NhdGNoJ10gPSBmdW5jdGlvbiAoaGFuZGxlck9yU2Vjb25kKSB7XG4gICAgcmV0dXJuIGlzRnVuY3Rpb24oaGFuZGxlck9yU2Vjb25kKSA/IG5ldyBDYXRjaE9ic2VydmFibGUodGhpcywgaGFuZGxlck9yU2Vjb25kKSA6IG9ic2VydmFibGVDYXRjaChbdGhpcywgaGFuZGxlck9yU2Vjb25kXSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENvbnRpbnVlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGVybWluYXRlZCBieSBhbiBleGNlcHRpb24gd2l0aCB0aGUgbmV4dCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKiBAcGFyYW0ge0FycmF5IHwgQXJndW1lbnRzfSBhcmdzIEFyZ3VtZW50cyBvciBhbiBhcnJheSB0byB1c2UgYXMgdGhlIG5leHQgc2VxdWVuY2UgaWYgYW4gZXJyb3Igb2NjdXJzLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIGVsZW1lbnRzIGZyb20gY29uc2VjdXRpdmUgc291cmNlIHNlcXVlbmNlcyB1bnRpbCBhIHNvdXJjZSBzZXF1ZW5jZSB0ZXJtaW5hdGVzIHN1Y2Nlc3NmdWxseS5cbiAgICovXG4gIHZhciBvYnNlcnZhYmxlQ2F0Y2ggPSBPYnNlcnZhYmxlWydjYXRjaCddID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpdGVtcztcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG4gICAgICBpdGVtcyA9IGFyZ3VtZW50c1swXTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgICBpdGVtcyA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGl0ZW1zW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgfVxuICAgIHJldHVybiBlbnVtZXJhYmxlT2YoaXRlbXMpLmNhdGNoRXJyb3IoKTtcbiAgfTtcblxuICAvKipcbiAgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYW55IG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBQcm9taXNlcyBwcm9kdWNlcyBhbiBlbGVtZW50LlxuICAgKiBUaGlzIGNhbiBiZSBpbiB0aGUgZm9ybSBvZiBhbiBhcmd1bWVudCBsaXN0IG9mIG9ic2VydmFibGVzIG9yIGFuIGFycmF5LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAxIC0gb2JzID0gb2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0KG9iczEsIG9iczIsIG9iczMsIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuICAgKiAyIC0gb2JzID0gb2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0KFtvYnMxLCBvYnMyLCBvYnMzXSwgZnVuY3Rpb24gKG8xLCBvMiwgbzMpIHsgcmV0dXJuIG8xICsgbzIgKyBvMzsgfSk7XG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJnc1swXSkpIHtcbiAgICAgIGFyZ3NbMF0udW5zaGlmdCh0aGlzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXJncy51bnNoaWZ0KHRoaXMpO1xuICAgIH1cbiAgICByZXR1cm4gY29tYmluZUxhdGVzdC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgfTtcblxuICBmdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuICBmdW5jdGlvbiBhcmd1bWVudHNUb0FycmF5KCkge1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICByZXR1cm4gYXJncztcbiAgfVxuXG4gIHZhciBDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZShwYXJhbXMsIGNiKSB7XG4gICAgICB0aGlzLl9wYXJhbXMgPSBwYXJhbXM7XG4gICAgICB0aGlzLl9jYiA9IGNiO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgQ29tYmluZUxhdGVzdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvYnNlcnZlcikge1xuICAgICAgdmFyIGxlbiA9IHRoaXMuX3BhcmFtcy5sZW5ndGgsXG4gICAgICAgICAgc3Vic2NyaXB0aW9ucyA9IG5ldyBBcnJheShsZW4pO1xuXG4gICAgICB2YXIgc3RhdGUgPSB7XG4gICAgICAgIGhhc1ZhbHVlOiBhcnJheUluaXRpYWxpemUobGVuLCBmYWxzZUZhY3RvcnkpLFxuICAgICAgICBoYXNWYWx1ZUFsbDogZmFsc2UsXG4gICAgICAgIGlzRG9uZTogYXJyYXlJbml0aWFsaXplKGxlbiwgZmFsc2VGYWN0b3J5KSxcbiAgICAgICAgdmFsdWVzOiBuZXcgQXJyYXkobGVuKVxuICAgICAgfTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB2YXIgc291cmNlID0gdGhpcy5fcGFyYW1zW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcbiAgICAgICAgaXNQcm9taXNlKHNvdXJjZSkgJiYgKHNvdXJjZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShzb3VyY2UpKTtcbiAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShuZXcgQ29tYmluZUxhdGVzdE9ic2VydmVyKG9ic2VydmVyLCBpLCB0aGlzLl9jYiwgc3RhdGUpKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG4gICAgfTtcblxuICAgIHJldHVybiBDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENvbWJpbmVMYXRlc3RPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIobywgaSwgY2IsIHN0YXRlKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX2kgPSBpO1xuICAgICAgdGhpcy5fY2IgPSBjYjtcbiAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBub3RUaGVTYW1lKGkpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoeCwgaikge1xuICAgICAgICByZXR1cm4gaiAhPT0gaTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgQ29tYmluZUxhdGVzdE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMuX3N0YXRlLnZhbHVlc1t0aGlzLl9pXSA9IHg7XG4gICAgICB0aGlzLl9zdGF0ZS5oYXNWYWx1ZVt0aGlzLl9pXSA9IHRydWU7XG4gICAgICBpZiAodGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwgfHwgKHRoaXMuX3N0YXRlLmhhc1ZhbHVlQWxsID0gdGhpcy5fc3RhdGUuaGFzVmFsdWUuZXZlcnkoaWRlbnRpdHkpKSkge1xuICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5fY2IpLmFwcGx5KG51bGwsIHRoaXMuX3N0YXRlLnZhbHVlcyk7XG4gICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG4gICAgICAgIHRoaXMuX28ub25OZXh0KHJlcyk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuX3N0YXRlLmlzRG9uZS5maWx0ZXIobm90VGhlU2FtZSh0aGlzLl9pKSkuZXZlcnkoaWRlbnRpdHkpKSB7XG4gICAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgQ29tYmluZUxhdGVzdE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIENvbWJpbmVMYXRlc3RPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fc3RhdGUuaXNEb25lW3RoaXMuX2ldID0gdHJ1ZTtcbiAgICAgIHRoaXMuX3N0YXRlLmlzRG9uZS5ldmVyeShpZGVudGl0eSkgJiYgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gQ29tYmluZUxhdGVzdE9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbnkgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIG9yIFByb21pc2VzIHByb2R1Y2VzIGFuIGVsZW1lbnQuXG4gICpcbiAgKiBAZXhhbXBsZVxuICAqIDEgLSBvYnMgPSBSeC5PYnNlcnZhYmxlLmNvbWJpbmVMYXRlc3Qob2JzMSwgb2JzMiwgb2JzMywgZnVuY3Rpb24gKG8xLCBvMiwgbzMpIHsgcmV0dXJuIG8xICsgbzIgKyBvMzsgfSk7XG4gICogMiAtIG9icyA9IFJ4Lk9ic2VydmFibGUuY29tYmluZUxhdGVzdChbb2JzMSwgb2JzMiwgb2JzM10sIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICovXG4gIHZhciBjb21iaW5lTGF0ZXN0ID0gT2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKGFyZ3NbbGVuIC0gMV0pID8gYXJncy5wb3AoKSA6IGFyZ3VtZW50c1RvQXJyYXk7XG4gICAgQXJyYXkuaXNBcnJheShhcmdzWzBdKSAmJiAoYXJncyA9IGFyZ3NbMF0pO1xuICAgIHJldHVybiBuZXcgQ29tYmluZUxhdGVzdE9ic2VydmFibGUoYXJncywgcmVzdWx0U2VsZWN0b3IpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDb25jYXRlbmF0ZXMgYWxsIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcy4gIFRoaXMgdGFrZXMgaW4gZWl0aGVyIGFuIGFycmF5IG9yIHZhcmlhYmxlIGFyZ3VtZW50cyB0byBjb25jYXRlbmF0ZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgZWFjaCBnaXZlbiBzZXF1ZW5jZSwgaW4gc2VxdWVudGlhbCBvcmRlci5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgZm9yKHZhciBhcmdzID0gW10sIGkgPSAwLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cbiAgICBhcmdzLnVuc2hpZnQodGhpcyk7XG4gICAgcmV0dXJuIG9ic2VydmFibGVDb25jYXQuYXBwbHkobnVsbCwgYXJncyk7XG4gIH07XG5cbiAgdmFyIENvbmNhdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ29uY2F0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDb25jYXRPYnNlcnZhYmxlKHNvdXJjZXMpIHtcbiAgICAgIHRoaXMuc291cmNlcyA9IHNvdXJjZXM7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBDb25jYXRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgQ29uY2F0U2luayh0aGlzLnNvdXJjZXMsIG8pO1xuICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIENvbmNhdFNpbmsoc291cmNlcywgbykge1xuICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlcztcbiAgICAgIHRoaXMubyA9IG87XG4gICAgfVxuICAgIENvbmNhdFNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBpc0Rpc3Bvc2VkLCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLCBzb3VyY2VzID0gdGhpcy5zb3VyY2VzLCBsZW5ndGggPSBzb3VyY2VzLmxlbmd0aCwgbyA9IHRoaXMubztcbiAgICAgIHZhciBjYW5jZWxhYmxlID0gaW1tZWRpYXRlU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKDAsIGZ1bmN0aW9uIChpLCBzZWxmKSB7XG4gICAgICAgIGlmIChpc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuICAgICAgICBpZiAoaSA9PT0gbGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGlmIHByb21pc2VcbiAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IHNvdXJjZXNbaV07XG4gICAgICAgIGlzUHJvbWlzZShjdXJyZW50VmFsdWUpICYmIChjdXJyZW50VmFsdWUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoY3VycmVudFZhbHVlKSk7XG5cbiAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICAgIGQuc2V0RGlzcG9zYWJsZShjdXJyZW50VmFsdWUuc3Vic2NyaWJlKFxuICAgICAgICAgIGZ1bmN0aW9uICh4KSB7IG8ub25OZXh0KHgpOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoKSB7IHNlbGYoaSArIDEpOyB9XG4gICAgICAgICkpO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkge1xuICAgICAgICBpc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIH0pKTtcbiAgICB9O1xuXG5cbiAgICByZXR1cm4gQ29uY2F0T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAgKiBDb25jYXRlbmF0ZXMgYWxsIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcy5cbiAgICogQHBhcmFtIHtBcnJheSB8IEFyZ3VtZW50c30gYXJncyBBcmd1bWVudHMgb3IgYW4gYXJyYXkgdG8gY29uY2F0IHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBlYWNoIGdpdmVuIHNlcXVlbmNlLCBpbiBzZXF1ZW50aWFsIG9yZGVyLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVDb25jYXQgPSBPYnNlcnZhYmxlLmNvbmNhdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXJncztcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG4gICAgICBhcmdzID0gYXJndW1lbnRzWzBdO1xuICAgIH0gZWxzZSB7XG4gICAgICBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgICAgZm9yKHZhciBpID0gMCwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBDb25jYXRPYnNlcnZhYmxlKGFyZ3MpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDb25jYXRlbmF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBvYnNlcnZhYmxlIHNlcXVlbmNlcy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgZWFjaCBvYnNlcnZlZCBpbm5lciBzZXF1ZW5jZSwgaW4gc2VxdWVudGlhbCBvcmRlci5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5jb25jYXRBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMubWVyZ2UoMSk7XG4gIH07XG5cbiAgdmFyIE1lcmdlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTWVyZ2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gTWVyZ2VPYnNlcnZhYmxlKHNvdXJjZSwgbWF4Q29uY3VycmVudCkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLm1heENvbmN1cnJlbnQgPSBtYXhDb25jdXJyZW50O1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgTWVyZ2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBnID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcbiAgICAgIGcuYWRkKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgTWVyZ2VPYnNlcnZlcihvYnNlcnZlciwgdGhpcy5tYXhDb25jdXJyZW50LCBnKSkpO1xuICAgICAgcmV0dXJuIGc7XG4gICAgfTtcblxuICAgIHJldHVybiBNZXJnZU9ic2VydmFibGU7XG5cbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBNZXJnZU9ic2VydmVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNZXJnZU9ic2VydmVyKG8sIG1heCwgZykge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMubWF4ID0gbWF4O1xuICAgICAgdGhpcy5nID0gZztcbiAgICAgIHRoaXMuZG9uZSA9IGZhbHNlO1xuICAgICAgdGhpcy5xID0gW107XG4gICAgICB0aGlzLmFjdGl2ZUNvdW50ID0gMDtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgfVxuICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLmhhbmRsZVN1YnNjcmliZSA9IGZ1bmN0aW9uICh4cykge1xuICAgICAgdmFyIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgdGhpcy5nLmFkZChzYWQpO1xuICAgICAgaXNQcm9taXNlKHhzKSAmJiAoeHMgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoeHMpKTtcbiAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHhzLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcih0aGlzLCBzYWQpKSk7XG4gICAgfTtcbiAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoaW5uZXJTb3VyY2UpIHtcbiAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgaWYodGhpcy5hY3RpdmVDb3VudCA8IHRoaXMubWF4KSB7XG4gICAgICAgICAgdGhpcy5hY3RpdmVDb3VudCsrO1xuICAgICAgICAgIHRoaXMuaGFuZGxlU3Vic2NyaWJlKGlubmVyU291cmNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnEucHVzaChpbm5lclNvdXJjZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICAgICAgdGhpcy5hY3RpdmVDb3VudCA9PT0gMCAmJiB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuICAgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuXG4gICAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKHBhcmVudCwgc2FkKSB7XG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICB0aGlzLnNhZCA9IHNhZDtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7IGlmKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLnBhcmVudC5vLm9uTmV4dCh4KTsgfSB9O1xuICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgcGFyZW50LmcucmVtb3ZlKHRoaXMuc2FkKTtcbiAgICAgICAgICBpZiAocGFyZW50LnEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcGFyZW50LmhhbmRsZVN1YnNjcmliZShwYXJlbnQucS5zaGlmdCgpKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGFyZW50LmFjdGl2ZUNvdW50LS07XG4gICAgICAgICAgICBwYXJlbnQuZG9uZSAmJiBwYXJlbnQuYWN0aXZlQ291bnQgPT09IDAgJiYgcGFyZW50Lm8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcbiAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBNZXJnZU9ic2VydmVyO1xuICB9KCkpO1xuXG5cblxuXG5cbiAgLyoqXG4gICogTWVyZ2VzIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLCBsaW1pdGluZyB0aGUgbnVtYmVyIG9mIGNvbmN1cnJlbnQgc3Vic2NyaXB0aW9ucyB0byBpbm5lciBzZXF1ZW5jZXMuXG4gICogT3IgbWVyZ2VzIHR3byBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIGEgc2luZ2xlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICpcbiAgKiBAZXhhbXBsZVxuICAqIDEgLSBtZXJnZWQgPSBzb3VyY2VzLm1lcmdlKDEpO1xuICAqIDIgLSBtZXJnZWQgPSBzb3VyY2UubWVyZ2Uob3RoZXJTb3VyY2UpO1xuICAqIEBwYXJhbSB7TWl4ZWR9IFttYXhDb25jdXJyZW50T3JPdGhlcl0gTWF4aW11bSBudW1iZXIgb2YgaW5uZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgYmVpbmcgc3Vic2NyaWJlZCB0byBjb25jdXJyZW50bHkgb3IgdGhlIHNlY29uZCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IG1lcmdlcyB0aGUgZWxlbWVudHMgb2YgdGhlIGlubmVyIHNlcXVlbmNlcy5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLm1lcmdlID0gZnVuY3Rpb24gKG1heENvbmN1cnJlbnRPck90aGVyKSB7XG4gICAgcmV0dXJuIHR5cGVvZiBtYXhDb25jdXJyZW50T3JPdGhlciAhPT0gJ251bWJlcicgP1xuICAgICAgb2JzZXJ2YWJsZU1lcmdlKHRoaXMsIG1heENvbmN1cnJlbnRPck90aGVyKSA6XG4gICAgICBuZXcgTWVyZ2VPYnNlcnZhYmxlKHRoaXMsIG1heENvbmN1cnJlbnRPck90aGVyKTtcbiAgfTtcblxuICAvKipcbiAgICogTWVyZ2VzIGFsbCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhIHNpbmdsZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKiBUaGUgc2NoZWR1bGVyIGlzIG9wdGlvbmFsIGFuZCBpZiBub3Qgc3BlY2lmaWVkLCB0aGUgaW1tZWRpYXRlIHNjaGVkdWxlciBpcyB1c2VkLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBtZXJnZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcy5cbiAgICovXG4gIHZhciBvYnNlcnZhYmxlTWVyZ2UgPSBPYnNlcnZhYmxlLm1lcmdlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzY2hlZHVsZXIsIHNvdXJjZXMgPSBbXSwgaSwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBpZiAoIWFyZ3VtZW50c1swXSkge1xuICAgICAgc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyO1xuICAgICAgZm9yKGkgPSAxOyBpIDwgbGVuOyBpKyspIHsgc291cmNlcy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cbiAgICB9IGVsc2UgaWYgKGlzU2NoZWR1bGVyKGFyZ3VtZW50c1swXSkpIHtcbiAgICAgIHNjaGVkdWxlciA9IGFyZ3VtZW50c1swXTtcbiAgICAgIGZvcihpID0gMTsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcjtcbiAgICAgIGZvcihpID0gMDsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KHNvdXJjZXNbMF0pKSB7XG4gICAgICBzb3VyY2VzID0gc291cmNlc1swXTtcbiAgICB9XG4gICAgcmV0dXJuIG9ic2VydmFibGVPZihzY2hlZHVsZXIsIHNvdXJjZXMpLm1lcmdlQWxsKCk7XG4gIH07XG5cbiAgdmFyIENvbXBvc2l0ZUVycm9yID0gUnguQ29tcG9zaXRlRXJyb3IgPSBmdW5jdGlvbihlcnJvcnMpIHtcbiAgICB0aGlzLmlubmVyRXJyb3JzID0gZXJyb3JzO1xuICAgIHRoaXMubWVzc2FnZSA9ICdUaGlzIGNvbnRhaW5zIG11bHRpcGxlIGVycm9ycy4gQ2hlY2sgdGhlIGlubmVyRXJyb3JzJztcbiAgICBFcnJvci5jYWxsKHRoaXMpO1xuICB9O1xuICBDb21wb3NpdGVFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG4gIENvbXBvc2l0ZUVycm9yLnByb3RvdHlwZS5uYW1lID0gJ0NvbXBvc2l0ZUVycm9yJztcblxuICB2YXIgTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUoc291cmNlKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGdyb3VwID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKSxcbiAgICAgICAgbSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLFxuICAgICAgICBzdGF0ZSA9IHsgaXNTdG9wcGVkOiBmYWxzZSwgZXJyb3JzOiBbXSwgbzogbyB9O1xuXG4gICAgICBncm91cC5hZGQobSk7XG4gICAgICBtLnNldERpc3Bvc2FibGUodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNZXJnZURlbGF5RXJyb3JPYnNlcnZlcihncm91cCwgc3RhdGUpKSk7XG5cbiAgICAgIHJldHVybiBncm91cDtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIoZ3JvdXAsIHN0YXRlKSB7XG4gICAgICB0aGlzLl9ncm91cCA9IGdyb3VwO1xuICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldENvbXBsZXRpb24obywgZXJyb3JzKSB7XG4gICAgICBpZiAoZXJyb3JzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgICB9IGVsc2UgaWYgKGVycm9ycy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgby5vbkVycm9yKGVycm9yc1swXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvLm9uRXJyb3IobmV3IENvbXBvc2l0ZUVycm9yKGVycm9ycykpO1xuICAgICAgfVxuICAgIH1cblxuICAgIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHZhciBpbm5lciA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgdGhpcy5fZ3JvdXAuYWRkKGlubmVyKTtcblxuICAgICAgLy8gQ2hlY2sgZm9yIHByb21pc2VzIHN1cHBvcnRcbiAgICAgIGlzUHJvbWlzZSh4KSAmJiAoeCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZSh4KSk7XG4gICAgICBpbm5lci5zZXREaXNwb3NhYmxlKHguc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKGlubmVyLCB0aGlzLl9ncm91cCwgdGhpcy5fc3RhdGUpKSk7XG4gICAgfTtcblxuICAgIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9zdGF0ZS5lcnJvcnMucHVzaChlKTtcbiAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuICAgIH07XG5cbiAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fc3RhdGUuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2dyb3VwLmxlbmd0aCA9PT0gMSAmJiBzZXRDb21wbGV0aW9uKHRoaXMuX3N0YXRlLm8sIHRoaXMuX3N0YXRlLmVycm9ycyk7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihpbm5lciwgZ3JvdXAsIHN0YXRlKSB7XG4gICAgICB0aGlzLl9pbm5lciA9IGlubmVyO1xuICAgICAgdGhpcy5fZ3JvdXAgPSBncm91cDtcbiAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fc3RhdGUuby5vbk5leHQoeCk7IH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fc3RhdGUuZXJyb3JzLnB1c2goZSk7XG4gICAgICB0aGlzLl9ncm91cC5yZW1vdmUodGhpcy5faW5uZXIpO1xuICAgICAgdGhpcy5fc3RhdGUuaXNTdG9wcGVkICYmIHRoaXMuX2dyb3VwLmxlbmd0aCA9PT0gMSAmJiBzZXRDb21wbGV0aW9uKHRoaXMuX3N0YXRlLm8sIHRoaXMuX3N0YXRlLmVycm9ycyk7XG4gICAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9ncm91cC5yZW1vdmUodGhpcy5faW5uZXIpO1xuICAgICAgdGhpcy5fc3RhdGUuaXNTdG9wcGVkICYmIHRoaXMuX2dyb3VwLmxlbmd0aCA9PT0gMSAmJiBzZXRDb21wbGV0aW9uKHRoaXMuX3N0YXRlLm8sIHRoaXMuX3N0YXRlLmVycm9ycyk7XG4gICAgfTtcblxuICAgIHJldHVybiBNZXJnZURlbGF5RXJyb3JPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICogRmxhdHRlbnMgYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIE9ic2VydmFibGVzIGludG8gb25lIE9ic2VydmFibGUsIGluIGEgd2F5IHRoYXQgYWxsb3dzIGFuIE9ic2VydmVyIHRvXG4gICogcmVjZWl2ZSBhbGwgc3VjY2Vzc2Z1bGx5IGVtaXR0ZWQgaXRlbXMgZnJvbSBhbGwgb2YgdGhlIHNvdXJjZSBPYnNlcnZhYmxlcyB3aXRob3V0IGJlaW5nIGludGVycnVwdGVkIGJ5XG4gICogYW4gZXJyb3Igbm90aWZpY2F0aW9uIGZyb20gb25lIG9mIHRoZW0uXG4gICpcbiAgKiBUaGlzIGJlaGF2ZXMgbGlrZSBPYnNlcnZhYmxlLnByb3RvdHlwZS5tZXJnZUFsbCBleGNlcHQgdGhhdCBpZiBhbnkgb2YgdGhlIG1lcmdlZCBPYnNlcnZhYmxlcyBub3RpZnkgb2YgYW5cbiAgKiBlcnJvciB2aWEgdGhlIE9ic2VydmVyJ3Mgb25FcnJvciwgbWVyZ2VEZWxheUVycm9yIHdpbGwgcmVmcmFpbiBmcm9tIHByb3BhZ2F0aW5nIHRoYXRcbiAgKiBlcnJvciBub3RpZmljYXRpb24gdW50aWwgYWxsIG9mIHRoZSBtZXJnZWQgT2JzZXJ2YWJsZXMgaGF2ZSBmaW5pc2hlZCBlbWl0dGluZyBpdGVtcy5cbiAgKiBAcGFyYW0ge0FycmF5IHwgQXJndW1lbnRzfSBhcmdzIEFyZ3VtZW50cyBvciBhbiBhcnJheSB0byBtZXJnZS5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIGFsbCBvZiB0aGUgaXRlbXMgZW1pdHRlZCBieSB0aGUgT2JzZXJ2YWJsZXMgZW1pdHRlZCBieSB0aGUgT2JzZXJ2YWJsZVxuICAqL1xuICBPYnNlcnZhYmxlLm1lcmdlRGVsYXlFcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhcmdzO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3VtZW50c1swXSkpIHtcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHNbMF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICB9XG4gICAgdmFyIHNvdXJjZSA9IG9ic2VydmFibGVPZihudWxsLCBhcmdzKTtcbiAgICByZXR1cm4gbmV3IE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUoc291cmNlKTtcbiAgfTtcblxuICB2YXIgTWVyZ2VBbGxPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhNZXJnZUFsbE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBNZXJnZUFsbE9ic2VydmFibGUoc291cmNlKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE1lcmdlQWxsT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIGcgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpLCBtID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICBnLmFkZChtKTtcbiAgICAgIG0uc2V0RGlzcG9zYWJsZSh0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IE1lcmdlQWxsT2JzZXJ2ZXIob2JzZXJ2ZXIsIGcpKSk7XG4gICAgICByZXR1cm4gZztcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gTWVyZ2VBbGxPYnNlcnZlcihvLCBnKSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy5nID0gZztcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICB9XG4gICAgTWVyZ2VBbGxPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24oaW5uZXJTb3VyY2UpIHtcbiAgICAgIGlmKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuICAgICAgdmFyIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgdGhpcy5nLmFkZChzYWQpO1xuXG4gICAgICBpc1Byb21pc2UoaW5uZXJTb3VyY2UpICYmIChpbm5lclNvdXJjZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShpbm5lclNvdXJjZSkpO1xuXG4gICAgICBzYWQuc2V0RGlzcG9zYWJsZShpbm5lclNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIodGhpcywgc2FkKSkpO1xuICAgIH07XG4gICAgTWVyZ2VBbGxPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5nLmxlbmd0aCA9PT0gMSAmJiB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKHBhcmVudCwgc2FkKSB7XG4gICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgIHRoaXMuc2FkID0gc2FkO1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKHgpIHsgaWYgKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLnBhcmVudC5vLm9uTmV4dCh4KTsgfSB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuICAgICAgfVxuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHBhcmVudC5nLnJlbW92ZSh0aGlzLnNhZCk7XG4gICAgICAgIHBhcmVudC5kb25lICYmIHBhcmVudC5nLmxlbmd0aCA9PT0gMSAmJiBwYXJlbnQuby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICByZXR1cm4gTWVyZ2VBbGxPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICogTWVyZ2VzIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IG1lcmdlcyB0aGUgZWxlbWVudHMgb2YgdGhlIGlubmVyIHNlcXVlbmNlcy5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLm1lcmdlQWxsID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgTWVyZ2VBbGxPYnNlcnZhYmxlKHRoaXMpO1xuICB9O1xuXG4gIHZhciBTa2lwVW50aWxPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBVbnRpbE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBTa2lwVW50aWxPYnNlcnZhYmxlKHNvdXJjZSwgb3RoZXIpIHtcbiAgICAgIHRoaXMuX3MgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9vID0gaXNQcm9taXNlKG90aGVyKSA/IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikgOiBvdGhlcjtcbiAgICAgIHRoaXMuX29wZW4gPSBmYWxzZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFNraXBVbnRpbE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICB2YXIgbGVmdFN1YnNjcmlwdGlvbiA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgbGVmdFN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHRoaXMuX3Muc3Vic2NyaWJlKG5ldyBTa2lwVW50aWxTb3VyY2VPYnNlcnZlcihvLCB0aGlzKSkpO1xuXG4gICAgICBpc1Byb21pc2UodGhpcy5fbykgJiYgKHRoaXMuX28gPSBvYnNlcnZhYmxlRnJvbVByb21pc2UodGhpcy5fbykpO1xuXG4gICAgICB2YXIgcmlnaHRTdWJzY3JpcHRpb24gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHJpZ2h0U3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUodGhpcy5fby5zdWJzY3JpYmUobmV3IFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIobywgdGhpcywgcmlnaHRTdWJzY3JpcHRpb24pKSk7XG5cbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShsZWZ0U3Vic2NyaXB0aW9uLCByaWdodFN1YnNjcmlwdGlvbik7XG4gICAgfTtcblxuICAgIHJldHVybiBTa2lwVW50aWxPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBVbnRpbFNvdXJjZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyKG8sIHApIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwVW50aWxTb3VyY2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9wLl9vcGVuICYmIHRoaXMuX28ub25OZXh0KHgpO1xuICAgIH07XG5cbiAgICBTa2lwVW50aWxTb3VyY2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZXJyKTtcbiAgICB9O1xuXG4gICAgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fcC5fb3BlbiAmJiB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBTa2lwVW50aWxTb3VyY2VPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgdmFyIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2tpcFVudGlsT3RoZXJPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwVW50aWxPdGhlck9ic2VydmVyKG8sIHAsIHIpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9yID0gcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9wLl9vcGVuID0gdHJ1ZTtcbiAgICAgIHRoaXMuX3IuZGlzcG9zZSgpO1xuICAgIH07XG5cbiAgICBTa2lwVW50aWxPdGhlck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlcnIpO1xuICAgIH07XG5cbiAgICBTa2lwVW50aWxPdGhlck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3IuZGlzcG9zZSgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcFVudGlsT3RoZXJPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHZhbHVlcyBmcm9tIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvbmx5IGFmdGVyIHRoZSBvdGhlciBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2VzIGEgdmFsdWUuXG4gICAqIEBwYXJhbSB7T2JzZXJ2YWJsZSB8IFByb21pc2V9IG90aGVyIFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIG9yIFByb21pc2UgdGhhdCB0cmlnZ2VycyBwcm9wYWdhdGlvbiBvZiBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlIHN0YXJ0aW5nIGZyb20gdGhlIHBvaW50IHRoZSBvdGhlciBzZXF1ZW5jZSB0cmlnZ2VyZWQgcHJvcGFnYXRpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2tpcFVudGlsID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgcmV0dXJuIG5ldyBTa2lwVW50aWxPYnNlcnZhYmxlKHRoaXMsIG90aGVyKTtcbiAgfTtcblxuICB2YXIgU3dpdGNoT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTd2l0Y2hPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFN3aXRjaE9ic2VydmFibGUoc291cmNlKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFN3aXRjaE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGlubmVyID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSwgcyA9IHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgU3dpdGNoT2JzZXJ2ZXIobywgaW5uZXIpKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzLCBpbm5lcik7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKFN3aXRjaE9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBTd2l0Y2hPYnNlcnZlcihvLCBpbm5lcikge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMuaW5uZXIgPSBpbm5lcjtcbiAgICAgIHRoaXMuc3RvcHBlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5sYXRlc3QgPSAwO1xuICAgICAgdGhpcy5oYXNMYXRlc3QgPSBmYWxzZTtcbiAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTd2l0Y2hPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChpbm5lclNvdXJjZSkge1xuICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSwgaWQgPSArK3RoaXMubGF0ZXN0O1xuICAgICAgdGhpcy5oYXNMYXRlc3QgPSB0cnVlO1xuICAgICAgdGhpcy5pbm5lci5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgaXNQcm9taXNlKGlubmVyU291cmNlKSAmJiAoaW5uZXJTb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoaW5uZXJTb3VyY2UpKTtcbiAgICAgIGQuc2V0RGlzcG9zYWJsZShpbm5lclNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIodGhpcywgaWQpKSk7XG4gICAgfTtcblxuICAgIFN3aXRjaE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLm8ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgU3dpdGNoT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuc3RvcHBlZCA9IHRydWU7XG4gICAgICAhdGhpcy5oYXNMYXRlc3QgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIocGFyZW50LCBpZCkge1xuICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdGhpcy5wYXJlbnQubGF0ZXN0ID09PSB0aGlzLmlkICYmIHRoaXMucGFyZW50Lm8ub25OZXh0KHgpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLnBhcmVudC5sYXRlc3QgPT09IHRoaXMuaWQgJiYgdGhpcy5wYXJlbnQuby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAodGhpcy5wYXJlbnQubGF0ZXN0ID09PSB0aGlzLmlkKSB7XG4gICAgICAgIHRoaXMucGFyZW50Lmhhc0xhdGVzdCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnBhcmVudC5pc1N0b3BwZWQgJiYgdGhpcy5wYXJlbnQuby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gU3dpdGNoT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqIFRyYW5zZm9ybXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHZhbHVlcyBvbmx5IGZyb20gdGhlIG1vc3QgcmVjZW50IG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgYXQgYW55IHBvaW50IGluIHRpbWUgcHJvZHVjZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBtb3N0IHJlY2VudCBpbm5lciBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaGFzIGJlZW4gcmVjZWl2ZWQuXG4gICovXG4gIG9ic2VydmFibGVQcm90b1snc3dpdGNoJ10gPSBvYnNlcnZhYmxlUHJvdG8uc3dpdGNoTGF0ZXN0ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgU3dpdGNoT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICB2YXIgVGFrZVVudGlsT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYWtlVW50aWxPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gVGFrZVVudGlsT2JzZXJ2YWJsZShzb3VyY2UsIG90aGVyKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMub3RoZXIgPSBpc1Byb21pc2Uob3RoZXIpID8gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKG90aGVyKSA6IG90aGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGFrZVVudGlsT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShcbiAgICAgICAgdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG8pLFxuICAgICAgICB0aGlzLm90aGVyLnN1YnNjcmliZShuZXcgVGFrZVVudGlsT2JzZXJ2ZXIobykpXG4gICAgICApO1xuICAgIH07XG5cbiAgICByZXR1cm4gVGFrZVVudGlsT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBUYWtlVW50aWxPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYWtlVW50aWxPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUYWtlVW50aWxPYnNlcnZlcihvKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRha2VVbnRpbE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICBUYWtlVW50aWxPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZXJyKTtcbiAgICB9O1xuXG4gICAgVGFrZVVudGlsT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gbm9vcDtcblxuICAgIHJldHVybiBUYWtlVW50aWxPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHZhbHVlcyBmcm9tIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1bnRpbCB0aGUgb3RoZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNlcyBhIHZhbHVlLlxuICAgKiBAcGFyYW0ge09ic2VydmFibGUgfCBQcm9taXNlfSBvdGhlciBPYnNlcnZhYmxlIHNlcXVlbmNlIG9yIFByb21pc2UgdGhhdCB0ZXJtaW5hdGVzIHByb3BhZ2F0aW9uIG9mIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UgdXAgdG8gdGhlIHBvaW50IHRoZSBvdGhlciBzZXF1ZW5jZSBpbnRlcnJ1cHRlZCBmdXJ0aGVyIHByb3BhZ2F0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnRha2VVbnRpbCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHJldHVybiBuZXcgVGFrZVVudGlsT2JzZXJ2YWJsZSh0aGlzLCBvdGhlcik7XG4gIH07XG5cbiAgZnVuY3Rpb24gZmFsc2VGYWN0b3J5KCkgeyByZXR1cm4gZmFsc2U7IH1cbiAgZnVuY3Rpb24gYXJndW1lbnRzVG9BcnJheSgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIGFyZ3M7XG4gIH1cblxuICB2YXIgV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUoc291cmNlLCBzb3VyY2VzLCByZXN1bHRTZWxlY3Rvcikge1xuICAgICAgdGhpcy5fcyA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX3NzID0gc291cmNlcztcbiAgICAgIHRoaXMuX2NiID0gcmVzdWx0U2VsZWN0b3I7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGxlbiA9IHRoaXMuX3NzLmxlbmd0aDtcbiAgICAgIHZhciBzdGF0ZSA9IHtcbiAgICAgICAgaGFzVmFsdWU6IGFycmF5SW5pdGlhbGl6ZShsZW4sIGZhbHNlRmFjdG9yeSksXG4gICAgICAgIGhhc1ZhbHVlQWxsOiBmYWxzZSxcbiAgICAgICAgdmFsdWVzOiBuZXcgQXJyYXkobGVuKVxuICAgICAgfTtcblxuICAgICAgdmFyIG4gPSB0aGlzLl9zcy5sZW5ndGgsIHN1YnNjcmlwdGlvbnMgPSBuZXcgQXJyYXkobiArIDEpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgdmFyIG90aGVyID0gdGhpcy5fc3NbaV0sIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgICBpc1Byb21pc2Uob3RoZXIpICYmIChvdGhlciA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikpO1xuICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShvdGhlci5zdWJzY3JpYmUobmV3IFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlcihvLCBpLCBzdGF0ZSkpKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcbiAgICAgIH1cblxuICAgICAgdmFyIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgc2FkLnNldERpc3Bvc2FibGUodGhpcy5fcy5zdWJzY3JpYmUobmV3IFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIobywgdGhpcy5fY2IsIHN0YXRlKSkpO1xuICAgICAgc3Vic2NyaXB0aW9uc1tuXSA9IHNhZDtcblxuICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb25zKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIobywgaSwgc3RhdGUpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5faSA9IGk7XG4gICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMuX3N0YXRlLnZhbHVlc1t0aGlzLl9pXSA9IHg7XG4gICAgICB0aGlzLl9zdGF0ZS5oYXNWYWx1ZVt0aGlzLl9pXSA9IHRydWU7XG4gICAgICB0aGlzLl9zdGF0ZS5oYXNWYWx1ZUFsbCA9IHRoaXMuX3N0YXRlLmhhc1ZhbHVlLmV2ZXJ5KGlkZW50aXR5KTtcbiAgICB9O1xuXG4gICAgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gbm9vcDtcblxuICAgIHJldHVybiBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIHZhciBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIobywgY2IsIHN0YXRlKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX2NiID0gY2I7XG4gICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB2YXIgYWxsVmFsdWVzID0gW3hdLmNvbmNhdCh0aGlzLl9zdGF0ZS52YWx1ZXMpO1xuICAgICAgaWYgKCF0aGlzLl9zdGF0ZS5oYXNWYWx1ZUFsbCkgeyByZXR1cm47IH1cbiAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl9jYikuYXBwbHkobnVsbCwgYWxsVmFsdWVzKTtcbiAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG4gICAgICB0aGlzLl9vLm9uTmV4dChyZXMpO1xuICAgIH07XG5cbiAgICBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiBvbmx5IHdoZW4gdGhlIChmaXJzdCkgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjZXMgYW4gZWxlbWVudC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgc291cmNlcyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by53aXRoTGF0ZXN0RnJvbSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgYXJndW1lbnRzJyk7IH1cblxuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKGFyZ3NbbGVuIC0gMV0pID8gYXJncy5wb3AoKSA6IGFyZ3VtZW50c1RvQXJyYXk7XG4gICAgQXJyYXkuaXNBcnJheShhcmdzWzBdKSAmJiAoYXJncyA9IGFyZ3NbMF0pO1xuXG4gICAgcmV0dXJuIG5ldyBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUodGhpcywgYXJncywgcmVzdWx0U2VsZWN0b3IpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGZhbHNlRmFjdG9yeSgpIHsgcmV0dXJuIGZhbHNlOyB9XG4gIGZ1bmN0aW9uIGVtcHR5QXJyYXlGYWN0b3J5KCkgeyByZXR1cm4gW107IH1cblxuICB2YXIgWmlwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhaaXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFppcE9ic2VydmFibGUoc291cmNlcywgcmVzdWx0U2VsZWN0b3IpIHtcbiAgICAgIHRoaXMuX3MgPSBzb3VyY2VzO1xuICAgICAgdGhpcy5fY2IgPSByZXN1bHRTZWxlY3RvcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFppcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvYnNlcnZlcikge1xuICAgICAgdmFyIG4gPSB0aGlzLl9zLmxlbmd0aCxcbiAgICAgICAgICBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KG4pO1xuICAgICAgICAgIGRvbmUgPSBhcnJheUluaXRpYWxpemUobiwgZmFsc2VGYWN0b3J5KSxcbiAgICAgICAgICBxID0gYXJyYXlJbml0aWFsaXplKG4sIGVtcHR5QXJyYXlGYWN0b3J5KTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IHRoaXMuX3NbaV0sIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgICBzdWJzY3JpcHRpb25zW2ldID0gc2FkO1xuICAgICAgICBpc1Byb21pc2Uoc291cmNlKSAmJiAoc291cmNlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHNvdXJjZSkpO1xuICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKG5ldyBaaXBPYnNlcnZlcihvYnNlcnZlciwgaSwgdGhpcywgcSwgZG9uZSkpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb25zKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFppcE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgWmlwT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFppcE9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFppcE9ic2VydmVyKG8sIGksIHAsIHEsIGQpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5faSA9IGk7XG4gICAgICB0aGlzLl9wID0gcDtcbiAgICAgIHRoaXMuX3EgPSBxO1xuICAgICAgdGhpcy5fZCA9IGQ7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBub3RFbXB0eSh4KSB7IHJldHVybiB4Lmxlbmd0aCA+IDA7IH1cbiAgICBmdW5jdGlvbiBzaGlmdEVhY2goeCkgeyByZXR1cm4geC5zaGlmdCgpOyB9XG4gICAgZnVuY3Rpb24gbm90VGhlU2FtZShpKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHgsIGopIHtcbiAgICAgICAgcmV0dXJuIGogIT09IGk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIFppcE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMuX3FbdGhpcy5faV0ucHVzaCh4KTtcbiAgICAgIGlmICh0aGlzLl9xLmV2ZXJ5KG5vdEVtcHR5KSkge1xuICAgICAgICB2YXIgcXVldWVkVmFsdWVzID0gdGhpcy5fcS5tYXAoc2hpZnRFYWNoKTtcbiAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX3AuX2NiKS5hcHBseShudWxsLCBxdWV1ZWRWYWx1ZXMpO1xuICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgICB0aGlzLl9vLm9uTmV4dChyZXMpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLl9kLmZpbHRlcihub3RUaGVTYW1lKHRoaXMuX2kpKS5ldmVyeShpZGVudGl0eSkpIHtcbiAgICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBaaXBPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBaaXBPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fZFt0aGlzLl9pXSA9IHRydWU7XG4gICAgICB0aGlzLl9kLmV2ZXJ5KGlkZW50aXR5KSAmJiB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBaaXBPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFsbCBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgb3IgYW4gYXJyYXkgaGF2ZSBwcm9kdWNlZCBhbiBlbGVtZW50IGF0IGEgY29ycmVzcG9uZGluZyBpbmRleC5cbiAgICogVGhlIGxhc3QgZWxlbWVudCBpbiB0aGUgYXJndW1lbnRzIG11c3QgYmUgYSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggc2VyaWVzIG9mIGVsZW1lbnRzIGF0IGNvcnJlc3BvbmRpbmcgaW5kZXhlcyBpbiB0aGUgYXJncy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgYXJncyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by56aXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFyZ3VtZW50cycpOyB9XG5cbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuICAgIEFycmF5LmlzQXJyYXkoYXJnc1swXSkgJiYgKGFyZ3MgPSBhcmdzWzBdKTtcblxuICAgIHZhciBwYXJlbnQgPSB0aGlzO1xuICAgIGFyZ3MudW5zaGlmdChwYXJlbnQpO1xuXG4gICAgcmV0dXJuIG5ldyBaaXBPYnNlcnZhYmxlKGFyZ3MsIHJlc3VsdFNlbGVjdG9yKTtcbiAgfTtcblxuICAvKipcbiAgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYWxsIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBoYXZlIHByb2R1Y2VkIGFuIGVsZW1lbnQgYXQgYSBjb3JyZXNwb25kaW5nIGluZGV4LlxuICAgKiBAcGFyYW0gYXJndW1lbnRzIE9ic2VydmFibGUgc291cmNlcy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gcmVzdWx0U2VsZWN0b3IgRnVuY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIHNlcmllcyBvZiBlbGVtZW50cyBhdCBjb3JyZXNwb25kaW5nIGluZGV4ZXMgaW4gdGhlIHNvdXJjZXMuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBPYnNlcnZhYmxlLnppcCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJnc1swXSkpIHtcbiAgICAgIGFyZ3MgPSBpc0Z1bmN0aW9uKGFyZ3NbMV0pID8gYXJnc1swXS5jb25jYXQoYXJnc1sxXSkgOiBhcmdzWzBdO1xuICAgIH1cbiAgICB2YXIgZmlyc3QgPSBhcmdzLnNoaWZ0KCk7XG4gICAgcmV0dXJuIGZpcnN0LnppcC5hcHBseShmaXJzdCwgYXJncyk7XG4gIH07XG5cbmZ1bmN0aW9uIGZhbHNlRmFjdG9yeSgpIHsgcmV0dXJuIGZhbHNlOyB9XG5mdW5jdGlvbiBlbXB0eUFycmF5RmFjdG9yeSgpIHsgcmV0dXJuIFtdOyB9XG5mdW5jdGlvbiBhcmd1bWVudHNUb0FycmF5KCkge1xuICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICByZXR1cm4gYXJncztcbn1cblxuLyoqXG4gKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbGwgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIG9yIGFuIGFycmF5IGhhdmUgcHJvZHVjZWQgYW4gZWxlbWVudCBhdCBhIGNvcnJlc3BvbmRpbmcgaW5kZXguXG4gKiBUaGUgbGFzdCBlbGVtZW50IGluIHRoZSBhcmd1bWVudHMgbXVzdCBiZSBhIGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBzZXJpZXMgb2YgZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzIGluIHRoZSBhcmdzLlxuICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgYXJncyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cbiAqL1xub2JzZXJ2YWJsZVByb3RvLnppcEl0ZXJhYmxlID0gZnVuY3Rpb24gKCkge1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgYXJndW1lbnRzJyk7IH1cblxuICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKGFyZ3NbbGVuIC0gMV0pID8gYXJncy5wb3AoKSA6IGFyZ3VtZW50c1RvQXJyYXk7XG5cbiAgdmFyIHBhcmVudCA9IHRoaXM7XG4gIGFyZ3MudW5zaGlmdChwYXJlbnQpO1xuICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICB2YXIgbiA9IGFyZ3MubGVuZ3RoLFxuICAgICAgcXVldWVzID0gYXJyYXlJbml0aWFsaXplKG4sIGVtcHR5QXJyYXlGYWN0b3J5KSxcbiAgICAgIGlzRG9uZSA9IGFycmF5SW5pdGlhbGl6ZShuLCBmYWxzZUZhY3RvcnkpO1xuXG4gICAgdmFyIHN1YnNjcmlwdGlvbnMgPSBuZXcgQXJyYXkobik7XG4gICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbjsgaWR4KyspIHtcbiAgICAgIChmdW5jdGlvbiAoaSkge1xuICAgICAgICB2YXIgc291cmNlID0gYXJnc1tpXSwgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cbiAgICAgICAgKGlzQXJyYXlMaWtlKHNvdXJjZSkgfHwgaXNJdGVyYWJsZShzb3VyY2UpKSAmJiAoc291cmNlID0gb2JzZXJ2YWJsZUZyb20oc291cmNlKSk7XG5cbiAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAoeCkge1xuICAgICAgICAgIHF1ZXVlc1tpXS5wdXNoKHgpO1xuICAgICAgICAgIGlmIChxdWV1ZXMuZXZlcnkoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgubGVuZ3RoID4gMDsgfSkpIHtcbiAgICAgICAgICAgIHZhciBxdWV1ZWRWYWx1ZXMgPSBxdWV1ZXMubWFwKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnNoaWZ0KCk7IH0pLFxuICAgICAgICAgICAgICAgIHJlcyA9IHRyeUNhdGNoKHJlc3VsdFNlbGVjdG9yKS5hcHBseShwYXJlbnQsIHF1ZXVlZFZhbHVlcyk7XG4gICAgICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgICAgICAgby5vbk5leHQocmVzKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGlzRG9uZS5maWx0ZXIoZnVuY3Rpb24gKHgsIGopIHsgcmV0dXJuIGogIT09IGk7IH0pLmV2ZXJ5KGlkZW50aXR5KSkge1xuICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgaXNEb25lW2ldID0gdHJ1ZTtcbiAgICAgICAgICBpc0RvbmUuZXZlcnkoaWRlbnRpdHkpICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBzdWJzY3JpcHRpb25zW2ldID0gc2FkO1xuICAgICAgfSkoaWR4KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG4gIH0sIHBhcmVudCk7XG59O1xuXG4gIGZ1bmN0aW9uIGFzT2JzZXJ2YWJsZShzb3VyY2UpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gc3Vic2NyaWJlKG8pIHsgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobyk7IH07XG4gIH1cblxuICAvKipcbiAgICogIEhpZGVzIHRoZSBpZGVudGl0eSBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGhpZGVzIHRoZSBpZGVudGl0eSBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmFzT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoYXNPYnNlcnZhYmxlKHRoaXMpLCB0aGlzKTtcbiAgfTtcblxuICB2YXIgRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIobykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRGVtYXRlcmlhbGl6ZU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgRGVtYXRlcmlhbGl6ZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhEZW1hdGVyaWFsaXplT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIobykge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB4LmFjY2VwdCh0aGlzLl9vKTsgfTtcbiAgICBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fby5vbkVycm9yKGUpOyB9O1xuICAgIERlbWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cbiAgICByZXR1cm4gRGVtYXRlcmlhbGl6ZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogRGVtYXRlcmlhbGl6ZXMgdGhlIGV4cGxpY2l0IG5vdGlmaWNhdGlvbiB2YWx1ZXMgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyBpbXBsaWNpdCBub3RpZmljYXRpb25zLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBleGhpYml0aW5nIHRoZSBiZWhhdmlvciBjb3JyZXNwb25kaW5nIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UncyBub3RpZmljYXRpb24gdmFsdWVzLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmRlbWF0ZXJpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICB2YXIgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUoc291cmNlLCBrZXlGbiwgY29tcGFyZXIpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5rZXlGbiA9IGtleUZuO1xuICAgICAgdGhpcy5jb21wYXJlciA9IGNvbXBhcmVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIobywgdGhpcy5rZXlGbiwgdGhpcy5jb21wYXJlcikpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyKG8sIGtleUZuLCBjb21wYXJlcikge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMua2V5Rm4gPSBrZXlGbjtcbiAgICAgIHRoaXMuY29tcGFyZXIgPSBjb21wYXJlcjtcbiAgICAgIHRoaXMuaGFzQ3VycmVudEtleSA9IGZhbHNlO1xuICAgICAgdGhpcy5jdXJyZW50S2V5ID0gbnVsbDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdmFyIGtleSA9IHgsIGNvbXBhcmVyRXF1YWxzO1xuICAgICAgaWYgKGlzRnVuY3Rpb24odGhpcy5rZXlGbikpIHtcbiAgICAgICAga2V5ID0gdHJ5Q2F0Y2godGhpcy5rZXlGbikoeCk7XG4gICAgICAgIGlmIChrZXkgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihrZXkuZSk7IH1cbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLmhhc0N1cnJlbnRLZXkpIHtcbiAgICAgICAgY29tcGFyZXJFcXVhbHMgPSB0cnlDYXRjaCh0aGlzLmNvbXBhcmVyKSh0aGlzLmN1cnJlbnRLZXksIGtleSk7XG4gICAgICAgIGlmIChjb21wYXJlckVxdWFscyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKGNvbXBhcmVyRXF1YWxzLmUpOyB9XG4gICAgICB9XG4gICAgICBpZiAoIXRoaXMuaGFzQ3VycmVudEtleSB8fCAhY29tcGFyZXJFcXVhbHMpIHtcbiAgICAgICAgdGhpcy5oYXNDdXJyZW50S2V5ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jdXJyZW50S2V5ID0ga2V5O1xuICAgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuICAgICAgfVxuICAgIH07XG4gICAgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihlKSB7XG4gICAgICB0aGlzLm8ub25FcnJvcihlKTtcbiAgICB9O1xuICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIG9ubHkgZGlzdGluY3QgY29udGlndW91cyBlbGVtZW50cyBhY2NvcmRpbmcgdG8gdGhlIGtleUZuIGFuZCB0aGUgY29tcGFyZXIuXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gW2tleUZuXSBBIGZ1bmN0aW9uIHRvIGNvbXB1dGUgdGhlIGNvbXBhcmlzb24ga2V5IGZvciBlYWNoIGVsZW1lbnQuIElmIG5vdCBwcm92aWRlZCwgaXQgcHJvamVjdHMgdGhlIHZhbHVlLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wYXJlcl0gRXF1YWxpdHkgY29tcGFyZXIgZm9yIGNvbXB1dGVkIGtleSB2YWx1ZXMuIElmIG5vdCBwcm92aWRlZCwgZGVmYXVsdHMgdG8gYW4gZXF1YWxpdHkgY29tcGFyZXIgZnVuY3Rpb24uXG4gICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb25seSBjb250YWluaW5nIHRoZSBkaXN0aW5jdCBjb250aWd1b3VzIGVsZW1lbnRzLCBiYXNlZCBvbiBhIGNvbXB1dGVkIGtleSB2YWx1ZSwgZnJvbSB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uZGlzdGluY3RVbnRpbENoYW5nZWQgPSBmdW5jdGlvbiAoa2V5Rm4sIGNvbXBhcmVyKSB7XG4gICAgY29tcGFyZXIgfHwgKGNvbXBhcmVyID0gZGVmYXVsdENvbXBhcmVyKTtcbiAgICByZXR1cm4gbmV3IERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSh0aGlzLCBrZXlGbiwgY29tcGFyZXIpO1xuICB9O1xuXG4gIHZhciBUYXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRhcE9ic2VydmFibGUsX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUYXBPYnNlcnZhYmxlKHNvdXJjZSwgb2JzZXJ2ZXJPck9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fb04gPSBvYnNlcnZlck9yT25OZXh0O1xuICAgICAgdGhpcy5fb0UgPSBvbkVycm9yO1xuICAgICAgdGhpcy5fb0MgPSBvbkNvbXBsZXRlZDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRhcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMpKTtcbiAgICB9O1xuXG4gICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBwKSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy50ID0gIXAuX29OIHx8IGlzRnVuY3Rpb24ocC5fb04pID9cbiAgICAgICAgb2JzZXJ2ZXJDcmVhdGUocC5fb04gfHwgbm9vcCwgcC5fb0UgfHwgbm9vcCwgcC5fb0MgfHwgbm9vcCkgOlxuICAgICAgICBwLl9vTjtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbih4KSB7XG4gICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy50Lm9uTmV4dCkuY2FsbCh0aGlzLnQsIHgpO1xuICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgdGhpcy5vLm9uRXJyb3IocmVzLmUpOyB9XG4gICAgICB0aGlzLm8ub25OZXh0KHgpO1xuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihlcnIpIHtcbiAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLnQub25FcnJvcikuY2FsbCh0aGlzLnQsIGVycik7XG4gICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzLmUpOyB9XG4gICAgICB0aGlzLm8ub25FcnJvcihlcnIpO1xuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy50Lm9uQ29tcGxldGVkKS5jYWxsKHRoaXMudCk7XG4gICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzLmUpOyB9XG4gICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRhcE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgKiAgSW52b2tlcyBhbiBhY3Rpb24gZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhbmQgaW52b2tlcyBhbiBhY3Rpb24gdXBvbiBncmFjZWZ1bCBvciBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiAgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZywgbG9nZ2luZywgZXRjLiBvZiBxdWVyeSBiZWhhdmlvciBieSBpbnRlcmNlcHRpbmcgdGhlIG1lc3NhZ2Ugc3RyZWFtIHRvIHJ1biBhcmJpdHJhcnkgYWN0aW9ucyBmb3IgbWVzc2FnZXMgb24gdGhlIHBpcGVsaW5lLlxuICAqIEBwYXJhbSB7RnVuY3Rpb24gfCBPYnNlcnZlcn0gb2JzZXJ2ZXJPck9uTmV4dCBBY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugb3IgYW4gby5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25FcnJvcl0gIEFjdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS4gVXNlZCBpZiBvbmx5IHRoZSBvYnNlcnZlck9yT25OZXh0IHBhcmFtZXRlciBpcyBhbHNvIGEgZnVuY3Rpb24uXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gW29uQ29tcGxldGVkXSAgQWN0aW9uIHRvIGludm9rZSB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLiBVc2VkIGlmIG9ubHkgdGhlIG9ic2VydmVyT3JPbk5leHQgcGFyYW1ldGVyIGlzIGFsc28gYSBmdW5jdGlvbi5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoIHRoZSBzaWRlLWVmZmVjdGluZyBiZWhhdmlvciBhcHBsaWVkLlxuICAqL1xuICBvYnNlcnZhYmxlUHJvdG9bJ2RvJ10gPSBvYnNlcnZhYmxlUHJvdG8udGFwID0gb2JzZXJ2YWJsZVByb3RvLmRvQWN0aW9uID0gZnVuY3Rpb24gKG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgcmV0dXJuIG5ldyBUYXBPYnNlcnZhYmxlKHRoaXMsIG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKTtcbiAgfTtcblxuICAvKipcbiAgKiAgSW52b2tlcyBhbiBhY3Rpb24gZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiAgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZywgbG9nZ2luZywgZXRjLiBvZiBxdWVyeSBiZWhhdmlvciBieSBpbnRlcmNlcHRpbmcgdGhlIG1lc3NhZ2Ugc3RyZWFtIHRvIHJ1biBhcmJpdHJhcnkgYWN0aW9ucyBmb3IgbWVzc2FnZXMgb24gdGhlIHBpcGVsaW5lLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uTmV4dCBBY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmRvT25OZXh0ID0gb2JzZXJ2YWJsZVByb3RvLnRhcE9uTmV4dCA9IGZ1bmN0aW9uIChvbk5leHQsIHRoaXNBcmcpIHtcbiAgICByZXR1cm4gdGhpcy50YXAodHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24gKHgpIHsgb25OZXh0LmNhbGwodGhpc0FyZywgeCk7IH0gOiBvbk5leHQpO1xuICB9O1xuXG4gIC8qKlxuICAqICBJbnZva2VzIGFuIGFjdGlvbiB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqICBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBmb3IgZGVidWdnaW5nLCBsb2dnaW5nLCBldGMuIG9mIHF1ZXJ5IGJlaGF2aW9yIGJ5IGludGVyY2VwdGluZyB0aGUgbWVzc2FnZSBzdHJlYW0gdG8gcnVuIGFyYml0cmFyeSBhY3Rpb25zIGZvciBtZXNzYWdlcyBvbiB0aGUgcGlwZWxpbmUuXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gb25FcnJvciBBY3Rpb24gdG8gaW52b2tlIHVwb24gZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmRvT25FcnJvciA9IG9ic2VydmFibGVQcm90by50YXBPbkVycm9yID0gZnVuY3Rpb24gKG9uRXJyb3IsIHRoaXNBcmcpIHtcbiAgICByZXR1cm4gdGhpcy50YXAobm9vcCwgdHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24gKGUpIHsgb25FcnJvci5jYWxsKHRoaXNBcmcsIGUpOyB9IDogb25FcnJvcik7XG4gIH07XG5cbiAgLyoqXG4gICogIEludm9rZXMgYW4gYWN0aW9uIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkNvbXBsZXRlZCBBY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmRvT25Db21wbGV0ZWQgPSBvYnNlcnZhYmxlUHJvdG8udGFwT25Db21wbGV0ZWQgPSBmdW5jdGlvbiAob25Db21wbGV0ZWQsIHRoaXNBcmcpIHtcbiAgICByZXR1cm4gdGhpcy50YXAobm9vcCwgbnVsbCwgdHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24gKCkgeyBvbkNvbXBsZXRlZC5jYWxsKHRoaXNBcmcpOyB9IDogb25Db21wbGV0ZWQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiAgSW52b2tlcyBhIHNwZWNpZmllZCBhY3Rpb24gYWZ0ZXIgdGhlIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRlcm1pbmF0ZXMgZ3JhY2VmdWxseSBvciBleGNlcHRpb25hbGx5LlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmaW5hbGx5QWN0aW9uIEFjdGlvbiB0byBpbnZva2UgYWZ0ZXIgdGhlIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRlcm1pbmF0ZXMuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBTb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgYWN0aW9uLWludm9raW5nIHRlcm1pbmF0aW9uIGJlaGF2aW9yIGFwcGxpZWQuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG9bJ2ZpbmFsbHknXSA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICB2YXIgc291cmNlID0gdGhpcztcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICB2YXIgc3Vic2NyaXB0aW9uID0gdHJ5Q2F0Y2goc291cmNlLnN1YnNjcmliZSkuY2FsbChzb3VyY2UsIG9ic2VydmVyKTtcbiAgICAgIGlmIChzdWJzY3JpcHRpb24gPT09IGVycm9yT2JqKSB7XG4gICAgICAgIGFjdGlvbigpO1xuICAgICAgICByZXR1cm4gdGhyb3dlcihzdWJzY3JpcHRpb24uZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByID0gdHJ5Q2F0Y2goc3Vic2NyaXB0aW9uLmRpc3Bvc2UpLmNhbGwoc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgYWN0aW9uKCk7XG4gICAgICAgIHIgPT09IGVycm9yT2JqICYmIHRocm93ZXIoci5lKTtcbiAgICAgIH0pO1xuICAgIH0sIHRoaXMpO1xuICB9O1xuXG4gIHZhciBJZ25vcmVFbGVtZW50c09ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBJZ25vcmVFbGVtZW50c09ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvKSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobykge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IG5vb3A7XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuby5vbkVycm9yKGVycik7XG4gICAgICB9XG4gICAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vYnNlcnZlci5vbkVycm9yKGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICByZXR1cm4gSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICAqICBJZ25vcmVzIGFsbCBlbGVtZW50cyBpbiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGxlYXZpbmcgb25seSB0aGUgdGVybWluYXRpb24gbWVzc2FnZXMuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBlbXB0eSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2lnbmFscyB0ZXJtaW5hdGlvbiwgc3VjY2Vzc2Z1bCBvciBleGNlcHRpb25hbCwgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5pZ25vcmVFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICB2YXIgTWF0ZXJpYWxpemVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhNYXRlcmlhbGl6ZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gTWF0ZXJpYWxpemVPYnNlcnZhYmxlKHNvdXJjZSwgZm4pIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgTWF0ZXJpYWxpemVPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IE1hdGVyaWFsaXplT2JzZXJ2ZXIobykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gTWF0ZXJpYWxpemVPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIE1hdGVyaWFsaXplT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE1hdGVyaWFsaXplT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBNYXRlcmlhbGl6ZU9ic2VydmVyKG8pIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgTWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KG5vdGlmaWNhdGlvbkNyZWF0ZU9uTmV4dCh4KSkgfTtcbiAgICBNYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25OZXh0KG5vdGlmaWNhdGlvbkNyZWF0ZU9uRXJyb3IoZSkpOyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG4gICAgTWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uTmV4dChub3RpZmljYXRpb25DcmVhdGVPbkNvbXBsZXRlZCgpKTsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXG4gICAgcmV0dXJuIE1hdGVyaWFsaXplT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiAgTWF0ZXJpYWxpemVzIHRoZSBpbXBsaWNpdCBub3RpZmljYXRpb25zIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgZXhwbGljaXQgbm90aWZpY2F0aW9uIHZhbHVlcy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgbWF0ZXJpYWxpemVkIG5vdGlmaWNhdGlvbiB2YWx1ZXMgZnJvbSB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLm1hdGVyaWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgTWF0ZXJpYWxpemVPYnNlcnZhYmxlKHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiAgUmVwZWF0cyB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuIElmIHRoZSByZXBlYXQgY291bnQgaXMgbm90IHNwZWNpZmllZCwgdGhlIHNlcXVlbmNlIHJlcGVhdHMgaW5kZWZpbml0ZWx5LlxuICAgKiBAcGFyYW0ge051bWJlcn0gW3JlcGVhdENvdW50XSAgTnVtYmVyIG9mIHRpbWVzIHRvIHJlcGVhdCB0aGUgc2VxdWVuY2UuIElmIG5vdCBwcm92aWRlZCwgcmVwZWF0cyB0aGUgc2VxdWVuY2UgaW5kZWZpbml0ZWx5LlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2VxdWVuY2UgcmVwZWF0ZWRseS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5yZXBlYXQgPSBmdW5jdGlvbiAocmVwZWF0Q291bnQpIHtcbiAgICByZXR1cm4gZW51bWVyYWJsZVJlcGVhdCh0aGlzLCByZXBlYXRDb3VudCkuY29uY2F0KCk7XG4gIH07XG5cbiAgLyoqXG4gICAqICBSZXBlYXRzIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiB0aW1lcyBvciB1bnRpbCBpdCBzdWNjZXNzZnVsbHkgdGVybWluYXRlcy4gSWYgdGhlIHJldHJ5IGNvdW50IGlzIG5vdCBzcGVjaWZpZWQsIGl0IHJldHJpZXMgaW5kZWZpbml0ZWx5LlxuICAgKiAgTm90ZSBpZiB5b3UgZW5jb3VudGVyIGFuIGVycm9yIGFuZCB3YW50IGl0IHRvIHJldHJ5IG9uY2UsIHRoZW4geW91IG11c3QgdXNlIC5yZXRyeSgyKTtcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogIHZhciByZXMgPSByZXRyaWVkID0gcmV0cnkucmVwZWF0KCk7XG4gICAqICB2YXIgcmVzID0gcmV0cmllZCA9IHJldHJ5LnJlcGVhdCgyKTtcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtyZXRyeUNvdW50XSAgTnVtYmVyIG9mIHRpbWVzIHRvIHJldHJ5IHRoZSBzZXF1ZW5jZS4gSWYgbm90IHByb3ZpZGVkLCByZXRyeSB0aGUgc2VxdWVuY2UgaW5kZWZpbml0ZWx5LlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNpbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBzZXF1ZW5jZSByZXBlYXRlZGx5IHVudGlsIGl0IHRlcm1pbmF0ZXMgc3VjY2Vzc2Z1bGx5LlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnJldHJ5ID0gZnVuY3Rpb24gKHJldHJ5Q291bnQpIHtcbiAgICByZXR1cm4gZW51bWVyYWJsZVJlcGVhdCh0aGlzLCByZXRyeUNvdW50KS5jYXRjaEVycm9yKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqICBSZXBlYXRzIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1cG9uIGVycm9yIGVhY2ggdGltZSB0aGUgbm90aWZpZXIgZW1pdHMgb3IgdW50aWwgaXQgc3VjY2Vzc2Z1bGx5IHRlcm1pbmF0ZXMuIFxuICAgKiAgaWYgdGhlIG5vdGlmaWVyIGNvbXBsZXRlcywgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgY29tcGxldGVzLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAgdmFyIHRpbWVyID0gT2JzZXJ2YWJsZS50aW1lcig1MDApO1xuICAgKiAgdmFyIHNvdXJjZSA9IG9ic2VydmFibGUucmV0cnlXaGVuKHRpbWVyKTtcbiAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBbbm90aWZpZXJdIEFuIG9ic2VydmFibGUgdGhhdCB0cmlnZ2VycyB0aGUgcmV0cmllcyBvciBjb21wbGV0ZXMgdGhlIG9ic2VydmFibGUgd2l0aCBvbk5leHQgb3Igb25Db21wbGV0ZWQgcmVzcGVjdGl2ZWx5LlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNpbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBzZXF1ZW5jZSByZXBlYXRlZGx5IHVudGlsIGl0IHRlcm1pbmF0ZXMgc3VjY2Vzc2Z1bGx5LlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnJldHJ5V2hlbiA9IGZ1bmN0aW9uIChub3RpZmllcikge1xuICAgIHJldHVybiBlbnVtZXJhYmxlUmVwZWF0KHRoaXMpLmNhdGNoRXJyb3JXaGVuKG5vdGlmaWVyKTtcbiAgfTtcbiAgdmFyIFNjYW5PYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNjYW5PYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFNjYW5PYnNlcnZhYmxlKHNvdXJjZSwgYWNjdW11bGF0b3IsIGhhc1NlZWQsIHNlZWQpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5hY2N1bXVsYXRvciA9IGFjY3VtdWxhdG9yO1xuICAgICAgdGhpcy5oYXNTZWVkID0gaGFzU2VlZDtcbiAgICAgIHRoaXMuc2VlZCA9IHNlZWQ7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTY2FuT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFNjYW5PYnNlcnZlcihvLHRoaXMpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFNjYW5PYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFNjYW5PYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2Nhbk9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFNjYW5PYnNlcnZlcihvLCBwYXJlbnQpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcCA9IHBhcmVudDtcbiAgICAgIHRoaXMuX2ZuID0gcGFyZW50LmFjY3VtdWxhdG9yO1xuICAgICAgdGhpcy5faHMgPSBwYXJlbnQuaGFzU2VlZDtcbiAgICAgIHRoaXMuX3MgPSBwYXJlbnQuc2VlZDtcbiAgICAgIHRoaXMuX2hhID0gZmFsc2U7XG4gICAgICB0aGlzLl9hID0gbnVsbDtcbiAgICAgIHRoaXMuX2h2ID0gZmFsc2U7XG4gICAgICB0aGlzLl9pID0gMDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFNjYW5PYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAhdGhpcy5faHYgJiYgKHRoaXMuX2h2ID0gdHJ1ZSk7XG4gICAgICBpZiAodGhpcy5faGEpIHtcbiAgICAgICAgdGhpcy5fYSA9IHRyeUNhdGNoKHRoaXMuX2ZuKSh0aGlzLl9hLCB4LCB0aGlzLl9pLCB0aGlzLl9wKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2EgPSB0aGlzLl9ocyA/IHRyeUNhdGNoKHRoaXMuX2ZuKSh0aGlzLl9zLCB4LCB0aGlzLl9pLCB0aGlzLl9wKSA6IHg7XG4gICAgICAgIHRoaXMuX2hhID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLl9hID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHRoaXMuX2EuZSk7IH1cbiAgICAgIHRoaXMuX28ub25OZXh0KHRoaXMuX2EpO1xuICAgICAgdGhpcy5faSsrO1xuICAgIH07XG5cbiAgICBTY2FuT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgU2Nhbk9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAhdGhpcy5faHYgJiYgdGhpcy5faHMgJiYgdGhpcy5fby5vbk5leHQodGhpcy5fcyk7XG4gICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBTY2FuT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAqICBBcHBsaWVzIGFuIGFjY3VtdWxhdG9yIGZ1bmN0aW9uIG92ZXIgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhbmQgcmV0dXJucyBlYWNoIGludGVybWVkaWF0ZSByZXN1bHQuIFRoZSBvcHRpb25hbCBzZWVkIHZhbHVlIGlzIHVzZWQgYXMgdGhlIGluaXRpYWwgYWNjdW11bGF0b3IgdmFsdWUuXG4gICogIEZvciBhZ2dyZWdhdGlvbiBiZWhhdmlvciB3aXRoIG5vIGludGVybWVkaWF0ZSByZXN1bHRzLCBzZWUgT2JzZXJ2YWJsZS5hZ2dyZWdhdGUuXG4gICogQHBhcmFtIHtNaXhlZH0gW3NlZWRdIFRoZSBpbml0aWFsIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjY3VtdWxhdG9yIEFuIGFjY3VtdWxhdG9yIGZ1bmN0aW9uIHRvIGJlIGludm9rZWQgb24gZWFjaCBlbGVtZW50LlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIGFjY3VtdWxhdGVkIHZhbHVlcy5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNjYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGhhc1NlZWQgPSBmYWxzZSwgc2VlZCwgYWNjdW11bGF0b3IgPSBhcmd1bWVudHNbMF07XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgIGhhc1NlZWQgPSB0cnVlO1xuICAgICAgc2VlZCA9IGFyZ3VtZW50c1sxXTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBTY2FuT2JzZXJ2YWJsZSh0aGlzLCBhY2N1bXVsYXRvciwgaGFzU2VlZCwgc2VlZCk7XG4gIH07XG5cbiAgdmFyIFNraXBMYXN0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2tpcExhc3RPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFNraXBMYXN0T2JzZXJ2YWJsZShzb3VyY2UsIGMpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fYyA9IGM7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwTGFzdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgU2tpcExhc3RPYnNlcnZlcihvLCB0aGlzLl9jKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBTa2lwTGFzdE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgU2tpcExhc3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2tpcExhc3RPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwTGFzdE9ic2VydmVyKG8sIGMpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fYyA9IGM7XG4gICAgICB0aGlzLl9xID0gW107XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwTGFzdE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMuX3EucHVzaCh4KTtcbiAgICAgIHRoaXMuX3EubGVuZ3RoID4gdGhpcy5fYyAmJiB0aGlzLl9vLm9uTmV4dCh0aGlzLl9xLnNoaWZ0KCkpO1xuICAgIH07XG5cbiAgICBTa2lwTGFzdE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIFNraXBMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFNraXBMYXN0T2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiAgQnlwYXNzZXMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGF0IHRoZSBlbmQgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQGRlc2NyaXB0aW9uXG4gICAqICBUaGlzIG9wZXJhdG9yIGFjY3VtdWxhdGVzIGEgcXVldWUgd2l0aCBhIGxlbmd0aCBlbm91Z2ggdG8gc3RvcmUgdGhlIGZpcnN0IGBjb3VudGAgZWxlbWVudHMuIEFzIG1vcmUgZWxlbWVudHMgYXJlXG4gICAqICByZWNlaXZlZCwgZWxlbWVudHMgYXJlIHRha2VuIGZyb20gdGhlIGZyb250IG9mIHRoZSBxdWV1ZSBhbmQgcHJvZHVjZWQgb24gdGhlIHJlc3VsdCBzZXF1ZW5jZS4gVGhpcyBjYXVzZXMgZWxlbWVudHMgdG8gYmUgZGVsYXllZC5cbiAgICogQHBhcmFtIGNvdW50IE51bWJlciBvZiBlbGVtZW50cyB0byBieXBhc3MgYXQgdGhlIGVuZCBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UgZWxlbWVudHMgZXhjZXB0IGZvciB0aGUgYnlwYXNzZWQgb25lcyBhdCB0aGUgZW5kLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNraXBMYXN0ID0gZnVuY3Rpb24gKGNvdW50KSB7XG4gICAgaWYgKGNvdW50IDwgMCkgeyB0aHJvdyBuZXcgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IoKTsgfVxuICAgIHJldHVybiBuZXcgU2tpcExhc3RPYnNlcnZhYmxlKHRoaXMsIGNvdW50KTtcbiAgfTtcblxuICAvKipcbiAgICogIFByZXBlbmRzIGEgc2VxdWVuY2Ugb2YgdmFsdWVzIHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBzY2hlZHVsZXIgYW5kIGFuIGFyZ3VtZW50IGxpc3Qgb2YgdmFsdWVzIHRvIHByZXBlbmQuXG4gICAqICBAZXhhbXBsZVxuICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5zdGFydFdpdGgoMSwgMiwgMyk7XG4gICAqICB2YXIgcmVzID0gc291cmNlLnN0YXJ0V2l0aChSeC5TY2hlZHVsZXIudGltZW91dCwgMSwgMiwgMyk7XG4gICAqIEBwYXJhbSB7QXJndW1lbnRzfSBhcmdzIFRoZSBzcGVjaWZpZWQgdmFsdWVzIHRvIHByZXBlbmQgdG8gdGhlIG9ic2VydmFibGUgc2VxdWVuY2VcbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2UgcHJlcGVuZGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZXMuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc3RhcnRXaXRoID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB2YWx1ZXMsIHNjaGVkdWxlciwgc3RhcnQgPSAwO1xuICAgIGlmICghIWFyZ3VtZW50cy5sZW5ndGggJiYgaXNTY2hlZHVsZXIoYXJndW1lbnRzWzBdKSkge1xuICAgICAgc2NoZWR1bGVyID0gYXJndW1lbnRzWzBdO1xuICAgICAgc3RhcnQgPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICBzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXI7XG4gICAgfVxuICAgIGZvcih2YXIgYXJncyA9IFtdLCBpID0gc3RhcnQsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuICAgIHJldHVybiBlbnVtZXJhYmxlT2YoW29ic2VydmFibGVGcm9tQXJyYXkoYXJncywgc2NoZWR1bGVyKSwgdGhpc10pLmNvbmNhdCgpO1xuICB9O1xuXG4gIHZhciBUYWtlTGFzdE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYWtlTGFzdE9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFRha2VMYXN0T2JzZXJ2ZXIobywgYykge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9jID0gYztcbiAgICAgIHRoaXMuX3EgPSBbXTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRha2VMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdGhpcy5fcS5wdXNoKHgpO1xuICAgICAgdGhpcy5fcS5sZW5ndGggPiB0aGlzLl9jICYmIHRoaXMuX3Euc2hpZnQoKTtcbiAgICB9O1xuXG4gICAgVGFrZUxhc3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBUYWtlTGFzdE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB3aGlsZSAodGhpcy5fcS5sZW5ndGggPiAwKSB7IHRoaXMuX28ub25OZXh0KHRoaXMuX3Euc2hpZnQoKSk7IH1cbiAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRha2VMYXN0T2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiAgUmV0dXJucyBhIHNwZWNpZmllZCBudW1iZXIgb2YgY29udGlndW91cyBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQGRlc2NyaXB0aW9uXG4gICAqICBUaGlzIG9wZXJhdG9yIGFjY3VtdWxhdGVzIGEgYnVmZmVyIHdpdGggYSBsZW5ndGggZW5vdWdoIHRvIHN0b3JlIGVsZW1lbnRzIGNvdW50IGVsZW1lbnRzLiBVcG9uIGNvbXBsZXRpb24gb2ZcbiAgICogIHRoZSBzb3VyY2Ugc2VxdWVuY2UsIHRoaXMgYnVmZmVyIGlzIGRyYWluZWQgb24gdGhlIHJlc3VsdCBzZXF1ZW5jZS4gVGhpcyBjYXVzZXMgdGhlIGVsZW1lbnRzIHRvIGJlIGRlbGF5ZWQuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCBOdW1iZXIgb2YgZWxlbWVudHMgdG8gdGFrZSBmcm9tIHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50YWtlTGFzdCA9IGZ1bmN0aW9uIChjb3VudCkge1xuICAgIGlmIChjb3VudCA8IDApIHsgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yKCk7IH1cbiAgICB2YXIgc291cmNlID0gdGhpcztcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBUYWtlTGFzdE9ic2VydmVyKG8sIGNvdW50KSk7XG4gICAgfSwgc291cmNlKTtcbiAgfTtcblxub2JzZXJ2YWJsZVByb3RvLmZsYXRNYXBDb25jYXQgPSBvYnNlcnZhYmxlUHJvdG8uY29uY2F0TWFwID0gZnVuY3Rpb24oc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIG5ldyBGbGF0TWFwT2JzZXJ2YWJsZSh0aGlzLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpLm1lcmdlKDEpO1xufTtcbiAgdmFyIE1hcE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE1hcE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBNYXBPYnNlcnZhYmxlKHNvdXJjZSwgc2VsZWN0b3IsIHRoaXNBcmcpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5zZWxlY3RvciA9IGJpbmRDYWxsYmFjayhzZWxlY3RvciwgdGhpc0FyZywgMyk7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbm5lck1hcChzZWxlY3Rvciwgc2VsZikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh4LCBpLCBvKSB7IHJldHVybiBzZWxlY3Rvci5jYWxsKHRoaXMsIHNlbGYuc2VsZWN0b3IoeCwgaSwgbyksIGksIG8pOyB9XG4gICAgfVxuXG4gICAgTWFwT2JzZXJ2YWJsZS5wcm90b3R5cGUuaW50ZXJuYWxNYXAgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIHRoaXNBcmcpIHtcbiAgICAgIHJldHVybiBuZXcgTWFwT2JzZXJ2YWJsZSh0aGlzLnNvdXJjZSwgaW5uZXJNYXAoc2VsZWN0b3IsIHRoaXMpLCB0aGlzQXJnKTtcbiAgICB9O1xuXG4gICAgTWFwT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMuc2VsZWN0b3IsIHRoaXMpKTtcbiAgICB9O1xuXG4gICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBzZWxlY3Rvciwgc291cmNlKSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLmkgPSAwO1xuICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbih4KSB7XG4gICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5zZWxlY3RvcikoeCwgdGhpcy5pKyssIHRoaXMuc291cmNlKTtcbiAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihyZXN1bHQuZSk7IH1cbiAgICAgIHRoaXMuby5vbk5leHQocmVzdWx0KTtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gTWFwT2JzZXJ2YWJsZTtcblxuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICogUHJvamVjdHMgZWFjaCBlbGVtZW50IG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgaW50byBhIG5ldyBmb3JtIGJ5IGluY29ycG9yYXRpbmcgdGhlIGVsZW1lbnQncyBpbmRleC5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzZWxlY3RvciBBIHRyYW5zZm9ybSBmdW5jdGlvbiB0byBhcHBseSB0byBlYWNoIHNvdXJjZSBlbGVtZW50OyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSB0cmFuc2Zvcm0gZnVuY3Rpb24gb24gZWFjaCBlbGVtZW50IG9mIHNvdXJjZS5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLm1hcCA9IG9ic2VydmFibGVQcm90by5zZWxlY3QgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIHRoaXNBcmcpIHtcbiAgICB2YXIgc2VsZWN0b3JGbiA9IHR5cGVvZiBzZWxlY3RvciA9PT0gJ2Z1bmN0aW9uJyA/IHNlbGVjdG9yIDogZnVuY3Rpb24gKCkgeyByZXR1cm4gc2VsZWN0b3I7IH07XG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBNYXBPYnNlcnZhYmxlID9cbiAgICAgIHRoaXMuaW50ZXJuYWxNYXAoc2VsZWN0b3JGbiwgdGhpc0FyZykgOlxuICAgICAgbmV3IE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3JGbiwgdGhpc0FyZyk7XG4gIH07XG5cbiAgZnVuY3Rpb24gcGx1Y2tlcihhcmdzLCBsZW4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gbWFwcGVyKHgpIHtcbiAgICAgIHZhciBjdXJyZW50UHJvcCA9IHg7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHZhciBwID0gY3VycmVudFByb3BbYXJnc1tpXV07XG4gICAgICAgIGlmICh0eXBlb2YgcCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICBjdXJyZW50UHJvcCA9IHA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGN1cnJlbnRQcm9wO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgdGhlIHZhbHVlIG9mIGEgc3BlY2lmaWVkIG5lc3RlZCBwcm9wZXJ0eSBmcm9tIGFsbCBlbGVtZW50cyBpblxuICAgKiB0aGUgT2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtBcmd1bWVudHN9IGFyZ3VtZW50cyBUaGUgbmVzdGVkIHByb3BlcnRpZXMgdG8gcGx1Y2suXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBSZXR1cm5zIGEgbmV3IE9ic2VydmFibGUgc2VxdWVuY2Ugb2YgcHJvcGVydHkgdmFsdWVzLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnBsdWNrID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG4gICAgaWYgKGxlbiA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoJ0xpc3Qgb2YgcHJvcGVydGllcyBjYW5ub3QgYmUgZW1wdHkuJyk7IH1cbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIHJldHVybiB0aGlzLm1hcChwbHVja2VyKGFyZ3MsIGxlbikpO1xuICB9O1xuXG5vYnNlcnZhYmxlUHJvdG8uZmxhdE1hcCA9IG9ic2VydmFibGVQcm90by5zZWxlY3RNYW55ID0gZnVuY3Rpb24oc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIG5ldyBGbGF0TWFwT2JzZXJ2YWJsZSh0aGlzLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpLm1lcmdlQWxsKCk7XG59O1xuXG5cbi8vXG4vL1J4Lk9ic2VydmFibGUucHJvdG90eXBlLmZsYXRNYXBXaXRoTWF4Q29uY3VycmVudCA9IGZ1bmN0aW9uKGxpbWl0LCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpIHtcbi8vICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5tZXJnZShsaW1pdCk7XG4vL307XG4vL1xuXG5SeC5PYnNlcnZhYmxlLnByb3RvdHlwZS5mbGF0TWFwTGF0ZXN0ID0gZnVuY3Rpb24oc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIG5ldyBGbGF0TWFwT2JzZXJ2YWJsZSh0aGlzLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpLnN3aXRjaExhdGVzdCgpO1xufTtcbiAgdmFyIFNraXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFNraXBPYnNlcnZhYmxlKHNvdXJjZSwgY291bnQpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5za2lwQ291bnQgPSBjb3VudDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICBcbiAgICBTa2lwT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMuc2tpcENvdW50KSk7XG4gICAgfTtcbiAgICBcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIGMpIHtcbiAgICAgIHRoaXMuYyA9IGM7XG4gICAgICB0aGlzLnIgPSBjO1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICBpZiAodGhpcy5yIDw9IDApIHsgXG4gICAgICAgIHRoaXMuby5vbk5leHQoeCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnItLTtcbiAgICAgIH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgdGhpcy5vLm9uRXJyb3IoZSk7IH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24oKSB7XG4gICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgdGhpcy5vLm9uQ29tcGxldGVkKCk7IH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIFNraXBPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7ICBcbiAgXG4gIC8qKlxuICAgKiBCeXBhc3NlcyBhIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMgaW4gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhbmQgdGhlbiByZXR1cm5zIHRoZSByZW1haW5pbmcgZWxlbWVudHMuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHNraXAgYmVmb3JlIHJldHVybmluZyB0aGUgcmVtYWluaW5nIGVsZW1lbnRzLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyB0aGF0IG9jY3VyIGFmdGVyIHRoZSBzcGVjaWZpZWQgaW5kZXggaW4gdGhlIGlucHV0IHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNraXAgPSBmdW5jdGlvbiAoY291bnQpIHtcbiAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG4gICAgcmV0dXJuIG5ldyBTa2lwT2JzZXJ2YWJsZSh0aGlzLCBjb3VudCk7XG4gIH07XG4gIHZhciBTa2lwV2hpbGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTa2lwV2hpbGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFNraXBXaGlsZU9ic2VydmFibGUoc291cmNlLCBmbikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9mbiA9IGZuO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2tpcFdoaWxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBTa2lwV2hpbGVPYnNlcnZlcihvLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBTa2lwV2hpbGVPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFNraXBXaGlsZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTa2lwV2hpbGVPYnNlcnZlciwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIFNraXBXaGlsZU9ic2VydmVyKG8sIHApIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9pID0gMDtcbiAgICAgIHRoaXMuX3IgPSBmYWxzZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFNraXBXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIGlmICghdGhpcy5fcikge1xuICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5fcC5fZm4pKHgsIHRoaXMuX2krKywgdGhpcy5fcCk7XG4gICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG4gICAgICAgIHRoaXMuX3IgPSAhcmVzO1xuICAgICAgfVxuICAgICAgdGhpcy5fciAmJiB0aGlzLl9vLm9uTmV4dCh4KTtcbiAgICB9O1xuICAgIFNraXBXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcbiAgICBTa2lwV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cbiAgICByZXR1cm4gU2tpcFdoaWxlT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiAgQnlwYXNzZXMgZWxlbWVudHMgaW4gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyBsb25nIGFzIGEgc3BlY2lmaWVkIGNvbmRpdGlvbiBpcyB0cnVlIGFuZCB0aGVuIHJldHVybnMgdGhlIHJlbWFpbmluZyBlbGVtZW50cy5cbiAgICogIFRoZSBlbGVtZW50J3MgaW5kZXggaXMgdXNlZCBpbiB0aGUgbG9naWMgb2YgdGhlIHByZWRpY2F0ZSBmdW5jdGlvbi5cbiAgICpcbiAgICogIHZhciByZXMgPSBzb3VyY2Uuc2tpcFdoaWxlKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgPCAxMDsgfSk7XG4gICAqICB2YXIgcmVzID0gc291cmNlLnNraXBXaGlsZShmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7IHJldHVybiB2YWx1ZSA8IDEwIHx8IGluZGV4IDwgMTA7IH0pO1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgQSBmdW5jdGlvbiB0byB0ZXN0IGVhY2ggZWxlbWVudCBmb3IgYSBjb25kaXRpb247IHRoZSBzZWNvbmQgcGFyYW1ldGVyIG9mIHRoZSBmdW5jdGlvbiByZXByZXNlbnRzIHRoZSBpbmRleCBvZiB0aGUgc291cmNlIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBmcm9tIHRoZSBpbnB1dCBzZXF1ZW5jZSBzdGFydGluZyBhdCB0aGUgZmlyc3QgZWxlbWVudCBpbiB0aGUgbGluZWFyIHNlcmllcyB0aGF0IGRvZXMgbm90IHBhc3MgdGhlIHRlc3Qgc3BlY2lmaWVkIGJ5IHByZWRpY2F0ZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5za2lwV2hpbGUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB0aGlzQXJnKSB7XG4gICAgdmFyIGZuID0gYmluZENhbGxiYWNrKHByZWRpY2F0ZSwgdGhpc0FyZywgMyk7XG4gICAgcmV0dXJuIG5ldyBTa2lwV2hpbGVPYnNlcnZhYmxlKHRoaXMsIGZuKTtcbiAgfTtcblxuICB2YXIgVGFrZU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGFrZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgXG4gICAgZnVuY3Rpb24gVGFrZU9ic2VydmFibGUoc291cmNlLCBjb3VudCkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLnRha2VDb3VudCA9IGNvdW50O1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIFxuICAgIFRha2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgdGhpcy50YWtlQ291bnQpKTtcbiAgICB9O1xuICAgIFxuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgYykge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMuYyA9IGM7XG4gICAgICB0aGlzLnIgPSBjO1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICB9XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUgPSB7XG4gICAgICBvbk5leHQ6IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgaWYgKHRoaXMuci0tID4gMCkge1xuICAgICAgICAgIHRoaXMuby5vbk5leHQoeCk7XG4gICAgICAgICAgdGhpcy5yIDw9IDAgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZXJyKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfSxcbiAgICAgIGZhaWw6IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIFRha2VPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7ICBcbiAgXG4gIC8qKlxuICAgKiAgUmV0dXJucyBhIHNwZWNpZmllZCBudW1iZXIgb2YgY29udGlndW91cyBlbGVtZW50cyBmcm9tIHRoZSBzdGFydCBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciBmb3IgdGhlIGVkZ2UgY2FzZSBvZiB0YWtlKDApLlxuICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byByZXR1cm4uXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdXNlZCB0byBwcm9kdWNlIGFuIE9uQ29tcGxldGVkIG1lc3NhZ2UgaW4gY2FzZSA8cGFyYW1yZWYgbmFtZT1cImNvdW50IGNvdW50PC9wYXJhbXJlZj4gaXMgc2V0IHRvIDAuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgdGhlIGlucHV0IHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnRha2UgPSBmdW5jdGlvbiAoY291bnQsIHNjaGVkdWxlcikge1xuICAgIGlmIChjb3VudCA8IDApIHsgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yKCk7IH1cbiAgICBpZiAoY291bnQgPT09IDApIHsgcmV0dXJuIG9ic2VydmFibGVFbXB0eShzY2hlZHVsZXIpOyB9XG4gICAgcmV0dXJuIG5ldyBUYWtlT2JzZXJ2YWJsZSh0aGlzLCBjb3VudCk7XG4gIH07XG5cbiAgdmFyIFRha2VXaGlsZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRha2VXaGlsZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGFrZVdoaWxlT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX2ZuID0gZm47XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUYWtlV2hpbGVPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFRha2VXaGlsZU9ic2VydmVyKG8sIHRoaXMpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRha2VXaGlsZU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgVGFrZVdoaWxlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRha2VXaGlsZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gVGFrZVdoaWxlT2JzZXJ2ZXIobywgcCkge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9wID0gcDtcbiAgICAgIHRoaXMuX2kgPSAwO1xuICAgICAgdGhpcy5fciA9IHRydWU7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUYWtlV2hpbGVPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICBpZiAodGhpcy5fcikge1xuICAgICAgICB0aGlzLl9yID0gdHJ5Q2F0Y2godGhpcy5fcC5fZm4pKHgsIHRoaXMuX2krKywgdGhpcy5fcCk7XG4gICAgICAgIGlmICh0aGlzLl9yID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHRoaXMuX3IuZSk7IH1cbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLl9yKSB7XG4gICAgICAgIHRoaXMuX28ub25OZXh0KHgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgVGFrZVdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fby5vbkVycm9yKGUpOyB9O1xuICAgIFRha2VXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblxuICAgIHJldHVybiBUYWtlV2hpbGVPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICAqICBSZXR1cm5zIGVsZW1lbnRzIGZyb20gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyBsb25nIGFzIGEgc3BlY2lmaWVkIGNvbmRpdGlvbiBpcyB0cnVlLlxuICAgKiAgVGhlIGVsZW1lbnQncyBpbmRleCBpcyB1c2VkIGluIHRoZSBsb2dpYyBvZiB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgQSBmdW5jdGlvbiB0byB0ZXN0IGVhY2ggZWxlbWVudCBmb3IgYSBjb25kaXRpb247IHRoZSBzZWNvbmQgcGFyYW1ldGVyIG9mIHRoZSBmdW5jdGlvbiByZXByZXNlbnRzIHRoZSBpbmRleCBvZiB0aGUgc291cmNlIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBmcm9tIHRoZSBpbnB1dCBzZXF1ZW5jZSB0aGF0IG9jY3VyIGJlZm9yZSB0aGUgZWxlbWVudCBhdCB3aGljaCB0aGUgdGVzdCBubyBsb25nZXIgcGFzc2VzLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnRha2VXaGlsZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHRoaXNBcmcpIHtcbiAgICB2YXIgZm4gPSBiaW5kQ2FsbGJhY2socHJlZGljYXRlLCB0aGlzQXJnLCAzKTtcbiAgICByZXR1cm4gbmV3IFRha2VXaGlsZU9ic2VydmFibGUodGhpcywgZm4pO1xuICB9O1xuXG4gIHZhciBGaWx0ZXJPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhGaWx0ZXJPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gRmlsdGVyT2JzZXJ2YWJsZShzb3VyY2UsIHByZWRpY2F0ZSwgdGhpc0FyZykge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLnByZWRpY2F0ZSA9IGJpbmRDYWxsYmFjayhwcmVkaWNhdGUsIHRoaXNBcmcsIDMpO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRmlsdGVyT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMucHJlZGljYXRlLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGlubmVyUHJlZGljYXRlKHByZWRpY2F0ZSwgc2VsZikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHgsIGksIG8pIHsgcmV0dXJuIHNlbGYucHJlZGljYXRlKHgsIGksIG8pICYmIHByZWRpY2F0ZS5jYWxsKHRoaXMsIHgsIGksIG8pOyB9XG4gICAgfVxuXG4gICAgRmlsdGVyT2JzZXJ2YWJsZS5wcm90b3R5cGUuaW50ZXJuYWxGaWx0ZXIgPSBmdW5jdGlvbihwcmVkaWNhdGUsIHRoaXNBcmcpIHtcbiAgICAgIHJldHVybiBuZXcgRmlsdGVyT2JzZXJ2YWJsZSh0aGlzLnNvdXJjZSwgaW5uZXJQcmVkaWNhdGUocHJlZGljYXRlLCB0aGlzKSwgdGhpc0FyZyk7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgcHJlZGljYXRlLCBzb3VyY2UpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLnByZWRpY2F0ZSA9IHByZWRpY2F0ZTtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5pID0gMDtcbiAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuICAgICAgdmFyIHNob3VsZFlpZWxkID0gdHJ5Q2F0Y2godGhpcy5wcmVkaWNhdGUpKHgsIHRoaXMuaSsrLCB0aGlzLnNvdXJjZSk7XG4gICAgICBpZiAoc2hvdWxkWWllbGQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm8ub25FcnJvcihzaG91bGRZaWVsZC5lKTtcbiAgICAgIH1cbiAgICAgIHNob3VsZFlpZWxkICYmIHRoaXMuby5vbk5leHQoeCk7XG4gICAgfTtcblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEZpbHRlck9ic2VydmFibGU7XG5cbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqICBGaWx0ZXJzIHRoZSBlbGVtZW50cyBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGJhc2VkIG9uIGEgcHJlZGljYXRlIGJ5IGluY29ycG9yYXRpbmcgdGhlIGVsZW1lbnQncyBpbmRleC5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgQSBmdW5jdGlvbiB0byB0ZXN0IGVhY2ggc291cmNlIGVsZW1lbnQgZm9yIGEgY29uZGl0aW9uOyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgZWxlbWVudHMgZnJvbSB0aGUgaW5wdXQgc2VxdWVuY2UgdGhhdCBzYXRpc2Z5IHRoZSBjb25kaXRpb24uXG4gICovXG4gIG9ic2VydmFibGVQcm90by5maWx0ZXIgPSBvYnNlcnZhYmxlUHJvdG8ud2hlcmUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBGaWx0ZXJPYnNlcnZhYmxlID8gdGhpcy5pbnRlcm5hbEZpbHRlcihwcmVkaWNhdGUsIHRoaXNBcmcpIDpcbiAgICAgIG5ldyBGaWx0ZXJPYnNlcnZhYmxlKHRoaXMsIHByZWRpY2F0ZSwgdGhpc0FyZyk7XG4gIH07XG5cbmZ1bmN0aW9uIGNyZWF0ZUNiT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncykge1xuICB2YXIgbyA9IG5ldyBBc3luY1N1YmplY3QoKTtcblxuICBhcmdzLnB1c2goY3JlYXRlQ2JIYW5kbGVyKG8sIGN0eCwgc2VsZWN0b3IpKTtcbiAgZm4uYXBwbHkoY3R4LCBhcmdzKTtcblxuICByZXR1cm4gby5hc09ic2VydmFibGUoKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2JIYW5kbGVyKG8sIGN0eCwgc2VsZWN0b3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCByZXN1bHRzID0gbmV3IEFycmF5KGxlbik7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IHJlc3VsdHNbaV0gPSBhcmd1bWVudHNbaV07IH1cblxuICAgIGlmIChpc0Z1bmN0aW9uKHNlbGVjdG9yKSkge1xuICAgICAgcmVzdWx0cyA9IHRyeUNhdGNoKHNlbGVjdG9yKS5hcHBseShjdHgsIHJlc3VsdHMpO1xuICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuICAgICAgby5vbk5leHQocmVzdWx0cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgIG8ub25OZXh0KHJlc3VsdHNbMF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgby5vbk5leHQocmVzdWx0cyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgby5vbkNvbXBsZXRlZCgpO1xuICB9O1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBGdW5jdGlvbiB3aXRoIGEgY2FsbGJhY2sgYXMgdGhlIGxhc3QgcGFyYW1ldGVyIHRvIGNvbnZlcnQgdG8gYW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAqIEBwYXJhbSB7TWl4ZWR9IFtjdHhdIFRoZSBjb250ZXh0IGZvciB0aGUgZnVuYyBwYXJhbWV0ZXIgdG8gYmUgZXhlY3V0ZWQuICBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byB1bmRlZmluZWQuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBjYWxsYmFjayB0byBwcm9kdWNlIGEgc2luZ2xlIGl0ZW0gdG8geWllbGQgb24gbmV4dC5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gQSBmdW5jdGlvbiwgd2hlbiBleGVjdXRlZCB3aXRoIHRoZSByZXF1aXJlZCBwYXJhbWV0ZXJzIG1pbnVzIHRoZSBjYWxsYmFjaywgcHJvZHVjZXMgYW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIGEgc2luZ2xlIHZhbHVlIG9mIHRoZSBhcmd1bWVudHMgdG8gdGhlIGNhbGxiYWNrIGFzIGFuIGFycmF5LlxuICovXG5PYnNlcnZhYmxlLmZyb21DYWxsYmFjayA9IGZ1bmN0aW9uIChmbiwgY3R4LCBzZWxlY3Rvcikge1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHR5cGVvZiBjdHggPT09ICd1bmRlZmluZWQnICYmIChjdHggPSB0aGlzKTsgXG5cbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pXG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICByZXR1cm4gY3JlYXRlQ2JPYnNlcnZhYmxlKGZuLCBjdHgsIHNlbGVjdG9yLCBhcmdzKTtcbiAgfTtcbn07XG5cbmZ1bmN0aW9uIGNyZWF0ZU5vZGVPYnNlcnZhYmxlKGZuLCBjdHgsIHNlbGVjdG9yLCBhcmdzKSB7XG4gIHZhciBvID0gbmV3IEFzeW5jU3ViamVjdCgpO1xuXG4gIGFyZ3MucHVzaChjcmVhdGVOb2RlSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSk7XG4gIGZuLmFwcGx5KGN0eCwgYXJncyk7XG5cbiAgcmV0dXJuIG8uYXNPYnNlcnZhYmxlKCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZU5vZGVIYW5kbGVyKG8sIGN0eCwgc2VsZWN0b3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuICAgIHZhciBlcnIgPSBhcmd1bWVudHNbMF07XG4gICAgaWYgKGVycikgeyByZXR1cm4gby5vbkVycm9yKGVycik7IH1cblxuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCByZXN1bHRzID0gW107XG4gICAgZm9yKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7IHJlc3VsdHNbaSAtIDFdID0gYXJndW1lbnRzW2ldOyB9XG5cbiAgICBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHtcbiAgICAgIHZhciByZXN1bHRzID0gdHJ5Q2F0Y2goc2VsZWN0b3IpLmFwcGx5KGN0eCwgcmVzdWx0cyk7XG4gICAgICBpZiAocmVzdWx0cyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXN1bHRzLmUpOyB9XG4gICAgICBvLm9uTmV4dChyZXN1bHRzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoIDw9IDEpIHtcbiAgICAgICAgby5vbk5leHQocmVzdWx0c1swXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBvLm9uQ29tcGxldGVkKCk7XG4gIH07XG59XG5cbi8qKlxuICogQ29udmVydHMgYSBOb2RlLmpzIGNhbGxiYWNrIHN0eWxlIGZ1bmN0aW9uIHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuICBUaGlzIG11c3QgYmUgaW4gZnVuY3Rpb24gKGVyciwgLi4uKSBmb3JtYXQuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gY2FsbFxuICogQHBhcmFtIHtNaXhlZH0gW2N0eF0gVGhlIGNvbnRleHQgZm9yIHRoZSBmdW5jIHBhcmFtZXRlciB0byBiZSBleGVjdXRlZC4gIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIHVuZGVmaW5lZC5cbiAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gQSBzZWxlY3RvciB3aGljaCB0YWtlcyB0aGUgYXJndW1lbnRzIGZyb20gdGhlIGNhbGxiYWNrIG1pbnVzIHRoZSBlcnJvciB0byBwcm9kdWNlIGEgc2luZ2xlIGl0ZW0gdG8geWllbGQgb24gbmV4dC5cbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gQW4gYXN5bmMgZnVuY3Rpb24gd2hpY2ggd2hlbiBhcHBsaWVkLCByZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCB0aGUgY2FsbGJhY2sgYXJndW1lbnRzIGFzIGFuIGFycmF5LlxuICovXG5PYnNlcnZhYmxlLmZyb21Ob2RlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZm4sIGN0eCwgc2VsZWN0b3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB0eXBlb2YgY3R4ID09PSAndW5kZWZpbmVkJyAmJiAoY3R4ID0gdGhpcyk7IFxuICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICByZXR1cm4gY3JlYXRlTm9kZU9ic2VydmFibGUoZm4sIGN0eCwgc2VsZWN0b3IsIGFyZ3MpO1xuICB9O1xufTtcblxuICBmdW5jdGlvbiBpc05vZGVMaXN0KGVsKSB7XG4gICAgaWYgKHJvb3QuU3RhdGljTm9kZUxpc3QpIHtcbiAgICAgIC8vIElFOCBTcGVjaWZpY1xuICAgICAgLy8gaW5zdGFuY2VvZiBpcyBzbG93ZXIgdGhhbiBPYmplY3QjdG9TdHJpbmcsIGJ1dCBPYmplY3QjdG9TdHJpbmcgd2lsbCBub3Qgd29yayBhcyBpbnRlbmRlZCBpbiBJRThcbiAgICAgIHJldHVybiBlbCBpbnN0YW5jZW9mIHJvb3QuU3RhdGljTm9kZUxpc3QgfHwgZWwgaW5zdGFuY2VvZiByb290Lk5vZGVMaXN0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGVsKSA9PT0gJ1tvYmplY3QgTm9kZUxpc3RdJztcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBMaXN0ZW5EaXNwb3NhYmxlKGUsIG4sIGZuKSB7XG4gICAgdGhpcy5fZSA9IGU7XG4gICAgdGhpcy5fbiA9IG47XG4gICAgdGhpcy5fZm4gPSBmbjtcbiAgICB0aGlzLl9lLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fbiwgdGhpcy5fZm4sIGZhbHNlKTtcbiAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgfVxuICBMaXN0ZW5EaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICB0aGlzLl9lLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fbiwgdGhpcy5fZm4sIGZhbHNlKTtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIGNyZWF0ZUV2ZW50TGlzdGVuZXIgKGVsLCBldmVudE5hbWUsIGhhbmRsZXIpIHtcbiAgICB2YXIgZGlzcG9zYWJsZXMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuXG4gICAgLy8gQXN1bWUgTm9kZUxpc3Qgb3IgSFRNTENvbGxlY3Rpb25cbiAgICB2YXIgZWxlbVRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGVsKTtcbiAgICBpZiAoaXNOb2RlTGlzdChlbCkgfHwgZWxlbVRvU3RyaW5nID09PSAnW29iamVjdCBIVE1MQ29sbGVjdGlvbl0nKSB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gZWwubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgZGlzcG9zYWJsZXMuYWRkKGNyZWF0ZUV2ZW50TGlzdGVuZXIoZWwuaXRlbShpKSwgZXZlbnROYW1lLCBoYW5kbGVyKSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChlbCkge1xuICAgICAgZGlzcG9zYWJsZXMuYWRkKG5ldyBMaXN0ZW5EaXNwb3NhYmxlKGVsLCBldmVudE5hbWUsIGhhbmRsZXIpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGlzcG9zYWJsZXM7XG4gIH1cblxuICAvKipcbiAgICogQ29uZmlndXJhdGlvbiBvcHRpb24gdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdG8gdXNlIG5hdGl2ZSBldmVudHMgb25seVxuICAgKi9cbiAgUnguY29uZmlnLnVzZU5hdGl2ZUV2ZW50cyA9IGZhbHNlO1xuXG4gIHZhciBFdmVudE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRXZlbnRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEV2ZW50T2JzZXJ2YWJsZShlbCwgbmFtZSwgZm4pIHtcbiAgICAgIHRoaXMuX2VsID0gZWw7XG4gICAgICB0aGlzLl9uID0gbmFtZTtcbiAgICAgIHRoaXMuX2ZuID0gZm47XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVIYW5kbGVyKG8sIGZuKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gaGFuZGxlciAoKSB7XG4gICAgICAgIHZhciByZXN1bHRzID0gYXJndW1lbnRzWzBdO1xuICAgICAgICBpZiAoaXNGdW5jdGlvbihmbikpIHtcbiAgICAgICAgICByZXN1bHRzID0gdHJ5Q2F0Y2goZm4pLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuICAgICAgICB9XG4gICAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBFdmVudE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIGNyZWF0ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgIHRoaXMuX2VsLFxuICAgICAgICB0aGlzLl9uLFxuICAgICAgICBjcmVhdGVIYW5kbGVyKG8sIHRoaXMuX2ZuKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBFdmVudE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IGFkZGluZyBhbiBldmVudCBsaXN0ZW5lciB0byB0aGUgbWF0Y2hpbmcgRE9NRWxlbWVudCBvciBlYWNoIGl0ZW0gaW4gdGhlIE5vZGVMaXN0LlxuICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudCBUaGUgRE9NRWxlbWVudCBvciBOb2RlTGlzdCB0byBhdHRhY2ggYSBsaXN0ZW5lci5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSBUaGUgZXZlbnQgbmFtZSB0byBhdHRhY2ggdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gQSBzZWxlY3RvciB3aGljaCB0YWtlcyB0aGUgYXJndW1lbnRzIGZyb20gdGhlIGV2ZW50IGhhbmRsZXIgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIGV2ZW50cyBmcm9tIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBhbmQgdGhlIHNwZWNpZmllZCBldmVudC5cbiAgICovXG4gIE9ic2VydmFibGUuZnJvbUV2ZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50TmFtZSwgc2VsZWN0b3IpIHtcbiAgICAvLyBOb2RlLmpzIHNwZWNpZmljXG4gICAgaWYgKGVsZW1lbnQuYWRkTGlzdGVuZXIpIHtcbiAgICAgIHJldHVybiBmcm9tRXZlbnRQYXR0ZXJuKFxuICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50LmFkZExpc3RlbmVyKGV2ZW50TmFtZSwgaCk7IH0sXG4gICAgICAgIGZ1bmN0aW9uIChoKSB7IGVsZW1lbnQucmVtb3ZlTGlzdGVuZXIoZXZlbnROYW1lLCBoKTsgfSxcbiAgICAgICAgc2VsZWN0b3IpO1xuICAgIH1cblxuICAgIC8vIFVzZSBvbmx5IGlmIG5vbi1uYXRpdmUgZXZlbnRzIGFyZSBhbGxvd2VkXG4gICAgaWYgKCFSeC5jb25maWcudXNlTmF0aXZlRXZlbnRzKSB7XG4gICAgICAvLyBIYW5kbGVzIGpxLCBBbmd1bGFyLmpzLCBaZXB0bywgTWFyaW9uZXR0ZSwgRW1iZXIuanNcbiAgICAgIGlmICh0eXBlb2YgZWxlbWVudC5vbiA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgZWxlbWVudC5vZmYgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIGZyb21FdmVudFBhdHRlcm4oXG4gICAgICAgICAgZnVuY3Rpb24gKGgpIHsgZWxlbWVudC5vbihldmVudE5hbWUsIGgpOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uIChoKSB7IGVsZW1lbnQub2ZmKGV2ZW50TmFtZSwgaCk7IH0sXG4gICAgICAgICAgc2VsZWN0b3IpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBuZXcgRXZlbnRPYnNlcnZhYmxlKGVsZW1lbnQsIGV2ZW50TmFtZSwgc2VsZWN0b3IpLnB1Ymxpc2goKS5yZWZDb3VudCgpO1xuICB9O1xuXG4gIHZhciBFdmVudFBhdHRlcm5PYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEV2ZW50UGF0dGVybk9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZShhZGQsIGRlbCwgZm4pIHtcbiAgICAgIHRoaXMuX2FkZCA9IGFkZDtcbiAgICAgIHRoaXMuX2RlbCA9IGRlbDtcbiAgICAgIHRoaXMuX2ZuID0gZm47XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVIYW5kbGVyKG8sIGZuKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gaGFuZGxlciAoKSB7XG4gICAgICAgIHZhciByZXN1bHRzID0gYXJndW1lbnRzWzBdO1xuICAgICAgICBpZiAoaXNGdW5jdGlvbihmbikpIHtcbiAgICAgICAgICByZXN1bHRzID0gdHJ5Q2F0Y2goZm4pLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuICAgICAgICB9XG4gICAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBFdmVudFBhdHRlcm5PYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBmbiA9IGNyZWF0ZUhhbmRsZXIobywgdGhpcy5fZm4pO1xuICAgICAgdmFyIHJldHVyblZhbHVlID0gdGhpcy5fYWRkKGZuKTtcbiAgICAgIHJldHVybiBuZXcgRXZlbnRQYXR0ZXJuRGlzcG9zYWJsZSh0aGlzLl9kZWwsIGZuLCByZXR1cm5WYWx1ZSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIEV2ZW50UGF0dGVybkRpc3Bvc2FibGUoZGVsLCBmbiwgcmV0KSB7XG4gICAgICB0aGlzLl9kZWwgPSBkZWw7XG4gICAgICB0aGlzLl9mbiA9IGZuO1xuICAgICAgdGhpcy5fcmV0ID0gcmV0O1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgRXZlbnRQYXR0ZXJuRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgICAgaXNGdW5jdGlvbih0aGlzLl9kZWwpICYmIHRoaXMuX2RlbCh0aGlzLl9mbiwgdGhpcy5fcmV0KTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIEV2ZW50UGF0dGVybk9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGZyb20gYW4gZXZlbnQgZW1pdHRlciB2aWEgYW4gYWRkSGFuZGxlci9yZW1vdmVIYW5kbGVyIHBhaXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGFkZEhhbmRsZXIgVGhlIGZ1bmN0aW9uIHRvIGFkZCBhIGhhbmRsZXIgdG8gdGhlIGVtaXR0ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtyZW1vdmVIYW5kbGVyXSBUaGUgb3B0aW9uYWwgZnVuY3Rpb24gdG8gcmVtb3ZlIGEgaGFuZGxlciBmcm9tIGFuIGVtaXR0ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gQSBzZWxlY3RvciB3aGljaCB0YWtlcyB0aGUgYXJndW1lbnRzIGZyb20gdGhlIGV2ZW50IGhhbmRsZXIgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIHdyYXBzIGFuIGV2ZW50IGZyb20gYW4gZXZlbnQgZW1pdHRlclxuICAgKi9cbiAgdmFyIGZyb21FdmVudFBhdHRlcm4gPSBPYnNlcnZhYmxlLmZyb21FdmVudFBhdHRlcm4gPSBmdW5jdGlvbiAoYWRkSGFuZGxlciwgcmVtb3ZlSGFuZGxlciwgc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbmV3IEV2ZW50UGF0dGVybk9ic2VydmFibGUoYWRkSGFuZGxlciwgcmVtb3ZlSGFuZGxlciwgc2VsZWN0b3IpLnB1Ymxpc2goKS5yZWZDb3VudCgpO1xuICB9O1xuXG4gIHZhciBGcm9tUHJvbWlzZU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRnJvbVByb21pc2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEZyb21Qcm9taXNlT2JzZXJ2YWJsZShwLCBzKSB7XG4gICAgICB0aGlzLl9wID0gcDtcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVOZXh0KHMsIHN0YXRlKSB7XG4gICAgICB2YXIgbyA9IHN0YXRlWzBdLCBkYXRhID0gc3RhdGVbMV07XG4gICAgICBvLm9uTmV4dChkYXRhKTtcbiAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzY2hlZHVsZUVycm9yKHMsIHN0YXRlKSB7XG4gICAgICB2YXIgbyA9IHN0YXRlWzBdLCBlcnIgPSBzdGF0ZVsxXTtcbiAgICAgIG8ub25FcnJvcihlcnIpO1xuICAgIH1cblxuICAgIEZyb21Qcm9taXNlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSwgc2VsZiA9IHRoaXM7XG5cbiAgICAgIHRoaXMuX3BcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShzZWxmLl9zLnNjaGVkdWxlKFtvLCBkYXRhXSwgc2NoZWR1bGVOZXh0KSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShzZWxmLl9zLnNjaGVkdWxlKFtvLCBlcnJdLCBzY2hlZHVsZUVycm9yKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gc2FkO1xuICAgIH07XG5cbiAgICByZXR1cm4gRnJvbVByb21pc2VPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICogQ29udmVydHMgYSBQcm9taXNlIHRvIGFuIE9ic2VydmFibGUgc2VxdWVuY2VcbiAgKiBAcGFyYW0ge1Byb21pc2V9IEFuIEVTNiBDb21wbGlhbnQgcHJvbWlzZS5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB3cmFwcyB0aGUgZXhpc3RpbmcgcHJvbWlzZSBzdWNjZXNzIGFuZCBmYWlsdXJlLlxuICAqL1xuICB2YXIgb2JzZXJ2YWJsZUZyb21Qcm9taXNlID0gT2JzZXJ2YWJsZS5mcm9tUHJvbWlzZSA9IGZ1bmN0aW9uIChwcm9taXNlLCBzY2hlZHVsZXIpIHtcbiAgICBzY2hlZHVsZXIgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuICAgIHJldHVybiBuZXcgRnJvbVByb21pc2VPYnNlcnZhYmxlKHByb21pc2UsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgLypcbiAgICogQ29udmVydHMgYW4gZXhpc3Rpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0byBhbiBFUzYgQ29tcGF0aWJsZSBQcm9taXNlXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciBwcm9taXNlID0gUnguT2JzZXJ2YWJsZS5yZXR1cm4oNDIpLnRvUHJvbWlzZShSU1ZQLlByb21pc2UpO1xuICAgKlxuICAgKiAvLyBXaXRoIGNvbmZpZ1xuICAgKiBSeC5jb25maWcuUHJvbWlzZSA9IFJTVlAuUHJvbWlzZTtcbiAgICogdmFyIHByb21pc2UgPSBSeC5PYnNlcnZhYmxlLnJldHVybig0MikudG9Qcm9taXNlKCk7XG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtwcm9taXNlQ3Rvcl0gVGhlIGNvbnN0cnVjdG9yIG9mIHRoZSBwcm9taXNlLiBJZiBub3QgcHJvdmlkZWQsIGl0IGxvb2tzIGZvciBpdCBpbiBSeC5jb25maWcuUHJvbWlzZS5cbiAgICogQHJldHVybnMge1Byb21pc2V9IEFuIEVTNiBjb21wYXRpYmxlIHByb21pc2Ugd2l0aCB0aGUgbGFzdCB2YWx1ZSBmcm9tIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnRvUHJvbWlzZSA9IGZ1bmN0aW9uIChwcm9taXNlQ3Rvcikge1xuICAgIHByb21pc2VDdG9yIHx8IChwcm9taXNlQ3RvciA9IFJ4LmNvbmZpZy5Qcm9taXNlKTtcbiAgICBpZiAoIXByb21pc2VDdG9yKSB7IHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcignUHJvbWlzZSB0eXBlIG5vdCBwcm92aWRlZCBub3IgaW4gUnguY29uZmlnLlByb21pc2UnKTsgfVxuICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgcHJvbWlzZUN0b3IoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgLy8gTm8gY2FuY2VsbGF0aW9uIGNhbiBiZSBkb25lXG4gICAgICB2YXIgdmFsdWU7XG4gICAgICBzb3VyY2Uuc3Vic2NyaWJlKGZ1bmN0aW9uICh2KSB7XG4gICAgICAgIHZhbHVlID0gdjtcbiAgICAgIH0sIHJlamVjdCwgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXNvbHZlKHZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbnZva2VzIHRoZSBhc3luY2hyb25vdXMgZnVuY3Rpb24sIHN1cmZhY2luZyB0aGUgcmVzdWx0IHRocm91Z2ggYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuY3Rpb25Bc3luYyBBc3luY2hyb25vdXMgZnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIFByb21pc2UgdG8gcnVuLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBleHBvc2luZyB0aGUgZnVuY3Rpb24ncyByZXN1bHQgdmFsdWUsIG9yIGFuIGV4Y2VwdGlvbi5cbiAgICovXG4gIE9ic2VydmFibGUuc3RhcnRBc3luYyA9IGZ1bmN0aW9uIChmdW5jdGlvbkFzeW5jKSB7XG4gICAgdmFyIHByb21pc2UgPSB0cnlDYXRjaChmdW5jdGlvbkFzeW5jKSgpO1xuICAgIGlmIChwcm9taXNlID09PSBlcnJvck9iaikgeyByZXR1cm4gb2JzZXJ2YWJsZVRocm93KHByb21pc2UuZSk7IH1cbiAgICByZXR1cm4gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHByb21pc2UpO1xuICB9O1xuXG4gIHZhciBNdWx0aWNhc3RPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhNdWx0aWNhc3RPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE11bHRpY2FzdE9ic2VydmFibGUoc291cmNlLCBmbjEsIGZuMikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9mbjEgPSBmbjE7XG4gICAgICB0aGlzLl9mbjIgPSBmbjI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBNdWx0aWNhc3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBjb25uZWN0YWJsZSA9IHRoaXMuc291cmNlLm11bHRpY2FzdCh0aGlzLl9mbjEoKSk7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUodGhpcy5fZm4yKGNvbm5lY3RhYmxlKS5zdWJzY3JpYmUobyksIGNvbm5lY3RhYmxlLmNvbm5lY3QoKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBNdWx0aWNhc3RPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICAqIE11bHRpY2FzdHMgdGhlIHNvdXJjZSBzZXF1ZW5jZSBub3RpZmljYXRpb25zIHRocm91Z2ggYW4gaW5zdGFudGlhdGVkIHN1YmplY3QgaW50byBhbGwgdXNlcyBvZiB0aGUgc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uIEVhY2hcbiAgICogc3Vic2NyaXB0aW9uIHRvIHRoZSByZXN1bHRpbmcgc2VxdWVuY2UgY2F1c2VzIGEgc2VwYXJhdGUgbXVsdGljYXN0IGludm9jYXRpb24sIGV4cG9zaW5nIHRoZSBzZXF1ZW5jZSByZXN1bHRpbmcgZnJvbSB0aGUgc2VsZWN0b3IgZnVuY3Rpb24nc1xuICAgKiBpbnZvY2F0aW9uLiBGb3Igc3BlY2lhbGl6YXRpb25zIHdpdGggZml4ZWQgc3ViamVjdCB0eXBlcywgc2VlIFB1Ymxpc2gsIFB1Ymxpc2hMYXN0LCBhbmQgUmVwbGF5LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAxIC0gcmVzID0gc291cmNlLm11bHRpY2FzdChvYnNlcnZhYmxlKTtcbiAgICogMiAtIHJlcyA9IHNvdXJjZS5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFN1YmplY3QoKTsgfSwgZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuICAgKlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFN1YmplY3R9IHN1YmplY3RPclN1YmplY3RTZWxlY3RvclxuICAgKiBGYWN0b3J5IGZ1bmN0aW9uIHRvIGNyZWF0ZSBhbiBpbnRlcm1lZGlhdGUgc3ViamVjdCB0aHJvdWdoIHdoaWNoIHRoZSBzb3VyY2Ugc2VxdWVuY2UncyBlbGVtZW50cyB3aWxsIGJlIG11bHRpY2FzdCB0byB0aGUgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqIE9yOlxuICAgKiBTdWJqZWN0IHRvIHB1c2ggc291cmNlIGVsZW1lbnRzIGludG8uXG4gICAqXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gT3B0aW9uYWwgc2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIHN1YmplY3QgdG8gdGhlIHBvbGljaWVzIGVuZm9yY2VkIGJ5IHRoZSBjcmVhdGVkIHN1YmplY3QuIFNwZWNpZmllZCBvbmx5IGlmIDxwYXJhbXJlZiBuYW1lPVwic3ViamVjdE9yU3ViamVjdFNlbGVjdG9yXCIgaXMgYSBmYWN0b3J5IGZ1bmN0aW9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLm11bHRpY2FzdCA9IGZ1bmN0aW9uIChzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IsIHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIGlzRnVuY3Rpb24oc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yKSA/XG4gICAgICBuZXcgTXVsdGljYXN0T2JzZXJ2YWJsZSh0aGlzLCBzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IsIHNlbGVjdG9yKSA6XG4gICAgICBuZXcgQ29ubmVjdGFibGVPYnNlcnZhYmxlKHRoaXMsIHN1YmplY3RPclN1YmplY3RTZWxlY3Rvcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG4gICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBNdWx0aWNhc3QgdXNpbmcgYSByZWd1bGFyIFN1YmplY3QuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciByZXNyZXMgPSBzb3VyY2UucHVibGlzaCgpO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2goZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuICAgKlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIFNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBhcyBtYW55IHRpbWVzIGFzIG5lZWRlZCwgd2l0aG91dCBjYXVzaW5nIG11bHRpcGxlIHN1YnNjcmlwdGlvbnMgdG8gdGhlIHNvdXJjZSBzZXF1ZW5jZS4gU3Vic2NyaWJlcnMgdG8gdGhlIGdpdmVuIHNvdXJjZSB3aWxsIHJlY2VpdmUgYWxsIG5vdGlmaWNhdGlvbnMgb2YgdGhlIHNvdXJjZSBmcm9tIHRoZSB0aW1lIG9mIHRoZSBzdWJzY3JpcHRpb24gb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucHVibGlzaCA9IGZ1bmN0aW9uIChzZWxlY3Rvcikge1xuICAgIHJldHVybiBzZWxlY3RvciAmJiBpc0Z1bmN0aW9uKHNlbGVjdG9yKSA/XG4gICAgICB0aGlzLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgU3ViamVjdCgpOyB9LCBzZWxlY3RvcikgOlxuICAgICAgdGhpcy5tdWx0aWNhc3QobmV3IFN1YmplY3QoKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG4gICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBwdWJsaXNoIHdoaWNoIGNyZWF0ZXMgYSBzdWJzY3JpcHRpb24gd2hlbiB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyBnb2VzIGZyb20gemVybyB0byBvbmUsIHRoZW4gc2hhcmVzIHRoYXQgc3Vic2NyaXB0aW9uIHdpdGggYWxsIHN1YnNlcXVlbnQgb2JzZXJ2ZXJzIHVudGlsIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIHJldHVybnMgdG8gemVybywgYXQgd2hpY2ggcG9pbnQgdGhlIHN1YnNjcmlwdGlvbiBpcyBkaXNwb3NlZC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5zaGFyZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5wdWJsaXNoKCkucmVmQ291bnQoKTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgc2VsZWN0b3Igb24gYSBjb25uZWN0YWJsZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSBjb250YWluaW5nIG9ubHkgdGhlIGxhc3Qgbm90aWZpY2F0aW9uLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgTXVsdGljYXN0IHVzaW5nIGEgQXN5bmNTdWJqZWN0LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hMYXN0KCk7XG4gICAqIHZhciByZXMgPSBzb3VyY2UucHVibGlzaExhc3QoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHg7IH0pO1xuICAgKlxuICAgKiBAcGFyYW0gc2VsZWN0b3IgW09wdGlvbmFsXSBTZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2UgYXMgbWFueSB0aW1lcyBhcyBuZWVkZWQsIHdpdGhvdXQgY2F1c2luZyBtdWx0aXBsZSBzdWJzY3JpcHRpb25zIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UuIFN1YnNjcmliZXJzIHRvIHRoZSBnaXZlbiBzb3VyY2Ugd2lsbCBvbmx5IHJlY2VpdmUgdGhlIGxhc3Qgbm90aWZpY2F0aW9uIG9mIHRoZSBzb3VyY2UuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucHVibGlzaExhc3QgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gc2VsZWN0b3IgJiYgaXNGdW5jdGlvbihzZWxlY3RvcikgP1xuICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IEFzeW5jU3ViamVjdCgpOyB9LCBzZWxlY3RvcikgOlxuICAgICAgdGhpcy5tdWx0aWNhc3QobmV3IEFzeW5jU3ViamVjdCgpKTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgc2VsZWN0b3Igb24gYSBjb25uZWN0YWJsZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSBhbmQgc3RhcnRzIHdpdGggaW5pdGlhbFZhbHVlLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgTXVsdGljYXN0IHVzaW5nIGEgQmVoYXZpb3JTdWJqZWN0LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hWYWx1ZSg0Mik7XG4gICAqIHZhciByZXMgPSBzb3VyY2UucHVibGlzaFZhbHVlKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnNlbGVjdChmdW5jdGlvbiAoeSkgeyByZXR1cm4geSAqIHk7IH0pIH0sIDQyKTtcbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBPcHRpb25hbCBzZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2UgYXMgbWFueSB0aW1lcyBhcyBuZWVkZWQsIHdpdGhvdXQgY2F1c2luZyBtdWx0aXBsZSBzdWJzY3JpcHRpb25zIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UuIFN1YnNjcmliZXJzIHRvIHRoZSBnaXZlbiBzb3VyY2Ugd2lsbCByZWNlaXZlIGltbWVkaWF0ZWx5IHJlY2VpdmUgdGhlIGluaXRpYWwgdmFsdWUsIGZvbGxvd2VkIGJ5IGFsbCBub3RpZmljYXRpb25zIG9mIHRoZSBzb3VyY2UgZnJvbSB0aGUgdGltZSBvZiB0aGUgc3Vic2NyaXB0aW9uIG9uLlxuICAgKiBAcGFyYW0ge01peGVkfSBpbml0aWFsVmFsdWUgSW5pdGlhbCB2YWx1ZSByZWNlaXZlZCBieSBvYnNlcnZlcnMgdXBvbiBzdWJzY3JpcHRpb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucHVibGlzaFZhbHVlID0gZnVuY3Rpb24gKGluaXRpYWxWYWx1ZU9yU2VsZWN0b3IsIGluaXRpYWxWYWx1ZSkge1xuICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAyID9cbiAgICAgIHRoaXMubXVsdGljYXN0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCZWhhdmlvclN1YmplY3QoaW5pdGlhbFZhbHVlKTtcbiAgICAgIH0sIGluaXRpYWxWYWx1ZU9yU2VsZWN0b3IpIDpcbiAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBCZWhhdmlvclN1YmplY3QoaW5pdGlhbFZhbHVlT3JTZWxlY3RvcikpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIGFuZCBzdGFydHMgd2l0aCBhbiBpbml0aWFsVmFsdWUuXG4gICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBwdWJsaXNoVmFsdWUgd2hpY2ggY3JlYXRlcyBhIHN1YnNjcmlwdGlvbiB3aGVuIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIGdvZXMgZnJvbSB6ZXJvIHRvIG9uZSwgdGhlbiBzaGFyZXMgdGhhdCBzdWJzY3JpcHRpb24gd2l0aCBhbGwgc3Vic2VxdWVudCBvYnNlcnZlcnMgdW50aWwgdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgcmV0dXJucyB0byB6ZXJvLCBhdCB3aGljaCBwb2ludCB0aGUgc3Vic2NyaXB0aW9uIGlzIGRpc3Bvc2VkLlxuICAgKiBAcGFyYW0ge01peGVkfSBpbml0aWFsVmFsdWUgSW5pdGlhbCB2YWx1ZSByZWNlaXZlZCBieSBvYnNlcnZlcnMgdXBvbiBzdWJzY3JpcHRpb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2hhcmVWYWx1ZSA9IGZ1bmN0aW9uIChpbml0aWFsVmFsdWUpIHtcbiAgICByZXR1cm4gdGhpcy5wdWJsaXNoVmFsdWUoaW5pdGlhbFZhbHVlKS5yZWZDb3VudCgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSBzZWxlY3RvciBvbiBhIGNvbm5lY3RhYmxlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIHJlcGxheWluZyBub3RpZmljYXRpb25zIHN1YmplY3QgdG8gYSBtYXhpbXVtIHRpbWUgbGVuZ3RoIGZvciB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIFJlcGxheVN1YmplY3QuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciByZXMgPSBzb3VyY2UucmVwbGF5KG51bGwsIDMpO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShudWxsLCAzLCA1MDApO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShudWxsLCAzLCA1MDAsIHNjaGVkdWxlcik7XG4gICAqIHZhciByZXMgPSBzb3VyY2UucmVwbGF5KGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRha2UoNikucmVwZWF0KCk7IH0sIDMsIDUwMCwgc2NoZWR1bGVyKTtcbiAgICpcbiAgICogQHBhcmFtIHNlbGVjdG9yIFtPcHRpb25hbF0gU2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgcmVjZWl2ZSBhbGwgdGhlIG5vdGlmaWNhdGlvbnMgb2YgdGhlIHNvdXJjZSBzdWJqZWN0IHRvIHRoZSBzcGVjaWZpZWQgcmVwbGF5IGJ1ZmZlciB0cmltbWluZyBwb2xpY3kuXG4gICAqIEBwYXJhbSBidWZmZXJTaXplIFtPcHRpb25hbF0gTWF4aW11bSBlbGVtZW50IGNvdW50IG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuICAgKiBAcGFyYW0gd2luZG93U2l6ZSBbT3B0aW9uYWxdIE1heGltdW0gdGltZSBsZW5ndGggb2YgdGhlIHJlcGxheSBidWZmZXIuXG4gICAqIEBwYXJhbSBzY2hlZHVsZXIgW09wdGlvbmFsXSBTY2hlZHVsZXIgd2hlcmUgY29ubmVjdGVkIG9ic2VydmVycyB3aXRoaW4gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCBvbi5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5yZXBsYXkgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikge1xuICAgIHJldHVybiBzZWxlY3RvciAmJiBpc0Z1bmN0aW9uKHNlbGVjdG9yKSA/XG4gICAgICB0aGlzLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgUmVwbGF5U3ViamVjdChidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpOyB9LCBzZWxlY3RvcikgOlxuICAgICAgdGhpcy5tdWx0aWNhc3QobmV3IFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgcmVwbGF5aW5nIG5vdGlmaWNhdGlvbnMgc3ViamVjdCB0byBhIG1heGltdW0gdGltZSBsZW5ndGggZm9yIHRoZSByZXBsYXkgYnVmZmVyLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgcmVwbGF5IHdoaWNoIGNyZWF0ZXMgYSBzdWJzY3JpcHRpb24gd2hlbiB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyBnb2VzIGZyb20gemVybyB0byBvbmUsIHRoZW4gc2hhcmVzIHRoYXQgc3Vic2NyaXB0aW9uIHdpdGggYWxsIHN1YnNlcXVlbnQgb2JzZXJ2ZXJzIHVudGlsIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIHJldHVybnMgdG8gemVybywgYXQgd2hpY2ggcG9pbnQgdGhlIHN1YnNjcmlwdGlvbiBpcyBkaXNwb3NlZC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5zaGFyZVJlcGxheSgzKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5zaGFyZVJlcGxheSgzLCA1MDApO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnNoYXJlUmVwbGF5KDMsIDUwMCwgc2NoZWR1bGVyKTtcbiAgICpcblxuICAgKiBAcGFyYW0gYnVmZmVyU2l6ZSBbT3B0aW9uYWxdIE1heGltdW0gZWxlbWVudCBjb3VudCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICogQHBhcmFtIHdpbmRvdyBbT3B0aW9uYWxdIE1heGltdW0gdGltZSBsZW5ndGggb2YgdGhlIHJlcGxheSBidWZmZXIuXG4gICAqIEBwYXJhbSBzY2hlZHVsZXIgW09wdGlvbmFsXSBTY2hlZHVsZXIgd2hlcmUgY29ubmVjdGVkIG9ic2VydmVycyB3aXRoaW4gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdpbGwgYmUgaW52b2tlZCBvbi5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5zaGFyZVJlcGxheSA9IGZ1bmN0aW9uIChidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gdGhpcy5yZXBsYXkobnVsbCwgYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKS5yZWZDb3VudCgpO1xuICB9O1xuXG4gIHZhciBSZWZDb3VudE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFJlZkNvdW50T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBSZWZDb3VudE9ic2VydmFibGUoc291cmNlKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX2NvdW50ID0gMDtcbiAgICAgIHRoaXMuX2Nvbm5lY3RhYmxlU3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFJlZkNvdW50T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgc2hvdWxkQ29ubmVjdCA9ICsrdGhpcy5fY291bnQgPT09IDEsIHN1YnNjcmlwdGlvbiA9IHRoaXMuc291cmNlLnN1YnNjcmliZShvKTtcbiAgICAgIHNob3VsZENvbm5lY3QgJiYgKHRoaXMuX2Nvbm5lY3RhYmxlU3Vic2NyaXB0aW9uID0gdGhpcy5zb3VyY2UuY29ubmVjdCgpKTtcbiAgICAgIHJldHVybiBuZXcgUmVmQ291bnREaXNwb3NhYmxlKHRoaXMsIHN1YnNjcmlwdGlvbik7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFJlZkNvdW50RGlzcG9zYWJsZShwLCBzKSB7XG4gICAgICB0aGlzLl9wID0gcDtcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgUmVmQ291bnREaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcy5kaXNwb3NlKCk7XG4gICAgICAgIC0tdGhpcy5fcC5fY291bnQgPT09IDAgJiYgdGhpcy5fcC5fY29ubmVjdGFibGVTdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gUmVmQ291bnRPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIENvbm5lY3RhYmxlT2JzZXJ2YWJsZSA9IFJ4LkNvbm5lY3RhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ29ubmVjdGFibGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIENvbm5lY3RhYmxlT2JzZXJ2YWJsZShzb3VyY2UsIHN1YmplY3QpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5faGFzU3Vic2NyaXB0aW9uICA9IGZhbHNlO1xuICAgICAgdGhpcy5fc3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgIHRoaXMuX3NvdXJjZU9ic2VydmFibGUgPSBzb3VyY2UuYXNPYnNlcnZhYmxlKCk7XG4gICAgICB0aGlzLl9zdWJqZWN0ID0gc3ViamVjdDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIENvbm5lY3REaXNwb3NhYmxlKHBhcmVudCkge1xuICAgICAgdGhpcy5fcCA9IHBhcmVudDtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIENvbm5lY3REaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcC5faGFzU3Vic2NyaXB0aW9uID0gZmFsc2U7XG4gICAgICB9XG4gICAgfTtcblxuICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5faGFzU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuX2hhc1N1YnNjcmlwdGlvbiA9IHRydWU7XG4gICAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuICAgICAgICAgIHRoaXMuX3NvdXJjZU9ic2VydmFibGUuc3Vic2NyaWJlKHRoaXMuX3N1YmplY3QpLFxuICAgICAgICAgIG5ldyBDb25uZWN0RGlzcG9zYWJsZSh0aGlzKVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmlwdGlvbjtcbiAgICB9O1xuXG4gICAgQ29ubmVjdGFibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdWJqZWN0LnN1YnNjcmliZShvKTtcbiAgICB9O1xuXG4gICAgQ29ubmVjdGFibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5yZWZDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBuZXcgUmVmQ291bnRPYnNlcnZhYmxlKHRoaXMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gQ29ubmVjdGFibGVPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGUpKTtcblxuICB2YXIgVGltZXJPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRpbWVyT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUaW1lck9ic2VydmFibGUoZHQsIHMpIHtcbiAgICAgIHRoaXMuX2R0ID0gZHQ7XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRpbWVyT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5fcy5zY2hlZHVsZUZ1dHVyZShvLCB0aGlzLl9kdCwgc2NoZWR1bGVNZXRob2QpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBzY2hlZHVsZU1ldGhvZChzLCBvKSB7XG4gICAgICBvLm9uTmV4dCgwKTtcbiAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gVGltZXJPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgZnVuY3Rpb24gX29ic2VydmFibGVUaW1lcihkdWVUaW1lLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gbmV3IFRpbWVyT2JzZXJ2YWJsZShkdWVUaW1lLCBzY2hlZHVsZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gb2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZChkdWVUaW1lLCBwZXJpb2QsIHNjaGVkdWxlcikge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBkID0gZHVlVGltZSwgcCA9IG5vcm1hbGl6ZVRpbWUocGVyaW9kKTtcbiAgICAgIHJldHVybiBzY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUoMCwgZCwgZnVuY3Rpb24gKGNvdW50LCBzZWxmKSB7XG4gICAgICAgIGlmIChwID4gMCkge1xuICAgICAgICAgIHZhciBub3cgPSBzY2hlZHVsZXIubm93KCk7XG4gICAgICAgICAgZCA9IG5ldyBEYXRlKGQuZ2V0VGltZSgpICsgcCk7XG4gICAgICAgICAgZC5nZXRUaW1lKCkgPD0gbm93ICYmIChkID0gbmV3IERhdGUobm93ICsgcCkpO1xuICAgICAgICB9XG4gICAgICAgIG9ic2VydmVyLm9uTmV4dChjb3VudCk7XG4gICAgICAgIHNlbGYoY291bnQgKyAxLCBuZXcgRGF0ZShkKSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9ic2VydmFibGVUaW1lclRpbWVTcGFuQW5kUGVyaW9kKGR1ZVRpbWUsIHBlcmlvZCwgc2NoZWR1bGVyKSB7XG4gICAgcmV0dXJuIGR1ZVRpbWUgPT09IHBlcmlvZCA/XG4gICAgICBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZVBlcmlvZGljKDAsIHBlcmlvZCwgZnVuY3Rpb24gKGNvdW50KSB7XG4gICAgICAgICAgb2JzZXJ2ZXIub25OZXh0KGNvdW50KTtcbiAgICAgICAgICByZXR1cm4gY291bnQgKyAxO1xuICAgICAgICB9KTtcbiAgICAgIH0pIDpcbiAgICAgIG9ic2VydmFibGVEZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJEYXRlQW5kUGVyaW9kKG5ldyBEYXRlKHNjaGVkdWxlci5ub3coKSArIGR1ZVRpbWUpLCBwZXJpb2QsIHNjaGVkdWxlcik7XG4gICAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcHJvZHVjZXMgYSB2YWx1ZSBhZnRlciBlYWNoIHBlcmlvZC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogIDEgLSByZXMgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMDApO1xuICAgKiAgMiAtIHJlcyA9IFJ4Lk9ic2VydmFibGUuaW50ZXJ2YWwoMTAwMCwgUnguU2NoZWR1bGVyLnRpbWVvdXQpO1xuICAgKlxuICAgKiBAcGFyYW0ge051bWJlcn0gcGVyaW9kIFBlcmlvZCBmb3IgcHJvZHVjaW5nIHRoZSB2YWx1ZXMgaW4gdGhlIHJlc3VsdGluZyBzZXF1ZW5jZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKS5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIHRpbWVyIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBSeC5TY2hlZHVsZXIudGltZW91dCBpcyB1c2VkLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZWFjaCBwZXJpb2QuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZWludGVydmFsID0gT2JzZXJ2YWJsZS5pbnRlcnZhbCA9IGZ1bmN0aW9uIChwZXJpb2QsIHNjaGVkdWxlcikge1xuICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZChwZXJpb2QsIHBlcmlvZCwgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSA/IHNjaGVkdWxlciA6IGRlZmF1bHRTY2hlZHVsZXIpO1xuICB9O1xuXG4gIC8qKlxuICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcHJvZHVjZXMgYSB2YWx1ZSBhZnRlciBkdWVUaW1lIGhhcyBlbGFwc2VkIGFuZCB0aGVuIGFmdGVyIGVhY2ggcGVyaW9kLlxuICAgKiBAcGFyYW0ge051bWJlcn0gZHVlVGltZSBBYnNvbHV0ZSAoc3BlY2lmaWVkIGFzIGEgRGF0ZSBvYmplY3QpIG9yIHJlbGF0aXZlIHRpbWUgKHNwZWNpZmllZCBhcyBhbiBpbnRlZ2VyIGRlbm90aW5nIG1pbGxpc2Vjb25kcykgYXQgd2hpY2ggdG8gcHJvZHVjZSB0aGUgZmlyc3QgdmFsdWUuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFtwZXJpb2RPclNjaGVkdWxlcl0gIFBlcmlvZCB0byBwcm9kdWNlIHN1YnNlcXVlbnQgdmFsdWVzIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpLCBvciB0aGUgc2NoZWR1bGVyIHRvIHJ1biB0aGUgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSByZXN1bHRpbmcgdGltZXIgaXMgbm90IHJlY3VycmluZy5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdICBTY2hlZHVsZXIgdG8gcnVuIHRoZSB0aW1lciBvbi4gSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWVvdXQgc2NoZWR1bGVyIGlzIHVzZWQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcHJvZHVjZXMgYSB2YWx1ZSBhZnRlciBkdWUgdGltZSBoYXMgZWxhcHNlZCBhbmQgdGhlbiBlYWNoIHBlcmlvZC5cbiAgICovXG4gIHZhciBvYnNlcnZhYmxlVGltZXIgPSBPYnNlcnZhYmxlLnRpbWVyID0gZnVuY3Rpb24gKGR1ZVRpbWUsIHBlcmlvZE9yU2NoZWR1bGVyLCBzY2hlZHVsZXIpIHtcbiAgICB2YXIgcGVyaW9kO1xuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuICAgIGlmIChwZXJpb2RPclNjaGVkdWxlciAhPSBudWxsICYmIHR5cGVvZiBwZXJpb2RPclNjaGVkdWxlciA9PT0gJ251bWJlcicpIHtcbiAgICAgIHBlcmlvZCA9IHBlcmlvZE9yU2NoZWR1bGVyO1xuICAgIH0gZWxzZSBpZiAoaXNTY2hlZHVsZXIocGVyaW9kT3JTY2hlZHVsZXIpKSB7XG4gICAgICBzY2hlZHVsZXIgPSBwZXJpb2RPclNjaGVkdWxlcjtcbiAgICB9XG4gICAgaWYgKChkdWVUaW1lIGluc3RhbmNlb2YgRGF0ZSB8fCB0eXBlb2YgZHVlVGltZSA9PT0gJ251bWJlcicpICYmIHBlcmlvZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gX29ic2VydmFibGVUaW1lcihkdWVUaW1lLCBzY2hlZHVsZXIpO1xuICAgIH1cbiAgICBpZiAoZHVlVGltZSBpbnN0YW5jZW9mIERhdGUgJiYgcGVyaW9kICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJEYXRlQW5kUGVyaW9kKGR1ZVRpbWUuZ2V0VGltZSgpLCBwZXJpb2RPclNjaGVkdWxlciwgc2NoZWR1bGVyKTtcbiAgICB9XG4gICAgcmV0dXJuIG9ic2VydmFibGVUaW1lclRpbWVTcGFuQW5kUGVyaW9kKGR1ZVRpbWUsIHBlcmlvZCwgc2NoZWR1bGVyKTtcbiAgfTtcblxuICBmdW5jdGlvbiBvYnNlcnZhYmxlRGVsYXlSZWxhdGl2ZShzb3VyY2UsIGR1ZVRpbWUsIHNjaGVkdWxlcikge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGFjdGl2ZSA9IGZhbHNlLFxuICAgICAgICBjYW5jZWxhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSxcbiAgICAgICAgZXhjZXB0aW9uID0gbnVsbCxcbiAgICAgICAgcSA9IFtdLFxuICAgICAgICBydW5uaW5nID0gZmFsc2UsXG4gICAgICAgIHN1YnNjcmlwdGlvbjtcbiAgICAgIHN1YnNjcmlwdGlvbiA9IHNvdXJjZS5tYXRlcmlhbGl6ZSgpLnRpbWVzdGFtcChzY2hlZHVsZXIpLnN1YnNjcmliZShmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIHZhciBkLCBzaG91bGRSdW47XG4gICAgICAgIGlmIChub3RpZmljYXRpb24udmFsdWUua2luZCA9PT0gJ0UnKSB7XG4gICAgICAgICAgcSA9IFtdO1xuICAgICAgICAgIHEucHVzaChub3RpZmljYXRpb24pO1xuICAgICAgICAgIGV4Y2VwdGlvbiA9IG5vdGlmaWNhdGlvbi52YWx1ZS5lcnJvcjtcbiAgICAgICAgICBzaG91bGRSdW4gPSAhcnVubmluZztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBxLnB1c2goeyB2YWx1ZTogbm90aWZpY2F0aW9uLnZhbHVlLCB0aW1lc3RhbXA6IG5vdGlmaWNhdGlvbi50aW1lc3RhbXAgKyBkdWVUaW1lIH0pO1xuICAgICAgICAgIHNob3VsZFJ1biA9ICFhY3RpdmU7XG4gICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2hvdWxkUnVuKSB7XG4gICAgICAgICAgaWYgKGV4Y2VwdGlvbiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgby5vbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgICAgIGNhbmNlbGFibGUuc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgICAgICAgIGQuc2V0RGlzcG9zYWJsZShzY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUobnVsbCwgZHVlVGltZSwgZnVuY3Rpb24gKF8sIHNlbGYpIHtcbiAgICAgICAgICAgICAgdmFyIGUsIHJlY3Vyc2VEdWVUaW1lLCByZXN1bHQsIHNob3VsZFJlY3Vyc2U7XG4gICAgICAgICAgICAgIGlmIChleGNlcHRpb24gIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcnVubmluZyA9IHRydWU7XG4gICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChxLmxlbmd0aCA+IDAgJiYgcVswXS50aW1lc3RhbXAgLSBzY2hlZHVsZXIubm93KCkgPD0gMCkge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcS5zaGlmdCgpLnZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICByZXN1bHQuYWNjZXB0KG8pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSB3aGlsZSAocmVzdWx0ICE9PSBudWxsKTtcbiAgICAgICAgICAgICAgc2hvdWxkUmVjdXJzZSA9IGZhbHNlO1xuICAgICAgICAgICAgICByZWN1cnNlRHVlVGltZSA9IDA7XG4gICAgICAgICAgICAgIGlmIChxLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBzaG91bGRSZWN1cnNlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZWN1cnNlRHVlVGltZSA9IE1hdGgubWF4KDAsIHFbMF0udGltZXN0YW1wIC0gc2NoZWR1bGVyLm5vdygpKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBhY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlID0gZXhjZXB0aW9uO1xuICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgIGlmIChlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgby5vbkVycm9yKGUpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNob3VsZFJlY3Vyc2UpIHtcbiAgICAgICAgICAgICAgICBzZWxmKG51bGwsIHJlY3Vyc2VEdWVUaW1lKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlKTtcbiAgICB9LCBzb3VyY2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gb2JzZXJ2YWJsZURlbGF5QWJzb2x1dGUoc291cmNlLCBkdWVUaW1lLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gb2JzZXJ2YWJsZURlZmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBvYnNlcnZhYmxlRGVsYXlSZWxhdGl2ZShzb3VyY2UsIGR1ZVRpbWUgLSBzY2hlZHVsZXIubm93KCksIHNjaGVkdWxlcik7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBkZWxheVdpdGhTZWxlY3Rvcihzb3VyY2UsIHN1YnNjcmlwdGlvbkRlbGF5LCBkZWxheUR1cmF0aW9uU2VsZWN0b3IpIHtcbiAgICB2YXIgc3ViRGVsYXksIHNlbGVjdG9yO1xuICAgIGlmIChpc0Z1bmN0aW9uKHN1YnNjcmlwdGlvbkRlbGF5KSkge1xuICAgICAgc2VsZWN0b3IgPSBzdWJzY3JpcHRpb25EZWxheTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3ViRGVsYXkgPSBzdWJzY3JpcHRpb25EZWxheTtcbiAgICAgIHNlbGVjdG9yID0gZGVsYXlEdXJhdGlvblNlbGVjdG9yO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBkZWxheXMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpLCBhdEVuZCA9IGZhbHNlLCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXG4gICAgICBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShcbiAgICAgICAgICBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgdmFyIGRlbGF5ID0gdHJ5Q2F0Y2goc2VsZWN0b3IpKHgpO1xuICAgICAgICAgICAgaWYgKGRlbGF5ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKGRlbGF5LmUpOyB9XG4gICAgICAgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgICAgICAgZGVsYXlzLmFkZChkKTtcbiAgICAgICAgICAgIGQuc2V0RGlzcG9zYWJsZShkZWxheS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBvLm9uTmV4dCh4KTtcbiAgICAgICAgICAgICAgICBkZWxheXMucmVtb3ZlKGQpO1xuICAgICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgby5vbk5leHQoeCk7XG4gICAgICAgICAgICAgICAgZGVsYXlzLnJlbW92ZShkKTtcbiAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICkpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGF0RW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XG4gICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgfVxuICAgICAgICApKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZG9uZSAoKSB7XG4gICAgICAgIGF0RW5kICYmIGRlbGF5cy5sZW5ndGggPT09IDAgJiYgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXN1YkRlbGF5KSB7XG4gICAgICAgIHN0YXJ0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShzdWJEZWxheS5zdWJzY3JpYmUoc3RhcnQsIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSwgc3RhcnQpKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgZGVsYXlzKTtcbiAgICB9LCB0aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiAgVGltZSBzaGlmdHMgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgZHVlVGltZS5cbiAgICogIFRoZSByZWxhdGl2ZSB0aW1lIGludGVydmFscyBiZXR3ZWVuIHRoZSB2YWx1ZXMgYXJlIHByZXNlcnZlZC5cbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGR1ZVRpbWUgQWJzb2x1dGUgKHNwZWNpZmllZCBhcyBhIERhdGUgb2JqZWN0KSBvciByZWxhdGl2ZSB0aW1lIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpIGJ5IHdoaWNoIHRvIHNoaWZ0IHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZGVsYXkgdGltZXJzIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgdGltZW91dCBzY2hlZHVsZXIgaXMgdXNlZC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRpbWUtc2hpZnRlZCBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5kZWxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZmlyc3RBcmcgPSBhcmd1bWVudHNbMF07XG4gICAgaWYgKHR5cGVvZiBmaXJzdEFyZyA9PT0gJ251bWJlcicgfHwgZmlyc3RBcmcgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICB2YXIgZHVlVGltZSA9IGZpcnN0QXJnLCBzY2hlZHVsZXIgPSBhcmd1bWVudHNbMV07XG4gICAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICAgIHJldHVybiBkdWVUaW1lIGluc3RhbmNlb2YgRGF0ZSA/XG4gICAgICAgIG9ic2VydmFibGVEZWxheUFic29sdXRlKHRoaXMsIGR1ZVRpbWUsIHNjaGVkdWxlcikgOlxuICAgICAgICBvYnNlcnZhYmxlRGVsYXlSZWxhdGl2ZSh0aGlzLCBkdWVUaW1lLCBzY2hlZHVsZXIpO1xuICAgIH0gZWxzZSBpZiAoT2JzZXJ2YWJsZS5pc09ic2VydmFibGUoZmlyc3RBcmcpIHx8IGlzRnVuY3Rpb24oZmlyc3RBcmcpKSB7XG4gICAgICByZXR1cm4gZGVsYXlXaXRoU2VsZWN0b3IodGhpcywgZmlyc3RBcmcsIGFyZ3VtZW50c1sxXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhcmd1bWVudHMnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIERlYm91bmNlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRGVib3VuY2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIERlYm91bmNlT2JzZXJ2YWJsZShzb3VyY2UsIGR0LCBzKSB7XG4gICAgICBpc1NjaGVkdWxlcihzKSB8fCAocyA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9kdCA9IGR0O1xuICAgICAgdGhpcy5fcyA9IHM7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBEZWJvdW5jZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGNhbmNlbGFibGUgPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuICAgICAgICB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IERlYm91bmNlT2JzZXJ2ZXIobywgdGhpcy5zb3VyY2UsIHRoaXMuX2R0LCB0aGlzLl9zLCBjYW5jZWxhYmxlKSksXG4gICAgICAgIGNhbmNlbGFibGUpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRGVib3VuY2VPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIERlYm91bmNlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERlYm91bmNlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gRGVib3VuY2VPYnNlcnZlcihvYnNlcnZlciwgc291cmNlLCBkdWVUaW1lLCBzY2hlZHVsZXIsIGNhbmNlbGFibGUpIHtcbiAgICAgIHRoaXMuX28gPSBvYnNlcnZlcjtcbiAgICAgIHRoaXMuX3MgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9kID0gZHVlVGltZTtcbiAgICAgIHRoaXMuX3NjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIHRoaXMuX2MgPSBjYW5jZWxhYmxlO1xuICAgICAgdGhpcy5fdiA9IG51bGw7XG4gICAgICB0aGlzLl9odiA9IGZhbHNlO1xuICAgICAgdGhpcy5faWQgPSAwO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVib3VuY2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9odiA9IHRydWU7XG4gICAgICB0aGlzLl92ID0geDtcbiAgICAgIHZhciBjdXJyZW50SWQgPSArK3RoaXMuX2lkLCBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICB0aGlzLl9jLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICBkLnNldERpc3Bvc2FibGUodGhpcy5fc2NoZWR1bGVyLnNjaGVkdWxlRnV0dXJlKHRoaXMsIHRoaXMuX2QsIGZ1bmN0aW9uIChfLCBzZWxmKSB7XG4gICAgICAgIHNlbGYuX2h2ICYmIHNlbGYuX2lkID09PSBjdXJyZW50SWQgJiYgc2VsZi5fby5vbk5leHQoeCk7XG4gICAgICAgIHNlbGYuX2h2ID0gZmFsc2U7XG4gICAgICB9KSk7XG4gICAgfTtcblxuICAgIERlYm91bmNlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX2MuZGlzcG9zZSgpO1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgICAgdGhpcy5faHYgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2lkKys7XG4gICAgfTtcblxuICAgIERlYm91bmNlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2MuZGlzcG9zZSgpO1xuICAgICAgdGhpcy5faHYgJiYgdGhpcy5fby5vbk5leHQodGhpcy5fdik7XG4gICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgICB0aGlzLl9odiA9IGZhbHNlO1xuICAgICAgdGhpcy5faWQrKztcbiAgICB9O1xuXG4gICAgcmV0dXJuIERlYm91bmNlT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIGZ1bmN0aW9uIGRlYm91bmNlV2l0aFNlbGVjdG9yKHNvdXJjZSwgZHVyYXRpb25TZWxlY3Rvcikge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHZhbHVlLCBoYXNWYWx1ZSA9IGZhbHNlLCBjYW5jZWxhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSwgaWQgPSAwO1xuICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHNvdXJjZS5zdWJzY3JpYmUoXG4gICAgICAgIGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgdmFyIHRocm90dGxlID0gdHJ5Q2F0Y2goZHVyYXRpb25TZWxlY3RvcikoeCk7XG4gICAgICAgICAgaWYgKHRocm90dGxlID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHRocm90dGxlLmUpOyB9XG5cbiAgICAgICAgICBpc1Byb21pc2UodGhyb3R0bGUpICYmICh0aHJvdHRsZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZSh0aHJvdHRsZSkpO1xuXG4gICAgICAgICAgaGFzVmFsdWUgPSB0cnVlO1xuICAgICAgICAgIHZhbHVlID0geDtcbiAgICAgICAgICBpZCsrO1xuICAgICAgICAgIHZhciBjdXJyZW50aWQgPSBpZCwgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgICAgIGNhbmNlbGFibGUuc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgICAgICBkLnNldERpc3Bvc2FibGUodGhyb3R0bGUuc3Vic2NyaWJlKFxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBoYXNWYWx1ZSAmJiBpZCA9PT0gY3VycmVudGlkICYmIG8ub25OZXh0KHZhbHVlKTtcbiAgICAgICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgZC5kaXNwb3NlKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBoYXNWYWx1ZSAmJiBpZCA9PT0gY3VycmVudGlkICYmIG8ub25OZXh0KHZhbHVlKTtcbiAgICAgICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgZC5kaXNwb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgY2FuY2VsYWJsZS5kaXNwb3NlKCk7XG4gICAgICAgICAgby5vbkVycm9yKGUpO1xuICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgfSxcbiAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNhbmNlbGFibGUuZGlzcG9zZSgpO1xuICAgICAgICAgIGhhc1ZhbHVlICYmIG8ub25OZXh0KHZhbHVlKTtcbiAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICBpZCsrO1xuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSk7XG4gICAgfSwgc291cmNlKTtcbiAgfVxuXG4gIG9ic2VydmFibGVQcm90by5kZWJvdW5jZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoaXNGdW5jdGlvbiAoYXJndW1lbnRzWzBdKSkge1xuICAgICAgcmV0dXJuIGRlYm91bmNlV2l0aFNlbGVjdG9yKHRoaXMsIGFyZ3VtZW50c1swXSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnbnVtYmVyJykge1xuICAgICAgcmV0dXJuIG5ldyBEZWJvdW5jZU9ic2VydmFibGUodGhpcywgYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYXJndW1lbnRzJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBUaW1lc3RhbXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUaW1lc3RhbXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFRpbWVzdGFtcE9ic2VydmFibGUoc291cmNlLCBzKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGltZXN0YW1wT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBUaW1lc3RhbXBPYnNlcnZlcihvLCB0aGlzLl9zKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBUaW1lc3RhbXBPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFRpbWVzdGFtcE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUaW1lc3RhbXBPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUaW1lc3RhbXBPYnNlcnZlcihvLCBzKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGltZXN0YW1wT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdGhpcy5fby5vbk5leHQoeyB2YWx1ZTogeCwgdGltZXN0YW1wOiB0aGlzLl9zLm5vdygpIH0pO1xuICAgIH07XG5cbiAgICBUaW1lc3RhbXBPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBUaW1lc3RhbXBPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gVGltZXN0YW1wT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiAgUmVjb3JkcyB0aGUgdGltZXN0YW1wIGZvciBlYWNoIHZhbHVlIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICAxIC0gcmVzID0gc291cmNlLnRpbWVzdGFtcCgpOyAvLyBwcm9kdWNlcyB7IHZhbHVlOiB4LCB0aW1lc3RhbXA6IHRzIH1cbiAgICogIDIgLSByZXMgPSBzb3VyY2UudGltZXN0YW1wKFJ4LlNjaGVkdWxlci5kZWZhdWx0KTtcbiAgICpcbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdICBTY2hlZHVsZXIgdXNlZCB0byBjb21wdXRlIHRpbWVzdGFtcHMuIElmIG5vdCBzcGVjaWZpZWQsIHRoZSBkZWZhdWx0IHNjaGVkdWxlciBpcyB1c2VkLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIHRpbWVzdGFtcCBpbmZvcm1hdGlvbiBvbiB2YWx1ZXMuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8udGltZXN0YW1wID0gZnVuY3Rpb24gKHNjaGVkdWxlcikge1xuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuICAgIHJldHVybiBuZXcgVGltZXN0YW1wT2JzZXJ2YWJsZSh0aGlzLCBzY2hlZHVsZXIpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHNhbXBsZU9ic2VydmFibGUoc291cmNlLCBzYW1wbGVyKSB7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgYXRFbmQgPSBmYWxzZSwgdmFsdWUsIGhhc1ZhbHVlID0gZmFsc2U7XG5cbiAgICAgIGZ1bmN0aW9uIHNhbXBsZVN1YnNjcmliZSgpIHtcbiAgICAgICAgaWYgKGhhc1ZhbHVlKSB7XG4gICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcbiAgICAgICAgICBvLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgYXRFbmQgJiYgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuXG4gICAgICB2YXIgc291cmNlU3Vic2NyaXB0aW9uID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICBzb3VyY2VTdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgICBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgICBoYXNWYWx1ZSA9IHRydWU7XG4gICAgICAgICAgdmFsdWUgPSBuZXdWYWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgYXRFbmQgPSB0cnVlO1xuICAgICAgICAgIHNvdXJjZVN1YnNjcmlwdGlvbi5kaXNwb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICkpO1xuXG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG4gICAgICAgIHNvdXJjZVN1YnNjcmlwdGlvbixcbiAgICAgICAgc2FtcGxlci5zdWJzY3JpYmUoc2FtcGxlU3Vic2NyaWJlLCBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIHNhbXBsZVN1YnNjcmliZSlcbiAgICAgICk7XG4gICAgfSwgc291cmNlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiAgU2FtcGxlcyB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhdCBlYWNoIGludGVydmFsLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAgMSAtIHJlcyA9IHNvdXJjZS5zYW1wbGUoc2FtcGxlT2JzZXJ2YWJsZSk7IC8vIFNhbXBsZXIgdGljayBzZXF1ZW5jZVxuICAgKiAgMiAtIHJlcyA9IHNvdXJjZS5zYW1wbGUoNTAwMCk7IC8vIDUgc2Vjb25kc1xuICAgKiAgMiAtIHJlcyA9IHNvdXJjZS5zYW1wbGUoNTAwMCwgUnguU2NoZWR1bGVyLnRpbWVvdXQpOyAvLyA1IHNlY29uZHNcbiAgICpcbiAgICogQHBhcmFtIHtNaXhlZH0gaW50ZXJ2YWxPclNhbXBsZXIgSW50ZXJ2YWwgYXQgd2hpY2ggdG8gc2FtcGxlIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpIG9yIFNhbXBsZXIgT2JzZXJ2YWJsZS5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdICBTY2hlZHVsZXIgdG8gcnVuIHRoZSBzYW1wbGluZyB0aW1lciBvbi4gSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWVvdXQgc2NoZWR1bGVyIGlzIHVzZWQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBTYW1wbGVkIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2FtcGxlID0gb2JzZXJ2YWJsZVByb3RvLnRocm90dGxlTGF0ZXN0ID0gZnVuY3Rpb24gKGludGVydmFsT3JTYW1wbGVyLCBzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICByZXR1cm4gdHlwZW9mIGludGVydmFsT3JTYW1wbGVyID09PSAnbnVtYmVyJyA/XG4gICAgICBzYW1wbGVPYnNlcnZhYmxlKHRoaXMsIG9ic2VydmFibGVpbnRlcnZhbChpbnRlcnZhbE9yU2FtcGxlciwgc2NoZWR1bGVyKSkgOlxuICAgICAgc2FtcGxlT2JzZXJ2YWJsZSh0aGlzLCBpbnRlcnZhbE9yU2FtcGxlcik7XG4gIH07XG5cbiAgdmFyIFRpbWVvdXRFcnJvciA9IFJ4LlRpbWVvdXRFcnJvciA9IGZ1bmN0aW9uKG1lc3NhZ2UpIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlIHx8ICdUaW1lb3V0IGhhcyBvY2N1cnJlZCc7XG4gICAgdGhpcy5uYW1lID0gJ1RpbWVvdXRFcnJvcic7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgVGltZW91dEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblxuICBmdW5jdGlvbiB0aW1lb3V0V2l0aFNlbGVjdG9yKHNvdXJjZSwgZmlyc3RUaW1lb3V0LCB0aW1lb3V0RHVyYXRpb25TZWxlY3Rvciwgb3RoZXIpIHtcbiAgICBpZiAoaXNGdW5jdGlvbihmaXJzdFRpbWVvdXQpKSB7XG4gICAgICBvdGhlciA9IHRpbWVvdXREdXJhdGlvblNlbGVjdG9yO1xuICAgICAgdGltZW91dER1cmF0aW9uU2VsZWN0b3IgPSBmaXJzdFRpbWVvdXQ7XG4gICAgICBmaXJzdFRpbWVvdXQgPSBvYnNlcnZhYmxlTmV2ZXIoKTtcbiAgICB9XG4gICAgb3RoZXIgfHwgKG90aGVyID0gb2JzZXJ2YWJsZVRocm93KG5ldyBUaW1lb3V0RXJyb3IoKSkpO1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG4gICAgICAgIHRpbWVyID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSxcbiAgICAgICAgb3JpZ2luYWwgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblxuICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3JpZ2luYWwpO1xuXG4gICAgICB2YXIgaWQgPSAwLCBzd2l0Y2hlZCA9IGZhbHNlO1xuXG4gICAgICBmdW5jdGlvbiBzZXRUaW1lcih0aW1lb3V0KSB7XG4gICAgICAgIHZhciBteUlkID0gaWQsIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblxuICAgICAgICBmdW5jdGlvbiB0aW1lcldpbnMoKSB7XG4gICAgICAgICAgc3dpdGNoZWQgPSAobXlJZCA9PT0gaWQpO1xuICAgICAgICAgIHJldHVybiBzd2l0Y2hlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRpbWVyLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICAgIGQuc2V0RGlzcG9zYWJsZSh0aW1lb3V0LnN1YnNjcmliZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGltZXJXaW5zKCkgJiYgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG8pKTtcbiAgICAgICAgICBkLmRpc3Bvc2UoKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICB0aW1lcldpbnMoKSAmJiBvLm9uRXJyb3IoZSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aW1lcldpbnMoKSAmJiBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShvdGhlci5zdWJzY3JpYmUobykpO1xuICAgICAgICB9KSk7XG4gICAgICB9O1xuXG4gICAgICBzZXRUaW1lcihmaXJzdFRpbWVvdXQpO1xuXG4gICAgICBmdW5jdGlvbiBvV2lucygpIHtcbiAgICAgICAgdmFyIHJlcyA9ICFzd2l0Y2hlZDtcbiAgICAgICAgaWYgKHJlcykgeyBpZCsrOyB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgICB9XG5cbiAgICAgIG9yaWdpbmFsLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAob1dpbnMoKSkge1xuICAgICAgICAgIG8ub25OZXh0KHgpO1xuICAgICAgICAgIHZhciB0aW1lb3V0ID0gdHJ5Q2F0Y2godGltZW91dER1cmF0aW9uU2VsZWN0b3IpKHgpO1xuICAgICAgICAgIGlmICh0aW1lb3V0ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHRpbWVvdXQuZSk7IH1cbiAgICAgICAgICBzZXRUaW1lcihpc1Byb21pc2UodGltZW91dCkgPyBvYnNlcnZhYmxlRnJvbVByb21pc2UodGltZW91dCkgOiB0aW1lb3V0KTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgb1dpbnMoKSAmJiBvLm9uRXJyb3IoZSk7XG4gICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9XaW5zKCkgJiYgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfSkpO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgdGltZXIpO1xuICAgIH0sIHNvdXJjZSk7XG4gIH1cblxuICBmdW5jdGlvbiB0aW1lb3V0KHNvdXJjZSwgZHVlVGltZSwgb3RoZXIsIHNjaGVkdWxlcikge1xuICAgIGlmIChpc1NjaGVkdWxlcihvdGhlcikpIHtcbiAgICAgIHNjaGVkdWxlciA9IG90aGVyO1xuICAgICAgb3RoZXIgPSBvYnNlcnZhYmxlVGhyb3cobmV3IFRpbWVvdXRFcnJvcigpKTtcbiAgICB9XG4gICAgaWYgKG90aGVyIGluc3RhbmNlb2YgRXJyb3IpIHsgb3RoZXIgPSBvYnNlcnZhYmxlVGhyb3cob3RoZXIpOyB9XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBpZCA9IDAsXG4gICAgICAgIG9yaWdpbmFsID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksXG4gICAgICAgIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG4gICAgICAgIHN3aXRjaGVkID0gZmFsc2UsXG4gICAgICAgIHRpbWVyID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblxuICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3JpZ2luYWwpO1xuXG4gICAgICBmdW5jdGlvbiBjcmVhdGVUaW1lcigpIHtcbiAgICAgICAgdmFyIG15SWQgPSBpZDtcbiAgICAgICAgdGltZXIuc2V0RGlzcG9zYWJsZShzY2hlZHVsZXIuc2NoZWR1bGVGdXR1cmUobnVsbCwgZHVlVGltZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHN3aXRjaGVkID0gaWQgPT09IG15SWQ7XG4gICAgICAgICAgaWYgKHN3aXRjaGVkKSB7XG4gICAgICAgICAgICBpc1Byb21pc2Uob3RoZXIpICYmIChvdGhlciA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikpO1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG8pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICAgIH1cblxuICAgICAgY3JlYXRlVGltZXIoKTtcblxuICAgICAgb3JpZ2luYWwuc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIGlmICghc3dpdGNoZWQpIHtcbiAgICAgICAgICBpZCsrO1xuICAgICAgICAgIG8ub25OZXh0KHgpO1xuICAgICAgICAgIGNyZWF0ZVRpbWVyKCk7XG4gICAgICAgIH1cbiAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghc3dpdGNoZWQpIHtcbiAgICAgICAgICBpZCsrO1xuICAgICAgICAgIG8ub25FcnJvcihlKTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXN3aXRjaGVkKSB7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIHRpbWVyKTtcbiAgICB9LCBzb3VyY2UpO1xuICB9XG5cbiAgb2JzZXJ2YWJsZVByb3RvLnRpbWVvdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGZpcnN0QXJnID0gYXJndW1lbnRzWzBdO1xuICAgIGlmIChmaXJzdEFyZyBpbnN0YW5jZW9mIERhdGUgfHwgdHlwZW9mIGZpcnN0QXJnID09PSAnbnVtYmVyJykge1xuICAgICAgcmV0dXJuIHRpbWVvdXQodGhpcywgZmlyc3RBcmcsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcbiAgICB9IGVsc2UgaWYgKE9ic2VydmFibGUuaXNPYnNlcnZhYmxlKGZpcnN0QXJnKSB8fCBpc0Z1bmN0aW9uKGZpcnN0QXJnKSkge1xuICAgICAgcmV0dXJuIHRpbWVvdXRXaXRoU2VsZWN0b3IodGhpcywgZmlyc3RBcmcsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50cycpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgb25seSB0aGUgZmlyc3QgaXRlbSBlbWl0dGVkIGJ5IHRoZSBzb3VyY2UgT2JzZXJ2YWJsZSBkdXJpbmcgc2VxdWVudGlhbCB0aW1lIHdpbmRvd3Mgb2YgYSBzcGVjaWZpZWQgZHVyYXRpb24uXG4gICAqIEBwYXJhbSB7TnVtYmVyfSB3aW5kb3dEdXJhdGlvbiB0aW1lIHRvIHdhaXQgYmVmb3JlIGVtaXR0aW5nIGFub3RoZXIgaXRlbSBhZnRlciBlbWl0dGluZyB0aGUgbGFzdCBpdGVtXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSB0aGUgU2NoZWR1bGVyIHRvIHVzZSBpbnRlcm5hbGx5IHRvIG1hbmFnZSB0aGUgdGltZXJzIHRoYXQgaGFuZGxlIHRpbWVvdXQgZm9yIGVhY2ggaXRlbS4gSWYgbm90IHByb3ZpZGVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIudGltZW91dC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIE9ic2VydmFibGUgdGhhdCBwZXJmb3JtcyB0aGUgdGhyb3R0bGUgb3BlcmF0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnRocm90dGxlID0gZnVuY3Rpb24gKHdpbmRvd0R1cmF0aW9uLCBzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICB2YXIgZHVyYXRpb24gPSArd2luZG93RHVyYXRpb24gfHwgMDtcbiAgICBpZiAoZHVyYXRpb24gPD0gMCkgeyB0aHJvdyBuZXcgUmFuZ2VFcnJvcignd2luZG93RHVyYXRpb24gY2Fubm90IGJlIGxlc3Mgb3IgZXF1YWwgemVyby4nKTsgfVxuICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGxhc3RPbk5leHQgPSAwO1xuICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUoXG4gICAgICAgIGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgdmFyIG5vdyA9IHNjaGVkdWxlci5ub3coKTtcbiAgICAgICAgICBpZiAobGFzdE9uTmV4dCA9PT0gMCB8fCBub3cgLSBsYXN0T25OZXh0ID49IGR1cmF0aW9uKSB7XG4gICAgICAgICAgICBsYXN0T25OZXh0ID0gbm93O1xuICAgICAgICAgICAgby5vbk5leHQoeCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSwgZnVuY3Rpb24gKCkgeyBvLm9uQ29tcGxldGVkKCk7IH1cbiAgICAgICk7XG4gICAgfSwgc291cmNlKTtcbiAgfTtcblxuICB2YXIgUGF1c2FibGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhQYXVzYWJsZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUGF1c2FibGVPYnNlcnZhYmxlKHNvdXJjZSwgcGF1c2VyKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuY29udHJvbGxlciA9IG5ldyBTdWJqZWN0KCk7XG5cbiAgICAgIGlmIChwYXVzZXIgJiYgcGF1c2VyLnN1YnNjcmliZSkge1xuICAgICAgICB0aGlzLnBhdXNlciA9IHRoaXMuY29udHJvbGxlci5tZXJnZShwYXVzZXIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wYXVzZXIgPSB0aGlzLmNvbnRyb2xsZXI7XG4gICAgICB9XG5cbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFBhdXNhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgY29ubiA9IHRoaXMuc291cmNlLnB1Ymxpc2goKSxcbiAgICAgICAgc3Vic2NyaXB0aW9uID0gY29ubi5zdWJzY3JpYmUobyksXG4gICAgICAgIGNvbm5lY3Rpb24gPSBkaXNwb3NhYmxlRW1wdHk7XG5cbiAgICAgIHZhciBwYXVzYWJsZSA9IHRoaXMucGF1c2VyLmRpc3RpbmN0VW50aWxDaGFuZ2VkKCkuc3Vic2NyaWJlKGZ1bmN0aW9uIChiKSB7XG4gICAgICAgIGlmIChiKSB7XG4gICAgICAgICAgY29ubmVjdGlvbiA9IGNvbm4uY29ubmVjdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbm5lY3Rpb24uZGlzcG9zZSgpO1xuICAgICAgICAgIGNvbm5lY3Rpb24gPSBkaXNwb3NhYmxlRW1wdHk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtzdWJzY3JpcHRpb24sIGNvbm5lY3Rpb24sIHBhdXNhYmxlXSk7XG4gICAgfTtcblxuICAgIFBhdXNhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIub25OZXh0KGZhbHNlKTtcbiAgICB9O1xuXG4gICAgUGF1c2FibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIub25OZXh0KHRydWUpO1xuICAgIH07XG5cbiAgICByZXR1cm4gUGF1c2FibGVPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIC8qKlxuICAgKiBQYXVzZXMgdGhlIHVuZGVybHlpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBiYXNlZCB1cG9uIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIHlpZWxkcyB0cnVlL2ZhbHNlLlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcGF1c2VyID0gbmV3IFJ4LlN1YmplY3QoKTtcbiAgICogdmFyIHNvdXJjZSA9IFJ4Lk9ic2VydmFibGUuaW50ZXJ2YWwoMTAwKS5wYXVzYWJsZShwYXVzZXIpO1xuICAgKiBAcGFyYW0ge09ic2VydmFibGV9IHBhdXNlciBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1c2VkIHRvIHBhdXNlIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggaXMgcGF1c2VkIGJhc2VkIHVwb24gdGhlIHBhdXNlci5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5wYXVzYWJsZSA9IGZ1bmN0aW9uIChwYXVzZXIpIHtcbiAgICByZXR1cm4gbmV3IFBhdXNhYmxlT2JzZXJ2YWJsZSh0aGlzLCBwYXVzZXIpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGNvbWJpbmVMYXRlc3RTb3VyY2Uoc291cmNlLCBzdWJqZWN0LCByZXN1bHRTZWxlY3Rvcikge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGhhc1ZhbHVlID0gW2ZhbHNlLCBmYWxzZV0sXG4gICAgICAgIGhhc1ZhbHVlQWxsID0gZmFsc2UsXG4gICAgICAgIGlzRG9uZSA9IGZhbHNlLFxuICAgICAgICB2YWx1ZXMgPSBuZXcgQXJyYXkoMiksXG4gICAgICAgIGVycjtcblxuICAgICAgZnVuY3Rpb24gbmV4dCh4LCBpKSB7XG4gICAgICAgIHZhbHVlc1tpXSA9IHg7XG4gICAgICAgIGhhc1ZhbHVlW2ldID0gdHJ1ZTtcbiAgICAgICAgaWYgKGhhc1ZhbHVlQWxsIHx8IChoYXNWYWx1ZUFsbCA9IGhhc1ZhbHVlLmV2ZXJ5KGlkZW50aXR5KSkpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7IHJldHVybiBvLm9uRXJyb3IoZXJyKTsgfVxuICAgICAgICAgIHZhciByZXMgPSB0cnlDYXRjaChyZXN1bHRTZWxlY3RvcikuYXBwbHkobnVsbCwgdmFsdWVzKTtcbiAgICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgICAgIG8ub25OZXh0KHJlcyk7XG4gICAgICAgIH1cbiAgICAgICAgaXNEb25lICYmIHZhbHVlc1sxXSAmJiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShcbiAgICAgICAgc291cmNlLnN1YnNjcmliZShcbiAgICAgICAgICBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgICAgbmV4dCh4LCAwKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAodmFsdWVzWzFdKSB7XG4gICAgICAgICAgICAgIG8ub25FcnJvcihlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGVyciA9IGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpc0RvbmUgPSB0cnVlO1xuICAgICAgICAgICAgdmFsdWVzWzFdICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICB9KSxcbiAgICAgICAgc3ViamVjdC5zdWJzY3JpYmUoXG4gICAgICAgICAgZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIG5leHQoeCwgMSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG4gICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIG5leHQodHJ1ZSwgMSk7XG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICB9LCBzb3VyY2UpO1xuICB9XG5cbiAgdmFyIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZShzb3VyY2UsIHBhdXNlcikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgU3ViamVjdCgpO1xuXG4gICAgICBpZiAocGF1c2VyICYmIHBhdXNlci5zdWJzY3JpYmUpIHtcbiAgICAgICAgdGhpcy5wYXVzZXIgPSB0aGlzLmNvbnRyb2xsZXIubWVyZ2UocGF1c2VyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyO1xuICAgICAgfVxuXG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgcSA9IFtdLCBwcmV2aW91c1Nob3VsZEZpcmU7XG5cbiAgICAgIGZ1bmN0aW9uIGRyYWluUXVldWUoKSB7IHdoaWxlIChxLmxlbmd0aCA+IDApIHsgby5vbk5leHQocS5zaGlmdCgpKTsgfSB9XG5cbiAgICAgIHZhciBzdWJzY3JpcHRpb24gPVxuICAgICAgICBjb21iaW5lTGF0ZXN0U291cmNlKFxuICAgICAgICAgIHRoaXMuc291cmNlLFxuICAgICAgICAgIHRoaXMucGF1c2VyLnN0YXJ0V2l0aChmYWxzZSkuZGlzdGluY3RVbnRpbENoYW5nZWQoKSxcbiAgICAgICAgICBmdW5jdGlvbiAoZGF0YSwgc2hvdWxkRmlyZSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgZGF0YTogZGF0YSwgc2hvdWxkRmlyZTogc2hvdWxkRmlyZSB9O1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgICAgICAgICAgIGlmIChwcmV2aW91c1Nob3VsZEZpcmUgIT09IHVuZGVmaW5lZCAmJiByZXN1bHRzLnNob3VsZEZpcmUgIT09IHByZXZpb3VzU2hvdWxkRmlyZSkge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzU2hvdWxkRmlyZSA9IHJlc3VsdHMuc2hvdWxkRmlyZTtcbiAgICAgICAgICAgICAgICAvLyBjaGFuZ2UgaW4gc2hvdWxkRmlyZVxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLnNob3VsZEZpcmUpIHsgZHJhaW5RdWV1ZSgpOyB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNTaG91bGRGaXJlID0gcmVzdWx0cy5zaG91bGRGaXJlO1xuICAgICAgICAgICAgICAgIC8vIG5ldyBkYXRhXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMuc2hvdWxkRmlyZSkge1xuICAgICAgICAgICAgICAgICAgby5vbk5leHQocmVzdWx0cy5kYXRhKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcS5wdXNoKHJlc3VsdHMuZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgICAgICAgICAgIG8ub25FcnJvcihlcnIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgICAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgIHJldHVybiBzdWJzY3JpcHRpb247ICAgICAgXG4gICAgfTtcblxuICAgIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY29udHJvbGxlci5vbk5leHQoZmFsc2UpO1xuICAgIH07XG5cbiAgICBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dCh0cnVlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIC8qKlxuICAgKiBQYXVzZXMgdGhlIHVuZGVybHlpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBiYXNlZCB1cG9uIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIHlpZWxkcyB0cnVlL2ZhbHNlLFxuICAgKiBhbmQgeWllbGRzIHRoZSB2YWx1ZXMgdGhhdCB3ZXJlIGJ1ZmZlcmVkIHdoaWxlIHBhdXNlZC5cbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHBhdXNlciA9IG5ldyBSeC5TdWJqZWN0KCk7XG4gICAqIHZhciBzb3VyY2UgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMCkucGF1c2FibGVCdWZmZXJlZChwYXVzZXIpO1xuICAgKiBAcGFyYW0ge09ic2VydmFibGV9IHBhdXNlciBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1c2VkIHRvIHBhdXNlIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggaXMgcGF1c2VkIGJhc2VkIHVwb24gdGhlIHBhdXNlci5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5wYXVzYWJsZUJ1ZmZlcmVkID0gZnVuY3Rpb24gKHN1YmplY3QpIHtcbiAgICByZXR1cm4gbmV3IFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlKHRoaXMsIHN1YmplY3QpO1xuICB9O1xuXG4gIHZhciBDb250cm9sbGVkT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ29udHJvbGxlZE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29udHJvbGxlZE9ic2VydmFibGUgKHNvdXJjZSwgZW5hYmxlUXVldWUsIHNjaGVkdWxlcikge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLnN1YmplY3QgPSBuZXcgQ29udHJvbGxlZFN1YmplY3QoZW5hYmxlUXVldWUsIHNjaGVkdWxlcik7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZS5tdWx0aWNhc3QodGhpcy5zdWJqZWN0KS5yZWZDb3VudCgpO1xuICAgIH1cblxuICAgIENvbnRyb2xsZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobyk7XG4gICAgfTtcblxuICAgIENvbnRyb2xsZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gKG51bWJlck9mSXRlbXMpIHtcbiAgICAgIHJldHVybiB0aGlzLnN1YmplY3QucmVxdWVzdChudW1iZXJPZkl0ZW1zID09IG51bGwgPyAtMSA6IG51bWJlck9mSXRlbXMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gQ29udHJvbGxlZE9ic2VydmFibGU7XG5cbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgdmFyIENvbnRyb2xsZWRTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhDb250cm9sbGVkU3ViamVjdCwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDb250cm9sbGVkU3ViamVjdChlbmFibGVRdWV1ZSwgc2NoZWR1bGVyKSB7XG4gICAgICBlbmFibGVRdWV1ZSA9PSBudWxsICYmIChlbmFibGVRdWV1ZSA9IHRydWUpO1xuXG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuc3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XG4gICAgICB0aGlzLmVuYWJsZVF1ZXVlID0gZW5hYmxlUXVldWU7XG4gICAgICB0aGlzLnF1ZXVlID0gZW5hYmxlUXVldWUgPyBbXSA6IG51bGw7XG4gICAgICB0aGlzLnJlcXVlc3RlZENvdW50ID0gMDtcbiAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSA9IG51bGw7XG4gICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgIHRoaXMuaGFzRmFpbGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXIgfHwgY3VycmVudFRocmVhZFNjaGVkdWxlcjtcbiAgICB9XG5cbiAgICBhZGRQcm9wZXJ0aWVzKENvbnRyb2xsZWRTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIsIHtcbiAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1YmplY3Quc3Vic2NyaWJlKG8pO1xuICAgICAgfSxcbiAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaGFzQ29tcGxldGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVF1ZXVlIHx8IHRoaXMucXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5zdWJqZWN0Lm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnF1ZXVlLnB1c2goTm90aWZpY2F0aW9uLmNyZWF0ZU9uQ29tcGxldGVkKCkpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHRoaXMuaGFzRmFpbGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgICBpZiAoIXRoaXMuZW5hYmxlUXVldWUgfHwgdGhpcy5xdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICB0aGlzLnN1YmplY3Qub25FcnJvcihlcnJvcik7XG4gICAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnF1ZXVlLnB1c2goTm90aWZpY2F0aW9uLmNyZWF0ZU9uRXJyb3IoZXJyb3IpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0aGlzLnJlcXVlc3RlZENvdW50IDw9IDApIHtcbiAgICAgICAgICB0aGlzLmVuYWJsZVF1ZXVlICYmIHRoaXMucXVldWUucHVzaChOb3RpZmljYXRpb24uY3JlYXRlT25OZXh0KHZhbHVlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgKHRoaXMucmVxdWVzdGVkQ291bnQtLSA9PT0gMCkgJiYgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcbiAgICAgICAgICB0aGlzLnN1YmplY3Qub25OZXh0KHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIF9wcm9jZXNzUmVxdWVzdDogZnVuY3Rpb24gKG51bWJlck9mSXRlbXMpIHtcbiAgICAgICAgaWYgKHRoaXMuZW5hYmxlUXVldWUpIHtcbiAgICAgICAgICB3aGlsZSAodGhpcy5xdWV1ZS5sZW5ndGggPiAwICYmIChudW1iZXJPZkl0ZW1zID4gMCB8fCB0aGlzLnF1ZXVlWzBdLmtpbmQgIT09ICdOJykpIHtcbiAgICAgICAgICAgIHZhciBmaXJzdCA9IHRoaXMucXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgIGZpcnN0LmFjY2VwdCh0aGlzLnN1YmplY3QpO1xuICAgICAgICAgICAgaWYgKGZpcnN0LmtpbmQgPT09ICdOJykge1xuICAgICAgICAgICAgICBudW1iZXJPZkl0ZW1zLS07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLmRpc3Bvc2VDdXJyZW50UmVxdWVzdCgpO1xuICAgICAgICAgICAgICB0aGlzLnF1ZXVlID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG51bWJlck9mSXRlbXM7XG4gICAgICB9LFxuICAgICAgcmVxdWVzdDogZnVuY3Rpb24gKG51bWJlcikge1xuICAgICAgICB0aGlzLmRpc3Bvc2VDdXJyZW50UmVxdWVzdCgpO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgdGhpcy5yZXF1ZXN0ZWREaXNwb3NhYmxlID0gdGhpcy5zY2hlZHVsZXIuc2NoZWR1bGUobnVtYmVyLFxuICAgICAgICBmdW5jdGlvbihzLCBpKSB7XG4gICAgICAgICAgdmFyIHJlbWFpbmluZyA9IHNlbGYuX3Byb2Nlc3NSZXF1ZXN0KGkpO1xuICAgICAgICAgIHZhciBzdG9wcGVkID0gc2VsZi5oYXNDb21wbGV0ZWQgfHwgc2VsZi5oYXNGYWlsZWQ7XG4gICAgICAgICAgaWYgKCFzdG9wcGVkICYmIHJlbWFpbmluZyA+IDApIHtcbiAgICAgICAgICAgIHNlbGYucmVxdWVzdGVkQ291bnQgPSByZW1haW5pbmc7XG5cbiAgICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgc2VsZi5yZXF1ZXN0ZWRDb3VudCA9IDA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgLy8gU2NoZWR1bGVkIGl0ZW0gaXMgc3RpbGwgaW4gcHJvZ3Jlc3MuIFJldHVybiBhIG5ld1xuICAgICAgICAgICAgICAvLyBkaXNwb3NhYmxlIHRvIGFsbG93IHRoZSByZXF1ZXN0IHRvIGJlIGludGVycnVwdGVkXG4gICAgICAgICAgICAgIC8vIHZpYSBkaXNwb3NlLlxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZTtcbiAgICAgIH0sXG4gICAgICBkaXNwb3NlQ3VycmVudFJlcXVlc3Q6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSkge1xuICAgICAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZS5kaXNwb3NlKCk7XG4gICAgICAgICAgdGhpcy5yZXF1ZXN0ZWREaXNwb3NhYmxlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIENvbnRyb2xsZWRTdWJqZWN0O1xuICB9KE9ic2VydmFibGUpKTtcblxuICAvKipcbiAgICogQXR0YWNoZXMgYSBjb250cm9sbGVyIHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGhlIGFiaWxpdHkgdG8gcXVldWUuXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciBzb3VyY2UgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMCkuY29udHJvbGxlZCgpO1xuICAgKiBzb3VyY2UucmVxdWVzdCgzKTsgLy8gUmVhZHMgMyB2YWx1ZXNcbiAgICogQHBhcmFtIHtib29sfSBlbmFibGVRdWV1ZSB0cnV0aHkgdmFsdWUgdG8gZGV0ZXJtaW5lIGlmIHZhbHVlcyBzaG91bGQgYmUgcXVldWVkIHBlbmRpbmcgdGhlIG5leHQgcmVxdWVzdFxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIGRldGVybWluZXMgaG93IHRoZSByZXF1ZXN0cyB3aWxsIGJlIHNjaGVkdWxlZFxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggb25seSBwcm9wYWdhdGVzIHZhbHVlcyBvbiByZXF1ZXN0LlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmNvbnRyb2xsZWQgPSBmdW5jdGlvbiAoZW5hYmxlUXVldWUsIHNjaGVkdWxlcikge1xuXG4gICAgaWYgKGVuYWJsZVF1ZXVlICYmIGlzU2NoZWR1bGVyKGVuYWJsZVF1ZXVlKSkge1xuICAgICAgc2NoZWR1bGVyID0gZW5hYmxlUXVldWU7XG4gICAgICBlbmFibGVRdWV1ZSA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGVuYWJsZVF1ZXVlID09IG51bGwpIHsgIGVuYWJsZVF1ZXVlID0gdHJ1ZTsgfVxuICAgIHJldHVybiBuZXcgQ29udHJvbGxlZE9ic2VydmFibGUodGhpcywgZW5hYmxlUXVldWUsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBpcGVzIHRoZSBleGlzdGluZyBPYnNlcnZhYmxlIHNlcXVlbmNlIGludG8gYSBOb2RlLmpzIFN0cmVhbS5cbiAgICogQHBhcmFtIHtTdHJlYW19IGRlc3QgVGhlIGRlc3RpbmF0aW9uIE5vZGUuanMgc3RyZWFtLlxuICAgKiBAcmV0dXJucyB7U3RyZWFtfSBUaGUgZGVzdGluYXRpb24gc3RyZWFtLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnBpcGUgPSBmdW5jdGlvbiAoZGVzdCkge1xuICAgIHZhciBzb3VyY2UgPSB0aGlzLnBhdXNhYmxlQnVmZmVyZWQoKTtcblxuICAgIGZ1bmN0aW9uIG9uRHJhaW4oKSB7XG4gICAgICBzb3VyY2UucmVzdW1lKCk7XG4gICAgfVxuXG4gICAgZGVzdC5hZGRMaXN0ZW5lcignZHJhaW4nLCBvbkRyYWluKTtcblxuICAgIHNvdXJjZS5zdWJzY3JpYmUoXG4gICAgICBmdW5jdGlvbiAoeCkge1xuICAgICAgICAhZGVzdC53cml0ZShTdHJpbmcoeCkpICYmIHNvdXJjZS5wYXVzZSgpO1xuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgZGVzdC5lbWl0KCdlcnJvcicsIGVycik7XG4gICAgICB9LFxuICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBIYWNrIGNoZWNrIGJlY2F1c2UgU1RESU8gaXMgbm90IGNsb3NhYmxlXG4gICAgICAgICFkZXN0Ll9pc1N0ZGlvICYmIGRlc3QuZW5kKCk7XG4gICAgICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2RyYWluJywgb25EcmFpbik7XG4gICAgICB9KTtcblxuICAgIHNvdXJjZS5yZXN1bWUoKTtcblxuICAgIHJldHVybiBkZXN0O1xuICB9O1xuXG4gIHZhciBUcmFuc2R1Y2VPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVHJhbnNkdWNlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVHJhbnNkdWNlT2JzZXJ2ZXIobywgeGZvcm0pIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5feGZvcm0gPSB4Zm9ybTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRyYW5zZHVjZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl94Zm9ybVsnQEB0cmFuc2R1Y2VyL3N0ZXAnXSkuY2FsbCh0aGlzLl94Zm9ybSwgdGhpcy5fbywgeCk7XG4gICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG4gICAgfTtcblxuICAgIFRyYW5zZHVjZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcblxuICAgIFRyYW5zZHVjZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl94Zm9ybVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHRoaXMuX28pO1xuICAgIH07XG5cbiAgICByZXR1cm4gVHJhbnNkdWNlT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIGZ1bmN0aW9uIHRyYW5zZm9ybUZvck9ic2VydmVyKG8pIHtcbiAgICByZXR1cm4ge1xuICAgICAgJ0BAdHJhbnNkdWNlci9pbml0JzogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBvO1xuICAgICAgfSxcbiAgICAgICdAQHRyYW5zZHVjZXIvc3RlcCc6IGZ1bmN0aW9uKG9icywgaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIG9icy5vbk5leHQoaW5wdXQpO1xuICAgICAgfSxcbiAgICAgICdAQHRyYW5zZHVjZXIvcmVzdWx0JzogZnVuY3Rpb24ob2JzKSB7XG4gICAgICAgIHJldHVybiBvYnMub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGVzIGEgdHJhbnNkdWNlciB0byB0cmFuc2Zvcm0gdGhlIG9ic2VydmFibGUgc2VxdWVuY2VcbiAgICogQHBhcmFtIHtUcmFuc2R1Y2VyfSB0cmFuc2R1Y2VyIEEgdHJhbnNkdWNlciB0byBleGVjdXRlXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdHMgZnJvbSB0aGUgdHJhbnNkdWNlci5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50cmFuc2R1Y2UgPSBmdW5jdGlvbih0cmFuc2R1Y2VyKSB7XG4gICAgdmFyIHNvdXJjZSA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uKG8pIHtcbiAgICAgIHZhciB4Zm9ybSA9IHRyYW5zZHVjZXIodHJhbnNmb3JtRm9yT2JzZXJ2ZXIobykpO1xuICAgICAgcmV0dXJuIHNvdXJjZS5zdWJzY3JpYmUobmV3IFRyYW5zZHVjZU9ic2VydmVyKG8sIHhmb3JtKSk7XG4gICAgfSwgc291cmNlKTtcbiAgfTtcblxuICB2YXIgQW5vbnltb3VzT2JzZXJ2YWJsZSA9IFJ4LkFub255bW91c09ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEFub255bW91c09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cbiAgICAvLyBGaXggc3Vic2NyaWJlciB0byBjaGVjayBmb3IgdW5kZWZpbmVkIG9yIGZ1bmN0aW9uIHJldHVybmVkIHRvIGRlY29yYXRlIGFzIERpc3Bvc2FibGVcbiAgICBmdW5jdGlvbiBmaXhTdWJzY3JpYmVyKHN1YnNjcmliZXIpIHtcbiAgICAgIHJldHVybiBzdWJzY3JpYmVyICYmIGlzRnVuY3Rpb24oc3Vic2NyaWJlci5kaXNwb3NlKSA/IHN1YnNjcmliZXIgOlxuICAgICAgICBpc0Z1bmN0aW9uKHN1YnNjcmliZXIpID8gZGlzcG9zYWJsZUNyZWF0ZShzdWJzY3JpYmVyKSA6IGRpc3Bvc2FibGVFbXB0eTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXREaXNwb3NhYmxlKHMsIHN0YXRlKSB7XG4gICAgICB2YXIgYWRvID0gc3RhdGVbMF0sIHNlbGYgPSBzdGF0ZVsxXTtcbiAgICAgIHZhciBzdWIgPSB0cnlDYXRjaChzZWxmLl9fc3Vic2NyaWJlKS5jYWxsKHNlbGYsIGFkbyk7XG4gICAgICBpZiAoc3ViID09PSBlcnJvck9iaiAmJiAhYWRvLmZhaWwoZXJyb3JPYmouZSkpIHsgdGhyb3dlcihlcnJvck9iai5lKTsgfVxuICAgICAgYWRvLnNldERpc3Bvc2FibGUoZml4U3Vic2NyaWJlcihzdWIpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBBbm9ueW1vdXNPYnNlcnZhYmxlKHN1YnNjcmliZSwgcGFyZW50KSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHBhcmVudDtcbiAgICAgIHRoaXMuX19zdWJzY3JpYmUgPSBzdWJzY3JpYmU7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBBbm9ueW1vdXNPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBhZG8gPSBuZXcgQXV0b0RldGFjaE9ic2VydmVyKG8pLCBzdGF0ZSA9IFthZG8sIHRoaXNdO1xuXG4gICAgICBpZiAoY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlcXVpcmVkKCkpIHtcbiAgICAgICAgY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZSwgc2V0RGlzcG9zYWJsZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXREaXNwb3NhYmxlKG51bGwsIHN0YXRlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhZG87XG4gICAgfTtcblxuICAgIHJldHVybiBBbm9ueW1vdXNPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIHZhciBBdXRvRGV0YWNoT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEF1dG9EZXRhY2hPYnNlcnZlciwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIEF1dG9EZXRhY2hPYnNlcnZlcihvYnNlcnZlcikge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgICB0aGlzLm0gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICB9XG5cbiAgICB2YXIgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlID0gQXV0b0RldGFjaE9ic2VydmVyLnByb3RvdHlwZTtcblxuICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5vYnNlcnZlci5vbk5leHQpLmNhbGwodGhpcy5vYnNlcnZlciwgdmFsdWUpO1xuICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHtcbiAgICAgICAgdGhpcy5kaXNwb3NlKCk7XG4gICAgICAgIHRocm93ZXIocmVzdWx0LmUpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5vYnNlcnZlci5vbkVycm9yKS5jYWxsKHRoaXMub2JzZXJ2ZXIsIGVycik7XG4gICAgICB0aGlzLmRpc3Bvc2UoKTtcbiAgICAgIHJlc3VsdCA9PT0gZXJyb3JPYmogJiYgdGhyb3dlcihyZXN1bHQuZSk7XG4gICAgfTtcblxuICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5vYnNlcnZlci5vbkNvbXBsZXRlZCkuY2FsbCh0aGlzLm9ic2VydmVyKTtcbiAgICAgIHRoaXMuZGlzcG9zZSgpO1xuICAgICAgcmVzdWx0ID09PSBlcnJvck9iaiAmJiB0aHJvd2VyKHJlc3VsdC5lKTtcbiAgICB9O1xuXG4gICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLnNldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAodmFsdWUpIHsgdGhpcy5tLnNldERpc3Bvc2FibGUodmFsdWUpOyB9O1xuICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5nZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5tLmdldERpc3Bvc2FibGUoKTsgfTtcblxuICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgX19zdXBlcl9fLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLm0uZGlzcG9zZSgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gQXV0b0RldGFjaE9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICB2YXIgSW5uZXJTdWJzY3JpcHRpb24gPSBmdW5jdGlvbiAocywgbykge1xuICAgIHRoaXMuX3MgPSBzO1xuICAgIHRoaXMuX28gPSBvO1xuICB9O1xuXG4gIElubmVyU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5fcy5pc0Rpc3Bvc2VkICYmIHRoaXMuX28gIT09IG51bGwpIHtcbiAgICAgIHZhciBpZHggPSB0aGlzLl9zLm9ic2VydmVycy5pbmRleE9mKHRoaXMuX28pO1xuICAgICAgdGhpcy5fcy5vYnNlcnZlcnMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICB0aGlzLl9vID0gbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqICBSZXByZXNlbnRzIGFuIG9iamVjdCB0aGF0IGlzIGJvdGggYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyB3ZWxsIGFzIGFuIG9ic2VydmVyLlxuICAgKiAgRWFjaCBub3RpZmljYXRpb24gaXMgYnJvYWRjYXN0ZWQgdG8gYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzLlxuICAgKi9cbiAgdmFyIFN1YmplY3QgPSBSeC5TdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTdWJqZWN0LCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFN1YmplY3QoKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG4gICAgICB0aGlzLmhhc0Vycm9yID0gZmFsc2U7XG4gICAgfVxuXG4gICAgYWRkUHJvcGVydGllcyhTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG4gICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvKTtcbiAgICAgICAgICByZXR1cm4gbmV3IElubmVyU3Vic2NyaXB0aW9uKHRoaXMsIG8pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG4gICAgICAgICAgby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgICAgIH1cbiAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cbiAgICAgICAqL1xuICAgICAgaGFzT2JzZXJ2ZXJzOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm9ic2VydmVycy5sZW5ndGggPiAwOyB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UuXG4gICAgICAgKi9cbiAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvc1tpXS5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXhjZXB0aW9uLlxuICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIGV4Y2VwdGlvbiB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG9zW2ldLm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgYXJyaXZhbCBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuICAgICAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cbiAgICAgICAqL1xuICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgb3NbaV0ub25OZXh0KHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuICAgICAgICovXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzdWJqZWN0IGZyb20gdGhlIHNwZWNpZmllZCBvYnNlcnZlciBhbmQgb2JzZXJ2YWJsZS5cbiAgICAgKiBAcGFyYW0ge09ic2VydmVyfSBvYnNlcnZlciBUaGUgb2JzZXJ2ZXIgdXNlZCB0byBzZW5kIG1lc3NhZ2VzIHRvIHRoZSBzdWJqZWN0LlxuICAgICAqIEBwYXJhbSB7T2JzZXJ2YWJsZX0gb2JzZXJ2YWJsZSBUaGUgb2JzZXJ2YWJsZSB1c2VkIHRvIHN1YnNjcmliZSB0byBtZXNzYWdlcyBzZW50IGZyb20gdGhlIHN1YmplY3QuXG4gICAgICogQHJldHVybnMge1N1YmplY3R9IFN1YmplY3QgaW1wbGVtZW50ZWQgdXNpbmcgdGhlIGdpdmVuIG9ic2VydmVyIGFuZCBvYnNlcnZhYmxlLlxuICAgICAqL1xuICAgIFN1YmplY3QuY3JlYXRlID0gZnVuY3Rpb24gKG9ic2VydmVyLCBvYnNlcnZhYmxlKSB7XG4gICAgICByZXR1cm4gbmV3IEFub255bW91c1N1YmplY3Qob2JzZXJ2ZXIsIG9ic2VydmFibGUpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU3ViamVjdDtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgLyoqXG4gICAqICBSZXByZXNlbnRzIHRoZSByZXN1bHQgb2YgYW4gYXN5bmNocm9ub3VzIG9wZXJhdGlvbi5cbiAgICogIFRoZSBsYXN0IHZhbHVlIGJlZm9yZSB0aGUgT25Db21wbGV0ZWQgbm90aWZpY2F0aW9uLCBvciB0aGUgZXJyb3IgcmVjZWl2ZWQgdGhyb3VnaCBPbkVycm9yLCBpcyBzZW50IHRvIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycy5cbiAgICovXG4gIHZhciBBc3luY1N1YmplY3QgPSBSeC5Bc3luY1N1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEFzeW5jU3ViamVjdCwgX19zdXBlcl9fKTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzdWJqZWN0IHRoYXQgY2FuIG9ubHkgcmVjZWl2ZSBvbmUgdmFsdWUgYW5kIHRoYXQgdmFsdWUgaXMgY2FjaGVkIGZvciBhbGwgZnV0dXJlIG9ic2VydmF0aW9ucy5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBc3luY1N1YmplY3QoKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaGFzVmFsdWUgPSBmYWxzZTtcbiAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG4gICAgICB0aGlzLmhhc0Vycm9yID0gZmFsc2U7XG4gICAgfVxuXG4gICAgYWRkUHJvcGVydGllcyhBc3luY1N1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcbiAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gobyk7XG4gICAgICAgICAgcmV0dXJuIG5ldyBJbm5lclN1YnNjcmlwdGlvbih0aGlzLCBvKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG4gICAgICAgICAgby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaGFzVmFsdWUpIHtcbiAgICAgICAgICBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcbiAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cbiAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKi9cbiAgICAgIGhhc09ic2VydmVyczogZnVuY3Rpb24gKCkge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICByZXR1cm4gdGhpcy5vYnNlcnZlcnMubGVuZ3RoID4gMDtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZSwgYWxzbyBjYXVzaW5nIHRoZSBsYXN0IHJlY2VpdmVkIHZhbHVlIHRvIGJlIHNlbnQgb3V0IChpZiBhbnkpLlxuICAgICAgICovXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaSwgbGVuO1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHZhciBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7XG5cbiAgICAgICAgICBpZiAodGhpcy5oYXNWYWx1ZSkge1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICAgIHZhciBvID0gb3NbaV07XG4gICAgICAgICAgICAgIG8ub25OZXh0KHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICBvc1tpXS5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXJyb3IuXG4gICAgICAgKiBAcGFyYW0ge01peGVkfSBlcnJvciBUaGUgRXJyb3IgdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuICAgICAgICovXG4gICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG5cbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG9zW2ldLm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIFNlbmRzIGEgdmFsdWUgdG8gdGhlIHN1YmplY3QuIFRoZSBsYXN0IHZhbHVlIHJlY2VpdmVkIGJlZm9yZSBzdWNjZXNzZnVsIHRlcm1pbmF0aW9uIHdpbGwgYmUgc2VudCB0byBhbGwgc3Vic2NyaWJlZCBhbmQgZnV0dXJlIG9ic2VydmVycy5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzdG9yZSBpbiB0aGUgc3ViamVjdC5cbiAgICAgICAqL1xuICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuaGFzVmFsdWUgPSB0cnVlO1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogVW5zdWJzY3JpYmUgYWxsIG9ic2VydmVycyBhbmQgcmVsZWFzZSByZXNvdXJjZXMuXG4gICAgICAgKi9cbiAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBudWxsO1xuICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gQXN5bmNTdWJqZWN0O1xuICB9KE9ic2VydmFibGUpKTtcblxuICB2YXIgQW5vbnltb3VzU3ViamVjdCA9IFJ4LkFub255bW91c1N1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEFub255bW91c1N1YmplY3QsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQW5vbnltb3VzU3ViamVjdChvYnNlcnZlciwgb2JzZXJ2YWJsZSkge1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy5vYnNlcnZhYmxlID0gb2JzZXJ2YWJsZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGFkZFByb3BlcnRpZXMoQW5vbnltb3VzU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2YWJsZS5zdWJzY3JpYmUobyk7XG4gICAgICB9LFxuICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuICAgICAgfSxcbiAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICB0aGlzLm9ic2VydmVyLm9uRXJyb3IoZXJyb3IpO1xuICAgICAgfSxcbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIub25OZXh0KHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBBbm9ueW1vdXNTdWJqZWN0O1xuICB9KE9ic2VydmFibGUpKTtcblxuICAvKipcbiAgICogIFJlcHJlc2VudHMgYSB2YWx1ZSB0aGF0IGNoYW5nZXMgb3ZlciB0aW1lLlxuICAgKiAgT2JzZXJ2ZXJzIGNhbiBzdWJzY3JpYmUgdG8gdGhlIHN1YmplY3QgdG8gcmVjZWl2ZSB0aGUgbGFzdCAob3IgaW5pdGlhbCkgdmFsdWUgYW5kIGFsbCBzdWJzZXF1ZW50IG5vdGlmaWNhdGlvbnMuXG4gICAqL1xuICB2YXIgQmVoYXZpb3JTdWJqZWN0ID0gUnguQmVoYXZpb3JTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhCZWhhdmlvclN1YmplY3QsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQmVoYXZpb3JTdWJqZWN0KHZhbHVlKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmhhc0Vycm9yID0gZmFsc2U7XG4gICAgfVxuXG4gICAgYWRkUHJvcGVydGllcyhCZWhhdmlvclN1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcbiAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG8pO1xuICAgICAgICAgIG8ub25OZXh0KHRoaXMudmFsdWUpO1xuICAgICAgICAgIHJldHVybiBuZXcgSW5uZXJTdWJzY3JpcHRpb24odGhpcywgbyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3IpIHtcbiAgICAgICAgICBvLm9uRXJyb3IodGhpcy5lcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBHZXRzIHRoZSBjdXJyZW50IHZhbHVlIG9yIHRocm93cyBhbiBleGNlcHRpb24uXG4gICAgICAgKiBWYWx1ZSBpcyBmcm96ZW4gYWZ0ZXIgb25Db21wbGV0ZWQgaXMgY2FsbGVkLlxuICAgICAgICogQWZ0ZXIgb25FcnJvciBpcyBjYWxsZWQgYWx3YXlzIHRocm93cyB0aGUgc3BlY2lmaWVkIGV4Y2VwdGlvbi5cbiAgICAgICAqIEFuIGV4Y2VwdGlvbiBpcyBhbHdheXMgdGhyb3duIGFmdGVyIGRpc3Bvc2UgaXMgY2FsbGVkLlxuICAgICAgICogQHJldHVybnMge01peGVkfSBUaGUgaW5pdGlhbCB2YWx1ZSBwYXNzZWQgdG8gdGhlIGNvbnN0cnVjdG9yIHVudGlsIG9uTmV4dCBpcyBjYWxsZWQ7IGFmdGVyIHdoaWNoLCB0aGUgbGFzdCB2YWx1ZSBwYXNzZWQgdG8gb25OZXh0LlxuICAgICAgICovXG4gICAgICBnZXRWYWx1ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgdGhyb3cgdGhpcy5lcnJvcjtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuICAgICAgICovXG4gICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7IH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZS5cbiAgICAgICAqL1xuICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIG9zW2ldLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBleGNlcHRpb24uXG4gICAgICAgKiBAcGFyYW0ge01peGVkfSBlcnJvciBUaGUgZXhjZXB0aW9uIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cbiAgICAgICAqL1xuICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIG9zW2ldLm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgYXJyaXZhbCBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuICAgICAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cbiAgICAgICAqL1xuICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIG9zW2ldLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuICAgICAgICovXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcbiAgICAgICAgdGhpcy52YWx1ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIEJlaGF2aW9yU3ViamVjdDtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgLyoqXG4gICAqIFJlcHJlc2VudHMgYW4gb2JqZWN0IHRoYXQgaXMgYm90aCBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIHdlbGwgYXMgYW4gb2JzZXJ2ZXIuXG4gICAqIEVhY2ggbm90aWZpY2F0aW9uIGlzIGJyb2FkY2FzdGVkIHRvIGFsbCBzdWJzY3JpYmVkIGFuZCBmdXR1cmUgb2JzZXJ2ZXJzLCBzdWJqZWN0IHRvIGJ1ZmZlciB0cmltbWluZyBwb2xpY2llcy5cbiAgICovXG4gIHZhciBSZXBsYXlTdWJqZWN0ID0gUnguUmVwbGF5U3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cbiAgICB2YXIgbWF4U2FmZUludGVnZXIgPSBNYXRoLnBvdygyLCA1MykgLSAxO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlUmVtb3ZhYmxlRGlzcG9zYWJsZShzdWJqZWN0LCBvYnNlcnZlcikge1xuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkge1xuICAgICAgICBvYnNlcnZlci5kaXNwb3NlKCk7XG4gICAgICAgICFzdWJqZWN0LmlzRGlzcG9zZWQgJiYgc3ViamVjdC5vYnNlcnZlcnMuc3BsaWNlKHN1YmplY3Qub2JzZXJ2ZXJzLmluZGV4T2Yob2JzZXJ2ZXIpLCAxKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGluaGVyaXRzKFJlcGxheVN1YmplY3QsIF9fc3VwZXJfXyk7XG5cbiAgICAvKipcbiAgICAgKiAgSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIFJlcGxheVN1YmplY3QgY2xhc3Mgd2l0aCB0aGUgc3BlY2lmaWVkIGJ1ZmZlciBzaXplLCB3aW5kb3cgc2l6ZSBhbmQgc2NoZWR1bGVyLlxuICAgICAqICBAcGFyYW0ge051bWJlcn0gW2J1ZmZlclNpemVdIE1heGltdW0gZWxlbWVudCBjb3VudCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICAgKiAgQHBhcmFtIHtOdW1iZXJ9IFt3aW5kb3dTaXplXSBNYXhpbXVtIHRpbWUgbGVuZ3RoIG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuICAgICAqICBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRoZSBvYnNlcnZlcnMgYXJlIGludm9rZWQgb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gUmVwbGF5U3ViamVjdChidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuYnVmZmVyU2l6ZSA9IGJ1ZmZlclNpemUgPT0gbnVsbCA/IG1heFNhZmVJbnRlZ2VyIDogYnVmZmVyU2l6ZTtcbiAgICAgIHRoaXMud2luZG93U2l6ZSA9IHdpbmRvd1NpemUgPT0gbnVsbCA/IG1heFNhZmVJbnRlZ2VyIDogd2luZG93U2l6ZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyIHx8IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXI7XG4gICAgICB0aGlzLnEgPSBbXTtcbiAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICB0aGlzLmhhc0Vycm9yID0gZmFsc2U7XG4gICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGFkZFByb3BlcnRpZXMoUmVwbGF5U3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgdmFyIHNvID0gbmV3IFNjaGVkdWxlZE9ic2VydmVyKHRoaXMuc2NoZWR1bGVyLCBvKSwgc3Vic2NyaXB0aW9uID0gY3JlYXRlUmVtb3ZhYmxlRGlzcG9zYWJsZSh0aGlzLCBzbyk7XG5cbiAgICAgICAgdGhpcy5fdHJpbSh0aGlzLnNjaGVkdWxlci5ub3coKSk7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2goc28pO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLnEubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBzby5vbk5leHQodGhpcy5xW2ldLnZhbHVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG4gICAgICAgICAgc28ub25FcnJvcih0aGlzLmVycm9yKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHNvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICBzby5lbnN1cmVBY3RpdmUoKTtcbiAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cbiAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKi9cbiAgICAgIGhhc09ic2VydmVyczogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vYnNlcnZlcnMubGVuZ3RoID4gMDtcbiAgICAgIH0sXG4gICAgICBfdHJpbTogZnVuY3Rpb24gKG5vdykge1xuICAgICAgICB3aGlsZSAodGhpcy5xLmxlbmd0aCA+IHRoaXMuYnVmZmVyU2l6ZSkge1xuICAgICAgICAgIHRoaXMucS5zaGlmdCgpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0aGlzLnEubGVuZ3RoID4gMCAmJiAobm93IC0gdGhpcy5xWzBdLmludGVydmFsKSA+IHRoaXMud2luZG93U2l6ZSkge1xuICAgICAgICAgIHRoaXMucS5zaGlmdCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGFycml2YWwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdmFyIG5vdyA9IHRoaXMuc2NoZWR1bGVyLm5vdygpO1xuICAgICAgICB0aGlzLnEucHVzaCh7IGludGVydmFsOiBub3csIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgdGhpcy5fdHJpbShub3cpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIHZhciBvYnNlcnZlciA9IG9zW2ldO1xuICAgICAgICAgIG9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgb2JzZXJ2ZXIuZW5zdXJlQWN0aXZlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXhjZXB0aW9uLlxuICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIGV4Y2VwdGlvbiB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgdmFyIG5vdyA9IHRoaXMuc2NoZWR1bGVyLm5vdygpO1xuICAgICAgICB0aGlzLl90cmltKG5vdyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIHZhciBvYnNlcnZlciA9IG9zW2ldO1xuICAgICAgICAgIG9ic2VydmVyLm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgIG9ic2VydmVyLmVuc3VyZUFjdGl2ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UuXG4gICAgICAgKi9cbiAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB2YXIgbm93ID0gdGhpcy5zY2hlZHVsZXIubm93KCk7XG4gICAgICAgIHRoaXMuX3RyaW0obm93KTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgdmFyIG9ic2VydmVyID0gb3NbaV07XG4gICAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICBvYnNlcnZlci5lbnN1cmVBY3RpdmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogVW5zdWJzY3JpYmUgYWxsIG9ic2VydmVycyBhbmQgcmVsZWFzZSByZXNvdXJjZXMuXG4gICAgICAgKi9cbiAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIFJlcGxheVN1YmplY3Q7XG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIC8qKlxuICAqIFVzZWQgdG8gcGF1c2UgYW5kIHJlc3VtZSBzdHJlYW1zLlxuICAqL1xuICBSeC5QYXVzZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFBhdXNlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBQYXVzZXIoKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQYXVzZXMgdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG4gICAgICovXG4gICAgUGF1c2VyLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5vbk5leHQoZmFsc2UpOyB9O1xuXG4gICAgLyoqXG4gICAgKiBSZXN1bWVzIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgICovXG4gICAgUGF1c2VyLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7IHRoaXMub25OZXh0KHRydWUpOyB9O1xuXG4gICAgcmV0dXJuIFBhdXNlcjtcbiAgfShTdWJqZWN0KSk7XG5cbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgZGVmaW5lLmFtZCA9PSAnb2JqZWN0JyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgcm9vdC5SeCA9IFJ4O1xuXG4gICAgZGVmaW5lKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIFJ4O1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKGZyZWVFeHBvcnRzICYmIGZyZWVNb2R1bGUpIHtcbiAgICAvLyBpbiBOb2RlLmpzIG9yIFJpbmdvSlNcbiAgICBpZiAobW9kdWxlRXhwb3J0cykge1xuICAgICAgKGZyZWVNb2R1bGUuZXhwb3J0cyA9IFJ4KS5SeCA9IFJ4O1xuICAgIH0gZWxzZSB7XG4gICAgICBmcmVlRXhwb3J0cy5SeCA9IFJ4O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBpbiBhIGJyb3dzZXIgb3IgUmhpbm9cbiAgICByb290LlJ4ID0gUng7XG4gIH1cblxuICAvLyBBbGwgY29kZSBiZWZvcmUgdGhpcyBwb2ludCB3aWxsIGJlIGZpbHRlcmVkIGZyb20gc3RhY2sgdHJhY2VzLlxuICB2YXIgckVuZGluZ0xpbmUgPSBjYXB0dXJlTGluZSgpO1xuXG59LmNhbGwodGhpcykpO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vY2xpbWItc29jaWFsL34vcngtbGl0ZS9yeC5saXRlLmpzXG4gKiogbW9kdWxlIGlkID0gMTZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCIuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1wiKSgpO1xuLy8gaW1wb3J0c1xuXG5cbi8vIG1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiLmNsaW1iX193YWxse3dpZHRoOjEwMCU7cGFkZGluZzowO21hcmdpbjowOy13ZWJraXQtanVzdGlmeS1jb250ZW50OmNlbnRlcjstbXMtZmxleC1wYWNrOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOy13ZWJraXQtZmxleC1kaXJlY3Rpb246cm93Oy1tcy1mbGV4LWRpcmVjdGlvbjpyb3c7ZmxleC1kaXJlY3Rpb246cm93Oy13ZWJraXQtZmxleC13cmFwOndyYXA7LW1zLWZsZXgtd3JhcDp3cmFwO2ZsZXgtd3JhcDp3cmFwO2ZvbnQtc2l6ZToxMDAlfS5jbGltYl9fdGlsZSwuY2xpbWJfX3dhbGx7ZGlzcGxheTotd2Via2l0LWZsZXg7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXh9LmNsaW1iX190aWxley13ZWJraXQtZmxleC1zaHJpbms6MDstbXMtZmxleC1uZWdhdGl2ZTowO2ZsZXgtc2hyaW5rOjA7aGVpZ2h0OjQyNXB4O2JveC1zaXppbmc6Ym9yZGVyLWJveDstd2Via2l0LWp1c3RpZnktY29udGVudDpmbGV4LWVuZDstbXMtZmxleC1wYWNrOmVuZDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQ7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpjb2x1bW47LW1zLWZsZXgtZGlyZWN0aW9uOmNvbHVtbjtmbGV4LWRpcmVjdGlvbjpjb2x1bW47bWFyZ2luLWJvdHRvbToyMHB4O292ZXJmbG93OmhpZGRlbjt0ZXh0LWFsaWduOmxlZnQ7Ym9yZGVyLXJhZGl1czo3cHg7YmFja2dyb3VuZC1jb2xvcjojZjZmNmY2Oy13ZWJraXQtYmFja2ZhY2UtdmlzaWJpbGl0eTpoaWRkZW47YmFja2ZhY2UtdmlzaWJpbGl0eTpoaWRkZW47LXdlYmtpdC1wZXJzcGVjdGl2ZToxMDAwcHg7cGVyc3BlY3RpdmU6MTAwMHB4fS5jbGltYl9fdGlsZV9fY29udGVudHt6LWluZGV4OjE7cGFkZGluZzoyNnB4O2JhY2tncm91bmQtY29sb3I6I2Y2ZjZmNn0uY2xpbWJfX3RpbGUtLWhhcy1uby1pbWFnZSAuY2xpbWJfX3RpbGVfX2NvbnRlbnR7aGVpZ2h0OjEwMCU7ZGlzcGxheTotd2Via2l0LWZsZXg7ZGlzcGxheTotbXMtZmxleGJveDtkaXNwbGF5OmZsZXg7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpjb2x1bW47LW1zLWZsZXgtZGlyZWN0aW9uOmNvbHVtbjtmbGV4LWRpcmVjdGlvbjpjb2x1bW47LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjstbXMtZmxleC1wYWNrOmp1c3RpZnk7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47Ym94LXNpemluZzpib3JkZXItYm94fS5jbGltYl9faW1hZ2V7ZGlzcGxheTpibG9jazttYXgtd2lkdGg6MTAwJX0uY2xpbWJfX3RpbGUgLmNsaW1iX19pbWFnZXtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjdweDtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czo3cHh9LmNsaW1iX190aWxlX19tZXNzYWdle3otaW5kZXg6MTttYXJnaW4tYm90dG9tOjI0cHh9LmNsaW1iX190aWxlX19tZXNzYWdlPmF7d2hpdGUtc3BhY2U6bm93cmFwO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzO21heC13aWR0aDoyNjBweDtkaXNwbGF5OmlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjpib3R0b219LmNsaW1iX190aWxlLS1oYXMtbm8taW1hZ2UgLmNsaW1iX190aWxlX19tZXNzYWdle2ZvbnQtc2l6ZToxODUlfS5jbGltYl9fdGlsZV9fYXV0aG9ye2Rpc3BsYXk6YmxvY2s7bWFyZ2luOi0xMHB4fS5jbGltYl9fdGlsZV9fYXV0aG9yIGltZ3tib3JkZXItcmFkaXVzOjI1cHg7d2lkdGg6MzRweH0uY2xpbWJfX3RpbGVfX2F1dGhvciAuY2xpbWJfX3RpbGVfX2F1dGhvcl9fdXNlcm5hbWV7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luOjAgMCAwIDEwcHg7bGluZS1oZWlnaHQ6MzRweDt2ZXJ0aWNhbC1hbGlnbjp0b3B9LmNsaW1iLXNvY2lhbC1iYWRnZXtwb3NpdGlvbjpmaXhlZDtib3R0b206MjBweDtyaWdodDoyMHB4O3otaW5kZXg6OTtiYWNrZ3JvdW5kLWNvbG9yOiNhOWNhZTI7d2lkdGg6MjAwcHg7aGVpZ2h0OjY2cHg7Ym9yZGVyLXJhZGl1czo1cHh9LmNsaW1iLXNvY2lhbC1iYWRnZT5zcGFue3Bvc2l0aW9uOmFic29sdXRlIWltcG9ydGFudDt0b3A6LTk5OTlweCFpbXBvcnRhbnQ7bGVmdDotOTk5OXB4IWltcG9ydGFudH0uY2xpbWItc2xpZGVzaG93e2hlaWdodDoxMDB2aDtkaXNwbGF5Oi13ZWJraXQtZmxleDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstd2Via2l0LWZsZXgtZGlyZWN0aW9uOnJvdzstbXMtZmxleC1kaXJlY3Rpb246cm93O2ZsZXgtZGlyZWN0aW9uOnJvdzstd2Via2l0LWFsaWduLWl0ZW1zOmNlbnRlcjstbXMtZmxleC1hbGlnbjpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyOy13ZWJraXQtanVzdGlmeS1jb250ZW50OmNlbnRlcjstbXMtZmxleC1wYWNrOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5jbGltYi1zbGlkZXNob3dfX3NsaWRle2Rpc3BsYXk6YmxvY2s7d2lkdGg6NzAlO21hcmdpbjowIGF1dG87YmFja2dyb3VuZC1jb2xvcjojZjZmNmY2fVwiLCBcIlwiXSk7XG5cbi8vIGV4cG9ydHNcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2Nzcy1sb2FkZXIhLi9+L2F1dG9wcmVmaXhlci1sb2FkZXI/YnJvd3NlcnM9bGFzdCAyIHZlcnNpb24hLi9+L3Nhc3MtbG9hZGVyIS4vc3JjL3N0eWxlL21haW4uc2Nzc1xuICoqIG1vZHVsZSBpZCA9IDE3XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvKlxyXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcblx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxyXG4qL1xyXG4vLyBjc3MgYmFzZSBjb2RlLCBpbmplY3RlZCBieSB0aGUgY3NzLWxvYWRlclxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xyXG5cdHZhciBsaXN0ID0gW107XHJcblxyXG5cdC8vIHJldHVybiB0aGUgbGlzdCBvZiBtb2R1bGVzIGFzIGNzcyBzdHJpbmdcclxuXHRsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XHJcblx0XHR2YXIgcmVzdWx0ID0gW107XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaXRlbSA9IHRoaXNbaV07XHJcblx0XHRcdGlmKGl0ZW1bMl0pIHtcclxuXHRcdFx0XHRyZXN1bHQucHVzaChcIkBtZWRpYSBcIiArIGl0ZW1bMl0gKyBcIntcIiArIGl0ZW1bMV0gKyBcIn1cIik7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cmVzdWx0LnB1c2goaXRlbVsxXSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiByZXN1bHQuam9pbihcIlwiKTtcclxuXHR9O1xyXG5cclxuXHQvLyBpbXBvcnQgYSBsaXN0IG9mIG1vZHVsZXMgaW50byB0aGUgbGlzdFxyXG5cdGxpc3QuaSA9IGZ1bmN0aW9uKG1vZHVsZXMsIG1lZGlhUXVlcnkpIHtcclxuXHRcdGlmKHR5cGVvZiBtb2R1bGVzID09PSBcInN0cmluZ1wiKVxyXG5cdFx0XHRtb2R1bGVzID0gW1tudWxsLCBtb2R1bGVzLCBcIlwiXV07XHJcblx0XHR2YXIgYWxyZWFkeUltcG9ydGVkTW9kdWxlcyA9IHt9O1xyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGlkID0gdGhpc1tpXVswXTtcclxuXHRcdFx0aWYodHlwZW9mIGlkID09PSBcIm51bWJlclwiKVxyXG5cdFx0XHRcdGFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaWRdID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGZvcihpID0gMDsgaSA8IG1vZHVsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGl0ZW0gPSBtb2R1bGVzW2ldO1xyXG5cdFx0XHQvLyBza2lwIGFscmVhZHkgaW1wb3J0ZWQgbW9kdWxlXHJcblx0XHRcdC8vIHRoaXMgaW1wbGVtZW50YXRpb24gaXMgbm90IDEwMCUgcGVyZmVjdCBmb3Igd2VpcmQgbWVkaWEgcXVlcnkgY29tYmluYXRpb25zXHJcblx0XHRcdC8vICB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXHJcblx0XHRcdC8vICBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpXHJcblx0XHRcdGlmKHR5cGVvZiBpdGVtWzBdICE9PSBcIm51bWJlclwiIHx8ICFhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7XHJcblx0XHRcdFx0aWYobWVkaWFRdWVyeSAmJiAhaXRlbVsyXSkge1xyXG5cdFx0XHRcdFx0aXRlbVsyXSA9IG1lZGlhUXVlcnk7XHJcblx0XHRcdFx0fSBlbHNlIGlmKG1lZGlhUXVlcnkpIHtcclxuXHRcdFx0XHRcdGl0ZW1bMl0gPSBcIihcIiArIGl0ZW1bMl0gKyBcIikgYW5kIChcIiArIG1lZGlhUXVlcnkgKyBcIilcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0bGlzdC5wdXNoKGl0ZW0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fTtcclxuXHRyZXR1cm4gbGlzdDtcclxufTtcclxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcbiAqKiBtb2R1bGUgaWQgPSAxOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIGRlZmluZShbJ2V4cG9ydHMnLCAnbW9kdWxlJ10sIGZhY3RvcnkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICAgIGZhY3RvcnkoZXhwb3J0cywgbW9kdWxlKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgbW9kID0ge1xuICAgICAgZXhwb3J0czoge31cbiAgICB9O1xuICAgIGZhY3RvcnkobW9kLmV4cG9ydHMsIG1vZCk7XG4gICAgZ2xvYmFsLmZldGNoSnNvbnAgPSBtb2QuZXhwb3J0cztcbiAgfVxufSkodGhpcywgZnVuY3Rpb24gKGV4cG9ydHMsIG1vZHVsZSkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgIHRpbWVvdXQ6IDUwMDAsXG4gICAganNvbnBDYWxsYmFjazogJ2NhbGxiYWNrJ1xuICB9O1xuXG4gIGZ1bmN0aW9uIGdlbmVyYXRlQ2FsbGJhY2tGdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJ2pzb25wXycgKyBEYXRlLm5vdygpICsgJ18nICsgTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkgKiAxMDAwMDApO1xuICB9XG5cbiAgLy8gS25vd24gaXNzdWU6IFdpbGwgdGhyb3cgJ1VuY2F1Z2h0IFJlZmVyZW5jZUVycm9yOiBjYWxsYmFja18qKiogaXMgbm90IGRlZmluZWQnIGVycm9yIGlmIHJlcXVlc3QgdGltZW91dFxuICBmdW5jdGlvbiBjbGVhckZ1bmN0aW9uKGZ1bmN0aW9uTmFtZSkge1xuICAgIC8vIElFOCB0aHJvd3MgYW4gZXhjZXB0aW9uIHdoZW4geW91IHRyeSB0byBkZWxldGUgYSBwcm9wZXJ0eSBvbiB3aW5kb3dcbiAgICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xODI0MjI4Lzc1MTA4OVxuICAgIHRyeSB7XG4gICAgICBkZWxldGUgd2luZG93W2Z1bmN0aW9uTmFtZV07XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgd2luZG93W2Z1bmN0aW9uTmFtZV0gPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcmVtb3ZlU2NyaXB0KHNjcmlwdElkKSB7XG4gICAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHNjcmlwdElkKTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0ucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcbiAgfVxuXG4gIHZhciBmZXRjaEpzb25wID0gZnVuY3Rpb24gZmV0Y2hKc29ucCh1cmwpIHtcbiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IHt9IDogYXJndW1lbnRzWzFdO1xuXG4gICAgdmFyIHRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQgIT0gbnVsbCA/IG9wdGlvbnMudGltZW91dCA6IGRlZmF1bHRPcHRpb25zLnRpbWVvdXQ7XG4gICAgdmFyIGpzb25wQ2FsbGJhY2sgPSBvcHRpb25zLmpzb25wQ2FsbGJhY2sgIT0gbnVsbCA/IG9wdGlvbnMuanNvbnBDYWxsYmFjayA6IGRlZmF1bHRPcHRpb25zLmpzb25wQ2FsbGJhY2s7XG5cbiAgICB2YXIgdGltZW91dElkID0gdW5kZWZpbmVkO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBjYWxsYmFja0Z1bmN0aW9uID0gZ2VuZXJhdGVDYWxsYmFja0Z1bmN0aW9uKCk7XG5cbiAgICAgIHdpbmRvd1tjYWxsYmFja0Z1bmN0aW9uXSA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICBvazogdHJ1ZSxcbiAgICAgICAgICAvLyBrZWVwIGNvbnNpc3RlbnQgd2l0aCBmZXRjaCBBUElcbiAgICAgICAgICBqc29uOiBmdW5jdGlvbiBqc29uKCkge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAodGltZW91dElkKSBjbGVhclRpbWVvdXQodGltZW91dElkKTtcblxuICAgICAgICByZW1vdmVTY3JpcHQoanNvbnBDYWxsYmFjayArICdfJyArIGNhbGxiYWNrRnVuY3Rpb24pO1xuXG4gICAgICAgIGNsZWFyRnVuY3Rpb24oY2FsbGJhY2tGdW5jdGlvbik7XG4gICAgICB9O1xuXG4gICAgICAvLyBDaGVjayBpZiB0aGUgdXNlciBzZXQgdGhlaXIgb3duIHBhcmFtcywgYW5kIGlmIG5vdCBhZGQgYSA/IHRvIHN0YXJ0IGEgbGlzdCBvZiBwYXJhbXNcbiAgICAgIHVybCArPSB1cmwuaW5kZXhPZignPycpID09PSAtMSA/ICc/JyA6ICcmJztcblxuICAgICAgdmFyIGpzb25wU2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG4gICAgICBqc29ucFNjcmlwdC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdXJsICsganNvbnBDYWxsYmFjayArICc9JyArIGNhbGxiYWNrRnVuY3Rpb24pO1xuICAgICAganNvbnBTY3JpcHQuaWQgPSBqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbjtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5hcHBlbmRDaGlsZChqc29ucFNjcmlwdCk7XG5cbiAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICByZWplY3QobmV3IEVycm9yKCdKU09OUCByZXF1ZXN0IHRvICcgKyB1cmwgKyAnIHRpbWVkIG91dCcpKTtcblxuICAgICAgICBjbGVhckZ1bmN0aW9uKGNhbGxiYWNrRnVuY3Rpb24pO1xuICAgICAgICByZW1vdmVTY3JpcHQoanNvbnBDYWxsYmFjayArICdfJyArIGNhbGxiYWNrRnVuY3Rpb24pO1xuICAgICAgfSwgdGltZW91dCk7XG4gICAgfSk7XG4gIH07XG5cbiAgLy8gZXhwb3J0IGFzIGdsb2JhbCBmdW5jdGlvblxuICAvKlxuICBsZXQgbG9jYWw7XG4gIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvY2FsID0gZ2xvYmFsO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvY2FsID0gc2VsZjtcbiAgfSBlbHNlIHtcbiAgICB0cnkge1xuICAgICAgbG9jYWwgPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigncG9seWZpbGwgZmFpbGVkIGJlY2F1c2UgZ2xvYmFsIG9iamVjdCBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Jyk7XG4gICAgfVxuICB9XG4gIFxuICBsb2NhbC5mZXRjaEpzb25wID0gZmV0Y2hKc29ucDtcbiAgKi9cblxuICBtb2R1bGUuZXhwb3J0cyA9IGZldGNoSnNvbnA7XG59KTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9mZXRjaC1qc29ucC9idWlsZC9mZXRjaC1qc29ucC5qc1xuICoqIG1vZHVsZSBpZCA9IDE5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzWydkZWZhdWx0J10gPSBjb25maWdBbmltYXRpb247XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblxudmFyIF9wZXJmb3JtYW5jZU5vdyA9IHJlcXVpcmUoJ3BlcmZvcm1hbmNlLW5vdycpO1xuXG52YXIgX3BlcmZvcm1hbmNlTm93MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BlcmZvcm1hbmNlTm93KTtcblxudmFyIF9yYWYgPSByZXF1aXJlKCdyYWYnKTtcblxudmFyIF9yYWYyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmFmKTtcblxuZnVuY3Rpb24gY29uZmlnQW5pbWF0aW9uKCkge1xuICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMF07XG4gIHZhciBfY29uZmlnJHRpbWVTdGVwID0gY29uZmlnLnRpbWVTdGVwO1xuICB2YXIgdGltZVN0ZXAgPSBfY29uZmlnJHRpbWVTdGVwID09PSB1bmRlZmluZWQgPyAxIC8gNjAgKiAxMDAwIDogX2NvbmZpZyR0aW1lU3RlcDtcbiAgdmFyIF9jb25maWckdGltZVNjYWxlID0gY29uZmlnLnRpbWVTY2FsZTtcbiAgdmFyIHRpbWVTY2FsZSA9IF9jb25maWckdGltZVNjYWxlID09PSB1bmRlZmluZWQgPyAxIDogX2NvbmZpZyR0aW1lU2NhbGU7XG4gIHZhciBfY29uZmlnJG1heFN0ZXBzID0gY29uZmlnLm1heFN0ZXBzO1xuICB2YXIgbWF4U3RlcHMgPSBfY29uZmlnJG1heFN0ZXBzID09PSB1bmRlZmluZWQgPyAxMCA6IF9jb25maWckbWF4U3RlcHM7XG4gIHZhciBfY29uZmlnJHJhZiA9IGNvbmZpZy5yYWY7XG4gIHZhciByYWYgPSBfY29uZmlnJHJhZiA9PT0gdW5kZWZpbmVkID8gX3JhZjJbJ2RlZmF1bHQnXSA6IF9jb25maWckcmFmO1xuICB2YXIgX2NvbmZpZyRub3cgPSBjb25maWcubm93O1xuICB2YXIgbm93ID0gX2NvbmZpZyRub3cgPT09IHVuZGVmaW5lZCA/IF9wZXJmb3JtYW5jZU5vdzJbJ2RlZmF1bHQnXSA6IF9jb25maWckbm93O1xuXG4gIHZhciBhbmltUnVubmluZyA9IFtdO1xuICB2YXIgcnVubmluZyA9IGZhbHNlO1xuICB2YXIgcHJldlRpbWUgPSAwO1xuICB2YXIgYWNjdW11bGF0ZWRUaW1lID0gMDtcblxuICBmdW5jdGlvbiBsb29wKCkge1xuICAgIHZhciBjdXJyZW50VGltZSA9IG5vdygpO1xuICAgIHZhciBmcmFtZVRpbWUgPSBjdXJyZW50VGltZSAtIHByZXZUaW1lOyAvLyBkZWx0YVxuXG4gICAgcHJldlRpbWUgPSBjdXJyZW50VGltZTtcbiAgICBhY2N1bXVsYXRlZFRpbWUgKz0gZnJhbWVUaW1lICogdGltZVNjYWxlO1xuXG4gICAgaWYgKGFjY3VtdWxhdGVkVGltZSA+IHRpbWVTdGVwICogbWF4U3RlcHMpIHtcbiAgICAgIGFjY3VtdWxhdGVkVGltZSA9IDA7XG4gICAgfVxuXG4gICAgdmFyIGZyYW1lTnVtYmVyID0gTWF0aC5jZWlsKGFjY3VtdWxhdGVkVGltZSAvIHRpbWVTdGVwKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1SdW5uaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgX2FuaW1SdW5uaW5nJGkgPSBhbmltUnVubmluZ1tpXTtcbiAgICAgIHZhciBhY3RpdmUgPSBfYW5pbVJ1bm5pbmckaS5hY3RpdmU7XG4gICAgICB2YXIgYW5pbWF0aW9uU3RlcCA9IF9hbmltUnVubmluZyRpLmFuaW1hdGlvblN0ZXA7XG4gICAgICB2YXIgcHJldlByZXZTdGF0ZSA9IF9hbmltUnVubmluZyRpLnByZXZTdGF0ZTtcbiAgICAgIHZhciBwcmV2TmV4dFN0YXRlID0gYW5pbVJ1bm5pbmdbaV0ubmV4dFN0YXRlO1xuXG4gICAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gU2VlbXMgbGlrZSBiZWNhdXNlIHRoZSBUUyBzZXRzIGRlc3RWYWxzIGFzIGVudGVyVmFscyBmb3IgdGhlIGZpcnN0XG4gICAgICAvLyB0aWNrLCB3ZSBtaWdodCByZW5kZXIgdGhhdCB2YWx1ZSB0d2ljZS4gV2UgcmVuZGVyIGl0IG9uY2UsIGN1cnJWYWx1ZSBpc1xuICAgICAgLy8gZW50ZXJWYWwgYW5kIGRlc3RWYWwgaXMgZW50ZXJWYWwuIFRoZSBuZXh0IHRpY2sgaXMgZmFzdGVyIHRoYW4gMTZtcyxcbiAgICAgIC8vIHNvIGFjY3VtdWxhdGVkVGltZSAod2hpY2ggd291bGQgYmUgYWJvdXQgLTE2bXMgZnJvbSB0aGUgcHJldmlvdXMgdGljaylcbiAgICAgIC8vIGlzIG5lZ2F0aXZlICgtMTZtcyArIGFueSBudW1iZXIgbGVzcyB0aGFuIDE2bXMgPCAwKS4gU28gd2UganVzdCByZW5kZXJcbiAgICAgIC8vIHBhcnQgd2F5cyB0b3dhcmRzIHRoZSBuZXh0U3RhdGUsIGJ1dCB0aGF0J3MgZW50ZXJWYWwgc3RpbGwuIFdlIHJlbmRlclxuICAgICAgLy8gc2F5IDc1JSBiZXR3ZWVuIGN1cnJWYWx1ZSAoPT09IGVudGVyVmFsKSBhbmQgZGVzdFZhbHVlICg9PT0gZW50ZXJWYWwpLlxuICAgICAgLy8gU28gd2UgcmVuZGVyIHRoZSBzYW1lIHZhbHVlIGEgc2Vjb25kIHRpbWUuXG4gICAgICAvLyBUaGUgc29sdXRpb24gYmVsb3cgaXMgdG8gcmVjYWxjdWxhdGUgdGhlIGRlc3RpbmF0aW9uIHN0YXRlIGV2ZW4gd2hlblxuICAgICAgLy8geW91J3JlIG1vdmluZyBwYXJ0aWFsbHkgdG93YXJkcyBpdC5cbiAgICAgIGlmIChhY2N1bXVsYXRlZFRpbWUgPD0gMCkge1xuICAgICAgICBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGUgPSBhbmltYXRpb25TdGVwKHRpbWVTdGVwIC8gMTAwMCwgcHJldlByZXZTdGF0ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZyYW1lTnVtYmVyOyBqKyspIHtcbiAgICAgICAgICBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGUgPSBhbmltYXRpb25TdGVwKHRpbWVTdGVwIC8gMTAwMCwgcHJldk5leHRTdGF0ZSk7XG4gICAgICAgICAgdmFyIF9yZWYgPSBbcHJldk5leHRTdGF0ZSwgYW5pbVJ1bm5pbmdbaV0ubmV4dFN0YXRlXTtcbiAgICAgICAgICBhbmltUnVubmluZ1tpXS5wcmV2U3RhdGUgPSBfcmVmWzBdO1xuICAgICAgICAgIHByZXZOZXh0U3RhdGUgPSBfcmVmWzFdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgYWNjdW11bGF0ZWRUaW1lID0gYWNjdW11bGF0ZWRUaW1lIC0gZnJhbWVOdW1iZXIgKiB0aW1lU3RlcDtcblxuICAgIC8vIFJlbmRlciBhbmQgZmlsdGVyIGluIG9uZSBpdGVyYXRpb24uXG4gICAgdmFyIGFscGhhID0gMSArIGFjY3VtdWxhdGVkVGltZSAvIHRpbWVTdGVwO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbVJ1bm5pbmcubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBfYW5pbVJ1bm5pbmckaTIgPSBhbmltUnVubmluZ1tpXTtcbiAgICAgIHZhciBhbmltYXRpb25SZW5kZXIgPSBfYW5pbVJ1bm5pbmckaTIuYW5pbWF0aW9uUmVuZGVyO1xuICAgICAgdmFyIG5leHRTdGF0ZSA9IF9hbmltUnVubmluZyRpMi5uZXh0U3RhdGU7XG4gICAgICB2YXIgcHJldlN0YXRlID0gX2FuaW1SdW5uaW5nJGkyLnByZXZTdGF0ZTtcblxuICAgICAgLy8gTWlnaHQgbXV0YXRlIGFuaW1SdW5uaW5nLi4uLi4uLi5cbiAgICAgIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpO1xuICAgIH1cblxuICAgIGFuaW1SdW5uaW5nID0gYW5pbVJ1bm5pbmcuZmlsdGVyKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgdmFyIGFjdGl2ZSA9IF9yZWYyLmFjdGl2ZTtcbiAgICAgIHJldHVybiBhY3RpdmU7XG4gICAgfSk7XG5cbiAgICBpZiAoYW5pbVJ1bm5pbmcubGVuZ3RoID09PSAwKSB7XG4gICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJhZihsb29wKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICBpZiAoIXJ1bm5pbmcpIHtcbiAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgcHJldlRpbWUgPSBub3coKTtcbiAgICAgIGFjY3VtdWxhdGVkVGltZSA9IDA7XG4gICAgICByYWYobG9vcCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW9uKHN0YXRlLCBhbmltYXRpb25TdGVwLCBhbmltYXRpb25SZW5kZXIpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1SdW5uaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgdmFsID0gYW5pbVJ1bm5pbmdbaV07XG4gICAgICBpZiAodmFsLmFuaW1hdGlvblN0ZXAgPT09IGFuaW1hdGlvblN0ZXApIHtcbiAgICAgICAgdmFsLmFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHZhbC5wcmV2U3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgc3RhcnQoKTtcbiAgICAgICAgcmV0dXJuIHZhbC5zdG9wO1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBuZXdBbmltID0ge1xuICAgICAgYW5pbWF0aW9uU3RlcDogYW5pbWF0aW9uU3RlcCxcbiAgICAgIGFuaW1hdGlvblJlbmRlcjogYW5pbWF0aW9uUmVuZGVyLFxuICAgICAgcHJldlN0YXRlOiBzdGF0ZSxcbiAgICAgIG5leHRTdGF0ZTogc3RhdGUsXG4gICAgICBhY3RpdmU6IHRydWVcbiAgICB9O1xuXG4gICAgbmV3QW5pbS5zdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIG5ld0FuaW0uYWN0aXZlID0gZmFsc2U7XG4gICAgfTtcbiAgICBhbmltUnVubmluZy5wdXNoKG5ld0FuaW0pO1xuXG4gICAgc3RhcnQoKTtcblxuICAgIHJldHVybiBuZXdBbmltLnN0b3A7XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvYW5pbWF0aW9uTG9vcC5qc1xuICoqIG1vZHVsZSBpZCA9IDIwXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cbnZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cbmV4cG9ydHNbJ2RlZmF1bHQnXSA9IGNvbXBvbmVudHM7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblxudmFyIF9ub1ZlbG9jaXR5ID0gcmVxdWlyZSgnLi9ub1ZlbG9jaXR5Jyk7XG5cbnZhciBfbm9WZWxvY2l0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ub1ZlbG9jaXR5KTtcblxudmFyIF9oYXNSZWFjaGVkU3R5bGUgPSByZXF1aXJlKCcuL2hhc1JlYWNoZWRTdHlsZScpO1xuXG52YXIgX2hhc1JlYWNoZWRTdHlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNSZWFjaGVkU3R5bGUpO1xuXG52YXIgX21lcmdlRGlmZiA9IHJlcXVpcmUoJy4vbWVyZ2VEaWZmJyk7XG5cbnZhciBfbWVyZ2VEaWZmMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lcmdlRGlmZik7XG5cbnZhciBfYW5pbWF0aW9uTG9vcCA9IHJlcXVpcmUoJy4vYW5pbWF0aW9uTG9vcCcpO1xuXG52YXIgX2FuaW1hdGlvbkxvb3AyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYW5pbWF0aW9uTG9vcCk7XG5cbnZhciBfemVybyA9IHJlcXVpcmUoJy4vemVybycpO1xuXG52YXIgX3plcm8yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfemVybyk7XG5cbnZhciBfdXBkYXRlVHJlZSA9IHJlcXVpcmUoJy4vdXBkYXRlVHJlZScpO1xuXG52YXIgX2RlcHJlY2F0ZWRTcHJpbmdzMiA9IHJlcXVpcmUoJy4vZGVwcmVjYXRlZFNwcmluZ3MnKTtcblxudmFyIF9kZXByZWNhdGVkU3ByaW5nczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZXByZWNhdGVkU3ByaW5nczIpO1xuXG52YXIgX3N0cmlwU3R5bGUgPSByZXF1aXJlKCcuL3N0cmlwU3R5bGUnKTtcblxudmFyIF9zdHJpcFN0eWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0cmlwU3R5bGUpO1xuXG52YXIgc3RhcnRBbmltYXRpb24gPSBfYW5pbWF0aW9uTG9vcDJbJ2RlZmF1bHQnXSgpO1xuXG5mdW5jdGlvbiBtYXBPYmplY3QoZiwgb2JqKSB7XG4gIHZhciByZXQgPSB7fTtcbiAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgIGlmICghb2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICByZXRba2V5XSA9IGYob2JqW2tleV0sIGtleSk7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gZXZlcnlPYmooZiwgb2JqKSB7XG4gIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICBpZiAoIW9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKCFmKG9ialtrZXldLCBrZXkpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBjb21wb25lbnRzKFJlYWN0KSB7XG4gIHZhciBQcm9wVHlwZXMgPSBSZWFjdC5Qcm9wVHlwZXM7XG5cbiAgdmFyIE1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBkaXNwbGF5TmFtZTogJ01vdGlvbicsXG5cbiAgICBwcm9wVHlwZXM6IHtcbiAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGEgY29uZmlnIGluIGhlcmVcbiAgICAgIGRlZmF1bHRWYWx1ZTogZnVuY3Rpb24gZGVmYXVsdFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1NwcmluZ1xcJ3MgYGRlZmF1bHRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgZGVmYXVsdFN0eWxlYC4gJyArICdJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpIGNoYW5nZXMgYXMgd2VsbC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGVuZFZhbHVlOiBmdW5jdGlvbiBlbmRWYWx1ZShwcm9wLCBwcm9wTmFtZSkge1xuICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdTcHJpbmdcXCdzIGBlbmRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgc3R5bGVgLiBJdHMgZm9ybWF0ICcgKyAncmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgY2hhbmdlcyBhcyB3ZWxsLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVmYXVsdFN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgICAgc3R5bGU6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG4gICAgfSxcblxuICAgIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24gZ2V0SW5pdGlhbFN0YXRlKCkge1xuICAgICAgdmFyIF9wcm9wcyA9IHRoaXMucHJvcHM7XG4gICAgICB2YXIgZGVmYXVsdFN0eWxlID0gX3Byb3BzLmRlZmF1bHRTdHlsZTtcbiAgICAgIHZhciBzdHlsZSA9IF9wcm9wcy5zdHlsZTtcblxuICAgICAgdmFyIGN1cnJlbnRTdHlsZSA9IGRlZmF1bHRTdHlsZSB8fCBzdHlsZTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGN1cnJlbnRTdHlsZTogY3VycmVudFN0eWxlLFxuICAgICAgICBjdXJyZW50VmVsb2NpdHk6IG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgY3VycmVudFN0eWxlKVxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuICAgIH0sXG5cbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKCkge1xuICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuICAgIH0sXG5cbiAgICBhbmltYXRpb25TdGVwOiBmdW5jdGlvbiBhbmltYXRpb25TdGVwKHRpbWVzdGVwLCBzdGF0ZSkge1xuICAgICAgdmFyIGN1cnJlbnRTdHlsZSA9IHN0YXRlLmN1cnJlbnRTdHlsZTtcbiAgICAgIHZhciBjdXJyZW50VmVsb2NpdHkgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdHk7XG4gICAgICB2YXIgc3R5bGUgPSB0aGlzLnByb3BzLnN0eWxlO1xuXG4gICAgICB2YXIgbmV3Q3VycmVudFN0eWxlID0gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFN0eWxlKHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpO1xuICAgICAgdmFyIG5ld0N1cnJlbnRWZWxvY2l0eSA9IF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRWZWxvY2l0eSh0aW1lc3RlcCwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdHksIHN0eWxlKTtcblxuICAgICAgLy8gVE9PRDogdGhpcyBpc24ndCBuZWNlc3NhcnkgYW55bW9yZS4gSXQgd2FzIHVzZWQgb25seSBhZ2FpbnN0IGVuZFZhbHVlIGZ1bmNcbiAgICAgIGlmIChfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXShjdXJyZW50VmVsb2NpdHksIG5ld0N1cnJlbnRTdHlsZSkgJiYgX25vVmVsb2NpdHkyWydkZWZhdWx0J10obmV3Q3VycmVudFZlbG9jaXR5LCBuZXdDdXJyZW50U3R5bGUpKSB7XG4gICAgICAgIC8vIGNoZWNrIGV4cGxhbmF0aW9uIGluIGBNb3Rpb24uYW5pbWF0aW9uUmVuZGVyYFxuICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTsgLy8gTmFzdHkgc2lkZSBlZmZlY3RzLi4uLlxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjdXJyZW50U3R5bGU6IG5ld0N1cnJlbnRTdHlsZSxcbiAgICAgICAgY3VycmVudFZlbG9jaXR5OiBuZXdDdXJyZW50VmVsb2NpdHlcbiAgICAgIH07XG4gICAgfSxcblxuICAgIHN0b3BBbmltYXRpb246IG51bGwsXG5cbiAgICAvLyB1c2VkIGluIGFuaW1hdGlvblJlbmRlclxuICAgIGhhc1VubW91bnRlZDogZmFsc2UsXG5cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcbiAgICAgIHRoaXMuaGFzVW5tb3VudGVkID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc3RhcnRBbmltYXRpbmc6IGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW5nKCkge1xuICAgICAgLy8gSXMgc21hcnQgZW5vdWdoIHRvIG5vdCBzdGFydCBpdCB0d2ljZVxuICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uID0gc3RhcnRBbmltYXRpb24odGhpcy5zdGF0ZSwgdGhpcy5hbmltYXRpb25TdGVwLCB0aGlzLmFuaW1hdGlvblJlbmRlcik7XG4gICAgfSxcblxuICAgIGFuaW1hdGlvblJlbmRlcjogZnVuY3Rpb24gYW5pbWF0aW9uUmVuZGVyKGFscGhhLCBuZXh0U3RhdGUsIHByZXZTdGF0ZSkge1xuICAgICAgLy8gYHRoaXMuaGFzVW5tb3VudGVkYCBtaWdodCBiZSB0cnVlIGluIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uOlxuICAgICAgLy8gdXNlciBkb2VzIHNvbWUgY2hlY2tzIGluIGBzdHlsZWAgYW5kIGNhbGxzIGFuIG93bmVyIGhhbmRsZXJcbiAgICAgIC8vIG93bmVyIHNldHMgc3RhdGUgaW4gdGhlIGNhbGxiYWNrLCB0cmlnZ2VyaW5nIGEgcmUtcmVuZGVyXG4gICAgICAvLyB1bm1vdW50cyBNb3Rpb25cbiAgICAgIGlmICghdGhpcy5oYXNVbm1vdW50ZWQpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgY3VycmVudFN0eWxlOiBfdXBkYXRlVHJlZS5pbnRlcnBvbGF0ZVZhbHVlKGFscGhhLCBuZXh0U3RhdGUuY3VycmVudFN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlKSxcbiAgICAgICAgICBjdXJyZW50VmVsb2NpdHk6IG5leHRTdGF0ZS5jdXJyZW50VmVsb2NpdHlcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSBfc3RyaXBTdHlsZTJbJ2RlZmF1bHQnXSh0aGlzLnN0YXRlLmN1cnJlbnRTdHlsZSk7XG4gICAgICB2YXIgcmVuZGVyZWRDaGlsZHJlbiA9IHRoaXMucHJvcHMuY2hpbGRyZW4oc3RyaXBwZWRTdHlsZSk7XG4gICAgICByZXR1cm4gcmVuZGVyZWRDaGlsZHJlbiAmJiBSZWFjdC5DaGlsZHJlbi5vbmx5KHJlbmRlcmVkQ2hpbGRyZW4pO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIFN0YWdnZXJlZE1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBkaXNwbGF5TmFtZTogJ1N0YWdnZXJlZE1vdGlvbicsXG5cbiAgICBwcm9wVHlwZXM6IHtcbiAgICAgIGRlZmF1bHRTdHlsZTogZnVuY3Rpb24gZGVmYXVsdFN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgU3RhZ2dlcmVkTW90aW9uYFxcJ3MgYGRlZmF1bHRTdHlsZXNgLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc3R5bGU6IGZ1bmN0aW9uIHN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgU3RhZ2dlcmVkTW90aW9uYFxcJ3MgYHN0eWxlc2AuJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICAvLyBUT09EOiB3YXJuIGFnYWluc3QgcHV0dGluZyBjb25maWdzIGluIGhlcmVcbiAgICAgIGRlZmF1bHRTdHlsZXM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5vYmplY3QpLFxuICAgICAgc3R5bGVzOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgICAgY2hpbGRyZW46IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWRcbiAgICB9LFxuXG4gICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgICB2YXIgX3Byb3BzMiA9IHRoaXMucHJvcHM7XG4gICAgICB2YXIgc3R5bGVzID0gX3Byb3BzMi5zdHlsZXM7XG4gICAgICB2YXIgZGVmYXVsdFN0eWxlcyA9IF9wcm9wczIuZGVmYXVsdFN0eWxlcztcblxuICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBkZWZhdWx0U3R5bGVzID8gZGVmYXVsdFN0eWxlcyA6IHN0eWxlcygpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY3VycmVudFN0eWxlczogY3VycmVudFN0eWxlcyxcbiAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IGN1cnJlbnRTdHlsZXMubWFwKGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgcyk7XG4gICAgICAgIH0pXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGFuaW1hdGlvblN0ZXA6IGZ1bmN0aW9uIGFuaW1hdGlvblN0ZXAodGltZXN0ZXAsIHN0YXRlKSB7XG4gICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHN0YXRlLmN1cnJlbnRTdHlsZXM7XG4gICAgICB2YXIgY3VycmVudFZlbG9jaXRpZXMgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdGllcztcblxuICAgICAgdmFyIHN0eWxlcyA9IHRoaXMucHJvcHMuc3R5bGVzKGN1cnJlbnRTdHlsZXMubWFwKF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddKSk7XG5cbiAgICAgIHZhciBuZXdDdXJyZW50U3R5bGVzID0gY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKGN1cnJlbnRTdHlsZSwgaSkge1xuICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFN0eWxlKHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0aWVzW2ldLCBzdHlsZXNbaV0pO1xuICAgICAgfSk7XG4gICAgICB2YXIgbmV3Q3VycmVudFZlbG9jaXRpZXMgPSBjdXJyZW50U3R5bGVzLm1hcChmdW5jdGlvbiAoY3VycmVudFN0eWxlLCBpKSB7XG4gICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50VmVsb2NpdHkodGltZXN0ZXAsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXRpZXNbaV0sIHN0eWxlc1tpXSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVE9ETzogaXMgdGhpcyByaWdodD9cbiAgICAgIGlmIChjdXJyZW50VmVsb2NpdGllcy5ldmVyeShmdW5jdGlvbiAodiwgaykge1xuICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgY3VycmVudFN0eWxlc1trXSk7XG4gICAgICB9KSAmJiBuZXdDdXJyZW50VmVsb2NpdGllcy5ldmVyeShmdW5jdGlvbiAodiwgaykge1xuICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgbmV3Q3VycmVudFN0eWxlc1trXSk7XG4gICAgICB9KSkge1xuICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY3VycmVudFN0eWxlczogbmV3Q3VycmVudFN0eWxlcyxcbiAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5ld0N1cnJlbnRWZWxvY2l0aWVzXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBzdG9wQW5pbWF0aW9uOiBudWxsLFxuXG4gICAgLy8gdXNlZCBpbiBhbmltYXRpb25SZW5kZXJcbiAgICBoYXNVbm1vdW50ZWQ6IGZhbHNlLFxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG4gICAgICB0aGlzLmhhc1VubW91bnRlZCA9IHRydWU7XG4gICAgfSxcblxuICAgIHN0YXJ0QW5pbWF0aW5nOiBmdW5jdGlvbiBzdGFydEFuaW1hdGluZygpIHtcbiAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbiA9IHN0YXJ0QW5pbWF0aW9uKHRoaXMuc3RhdGUsIHRoaXMuYW5pbWF0aW9uU3RlcCwgdGhpcy5hbmltYXRpb25SZW5kZXIpO1xuICAgIH0sXG5cbiAgICBhbmltYXRpb25SZW5kZXI6IGZ1bmN0aW9uIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpIHtcbiAgICAgIC8vIFNlZSBjb21tZW50IGluIE1vdGlvbi5cbiAgICAgIGlmICghdGhpcy5oYXNVbm1vdW50ZWQpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBuZXh0U3RhdGUuY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKHN0eWxlLCBpKSB7XG4gICAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLmludGVycG9sYXRlVmFsdWUoYWxwaGEsIHN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlc1tpXSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuICAgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXh0U3RhdGUuY3VycmVudFZlbG9jaXRpZXNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSB0aGlzLnN0YXRlLmN1cnJlbnRTdHlsZXMubWFwKF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddKTtcbiAgICAgIHZhciByZW5kZXJlZENoaWxkcmVuID0gdGhpcy5wcm9wcy5jaGlsZHJlbihzdHJpcHBlZFN0eWxlKTtcbiAgICAgIHJldHVybiByZW5kZXJlZENoaWxkcmVuICYmIFJlYWN0LkNoaWxkcmVuLm9ubHkocmVuZGVyZWRDaGlsZHJlbik7XG4gICAgfVxuICB9KTtcblxuICB2YXIgVHJhbnNpdGlvbk1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBkaXNwbGF5TmFtZTogJ1RyYW5zaXRpb25Nb3Rpb24nLFxuXG4gICAgcHJvcFR5cGVzOiB7XG4gICAgICBkZWZhdWx0VmFsdWU6IGZ1bmN0aW9uIGRlZmF1bHRWYWx1ZShwcm9wLCBwcm9wTmFtZSkge1xuICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdUcmFuc2l0aW9uU3ByaW5nXFwncyBgZGVmYXVsdFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvICcgKyAnYGRlZmF1bHRTdHlsZXNgLiBJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpICcgKyAnY2hhbmdlcyBhcyB3ZWxsLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZW5kVmFsdWU6IGZ1bmN0aW9uIGVuZFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1RyYW5zaXRpb25TcHJpbmdcXCdzIGBlbmRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byBgc3R5bGVzYC4gJyArICdJdHMgZm9ybWF0IHJlY2VpdmVkIGEgZmV3IChlYXN5IHRvIHVwZGF0ZSEpIGNoYW5nZXMgYXMgd2VsbC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRlZmF1bHRTdHlsZTogZnVuY3Rpb24gZGVmYXVsdFN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgVHJhbnNpdGlvbk1vdGlvbmBcXCdzIGBkZWZhdWx0U3R5bGVzYC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShwcm9wLCBwcm9wTmFtZSkge1xuICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcbiAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdZb3UgZm9yZ290IHRoZSBcInNcIiBmb3IgYFRyYW5zaXRpb25Nb3Rpb25gXFwncyBgc3R5bGVzYC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGNvbmZpZ3MgaW4gaGVyZVxuICAgICAgZGVmYXVsdFN0eWxlczogUHJvcFR5cGVzLm9iamVjdE9mKFByb3BUeXBlcy5hbnkpLFxuICAgICAgc3R5bGVzOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuYywgUHJvcFR5cGVzLm9iamVjdE9mKFByb3BUeXBlcy5hbnkuaXNSZXF1aXJlZCldKS5pc1JlcXVpcmVkLFxuICAgICAgd2lsbExlYXZlOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuZnVuY10pLFxuICAgICAgLy8gVE9PRDogd2FybiBhZ2FpbnN0IHB1dHRpbmcgY29uZmlncyBpbiBoZXJlXG4gICAgICB3aWxsRW50ZXI6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5mdW5jXSksXG4gICAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxuICAgIH0sXG5cbiAgICBnZXREZWZhdWx0UHJvcHM6IGZ1bmN0aW9uIGdldERlZmF1bHRQcm9wcygpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdpbGxFbnRlcjogZnVuY3Rpb24gd2lsbEVudGVyKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIHdpbGxMZWF2ZTogZnVuY3Rpb24gd2lsbExlYXZlKCkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcbiAgICAgIHZhciBfcHJvcHMzID0gdGhpcy5wcm9wcztcbiAgICAgIHZhciBzdHlsZXMgPSBfcHJvcHMzLnN0eWxlcztcbiAgICAgIHZhciBkZWZhdWx0U3R5bGVzID0gX3Byb3BzMy5kZWZhdWx0U3R5bGVzO1xuXG4gICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHVuZGVmaW5lZDtcbiAgICAgIGlmIChkZWZhdWx0U3R5bGVzID09IG51bGwpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzdHlsZXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBjdXJyZW50U3R5bGVzID0gc3R5bGVzKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3VycmVudFN0eWxlcyA9IHN0eWxlcztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudFN0eWxlcyA9IGRlZmF1bHRTdHlsZXM7XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuICAgICAgICBjdXJyZW50VmVsb2NpdGllczogbWFwT2JqZWN0KGZ1bmN0aW9uIChzKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgcyk7XG4gICAgICAgIH0sIGN1cnJlbnRTdHlsZXMpXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGFuaW1hdGlvblN0ZXA6IGZ1bmN0aW9uIGFuaW1hdGlvblN0ZXAodGltZXN0ZXAsIHN0YXRlKSB7XG4gICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHN0YXRlLmN1cnJlbnRTdHlsZXM7XG4gICAgICB2YXIgY3VycmVudFZlbG9jaXRpZXMgPSBzdGF0ZS5jdXJyZW50VmVsb2NpdGllcztcbiAgICAgIHZhciBfcHJvcHM0ID0gdGhpcy5wcm9wcztcbiAgICAgIHZhciBzdHlsZXMgPSBfcHJvcHM0LnN0eWxlcztcbiAgICAgIHZhciB3aWxsRW50ZXIgPSBfcHJvcHM0LndpbGxFbnRlcjtcbiAgICAgIHZhciB3aWxsTGVhdmUgPSBfcHJvcHM0LndpbGxMZWF2ZTtcblxuICAgICAgaWYgKHR5cGVvZiBzdHlsZXMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgc3R5bGVzID0gc3R5bGVzKGN1cnJlbnRTdHlsZXMpO1xuICAgICAgfVxuXG4gICAgICAvLyBUT0RPOiBodWg/XG4gICAgICB2YXIgbWVyZ2VkU3R5bGVzID0gc3R5bGVzOyAvLyBzZXQgbWVyZ2VkU3R5bGVzIHRvIHN0eWxlcyBhcyB0aGUgZGVmYXVsdFxuICAgICAgdmFyIGhhc05ld0tleSA9IGZhbHNlO1xuXG4gICAgICBtZXJnZWRTdHlsZXMgPSBfbWVyZ2VEaWZmMlsnZGVmYXVsdCddKGN1cnJlbnRTdHlsZXMsIHN0eWxlcyxcbiAgICAgIC8vIFRPRE86IHN0b3AgYWxsb2NhdGluZyBsaWtlIGNyYXp5IGluIHRoaXMgd2hvbGUgY29kZSBwYXRoXG4gICAgICBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHZhciByZXMgPSB3aWxsTGVhdmUoa2V5LCBjdXJyZW50U3R5bGVzW2tleV0sIHN0eWxlcywgY3VycmVudFN0eWxlcywgY3VycmVudFZlbG9jaXRpZXMpO1xuICAgICAgICBpZiAocmVzID09IG51bGwpIHtcbiAgICAgICAgICAvLyBGb3IgbGVnYWN5IHJlYXNvbi4gV2Ugd29uJ3QgYWxsb3cgcmV0dXJuaW5nIG51bGwgc29vblxuICAgICAgICAgIC8vIFRPRE86IHJlbW92ZSwgYWZ0ZXIgbmV4dCByZWxlYXNlXG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoX25vVmVsb2NpdHkyWydkZWZhdWx0J10oY3VycmVudFZlbG9jaXRpZXNba2V5XSwgY3VycmVudFN0eWxlc1trZXldKSAmJiBfaGFzUmVhY2hlZFN0eWxlMlsnZGVmYXVsdCddKGN1cnJlbnRTdHlsZXNba2V5XSwgcmVzKSkge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgICB9KTtcblxuICAgICAgT2JqZWN0LmtleXMobWVyZ2VkU3R5bGVzKS5maWx0ZXIoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4gIWN1cnJlbnRTdHlsZXMuaGFzT3duUHJvcGVydHkoa2V5KTtcbiAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICB2YXIgX2V4dGVuZHMyLCBfZXh0ZW5kczM7XG5cbiAgICAgICAgaGFzTmV3S2V5ID0gdHJ1ZTtcbiAgICAgICAgdmFyIGVudGVyU3R5bGUgPSB3aWxsRW50ZXIoa2V5LCBtZXJnZWRTdHlsZXNba2V5XSwgc3R5bGVzLCBjdXJyZW50U3R5bGVzLCBjdXJyZW50VmVsb2NpdGllcyk7XG5cbiAgICAgICAgLy8gV2UgY2FuIG11dGF0ZSB0aGlzIGhlcmUgYmVjYXVzZSBtZXJnZURpZmYgcmV0dXJucyBhIG5ldyBPYmpcbiAgICAgICAgbWVyZ2VkU3R5bGVzW2tleV0gPSBlbnRlclN0eWxlO1xuXG4gICAgICAgIGN1cnJlbnRTdHlsZXMgPSBfZXh0ZW5kcyh7fSwgY3VycmVudFN0eWxlcywgKF9leHRlbmRzMiA9IHt9LCBfZXh0ZW5kczJba2V5XSA9IGVudGVyU3R5bGUsIF9leHRlbmRzMikpO1xuICAgICAgICBjdXJyZW50VmVsb2NpdGllcyA9IF9leHRlbmRzKHt9LCBjdXJyZW50VmVsb2NpdGllcywgKF9leHRlbmRzMyA9IHt9LCBfZXh0ZW5kczNba2V5XSA9IG1hcE9iamVjdChfemVybzJbJ2RlZmF1bHQnXSwgZW50ZXJTdHlsZSksIF9leHRlbmRzMykpO1xuICAgICAgfSk7XG5cbiAgICAgIHZhciBuZXdDdXJyZW50U3R5bGVzID0gbWFwT2JqZWN0KGZ1bmN0aW9uIChtZXJnZWRTdHlsZSwga2V5KSB7XG4gICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50U3R5bGUodGltZXN0ZXAsIGN1cnJlbnRTdHlsZXNba2V5XSwgY3VycmVudFZlbG9jaXRpZXNba2V5XSwgbWVyZ2VkU3R5bGUpO1xuICAgICAgfSwgbWVyZ2VkU3R5bGVzKTtcbiAgICAgIHZhciBuZXdDdXJyZW50VmVsb2NpdGllcyA9IG1hcE9iamVjdChmdW5jdGlvbiAobWVyZ2VkU3R5bGUsIGtleSkge1xuICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFZlbG9jaXR5KHRpbWVzdGVwLCBjdXJyZW50U3R5bGVzW2tleV0sIGN1cnJlbnRWZWxvY2l0aWVzW2tleV0sIG1lcmdlZFN0eWxlKTtcbiAgICAgIH0sIG1lcmdlZFN0eWxlcyk7XG5cbiAgICAgIGlmICghaGFzTmV3S2V5ICYmIGV2ZXJ5T2JqKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBjdXJyZW50U3R5bGVzW2tdKTtcbiAgICAgIH0sIGN1cnJlbnRWZWxvY2l0aWVzKSAmJiBldmVyeU9iaihmdW5jdGlvbiAodiwgaykge1xuICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgbmV3Q3VycmVudFN0eWxlc1trXSk7XG4gICAgICB9LCBuZXdDdXJyZW50VmVsb2NpdGllcykpIHtcbiAgICAgICAgLy8gY2hlY2sgZXhwbGFuYXRpb24gaW4gYE1vdGlvbi5hbmltYXRpb25SZW5kZXJgXG4gICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpOyAvLyBOYXN0eSBzaWRlIGVmZmVjdHMuLi4uXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGN1cnJlbnRTdHlsZXM6IG5ld0N1cnJlbnRTdHlsZXMsXG4gICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXdDdXJyZW50VmVsb2NpdGllc1xuICAgICAgfTtcbiAgICB9LFxuXG4gICAgc3RvcEFuaW1hdGlvbjogbnVsbCxcblxuICAgIC8vIHVzZWQgaW4gYW5pbWF0aW9uUmVuZGVyXG4gICAgaGFzVW5tb3VudGVkOiBmYWxzZSxcblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuICAgICAgdGhpcy5oYXNVbm1vdW50ZWQgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBzdGFydEFuaW1hdGluZzogZnVuY3Rpb24gc3RhcnRBbmltYXRpbmcoKSB7XG4gICAgICB0aGlzLnN0b3BBbmltYXRpb24gPSBzdGFydEFuaW1hdGlvbih0aGlzLnN0YXRlLCB0aGlzLmFuaW1hdGlvblN0ZXAsIHRoaXMuYW5pbWF0aW9uUmVuZGVyKTtcbiAgICB9LFxuXG4gICAgYW5pbWF0aW9uUmVuZGVyOiBmdW5jdGlvbiBhbmltYXRpb25SZW5kZXIoYWxwaGEsIG5leHRTdGF0ZSwgcHJldlN0YXRlKSB7XG4gICAgICAvLyBTZWUgY29tbWVudCBpbiBNb3Rpb24uXG4gICAgICBpZiAoIXRoaXMuaGFzVW5tb3VudGVkKSB7XG4gICAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gbWFwT2JqZWN0KGZ1bmN0aW9uIChzdHlsZSwga2V5KSB7XG4gICAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLmludGVycG9sYXRlVmFsdWUoYWxwaGEsIHN0eWxlLCBwcmV2U3RhdGUuY3VycmVudFN0eWxlc1trZXldKTtcbiAgICAgICAgfSwgbmV4dFN0YXRlLmN1cnJlbnRTdHlsZXMpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuICAgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXh0U3RhdGUuY3VycmVudFZlbG9jaXRpZXNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSBtYXBPYmplY3QoX3N0cmlwU3R5bGUyWydkZWZhdWx0J10sIHRoaXMuc3RhdGUuY3VycmVudFN0eWxlcyk7XG4gICAgICB2YXIgcmVuZGVyZWRDaGlsZHJlbiA9IHRoaXMucHJvcHMuY2hpbGRyZW4oc3RyaXBwZWRTdHlsZSk7XG4gICAgICByZXR1cm4gcmVuZGVyZWRDaGlsZHJlbiAmJiBSZWFjdC5DaGlsZHJlbi5vbmx5KHJlbmRlcmVkQ2hpbGRyZW4pO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIF9kZXByZWNhdGVkU3ByaW5ncyA9IF9kZXByZWNhdGVkU3ByaW5nczNbJ2RlZmF1bHQnXShSZWFjdCk7XG5cbiAgdmFyIFNwcmluZyA9IF9kZXByZWNhdGVkU3ByaW5ncy5TcHJpbmc7XG4gIHZhciBUcmFuc2l0aW9uU3ByaW5nID0gX2RlcHJlY2F0ZWRTcHJpbmdzLlRyYW5zaXRpb25TcHJpbmc7XG5cbiAgcmV0dXJuIHsgU3ByaW5nOiBTcHJpbmcsIFRyYW5zaXRpb25TcHJpbmc6IFRyYW5zaXRpb25TcHJpbmcsIE1vdGlvbjogTW90aW9uLCBTdGFnZ2VyZWRNb3Rpb246IFN0YWdnZXJlZE1vdGlvbiwgVHJhbnNpdGlvbk1vdGlvbjogVHJhbnNpdGlvbk1vdGlvbiB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL2NvbXBvbmVudHMuanNcbiAqKiBtb2R1bGUgaWQgPSAyMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1snZGVmYXVsdCddID0gZGVwcmVjYXRlZFNwcmluZ3M7XG52YXIgaGFzV2FybmVkRm9yU3ByaW5nID0ge307XG52YXIgaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZyA9IHt9O1xuXG5mdW5jdGlvbiBkZXByZWNhdGVkU3ByaW5ncyhSZWFjdCkge1xuICB2YXIgU3ByaW5nID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICAgIGRpc3BsYXlOYW1lOiAnU3ByaW5nJyxcblxuICAgIGNvbXBvbmVudFdpbGxNb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICAgIHZhciBvd25lck5hbWUgPSB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lciAmJiB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lci5nZXROYW1lKCk7XG4gICAgICAgIGlmICghaGFzV2FybmVkRm9yU3ByaW5nW293bmVyTmFtZV0pIHtcbiAgICAgICAgICBoYXNXYXJuZWRGb3JTcHJpbmdbb3duZXJOYW1lXSA9IHRydWU7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignU3ByaW5nICh1c2VkIGluICVzcmVuZGVyKSBoYXMgbm93IGJlZW4gcmVuYW1lZCB0byBNb3Rpb24uICcgKyAnUGxlYXNlIHNlZSB0aGUgcmVsZWFzZSBub3RlIGZvciB0aGUgdXBncmFkZSBwYXRoLiBUaGFuayB5b3UhJywgb3duZXJOYW1lID8gb3duZXJOYW1lICsgJ1xcJ3MgJyA6ICdSZWFjdC4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSk7XG5cbiAgdmFyIFRyYW5zaXRpb25TcHJpbmcgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gICAgZGlzcGxheU5hbWU6ICdUcmFuc2l0aW9uU3ByaW5nJyxcblxuICAgIGNvbXBvbmVudFdpbGxNb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gICAgICAgIHZhciBvd25lck5hbWUgPSB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lciAmJiB0aGlzLl9yZWFjdEludGVybmFsSW5zdGFuY2UuX2N1cnJlbnRFbGVtZW50Ll9vd25lci5nZXROYW1lKCk7XG4gICAgICAgIGlmICghaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZ1tvd25lck5hbWVdKSB7XG4gICAgICAgICAgaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZ1tvd25lck5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdUcmFuc2l0aW9uU3ByaW5nICh1c2VkIGluICVzcmVuZGVyKSBoYXMgbm93IGJlZW4gcmVuYW1lZCB0byAnICsgJ1RyYW5zaXRpb25Nb3Rpb24uIFBsZWFzZSBzZWUgdGhlIHJlbGVhc2Ugbm90ZSBmb3IgdGhlIHVwZ3JhZGUgJyArICdwYXRoLiBUaGFuayB5b3UhJywgb3duZXJOYW1lID8gb3duZXJOYW1lICsgJ1xcJ3MgJyA6ICdSZWFjdC4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHsgU3ByaW5nOiBTcHJpbmcsIFRyYW5zaXRpb25TcHJpbmc6IFRyYW5zaXRpb25TcHJpbmcgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9kZXByZWNhdGVkU3ByaW5ncy5qc1xuICoqIG1vZHVsZSBpZCA9IDIyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJcInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gaGFzUmVhY2hlZFN0eWxlO1xuXG5mdW5jdGlvbiBoYXNSZWFjaGVkU3R5bGUoY3VycmVudFN0eWxlLCBzdHlsZSkge1xuICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcbiAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB2YXIgY3VycmVudFZhbHVlID0gY3VycmVudFN0eWxlW2tleV07XG4gICAgdmFyIGRlc3RWYWx1ZSA9IHN0eWxlW2tleV07XG4gICAgaWYgKCFkZXN0VmFsdWUuY29uZmlnKSB7XG4gICAgICAvLyBub3QgYSBzcHJpbmcgY29uZmlnXG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGN1cnJlbnRWYWx1ZS5jb25maWcgJiYgY3VycmVudFZhbHVlLnZhbCAhPT0gZGVzdFZhbHVlLnZhbCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoIWN1cnJlbnRWYWx1ZS5jb25maWcgJiYgY3VycmVudFZhbHVlICE9PSBkZXN0VmFsdWUudmFsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9oYXNSZWFjaGVkU3R5bGUuanNcbiAqKiBtb2R1bGUgaWQgPSAyM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gdGhpcyBmdW5jdGlvbiBpcyBhbGxvY2F0aW9uLWxlc3MgdGhhbmtzIHRvIGJhYmVsLCB3aGljaCB0cmFuc2Zvcm1zIHRoZSB0YWlsXG4vLyBjYWxscyBpbnRvIGxvb3BzXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gbWVyZ2VEaWZmO1xuZnVuY3Rpb24gbWVyZ2VEaWZmQXJyKF94LCBfeDIsIF94MywgX3g0LCBfeDUsIF94NiwgX3g3KSB7XG4gIHZhciBfYWdhaW4gPSB0cnVlO1xuXG4gIF9mdW5jdGlvbjogd2hpbGUgKF9hZ2Fpbikge1xuICAgIHZhciBhcnJBID0gX3gsXG4gICAgICAgIGFyckIgPSBfeDIsXG4gICAgICAgIGNvbGxCID0gX3gzLFxuICAgICAgICBpbmRleEEgPSBfeDQsXG4gICAgICAgIGluZGV4QiA9IF94NSxcbiAgICAgICAgb25SZW1vdmUgPSBfeDYsXG4gICAgICAgIGFjY3VtID0gX3g3O1xuICAgIGVuZEEgPSBlbmRCID0ga2V5QSA9IGtleUIgPSBmaWxsID0gZmlsbCA9IHVuZGVmaW5lZDtcbiAgICBfYWdhaW4gPSBmYWxzZTtcblxuICAgIHZhciBlbmRBID0gaW5kZXhBID09PSBhcnJBLmxlbmd0aDtcbiAgICB2YXIgZW5kQiA9IGluZGV4QiA9PT0gYXJyQi5sZW5ndGg7XG4gICAgdmFyIGtleUEgPSBhcnJBW2luZGV4QV07XG4gICAgdmFyIGtleUIgPSBhcnJCW2luZGV4Ql07XG4gICAgaWYgKGVuZEEgJiYgZW5kQikge1xuICAgICAgLy8gcmV0dXJuaW5nIG51bGwgaGVyZSwgb3RoZXJ3aXNlIGxpbnQgY29tcGxhaW5zIHRoYXQgd2UncmUgbm90IGV4cGVjdGluZ1xuICAgICAgLy8gYSByZXR1cm4gdmFsdWUgaW4gc3Vic2VxdWVudCBjYWxscy4gV2Uga25vdyB3aGF0IHdlJ3JlIGRvaW5nLlxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGVuZEEpIHtcbiAgICAgIGFjY3VtW2tleUJdID0gY29sbEJba2V5Ql07XG4gICAgICBfeCA9IGFyckE7XG4gICAgICBfeDIgPSBhcnJCO1xuICAgICAgX3gzID0gY29sbEI7XG4gICAgICBfeDQgPSBpbmRleEE7XG4gICAgICBfeDUgPSBpbmRleEIgKyAxO1xuICAgICAgX3g2ID0gb25SZW1vdmU7XG4gICAgICBfeDcgPSBhY2N1bTtcbiAgICAgIF9hZ2FpbiA9IHRydWU7XG4gICAgICBjb250aW51ZSBfZnVuY3Rpb247XG4gICAgfVxuXG4gICAgaWYgKGVuZEIpIHtcbiAgICAgIHZhciBmaWxsID0gb25SZW1vdmUoa2V5QSk7XG4gICAgICBpZiAoZmlsbCAhPSBudWxsKSB7XG4gICAgICAgIGFjY3VtW2tleUFdID0gZmlsbDtcbiAgICAgIH1cbiAgICAgIF94ID0gYXJyQTtcbiAgICAgIF94MiA9IGFyckI7XG4gICAgICBfeDMgPSBjb2xsQjtcbiAgICAgIF94NCA9IGluZGV4QSArIDE7XG4gICAgICBfeDUgPSBpbmRleEI7XG4gICAgICBfeDYgPSBvblJlbW92ZTtcbiAgICAgIF94NyA9IGFjY3VtO1xuICAgICAgX2FnYWluID0gdHJ1ZTtcbiAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcbiAgICB9XG5cbiAgICBpZiAoa2V5QSA9PT0ga2V5Qikge1xuICAgICAgYWNjdW1ba2V5QV0gPSBjb2xsQltrZXlBXTtcbiAgICAgIF94ID0gYXJyQTtcbiAgICAgIF94MiA9IGFyckI7XG4gICAgICBfeDMgPSBjb2xsQjtcbiAgICAgIF94NCA9IGluZGV4QSArIDE7XG4gICAgICBfeDUgPSBpbmRleEIgKyAxO1xuICAgICAgX3g2ID0gb25SZW1vdmU7XG4gICAgICBfeDcgPSBhY2N1bTtcbiAgICAgIF9hZ2FpbiA9IHRydWU7XG4gICAgICBjb250aW51ZSBfZnVuY3Rpb247XG4gICAgfVxuXG4gICAgaWYgKCFjb2xsQi5oYXNPd25Qcm9wZXJ0eShrZXlBKSkge1xuICAgICAgdmFyIGZpbGwgPSBvblJlbW92ZShrZXlBKTtcbiAgICAgIGlmIChmaWxsICE9IG51bGwpIHtcbiAgICAgICAgYWNjdW1ba2V5QV0gPSBmaWxsO1xuICAgICAgfVxuICAgICAgX3ggPSBhcnJBO1xuICAgICAgX3gyID0gYXJyQjtcbiAgICAgIF94MyA9IGNvbGxCO1xuICAgICAgX3g0ID0gaW5kZXhBICsgMTtcbiAgICAgIF94NSA9IGluZGV4QjtcbiAgICAgIF94NiA9IG9uUmVtb3ZlO1xuICAgICAgX3g3ID0gYWNjdW07XG4gICAgICBfYWdhaW4gPSB0cnVlO1xuICAgICAgY29udGludWUgX2Z1bmN0aW9uO1xuICAgIH1cblxuICAgIF94ID0gYXJyQTtcbiAgICBfeDIgPSBhcnJCO1xuICAgIF94MyA9IGNvbGxCO1xuICAgIF94NCA9IGluZGV4QSArIDE7XG4gICAgX3g1ID0gaW5kZXhCO1xuICAgIF94NiA9IG9uUmVtb3ZlO1xuICAgIF94NyA9IGFjY3VtO1xuICAgIF9hZ2FpbiA9IHRydWU7XG4gICAgY29udGludWUgX2Z1bmN0aW9uO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1lcmdlRGlmZihhLCBiLCBvblJlbW92ZSkge1xuICB2YXIgcmV0ID0ge307XG4gIC8vIGlmIGFueW9uZSBjYW4gbWFrZSB0aGlzIHdvcmsgd2l0aG91dCBhbGxvY2F0aW5nIHRoZSBhcnJheXMgaGVyZSwgd2UnbGxcbiAgLy8gZ2l2ZSB5b3UgYSBtZWRhbFxuICBtZXJnZURpZmZBcnIoT2JqZWN0LmtleXMoYSksIE9iamVjdC5rZXlzKGIpLCBiLCAwLCAwLCBvblJlbW92ZSwgcmV0KTtcbiAgcmV0dXJuIHJldDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL21lcmdlRGlmZi5qc1xuICoqIG1vZHVsZSBpZCA9IDI0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyBjdXJyZW50U3R5bGUga2VlcHMgdGhlIGluZm8gYWJvdXQgd2hldGhlciBhIHByb3AgaXMgY29uZmlndXJlZCBhcyBhIHNwcmluZ1xuLy8gb3IgaWYgaXQncyBqdXN0IGEgcmFuZG9tIHByb3AgdGhhdCBoYXBwZW5zIHRvIGJlIHByZXNlbnQgb24gdGhlIHN0eWxlXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gbm9WZWxvY2l0eTtcblxuZnVuY3Rpb24gbm9WZWxvY2l0eShjdXJyZW50VmVsb2NpdHksIGN1cnJlbnRTdHlsZSkge1xuICBmb3IgKHZhciBrZXkgaW4gY3VycmVudFZlbG9jaXR5KSB7XG4gICAgaWYgKCFjdXJyZW50VmVsb2NpdHkuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChjdXJyZW50U3R5bGVba2V5XS5jb25maWcgJiYgY3VycmVudFZlbG9jaXR5W2tleV0gIT09IDApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9ub1ZlbG9jaXR5LmpzXG4gKiogbW9kdWxlIGlkID0gMjVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3JlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfY29tcG9uZW50czIgPSByZXF1aXJlKCcuL2NvbXBvbmVudHMnKTtcblxudmFyIF9jb21wb25lbnRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudHMyKTtcblxudmFyIF9yZW9yZGVyS2V5cyA9IHJlcXVpcmUoJy4vcmVvcmRlcktleXMnKTtcblxudmFyIF9yZW9yZGVyS2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW9yZGVyS2V5cyk7XG5cbnZhciBfY29tcG9uZW50cyA9IF9jb21wb25lbnRzM1snZGVmYXVsdCddKF9yZWFjdDJbJ2RlZmF1bHQnXSk7XG5cbnZhciBTcHJpbmcgPSBfY29tcG9uZW50cy5TcHJpbmc7XG52YXIgVHJhbnNpdGlvblNwcmluZyA9IF9jb21wb25lbnRzLlRyYW5zaXRpb25TcHJpbmc7XG52YXIgTW90aW9uID0gX2NvbXBvbmVudHMuTW90aW9uO1xudmFyIFN0YWdnZXJlZE1vdGlvbiA9IF9jb21wb25lbnRzLlN0YWdnZXJlZE1vdGlvbjtcbnZhciBUcmFuc2l0aW9uTW90aW9uID0gX2NvbXBvbmVudHMuVHJhbnNpdGlvbk1vdGlvbjtcbmV4cG9ydHMuU3ByaW5nID0gU3ByaW5nO1xuZXhwb3J0cy5UcmFuc2l0aW9uU3ByaW5nID0gVHJhbnNpdGlvblNwcmluZztcbmV4cG9ydHMuTW90aW9uID0gTW90aW9uO1xuZXhwb3J0cy5TdGFnZ2VyZWRNb3Rpb24gPSBTdGFnZ2VyZWRNb3Rpb247XG5leHBvcnRzLlRyYW5zaXRpb25Nb3Rpb24gPSBUcmFuc2l0aW9uTW90aW9uO1xuXG52YXIgX3NwcmluZzIgPSByZXF1aXJlKCcuL3NwcmluZycpO1xuXG52YXIgX3NwcmluZzMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zcHJpbmcyKTtcblxuZXhwb3J0cy5zcHJpbmcgPSBfc3ByaW5nM1snZGVmYXVsdCddO1xuXG52YXIgX3ByZXNldHMyID0gcmVxdWlyZSgnLi9wcmVzZXRzJyk7XG5cbnZhciBfcHJlc2V0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcmVzZXRzMik7XG5cbmV4cG9ydHMucHJlc2V0cyA9IF9wcmVzZXRzM1snZGVmYXVsdCddO1xudmFyIHV0aWxzID0ge1xuICByZW9yZGVyS2V5czogX3Jlb3JkZXJLZXlzMlsnZGVmYXVsdCddXG59O1xuZXhwb3J0cy51dGlscyA9IHV0aWxzO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvcmVhY3QtbW90aW9uLmpzXG4gKiogbW9kdWxlIGlkID0gMjZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSByZW9yZGVyS2V5cztcblxuZnVuY3Rpb24gcmVvcmRlcktleXMob2JqLCBmKSB7XG4gIHZhciBuZXdLZXlzID0gZihPYmplY3Qua2V5cyhvYmopKTtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBpID0gMDsgaSA8IG5ld0tleXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIga2V5ID0gbmV3S2V5c1tpXTtcbiAgICByZXRba2V5XSA9IG9ialtrZXldO1xuICB9XG5cbiAgcmV0dXJuIHJldDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3Jlb3JkZXJLZXlzLmpzXG4gKiogbW9kdWxlIGlkID0gMjdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbJ2RlZmF1bHQnXSA9IHNwcmluZztcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3ByZXNldHMgPSByZXF1aXJlKCcuL3ByZXNldHMnKTtcblxudmFyIF9wcmVzZXRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3ByZXNldHMpO1xuXG4vLyBpbnN0ZWFkIG9mIGV4cG9zaW5nIHt2YWw6IGJsYSwgY29uZmlnOiBibGF9LCB1c2UgYSBoZWxwZXJcblxuZnVuY3Rpb24gc3ByaW5nKHZhbCkge1xuICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gX3ByZXNldHMyWydkZWZhdWx0J10ubm9Xb2JibGUgOiBhcmd1bWVudHNbMV07XG5cbiAgcmV0dXJuIHsgdmFsOiB2YWwsIGNvbmZpZzogY29uZmlnIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvc3ByaW5nLmpzXG4gKiogbW9kdWxlIGlkID0gMjhcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBzdGVwcGVyO1xudmFyIGVycm9yTWFyZ2luID0gMC4wMDAxO1xuXG5mdW5jdGlvbiBzdGVwcGVyKGZyYW1lUmF0ZSwgeCwgdiwgZGVzdFgsIGssIGIpIHtcbiAgLy8gU3ByaW5nIHN0aWZmbmVzcywgaW4ga2cgLyBzXjJcblxuICAvLyBmb3IgYW5pbWF0aW9ucywgZGVzdFggaXMgcmVhbGx5IHNwcmluZyBsZW5ndGggKHNwcmluZyBhdCByZXN0KS4gaW5pdGlhbFxuICAvLyBwb3NpdGlvbiBpcyBjb25zaWRlcmVkIGFzIHRoZSBzdHJldGNoZWQvY29tcHJlc3NlZCBwb3NpdGlvbiBvZiBhIHNwcmluZ1xuICB2YXIgRnNwcmluZyA9IC1rICogKHggLSBkZXN0WCk7XG5cbiAgLy8gRGFtcGluZywgaW4ga2cgLyBzXG4gIHZhciBGZGFtcGVyID0gLWIgKiB2O1xuXG4gIC8vIHVzdWFsbHkgd2UgcHV0IG1hc3MgaGVyZSwgYnV0IGZvciBhbmltYXRpb24gcHVycG9zZXMsIHNwZWNpZnlpbmcgbWFzcyBpcyBhXG4gIC8vIGJpdCByZWR1bmRhbnQuIHlvdSBjb3VsZCBzaW1wbHkgYWRqdXN0IGsgYW5kIGIgYWNjb3JkaW5nbHlcbiAgLy8gbGV0IGEgPSAoRnNwcmluZyArIEZkYW1wZXIpIC8gbWFzcztcbiAgdmFyIGEgPSBGc3ByaW5nICsgRmRhbXBlcjtcblxuICB2YXIgbmV3ViA9IHYgKyBhICogZnJhbWVSYXRlO1xuICB2YXIgbmV3WCA9IHggKyBuZXdWICogZnJhbWVSYXRlO1xuXG4gIGlmIChNYXRoLmFicyhuZXdWIC0gdikgPCBlcnJvck1hcmdpbiAmJiBNYXRoLmFicyhuZXdYIC0geCkgPCBlcnJvck1hcmdpbikge1xuICAgIHJldHVybiBbZGVzdFgsIDBdO1xuICB9XG5cbiAgcmV0dXJuIFtuZXdYLCBuZXdWXTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3N0ZXBwZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAyOVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gdHVybiB7eDoge3ZhbDogMSwgY29uZmlnOiBbMSwgMl19LCB5OiAyfSBpbnRvIHt4OiAxLCB5OiAyfVxuXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHN0cmlwU3R5bGU7XG5cbmZ1bmN0aW9uIHN0cmlwU3R5bGUoc3R5bGUpIHtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcbiAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICByZXRba2V5XSA9IHN0eWxlW2tleV0udmFsID09IG51bGwgPyBzdHlsZVtrZXldIDogc3R5bGVba2V5XS52YWw7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3N0cmlwU3R5bGUuanNcbiAqKiBtb2R1bGUgaWQgPSAzMFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0cy5pbnRlcnBvbGF0ZVZhbHVlID0gaW50ZXJwb2xhdGVWYWx1ZTtcbmV4cG9ydHMudXBkYXRlQ3VycmVudFN0eWxlID0gdXBkYXRlQ3VycmVudFN0eWxlO1xuZXhwb3J0cy51cGRhdGVDdXJyZW50VmVsb2NpdHkgPSB1cGRhdGVDdXJyZW50VmVsb2NpdHk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblxudmFyIF9zdGVwcGVyID0gcmVxdWlyZSgnLi9zdGVwcGVyJyk7XG5cbnZhciBfc3RlcHBlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGVwcGVyKTtcblxuLy8gVE9ETzogcmVmYWN0b3IgY29tbW9uIGxvZ2ljIHdpdGggdXBkYXRlQ3VyclZhbHVlIGFuZCB1cGRhdGVDdXJyVmVsb2NpdHlcblxuZnVuY3Rpb24gaW50ZXJwb2xhdGVWYWx1ZShhbHBoYSwgbmV4dFN0eWxlLCBwcmV2U3R5bGUpIHtcbiAgLy8gbWlnaHQgYmUgdXNlZCBieSBhIFRyYW5zaXRpb25Nb3Rpb24sIHdoZXJlIHByZXZTdHlsZSBtaWdodCBub3QgZXhpc3QgYW55bW9yZVxuICBpZiAoIXByZXZTdHlsZSkge1xuICAgIHJldHVybiBuZXh0U3R5bGU7XG4gIH1cblxuICB2YXIgcmV0ID0ge307XG4gIGZvciAodmFyIGtleSBpbiBuZXh0U3R5bGUpIHtcbiAgICBpZiAoIW5leHRTdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoIW5leHRTdHlsZVtrZXldLmNvbmZpZykge1xuICAgICAgcmV0W2tleV0gPSBuZXh0U3R5bGVba2V5XTtcbiAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWcsIG5vdCBzb21ldGhpbmcgd2Ugd2FudCB0byBpbnRlcnBvbGF0ZVxuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHZhciBwcmV2VmFsdWUgPSBwcmV2U3R5bGVba2V5XS5jb25maWcgPyBwcmV2U3R5bGVba2V5XS52YWwgOiBwcmV2U3R5bGVba2V5XTtcbiAgICByZXRba2V5XSA9IHtcbiAgICAgIHZhbDogbmV4dFN0eWxlW2tleV0udmFsICogYWxwaGEgKyBwcmV2VmFsdWUgKiAoMSAtIGFscGhhKSxcbiAgICAgIGNvbmZpZzogbmV4dFN0eWxlW2tleV0uY29uZmlnXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiByZXQ7XG59XG5cbi8vIFRPRE86IHJlZmFjdG9yIGNvbW1vbiBsb2dpYyB3aXRoIHVwZGF0ZUN1cnJlbnRWZWxvY2l0eVxuXG5mdW5jdGlvbiB1cGRhdGVDdXJyZW50U3R5bGUoZnJhbWVSYXRlLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpIHtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcbiAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoIXN0eWxlW2tleV0uY29uZmlnKSB7XG4gICAgICByZXRba2V5XSA9IHN0eWxlW2tleV07XG4gICAgICAvLyBub3QgYSBzcHJpbmcgY29uZmlnLCBub3Qgc29tZXRoaW5nIHdlIHdhbnQgdG8gaW50ZXJwb2xhdGVcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB2YXIgX3N0eWxlJGtleSRjb25maWcgPSBzdHlsZVtrZXldLmNvbmZpZztcbiAgICB2YXIgayA9IF9zdHlsZSRrZXkkY29uZmlnWzBdO1xuICAgIHZhciBiID0gX3N0eWxlJGtleSRjb25maWdbMV07XG5cbiAgICB2YXIgdmFsID0gX3N0ZXBwZXIyWydkZWZhdWx0J10oZnJhbWVSYXRlLFxuICAgIC8vIG1pZ2h0IGhhdmUgYmVlbiBhIG5vbi1zcHJpbmdlZCBwcm9wIHRoYXQganVzdCBiZWNhbWUgb25lXG4gICAgY3VycmVudFN0eWxlW2tleV0udmFsID09IG51bGwgPyBjdXJyZW50U3R5bGVba2V5XSA6IGN1cnJlbnRTdHlsZVtrZXldLnZhbCwgY3VycmVudFZlbG9jaXR5W2tleV0sIHN0eWxlW2tleV0udmFsLCBrLCBiKVswXTtcbiAgICByZXRba2V5XSA9IHtcbiAgICAgIHZhbDogdmFsLFxuICAgICAgY29uZmlnOiBzdHlsZVtrZXldLmNvbmZpZ1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ3VycmVudFZlbG9jaXR5KGZyYW1lUmF0ZSwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdHksIHN0eWxlKSB7XG4gIHZhciByZXQgPSB7fTtcbiAgZm9yICh2YXIga2V5IGluIHN0eWxlKSB7XG4gICAgaWYgKCFzdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKCFzdHlsZVtrZXldLmNvbmZpZykge1xuICAgICAgLy8gbm90IGEgc3ByaW5nIGNvbmZpZywgbm90IHNvbWV0aGluZyB3ZSB3YW50IHRvIGludGVycG9sYXRlXG4gICAgICByZXRba2V5XSA9IDA7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgdmFyIF9zdHlsZSRrZXkkY29uZmlnMiA9IHN0eWxlW2tleV0uY29uZmlnO1xuICAgIHZhciBrID0gX3N0eWxlJGtleSRjb25maWcyWzBdO1xuICAgIHZhciBiID0gX3N0eWxlJGtleSRjb25maWcyWzFdO1xuXG4gICAgdmFyIHZhbCA9IF9zdGVwcGVyMlsnZGVmYXVsdCddKGZyYW1lUmF0ZSxcbiAgICAvLyBtaWdodCBoYXZlIGJlZW4gYSBub24tc3ByaW5nZWQgcHJvcCB0aGF0IGp1c3QgYmVjYW1lIG9uZVxuICAgIGN1cnJlbnRTdHlsZVtrZXldLnZhbCA9PSBudWxsID8gY3VycmVudFN0eWxlW2tleV0gOiBjdXJyZW50U3R5bGVba2V5XS52YWwsIGN1cnJlbnRWZWxvY2l0eVtrZXldLCBzdHlsZVtrZXldLnZhbCwgaywgYilbMV07XG4gICAgcmV0W2tleV0gPSB2YWw7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn1cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3VwZGF0ZVRyZWUuanNcbiAqKiBtb2R1bGUgaWQgPSAzMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gdXNlZCBieSB0aGUgdHJlZS13YWxraW5nIHVwZGF0ZXMgYW5kIHNwcmluZ3MuIEF2b2lkcyBzb21lIGFsbG9jYXRpb25zXG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gemVybztcblxuZnVuY3Rpb24gemVybygpIHtcbiAgcmV0dXJuIDA7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi96ZXJvLmpzXG4gKiogbW9kdWxlIGlkID0gMzJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInZhciBub3cgPSByZXF1aXJlKCdwZXJmb3JtYW5jZS1ub3cnKVxuICAsIGdsb2JhbCA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnID8ge30gOiB3aW5kb3dcbiAgLCB2ZW5kb3JzID0gWydtb3onLCAnd2Via2l0J11cbiAgLCBzdWZmaXggPSAnQW5pbWF0aW9uRnJhbWUnXG4gICwgcmFmID0gZ2xvYmFsWydyZXF1ZXN0JyArIHN1ZmZpeF1cbiAgLCBjYWYgPSBnbG9iYWxbJ2NhbmNlbCcgKyBzdWZmaXhdIHx8IGdsb2JhbFsnY2FuY2VsUmVxdWVzdCcgKyBzdWZmaXhdXG5cbmZvcih2YXIgaSA9IDA7IGkgPCB2ZW5kb3JzLmxlbmd0aCAmJiAhcmFmOyBpKyspIHtcbiAgcmFmID0gZ2xvYmFsW3ZlbmRvcnNbaV0gKyAnUmVxdWVzdCcgKyBzdWZmaXhdXG4gIGNhZiA9IGdsb2JhbFt2ZW5kb3JzW2ldICsgJ0NhbmNlbCcgKyBzdWZmaXhdXG4gICAgICB8fCBnbG9iYWxbdmVuZG9yc1tpXSArICdDYW5jZWxSZXF1ZXN0JyArIHN1ZmZpeF1cbn1cblxuLy8gU29tZSB2ZXJzaW9ucyBvZiBGRiBoYXZlIHJBRiBidXQgbm90IGNBRlxuaWYoIXJhZiB8fCAhY2FmKSB7XG4gIHZhciBsYXN0ID0gMFxuICAgICwgaWQgPSAwXG4gICAgLCBxdWV1ZSA9IFtdXG4gICAgLCBmcmFtZUR1cmF0aW9uID0gMTAwMCAvIDYwXG5cbiAgcmFmID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICBpZihxdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgIHZhciBfbm93ID0gbm93KClcbiAgICAgICAgLCBuZXh0ID0gTWF0aC5tYXgoMCwgZnJhbWVEdXJhdGlvbiAtIChfbm93IC0gbGFzdCkpXG4gICAgICBsYXN0ID0gbmV4dCArIF9ub3dcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBjcCA9IHF1ZXVlLnNsaWNlKDApXG4gICAgICAgIC8vIENsZWFyIHF1ZXVlIGhlcmUgdG8gcHJldmVudFxuICAgICAgICAvLyBjYWxsYmFja3MgZnJvbSBhcHBlbmRpbmcgbGlzdGVuZXJzXG4gICAgICAgIC8vIHRvIHRoZSBjdXJyZW50IGZyYW1lJ3MgcXVldWVcbiAgICAgICAgcXVldWUubGVuZ3RoID0gMFxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY3AubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZighY3BbaV0uY2FuY2VsbGVkKSB7XG4gICAgICAgICAgICB0cnl7XG4gICAgICAgICAgICAgIGNwW2ldLmNhbGxiYWNrKGxhc3QpXG4gICAgICAgICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgdGhyb3cgZSB9LCAwKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSwgTWF0aC5yb3VuZChuZXh0KSlcbiAgICB9XG4gICAgcXVldWUucHVzaCh7XG4gICAgICBoYW5kbGU6ICsraWQsXG4gICAgICBjYWxsYmFjazogY2FsbGJhY2ssXG4gICAgICBjYW5jZWxsZWQ6IGZhbHNlXG4gICAgfSlcbiAgICByZXR1cm4gaWRcbiAgfVxuXG4gIGNhZiA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBxdWV1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgaWYocXVldWVbaV0uaGFuZGxlID09PSBoYW5kbGUpIHtcbiAgICAgICAgcXVldWVbaV0uY2FuY2VsbGVkID0gdHJ1ZVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuKSB7XG4gIC8vIFdyYXAgaW4gYSBuZXcgZnVuY3Rpb24gdG8gcHJldmVudFxuICAvLyBgY2FuY2VsYCBwb3RlbnRpYWxseSBiZWluZyBhc3NpZ25lZFxuICAvLyB0byB0aGUgbmF0aXZlIHJBRiBmdW5jdGlvblxuICByZXR1cm4gcmFmLmNhbGwoZ2xvYmFsLCBmbilcbn1cbm1vZHVsZS5leHBvcnRzLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xuICBjYWYuYXBwbHkoZ2xvYmFsLCBhcmd1bWVudHMpXG59XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vfi9yYWYvaW5kZXguanNcbiAqKiBtb2R1bGUgaWQgPSAzM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLypcclxuXHRNSVQgTGljZW5zZSBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxyXG5cdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuKi9cclxudmFyIHN0eWxlc0luRG9tID0ge30sXHJcblx0bWVtb2l6ZSA9IGZ1bmN0aW9uKGZuKSB7XHJcblx0XHR2YXIgbWVtbztcclxuXHRcdHJldHVybiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGlmICh0eXBlb2YgbWVtbyA9PT0gXCJ1bmRlZmluZWRcIikgbWVtbyA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdHJldHVybiBtZW1vO1xyXG5cdFx0fTtcclxuXHR9LFxyXG5cdGlzT2xkSUUgPSBtZW1vaXplKGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIC9tc2llIFs2LTldXFxiLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpO1xyXG5cdH0pLFxyXG5cdGdldEhlYWRFbGVtZW50ID0gbWVtb2l6ZShmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF07XHJcblx0fSksXHJcblx0c2luZ2xldG9uRWxlbWVudCA9IG51bGwsXHJcblx0c2luZ2xldG9uQ291bnRlciA9IDA7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGxpc3QsIG9wdGlvbnMpIHtcclxuXHRpZih0eXBlb2YgREVCVUcgIT09IFwidW5kZWZpbmVkXCIgJiYgREVCVUcpIHtcclxuXHRcdGlmKHR5cGVvZiBkb2N1bWVudCAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHN0eWxlLWxvYWRlciBjYW5ub3QgYmUgdXNlZCBpbiBhIG5vbi1icm93c2VyIGVudmlyb25tZW50XCIpO1xyXG5cdH1cclxuXHJcblx0b3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcblx0Ly8gRm9yY2Ugc2luZ2xlLXRhZyBzb2x1dGlvbiBvbiBJRTYtOSwgd2hpY2ggaGFzIGEgaGFyZCBsaW1pdCBvbiB0aGUgIyBvZiA8c3R5bGU+XHJcblx0Ly8gdGFncyBpdCB3aWxsIGFsbG93IG9uIGEgcGFnZVxyXG5cdGlmICh0eXBlb2Ygb3B0aW9ucy5zaW5nbGV0b24gPT09IFwidW5kZWZpbmVkXCIpIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xyXG5cclxuXHR2YXIgc3R5bGVzID0gbGlzdFRvU3R5bGVzKGxpc3QpO1xyXG5cdGFkZFN0eWxlc1RvRG9tKHN0eWxlcywgb3B0aW9ucyk7XHJcblxyXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGUobmV3TGlzdCkge1xyXG5cdFx0dmFyIG1heVJlbW92ZSA9IFtdO1xyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaXRlbSA9IHN0eWxlc1tpXTtcclxuXHRcdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XHJcblx0XHRcdGRvbVN0eWxlLnJlZnMtLTtcclxuXHRcdFx0bWF5UmVtb3ZlLnB1c2goZG9tU3R5bGUpO1xyXG5cdFx0fVxyXG5cdFx0aWYobmV3TGlzdCkge1xyXG5cdFx0XHR2YXIgbmV3U3R5bGVzID0gbGlzdFRvU3R5bGVzKG5ld0xpc3QpO1xyXG5cdFx0XHRhZGRTdHlsZXNUb0RvbShuZXdTdHlsZXMsIG9wdGlvbnMpO1xyXG5cdFx0fVxyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IG1heVJlbW92ZS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBtYXlSZW1vdmVbaV07XHJcblx0XHRcdGlmKGRvbVN0eWxlLnJlZnMgPT09IDApIHtcclxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspXHJcblx0XHRcdFx0XHRkb21TdHlsZS5wYXJ0c1tqXSgpO1xyXG5cdFx0XHRcdGRlbGV0ZSBzdHlsZXNJbkRvbVtkb21TdHlsZS5pZF07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpIHtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHR2YXIgaXRlbSA9IHN0eWxlc1tpXTtcclxuXHRcdHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdO1xyXG5cdFx0aWYoZG9tU3R5bGUpIHtcclxuXHRcdFx0ZG9tU3R5bGUucmVmcysrO1xyXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRkb21TdHlsZS5wYXJ0c1tqXShpdGVtLnBhcnRzW2pdKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IoOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdGRvbVN0eWxlLnBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSwgb3B0aW9ucykpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR2YXIgcGFydHMgPSBbXTtcclxuXHRcdFx0Zm9yKHZhciBqID0gMDsgaiA8IGl0ZW0ucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRzdHlsZXNJbkRvbVtpdGVtLmlkXSA9IHtpZDogaXRlbS5pZCwgcmVmczogMSwgcGFydHM6IHBhcnRzfTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGxpc3RUb1N0eWxlcyhsaXN0KSB7XHJcblx0dmFyIHN0eWxlcyA9IFtdO1xyXG5cdHZhciBuZXdTdHlsZXMgPSB7fTtcclxuXHRmb3IodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xyXG5cdFx0dmFyIGl0ZW0gPSBsaXN0W2ldO1xyXG5cdFx0dmFyIGlkID0gaXRlbVswXTtcclxuXHRcdHZhciBjc3MgPSBpdGVtWzFdO1xyXG5cdFx0dmFyIG1lZGlhID0gaXRlbVsyXTtcclxuXHRcdHZhciBzb3VyY2VNYXAgPSBpdGVtWzNdO1xyXG5cdFx0dmFyIHBhcnQgPSB7Y3NzOiBjc3MsIG1lZGlhOiBtZWRpYSwgc291cmNlTWFwOiBzb3VyY2VNYXB9O1xyXG5cdFx0aWYoIW5ld1N0eWxlc1tpZF0pXHJcblx0XHRcdHN0eWxlcy5wdXNoKG5ld1N0eWxlc1tpZF0gPSB7aWQ6IGlkLCBwYXJ0czogW3BhcnRdfSk7XHJcblx0XHRlbHNlXHJcblx0XHRcdG5ld1N0eWxlc1tpZF0ucGFydHMucHVzaChwYXJ0KTtcclxuXHR9XHJcblx0cmV0dXJuIHN0eWxlcztcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlU3R5bGVFbGVtZW50KCkge1xyXG5cdHZhciBzdHlsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XHJcblx0dmFyIGhlYWQgPSBnZXRIZWFkRWxlbWVudCgpO1xyXG5cdHN0eWxlRWxlbWVudC50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xyXG5cdGhlYWQuYXBwZW5kQ2hpbGQoc3R5bGVFbGVtZW50KTtcclxuXHRyZXR1cm4gc3R5bGVFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVMaW5rRWxlbWVudCgpIHtcclxuXHR2YXIgbGlua0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTtcclxuXHR2YXIgaGVhZCA9IGdldEhlYWRFbGVtZW50KCk7XHJcblx0bGlua0VsZW1lbnQucmVsID0gXCJzdHlsZXNoZWV0XCI7XHJcblx0aGVhZC5hcHBlbmRDaGlsZChsaW5rRWxlbWVudCk7XHJcblx0cmV0dXJuIGxpbmtFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBhZGRTdHlsZShvYmosIG9wdGlvbnMpIHtcclxuXHR2YXIgc3R5bGVFbGVtZW50LCB1cGRhdGUsIHJlbW92ZTtcclxuXHJcblx0aWYgKG9wdGlvbnMuc2luZ2xldG9uKSB7XHJcblx0XHR2YXIgc3R5bGVJbmRleCA9IHNpbmdsZXRvbkNvdW50ZXIrKztcclxuXHRcdHN0eWxlRWxlbWVudCA9IHNpbmdsZXRvbkVsZW1lbnQgfHwgKHNpbmdsZXRvbkVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQoKSk7XHJcblx0XHR1cGRhdGUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50LCBzdHlsZUluZGV4LCBmYWxzZSk7XHJcblx0XHRyZW1vdmUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50LCBzdHlsZUluZGV4LCB0cnVlKTtcclxuXHR9IGVsc2UgaWYob2JqLnNvdXJjZU1hcCAmJlxyXG5cdFx0dHlwZW9mIFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHR0eXBlb2YgVVJMLmNyZWF0ZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHR0eXBlb2YgVVJMLnJldm9rZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHR0eXBlb2YgQmxvYiA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHR0eXBlb2YgYnRvYSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcblx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVMaW5rRWxlbWVudCgpO1xyXG5cdFx0dXBkYXRlID0gdXBkYXRlTGluay5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50KTtcclxuXHRcdFx0aWYoc3R5bGVFbGVtZW50LmhyZWYpXHJcblx0XHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChzdHlsZUVsZW1lbnQuaHJlZik7XHJcblx0XHR9O1xyXG5cdH0gZWxzZSB7XHJcblx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQoKTtcclxuXHRcdHVwZGF0ZSA9IGFwcGx5VG9UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQpO1xyXG5cdFx0cmVtb3ZlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0dXBkYXRlKG9iaik7XHJcblxyXG5cdHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmopIHtcclxuXHRcdGlmKG5ld09iaikge1xyXG5cdFx0XHRpZihuZXdPYmouY3NzID09PSBvYmouY3NzICYmIG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmIG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXApXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR1cGRhdGUob2JqID0gbmV3T2JqKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJlbW92ZSgpO1xyXG5cdFx0fVxyXG5cdH07XHJcbn1cclxuXHJcbnZhciByZXBsYWNlVGV4dCA9IChmdW5jdGlvbiAoKSB7XHJcblx0dmFyIHRleHRTdG9yZSA9IFtdO1xyXG5cclxuXHRyZXR1cm4gZnVuY3Rpb24gKGluZGV4LCByZXBsYWNlbWVudCkge1xyXG5cdFx0dGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xyXG5cdFx0cmV0dXJuIHRleHRTdG9yZS5maWx0ZXIoQm9vbGVhbikuam9pbignXFxuJyk7XHJcblx0fTtcclxufSkoKTtcclxuXHJcbmZ1bmN0aW9uIGFwcGx5VG9TaW5nbGV0b25UYWcoc3R5bGVFbGVtZW50LCBpbmRleCwgcmVtb3ZlLCBvYmopIHtcclxuXHR2YXIgY3NzID0gcmVtb3ZlID8gXCJcIiA6IG9iai5jc3M7XHJcblxyXG5cdGlmIChzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xyXG5cdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR2YXIgY3NzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcyk7XHJcblx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlRWxlbWVudC5jaGlsZE5vZGVzO1xyXG5cdFx0aWYgKGNoaWxkTm9kZXNbaW5kZXhdKSBzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0aWYgKGNoaWxkTm9kZXMubGVuZ3RoKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudC5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGNzc05vZGUpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gYXBwbHlUb1RhZyhzdHlsZUVsZW1lbnQsIG9iaikge1xyXG5cdHZhciBjc3MgPSBvYmouY3NzO1xyXG5cdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcclxuXHR2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcclxuXHJcblx0aWYobWVkaWEpIHtcclxuXHRcdHN0eWxlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJtZWRpYVwiLCBtZWRpYSlcclxuXHR9XHJcblxyXG5cdGlmKHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0KSB7XHJcblx0XHRzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR3aGlsZShzdHlsZUVsZW1lbnQuZmlyc3RDaGlsZCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpO1xyXG5cdFx0fVxyXG5cdFx0c3R5bGVFbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcykpO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlTGluayhsaW5rRWxlbWVudCwgb2JqKSB7XHJcblx0dmFyIGNzcyA9IG9iai5jc3M7XHJcblx0dmFyIG1lZGlhID0gb2JqLm1lZGlhO1xyXG5cdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xyXG5cclxuXHRpZihzb3VyY2VNYXApIHtcclxuXHRcdC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzI2NjAzODc1XHJcblx0XHRjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArIFwiICovXCI7XHJcblx0fVxyXG5cclxuXHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3NdLCB7IHR5cGU6IFwidGV4dC9jc3NcIiB9KTtcclxuXHJcblx0dmFyIG9sZFNyYyA9IGxpbmtFbGVtZW50LmhyZWY7XHJcblxyXG5cdGxpbmtFbGVtZW50LmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xyXG5cclxuXHRpZihvbGRTcmMpXHJcblx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKG9sZFNyYyk7XHJcbn1cclxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vc3R5bGUtbG9hZGVyL2FkZFN0eWxlcy5qc1xuICoqIG1vZHVsZSBpZCA9IDM0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyBzdHlsZS1sb2FkZXI6IEFkZHMgc29tZSBjc3MgdG8gdGhlIERPTSBieSBhZGRpbmcgYSA8c3R5bGU+IHRhZ1xuXG4vLyBsb2FkIHRoZSBzdHlsZXNcbnZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuLy4uLy4uL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzP2Jyb3dzZXJzPWxhc3QgMiB2ZXJzaW9uIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2luZGV4LmpzIS4vbWFpbi5zY3NzXCIpO1xuaWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4vLyBhZGQgdGhlIHN0eWxlcyB0byB0aGUgRE9NXG52YXIgdXBkYXRlID0gcmVxdWlyZShcIiEuLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvYWRkU3R5bGVzLmpzXCIpKGNvbnRlbnQsIHt9KTtcbmlmKGNvbnRlbnQubG9jYWxzKSBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzO1xuLy8gSG90IE1vZHVsZSBSZXBsYWNlbWVudFxuaWYobW9kdWxlLmhvdCkge1xuXHQvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFnc1xuXHRpZighY29udGVudC5sb2NhbHMpIHtcblx0XHRtb2R1bGUuaG90LmFjY2VwdChcIiEhLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcyEuLy4uLy4uL25vZGVfbW9kdWxlcy9hdXRvcHJlZml4ZXItbG9hZGVyL2luZGV4LmpzP2Jyb3dzZXJzPWxhc3QgMiB2ZXJzaW9uIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3Nhc3MtbG9hZGVyL2luZGV4LmpzIS4vbWFpbi5zY3NzXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2F1dG9wcmVmaXhlci1sb2FkZXIvaW5kZXguanM/YnJvd3NlcnM9bGFzdCAyIHZlcnNpb24hLi8uLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhLi9tYWluLnNjc3NcIik7XG5cdFx0XHRpZih0eXBlb2YgbmV3Q29udGVudCA9PT0gJ3N0cmluZycpIG5ld0NvbnRlbnQgPSBbW21vZHVsZS5pZCwgbmV3Q29udGVudCwgJyddXTtcblx0XHRcdHVwZGF0ZShuZXdDb250ZW50KTtcblx0XHR9KTtcblx0fVxuXHQvLyBXaGVuIHRoZSBtb2R1bGUgaXMgZGlzcG9zZWQsIHJlbW92ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvc3R5bGUvbWFpbi5zY3NzXG4gKiogbW9kdWxlIGlkID0gMzVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHZpZXdCb3g9XFxcIjAgMCAyNjgxIDgxNFxcXCIgdmVyc2lvbj1cXFwiMS4xXFxcIiB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHhtbG5zOnhsaW5rPVxcXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXFxcIiB4bWxuczpza2V0Y2g9XFxcImh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9uc1xcXCI+PHRpdGxlPkNsaW1iIExvZ28gQmV0YTwvdGl0bGU+PGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+PGRlZnM+PC9kZWZzPjxnIGlkPVxcXCJQYWdlLTFcXFwiIHN0cm9rZT1cXFwibm9uZVxcXCIgc3Ryb2tlLXdpZHRoPVxcXCIxXFxcIiBmaWxsPVxcXCJub25lXFxcIiBmaWxsLXJ1bGU9XFxcImV2ZW5vZGRcXFwiIHNrZXRjaDp0eXBlPVxcXCJNU1BhZ2VcXFwiPjxnIGlkPVxcXCJDbGltYi1Mb2dvLUJldGFcXFwiIHNrZXRjaDp0eXBlPVxcXCJNU0FydGJvYXJkR3JvdXBcXFwiIGZpbGw9XFxcIiMxOTM3NERcXFwiPjxnIGlkPVxcXCJjbGktLS0tYi5zb2NpYWwtKy1QYXRoLUNvcHktKy1UeXBlLXNvbWV0aGluZy1Db3B5LUNvcHktQ29weS1Db3B5LUNvcHlcXFwiIHNrZXRjaDp0eXBlPVxcXCJNU0xheWVyR3JvdXBcXFwiIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDIwNi4wMDAwMDAsIDI0OS4wMDAwMDApXFxcIj48ZyBpZD1cXFwiY2xpLS0tLWIuc29jaWFsLSstUGF0aC1Db3B5XFxcIiBza2V0Y2g6dHlwZT1cXFwiTVNTaGFwZUdyb3VwXFxcIj48cGF0aCBkPVxcXCJNNzIzLjM3NDIwNywxODcuNDQyMjExIEw3NjcuMDI3NjQxLDMzNy4zODM1NzUgQzc2Ny41MTA4ODksMzQxLjI2NTU1MiA3NzEuODYwMTI0LDM0NS4xNDc1MjkgNzc2LjIwOTM1OSwzNDUuMTQ3NTI5IEw4MzMuMjMyNjY0LDM0NS4xNDc1MjkgQzgzOS4wMzE2NDQsMzQ1LjE0NzUyOSA4NDMuMzgwODc5LDM0MC43ODAzMDUgODQyLjQxNDM4MywzMzQuNDcyMDkyIEw3MzkuNDgyNDg1LDguMzg2MDE5ODIgQzczOC45OTkyMzcsNC4wMTg3OTU2NCA3MzQuNjUwMDAyLDAuNjIyMDY1NzI4IDczMC43ODQwMTUsMC42MjIwNjU3MjggTDcyMy4wNTIwNDEsMC42MjIwNjU3MjggQzcyMC42MzU4LDAuNjIyMDY1NzI4IDcxNi4yODY1NjUsMi41NjMwNTQyNSA3MTQuODM2ODIsNS40NzQ1MzcwNCBMNjQzLjUxNDMwMiwyMDkuMDE5MDYyIEw1NzYuNDk0MDAzLDEwNS40MzE3ODggQzU3My43MjEwNTgsMTAxLjE0NTg5NSA1NjcuMzQyNTM5LDk3LjY3MTQ5MTkgNTYyLjI1NTYsOTcuNjcxNDkxOSBMNTUyLjE3OTAzMyw5Ny42NzE0OTE5IEM1NDcuMDg4MzI2LDk3LjY3MTQ5MTkgNTQxLjUyOTM4NCwxMDEuNTU4NzQ5IDUzOS43NzAwNjEsMTA2LjMzNDE4NyBMNDU0Ljk4MDA2OCwzMzYuNDg0ODMzIEM0NTMuMjE3NDksMzQxLjI2OTEwOCA0NTUuOTI3MDg2LDM0NS4xNDc1MjkgNDYxLjAxNDEwMiwzNDUuMTQ3NTI5IEw1MjIuMTM4MDY3LDM0NS4xNDc1MjkgQzUyNy4yMzMxNSwzNDUuMTQ3NTI5IDUzMi43OTEwNTQsMzQxLjI2MTczMyA1MzQuNTUyNzk3LDMzNi40NjYxNzEgTDU3MS40NzMxNDQsMjM1Ljk2NjkyNCBMNjQyLjEwODUyOCwzNDYuMTA3NzEyIEM2NDMuNDg3MTQxLDM0OC4yNTczNjMgNjQ2LjY2NzA5MiwzNTAgNjQ5LjIxMjMwNywzNTAgTDY1OS45NzE0MTIsMzUwIEM2NjIuNTE2MTA4LDM1MCA2NjUuMjgyMDQ0LDM0OC4wNDUwNzggNjY2LjE0MTk4MiwzNDUuNjUzOTE4IEw2ODMuODI3MjYxLDI5Ni40Nzc4NzIgTDcyMy4zNzQyMDcsMTg3LjQ0MjIxMSBaXFxcIiBpZD1cXFwiUGF0aC1Db3B5XFxcIj48L3BhdGg+PHBhdGggZD1cXFwiTTAuMTQ1MjEzNDQxLDI0Ny4wODUxMDEgQzAuMTQ1MjEzNDQxLDMwNS4yMzQwNCA0OS4wODcyMzc3LDM0OC44NDU3NDUgMTA0LjMyODczLDM0OC44NDU3NDUgQzEzOS4yMTgwOTQsMzQ4Ljg0NTc0NSAxNjQuNDE1OTY4LDMzNS4yNzc2NTkgMTgyLjM0NTIyNCwzMDguMTQxNDg3IEMxODUuNzM3MjQ2LDMwMy4yOTU3NDIgMTgzLjMxNDM3MywyOTguNDQ5OTk3IDE3OC45NTMyMDMsMjk0LjU3MzQwMSBMMTQ5Ljg3ODczMywyNjkuMzc1NTI3IEMxNDYuOTcxMjg2LDI2Ni45NTI2NTUgMTQyLjYxMDExNiwyNjcuOTIxODA0IDEzOS4yMTgwOTQsMjcxLjMxMzgyNSBDMTMxLjQ2NDkwMiwyNzkuMDY3MDE3IDEyMy4yMjcxMzYsMjg2LjMzNTYzNSAxMDYuMjY3MDI4LDI4Ni4zMzU2MzUgQzg0Ljk0NTc1MDUsMjg2LjMzNTYzNSA2OC40NzAyMTc2LDI2OC44OTA5NTMgNjguNDcwMjE3NiwyNDcuMDg1MTAxIEM2OC40NzAyMTc2LDIyNS43NjM4MjMgODUuOTE0ODk5NSwyMDcuODM0NTY2IDEwNy4yMzYxNzcsMjA3LjgzNDU2NiBDMTE4LjM4MTM5MSwyMDcuODM0NTY2IDEyOC41NTc0NTUsMjEzLjE2NDg4NiAxMzUuMzQxNDk4LDIyMC40MzM1MDMgQzEzNy43NjQzNzEsMjIyLjg1NjM3NiAxNDMuNTc5MjY1LDIyMy44MjU1MjUgMTQ2LjAwMjEzNywyMjEuNDAyNjUyIEwxNzUuMDc2NjA3LDE5My43ODE5MDYgQzE3OS40Mzc3NzcsMTg5LjkwNTMxIDE4MC44OTE1MDEsMTg0LjU3NDk5IDE3Ny40OTk0OCwxODAuMjEzODIgQzE1OS4wODU2NDksMTU3LjkyMzM5MyAxMzUuMzQxNDk4LDE0NS4zMjQ0NTYgMTA0LjgxMzMwNSwxNDUuMzI0NDU2IEM0OS41NzE4MTIyLDE0NS4zMjQ0NTYgMC4xNDUyMTM0NDEsMTg5LjkwNTMxIDAuMTQ1MjEzNDQxLDI0Ny4wODUxMDEgTDAuMTQ1MjEzNDQxLDI0Ny4wODUxMDEgWiBNMjE4LjY4ODMxMiwzMzQuNzkzMDg1IEMyMTguNjg4MzEyLDMzOS42Mzg4MyAyMjMuMDQ5NDgyLDM0NCAyMjcuODk1MjI3LDM0NCBMMjgxLjE5ODQyMiwzNDQgQzI4Ni4wNDQxNjcsMzQ0IDI5MC40MDUzMzcsMzM5LjYzODgzIDI5MC40MDUzMzcsMzM0Ljc5MzA4NSBMMjkwLjQwNTMzNywxNC4wMDQ3NjcyIEMyOTAuNDA1MzM3LDkuMTU5MDIyMjYgMjg2LjA0NDE2Nyw0Ljc5Nzg1MTc5IDI4MS4xOTg0MjIsNC43OTc4NTE3OSBMMjI3Ljg5NTIyNyw0Ljc5Nzg1MTc5IEMyMjMuMDQ5NDgyLDQuNzk3ODUxNzkgMjE4LjY4ODMxMiw5LjE1OTAyMjI2IDIxOC42ODgzMTIsMTQuMDA0NzY3MiBMMjE4LjY4ODMxMiwzMzQuNzkzMDg1IFogTTM3OC4xMTMzMjEsOTEuNTM2Njg2OCBDMzk5LjQzNDU5OSw5MS41MzY2ODY4IDQxNi44NzkyODEsNzQuNTc2NTc5NCA0MTYuODc5MjgxLDUzLjI1NTMwMTUgQzQxNi44NzkyODEsMzEuOTM0MDIzNiAzOTkuNDM0NTk5LDE0LjQ4OTM0MTcgMzc4LjExMzMyMSwxNC40ODkzNDE3IEMzNTYuNzkyMDQ0LDE0LjQ4OTM0MTcgMzM5LjgzMTkzNiwzMS45MzQwMjM2IDMzOS44MzE5MzYsNTMuMjU1MzAxNSBDMzM5LjgzMTkzNiw3NC41NzY1Nzk0IDM1Ni43OTIwNDQsOTEuNTM2Njg2OCAzNzguMTEzMzIxLDkxLjUzNjY4NjggTDM3OC4xMTMzMjEsOTEuNTM2Njg2OCBaIE0zNDIuNzM5MzgzLDMzNC43OTMwODUgQzM0Mi43MzkzODMsMzM5LjYzODgzIDM0Ny4xMDA1NTQsMzQ0IDM1MS45NDYyOTksMzQ0IEw0MDUuMjQ5NDkzLDM0NCBDNDEwLjA5NTIzOCwzNDQgNDE0LjQ1NjQwOSwzMzkuNjM4ODMgNDE0LjQ1NjQwOSwzMzQuNzkzMDg1IEw0MTQuNDU2NDA5LDE1OS4zNzcxMTYgQzQxNC40NTY0MDksMTU0LjA0Njc5NyA0MTAuMDk1MjM4LDE1MC4xNzAyMDEgNDA1LjI0OTQ5MywxNTAuMTcwMjAxIEwzNTEuOTQ2Mjk5LDE1MC4xNzAyMDEgQzM0Ny4xMDA1NTQsMTUwLjE3MDIwMSAzNDIuNzM5MzgzLDE1NC4wNDY3OTcgMzQyLjczOTM4MywxNTkuMzc3MTE2IEwzNDIuNzM5MzgzLDMzNC43OTMwODUgWiBNODg5LjE1NDMxLDMzNC43OTMwODUgQzg4OS4xNTQzMSwzMzkuNjM4ODMgODkzLjUxNTQ4MSwzNDQgODk4LjM2MTIyNiwzNDQgTDkyMS4xMzYyMjcsMzQ0IEM5MjUuOTgxOTcyLDM0NCA5MjkuMzczOTk0LDMzOS42Mzg4MyA5MzEuMzEyMjkyLDMzNC4zMDg1MSBMOTM3LjEyNzE4NSwzMTguMzE3NTUyIEM5MzcuMTI3MTg1LDMxOC4zMTc1NTIgOTU5LjQxNzYxMiwzNDguODQ1NzQ1IDEwMDIuMDYwMTcsMzQ4Ljg0NTc0NSBDMTA1Ni44MTcwOSwzNDguODQ1NzQ1IDEwOTguMDA1OTIsMzAyLjgxMTE2OCAxMDk4LjAwNTkyLDI0Ny4wODUxMDEgQzEwOTguMDA1OTIsMTc4Ljc2MDA5NiAxMDUzLjQyNTA2LDE0NS4zMjQ0NTYgMTAwMS41NzU1OSwxNDUuMzI0NDU2IEM5ODUuMTAwMDYxLDE0NS4zMjQ0NTYgOTY3LjE3MDgwNCwxNTEuMTM5MzUgOTYxLjM1NTkxLDE1NC41MzEzNzEgTDk2MS4zNTU5MSwxNC4wMDQ3NjcyIEM5NjEuMzU1OTEsOS4xNTkwMjIyNiA5NTYuOTk0NzQsNC43OTc4NTE3OSA5NTIuMTQ4OTk1LDQuNzk3ODUxNzkgTDg5OC4zNjEyMjYsNC43OTc4NTE3OSBDODkzLjUxNTQ4MSw0Ljc5Nzg1MTc5IDg4OS4xNTQzMSw5LjE1OTAyMjI2IDg4OS4xNTQzMSwxNC4wMDQ3NjcyIEw4ODkuMTU0MzEsMzM0Ljc5MzA4NSBaIE05NTMuNjAyNzE4LDI0Ni42MDA1MjYgQzk1My42MDI3MTgsMjI0Ljc5NDY3NCA5NzAuMDc4MjUxLDIwNy44MzQ1NjYgOTkyLjM2ODY3OCwyMDcuODM0NTY2IEMxMDE0LjY1OTExLDIwNy44MzQ1NjYgMTAzMS42MTkyMSwyMjQuNzk0Njc0IDEwMzEuNjE5MjEsMjQ2LjYwMDUyNiBDMTAzMS42MTkyMSwyNjguODkwOTUzIDEwMTQuNjU5MTEsMjg2LjMzNTYzNSA5OTIuMzY4Njc4LDI4Ni4zMzU2MzUgQzk3MC4wNzgyNTEsMjg2LjMzNTYzNSA5NTMuNjAyNzE4LDI2OC44OTA5NTMgOTUzLjYwMjcxOCwyNDYuNjAwNTI2IEw5NTMuNjAyNzE4LDI0Ni42MDA1MjYgWiBNMTEzNC4yNTY0NSwzMjEuMjI0OTk5IEMxMTM0LjI1NjQ1LDMzNi4yNDY4MDggMTE0Ni44NTUzOSwzNDguODQ1NzQ1IDExNjEuODc3MiwzNDguODQ1NzQ1IEMxMTc3LjM4MzU4LDM0OC44NDU3NDUgMTE4OS40OTc5NSwzMzYuMjQ2ODA4IDExODkuNDk3OTUsMzIxLjIyNDk5OSBDMTE4OS40OTc5NSwzMDUuNzE4NjE1IDExNzcuMzgzNTgsMjkzLjYwNDI1MiAxMTYxLjg3NzIsMjkzLjYwNDI1MiBDMTE0Ni44NTUzOSwyOTMuNjA0MjUyIDExMzQuMjU2NDUsMzA1LjcxODYxNSAxMTM0LjI1NjQ1LDMyMS4yMjQ5OTkgTDExMzQuMjU2NDUsMzIxLjIyNDk5OSBaIE0xMjM2LjAxNzEsMzMyLjg1NDc4NyBDMTI0NS43MDg1OSwzNDAuNjA3OTc5IDEyNjkuOTM3MzEsMzQ4Ljg0NTc0NSAxMzAxLjkxOTIzLDM0OC44NDU3NDUgQzEzNTYuNjc2MTUsMzQ4Ljg0NTc0NSAxMzgzLjgxMjMyLDMyMS4yMjQ5OTkgMTM4My44MTIzMiwyODcuMzA0Nzg0IEMxMzgzLjgxMjMyLDI0OC41Mzg4MjQgMTM1Ni42NzYxNSwyMzMuMDMyNDQgMTMxNy40MjU2MSwyMTkuNDY0MzU0IEMxMzAwLjk1MDA4LDIxMy42NDk0NiAxMjk1LjYxOTc2LDIwOC44MDM3MTUgMTI5NS42MTk3NiwyMDMuOTU3OTcgQzEyOTUuNjE5NzYsMTk4LjYyNzY1MSAxMjk5Ljk4MDkzLDE5Ny4xNzM5MjcgMTMwNi4yODA0LDE5Ny4xNzM5MjcgQzEzMjUuMTc4OCwxOTcuMTczOTI3IDEzNDcuNDY5MjMsMjA4LjMxOTE0MSAxMzQ3LjQ2OTIzLDIwOC4zMTkxNDEgQzEzNTEuMzQ1ODMsMjA5Ljc3Mjg2NCAxMzU2LjE5MTU3LDIwOC4zMTkxNDEgMTM1Ny42NDUzLDIwNS40MTE2OTQgTDEzNzUuNTc0NTUsMTcyLjQ2MDYyOCBDMTM3OC40ODIsMTY3LjYxNDg4MyAxMzc1LjA4OTk4LDE2My4yNTM3MTIgMTM3MC43Mjg4MSwxNjAuMzQ2MjY1IEMxMzYwLjA2ODE3LDE1My41NjIyMjMgMTMzNi44MDg1OSwxNDUuMzI0NDU2IDEzMDYuMjgwNCwxNDUuMzI0NDU2IEMxMjUzLjk0NjM1LDE0NS4zMjQ0NTYgMTIzMC42ODY3OCwxNzEuNDkxNDc5IDEyMzAuNjg2NzgsMjAzLjk1Nzk3IEMxMjMwLjY4Njc4LDIzNC4wMDE1ODkgMTI0Ny4xNjIzMSwyNTUuODA3NDQxIDEyODQuOTU5MTIsMjY4Ljg5MDk1MyBDMTMwOS42NzI0MiwyNzcuNjEzMjk0IDEzMTIuNTc5ODcsMjg0LjM5NzMzNyAxMzEyLjU3OTg3LDI4OS4yNDMwODIgQzEzMTIuNTc5ODcsMjk1LjA1Nzk3NiAxMzA4LjIxODcsMjk3Ljk2NTQyMyAxMzAzLjM3Mjk1LDI5Ny45NjU0MjMgQzEyODIuNTM2MjUsMjk3Ljk2NTQyMyAxMjU5Ljc2MTI1LDI4NS4zNjY0ODYgMTI1OS43NjEyNSwyODUuMzY2NDg2IEMxMjU1Ljg4NDY1LDI4My40MjgxODggMTI1MS4wMzg5MSwyODYuMzM1NjM1IDEyNDkuNTg1MTgsMjg5LjI0MzA4MiBMMTIzMi42MjUwOCwzMjIuNjc4NzIyIEMxMjMwLjIwMjIsMzI3LjAzOTg5MyAxMjMyLjYyNTA4LDMyOS45NDczNCAxMjM2LjAxNzEsMzMyLjg1NDc4NyBMMTIzNi4wMTcxLDMzMi44NTQ3ODcgWiBNMTQwNy41NTY0NywyNDYuNjAwNTI2IEMxNDA3LjU1NjQ3LDMwMi4zMjY1OTMgMTQ1My4xMDY0NywzNDguODQ1NzQ1IDE1MDguMzQ3OTYsMzQ4Ljg0NTc0NSBDMTU2My41ODk0NiwzNDguODQ1NzQ1IDE2MDkuMTM5NDYsMzAyLjMyNjU5MyAxNjA5LjEzOTQ2LDI0Ni42MDA1MjYgQzE2MDkuMTM5NDYsMTkxLjg0MzYwOCAxNTYzLjU4OTQ2LDE0NS4zMjQ0NTYgMTUwOC4zNDc5NiwxNDUuMzI0NDU2IEMxNDUzLjEwNjQ3LDE0NS4zMjQ0NTYgMTQwNy41NTY0NywxOTEuODQzNjA4IDE0MDcuNTU2NDcsMjQ2LjYwMDUyNiBMMTQwNy41NTY0NywyNDYuNjAwNTI2IFogTTE0NzAuMDY2NTgsMjQ2LjYwMDUyNiBDMTQ3MC4wNjY1OCwyMjUuMjc5MjQ4IDE0ODcuMDI2NjksMjA3LjgzNDU2NiAxNTA4LjM0Nzk2LDIwNy44MzQ1NjYgQzE1MjkuNjY5MjQsMjA3LjgzNDU2NiAxNTQ2LjYyOTM1LDIyNS4yNzkyNDggMTU0Ni42MjkzNSwyNDYuNjAwNTI2IEMxNTQ2LjYyOTM1LDI2OC40MDYzNzggMTUyOS42NjkyNCwyODYuMzM1NjM1IDE1MDguMzQ3OTYsMjg2LjMzNTYzNSBDMTQ4Ny4wMjY2OSwyODYuMzM1NjM1IDE0NzAuMDY2NTgsMjY4LjQwNjM3OCAxNDcwLjA2NjU4LDI0Ni42MDA1MjYgTDE0NzAuMDY2NTgsMjQ2LjYwMDUyNiBaIE0xNjMxLjQyOTg5LDI0Ny4wODUxMDEgQzE2MzEuNDI5ODksMzA1LjIzNDA0IDE2ODAuMzcxOTEsMzQ4Ljg0NTc0NSAxNzM1LjYxMzQsMzQ4Ljg0NTc0NSBDMTc3MC41MDI3NywzNDguODQ1NzQ1IDE3OTUuNzAwNjQsMzM1LjI3NzY1OSAxODEzLjYyOTksMzA4LjE0MTQ4NyBDMTgxNy4wMjE5MiwzMDMuMjk1NzQyIDE4MTQuNTk5MDUsMjk4LjQ0OTk5NyAxODEwLjIzNzg4LDI5NC41NzM0MDEgTDE3ODEuMTYzNDEsMjY5LjM3NTUyNyBDMTc3OC4yNTU5NiwyNjYuOTUyNjU1IDE3NzMuODk0NzksMjY3LjkyMTgwNCAxNzcwLjUwMjc3LDI3MS4zMTM4MjUgQzE3NjIuNzQ5NTgsMjc5LjA2NzAxNyAxNzU0LjUxMTgxLDI4Ni4zMzU2MzUgMTczNy41NTE3LDI4Ni4zMzU2MzUgQzE3MTYuMjMwNDIsMjg2LjMzNTYzNSAxNjk5Ljc1NDg5LDI2OC44OTA5NTMgMTY5OS43NTQ4OSwyNDcuMDg1MTAxIEMxNjk5Ljc1NDg5LDIyNS43NjM4MjMgMTcxNy4xOTk1NywyMDcuODM0NTY2IDE3MzguNTIwODUsMjA3LjgzNDU2NiBDMTc0OS42NjYwNiwyMDcuODM0NTY2IDE3NTkuODQyMTMsMjEzLjE2NDg4NiAxNzY2LjYyNjE3LDIyMC40MzM1MDMgQzE3NjkuMDQ5MDQsMjIyLjg1NjM3NiAxNzc0Ljg2Mzk0LDIyMy44MjU1MjUgMTc3Ny4yODY4MSwyMjEuNDAyNjUyIEwxODA2LjM2MTI4LDE5My43ODE5MDYgQzE4MTAuNzIyNDUsMTg5LjkwNTMxIDE4MTIuMTc2MTcsMTg0LjU3NDk5IDE4MDguNzg0MTUsMTgwLjIxMzgyIEMxNzkwLjM3MDMyLDE1Ny45MjMzOTMgMTc2Ni42MjYxNywxNDUuMzI0NDU2IDE3MzYuMDk3OTgsMTQ1LjMyNDQ1NiBDMTY4MC44NTY0OSwxNDUuMzI0NDU2IDE2MzEuNDI5ODksMTg5LjkwNTMxIDE2MzEuNDI5ODksMjQ3LjA4NTEwMSBMMTYzMS40Mjk4OSwyNDcuMDg1MTAxIFogTTE4ODUuMzQ2OTIsOTEuNTM2Njg2OCBDMTkwNi42NjgyLDkxLjUzNjY4NjggMTkyNC4xMTI4OCw3NC41NzY1Nzk0IDE5MjQuMTEyODgsNTMuMjU1MzAxNSBDMTkyNC4xMTI4OCwzMS45MzQwMjM2IDE5MDYuNjY4MiwxNC40ODkzNDE3IDE4ODUuMzQ2OTIsMTQuNDg5MzQxNyBDMTg2NC4wMjU2NSwxNC40ODkzNDE3IDE4NDcuMDY1NTQsMzEuOTM0MDIzNiAxODQ3LjA2NTU0LDUzLjI1NTMwMTUgQzE4NDcuMDY1NTQsNzQuNTc2NTc5NCAxODY0LjAyNTY1LDkxLjUzNjY4NjggMTg4NS4zNDY5Miw5MS41MzY2ODY4IEwxODg1LjM0NjkyLDkxLjUzNjY4NjggWiBNMTg0OS45NzI5OSwzMzQuNzkzMDg1IEMxODQ5Ljk3Mjk5LDMzOS42Mzg4MyAxODU0LjMzNDE2LDM0NCAxODU5LjE3OTksMzQ0IEwxOTEyLjQ4MzEsMzQ0IEMxOTE3LjMyODg0LDM0NCAxOTIxLjY5MDAxLDMzOS42Mzg4MyAxOTIxLjY5MDAxLDMzNC43OTMwODUgTDE5MjEuNjkwMDEsMTU5LjM3NzExNiBDMTkyMS42OTAwMSwxNTQuMDQ2Nzk3IDE5MTcuMzI4ODQsMTUwLjE3MDIwMSAxOTEyLjQ4MzEsMTUwLjE3MDIwMSBMMTg1OS4xNzk5LDE1MC4xNzAyMDEgQzE4NTQuMzM0MTYsMTUwLjE3MDIwMSAxODQ5Ljk3Mjk5LDE1NC4wNDY3OTcgMTg0OS45NzI5OSwxNTkuMzc3MTE2IEwxODQ5Ljk3Mjk5LDMzNC43OTMwODUgWiBNMTk2MC45NDA1NSwyODQuODgxOTExIEMxOTYwLjk0MDU1LDMyMy4xNjMyOTcgMTk4OS41MzA0NCwzNDguODQ1NzQ1IDIwMjcuODExODMsMzQ4Ljg0NTc0NSBDMjA1OC4zNDAwMiwzNDguODQ1NzQ1IDIwNzUuMzAwMTMsMzM0Ljc5MzA4NSAyMDg2LjQ0NTM0LDMyNC42MTcwMiBMMjA5My4yMjkzOCwzMzcuNzAwNTMyIEMyMDk1LjY1MjI2LDM0My4wMzA4NTEgMjA5OS4wNDQyOCwzNDQgMjEwMS45NTE3MiwzNDQgTDIxMjMuMjczLDM0NCBDMjEyOC4xMTg3NSwzNDQgMjEzMi40Nzk5MiwzMzkuNjM4ODMgMjEzMi40Nzk5MiwzMzQuNzkzMDg1IEwyMTMyLjQ3OTkyLDIyNy43MDIxMjEgQzIxMzIuNDc5OTIsMTcwLjUyMjMzIDIxMTAuNjc0MDcsMTQ1LjMyNDQ1NiAyMDUwLjU4NjgzLDE0NS4zMjQ0NTYgQzIwMjQuNDE5OCwxNDUuMzI0NDU2IDE5OTAuNDk5NTksMTUxLjEzOTM1IDE5ODYuMTM4NDIsMTUyLjU5MzA3NCBDMTk4MS43NzcyNSwxNTQuMDQ2Nzk3IDE5NzcuNDE2MDgsMTU3LjQzODgxOCAxOTc4Ljg2OTgsMTY1LjY3NjU4NSBMMTk4My4yMzA5NywxOTYuMjA0Nzc4IEMxOTg0LjIwMDEyLDIwMy40NzMzOTYgMTk4Ny41OTIxNCwyMDguODAzNzE1IDE5OTQuODYwNzYsMjA2LjM4MDg0MyBDMjAwNy40NTk3LDIwMi41MDQyNDcgMjAzMC4yMzQ3LDE5OS4xMTIyMjUgMjA0My4zMTgyMSwxOTkuMTEyMjI1IEMyMDY2LjU3Nzc5LDE5OS4xMTIyMjUgMjA2OS40ODUyMywyMDguODAzNzE1IDIwNjkuNDg1MjMsMjI3LjcwMjEyMSBDMjA2OS40ODUyMywyMjcuNzAyMTIxIDIwNTMuOTc4ODUsMjE5Ljk0ODkyOSAyMDMyLjE3MywyMTkuOTQ4OTI5IEMxOTg4LjA3NjcyLDIxOS45NDg5MjkgMTk2MC45NDA1NSwyNDcuNTY5Njc1IDE5NjAuOTQwNTUsMjg0Ljg4MTkxMSBMMTk2MC45NDA1NSwyODQuODgxOTExIFogTTIwMjMuOTM1MjMsMjgwLjAzNjE2NiBDMjAyMy45MzUyMywyNjguODkwOTUzIDIwMzMuMTQyMTUsMjU5LjY4NDAzNyAyMDQ0Ljc3MTkzLDI1OS42ODQwMzcgQzIwNTYuNDAxNzIsMjU5LjY4NDAzNyAyMDY1LjYwODY0LDI2OC44OTA5NTMgMjA2Ni4wOTMyMSwyODAuMDM2MTY2IEMyMDY2LjA5MzIxLDI5MS42NjU5NTQgMjA1Ni40MDE3MiwzMDEuMzU3NDQ0IDIwNDQuNzcxOTMsMzAxLjM1NzQ0NCBDMjAzMy4xNDIxNSwzMDEuMzU3NDQ0IDIwMjMuOTM1MjMsMjkxLjY2NTk1NCAyMDIzLjkzNTIzLDI4MC4wMzYxNjYgTDIwMjMuOTM1MjMsMjgwLjAzNjE2NiBaIE0yMTgxLjkwNjUyLDMzNC43OTMwODUgQzIxODEuOTA2NTIsMzM5LjYzODgzIDIxODYuMjY3NjksMzQ0IDIxOTEuMTEzNDMsMzQ0IEwyMjQ0LjQxNjYzLDM0NCBDMjI0OS4yNjIzNywzNDQgMjI1My42MjM1NCwzMzkuNjM4ODMgMjI1My42MjM1NCwzMzQuNzkzMDg1IEwyMjUzLjYyMzU0LDE0LjAwNDc2NzIgQzIyNTMuNjIzNTQsOS4xNTkwMjIyNiAyMjQ5LjI2MjM3LDQuNzk3ODUxNzkgMjI0NC40MTY2Myw0Ljc5Nzg1MTc5IEwyMTkxLjExMzQzLDQuNzk3ODUxNzkgQzIxODYuMjY3NjksNC43OTc4NTE3OSAyMTgxLjkwNjUyLDkuMTU5MDIyMjYgMjE4MS45MDY1MiwxNC4wMDQ3NjcyIEwyMTgxLjkwNjUyLDMzNC43OTMwODUgWlxcXCIgaWQ9XFxcImNsaS0tLS1iLnNvY2lhbFxcXCI+PC9wYXRoPjwvZz48L2c+PC9nPjwvZz48L3N2Zz5cIlxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9zcmMvaW1nL2NsaW1iX2xvZ28uc3ZnXG4gKiogbW9kdWxlIGlkID0gMzZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obW9kdWxlKSB7XHJcblx0aWYoIW1vZHVsZS53ZWJwYWNrUG9seWZpbGwpIHtcclxuXHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0bW9kdWxlLnBhdGhzID0gW107XHJcblx0XHQvLyBtb2R1bGUucGFyZW50ID0gdW5kZWZpbmVkIGJ5IGRlZmF1bHRcclxuXHRcdG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn1cclxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAod2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanNcbiAqKiBtb2R1bGUgaWQgPSAzN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzM4X187XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCBcIlJlYWN0RE9NXCJcbiAqKiBtb2R1bGUgaWQgPSAzOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==