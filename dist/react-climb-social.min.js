!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("ReactDOM")):"function"==typeof define&&define.amd?define(["react","ReactDOM"],e):"object"==typeof exports?exports["react-climb-social"]=e(require("react"),require("ReactDOM")):t["react-climb-social"]=e(t.React,t.ReactDOM)}(this,function(t,e){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="/",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),o=r(i),s=n(39),u=r(s),c=n(17),a=r(c),l=n(14),p=r(l);if(n(36),window){window.Climb=window.Climb||{};for(var h=document.querySelectorAll(".climb-wall"),f=0;f<h.length;++f){var d=h[f],v=d.dataset.collectionId,b=d.dataset.limit;u["default"].render(o["default"].createElement(a["default"],{collectionId:v,limit:b}),d)}for(var y=document.querySelectorAll(".climb-slideshow"),f=0;f<y.length;++f){var d=y[f],v=d.dataset.collectionId,m=parseInt(d.dataset.delay,0);u["default"].render(o["default"].createElement(p["default"],{collectionId:v,delay:m}),d)}}e.WallContainer=a["default"];var _=n(7);Object.defineProperty(e,"Wall",{enumerable:!0,get:function(){return _.Wall}});var g=n(6);Object.defineProperty(e,"Tile",{enumerable:!0,get:function(){return g.Tile}})},function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=n(1),o=r(i),s=n(23),u=r(s),c=n(28),a=r(c),l=u["default"](o["default"]),p=l.Spring,h=l.TransitionSpring,f=l.Motion,d=l.StaggeredMotion,v=l.TransitionMotion;e.Spring=p,e.TransitionSpring=h,e.Motion=f,e.StaggeredMotion=d,e.TransitionMotion=v;var b=n(29),y=r(b);e.spring=y["default"];var m=n(9),_=r(m);e.presets=_["default"];var g={reorderKeys:a["default"]};e.utils=g},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"render",value:function(){return a["default"].createElement("a",{className:"climb__author",href:this.props.link},a["default"].createElement("img",{height:"34",width:"34",src:this.props.picture,alt:"Profile pic of "+this.props.name}),a["default"].createElement("h4",{className:"climb__tile__author__username"},this.props.username))}}],[{key:"propTypes",value:{link:c.PropTypes.string,picture:c.PropTypes.string.isRequired,name:c.PropTypes.string.isRequired,username:c.PropTypes.string.isRequired},enumerable:!0}]),e}(c.Component);e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"render",value:function(){return a["default"].createElement("img",{className:"climb__image",src:this.props.src,"data-width":this.props.width,"data-height":this.props.height})}}]),e}(a["default"].Component);l.propTypes={src:a["default"].PropTypes.string.isRequired,width:a["default"].PropTypes.number,height:a["default"].PropTypes.number},e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"render",value:function(){var t=this.props.body.replace(/<a href="http:\/\/pic.twitter.com\/[^>]*>([^<]+)<\/a>/g,"");return a["default"].createElement("div",{className:"climb__message",dangerouslySetInnerHTML:{__html:t}})}}]),e}(a["default"].Component);l.propTypes={body:a["default"].PropTypes.string.isRequired},e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=n(4),p=r(l),h=n(5),f=r(h),d=n(3),v=r(d),b=function(t){function e(t){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t)}return o(e,t),s(e,[{key:"createImage",value:function(){if(null!==this.props.image){var t=this.props.image,e=t.url,n=t.width,r=t.height;return a["default"].createElement(p["default"],{src:e,width:n,height:r})}return null}},{key:"createMessage",value:function(){return this.props.message?a["default"].createElement(f["default"],{body:this.props.message}):null}},{key:"createClassString",value:function(){var t="climb__tile climb__tile--"+this.props.source_type;return t+=this.props.image?" climb__tile--has-media climb__tile--has-image":" climb__tile--has-no-image",t+=this.props.video_url?" climb__tile--has-media climb__tile--has-video":" climb__tile--has-no-video"}},{key:"render",value:function(){var t=this.createImage(),e=this.createMessage(),n=this.createClassString(),r=this.props.author;return a["default"].createElement("div",{className:n,style:this.props.style},a["default"].createElement("a",{href:this.props.link},t),a["default"].createElement("div",{className:"climb__tile__content"},e,a["default"].createElement(v["default"],r)))}}]),e}(a["default"].Component);b.propTypes={link:a["default"].PropTypes.string.isRequired,source_type:a["default"].PropTypes.string.isRequired,timestamp:a["default"].PropTypes.number.isRequired,author:a["default"].PropTypes.shape({username:a["default"].PropTypes.string.isRequired,picture:a["default"].PropTypes.string.isRequired,link:a["default"].PropTypes.string.isRequired}),message:a["default"].PropTypes.string,video_src:a["default"].PropTypes.string,image:a["default"].PropTypes.shape({url:a["default"].PropTypes.string.isRequired,width:a["default"].PropTypes.number.isRequired,height:a["default"].PropTypes.number.isRequired})},e["default"]=b,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},l=n(1),p=r(l),h=n(6),f=r(h),d=n(2),v=function(t){function e(){o(this,e),a(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return s(e,t),c(e,[{key:"getStyles",value:function(){var t=this,e={};return Object.keys(this.props.items).map(function(n){e[n]={opacity:d.spring(1),width:d.spring(30),margin:d.spring(1),item:t.props.items[n]}}),e}},{key:"willEnter",value:function(t){return{opacity:d.spring(0),width:d.spring(0),margin:d.spring(0),item:this.props.items[t]}}},{key:"willLeave",value:function(t,e){return{opacity:d.spring(0),width:d.spring(0),margin:d.spring(0),item:e.item}}},{key:"renderTile",value:function(t,e){var n=e.item,r=i(e,["item"]),o=i(n,[]),s={opacity:r.opacity,width:r.width+"%",marginLeft:r.margin+"%",marginRight:r.margin+"%"};return p["default"].createElement(f["default"],u({key:t,style:s},o))}},{key:"render",value:function(){var t=this;return p["default"].createElement(d.TransitionMotion,{styles:this.getStyles.bind(this)(),willEnter:this.willEnter.bind(this),willLeave:this.willLeave.bind(this)},function(e){return p["default"].createElement("div",{className:"climb__wall"},Object.keys(e).map(function(n){var r=e[n];return t.renderTile(n,r)}))})}}],[{key:"propTypes",value:{items:l.PropTypes.object.isRequired},enumerable:!0}]),e}(l.Component);e["default"]=v,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(18),o=n(21),s=r(o),u=function(t){var e=5e3,n=i.Observable.just("http://app.climb.social/api/v1/collections/"+t),r=i.Observable.interval(e).startWith(null),o=r.combineLatest(n,function(t,e){return e}).flatMap(function(t){var e=""+t;return i.Observable.fromPromise(s["default"](e).then(function(t){return t.json()}))});return o};e["default"]={getStream:u},t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0,e["default"]={noWobble:[170,26],gentle:[120,14],wobbly:[180,12],stiff:[210,20]},t.exports=e["default"]},function(t,e,n){(function(e){(function(){var n,r,i;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(n()-i)/1e6},r=e.hrtime,n=function(){var t;return t=r(),1e9*t[0]+t[1]},i=n()):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(e,n(11))},function(t,e){function n(){a=!1,s.length?c=s.concat(c):l=-1,c.length&&r()}function r(){if(!a){var t=setTimeout(n);a=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,a=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function o(){}var s,u=t.exports={},c=[],a=!1,l=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new i(t,e)),1!==c.length||a||setTimeout(r,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=o,u.addListener=o,u.once=o,u.off=o,u.removeListener=o,u.removeAllListeners=o,u.emit=o,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=n(5),p=r(l),h=n(3),f=r(h),d=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"createAuthor",value:function(){var t=this.props.author;return a["default"].createElement(f["default"],t)}},{key:"createMessage",value:function(){return a["default"].createElement(p["default"],{body:this.props.message})}},{key:"render",value:function(){var t=this.createAuthor(),e=this.createMessage();return a["default"].createElement("div",{style:this.props.style,className:"climb-slideshow__panel"},t,e)}}],[{key:"propTypes",value:{message:c.PropTypes.string.isRequired,author:c.PropTypes.object.isRequired},enumerable:!0}]),e}(c.Component);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},a=n(1),l=r(a),p=n(15),h=r(p),f=n(2),d=function(t){function e(t){o(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={currentKey:""}}return s(e,t),u(e,[{key:"componentDidMount",value:function(){var t=this.props.delay;this.timer=setInterval(this.nextSlide.bind(this),1e3*t)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"nextSlide",value:function(){var t=Object.keys(this.props.items),e=t[t.length*Math.random()<<0];this.setState({currentKey:e})}},{key:"getStyles",value:function(){var t=this,e=this.state.currentKey,n={};return Object.keys(this.props.items).map(function(r){n[r]={opacity:f.spring(0),scale:f.spring(0),zIndex:-5,item:t.props.items[r]},r===e&&Object.assign(n[r],{opacity:f.spring(1),scale:f.spring(1),zIndex:1})}),n}},{key:"willEnter",value:function(t){return{opacity:f.spring(0),scale:f.spring(0),zIndex:-5,item:this.props.items[t]}}},{key:"willLeave",value:function(t,e){return{opacity:f.spring(0),scale:f.spring(0),zIndex:-5,item:e.item}}},{key:"renderSlide",value:function(t,e){var n=e.item,r=i(e,["item"]),o={opacity:r.opacity,zIndex:Math.floor(r.zIndex),transform:"scale("+r.scale+")"};return l["default"].createElement(h["default"],{key:t,isCurrent:t===this.state.currentKey,item:n,style:o})}},{key:"render",value:function(){var t=this;return l["default"].createElement(f.TransitionMotion,{styles:this.getStyles.bind(this)(),willEnter:this.willEnter.bind(this),willLeave:this.willLeave.bind(this)},function(e){return l["default"].createElement("div",{className:"climb__slideshow__container"},Object.keys(e).map(function(n){var r=e[n];return t.renderSlide(n,r)}))})}}],[{key:"propTypes",value:{items:a.PropTypes.object.isRequired,delay:a.PropTypes.number.isRequired},enumerable:!0}]),e}(a.Component);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=n(8),p=r(l),h=n(13),f=r(h),d=function(t){function e(t){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={items:{}}}return o(e,t),s(e,[{key:"init",value:function(){var t=this;this.props.collectionId&&p["default"].getStream(this.props.collectionId).subscribe(function(e){var n={};e.map(function(t){n[t.id]=t}),t.setState({items:n})})}},{key:"componentDidMount",value:function(){this.init()}},{key:"render",value:function(){return a["default"].createElement(f["default"],{items:this.state.items,delay:this.props.delay})}}],[{key:"propTypes",value:{collectionId:c.PropTypes.string.isRequired,delay:c.PropTypes.number},enumerable:!0},{key:"defaultProps",value:{collectionId:"561ba63445284e1740e016f7",delay:5},enumerable:!0}]),e}(c.Component);e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=n(12),p=r(l),h=n(4),f=r(h),d=n(2),v=function(t){function e(t){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={shouldDisplayPanel:!1}}return o(e,t),s(e,[{key:"componentWillReceiveProps",value:function(t){var e=this;t.isCurrent?setTimeout(function(){e.setState({shouldDisplayPanel:!0})},850):this.setState({shouldDisplayPanel:!1})}},{key:"createImage",value:function(){var t=this.props.item.image;if(null!==t){var e=t.url,n=t.width,r=t.height;return a["default"].createElement(f["default"],{src:e,width:n,height:r})}return null}},{key:"createPanel",value:function(){var t=this;if(!this.props.item.image)return a["default"].createElement(p["default"],{author:this.props.item.author,message:this.props.item.message});var e=300,n={x:this.state.shouldDisplayPanel?d.spring(0):d.spring(e)},r={x:0};return a["default"].createElement(d.Motion,{defaultStyle:r,style:n},function(n){return a["default"].createElement(p["default"],{author:t.props.item.author,message:t.props.item.message,style:{marginLeft:"-"+n.x+"px",width:e}})})}},{key:"createClassString",value:function(){var t="climb-slideshow__slide climb__tile--"+this.props.item.source_type;return t+=this.props.item.image?" climb-slideshow__slide--has-media climb-slideshow__slide--has-image":" climb-slideshow__slide--has-no-image",t+=this.props.item.video_url?" climb-slideshow__slide--has-media climb-slideshow__slide--has-video":" climb-slideshow__slide--has-no-video"}},{key:"render",value:function(){var t=this.createImage(),e=this.createPanel(),n=this.createClassString();return a["default"].createElement("div",{className:n,style:this.props.style},t,e)}}],[{key:"propTypes",value:{item:c.PropTypes.object.isRequired,isCurrent:c.PropTypes.bool},enumerable:!0},{key:"defaultProps",value:{isCurrent:!1},enumerable:!0}]),e}(c.Component);e["default"]=v,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=function(t){function e(){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments)}return o(e,t),s(e,[{key:"render",value:function(){var t=n(37);return a["default"].createElement("a",{href:"http://climb.social/",className:"climb-social-badge",dangerouslySetInnerHTML:{__html:t}})}}]),e}(c.Component);e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e,n){for(var r=!0;r;){var i=t,o=e,s=n;u=a=c=void 0,r=!1,null===i&&(i=Function.prototype);var u=Object.getOwnPropertyDescriptor(i,o);if(void 0!==u){if("value"in u)return u.value;var c=u.get;return void 0===c?void 0:c.call(s)}var a=Object.getPrototypeOf(i);if(null===a)return void 0;t=a,e=o,n=s,r=!0}},c=n(1),a=r(c),l=n(8),p=r(l),h=n(7),f=r(h),d=n(16),v=r(d),b=function(t){function e(t){i(this,e),u(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.state={items:{}}}return o(e,t),s(e,[{key:"init",value:function(){var t=this;this.props.collectionId&&p["default"].getStream(this.props.collectionId).subscribe(function(e){var n=parseInt(t.props.limit,0),r={};e.splice(0,n).map(function(t){r[t.id]=t}),t.setState({items:r})})}},{key:"componentDidMount",value:function(){this.init()}},{key:"componentDidUpdate",value:function(){var t=void 0;(t=window.Climb&&window.Climb.onUpdate?window.Climb.onUpdate:function(){})()}},{key:"render",value:function(){return a["default"].createElement("div",null,a["default"].createElement(f["default"],{items:this.state.items}),a["default"].createElement(v["default"],null))}}],[{key:"propTypes",value:{collectionId:c.PropTypes.string.isRequired,limit:c.PropTypes.oneOfType([c.PropTypes.number,c.PropTypes.string])},enumerable:!0},{key:"defaultProps",value:{collectionId:"561ba63445284e1740e016f7",limit:30},enumerable:!0}]),e}(c.Component);e["default"]=b,t.exports=e["default"]},function(t,e,n){var r;(function(t,i,o){(function(s){function u(t){return t&&t.Object===Object?t:null}function c(t){for(var e=t.length,n=new Array(e),r=0;e>r;r++)n[r]=t[r];return n}function a(t){return function(){try{return t.apply(this,arguments)}catch(e){return jt.e=e,jt}}}function l(t){throw t}function p(t,e){if(kt&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(Mt)){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var i=n.join("\n"+Mt+"\n");t.stack=h(i)}}function h(t){for(var e=t.split("\n"),n=[],r=0,i=e.length;i>r;r++){var o=e[r];f(o)||d(o)||!o||n.push(o)}return n.join("\n")}function f(t){var e=b(t);if(!e)return!1;var n=e[0],r=e[1];return n===Nt&&r>=Tt&&ci>=r}function d(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function v(){if(kt)try{throw new Error}catch(t){var e=t.stack.split("\n"),n=e[0].indexOf("@")>0?e[1]:e[2],r=b(n);if(!r)return;return Nt=r[0],r[1]}}function b(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function y(t){var e=[];if(!de(t))return e;fe.nonEnumArgs&&t.length&&ve(t)&&(t=ye.call(t));var n=fe.enumPrototypes&&"function"==typeof t,r=fe.enumErrorProps&&(t===ue||t instanceof Error);for(var i in t)n&&"prototype"==i||r&&("message"==i||"name"==i)||e.push(i);if(fe.nonEnumShadows&&t!==ce){var o=t.constructor,s=-1,u=Ht;if(t===(o&&o.prototype))var c=t===ae?re:t===ue?Jt:ie.call(t),a=he[c];for(;++s<u;)i=Kt[s],a&&a[i]||!oe.call(t,i)||e.push(i)}return e}function m(t,e,n){for(var r=-1,i=n(t),o=i.length;++r<o;){var s=i[r];if(e(t[s],s,t)===!1)break}return t}function _(t,e){return m(t,e,y)}function g(t){return"function"!=typeof t.toString&&"string"==typeof(t+"")}function w(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;var i=typeof t,o=typeof e;if(t===t&&(null==t||null==e||"function"!=i&&"object"!=i&&"function"!=o&&"object"!=o))return!1;var s=ie.call(t),u=ie.call(e);if(s==Qt&&(s=ee),u==Qt&&(u=ee),s!=u)return!1;switch(s){case Yt:case Gt:return+t==+e;case te:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case ne:case re:return t==String(e)}var c=s==$t;if(!c){if(s!=ee||!fe.nodeClass&&(g(t)||g(e)))return!1;var a=!fe.argsObject&&ve(t)?Object:t.constructor,l=!fe.argsObject&&ve(e)?Object:e.constructor;if(!(a==l||oe.call(t,"constructor")&&oe.call(e,"constructor")||Ot(a)&&a instanceof a&&Ot(l)&&l instanceof l||!("constructor"in t&&"constructor"in e)))return!1}n||(n=[]),r||(r=[]);for(var p=n.length;p--;)if(n[p]==t)return r[p]==e;var h=0,f=!0;if(n.push(t),r.push(e),c){if(p=t.length,h=e.length,f=h==p)for(;h--;){var d=e[h];if(!(f=w(t[h],d,n,r)))break}}else _(e,function(e,i,o){return oe.call(o,i)?(h++,f=oe.call(t,i)&&w(t[i],e,n,r)):void 0}),f&&_(t,function(t,e,n){return oe.call(n,e)?f=--h>-1:void 0});return n.pop(),r.pop(),f}function C(t,e){for(var n=new Array(t),r=0;t>r;r++)n[r]=e();return n}function x(t,e){this.id=t,this.value=e}function S(t){this._s=t,this.isDisposed=!1}function E(t){this._s=t}function O(t){this._s=t,this._l=t.length,this._i=0}function j(t){this._a=t}function D(t){this._a=t,this._l=T(t),this._i=0}function k(t){return"number"==typeof t&&yt.isFinite(t)}function P(t){var e,n=t[Vt];if(!n&&"string"==typeof t)return e=new E(t),e[Vt]();if(!n&&t.length!==s)return e=new j(t),e[Vt]();if(!n)throw new TypeError("Object is not iterable");return t[Vt]()}function N(t){var e=+t;return 0===e?e:isNaN(e)?e:0>e?-1:1}function T(t){var e=+t.length;return isNaN(e)?0:0!==e&&k(e)?(e=N(e)*Math.floor(Math.abs(e)),0>=e?0:e>jn?jn:e):e}function M(t,e){this.observer=t,
this.parent=e}function A(t,e){var n=t.length;return function(r,i){n>r?(e.onNext(t[r]),i(r+1)):e.onCompleted()}}function L(t,e){return qe(t)||(t=ze),new kn(e,t)}function R(t,e){this.observer=t,this.parent=e}function I(t,e){this.observer=t,this.parent=e}function F(){return!1}function V(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function F(){return!1}function V(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function F(){return!1}function z(){return[]}function F(){return!1}function z(){return[]}function V(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return e}function U(t){return function(e){return t.subscribe(e)}}function W(t,e){return function(n){for(var r=n,i=0;e>i;i++){var o=r[t[i]];if("undefined"==typeof o)return s;r=o}return r}}function B(t,e,n,r){var i=new ii;return r.push(Z(i,e,n)),t.apply(e,r),i.asObservable()}function Z(t,e,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;r>o;o++)i[o]=arguments[o];if(Ot(n)){if(i=Dt(n).apply(e,i),i===jt)return t.onError(i.e);t.onNext(i)}else i.length<=1?t.onNext(i[0]):t.onNext(i);t.onCompleted()}}function K(t,e,n,r){var i=new ii;return r.push(H(i,e,n)),t.apply(e,r),i.asObservable()}function H(t,e,n){return function(){var r=arguments[0];if(r)return t.onError(r);for(var i=arguments.length,o=[],s=1;i>s;s++)o[s-1]=arguments[s];if(Ot(n)){var o=Dt(n).apply(e,o);if(o===jt)return t.onError(o.e);t.onNext(o)}else o.length<=1?t.onNext(o[0]):t.onNext(o);t.onCompleted()}}function Q(t){return yt.StaticNodeList?t instanceof yt.StaticNodeList||t instanceof yt.NodeList:"[object NodeList]"===Object.prototype.toString.call(t)}function $(t,e,n){this._e=t,this._n=e,this._fn=n,this._e.addEventListener(this._n,this._fn,!1),this.isDisposed=!1}function Y(t,e,n){var r=new ge,i=Object.prototype.toString.call(t);if(Q(t)||"[object HTMLCollection]"===i)for(var o=0,s=t.length;s>o;o++)r.add(Y(t.item(o),e,n));else t&&r.add(new $(t,e,n));return r}function G(t,e){return new Ur(t,e)}function J(t,e,n){return new ti(function(r){var i=t,o=Ae(e);return n.scheduleRecursiveFuture(0,i,function(t,e){if(o>0){var s=n.now();i=new Date(i.getTime()+o),i.getTime()<=s&&(i=new Date(s+o))}r.onNext(t),e(t+1,new Date(i))})})}function X(t,e,n){return t===e?new ti(function(t){return n.schedulePeriodic(0,e,function(e){return t.onNext(e),e+1})}):wn(function(){return J(new Date(n.now()+t),e,n)})}function tt(t,e,n){return new ti(function(r){var i,o=!1,s=new ke,u=null,c=[],a=!1;return i=t.materialize().timestamp(n).subscribe(function(t){var i,l;"E"===t.value.kind?(c=[],c.push(t),u=t.value.error,l=!a):(c.push({value:t.value,timestamp:t.timestamp+e}),l=!o,o=!0),l&&(null!==u?r.onError(u):(i=new De,s.setDisposable(i),i.setDisposable(n.scheduleRecursiveFuture(null,e,function(t,e){var i,s,l,p;if(null===u){a=!0;do l=null,c.length>0&&c[0].timestamp-n.now()<=0&&(l=c.shift().value),null!==l&&l.accept(r);while(null!==l);p=!1,s=0,c.length>0?(p=!0,s=Math.max(0,c[0].timestamp-n.now())):o=!1,i=u,a=!1,null!==i?r.onError(i):p&&e(null,s)}}))))}),new Pe(i,s)},t)}function et(t,e,n){return wn(function(){return tt(t,e-n.now(),n)})}function nt(t,e,n){var r,i;return Ot(e)?i=e:(r=e,i=n),new ti(function(e){function n(){c.setDisposable(t.subscribe(function(t){var n=Dt(i)(t);if(n===jt)return e.onError(n.e);var r=new De;s.add(r),r.setDisposable(n.subscribe(function(){e.onNext(t),s.remove(r),o()},function(t){e.onError(t)},function(){e.onNext(t),s.remove(r),o()}))},function(t){e.onError(t)},function(){u=!0,c.dispose(),o()}))}function o(){u&&0===s.length&&e.onCompleted()}var s=new ge,u=!1,c=new ke;return r?c.setDisposable(r.subscribe(n,function(t){e.onError(t)},n)):n(),new Pe(c,s)},this)}function rt(t,e){return new ti(function(n){var r,i=!1,o=new ke,s=0,u=t.subscribe(function(t){var u=Dt(e)(t);if(u===jt)return n.onError(u.e);Et(u)&&(u=Ir(u)),i=!0,r=t,s++;var c=s,a=new De;o.setDisposable(a),a.setDisposable(u.subscribe(function(){i&&s===c&&n.onNext(r),i=!1,a.dispose()},function(t){n.onError(t)},function(){i&&s===c&&n.onNext(r),i=!1,a.dispose()}))},function(t){o.dispose(),n.onError(t),i=!1,s++},function(){o.dispose(),i&&n.onNext(r),n.onCompleted(),i=!1,s++});return new Pe(u,o)},t)}function it(t,e){return new ti(function(n){function r(){s&&(s=!1,n.onNext(i)),o&&n.onCompleted()}var i,o=!1,s=!1,u=new De;return u.setDisposable(t.subscribe(function(t){s=!0,i=t},function(t){n.onError(t)},function(){o=!0,u.dispose()})),new Pe(u,e.subscribe(r,function(t){n.onError(t)},r))},t)}function ot(t,e,n,r){return Ot(e)&&(r=n,n=e,e=Mn()),r||(r=Vn(new Qr)),new ti(function(i){function o(t){function e(){return p=n===l}var n=l,o=new De;c.setDisposable(o),o.setDisposable(t.subscribe(function(){e()&&u.setDisposable(r.subscribe(i)),o.dispose()},function(t){e()&&i.onError(t)},function(){e()&&u.setDisposable(r.subscribe(i))}))}function s(){var t=!p;return t&&l++,t}var u=new ke,c=new ke,a=new De;u.setDisposable(a);var l=0,p=!1;return o(e),a.setDisposable(t.subscribe(function(t){if(s()){i.onNext(t);var e=Dt(n)(t);if(e===jt)return i.onError(e.e);o(Et(e)?Ir(e):e)}},function(t){s()&&i.onError(t)},function(){s()&&i.onCompleted()})),new Pe(u,c)},t)}function st(t,e,n,r){return qe(n)&&(r=n,n=Vn(new Qr)),n instanceof Error&&(n=Vn(n)),qe(r)||(r=Ke),new ti(function(i){function o(){var t=s;l.setDisposable(r.scheduleFuture(null,e,function(){a=s===t,a&&(Et(n)&&(n=Ir(n)),c.setDisposable(n.subscribe(i)))}))}var s=0,u=new De,c=new ke,a=!1,l=new ke;return c.setDisposable(u),o(),u.setDisposable(t.subscribe(function(t){a||(s++,i.onNext(t),o())},function(t){a||(s++,i.onError(t))},function(){a||(s++,i.onCompleted())})),new Pe(c,l)},t)}function ut(t,e,n){return new ti(function(r){function i(t,e){if(a[e]=t,s[e]=!0,u||(u=s.every(gt))){if(o)return r.onError(o);var i=Dt(n).apply(null,a);if(i===jt)return r.onError(i.e);r.onNext(i)}c&&a[1]&&r.onCompleted()}var o,s=[!1,!1],u=!1,c=!1,a=new Array(2);return new Pe(t.subscribe(function(t){i(t,0)},function(t){a[1]?r.onError(t):o=t},function(){c=!0,a[1]&&r.onCompleted()}),e.subscribe(function(t){i(t,1)},function(t){r.onError(t)},function(){c=!0,i(!0,1)}))},t)}function ct(t){return{"@@transducer/init":function(){return t},"@@transducer/step":function(t,e){return t.onNext(e)},"@@transducer/result":function(t){return t.onCompleted()}}}var at={"function":!0,object:!0},lt=at[typeof e]&&e&&!e.nodeType?e:null,pt=at[typeof t]&&t&&!t.nodeType?t:null,ht=u(lt&&pt&&"object"==typeof i&&i),ft=u(at[typeof self]&&self),dt=u(at[typeof window]&&window),vt=pt&&pt.exports===lt?lt:null,bt=u(at[typeof this]&&this),yt=ht||dt!==(bt&&bt.window)&&dt||ft||bt||Function("return this")(),mt={internals:{},config:{Promise:yt.Promise},helpers:{}},_t=mt.helpers.noop=function(){},gt=mt.helpers.identity=function(t){return t},wt=mt.helpers.defaultNow=Date.now,Ct=mt.helpers.defaultComparer=function(t,e){return be(t,e)},xt=mt.helpers.defaultSubComparer=function(t,e){return t>e?1:e>t?-1:0},St=(mt.helpers.defaultKeySerializer=function(t){return t.toString()},mt.helpers.defaultError=function(t){throw t}),Et=mt.helpers.isPromise=function(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then},Ot=mt.helpers.isFunction=function(){var t=function(t){return"function"==typeof t||!1};return t(/x/)&&(t=function(t){return"function"==typeof t&&"[object Function]"==ie.call(t)}),t}(),jt={e:{}},Dt=mt.internals.tryCatch=function(t){if(!Ot(t))throw new TypeError("fn must be a function");return a(t)};mt.config.longStackSupport=!1;var kt=!1,Pt=Dt(function(){throw new Error})();kt=!!Pt.e&&!!Pt.e.stack;var Nt,Tt=v(),Mt="From previous event:",At=mt.EmptyError=function(){this.message="Sequence contains no elements.",Error.call(this)};At.prototype=Object.create(Error.prototype),At.prototype.name="EmptyError";var qt=mt.ObjectDisposedError=function(){this.message="Object has been disposed",Error.call(this)};qt.prototype=Object.create(Error.prototype),qt.prototype.name="ObjectDisposedError";var Lt=mt.ArgumentOutOfRangeError=function(){this.message="Argument out of range",Error.call(this)};Lt.prototype=Object.create(Error.prototype),Lt.prototype.name="ArgumentOutOfRangeError";var Rt=mt.NotSupportedError=function(t){this.message=t||"This operation is not supported",Error.call(this)};Rt.prototype=Object.create(Error.prototype),Rt.prototype.name="NotSupportedError";var It=mt.NotImplementedError=function(t){this.message=t||"This operation is not implemented",Error.call(this)};It.prototype=Object.create(Error.prototype),It.prototype.name="NotImplementedError";var Ft=mt.helpers.notImplemented=function(){throw new It},Vt=(mt.helpers.notSupported=function(){throw new Rt},"function"==typeof Symbol&&Symbol.iterator||"_es6shim_iterator_");yt.Set&&"function"==typeof(new yt.Set)["@@iterator"]&&(Vt="@@iterator");var zt=mt.doneEnumerator={done:!0,value:s},Ut=mt.helpers.isIterable=function(t){return t&&t[Vt]!==s},Wt=mt.helpers.isArrayLike=function(t){return t&&t.length!==s};mt.helpers.iterator=Vt;var Bt,Zt=mt.internals.bindCallback=function(t,e,n){if("undefined"==typeof e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},Kt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Ht=Kt.length,Qt="[object Arguments]",$t="[object Array]",Yt="[object Boolean]",Gt="[object Date]",Jt="[object Error]",Xt="[object Function]",te="[object Number]",ee="[object Object]",ne="[object RegExp]",re="[object String]",ie=Object.prototype.toString,oe=Object.prototype.hasOwnProperty,se=ie.call(arguments)==Qt,ue=Error.prototype,ce=Object.prototype,ae=String.prototype,le=ce.propertyIsEnumerable;try{Bt=!(ie.call(document)==ee&&!({toString:0}+""))}catch(pe){Bt=!0}var he={};he[$t]=he[Gt]=he[te]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},he[Yt]=he[re]={constructor:!0,toString:!0,valueOf:!0},he[Jt]=he[Xt]=he[ne]={constructor:!0,toString:!0},he[ee]={constructor:!0};var fe={};!function(){var t=function(){this.x=1},e=[];t.prototype={valueOf:1,y:1};for(var n in new t)e.push(n);for(n in arguments);fe.enumErrorProps=le.call(ue,"message")||le.call(ue,"name"),fe.enumPrototypes=le.call(t,"prototype"),fe.nonEnumArgs=0!=n,fe.nonEnumShadows=!/valueOf/.test(e)}(1);var de=mt.internals.isObject=function(t){var e=typeof t;return t&&("function"==e||"object"==e)||!1},ve=function(t){return t&&"object"==typeof t?ie.call(t)==Qt:!1};se||(ve=function(t){return t&&"object"==typeof t?oe.call(t,"callee"):!1});var be=mt.internals.isEqual=function(t,e){return w(t,e,[],[])},ye=({}.hasOwnProperty,Array.prototype.slice),me=mt.internals.inherits=function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n},_e=mt.internals.addProperties=function(t){for(var e=[],n=1,r=arguments.length;r>n;n++)e.push(arguments[n]);for(var i=0,o=e.length;o>i;i++){var s=e[i];for(var u in s)t[u]=s[u]}},ge=(mt.internals.addRef=function(t,e){return new ti(function(n){return new Pe(e.getDisposable(),t.subscribe(n))})},mt.CompositeDisposable=function(){var t,e,n=[];if(Array.isArray(arguments[0]))n=arguments[0],e=n.length;else for(e=arguments.length,n=new Array(e),t=0;e>t;t++)n[t]=arguments[t];this.disposables=n,this.isDisposed=!1,this.length=n.length}),we=ge.prototype;we.add=function(t){this.isDisposed?t.dispose():(this.disposables.push(t),this.length++)},we.remove=function(t){var e=!1;if(!this.isDisposed){var n=this.disposables.indexOf(t);-1!==n&&(e=!0,this.disposables.splice(n,1),this.length--,t.dispose())}return e},we.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=this.disposables.length,e=new Array(t),n=0;t>n;n++)e[n]=this.disposables[n];for(this.disposables=[],this.length=0,n=0;t>n;n++)e[n].dispose()}};var Ce=mt.Disposable=function(t){this.isDisposed=!1,this.action=t||_t};Ce.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var xe=Ce.create=function(t){return new Ce(t)},Se=Ce.empty={dispose:_t},Ee=Ce.isDisposable=function(t){return t&&Ot(t.dispose)},Oe=Ce.checkDisposed=function(t){if(t.isDisposed)throw new qt},je=Ce._fixup=function(t){return Ee(t)?t:Se},De=mt.SingleAssignmentDisposable=function(){this.isDisposed=!1,this.current=null};De.prototype.getDisposable=function(){return this.current},De.prototype.setDisposable=function(t){if(this.current)throw new Error("Disposable has already been assigned");var e=this.isDisposed;!e&&(this.current=t),e&&t&&t.dispose()},De.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null,t&&t.dispose()}};var ke=mt.SerialDisposable=function(){this.isDisposed=!1,this.current=null};ke.prototype.getDisposable=function(){return this.current},ke.prototype.setDisposable=function(t){var e=this.isDisposed;if(!e){var n=this.current;this.current=t}n&&n.dispose(),e&&t&&t.dispose()},ke.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this.current;this.current=null}t&&t.dispose()};var Pe=mt.BinaryDisposable=function(t,e){this._first=t,this._second=e,this.isDisposed=!1};Pe.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var t=this._first;this._first=null,t&&t.dispose();var e=this._second;this._second=null,e&&e.dispose()}};var Ne=mt.NAryDisposable=function(t){this._disposables=t,this.isDisposed=!1};Ne.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var t=0,e=this._disposables.length;e>t;t++)this._disposables[t].dispose();this._disposables.length=0}};var Te=(mt.RefCountDisposable=function(){function t(t){this.disposable=t,this.disposable.count++,this.isInnerDisposed=!1}function e(t){this.underlyingDisposable=t,this.isDisposed=!1,this.isPrimaryDisposed=!1,this.count=0}return t.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,0===this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))},e.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))},e.prototype.getDisposable=function(){return this.isDisposed?Se:new t(this)},e}(),mt.internals.ScheduledItem=function(t,e,n,r,i){this.scheduler=t,this.state=e,this.action=n,this.dueTime=r,this.comparer=i||xt,this.disposable=new De});Te.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())},Te.prototype.compareTo=function(t){return this.comparer(this.dueTime,t.dueTime)},Te.prototype.isCancelled=function(){return this.disposable.isDisposed},Te.prototype.invokeCore=function(){return je(this.action(this.scheduler,this.state))};var Me=mt.Scheduler=function(){function t(){}t.isScheduler=function(e){return e instanceof t};var e=t.prototype;return e.schedule=function(t,e){throw new It},e.scheduleFuture=function(e,n,r){var i=n;return i instanceof Date&&(i-=this.now()),i=t.normalize(i),0===i?this.schedule(e,r):this._scheduleFuture(e,i,r)},e._scheduleFuture=function(t,e,n){throw new It},t.now=wt,t.prototype.now=wt,t.normalize=function(t){return 0>t&&(t=0),t},t}(),Ae=Me.normalize,qe=Me.isScheduler;!function(t){function e(t,e){function n(e){function r(t,e){return s?o.remove(c):u=!0,i(e,n),Se}var s=!1,u=!1,c=t.schedule(e,r);u||(o.add(c),s=!0)}var r=e[0],i=e[1],o=new ge;return i(r,n),o}function n(t,e){function n(e,r){function s(t,e){return u?o.remove(a):c=!0,i(e,n),Se}var u=!1,c=!1,a=t.scheduleFuture(e,r,s);c||(o.add(a),u=!0)}var r=e[0],i=e[1],o=new ge;return i(r,n),o}t.scheduleRecursive=function(t,n){return this.schedule([t,n],e)},t.scheduleRecursiveFuture=function(t,e,r){return this.scheduleFuture([t,r],e,n)}}(Me.prototype),function(t){Me.prototype.schedulePeriodic=function(t,e,n){if("undefined"==typeof yt.setInterval)throw new Rt;e=Ae(e);var r=t,i=yt.setInterval(function(){r=n(r)},e);return xe(function(){yt.clearInterval(i)})}}(Me.prototype);var Le,Re,Ie=function(t){function e(){t.call(this)}return me(e,t),e.prototype.schedule=function(t,e){return je(e(this,t))},e}(Me),Fe=Me.immediate=new Ie,Ve=function(t){function e(){for(;r.length>0;){var t=r.dequeue();!t.isCancelled()&&t.invoke()}}function n(){t.call(this)}var r;return me(n,t),n.prototype.schedule=function(t,n){var i=new Te(this,t,n,this.now());if(r)r.enqueue(i);else{r=new He(4),r.enqueue(i);var o=Dt(e)();r=null,o===jt&&l(o.e)}return i.disposable},n.prototype.scheduleRequired=function(){return!r},n}(Me),ze=Me.currentThread=new Ve,Ue=(mt.internals.SchedulePeriodicRecursive=function(){function t(t){return function(e,n){n(0,t._period);var r=Dt(t._action)(t._state);r===jt&&(t._cancel.dispose(),l(r.e)),t._state=r}}function e(t,e,n,r){this._scheduler=t,this._state=e,this._period=n,this._action=r}return e.prototype.start=function(){var e=new De;return this._cancel=e,e.setDisposable(this._scheduler.scheduleRecursiveFuture(0,this._period,t(this))),e},e}(),function(){var t,e=_t;if(yt.setTimeout)t=yt.setTimeout,e=yt.clearTimeout;else{if(!yt.WScript)throw new Rt;t=function(t,e){yt.WScript.Sleep(e),t()}}return{setTimeout:t,clearTimeout:e}}()),We=Ue.setTimeout,Be=Ue.clearTimeout;!function(){function t(e){if(i)We(function(){t(e)},0);else{var n=r[e];if(n){i=!0;var o=Dt(n)();Re(e),i=!1,o===jt&&l(o.e)}}}function e(){if(!yt.postMessage||yt.importScripts)return!1;var t=!1,e=yt.onmessage;return yt.onmessage=function(){t=!0},yt.postMessage("","*"),yt.onmessage=e,t}var n=1,r={},i=!1;Re=function(t){delete r[t]};var s=new RegExp("^"+String(ie).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),u="function"==typeof(u=ht&&vt&&ht.setImmediate)&&!s.test(u)&&u;if(Ot(u))Le=function(e){var i=n++;return r[i]=e,u(function(){t(i)}),i};else if("undefined"!=typeof o&&"[object process]"==={}.toString.call(o))Le=function(e){var i=n++;return r[i]=e,o.nextTick(function(){t(i)}),i};else if(e()){var c="ms.rx.schedule"+Math.random(),a=function(e){"string"==typeof e.data&&e.data.substring(0,c.length)===c&&t(e.data.substring(c.length))};yt.addEventListener("message",a,!1),Le=function(t){var e=n++;return r[e]=t,yt.postMessage(c+currentId,"*"),e}}else if(yt.MessageChannel){var p=new yt.MessageChannel;p.port1.onmessage=function(e){t(e.data)},Le=function(t){var e=n++;return r[e]=t,p.port2.postMessage(e),e}}else Le="document"in yt&&"onreadystatechange"in yt.document.createElement("script")?function(e){var i=yt.document.createElement("script"),o=n++;return r[o]=e,i.onreadystatechange=function(){t(o),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},yt.document.documentElement.appendChild(i),o}:function(e){var i=n++;return r[i]=e,We(function(){t(i)},0),i}}();var Ze=function(t){function e(){t.call(this)}function n(t,e,n,r){return function(){!t.isDisposed&&t.setDisposable(Ce._fixup(e(n,r)))}}function r(t,e){this._id=e,this._method=t,this.isDisposed=!1}return me(e,t),r.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._method.call(null,this._id))},e.prototype.schedule=function(t,e){var i=new De,o=Le(n(i,e,this,t));return new Pe(i,new r(Re,o))},e.prototype._scheduleFuture=function(t,e,i){if(0===e)return this.schedule(t,i);var o=new De,s=We(n(o,i,this,t),e);return new Pe(o,new r(Be,s))},e}(Me),Ke=Me["default"]=Me.async=new Ze;x.prototype.compareTo=function(t){var e=this.value.compareTo(t.value);return 0===e&&(e=this.id-t.id),e};var He=mt.internals.PriorityQueue=function(t){this.items=new Array(t),this.length=0},Qe=He.prototype;Qe.isHigherPriority=function(t,e){return this.items[t].compareTo(this.items[e])<0},Qe.percolate=function(t){if(!(t>=this.length||0>t)){var e=t-1>>1;if(!(0>e||e===t)&&this.isHigherPriority(t,e)){var n=this.items[t];this.items[t]=this.items[e],this.items[e]=n,this.percolate(e)}}},Qe.heapify=function(t){if(+t||(t=0),!(t>=this.length||0>t)){var e=2*t+1,n=2*t+2,r=t;if(e<this.length&&this.isHigherPriority(e,r)&&(r=e),n<this.length&&this.isHigherPriority(n,r)&&(r=n),r!==t){var i=this.items[t];this.items[t]=this.items[r],this.items[r]=i,this.heapify(r)}}},Qe.peek=function(){return this.items[0].value},Qe.removeAt=function(t){this.items[t]=this.items[--this.length],this.items[this.length]=s,this.heapify()},Qe.dequeue=function(){var t=this.peek();return this.removeAt(0),t},Qe.enqueue=function(t){var e=this.length++;this.items[e]=new x(He.count++,t),this.percolate(e)},Qe.remove=function(t){for(var e=0;e<this.length;e++)if(this.items[e].value===t)return this.removeAt(e),!0;return!1},He.count=0;var $e,Ye=mt.Notification=function(){function t(){}return t.prototype._accept=function(t,e,n){throw new It},t.prototype._acceptObservable=function(t,e,n){throw new It},t.prototype.accept=function(t,e,n){return t&&"object"==typeof t?this._acceptObservable(t):this._accept(t,e,n)},t.prototype.toObservable=function(t){var e=this;return qe(t)||(t=Fe),new ti(function(n){return t.schedule(e,function(t,e){e._acceptObservable(n),"N"===e.kind&&n.onCompleted()})})},t}(),Ge=function(t){function e(t){this.value=t,this.kind="N"}return me(e,t),e.prototype._accept=function(t){return t(this.value)},e.prototype._acceptObservable=function(t){return t.onNext(this.value)},e.prototype.toString=function(){return"OnNext("+this.value+")"},e}(Ye),Je=function(t){function e(t){this.error=t,this.kind="E"}return me(e,t),e.prototype._accept=function(t,e){return e(this.error)},e.prototype._acceptObservable=function(t){return t.onError(this.error)},e.prototype.toString=function(){return"OnError("+this.error+")"},e}(Ye),Xe=function(t){function e(){this.kind="C"}return me(e,t),e.prototype._accept=function(t,e,n){return n()},e.prototype._acceptObservable=function(t){return t.onCompleted()},e.prototype.toString=function(){return"OnCompleted()"},e}(Ye),tn=Ye.createOnNext=function(t){return new Ge(t)},en=Ye.createOnError=function(t){return new Je(t)},nn=Ye.createOnCompleted=function(){return new Xe},rn=mt.Observer=function(){},on=rn.create=function(t,e,n){return t||(t=_t),e||(e=St),n||(n=_t),new un(t,e,n)},sn=mt.internals.AbstractObserver=function(t){function e(){this.isStopped=!1}return me(e,t),e.prototype.next=Ft,e.prototype.error=Ft,e.prototype.completed=Ft,e.prototype.onNext=function(t){!this.isStopped&&this.next(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.error(t))},e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.error(t),!0)},e}(rn),un=mt.AnonymousObserver=function(t){function e(e,n,r){t.call(this),this._onNext=e,this._onError=n,this._onCompleted=r}return me(e,t),e.prototype.next=function(t){this._onNext(t)},e.prototype.error=function(t){this._onError(t)},e.prototype.completed=function(){this._onCompleted()},e}(sn),cn=mt.Observable=function(){function t(t,e){return function(n){var r=n.onError;return n.onError=function(e){p(e,t),r.call(n,e)},e.call(t,n)}}function e(){if(mt.config.longStackSupport&&kt){var e=this._subscribe,n=Dt(l)(new Error).e;this.stack=n.stack.substring(n.stack.indexOf("\n")+1),this._subscribe=t(this,e)}}return $e=e.prototype,e.isObservable=function(t){return t&&Ot(t.subscribe)},$e.subscribe=$e.forEach=function(t,e,n){return this._subscribe("object"==typeof t?t:on(t,e,n))},$e.subscribeOnNext=function(t,e){return this._subscribe(on("undefined"!=typeof e?function(n){t.call(e,n)}:t))},$e.subscribeOnError=function(t,e){return this._subscribe(on(null,"undefined"!=typeof e?function(n){t.call(e,n)}:t))},$e.subscribeOnCompleted=function(t,e){return this._subscribe(on(null,null,"undefined"!=typeof e?function(){t.call(e)}:t))},e}(),an=mt.internals.ScheduledObserver=function(t){function e(e,n){t.call(this),this.scheduler=e,this.observer=n,this.isAcquired=!1,this.hasFaulted=!1,this.queue=[],this.disposable=new ke}return me(e,t),e.prototype.next=function(t){var e=this;this.queue.push(function(){e.observer.onNext(t)})},e.prototype.error=function(t){var e=this;this.queue.push(function(){e.observer.onError(t)})},e.prototype.completed=function(){var t=this;this.queue.push(function(){t.observer.onCompleted()})},e.prototype.ensureActive=function(){var t=!1;!this.hasFaulted&&this.queue.length>0&&(t=!this.isAcquired,this.isAcquired=!0),t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(this,function(t,e){var n;if(!(t.queue.length>0))return void(t.isAcquired=!1);n=t.queue.shift();var r=Dt(n)();return r===jt?(t.queue=[],t.hasFaulted=!0,l(r.e)):void e(t)}))},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.disposable.dispose()},e}(sn),ln=mt.ObservableBase=function(t){function e(t){return t&&Ot(t.dispose)?t:Ot(t)?xe(t):Se}function n(t,n){var r=n[0],i=n[1],o=Dt(i.subscribeCore).call(i,r);o!==jt||r.fail(jt.e)||l(jt.e),r.setDisposable(e(o))}function r(){t.call(this)}return me(r,t),r.prototype._subscribe=function(t){var e=new ei(t),r=[e,this];return ze.scheduleRequired()?ze.schedule(r,n):n(null,r),e},r.prototype.subscribeCore=Ft,r}(cn),pn=mt.FlatMapObservable=function(t){function e(e,n,r,i){this.resultSelector=Ot(r)?r:null,this.selector=Zt(Ot(n)?n:function(){return n},i,3),this.source=e,t.call(this)}function n(t,e,n,r){this.i=0,this.selector=e,this.resultSelector=n,this.source=r,this.o=t,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.selector,this.resultSelector,this))},me(n,sn),n.prototype._wrapResult=function(t,e,n){return this.resultSelector?t.map(function(t,r){return this.resultSelector(e,t,n,r)},this):t},n.prototype.next=function(t){var e=this.i++,n=Dt(this.selector)(t,e,this.source);return n===jt?this.o.onError(n.e):(Et(n)&&(n=Ir(n)),(Wt(n)||Ut(n))&&(n=cn.from(n)),void this.o.onNext(this._wrapResult(n,t,e)))},n.prototype.error=function(t){this.o.onError(t)},n.prototype.onCompleted=function(){this.o.onCompleted()},e}(ln),hn=mt.internals.Enumerable=function(){};S.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.isDisposed=!0)};var fn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e,n){this._o=t,this._s=e,this._e=n,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e={isDisposed:!1},r=new ke,i=ze.scheduleRecursive(this.sources[Vt](),function(i,o){if(!e.isDisposed){var s=Dt(i.next).call(i);if(s===jt)return t.onError(s.e);if(s.done)return t.onCompleted();var u=s.value;Et(u)&&(u=Ir(u));var c=new De;r.setDisposable(c),c.setDisposable(u.subscribe(new n(t,o,i)))}});return new Ne([r,i,new S(e)])},me(n,sn),n.prototype.onNext=function(t){this._o.onNext(t)},n.prototype.onError=function(t){this._o.onError(t)},n.prototype.onCompleted=function(){this._s(this._e)},e}(ln);hn.prototype.concat=function(){return new fn(this)};var dn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){this._o=t,this._recurse=e,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=this.sources[Vt](),r={isDisposed:!1},i=new ke,o=ze.scheduleRecursive(null,function(o,s){if(!r.isDisposed){var u=Dt(e.next).call(e);if(u===jt)return t.onError(u.e);if(u.done)return null!==o?t.onError(o):t.onCompleted();var c=u.value;Et(c)&&(c=Ir(c));var a=new De;i.setDisposable(a),a.setDisposable(c.subscribe(new n(t,s)))}});return new Ne([i,o,new S(r)])},me(n,sn),n.prototype.next=function(t){this._o.onNext(t)},n.prototype.error=function(t){this._recurse(t)},n.prototype.completed=function(){this._o.onCompleted()},e}(ln);hn.prototype.catchError=function(){return new dn(this)},hn.prototype.catchErrorWhen=function(t){var e=this;return new ti(function(n){var r,i=new ri,o=new ri,s=t(i),u=s.subscribe(o),c=e[Vt](),a={isDisposed:!1},l=new ke,p=ze.scheduleRecursive(null,function(t,e){if(!a.isDisposed){var s=Dt(c.next).call(c);if(s===jt)return n.onError(s.e);if(s.done)return void(r?n.onError(r):n.onCompleted());var u=s.value;Et(u)&&(u=Ir(u));var p=new De,h=new De;l.setDisposable(new Pe(h,p)),p.setDisposable(u.subscribe(function(t){n.onNext(t)},function(t){h.setDisposable(o.subscribe(e,function(t){n.onError(t)},function(){n.onCompleted()})),i.onNext(t)},function(){n.onCompleted()}))}});return new Ne([u,l,p,new S(a)])})};var vn=function(t){function e(t,e){this.v=t,this.c=null==e?-1:e}function n(t){this.v=t.v,this.l=t.c}return me(e,t),e.prototype[Vt]=function(){return new n(this)},n.prototype.next=function(){return 0===this.l?zt:(this.l>0&&this.l--,{done:!1,value:this.v})},e}(hn),bn=hn.repeat=function(t,e){return new vn(t,e)},yn=function(t){function e(t,e,n){this.s=t,this.fn=e?Zt(e,n,3):null}function n(t){this.i=-1,this.s=t.s,this.l=this.s.length,this.fn=t.fn}return me(e,t),e.prototype[Vt]=function(){return new n(this)},n.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:zt},e}(hn),mn=hn.of=function(t,e,n){return new yn(t,e,n)},_n=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.a=[],sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},me(n,sn),n.prototype.next=function(t){this.a.push(t)},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.o.onNext(this.a),this.o.onCompleted()},e}(ln);$e.toArray=function(){return new _n(this)},cn.create=function(t,e){return new ti(t,e)};var gn=function(t){function e(e){this._f=e,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=Dt(this._f)();return e===jt?Vn(e.e).subscribe(t):(Et(e)&&(e=Ir(e)),e.subscribe(t))},e}(ln),wn=cn.defer=function(t){return new gn(t)},Cn=function(t){function e(e){this.scheduler=e,t.call(this)}function n(t,e){this.observer=t,this.scheduler=e}function r(t,e){return e.onCompleted(),Se}return me(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this.scheduler);return e.run()},n.prototype.run=function(){var t=this.observer;return this.scheduler===Fe?r(null,t):this.scheduler.schedule(t,r)},e}(ln),xn=new Cn(Fe),Sn=cn.empty=function(t){return qe(t)||(t=Fe),t===Fe?xn:new Cn(t)},En=function(t){function e(e,n,r){this.iterable=e,this.mapper=n,this.scheduler=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new On(t,this);return e.run()},e}(ln),On=function(){function t(t,e){this.o=t,this.parent=e}return t.prototype.run=function(){function t(t,e){var o=Dt(n.next).call(n);if(o===jt)return r.onError(o.e);if(o.done)return r.onCompleted();var s=o.value;return Ot(i)&&(s=Dt(i)(s,t),s===jt)?r.onError(s.e):(r.onNext(s),void e(t+1))}var e=Object(this.parent.iterable),n=P(e),r=this.o,i=this.parent.mapper;return this.parent.scheduler.scheduleRecursive(0,t)},t}(),jn=Math.pow(2,53)-1;E.prototype[Vt]=function(){return new O(this._s)},O.prototype[Vt]=function(){return this},O.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:zt},j.prototype[Vt]=function(){return new D(this._a)},D.prototype[Vt]=function(){return this},D.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:zt};var Dn=cn.from=function(t,e,n,r){if(null==t)throw new Error("iterable cannot be null.");if(e&&!Ot(e))throw new Error("mapFn when provided must be a function");if(e)var i=Zt(e,n,2);return qe(r)||(r=ze),new En(t,i,r)},kn=function(t){function e(e,n){this.args=e,this.scheduler=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new M(t,this);return e.run()},e}(ln);M.prototype.run=function(){return this.parent.scheduler.scheduleRecursive(0,A(this.parent.args,this.observer))};var Pn=cn.fromArray=function(t,e){return qe(e)||(e=ze),new kn(t,e)},Nn=function(t){function e(){t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return Se},e}(ln),Tn=new Nn,Mn=cn.never=function(){return Tn};cn.of=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return new kn(e,ze)},cn.ofWithScheduler=function(t){for(var e=arguments.length,n=new Array(e-1),r=1;e>r;r++)n[r-1]=arguments[r];
return new kn(n,t)};var An=function(t){function e(e,n){this.obj=e,this.keys=Object.keys(e),this.scheduler=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new R(t,this);return e.run()},e}(ln);R.prototype.run=function(){function t(t,o){if(i>t){var s=r[t];e.onNext([s,n[s]]),o(t+1)}else e.onCompleted()}var e=this.observer,n=this.parent.obj,r=this.parent.keys,i=r.length;return this.parent.scheduler.scheduleRecursive(0,t)},cn.pairs=function(t,e){return e||(e=ze),new An(t,e)};var qn=function(t){function e(e,n,r){this.start=e,this.rangeCount=n,this.scheduler=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new Ln(t,this);return e.run()},e}(ln),Ln=function(){function t(t,e){this.observer=t,this.parent=e}function e(t,e,n){return function(r,i){e>r?(n.onNext(t+r),i(r+1)):n.onCompleted()}}return t.prototype.run=function(){return this.parent.scheduler.scheduleRecursive(0,e(this.parent.start,this.parent.rangeCount,this.observer))},t}();cn.range=function(t,e,n){return qe(n)||(n=ze),new qn(t,e,n)};var Rn=function(t){function e(e,n,r){this.value=e,this.repeatCount=null==n?-1:n,this.scheduler=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new I(t,this);return e.run()},e}(ln);I.prototype.run=function(){function t(t,r){return(-1===t||t>0)&&(e.onNext(n),t>0&&t--),0===t?e.onCompleted():void r(t)}var e=this.observer,n=this.parent.value;return this.parent.scheduler.scheduleRecursive(this.parent.repeatCount,t)},cn.repeat=function(t,e,n){return qe(n)||(n=ze),new Rn(t,e,n)};var In=function(t){function e(e,n){this.value=e,this.scheduler=n,t.call(this)}function n(t,e,n){this.observer=t,this.value=e,this.scheduler=n}function r(t,e){var n=e[0],r=e[1];return r.onNext(n),r.onCompleted(),Se}return me(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this.value,this.scheduler);return e.run()},n.prototype.run=function(){var t=[this.value,this.observer];return this.scheduler===Fe?r(null,t):this.scheduler.schedule(t,r)},e}(ln),Fn=(cn["return"]=cn.just=function(t,e){return qe(e)||(e=Fe),new In(t,e)},function(t){function e(e,n){this.error=e,this.scheduler=n,t.call(this)}function n(t,e){this.o=t,this.p=e}function r(t,e){var n=e[0],r=e[1];r.onError(n)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new n(t,this);return e.run()},n.prototype.run=function(){return this.p.scheduler.schedule([this.p.error,this.o],r)},e}(ln)),Vn=cn["throw"]=function(t,e){return qe(e)||(e=Fe),new Fn(t,e)},zn=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new De,n=new ke;return n.setDisposable(e),e.setDisposable(this.source.subscribe(new Un(t,n,this._fn))),n},e}(ln),Un=function(t){function e(e,n,r){this._o=e,this._s=n,this._fn=r,t.call(this)}return me(e,t),e.prototype.next=function(t){this._o.onNext(t)},e.prototype.completed=function(){return this._o.onCompleted()},e.prototype.error=function(t){var e=Dt(this._fn)(t);if(e===jt)return this._o.onError(e.e);Et(e)&&(e=Ir(e));var n=new De;this._s.setDisposable(n),n.setDisposable(e.subscribe(this._o))},e}(sn);$e["catch"]=function(t){return Ot(t)?new zn(this,t):Wn([this,t])};var Wn=cn["catch"]=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;e>n;n++)t[n]=arguments[n]}return mn(t).catchError()};$e.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];return Array.isArray(e[0])?e[0].unshift(this):e.unshift(this),Kn.apply(this,e)};var Bn=function(t){function e(e,n){this._params=e,this._cb=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){for(var e=this._params.length,n=new Array(e),r={hasValue:C(e,F),hasValueAll:!1,isDone:C(e,F),values:new Array(e)},i=0;e>i;i++){var o=this._params[i],s=new De;n[i]=s,Et(o)&&(o=Ir(o)),s.setDisposable(o.subscribe(new Zn(t,i,this._cb,r)))}return new Ne(n)},e}(ln),Zn=function(t){function e(e,n,r,i){this._o=e,this._i=n,this._cb=r,this._state=i,t.call(this)}function n(t){return function(e,n){return n!==t}}return me(e,t),e.prototype.next=function(t){if(this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll||(this._state.hasValueAll=this._state.hasValue.every(gt))){var e=Dt(this._cb).apply(null,this._state.values);if(e===jt)return this._o.onError(e.e);this._o.onNext(e)}else this._state.isDone.filter(n(this._i)).every(gt)&&this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._state.isDone[this._i]=!0,this._state.isDone.every(gt)&&this._o.onCompleted()},e}(sn),Kn=cn.combineLatest=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():V;return Array.isArray(e[0])&&(e=e[0]),new Bn(e,r)};$e.concat=function(){for(var t=[],e=0,n=arguments.length;n>e;e++)t.push(arguments[e]);return t.unshift(this),Qn.apply(null,t)};var Hn=function(t){function e(e){this.sources=e,t.call(this)}function n(t,e){this.sources=t,this.o=e}return me(e,t),e.prototype.subscribeCore=function(t){var e=new n(this.sources,t);return e.run()},n.prototype.run=function(){var t,e=new ke,n=this.sources,r=n.length,i=this.o,o=Fe.scheduleRecursive(0,function(o,s){if(!t){if(o===r)return i.onCompleted();var u=n[o];Et(u)&&(u=Ir(u));var c=new De;e.setDisposable(c),c.setDisposable(u.subscribe(function(t){i.onNext(t)},function(t){i.onError(t)},function(){s(o+1)}))}});return new ge(e,o,xe(function(){t=!0}))},e}(ln),Qn=cn.concat=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{t=new Array(arguments.length);for(var e=0,n=arguments.length;n>e;e++)t[e]=arguments[e]}return new Hn(t)};$e.concatAll=function(){return this.merge(1)};var $n=function(t){function e(e,n){this.source=e,this.maxConcurrent=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ge;return e.add(this.source.subscribe(new Yn(t,this.maxConcurrent,e))),e},e}(ln),Yn=function(){function t(t,e,n){this.o=t,this.max=e,this.g=n,this.done=!1,this.q=[],this.activeCount=0,this.isStopped=!1}function e(t,e){this.parent=t,this.sad=e,this.isStopped=!1}return t.prototype.handleSubscribe=function(t){var n=new De;this.g.add(n),Et(t)&&(t=Ir(t)),n.setDisposable(t.subscribe(new e(this,n)))},t.prototype.onNext=function(t){this.isStopped||(this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(t)):this.q.push(t))},t.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},t.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.done=!0,0===this.activeCount&&this.o.onCompleted())},t.prototype.dispose=function(){this.isStopped=!0},t.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},e.prototype.onNext=function(t){this.isStopped||this.parent.o.onNext(t)},e.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.o.onError(t))},e.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var t=this.parent;t.g.remove(this.sad),t.q.length>0?t.handleSubscribe(t.q.shift()):(t.activeCount--,t.done&&0===t.activeCount&&t.o.onCompleted())}},e.prototype.dispose=function(){this.isStopped=!0},e.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(t),!0)},t}();$e.merge=function(t){return"number"!=typeof t?Gn(this,t):new $n(this,t)};var Gn=cn.merge=function(){var t,e,n=[],r=arguments.length;if(arguments[0])if(qe(arguments[0]))for(t=arguments[0],e=1;r>e;e++)n.push(arguments[e]);else for(t=Fe,e=0;r>e;e++)n.push(arguments[e]);else for(t=Fe,e=1;r>e;e++)n.push(arguments[e]);return Array.isArray(n[0])&&(n=n[0]),L(t,n).mergeAll()},Jn=mt.CompositeError=function(t){this.innerErrors=t,this.message="This contains multiple errors. Check the innerErrors",Error.call(this)};Jn.prototype=Object.create(Error.prototype),Jn.prototype.name="CompositeError";var Xn=function(t){function e(e){this.source=e,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ge,n=new De,r={isStopped:!1,errors:[],o:t};return e.add(n),n.setDisposable(this.source.subscribe(new tr(e,r))),e},e}(ln),tr=function(t){function e(e,n){this._group=e,this._state=n,t.call(this)}function n(t,e){0===e.length?t.onCompleted():1===e.length?t.onError(e[0]):t.onError(new Jn(e))}function r(e,n,r){this._inner=e,this._group=n,this._state=r,t.call(this)}return me(e,t),e.prototype.next=function(t){var e=new De;this._group.add(e),Et(t)&&(t=Ir(t)),e.setDisposable(t.subscribe(new r(e,this._group,this._state)))},e.prototype.error=function(t){this._state.errors.push(t),this._state.isStopped=!0,1===this._group.length&&n(this._state.o,this._state.errors)},e.prototype.completed=function(){this._state.isStopped=!0,1===this._group.length&&n(this._state.o,this._state.errors)},me(r,t),r.prototype.next=function(t){this._state.o.onNext(t)},r.prototype.error=function(t){this._state.errors.push(t),this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&n(this._state.o,this._state.errors)},r.prototype.completed=function(){this._group.remove(this._inner),this._state.isStopped&&1===this._group.length&&n(this._state.o,this._state.errors)},e}(sn);cn.mergeDelayError=function(){var t;if(Array.isArray(arguments[0]))t=arguments[0];else{var e=arguments.length;t=new Array(e);for(var n=0;e>n;n++)t[n]=arguments[n]}var r=L(null,t);return new Xn(r)};var er=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.g=e,this.isStopped=!1,this.done=!1}function r(t,e){this.parent=t,this.sad=e,this.isStopped=!1}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ge,r=new De;return e.add(r),r.setDisposable(this.source.subscribe(new n(t,e))),e},n.prototype.onNext=function(t){if(!this.isStopped){var e=new De;this.g.add(e),Et(t)&&(t=Ir(t)),e.setDisposable(t.subscribe(new r(this,e)))}},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.done=!0,1===this.g.length&&this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},r.prototype.onNext=function(t){this.isStopped||this.parent.o.onNext(t)},r.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.parent.o.onError(t))},r.prototype.onCompleted=function(){if(!this.isStopped){var t=this.parent;this.isStopped=!0,t.g.remove(this.sad),t.done&&1===t.g.length&&t.o.onCompleted()}},r.prototype.dispose=function(){this.isStopped=!0},r.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(t),!0)},e}(ln);$e.mergeAll=function(){return new er(this)};var nr=function(t){function e(e,n){this._s=e,this._o=Et(n)?Ir(n):n,this._open=!1,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new De;e.setDisposable(this._s.subscribe(new rr(t,this))),Et(this._o)&&(this._o=Ir(this._o));var n=new De;return n.setDisposable(this._o.subscribe(new ir(t,this,n))),new Pe(e,n)},e}(ln),rr=function(t){function e(e,n){this._o=e,this._p=n,t.call(this)}return me(e,t),e.prototype.next=function(t){this._p._open&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._p._open&&this._o.onCompleted()},e}(sn),ir=function(t){function e(e,n,r){this._o=e,this._p=n,this._r=r,t.call(this)}return me(e,t),e.prototype.next=function(){this._p._open=!0,this._r.dispose()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=function(){this._r.dispose()},e}(sn);$e.skipUntil=function(t){return new nr(this,t)};var or=function(t){function e(e){this.source=e,t.call(this)}function n(t,e){this.o=t,this.inner=e,this.stopped=!1,this.latest=0,this.hasLatest=!1,sn.call(this)}function r(t,e){this.parent=t,this.id=e,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ke,r=this.source.subscribe(new n(t,e));return new Pe(r,e)},me(n,sn),n.prototype.next=function(t){var e=new De,n=++this.latest;this.hasLatest=!0,this.inner.setDisposable(e),Et(t)&&(t=Ir(t)),e.setDisposable(t.subscribe(new r(this,n)))},n.prototype.error=function(t){this.o.onError(t)},n.prototype.completed=function(){this.stopped=!0,!this.hasLatest&&this.o.onCompleted()},me(r,sn),r.prototype.next=function(t){this.parent.latest===this.id&&this.parent.o.onNext(t)},r.prototype.error=function(t){this.parent.latest===this.id&&this.parent.o.onError(t)},r.prototype.completed=function(){this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.isStopped&&this.parent.o.onCompleted())},e}(ln);$e["switch"]=$e.switchLatest=function(){return new or(this)};var sr=function(t){function e(e,n){this.source=e,this.other=Et(n)?Ir(n):n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return new Pe(this.source.subscribe(t),this.other.subscribe(new ur(t)))},e}(ln),ur=function(t){function e(e){this._o=e,t.call(this)}return me(e,t),e.prototype.next=function(){this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.onCompleted=_t,e}(sn);$e.takeUntil=function(t){return new sr(this,t)};var cr=function(t){function e(e,n,r){this._s=e,this._ss=n,this._cb=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){for(var e=this._ss.length,n={hasValue:C(e,F),hasValueAll:!1,values:new Array(e)},r=this._ss.length,i=new Array(r+1),o=0;r>o;o++){var s=this._ss[o],u=new De;Et(s)&&(s=Ir(s)),u.setDisposable(s.subscribe(new ar(t,o,n))),i[o]=u}var u=new De;return u.setDisposable(this._s.subscribe(new lr(t,this._cb,n))),i[r]=u,new Ne(i)},e}(ln),ar=function(t){function e(e,n,r){this._o=e,this._i=n,this._state=r,t.call(this)}return me(e,t),e.prototype.next=function(t){this._state.values[this._i]=t,this._state.hasValue[this._i]=!0,this._state.hasValueAll=this._state.hasValue.every(gt)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=_t,e}(sn),lr=function(t){function e(e,n,r){this._o=e,this._cb=n,this._state=r,t.call(this)}return me(e,t),e.prototype.next=function(t){var e=[t].concat(this._state.values);if(this._state.hasValueAll){var n=Dt(this._cb).apply(null,e);return n===jt?this._o.onError(n.e):void this._o.onNext(n)}},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.withLatestFrom=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():V;return Array.isArray(e[0])&&(e=e[0]),new cr(this,e,r)};var pr=function(t){function e(e,n){this._s=e,this._cb=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=this._s.length,n=new Array(e);done=C(e,F),q=C(e,z);for(var r=0;e>r;r++){var i=this._s[r],o=new De;n[r]=o,Et(i)&&(i=Ir(i)),o.setDisposable(i.subscribe(new hr(t,r,this,q,done)))}return new Ne(n)},e}(ln),hr=function(t){function e(e,n,r,i,o){this._o=e,this._i=n,this._p=r,this._q=i,this._d=o,t.call(this)}function n(t){return t.length>0}function r(t){return t.shift()}function i(t){return function(e,n){return n!==t}}return me(e,t),e.prototype.next=function(t){if(this._q[this._i].push(t),this._q.every(n)){var e=this._q.map(r),o=Dt(this._p._cb).apply(null,e);if(o===jt)return this._o.onError(o.e);this._o.onNext(o)}else this._d.filter(i(this._i)).every(gt)&&this._o.onCompleted()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._d[this._i]=!0,this._d.every(gt)&&this._o.onCompleted()},e}(sn);$e.zip=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():V;Array.isArray(e[0])&&(e=e[0]);var i=this;return e.unshift(i),new pr(e,r)},cn.zip=function(){for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];Array.isArray(e[0])&&(e=Ot(e[1])?e[0].concat(e[1]):e[0]);var r=e.shift();return r.zip.apply(r,e)},$e.zipIterable=function(){if(0===arguments.length)throw new Error("invalid arguments");for(var t=arguments.length,e=new Array(t),n=0;t>n;n++)e[n]=arguments[n];var r=Ot(e[t-1])?e.pop():V,i=this;return e.unshift(i),new ti(function(t){for(var n=e.length,o=C(n,z),s=C(n,F),u=new Array(n),c=0;n>c;c++)!function(n){var c=e[n],a=new De;(Wt(c)||Ut(c))&&(c=Dn(c)),a.setDisposable(c.subscribe(function(e){if(o[n].push(e),o.every(function(t){return t.length>0})){var u=o.map(function(t){return t.shift()}),c=Dt(r).apply(i,u);if(c===jt)return t.onError(c.e);t.onNext(c)}else s.filter(function(t,e){return e!==n}).every(gt)&&t.onCompleted()},function(e){t.onError(e)},function(){s[n]=!0,s.every(gt)&&t.onCompleted()})),u[n]=a}(c);return new ge(u)},i)},$e.asObservable=function(){return new ti(U(this),this)};var fr=function(t){function e(e){this.source=e,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new dr(t))},e}(ln),dr=function(t){function e(e){this._o=e,t.call(this)}return me(e,t),e.prototype.next=function(t){t.accept(this._o)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.dematerialize=function(){return new fr(this)};var vr=function(t){function e(e,n,r){this.source=e,this.keyFn=n,this.comparer=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new br(t,this.keyFn,this.comparer))},e}(ln),br=function(t){function e(e,n,r){this.o=e,this.keyFn=n,this.comparer=r,this.hasCurrentKey=!1,this.currentKey=null,t.call(this)}return me(e,t),e.prototype.next=function(t){var e,n=t;return Ot(this.keyFn)&&(n=Dt(this.keyFn)(t),n===jt)?this.o.onError(n.e):this.hasCurrentKey&&(e=Dt(this.comparer)(this.currentKey,n),e===jt)?this.o.onError(e.e):void(this.hasCurrentKey&&e||(this.hasCurrentKey=!0,this.currentKey=n,this.o.onNext(t)))},e.prototype.error=function(t){this.o.onError(t)},e.prototype.completed=function(){this.o.onCompleted()},e}(sn);$e.distinctUntilChanged=function(t,e){return e||(e=Ct),new vr(this,t,e)};var yr=function(t){function e(e,n,r,i){this.source=e,this._oN=n,this._oE=r,this._oC=i,t.call(this)}function n(t,e){this.o=t,this.t=!e._oN||Ot(e._oN)?on(e._oN||_t,e._oE||_t,e._oC||_t):e._oN,this.isStopped=!1,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this))},me(n,sn),n.prototype.next=function(t){var e=Dt(this.t.onNext).call(this.t,t);e===jt&&this.o.onError(e.e),this.o.onNext(t)},n.prototype.error=function(t){var e=Dt(this.t.onError).call(this.t,t);return e===jt?this.o.onError(e.e):void this.o.onError(t)},n.prototype.completed=function(){var t=Dt(this.t.onCompleted).call(this.t);return t===jt?this.o.onError(t.e):void this.o.onCompleted()},e}(ln);$e["do"]=$e.tap=$e.doAction=function(t,e,n){return new yr(this,t,e,n)},$e.doOnNext=$e.tapOnNext=function(t,e){return this.tap("undefined"!=typeof e?function(n){t.call(e,n)}:t)},$e.doOnError=$e.tapOnError=function(t,e){return this.tap(_t,"undefined"!=typeof e?function(n){t.call(e,n)}:t)},$e.doOnCompleted=$e.tapOnCompleted=function(t,e){return this.tap(_t,null,"undefined"!=typeof e?function(){t.call(e)}:t)},$e["finally"]=function(t){var e=this;return new ti(function(n){var r=Dt(e.subscribe).call(e,n);return r===jt?(t(),l(r.e)):xe(function(){var e=Dt(r.dispose).call(r);t(),e===jt&&l(e.e)})},this)};var mr=function(t){function e(e){this.source=e,t.call(this)}function n(t){this.o=t,this.isStopped=!1}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t))},n.prototype.onNext=_t,n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.observer.onError(t),!0)},e}(ln);$e.ignoreElements=function(){return new mr(this)};var _r=function(t){function e(e,n){this.source=e,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new gr(t))},e}(ln),gr=function(t){function e(e){this._o=e,t.call(this)}return me(e,t),e.prototype.next=function(t){this._o.onNext(tn(t))},e.prototype.error=function(t){this._o.onNext(en(t)),this._o.onCompleted()},e.prototype.completed=function(){this._o.onNext(nn()),this._o.onCompleted()},e}(sn);$e.materialize=function(){return new _r(this)},$e.repeat=function(t){return bn(this,t).concat()},$e.retry=function(t){return bn(this,t).catchError()},$e.retryWhen=function(t){return bn(this).catchErrorWhen(t)};var wr=function(t){function e(e,n,r,i){this.source=e,this.accumulator=n,this.hasSeed=r,this.seed=i,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Cr(t,this))},e}(ln),Cr=function(t){function e(e,n){this._o=e,this._p=n,this._fn=n.accumulator,this._hs=n.hasSeed,this._s=n.seed,this._ha=!1,this._a=null,this._hv=!1,this._i=0,t.call(this)}return me(e,t),e.prototype.next=function(t){return!this._hv&&(this._hv=!0),this._ha?this._a=Dt(this._fn)(this._a,t,this._i,this._p):(this._a=this._hs?Dt(this._fn)(this._s,t,this._i,this._p):t,this._ha=!0),this._a===jt?this._o.onError(this._a.e):(this._o.onNext(this._a),void this._i++)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){!this._hv&&this._hs&&this._o.onNext(this._s),this._o.onCompleted()},e}(sn);$e.scan=function(){var t,e=!1,n=arguments[0];return 2===arguments.length&&(e=!0,t=arguments[1]),new wr(this,n,e,t)};var xr=function(t){function e(e,n){this.source=e,this._c=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Sr(t,this._c))},e}(ln),Sr=function(t){function e(e,n){this._o=e,this._c=n,this._q=[],t.call(this)}return me(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._o.onNext(this._q.shift())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.skipLast=function(t){if(0>t)throw new Lt;return new xr(this,t)},$e.startWith=function(){var t,e=0;arguments.length&&qe(arguments[0])?(t=arguments[0],e=1):t=Fe;for(var n=[],r=e,i=arguments.length;i>r;r++)n.push(arguments[r]);return mn([Pn(n,t),this]).concat()};var Er=function(t){function e(e,n){this._o=e,this._c=n,this._q=[],t.call(this)}return me(e,t),e.prototype.next=function(t){this._q.push(t),this._q.length>this._c&&this._q.shift()},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){for(;this._q.length>0;)this._o.onNext(this._q.shift());this._o.onCompleted()},e}(sn);$e.takeLast=function(t){if(0>t)throw new Lt;var e=this;return new ti(function(n){return e.subscribe(new Er(n,t))},e)},$e.flatMapConcat=$e.concatMap=function(t,e,n){return new pn(this,t,e,n).merge(1)};var Or=function(t){function e(e,n,r){this.source=e,this.selector=Zt(n,r,3),t.call(this)}function n(t,e){return function(n,r,i){return t.call(this,e.selector(n,r,i),r,i)}}function r(t,e,n){this.o=t,this.selector=e,this.source=n,this.i=0,sn.call(this)}return me(e,t),e.prototype.internalMap=function(t,r){return new e(this.source,n(t,this),r)},e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.selector,this))},me(r,sn),r.prototype.next=function(t){var e=Dt(this.selector)(t,this.i++,this.source);return e===jt?this.o.onError(e.e):void this.o.onNext(e)},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(ln);$e.map=$e.select=function(t,e){var n="function"==typeof t?t:function(){return t};return this instanceof Or?this.internalMap(n,e):new Or(this,n,e)},$e.pluck=function(){var t=arguments.length,e=new Array(t);if(0===t)throw new Error("List of properties cannot be empty.");for(var n=0;t>n;n++)e[n]=arguments[n];return this.map(W(e,t))},$e.flatMap=$e.selectMany=function(t,e,n){return new pn(this,t,e,n).mergeAll()},mt.Observable.prototype.flatMapLatest=function(t,e,n){return new pn(this,t,e,n).switchLatest()};var jr=function(t){function e(e,n){this.source=e,this.skipCount=n,t.call(this)}function n(t,e){this.c=e,this.r=e,this.o=t,this.isStopped=!1}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.skipCount))},n.prototype.onNext=function(t){this.isStopped||(this.r<=0?this.o.onNext(t):this.r--)},n.prototype.onError=function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},n.prototype.dispose=function(){this.isStopped=!0},n.prototype.fail=function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)},e}(ln);$e.skip=function(t){if(0>t)throw new Lt;return new jr(this,t)};var Dr=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new kr(t,this))},e}(ln),kr=function(t){function e(e,n){this._o=e,this._p=n,this._i=0,this._r=!1,t.call(this)}return me(e,t),e.prototype.next=function(t){if(!this._r){var e=Dt(this._p._fn)(t,this._i++,this._p);if(e===jt)return this._o.onError(e.e);this._r=!e}this._r&&this._o.onNext(t)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.skipWhile=function(t,e){var n=Zt(t,e,3);return new Dr(this,n)};var Pr=function(t){function e(e,n){this.source=e,this.takeCount=n,t.call(this)}function n(t,e){this.o=t,this.c=e,this.r=e,this.isStopped=!1}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.takeCount))},n.prototype={onNext:function(t){this.isStopped||this.r-->0&&(this.o.onNext(t),this.r<=0&&this.o.onCompleted())},onError:function(t){this.isStopped||(this.isStopped=!0,this.o.onError(t))},onCompleted:function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())},dispose:function(){this.isStopped=!0},fail:function(t){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(t),!0)}},e}(ln);$e.take=function(t,e){if(0>t)throw new Lt;return 0===t?Sn(e):new Pr(this,t)};var Nr=function(t){function e(e,n){this.source=e,this._fn=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Tr(t,this))},e}(ln),Tr=function(t){function e(e,n){this._o=e,this._p=n,this._i=0,this._r=!0,t.call(this)}return me(e,t),e.prototype.next=function(t){return this._r&&(this._r=Dt(this._p._fn)(t,this._i++,this._p),this._r===jt)?this._o.onError(this._r.e):void(this._r?this._o.onNext(t):this._o.onCompleted())},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.takeWhile=function(t,e){var n=Zt(t,e,3);return new Nr(this,n)};var Mr=function(t){function e(e,n,r){this.source=e,this.predicate=Zt(n,r,3),t.call(this)}function n(t,e){return function(n,r,i){return e.predicate(n,r,i)&&t.call(this,n,r,i)}}function r(t,e,n){this.o=t,this.predicate=e,this.source=n,this.i=0,sn.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.predicate,this))},e.prototype.internalFilter=function(t,r){return new e(this.source,n(t,this),r)},me(r,sn),r.prototype.next=function(t){var e=Dt(this.predicate)(t,this.i++,this.source);return e===jt?this.o.onError(e.e):void(e&&this.o.onNext(t))},r.prototype.error=function(t){this.o.onError(t)},r.prototype.completed=function(){this.o.onCompleted()},e}(ln);$e.filter=$e.where=function(t,e){return this instanceof Mr?this.internalFilter(t,e):new Mr(this,t,e)},cn.fromCallback=function(t,e,n){return function(){"undefined"==typeof e&&(e=this);for(var r=arguments.length,i=new Array(r),o=0;r>o;o++)i[o]=arguments[o];return B(t,e,n,i)}},cn.fromNodeCallback=function(t,e,n){return function(){"undefined"==typeof e&&(e=this);for(var r=arguments.length,i=new Array(r),o=0;r>o;o++)i[o]=arguments[o];return K(t,e,n,i)}},$.prototype.dispose=function(){this.isDisposed||(this._e.removeEventListener(this._n,this._fn,!1),this.isDisposed=!0)},mt.config.useNativeEvents=!1;var Ar=function(t){function e(e,n,r){this._el=e,this._n=n,this._fn=r,t.call(this)}function n(t,e){return function(){var n=arguments[0];return Ot(e)&&(n=Dt(e).apply(null,arguments),n===jt)?t.onError(n.e):void t.onNext(n)}}return me(e,t),e.prototype.subscribeCore=function(t){return Y(this._el,this._n,n(t,this._fn))},e}(ln);cn.fromEvent=function(t,e,n){return t.addListener?Lr(function(n){t.addListener(e,n)},function(n){t.removeListener(e,n)},n):mt.config.useNativeEvents||"function"!=typeof t.on||"function"!=typeof t.off?new Ar(t,e,n).publish().refCount():Lr(function(n){t.on(e,n)},function(n){t.off(e,n)},n)};var qr=function(t){function e(e,n,r){this._add=e,this._del=n,this._fn=r,t.call(this)}function n(t,e){return function(){var n=arguments[0];return Ot(e)&&(n=Dt(e).apply(null,arguments),n===jt)?t.onError(n.e):void t.onNext(n)}}function r(t,e,n){this._del=t,this._fn=e,this._ret=n,this.isDisposed=!1}return me(e,t),e.prototype.subscribeCore=function(t){var e=n(t,this._fn),i=this._add(e);return new r(this._del,e,i)},r.prototype.dispose=function(){this.isDisposed||Ot(this._del)&&this._del(this._fn,this._ret)},e}(ln),Lr=cn.fromEventPattern=function(t,e,n){return new qr(t,e,n).publish().refCount()},Rr=function(t){function e(e,n){this._p=e,this._s=n,t.call(this)}function n(t,e){var n=e[0],r=e[1];n.onNext(r),n.onCompleted()}function r(t,e){var n=e[0],r=e[1];n.onError(r)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new De,i=this;return this._p.then(function(r){e.setDisposable(i._s.schedule([t,r],n))},function(n){e.setDisposable(i._s.schedule([t,n],r))}),e},e}(ln),Ir=cn.fromPromise=function(t,e){return e||(e=Ke),new Rr(t,e)};$e.toPromise=function(t){if(t||(t=mt.config.Promise),!t)throw new Rt("Promise type not provided nor in Rx.config.Promise");var e=this;return new t(function(t,n){var r;e.subscribe(function(t){r=t},n,function(){t(r)})})},cn.startAsync=function(t){var e=Dt(t)();return e===jt?Vn(e.e):Ir(e)};var Fr=function(t){function e(e,n,r){this.source=e,this._fn1=n,this._fn2=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=this.source.multicast(this._fn1());return new Pe(this._fn2(e).subscribe(t),e.connect())},e}(ln);$e.multicast=function(t,e){return Ot(t)?new Fr(this,t,e):new zr(this,t)},$e.publish=function(t){return t&&Ot(t)?this.multicast(function(){return new ri},t):this.multicast(new ri)},$e.share=function(){return this.publish().refCount()},$e.publishLast=function(t){return t&&Ot(t)?this.multicast(function(){return new ii},t):this.multicast(new ii)},$e.publishValue=function(t,e){return 2===arguments.length?this.multicast(function(){return new si(e)},t):this.multicast(new si(t))},$e.shareValue=function(t){return this.publishValue(t).refCount()},$e.replay=function(t,e,n,r){return t&&Ot(t)?this.multicast(function(){return new ui(e,n,r)},t):this.multicast(new ui(e,n,r))},$e.shareReplay=function(t,e,n){return this.replay(null,t,e,n).refCount()};var Vr=function(t){function e(e){this.source=e,this._count=0,this._connectableSubscription=null,t.call(this)}function n(t,e){this._p=t,this._s=e,this.isDisposed=!1}return me(e,t),e.prototype.subscribeCore=function(t){var e=1===++this._count,r=this.source.subscribe(t);return e&&(this._connectableSubscription=this.source.connect()),new n(this,r)},n.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._s.dispose(),0===--this._p._count&&this._p._connectableSubscription.dispose())},e}(ln),zr=mt.ConnectableObservable=function(t){function e(e,n){this.source=e,this._hasSubscription=!1,this._subscription=null,this._sourceObservable=e.asObservable(),this._subject=n,t.call(this)}function n(t){this._p=t,this.isDisposed=!1}return me(e,t),n.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._p._hasSubscription=!1)},e.prototype.connect=function(){return this._hasSubscription||(this._hasSubscription=!0,this._subscription=new Pe(this._sourceObservable.subscribe(this._subject),new n(this))),
this._subscription},e.prototype._subscribe=function(t){return this._subject.subscribe(t)},e.prototype.refCount=function(){return new Vr(this)},e}(cn),Ur=function(t){function e(e,n){this._dt=e,this._s=n,t.call(this)}function n(t,e){e.onNext(0),e.onCompleted()}return me(e,t),e.prototype.subscribeCore=function(t){return this._s.scheduleFuture(t,this._dt,n)},e}(ln),Wr=cn.interval=function(t,e){return X(t,t,qe(e)?e:Ke)};cn.timer=function(t,e,n){var r;return qe(n)||(n=Ke),null!=e&&"number"==typeof e?r=e:qe(e)&&(n=e),(t instanceof Date||"number"==typeof t)&&r===s?G(t,n):t instanceof Date&&r!==s?J(t.getTime(),e,n):X(t,r,n)};$e.delay=function(){var t=arguments[0];if("number"==typeof t||t instanceof Date){var e=t,n=arguments[1];return qe(n)||(n=Ke),e instanceof Date?et(this,e,n):tt(this,e,n)}if(cn.isObservable(t)||Ot(t))return nt(this,t,arguments[1]);throw new Error("Invalid arguments")};var Br=function(t){function e(e,n,r){qe(r)||(r=Ke),this.source=e,this._dt=n,this._s=r,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){var e=new ke;return new Pe(this.source.subscribe(new Zr(t,this.source,this._dt,this._s,e)),e)},e}(ln),Zr=function(t){function e(e,n,r,i,o){this._o=e,this._s=n,this._d=r,this._scheduler=i,this._c=o,this._v=null,this._hv=!1,this._id=0,t.call(this)}return me(e,t),e.prototype.next=function(t){this._hv=!0,this._v=t;var e=++this._id,n=new De;this._c.setDisposable(n),n.setDisposable(this._scheduler.scheduleFuture(this,this._d,function(n,r){r._hv&&r._id===e&&r._o.onNext(t),r._hv=!1}))},e.prototype.error=function(t){this._c.dispose(),this._o.onError(t),this._hv=!1,this._id++},e.prototype.completed=function(){this._c.dispose(),this._hv&&this._o.onNext(this._v),this._o.onCompleted(),this._hv=!1,this._id++},e}(sn);$e.debounce=function(){if(Ot(arguments[0]))return rt(this,arguments[0]);if("number"==typeof arguments[0])return new Br(this,arguments[0],arguments[1]);throw new Error("Invalid arguments")};var Kr=function(t){function e(e,n){this.source=e,this._s=n,t.call(this)}return me(e,t),e.prototype.subscribeCore=function(t){return this.source.subscribe(new Hr(t,this._s))},e}(ln),Hr=function(t){function e(e,n){this._o=e,this._s=n,t.call(this)}return me(e,t),e.prototype.next=function(t){this._o.onNext({value:t,timestamp:this._s.now()})},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._o.onCompleted()},e}(sn);$e.timestamp=function(t){return qe(t)||(t=Ke),new Kr(this,t)},$e.sample=$e.throttleLatest=function(t,e){return qe(e)||(e=Ke),"number"==typeof t?it(this,Wr(t,e)):it(this,t)};var Qr=mt.TimeoutError=function(t){this.message=t||"Timeout has occurred",this.name="TimeoutError",Error.call(this)};Qr.prototype=Object.create(Error.prototype),$e.timeout=function(){var t=arguments[0];if(t instanceof Date||"number"==typeof t)return st(this,t,arguments[1],arguments[2]);if(cn.isObservable(t)||Ot(t))return ot(this,t,arguments[1],arguments[2]);throw new Error("Invalid arguments")},$e.throttle=function(t,e){qe(e)||(e=Ke);var n=+t||0;if(0>=n)throw new RangeError("windowDuration cannot be less or equal zero.");var r=this;return new ti(function(t){var i=0;return r.subscribe(function(r){var o=e.now();(0===i||o-i>=n)&&(i=o,t.onNext(r))},function(e){t.onError(e)},function(){t.onCompleted()})},r)};var $r=function(t){function e(e,n){this.source=e,this.controller=new ri,n&&n.subscribe?this.pauser=this.controller.merge(n):this.pauser=this.controller,t.call(this)}return me(e,t),e.prototype._subscribe=function(t){var e=this.source.publish(),n=e.subscribe(t),r=Se,i=this.pauser.distinctUntilChanged().subscribe(function(t){t?r=e.connect():(r.dispose(),r=Se)});return new Ne([n,r,i])},e.prototype.pause=function(){this.controller.onNext(!1)},e.prototype.resume=function(){this.controller.onNext(!0)},e}(cn);$e.pausable=function(t){return new $r(this,t)};var Yr=function(t){function e(e,n){this.source=e,this.controller=new ri,n&&n.subscribe?this.pauser=this.controller.merge(n):this.pauser=this.controller,t.call(this)}return me(e,t),e.prototype._subscribe=function(t){function e(){for(;r.length>0;)t.onNext(r.shift())}var n,r=[],i=ut(this.source,this.pauser.startWith(!1).distinctUntilChanged(),function(t,e){return{data:t,shouldFire:e}}).subscribe(function(i){n!==s&&i.shouldFire!==n?(n=i.shouldFire,i.shouldFire&&e()):(n=i.shouldFire,i.shouldFire?t.onNext(i.data):r.push(i.data))},function(n){e(),t.onError(n)},function(){e(),t.onCompleted()});return i},e.prototype.pause=function(){this.controller.onNext(!1)},e.prototype.resume=function(){this.controller.onNext(!0)},e}(cn);$e.pausableBuffered=function(t){return new Yr(this,t)};var Gr=function(t){function e(e,n,r){t.call(this),this.subject=new Jr(n,r),this.source=e.multicast(this.subject).refCount()}return me(e,t),e.prototype._subscribe=function(t){return this.source.subscribe(t)},e.prototype.request=function(t){return this.subject.request(null==t?-1:t)},e}(cn),Jr=function(t){function e(e,n){null==e&&(e=!0),t.call(this),this.subject=new ri,this.enableQueue=e,this.queue=e?[]:null,this.requestedCount=0,this.requestedDisposable=null,this.error=null,this.hasFailed=!1,this.hasCompleted=!1,this.scheduler=n||ze}return me(e,t),_e(e.prototype,rn,{_subscribe:function(t){return this.subject.subscribe(t)},onCompleted:function(){this.hasCompleted=!0,this.enableQueue&&0!==this.queue.length?this.queue.push(Ye.createOnCompleted()):(this.subject.onCompleted(),this.disposeCurrentRequest())},onError:function(t){this.hasFailed=!0,this.error=t,this.enableQueue&&0!==this.queue.length?this.queue.push(Ye.createOnError(t)):(this.subject.onError(t),this.disposeCurrentRequest())},onNext:function(t){this.requestedCount<=0?this.enableQueue&&this.queue.push(Ye.createOnNext(t)):(0===this.requestedCount--&&this.disposeCurrentRequest(),this.subject.onNext(t))},_processRequest:function(t){if(this.enableQueue)for(;this.queue.length>0&&(t>0||"N"!==this.queue[0].kind);){var e=this.queue.shift();e.accept(this.subject),"N"===e.kind?t--:(this.disposeCurrentRequest(),this.queue=[])}return t},request:function(t){this.disposeCurrentRequest();var e=this;return this.requestedDisposable=this.scheduler.schedule(t,function(t,n){var r=e._processRequest(n),i=e.hasCompleted||e.hasFailed;return!i&&r>0?(e.requestedCount=r,xe(function(){e.requestedCount=0})):void 0}),this.requestedDisposable},disposeCurrentRequest:function(){this.requestedDisposable&&(this.requestedDisposable.dispose(),this.requestedDisposable=null)}}),e}(cn);$e.controlled=function(t,e){return t&&qe(t)&&(e=t,t=!0),null==t&&(t=!0),new Gr(this,t,e)},$e.pipe=function(t){function e(){n.resume()}var n=this.pausableBuffered();return t.addListener("drain",e),n.subscribe(function(e){!t.write(String(e))&&n.pause()},function(e){t.emit("error",e)},function(){!t._isStdio&&t.end(),t.removeListener("drain",e)}),n.resume(),t};var Xr=function(t){function e(e,n){this._o=e,this._xform=n,t.call(this)}return me(e,t),e.prototype.next=function(t){var e=Dt(this._xform["@@transducer/step"]).call(this._xform,this._o,t);e===jt&&this._o.onError(e.e)},e.prototype.error=function(t){this._o.onError(t)},e.prototype.completed=function(){this._xform["@@transducer/result"](this._o)},e}(sn);$e.transduce=function(t){var e=this;return new ti(function(n){var r=t(ct(n));return e.subscribe(new Xr(n,r))},e)};var ti=mt.AnonymousObservable=function(t){function e(t){return t&&Ot(t.dispose)?t:Ot(t)?xe(t):Se}function n(t,n){var r=n[0],i=n[1],o=Dt(i.__subscribe).call(i,r);o!==jt||r.fail(jt.e)||l(jt.e),r.setDisposable(e(o))}function r(e,n){this.source=n,this.__subscribe=e,t.call(this)}return me(r,t),r.prototype._subscribe=function(t){var e=new ei(t),r=[e,this];return ze.scheduleRequired()?ze.schedule(r,n):n(null,r),e},r}(cn),ei=function(t){function e(e){t.call(this),this.observer=e,this.m=new De}me(e,t);var n=e.prototype;return n.next=function(t){var e=Dt(this.observer.onNext).call(this.observer,t);e===jt&&(this.dispose(),l(e.e))},n.error=function(t){var e=Dt(this.observer.onError).call(this.observer,t);this.dispose(),e===jt&&l(e.e)},n.completed=function(){var t=Dt(this.observer.onCompleted).call(this.observer);this.dispose(),t===jt&&l(t.e)},n.setDisposable=function(t){this.m.setDisposable(t)},n.getDisposable=function(){return this.m.getDisposable()},n.dispose=function(){t.prototype.dispose.call(this),this.m.dispose()},e}(sn),ni=function(t,e){this._s=t,this._o=e};ni.prototype.dispose=function(){if(!this._s.isDisposed&&null!==this._o){var t=this._s.observers.indexOf(this._o);this._s.observers.splice(t,1),this._o=null}};var ri=mt.Subject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.observers=[],this.hasError=!1}return me(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?this.hasError?(t.onError(this.error),Se):(t.onCompleted(),Se):(this.observers.push(t),new ni(this,t))},hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=c(this.observers),n=e.length;n>t;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(Oe(this),!this.isStopped)for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onNext(t)},dispose:function(){this.isDisposed=!0,this.observers=null}}),e.create=function(t,e){return new oi(t,e)},e}(cn),ii=mt.AsyncSubject=function(t){function e(){t.call(this),this.isDisposed=!1,this.isStopped=!1,this.hasValue=!1,this.observers=[],this.hasError=!1}return me(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?(this.hasError?t.onError(this.error):this.hasValue?(t.onNext(this.value),t.onCompleted()):t.onCompleted(),Se):(this.observers.push(t),new ni(this,t))},hasObservers:function(){return Oe(this),this.observers.length>0},onCompleted:function(){var t,e;if(Oe(this),!this.isStopped){this.isStopped=!0;var n=c(this.observers),e=n.length;if(this.hasValue)for(t=0;e>t;t++){var r=n[t];r.onNext(this.value),r.onCompleted()}else for(t=0;e>t;t++)n[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){Oe(this),this.isStopped||(this.value=t,this.hasValue=!0)},dispose:function(){this.isDisposed=!0,this.observers=null,this.error=null,this.value=null}}),e}(cn),oi=mt.AnonymousSubject=function(t){function e(e,n){this.observer=e,this.observable=n,t.call(this)}return me(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return this.observable.subscribe(t)},onCompleted:function(){this.observer.onCompleted()},onError:function(t){this.observer.onError(t)},onNext:function(t){this.observer.onNext(t)}}),e}(cn),si=mt.BehaviorSubject=function(t){function e(e){t.call(this),this.value=e,this.observers=[],this.isDisposed=!1,this.isStopped=!1,this.hasError=!1}return me(e,t),_e(e.prototype,rn.prototype,{_subscribe:function(t){return Oe(this),this.isStopped?(this.hasError?t.onError(this.error):t.onCompleted(),Se):(this.observers.push(t),t.onNext(this.value),new ni(this,t))},getValue:function(){if(Oe(this),this.hasError)throw this.error;return this.value},hasObservers:function(){return this.observers.length>0},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;for(var t=0,e=c(this.observers),n=e.length;n>t;t++)e[t].onCompleted();this.observers.length=0}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.hasError=!0,this.error=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onError(t);this.observers.length=0}},onNext:function(t){if(Oe(this),!this.isStopped){this.value=t;for(var e=0,n=c(this.observers),r=n.length;r>e;e++)n[e].onNext(t)}},dispose:function(){this.isDisposed=!0,this.observers=null,this.value=null,this.error=null}}),e}(cn),ui=mt.ReplaySubject=function(t){function e(t,e){return xe(function(){e.dispose(),!t.isDisposed&&t.observers.splice(t.observers.indexOf(e),1)})}function n(e,n,i){this.bufferSize=null==e?r:e,this.windowSize=null==n?r:n,this.scheduler=i||ze,this.q=[],this.observers=[],this.isStopped=!1,this.isDisposed=!1,this.hasError=!1,this.error=null,t.call(this)}var r=Math.pow(2,53)-1;return me(n,t),_e(n.prototype,rn.prototype,{_subscribe:function(t){Oe(this);var n=new an(this.scheduler,t),r=e(this,n);this._trim(this.scheduler.now()),this.observers.push(n);for(var i=0,o=this.q.length;o>i;i++)n.onNext(this.q[i].value);return this.hasError?n.onError(this.error):this.isStopped&&n.onCompleted(),n.ensureActive(),r},hasObservers:function(){return this.observers.length>0},_trim:function(t){for(;this.q.length>this.bufferSize;)this.q.shift();for(;this.q.length>0&&t-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(t){if(Oe(this),!this.isStopped){var e=this.scheduler.now();this.q.push({interval:e,value:t}),this._trim(e);for(var n=0,r=c(this.observers),i=r.length;i>n;n++){var o=r[n];o.onNext(t),o.ensureActive()}}},onError:function(t){if(Oe(this),!this.isStopped){this.isStopped=!0,this.error=t,this.hasError=!0;var e=this.scheduler.now();this._trim(e);for(var n=0,r=c(this.observers),i=r.length;i>n;n++){var o=r[n];o.onError(t),o.ensureActive()}this.observers.length=0}},onCompleted:function(){if(Oe(this),!this.isStopped){this.isStopped=!0;var t=this.scheduler.now();this._trim(t);for(var e=0,n=c(this.observers),r=n.length;r>e;e++){var i=n[e];i.onCompleted(),i.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0,this.observers=null}}),n}(cn);mt.Pauser=function(t){function e(){t.call(this)}return me(e,t),e.prototype.pause=function(){this.onNext(!1)},e.prototype.resume=function(){this.onNext(!0)},e}(ri),yt.Rx=mt,r=function(){return mt}.call(e,n,e,t),!(r!==s&&(t.exports=r));var ci=v()}).call(this)}).call(e,n(38)(t),function(){return this}(),n(11))},function(t,e,n){e=t.exports=n(20)(),e.push([t.id,".climb__wall{width:100%;padding:0;margin:0;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;font-size:100%}.climb__tile,.climb__wall{display:-webkit-flex;display:-ms-flexbox;display:flex}.climb__tile{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:425px;box-sizing:border-box;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-bottom:20px;overflow:hidden;text-align:left;border-radius:7px;background-color:#f6f6f6;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:1000px;perspective:1000px}.climb__tile__content{z-index:1;padding:26px;background-color:#f6f6f6}.climb__tile--has-no-image .climb__tile__content{height:100%;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;box-sizing:border-box}.climb__image{display:block;max-width:100%;z-index:5}.climb__tile .climb__image{position:absolute;top:0;border-top-left-radius:7px;border-top-right-radius:7px}.climb-slideshow .climb__image{box-shadow:0 0 14px 0 rgba(0,0,0,.75);border-radius:7px}.climb__message{z-index:1}.climb__message>a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:260px;display:inline-block;vertical-align:bottom}.climb-tile .climb__message{margin-bottom:24px}.climb__tile--has-no-image .climb__message{font-size:185%}.climb-slideshow__slide--has-no-image .climb__message{font-size:220%}.climb__author{display:inline-block;margin:-10px}.climb__author img{border-radius:25px}.climb__author .climb__tile__author__username{display:inline-block;margin:0 0 0 10px;line-height:34px;vertical-align:top}.climb-social-badge{position:fixed;bottom:20px;right:20px;z-index:9;background-color:#a9cae2;width:200px;height:66px;border-radius:5px}.climb-social-badge>span{position:absolute!important;top:-9999px!important;left:-9999px!important}.climb-slideshow{height:100vh;width:100vw;font-size:160%}.climb__slideshow__container{width:100%;height:100%;position:relative}.climb-slideshow__slide{position:absolute;width:100%;height:100%;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}.climb-slideshow__panel,.climb-slideshow__slide{-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:1000px;perspective:1000px}.climb-slideshow__panel{box-sizing:border-box;display:inline-block;position:relative;padding:30px 15px 5px;width:50%;border-radius:3px;background-color:#f6f6f6}.climb-slideshow__slide--has-no-image .climb-slideshow__panel{padding:30px;border-radius:7px;box-shadow:0 0 14px 0 rgba(0,0,0,.75)}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<e.length;i++){var s=e[i];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(t,e,n){var r,i,o;!function(n,s){i=[e,t],r=s,o="function"==typeof r?r.apply(e,i):r,!(void 0!==o&&(t.exports=o))}(this,function(t,e){"use strict";function n(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function r(t){try{delete window[t]}catch(e){window[t]=void 0}}function i(t){var e=document.getElementById(t);document.getElementsByTagName("head")[0].removeChild(e)}var o={timeout:5e3,jsonpCallback:"callback"},s=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=null!=e.timeout?e.timeout:o.timeout,u=null!=e.jsonpCallback?e.jsonpCallback:o.jsonpCallback,c=void 0;return new Promise(function(e,o){var a=n();window[a]=function(t){e({ok:!0,json:function(){return Promise.resolve(t)}}),c&&clearTimeout(c),i(u+"_"+a),r(a)},t+=-1===t.indexOf("?")?"?":"&";var l=document.createElement("script");l.setAttribute("src",t+u+"="+a),l.id=u+"_"+a,document.getElementsByTagName("head")[0].appendChild(l),c=setTimeout(function(){o(new Error("JSONP request to "+t+" timed out")),r(a),i(u+"_"+a)},s)})};e.exports=s})},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(){function t(){var e=d(),n=e-y;y=e,m+=n*u,m>i*l&&(m=0);for(var r=Math.ceil(m/i),o=0;o<v.length;o++){var s=v[o],c=s.active,a=s.animationStep,p=s.prevState,f=v[o].nextState;if(c)if(0>=m)v[o].nextState=a(i/1e3,p);else for(var _=0;r>_;_++){v[o].nextState=a(i/1e3,f);var g=[f,v[o].nextState];v[o].prevState=g[0],f=g[1]}}m-=r*i;for(var w=1+m/i,o=0;o<v.length;o++){var C=v[o],x=C.animationRender,S=C.nextState,E=C.prevState;x(w,S,E)}v=v.filter(function(t){var e=t.active;return e}),0===v.length?b=!1:h(t)}function e(){b||(b=!0,y=d(),m=0,h(t))}var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=n.timeStep,i=void 0===r?1/60*1e3:r,o=n.timeScale,u=void 0===o?1:o,a=n.maxSteps,l=void 0===a?10:a,p=n.raf,h=void 0===p?c["default"]:p,f=n.now,d=void 0===f?s["default"]:f,v=[],b=!1,y=0,m=0;return function(t,n,r){for(var i=0;i<v.length;i++){var o=v[i];if(o.animationStep===n)return o.active=!0,o.prevState=t,e(),o.stop}var s={animationStep:n,animationRender:r,prevState:t,nextState:t,active:!0};return s.stop=function(){return s.active=!1},v.push(s),e(),s.stop}}e.__esModule=!0,e["default"]=i;var o=n(10),s=r(o),u=n(34),c=r(u);t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r],r));return n}function o(t,e){for(var n in e)if(e.hasOwnProperty(n)&&!t(e[n],n))return!1;return!0}function s(t){var e=t.PropTypes,n=t.createClass({displayName:"Motion",propTypes:{defaultValue:function(t,e){return t[e]?new Error("Spring's `defaultValue` has been changed to `defaultStyle`. Its format received a few (easy to update!) changes as well."):void 0},endValue:function(t,e){return t[e]?new Error("Spring's `endValue` has been changed to `style`. Its format received a few (easy to update!) changes as well."):void 0},defaultStyle:e.object,style:e.object.isRequired,children:e.func.isRequired},getInitialState:function(){var t=this.props,e=t.defaultStyle,n=t.style,r=e||n;return{currentStyle:r,currentVelocity:i(y["default"],r)}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyle,r=e.currentVelocity,i=this.props.style,o=m.updateCurrentStyle(t,n,r,i),s=m.updateCurrentVelocity(t,n,r,i);return a["default"](r,o)&&a["default"](s,o)&&this.stopAnimation(),{currentStyle:o,currentVelocity:s}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=x(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){this.hasUnmounted||this.setState({currentStyle:m.interpolateValue(t,e.currentStyle,n.currentStyle),currentVelocity:e.currentVelocity})},render:function(){var e=C["default"](this.state.currentStyle),n=this.props.children(e);return n&&t.Children.only(n)}}),r=t.createClass({displayName:"StaggeredMotion",propTypes:{defaultStyle:function(t,e){return t[e]?new Error('You forgot the "s" for `StaggeredMotion`\'s `defaultStyles`.'):void 0},style:function(t,e){return t[e]?new Error('You forgot the "s" for `StaggeredMotion`\'s `styles`.'):void 0},defaultStyles:e.arrayOf(e.object),styles:e.func.isRequired,children:e.func.isRequired},getInitialState:function(){var t=this.props,e=t.styles,n=t.defaultStyles,r=n?n:e();return{currentStyles:r,currentVelocities:r.map(function(t){return i(y["default"],t)})}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyles,r=e.currentVelocities,i=this.props.styles(n.map(C["default"])),o=n.map(function(e,n){return m.updateCurrentStyle(t,e,r[n],i[n])}),s=n.map(function(e,n){return m.updateCurrentVelocity(t,e,r[n],i[n])});return r.every(function(t,e){return a["default"](t,n[e])})&&s.every(function(t,e){return a["default"](t,o[e])})&&this.stopAnimation(),{currentStyles:o,currentVelocities:s}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=x(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){if(!this.hasUnmounted){var r=e.currentStyles.map(function(e,r){return m.interpolateValue(t,e,n.currentStyles[r])});this.setState({currentStyles:r,currentVelocities:e.currentVelocities})}},render:function(){var e=this.state.currentStyles.map(C["default"]),n=this.props.children(e);return n&&t.Children.only(n)}}),s=t.createClass({displayName:"TransitionMotion",propTypes:{defaultValue:function(t,e){return t[e]?new Error("TransitionSpring's `defaultValue` has been changed to `defaultStyles`. Its format received a few (easy to update!) changes as well."):void 0},endValue:function(t,e){return t[e]?new Error("TransitionSpring's `endValue` has been changed to `styles`. Its format received a few (easy to update!) changes as well."):void 0},defaultStyle:function(t,e){return t[e]?new Error('You forgot the "s" for `TransitionMotion`\'s `defaultStyles`.'):void 0},style:function(t,e){return t[e]?new Error('You forgot the "s" for `TransitionMotion`\'s `styles`.'):void 0},defaultStyles:e.objectOf(e.any),styles:e.oneOfType([e.func,e.objectOf(e.any.isRequired)]).isRequired,willLeave:e.oneOfType([e.func]),willEnter:e.oneOfType([e.func]),children:e.func.isRequired},getDefaultProps:function(){return{willEnter:function(t,e){return e},willLeave:function(){return null}}},getInitialState:function(){var t=this.props,e=t.styles,n=t.defaultStyles,r=void 0;return r=null==n?"function"==typeof e?e():e:n,{currentStyles:r,currentVelocities:i(function(t){return i(y["default"],t)},r)}},componentDidMount:function(){this.startAnimating()},componentWillReceiveProps:function(){this.startAnimating()},animationStep:function(t,e){var n=e.currentStyles,r=e.currentVelocities,s=this.props,c=s.styles,l=s.willEnter,h=s.willLeave;"function"==typeof c&&(c=c(n));var d=c,v=!1;d=f["default"](n,c,function(t){var e=h(t,n[t],c,n,r);return null==e?null:a["default"](r[t],n[t])&&p["default"](n[t],e)?null:e}),Object.keys(d).filter(function(t){return!n.hasOwnProperty(t)}).forEach(function(t){var e,o;v=!0;var s=l(t,d[t],c,n,r);d[t]=s,n=u({},n,(e={},e[t]=s,e)),r=u({},r,(o={},o[t]=i(y["default"],s),o))});var b=i(function(e,i){return m.updateCurrentStyle(t,n[i],r[i],e)},d),_=i(function(e,i){return m.updateCurrentVelocity(t,n[i],r[i],e)},d);return!v&&o(function(t,e){return a["default"](t,n[e])},r)&&o(function(t,e){return a["default"](t,b[e])},_)&&this.stopAnimation(),{currentStyles:b,currentVelocities:_}},stopAnimation:null,hasUnmounted:!1,componentWillUnmount:function(){this.stopAnimation(),this.hasUnmounted=!0},startAnimating:function(){this.stopAnimation=x(this.state,this.animationStep,this.animationRender)},animationRender:function(t,e,n){if(!this.hasUnmounted){var r=i(function(e,r){return m.interpolateValue(t,e,n.currentStyles[r])},e.currentStyles);this.setState({currentStyles:r,currentVelocities:e.currentVelocities})}},render:function(){var e=i(C["default"],this.state.currentStyles),n=this.props.children(e);return n&&t.Children.only(n)}}),c=g["default"](t),l=c.Spring,h=c.TransitionSpring;return{Spring:l,TransitionSpring:h,Motion:n,StaggeredMotion:r,TransitionMotion:s}}e.__esModule=!0;var u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e["default"]=s;var c=n(27),a=r(c),l=n(25),p=r(l),h=n(26),f=r(h),d=n(22),v=r(d),b=n(33),y=r(b),m=n(32),_=n(24),g=r(_),w=n(31),C=r(w),x=v["default"]();t.exports=e["default"]},function(t,e,n){"use strict";function r(t){var e=t.createClass({displayName:"Spring",componentWillMount:function(){},render:function(){return null}}),n=t.createClass({displayName:"TransitionSpring",componentWillMount:function(){},render:function(){return null}});return{Spring:e,TransitionSpring:n}}e.__esModule=!0,e["default"]=r;t.exports=e["default"]},function(t,e){"use strict";function n(t,e){for(var n in e)if(e.hasOwnProperty(n)){var r=t[n],i=e[n];if(i.config){if(r.config&&r.val!==i.val)return!1;if(!r.config&&r!==i.val)return!1}}return!0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e){"use strict";function n(t,e,n,r,i,o,s){for(var u=!0;u;){var c=t,a=e,l=n,p=r,h=i,f=o,d=s;v=b=y=m=_=_=void 0,u=!1;var v=p===c.length,b=h===a.length,y=c[p],m=a[h];if(v&&b)return null;if(v)d[m]=l[m],t=c,e=a,n=l,r=p,i=h+1,o=f,s=d,u=!0;else if(b){var _=f(y);null!=_&&(d[y]=_),t=c,e=a,n=l,r=p+1,i=h,o=f,s=d,u=!0}else if(y!==m)if(l.hasOwnProperty(y))t=c,e=a,n=l,r=p+1,i=h,o=f,s=d,u=!0;else{var _=f(y);null!=_&&(d[y]=_),t=c,e=a,n=l,r=p+1,i=h,o=f,s=d,u=!0}else d[y]=l[y],t=c,e=a,n=l,r=p+1,i=h+1,o=f,s=d,u=!0}}function r(t,e,r){var i={};return n(Object.keys(t),Object.keys(e),e,0,0,r,i),i}e.__esModule=!0,e["default"]=r,t.exports=e["default"]},function(t,e){"use strict";function n(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e[n].config&&0!==t[n])return!1;return!0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e){"use strict";function n(t,e){for(var n=e(Object.keys(t)),r={},i=0;i<n.length;i++){var o=n[i];r[o]=t[o]}return r}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){var e=arguments.length<=1||void 0===arguments[1]?s["default"].noWobble:arguments[1];return{val:t,config:e}}e.__esModule=!0,e["default"]=i;var o=n(9),s=r(o);t.exports=e["default"]},function(t,e){"use strict";function n(t,e,n,i,o,s){var u=-o*(e-i),c=-s*n,a=u+c,l=n+a*t,p=e+l*t;return Math.abs(l-n)<r&&Math.abs(p-e)<r?[i,0]:[p,l]}e.__esModule=!0,e["default"]=n;var r=1e-4;t.exports=e["default"]},function(t,e){"use strict";function n(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=null==t[n].val?t[n]:t[n].val);return e}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e,n){if(!n)return e;var r={};for(var i in e)if(e.hasOwnProperty(i))if(e[i].config){var o=n[i].config?n[i].val:n[i];r[i]={val:e[i].val*t+o*(1-t),config:e[i].config}}else r[i]=e[i];return r}function o(t,e,n,r){var i={};for(var o in r)if(r.hasOwnProperty(o))if(r[o].config){var s=r[o].config,u=s[0],a=s[1],l=c["default"](t,null==e[o].val?e[o]:e[o].val,n[o],r[o].val,u,a)[0];i[o]={val:l,config:r[o].config}}else i[o]=r[o];return i}function s(t,e,n,r){var i={};for(var o in r)if(r.hasOwnProperty(o))if(r[o].config){var s=r[o].config,u=s[0],a=s[1],l=c["default"](t,null==e[o].val?e[o]:e[o].val,n[o],r[o].val,u,a)[1];i[o]=l}else i[o]=0;return i}e.__esModule=!0,e.interpolateValue=i,e.updateCurrentStyle=o,e.updateCurrentVelocity=s;var u=n(30),c=r(u)},function(t,e){"use strict";function n(){return 0}e.__esModule=!0,e["default"]=n,t.exports=e["default"]},function(t,e,n){for(var r=n(10),i="undefined"==typeof window?{}:window,o=["moz","webkit"],s="AnimationFrame",u=i["request"+s],c=i["cancel"+s]||i["cancelRequest"+s],a=0;a<o.length&&!u;a++)u=i[o[a]+"Request"+s],c=i[o[a]+"Cancel"+s]||i[o[a]+"CancelRequest"+s];if(!u||!c){var l=0,p=0,h=[],f=1e3/60;u=function(t){if(0===h.length){var e=r(),n=Math.max(0,f-(e-l));l=n+e,setTimeout(function(){var t=h.slice(0);h.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(l)}catch(n){setTimeout(function(){throw n},0)}},Math.round(n))}return h.push({handle:++p,callback:t,cancelled:!1}),p},c=function(t){for(var e=0;e<h.length;e++)h[e].handle===t&&(h[e].cancelled=!0)}}t.exports=function(t){return u.call(i,t)},t.exports.cancel=function(){c.apply(i,arguments)}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=p[r.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](r.parts[o]);for(;o<r.parts.length;o++)i.parts.push(u(r.parts[o],e))}else{for(var s=[],o=0;o<r.parts.length;o++)s.push(u(r.parts[o],e));p[r.id]={id:r.id,refs:1,parts:s}}}}function i(t){for(var e=[],n={},r=0;r<t.length;r++){var i=t[r],o=i[0],s=i[1],u=i[2],c=i[3],a={css:s,media:u,sourceMap:c};n[o]?n[o].parts.push(a):e.push(n[o]={id:o,parts:[a]})}return e}function o(){var t=document.createElement("style"),e=d();return t.type="text/css",e.appendChild(t),t}function s(){var t=document.createElement("link"),e=d();return t.rel="stylesheet",e.appendChild(t),t}function u(t,e){var n,r,i;if(e.singleton){var u=b++;n=v||(v=o()),r=c.bind(null,n,u,!1),i=c.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(),r=l.bind(null,n),i=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=o(),r=a.bind(null,n),i=function(){n.parentNode.removeChild(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}function c(t,e,n,r){var i=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=y(e,i);else{var o=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function a(t,e){var n=e.css,r=e.media;e.sourceMap;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{
for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function l(t,e){var n=e.css,r=(e.media,e.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([n],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(i),o&&URL.revokeObjectURL(o)}var p={},h=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},f=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),d=h(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,b=0;t.exports=function(t,e){if("object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},"undefined"==typeof e.singleton&&(e.singleton=f());var n=i(t);return r(n,e),function(t){for(var o=[],s=0;s<n.length;s++){var u=n[s],c=p[u.id];c.refs--,o.push(c)}if(t){var a=i(t);r(a,e)}for(var s=0;s<o.length;s++){var c=o[s];if(0===c.refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete p[c.id]}}}};var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){var r=n(19);"string"==typeof r&&(r=[[t.id,r,""]]);n(35)(r,{});r.locals&&(t.exports=r.locals)},function(t,e){t.exports='<svg viewBox="0 0 2681 814" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>Climb Logo Beta</title><desc>Created with Sketch.</desc><defs></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="Climb-Logo-Beta" sketch:type="MSArtboardGroup" fill="#19374D"><g id="cli----b.social-+-Path-Copy-+-Type-something-Copy-Copy-Copy-Copy-Copy" sketch:type="MSLayerGroup" transform="translate(206.000000, 249.000000)"><g id="cli----b.social-+-Path-Copy" sketch:type="MSShapeGroup"><path d="M723.374207,187.442211 L767.027641,337.383575 C767.510889,341.265552 771.860124,345.147529 776.209359,345.147529 L833.232664,345.147529 C839.031644,345.147529 843.380879,340.780305 842.414383,334.472092 L739.482485,8.38601982 C738.999237,4.01879564 734.650002,0.622065728 730.784015,0.622065728 L723.052041,0.622065728 C720.6358,0.622065728 716.286565,2.56305425 714.83682,5.47453704 L643.514302,209.019062 L576.494003,105.431788 C573.721058,101.145895 567.342539,97.6714919 562.2556,97.6714919 L552.179033,97.6714919 C547.088326,97.6714919 541.529384,101.558749 539.770061,106.334187 L454.980068,336.484833 C453.21749,341.269108 455.927086,345.147529 461.014102,345.147529 L522.138067,345.147529 C527.23315,345.147529 532.791054,341.261733 534.552797,336.466171 L571.473144,235.966924 L642.108528,346.107712 C643.487141,348.257363 646.667092,350 649.212307,350 L659.971412,350 C662.516108,350 665.282044,348.045078 666.141982,345.653918 L683.827261,296.477872 L723.374207,187.442211 Z" id="Path-Copy"></path><path d="M0.145213441,247.085101 C0.145213441,305.23404 49.0872377,348.845745 104.32873,348.845745 C139.218094,348.845745 164.415968,335.277659 182.345224,308.141487 C185.737246,303.295742 183.314373,298.449997 178.953203,294.573401 L149.878733,269.375527 C146.971286,266.952655 142.610116,267.921804 139.218094,271.313825 C131.464902,279.067017 123.227136,286.335635 106.267028,286.335635 C84.9457505,286.335635 68.4702176,268.890953 68.4702176,247.085101 C68.4702176,225.763823 85.9148995,207.834566 107.236177,207.834566 C118.381391,207.834566 128.557455,213.164886 135.341498,220.433503 C137.764371,222.856376 143.579265,223.825525 146.002137,221.402652 L175.076607,193.781906 C179.437777,189.90531 180.891501,184.57499 177.49948,180.21382 C159.085649,157.923393 135.341498,145.324456 104.813305,145.324456 C49.5718122,145.324456 0.145213441,189.90531 0.145213441,247.085101 L0.145213441,247.085101 Z M218.688312,334.793085 C218.688312,339.63883 223.049482,344 227.895227,344 L281.198422,344 C286.044167,344 290.405337,339.63883 290.405337,334.793085 L290.405337,14.0047672 C290.405337,9.15902226 286.044167,4.79785179 281.198422,4.79785179 L227.895227,4.79785179 C223.049482,4.79785179 218.688312,9.15902226 218.688312,14.0047672 L218.688312,334.793085 Z M378.113321,91.5366868 C399.434599,91.5366868 416.879281,74.5765794 416.879281,53.2553015 C416.879281,31.9340236 399.434599,14.4893417 378.113321,14.4893417 C356.792044,14.4893417 339.831936,31.9340236 339.831936,53.2553015 C339.831936,74.5765794 356.792044,91.5366868 378.113321,91.5366868 L378.113321,91.5366868 Z M342.739383,334.793085 C342.739383,339.63883 347.100554,344 351.946299,344 L405.249493,344 C410.095238,344 414.456409,339.63883 414.456409,334.793085 L414.456409,159.377116 C414.456409,154.046797 410.095238,150.170201 405.249493,150.170201 L351.946299,150.170201 C347.100554,150.170201 342.739383,154.046797 342.739383,159.377116 L342.739383,334.793085 Z M889.15431,334.793085 C889.15431,339.63883 893.515481,344 898.361226,344 L921.136227,344 C925.981972,344 929.373994,339.63883 931.312292,334.30851 L937.127185,318.317552 C937.127185,318.317552 959.417612,348.845745 1002.06017,348.845745 C1056.81709,348.845745 1098.00592,302.811168 1098.00592,247.085101 C1098.00592,178.760096 1053.42506,145.324456 1001.57559,145.324456 C985.100061,145.324456 967.170804,151.13935 961.35591,154.531371 L961.35591,14.0047672 C961.35591,9.15902226 956.99474,4.79785179 952.148995,4.79785179 L898.361226,4.79785179 C893.515481,4.79785179 889.15431,9.15902226 889.15431,14.0047672 L889.15431,334.793085 Z M953.602718,246.600526 C953.602718,224.794674 970.078251,207.834566 992.368678,207.834566 C1014.65911,207.834566 1031.61921,224.794674 1031.61921,246.600526 C1031.61921,268.890953 1014.65911,286.335635 992.368678,286.335635 C970.078251,286.335635 953.602718,268.890953 953.602718,246.600526 L953.602718,246.600526 Z M1134.25645,321.224999 C1134.25645,336.246808 1146.85539,348.845745 1161.8772,348.845745 C1177.38358,348.845745 1189.49795,336.246808 1189.49795,321.224999 C1189.49795,305.718615 1177.38358,293.604252 1161.8772,293.604252 C1146.85539,293.604252 1134.25645,305.718615 1134.25645,321.224999 L1134.25645,321.224999 Z M1236.0171,332.854787 C1245.70859,340.607979 1269.93731,348.845745 1301.91923,348.845745 C1356.67615,348.845745 1383.81232,321.224999 1383.81232,287.304784 C1383.81232,248.538824 1356.67615,233.03244 1317.42561,219.464354 C1300.95008,213.64946 1295.61976,208.803715 1295.61976,203.95797 C1295.61976,198.627651 1299.98093,197.173927 1306.2804,197.173927 C1325.1788,197.173927 1347.46923,208.319141 1347.46923,208.319141 C1351.34583,209.772864 1356.19157,208.319141 1357.6453,205.411694 L1375.57455,172.460628 C1378.482,167.614883 1375.08998,163.253712 1370.72881,160.346265 C1360.06817,153.562223 1336.80859,145.324456 1306.2804,145.324456 C1253.94635,145.324456 1230.68678,171.491479 1230.68678,203.95797 C1230.68678,234.001589 1247.16231,255.807441 1284.95912,268.890953 C1309.67242,277.613294 1312.57987,284.397337 1312.57987,289.243082 C1312.57987,295.057976 1308.2187,297.965423 1303.37295,297.965423 C1282.53625,297.965423 1259.76125,285.366486 1259.76125,285.366486 C1255.88465,283.428188 1251.03891,286.335635 1249.58518,289.243082 L1232.62508,322.678722 C1230.2022,327.039893 1232.62508,329.94734 1236.0171,332.854787 L1236.0171,332.854787 Z M1407.55647,246.600526 C1407.55647,302.326593 1453.10647,348.845745 1508.34796,348.845745 C1563.58946,348.845745 1609.13946,302.326593 1609.13946,246.600526 C1609.13946,191.843608 1563.58946,145.324456 1508.34796,145.324456 C1453.10647,145.324456 1407.55647,191.843608 1407.55647,246.600526 L1407.55647,246.600526 Z M1470.06658,246.600526 C1470.06658,225.279248 1487.02669,207.834566 1508.34796,207.834566 C1529.66924,207.834566 1546.62935,225.279248 1546.62935,246.600526 C1546.62935,268.406378 1529.66924,286.335635 1508.34796,286.335635 C1487.02669,286.335635 1470.06658,268.406378 1470.06658,246.600526 L1470.06658,246.600526 Z M1631.42989,247.085101 C1631.42989,305.23404 1680.37191,348.845745 1735.6134,348.845745 C1770.50277,348.845745 1795.70064,335.277659 1813.6299,308.141487 C1817.02192,303.295742 1814.59905,298.449997 1810.23788,294.573401 L1781.16341,269.375527 C1778.25596,266.952655 1773.89479,267.921804 1770.50277,271.313825 C1762.74958,279.067017 1754.51181,286.335635 1737.5517,286.335635 C1716.23042,286.335635 1699.75489,268.890953 1699.75489,247.085101 C1699.75489,225.763823 1717.19957,207.834566 1738.52085,207.834566 C1749.66606,207.834566 1759.84213,213.164886 1766.62617,220.433503 C1769.04904,222.856376 1774.86394,223.825525 1777.28681,221.402652 L1806.36128,193.781906 C1810.72245,189.90531 1812.17617,184.57499 1808.78415,180.21382 C1790.37032,157.923393 1766.62617,145.324456 1736.09798,145.324456 C1680.85649,145.324456 1631.42989,189.90531 1631.42989,247.085101 L1631.42989,247.085101 Z M1885.34692,91.5366868 C1906.6682,91.5366868 1924.11288,74.5765794 1924.11288,53.2553015 C1924.11288,31.9340236 1906.6682,14.4893417 1885.34692,14.4893417 C1864.02565,14.4893417 1847.06554,31.9340236 1847.06554,53.2553015 C1847.06554,74.5765794 1864.02565,91.5366868 1885.34692,91.5366868 L1885.34692,91.5366868 Z M1849.97299,334.793085 C1849.97299,339.63883 1854.33416,344 1859.1799,344 L1912.4831,344 C1917.32884,344 1921.69001,339.63883 1921.69001,334.793085 L1921.69001,159.377116 C1921.69001,154.046797 1917.32884,150.170201 1912.4831,150.170201 L1859.1799,150.170201 C1854.33416,150.170201 1849.97299,154.046797 1849.97299,159.377116 L1849.97299,334.793085 Z M1960.94055,284.881911 C1960.94055,323.163297 1989.53044,348.845745 2027.81183,348.845745 C2058.34002,348.845745 2075.30013,334.793085 2086.44534,324.61702 L2093.22938,337.700532 C2095.65226,343.030851 2099.04428,344 2101.95172,344 L2123.273,344 C2128.11875,344 2132.47992,339.63883 2132.47992,334.793085 L2132.47992,227.702121 C2132.47992,170.52233 2110.67407,145.324456 2050.58683,145.324456 C2024.4198,145.324456 1990.49959,151.13935 1986.13842,152.593074 C1981.77725,154.046797 1977.41608,157.438818 1978.8698,165.676585 L1983.23097,196.204778 C1984.20012,203.473396 1987.59214,208.803715 1994.86076,206.380843 C2007.4597,202.504247 2030.2347,199.112225 2043.31821,199.112225 C2066.57779,199.112225 2069.48523,208.803715 2069.48523,227.702121 C2069.48523,227.702121 2053.97885,219.948929 2032.173,219.948929 C1988.07672,219.948929 1960.94055,247.569675 1960.94055,284.881911 L1960.94055,284.881911 Z M2023.93523,280.036166 C2023.93523,268.890953 2033.14215,259.684037 2044.77193,259.684037 C2056.40172,259.684037 2065.60864,268.890953 2066.09321,280.036166 C2066.09321,291.665954 2056.40172,301.357444 2044.77193,301.357444 C2033.14215,301.357444 2023.93523,291.665954 2023.93523,280.036166 L2023.93523,280.036166 Z M2181.90652,334.793085 C2181.90652,339.63883 2186.26769,344 2191.11343,344 L2244.41663,344 C2249.26237,344 2253.62354,339.63883 2253.62354,334.793085 L2253.62354,14.0047672 C2253.62354,9.15902226 2249.26237,4.79785179 2244.41663,4.79785179 L2191.11343,4.79785179 C2186.26769,4.79785179 2181.90652,9.15902226 2181.90652,14.0047672 L2181.90652,334.793085 Z" id="cli----b.social"></path></g></g></g></g></svg>'},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,n){t.exports=e}])});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy9yZWFjdC1jbGltYi1zb2NpYWwubWluLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCBhNDJlZjI1YTRjZDcyN2ZjMjI0NCIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIHtcInJvb3RcIjpcIlJlYWN0XCIsXCJjb21tb25qczJcIjpcInJlYWN0XCIsXCJjb21tb25qc1wiOlwicmVhY3RcIixcImFtZFwiOlwicmVhY3RcIn0iLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL3JlYWN0LW1vdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jb21tb24vQXV0aG9yLmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9jb21tb24vSW1hZ2UuanN4Iiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL2NvbW1vbi9NZXNzYWdlLmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy93YWxsL1RpbGUuanN4Iiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3dhbGwvV2FsbC5qc3giLCJ3ZWJwYWNrOi8vLy4vfi9jbGltYi1zb2NpYWwvZGlzdC9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9saWIvcHJlc2V0cy5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9+L3BlcmZvcm1hbmNlLW5vdy9saWIvcGVyZm9ybWFuY2Utbm93LmpzIiwid2VicGFjazovLy8od2VicGFjaykvfi9ub2RlLWxpYnMtYnJvd3Nlci9+L3Byb2Nlc3MvYnJvd3Nlci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy9zbGlkZXNob3cvUGFuZWwuanN4Iiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NsaWRlc2hvdy9TbGlkZXNob3cuanN4Iiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NsaWRlc2hvdy9TbGlkZXNob3dDb250YWluZXIuanN4Iiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnRzL3NsaWRlc2hvdy9zbGlkZS5qc3giLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudHMvd2FsbC9DbGltYkJhZGdlLmpzeCIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50cy93YWxsL1dhbGxDb250YWluZXIuanN4Iiwid2VicGFjazovLy8uL34vY2xpbWItc29jaWFsL34vcngtbGl0ZS9yeC5saXRlLmpzIiwid2VicGFjazovLy8uL3NyYy9zdHlsZS9tYWluLnNjc3MiLCJ3ZWJwYWNrOi8vLy4vfi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi9+L2ZldGNoLWpzb25wL2J1aWxkL2ZldGNoLWpzb25wLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9hbmltYXRpb25Mb29wLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9jb21wb25lbnRzLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9kZXByZWNhdGVkU3ByaW5ncy5qcyIsIndlYnBhY2s6Ly8vLi9+L3JlYWN0LW1vdGlvbi9saWIvaGFzUmVhY2hlZFN0eWxlLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9tZXJnZURpZmYuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL25vVmVsb2NpdHkuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL3Jlb3JkZXJLZXlzLmpzIiwid2VicGFjazovLy8uL34vcmVhY3QtbW90aW9uL2xpYi9zcHJpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL3N0ZXBwZXIuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL3N0cmlwU3R5bGUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL3VwZGF0ZVRyZWUuanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vbGliL3plcm8uanMiLCJ3ZWJwYWNrOi8vLy4vfi9yZWFjdC1tb3Rpb24vfi9yYWYvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vfi9zdHlsZS1sb2FkZXIvYWRkU3R5bGVzLmpzIiwid2VicGFjazovLy8uL3NyYy9zdHlsZS9tYWluLnNjc3M/M2FkYiIsIndlYnBhY2s6Ly8vLi9zcmMvaW1nL2NsaW1iX2xvZ28uc3ZnIiwid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9tb2R1bGUuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiUmVhY3RET01cIiJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJyZXF1aXJlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMV9fIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8zOV9fIiwibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiX3JlYWN0IiwiX3JlYWN0MiIsIl9yZWFjdERvbSIsIl9yZWFjdERvbTIiLCJfY29tcG9uZW50c1dhbGxXYWxsQ29udGFpbmVyIiwiX2NvbXBvbmVudHNXYWxsV2FsbENvbnRhaW5lcjIiLCJfY29tcG9uZW50c1NsaWRlc2hvd1NsaWRlc2hvd0NvbnRhaW5lciIsIl9jb21wb25lbnRzU2xpZGVzaG93U2xpZGVzaG93Q29udGFpbmVyMiIsIndpbmRvdyIsIkNsaW1iIiwiJHdhbGxzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaSIsImxlbmd0aCIsIiRpdGVtIiwiY29sbGVjdGlvbklkIiwiZGF0YXNldCIsImxpbWl0IiwicmVuZGVyIiwiY3JlYXRlRWxlbWVudCIsIiRzbGlkZXNob3dzIiwiZGVsYXkiLCJwYXJzZUludCIsIldhbGxDb250YWluZXIiLCJfY29tcG9uZW50c1dhbGxXYWxsIiwiZW51bWVyYWJsZSIsImdldCIsIldhbGwiLCJfY29tcG9uZW50c1dhbGxUaWxlIiwiVGlsZSIsIl9jb21wb25lbnRzMiIsIl9jb21wb25lbnRzMyIsIl9yZW9yZGVyS2V5cyIsIl9yZW9yZGVyS2V5czIiLCJfY29tcG9uZW50cyIsIlNwcmluZyIsIlRyYW5zaXRpb25TcHJpbmciLCJNb3Rpb24iLCJTdGFnZ2VyZWRNb3Rpb24iLCJUcmFuc2l0aW9uTW90aW9uIiwiX3NwcmluZzIiLCJfc3ByaW5nMyIsInNwcmluZyIsIl9wcmVzZXRzMiIsIl9wcmVzZXRzMyIsInByZXNldHMiLCJ1dGlscyIsInJlb3JkZXJLZXlzIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsInByb3RvdHlwZSIsImNyZWF0ZSIsImNvbnN0cnVjdG9yIiwid3JpdGFibGUiLCJjb25maWd1cmFibGUiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImRlc2NyaXB0b3IiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfZ2V0IiwiX3giLCJfeDIiLCJfeDMiLCJfYWdhaW4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInJlY2VpdmVyIiwiZGVzYyIsInBhcmVudCIsImdldHRlciIsInVuZGVmaW5lZCIsIkZ1bmN0aW9uIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0UHJvdG90eXBlT2YiLCJBdXRob3IiLCJfQ29tcG9uZW50IiwiYXBwbHkiLCJhcmd1bWVudHMiLCJjbGFzc05hbWUiLCJocmVmIiwibGluayIsImhlaWdodCIsIndpZHRoIiwic3JjIiwicGljdHVyZSIsImFsdCIsIm5hbWUiLCJ1c2VybmFtZSIsIlByb3BUeXBlcyIsInN0cmluZyIsImlzUmVxdWlyZWQiLCJDb21wb25lbnQiLCJJbWFnZSIsIl9SZWFjdCRDb21wb25lbnQiLCJkYXRhLXdpZHRoIiwiZGF0YS1oZWlnaHQiLCJwcm9wVHlwZXMiLCJudW1iZXIiLCJNZXNzYWdlIiwibWVzc2FnZSIsImJvZHkiLCJyZXBsYWNlIiwiZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUwiLCJfX2h0bWwiLCJfY29tbW9uSW1hZ2UiLCJfY29tbW9uSW1hZ2UyIiwiX2NvbW1vbk1lc3NhZ2UiLCJfY29tbW9uTWVzc2FnZTIiLCJfY29tbW9uQXV0aG9yIiwiX2NvbW1vbkF1dGhvcjIiLCJpbWFnZSIsIl9wcm9wcyRpbWFnZSIsInVybCIsImNsYXNzU3RyaW5nIiwic291cmNlX3R5cGUiLCJ2aWRlb191cmwiLCJjcmVhdGVJbWFnZSIsImNyZWF0ZU1lc3NhZ2UiLCJjcmVhdGVDbGFzc1N0cmluZyIsImF1dGhvciIsInN0eWxlIiwidGltZXN0YW1wIiwic2hhcGUiLCJ2aWRlb19zcmMiLCJfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMiLCJrZXlzIiwiaW5kZXhPZiIsImhhc093blByb3BlcnR5IiwiX2V4dGVuZHMiLCJhc3NpZ24iLCJzb3VyY2UiLCJfVGlsZSIsIl9UaWxlMiIsIl9yZWFjdE1vdGlvbiIsIl90aGlzIiwiY29uZmlncyIsIml0ZW1zIiwibWFwIiwib3BhY2l0eSIsIm1hcmdpbiIsIml0ZW0iLCJpdGVtVmFsdWVzIiwic3R5bGVDb25maWciLCJpdGVtUHJvcHMiLCJtYXJnaW5MZWZ0IiwibWFyZ2luUmlnaHQiLCJfdGhpczIiLCJzdHlsZXMiLCJnZXRTdHlsZXMiLCJiaW5kIiwid2lsbEVudGVyIiwid2lsbExlYXZlIiwidmFsdWVzIiwicmVuZGVyVGlsZSIsIl9yeExpdGUiLCJfZmV0Y2hKc29ucCIsIl9mZXRjaEpzb25wMiIsImdldFN0cmVhbSIsInBvbGxSYXRlIiwicmVxdWVzdFN0cmVhbSIsIk9ic2VydmFibGUiLCJqdXN0IiwidXBkYXRlU3RyZWFtIiwiaW50ZXJ2YWwiLCJzdGFydFdpdGgiLCJyZXNwb25zZVN0cmVhbSIsImNvbWJpbmVMYXRlc3QiLCJ0aWNrIiwiZmxhdE1hcCIsImJhc2VVcmwiLCJyZXF1ZXN0VXJsIiwiZnJvbVByb21pc2UiLCJ0aGVuIiwicmVzcCIsImpzb24iLCJub1dvYmJsZSIsImdlbnRsZSIsIndvYmJseSIsInN0aWZmIiwicHJvY2VzcyIsImdldE5hbm9TZWNvbmRzIiwiaHJ0aW1lIiwibG9hZFRpbWUiLCJwZXJmb3JtYW5jZSIsIm5vdyIsImhyIiwiRGF0ZSIsImdldFRpbWUiLCJjbGVhblVwTmV4dFRpY2siLCJkcmFpbmluZyIsImN1cnJlbnRRdWV1ZSIsInF1ZXVlIiwiY29uY2F0IiwicXVldWVJbmRleCIsImRyYWluUXVldWUiLCJ0aW1lb3V0Iiwic2V0VGltZW91dCIsImxlbiIsInJ1biIsImNsZWFyVGltZW91dCIsIkl0ZW0iLCJmdW4iLCJhcnJheSIsIm5vb3AiLCJuZXh0VGljayIsImFyZ3MiLCJBcnJheSIsInB1c2giLCJ0aXRsZSIsImJyb3dzZXIiLCJlbnYiLCJhcmd2IiwidmVyc2lvbiIsInZlcnNpb25zIiwib24iLCJhZGRMaXN0ZW5lciIsIm9uY2UiLCJvZmYiLCJyZW1vdmVMaXN0ZW5lciIsInJlbW92ZUFsbExpc3RlbmVycyIsImVtaXQiLCJiaW5kaW5nIiwiRXJyb3IiLCJjd2QiLCJjaGRpciIsImRpciIsInVtYXNrIiwiUGFuZWwiLCJjcmVhdGVBdXRob3IiLCJfc2xpZGUiLCJfc2xpZGUyIiwiU2xpZGVzaG93Iiwic3RhdGUiLCJjdXJyZW50S2V5IiwidGltZXIiLCJzZXRJbnRlcnZhbCIsIm5leHRTbGlkZSIsImNsZWFySW50ZXJ2YWwiLCJyYW5kb21LZXkiLCJNYXRoIiwicmFuZG9tIiwic2V0U3RhdGUiLCJzY2FsZSIsInpJbmRleCIsImZsb29yIiwidHJhbnNmb3JtIiwiaXNDdXJyZW50IiwicmVuZGVyU2xpZGUiLCJfY2xpbWJTb2NpYWwiLCJfY2xpbWJTb2NpYWwyIiwiX1NsaWRlc2hvdyIsIl9TbGlkZXNob3cyIiwiU2xpZGVzaG93Q29udGFpbmVyIiwic3Vic2NyaWJlIiwibWFwcGVkSXRlbXMiLCJpbml0IiwiX1BhbmVsIiwiX1BhbmVsMiIsIlNsaWRlIiwic2hvdWxkRGlzcGxheVBhbmVsIiwibmV4dFByb3BzIiwicGFuZWxXaWR0aCIsIngiLCJkZWZhdWx0VmFsdWVzIiwiZGVmYXVsdFN0eWxlIiwiaW50ZXJwb2xhdGVkVmFsdWVzIiwicGFuZWwiLCJjcmVhdGVQYW5lbCIsImJvb2wiLCJDbGltYkJhZGdlIiwibG9nbyIsIl9XYWxsIiwiX1dhbGwyIiwiX0NsaW1iQmFkZ2UiLCJfQ2xpbWJCYWRnZTIiLCJtYXhTaXplIiwic3BsaWNlIiwiY2IiLCJvblVwZGF0ZSIsIm9uZU9mVHlwZSIsIl9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fIiwiZ2xvYmFsIiwiY2hlY2tHbG9iYWwiLCJjbG9uZUFycmF5IiwiYXJyIiwiYSIsInRyeUNhdGNoZXJHZW4iLCJ0cnlDYXRjaFRhcmdldCIsImUiLCJlcnJvck9iaiIsInRocm93ZXIiLCJtYWtlU3RhY2tUcmFjZUxvbmciLCJlcnJvciIsIm9ic2VydmFibGUiLCJoYXNTdGFja3MiLCJzdGFjayIsIlNUQUNLX0pVTVBfU0VQQVJBVE9SIiwic3RhY2tzIiwibyIsInVuc2hpZnQiLCJjb25jYXRlZFN0YWNrcyIsImpvaW4iLCJmaWx0ZXJTdGFja1N0cmluZyIsInN0YWNrU3RyaW5nIiwibGluZXMiLCJzcGxpdCIsImRlc2lyZWRMaW5lcyIsImxpbmUiLCJpc0ludGVybmFsRnJhbWUiLCJpc05vZGVGcmFtZSIsInN0YWNrTGluZSIsImZpbGVOYW1lQW5kTGluZU51bWJlciIsImdldEZpbGVOYW1lQW5kTGluZU51bWJlciIsImZpbGVOYW1lIiwibGluZU51bWJlciIsInJGaWxlTmFtZSIsInJTdGFydGluZ0xpbmUiLCJyRW5kaW5nTGluZSIsImNhcHR1cmVMaW5lIiwiZmlyc3RMaW5lIiwiYXR0ZW1wdDEiLCJleGVjIiwiTnVtYmVyIiwiYXR0ZW1wdDIiLCJhdHRlbXB0MyIsImtleXNJbiIsInJlc3VsdCIsImlzT2JqZWN0Iiwic3VwcG9ydCIsIm5vbkVudW1BcmdzIiwiaXNBcmd1bWVudHMiLCJzbGljZSIsInNraXBQcm90byIsImVudW1Qcm90b3R5cGVzIiwic2tpcEVycm9yUHJvcHMiLCJlbnVtRXJyb3JQcm9wcyIsImVycm9yUHJvdG8iLCJub25FbnVtU2hhZG93cyIsIm9iamVjdFByb3RvIiwiY3RvciIsImluZGV4IiwiZG9udEVudW1zTGVuZ3RoIiwic3RyaW5nUHJvdG8iLCJzdHJpbmdDbGFzcyIsImVycm9yQ2xhc3MiLCJ0b1N0cmluZyIsIm5vbkVudW0iLCJub25FbnVtUHJvcHMiLCJkb250RW51bXMiLCJpbnRlcm5hbEZvciIsImNhbGxiYWNrIiwia2V5c0Z1bmMiLCJpbnRlcm5hbEZvckluIiwiaXNOb2RlIiwiZGVlcEVxdWFscyIsImIiLCJzdGFja0EiLCJzdGFja0IiLCJ0eXBlIiwib3RoZXJUeXBlIiwib3RoZXJDbGFzcyIsImFyZ3NDbGFzcyIsIm9iamVjdENsYXNzIiwiYm9vbENsYXNzIiwiZGF0ZUNsYXNzIiwibnVtYmVyQ2xhc3MiLCJyZWdleHBDbGFzcyIsIlN0cmluZyIsImlzQXJyIiwiYXJyYXlDbGFzcyIsIm5vZGVDbGFzcyIsImN0b3JBIiwiYXJnc09iamVjdCIsImN0b3JCIiwiaXNGdW5jdGlvbiIsInNpemUiLCJwb3AiLCJhcnJheUluaXRpYWxpemUiLCJjb3VudCIsIkluZGV4ZWRJdGVtIiwiSXNEaXNwb3NlZERpc3Bvc2FibGUiLCJfcyIsImlzRGlzcG9zZWQiLCJTdHJpbmdJdGVyYWJsZSIsInMiLCJTdHJpbmdJdGVyYXRvciIsIl9sIiwiX2kiLCJBcnJheUl0ZXJhYmxlIiwiX2EiLCJBcnJheUl0ZXJhdG9yIiwidG9MZW5ndGgiLCJudW1iZXJJc0Zpbml0ZSIsImlzRmluaXRlIiwiZ2V0SXRlcmFibGUiLCJpdCIsIiRpdGVyYXRvciQiLCJzaWduIiwiaXNOYU4iLCJhYnMiLCJtYXhTYWZlSW50ZWdlciIsIkZyb21BcnJheVNpbmsiLCJvYnNlcnZlciIsImxvb3BSZWN1cnNpdmUiLCJyZWN1cnNlIiwib25OZXh0Iiwib25Db21wbGV0ZWQiLCJvYnNlcnZhYmxlT2YiLCJzY2hlZHVsZXIiLCJpc1NjaGVkdWxlciIsImN1cnJlbnRUaHJlYWRTY2hlZHVsZXIiLCJGcm9tQXJyYXlPYnNlcnZhYmxlIiwiUGFpcnNTaW5rIiwiUmVwZWF0U2luayIsImZhbHNlRmFjdG9yeSIsImFyZ3VtZW50c1RvQXJyYXkiLCJlbXB0eUFycmF5RmFjdG9yeSIsImFzT2JzZXJ2YWJsZSIsInBsdWNrZXIiLCJjdXJyZW50UHJvcCIsImNyZWF0ZUNiT2JzZXJ2YWJsZSIsImZuIiwiY3R4Iiwic2VsZWN0b3IiLCJBc3luY1N1YmplY3QiLCJjcmVhdGVDYkhhbmRsZXIiLCJyZXN1bHRzIiwidHJ5Q2F0Y2giLCJvbkVycm9yIiwiY3JlYXRlTm9kZU9ic2VydmFibGUiLCJjcmVhdGVOb2RlSGFuZGxlciIsImVyciIsImlzTm9kZUxpc3QiLCJlbCIsIlN0YXRpY05vZGVMaXN0IiwiTm9kZUxpc3QiLCJMaXN0ZW5EaXNwb3NhYmxlIiwibiIsIl9lIiwiX24iLCJfZm4iLCJhZGRFdmVudExpc3RlbmVyIiwiY3JlYXRlRXZlbnRMaXN0ZW5lciIsImV2ZW50TmFtZSIsImhhbmRsZXIiLCJkaXNwb3NhYmxlcyIsIkNvbXBvc2l0ZURpc3Bvc2FibGUiLCJlbGVtVG9TdHJpbmciLCJhZGQiLCJfb2JzZXJ2YWJsZVRpbWVyIiwiZHVlVGltZSIsIlRpbWVyT2JzZXJ2YWJsZSIsIm9ic2VydmFibGVUaW1lckRhdGVBbmRQZXJpb2QiLCJwZXJpb2QiLCJBbm9ueW1vdXNPYnNlcnZhYmxlIiwiZCIsIm5vcm1hbGl6ZVRpbWUiLCJzY2hlZHVsZVJlY3Vyc2l2ZUZ1dHVyZSIsInNlbGYiLCJvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZCIsInNjaGVkdWxlUGVyaW9kaWMiLCJvYnNlcnZhYmxlRGVmZXIiLCJvYnNlcnZhYmxlRGVsYXlSZWxhdGl2ZSIsInN1YnNjcmlwdGlvbiIsImFjdGl2ZSIsImNhbmNlbGFibGUiLCJTZXJpYWxEaXNwb3NhYmxlIiwiZXhjZXB0aW9uIiwicSIsInJ1bm5pbmciLCJtYXRlcmlhbGl6ZSIsIm5vdGlmaWNhdGlvbiIsInNob3VsZFJ1biIsImtpbmQiLCJTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSIsInNldERpc3Bvc2FibGUiLCJfIiwicmVjdXJzZUR1ZVRpbWUiLCJzaG91bGRSZWN1cnNlIiwic2hpZnQiLCJhY2NlcHQiLCJtYXgiLCJCaW5hcnlEaXNwb3NhYmxlIiwib2JzZXJ2YWJsZURlbGF5QWJzb2x1dGUiLCJkZWxheVdpdGhTZWxlY3RvciIsInN1YnNjcmlwdGlvbkRlbGF5IiwiZGVsYXlEdXJhdGlvblNlbGVjdG9yIiwic3ViRGVsYXkiLCJzdGFydCIsImRlbGF5cyIsInJlbW92ZSIsImRvbmUiLCJhdEVuZCIsImRpc3Bvc2UiLCJkZWJvdW5jZVdpdGhTZWxlY3RvciIsImR1cmF0aW9uU2VsZWN0b3IiLCJoYXNWYWx1ZSIsInRocm90dGxlIiwiaXNQcm9taXNlIiwib2JzZXJ2YWJsZUZyb21Qcm9taXNlIiwiY3VycmVudGlkIiwic2FtcGxlT2JzZXJ2YWJsZSIsInNhbXBsZXIiLCJzYW1wbGVTdWJzY3JpYmUiLCJzb3VyY2VTdWJzY3JpcHRpb24iLCJuZXdWYWx1ZSIsInRpbWVvdXRXaXRoU2VsZWN0b3IiLCJmaXJzdFRpbWVvdXQiLCJ0aW1lb3V0RHVyYXRpb25TZWxlY3RvciIsIm90aGVyIiwib2JzZXJ2YWJsZU5ldmVyIiwib2JzZXJ2YWJsZVRocm93IiwiVGltZW91dEVycm9yIiwic2V0VGltZXIiLCJ0aW1lcldpbnMiLCJzd2l0Y2hlZCIsIm15SWQiLCJvV2lucyIsInJlcyIsIm9yaWdpbmFsIiwiZGVmYXVsdFNjaGVkdWxlciIsImNyZWF0ZVRpbWVyIiwic2NoZWR1bGVGdXR1cmUiLCJjb21iaW5lTGF0ZXN0U291cmNlIiwic3ViamVjdCIsInJlc3VsdFNlbGVjdG9yIiwibmV4dCIsImhhc1ZhbHVlQWxsIiwiZXZlcnkiLCJpZGVudGl0eSIsImlzRG9uZSIsInRyYW5zZm9ybUZvck9ic2VydmVyIiwiQEB0cmFuc2R1Y2VyL2luaXQiLCJAQHRyYW5zZHVjZXIvc3RlcCIsIm9icyIsImlucHV0IiwiQEB0cmFuc2R1Y2VyL3Jlc3VsdCIsIm9iamVjdFR5cGVzIiwiZnVuY3Rpb24iLCJmcmVlRXhwb3J0cyIsIm5vZGVUeXBlIiwiZnJlZU1vZHVsZSIsImZyZWVHbG9iYWwiLCJmcmVlU2VsZiIsImZyZWVXaW5kb3ciLCJtb2R1bGVFeHBvcnRzIiwidGhpc0dsb2JhbCIsIlJ4IiwiaW50ZXJuYWxzIiwiY29uZmlnIiwiUHJvbWlzZSIsImhlbHBlcnMiLCJkZWZhdWx0Tm93IiwiZGVmYXVsdENvbXBhcmVyIiwieSIsImlzRXF1YWwiLCJkZWZhdWx0U3ViQ29tcGFyZXIiLCJkZWZhdWx0RXJyb3IiLCJkZWZhdWx0S2V5U2VyaWFsaXplciIsImlzRm4iLCJsb25nU3RhY2tTdXBwb3J0IiwiRW1wdHlFcnJvciIsIk9iamVjdERpc3Bvc2VkRXJyb3IiLCJBcmd1bWVudE91dE9mUmFuZ2VFcnJvciIsIk5vdFN1cHBvcnRlZEVycm9yIiwiTm90SW1wbGVtZW50ZWRFcnJvciIsIm5vdEltcGxlbWVudGVkIiwibm90U3VwcG9ydGVkIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJTZXQiLCJkb25lRW51bWVyYXRvciIsImlzSXRlcmFibGUiLCJpc0FycmF5TGlrZSIsInN1cHBvcnROb2RlQ2xhc3MiLCJiaW5kQ2FsbGJhY2siLCJmdW5jIiwidGhpc0FyZyIsImFyZ0NvdW50IiwiYXJnIiwiY29sbGVjdGlvbiIsImZ1bmNDbGFzcyIsInN1cHBvcnRzQXJnc0NsYXNzIiwicHJvcGVydHlJc0VudW1lcmFibGUiLCJ0b0xvY2FsZVN0cmluZyIsInZhbHVlT2YiLCJ0ZXN0IiwiaW5oZXJpdHMiLCJjaGlsZCIsIl9fIiwiYWRkUHJvcGVydGllcyIsInNvdXJjZXMiLCJpZHgiLCJsbiIsInByb3AiLCJhZGRSZWYiLCJ4cyIsInIiLCJnZXREaXNwb3NhYmxlIiwiaXNBcnJheSIsIkNvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUiLCJzaG91bGREaXNwb3NlIiwiY3VycmVudERpc3Bvc2FibGVzIiwiRGlzcG9zYWJsZSIsImFjdGlvbiIsImRpc3Bvc2FibGVDcmVhdGUiLCJkaXNwb3NhYmxlRW1wdHkiLCJlbXB0eSIsImlzRGlzcG9zYWJsZSIsImNoZWNrRGlzcG9zZWQiLCJkaXNwb3NhYmxlIiwiZGlzcG9zYWJsZUZpeHVwIiwiX2ZpeHVwIiwiY3VycmVudCIsIm9sZCIsImZpcnN0Iiwic2Vjb25kIiwiX2ZpcnN0IiwiX3NlY29uZCIsIm9sZDEiLCJvbGQyIiwiTkFyeURpc3Bvc2FibGUiLCJfZGlzcG9zYWJsZXMiLCJTY2hlZHVsZWRJdGVtIiwiUmVmQ291bnREaXNwb3NhYmxlIiwiSW5uZXJEaXNwb3NhYmxlIiwiaXNJbm5lckRpc3Bvc2VkIiwidW5kZXJseWluZ0Rpc3Bvc2FibGUiLCJpc1ByaW1hcnlEaXNwb3NlZCIsImNvbXBhcmVyIiwiaW52b2tlIiwiaW52b2tlQ29yZSIsImNvbXBhcmVUbyIsImlzQ2FuY2VsbGVkIiwiU2NoZWR1bGVyIiwic2NoZWR1bGVyUHJvdG8iLCJzY2hlZHVsZSIsImR0Iiwibm9ybWFsaXplIiwiX3NjaGVkdWxlRnV0dXJlIiwidGltZVNwYW4iLCJpbnZva2VSZWNJbW1lZGlhdGUiLCJwYWlyIiwiaW5uZXJBY3Rpb24iLCJzdGF0ZTIiLCJzY2hlZHVsZVdvcmsiLCJzdGF0ZTMiLCJpc0FkZGVkIiwiZ3JvdXAiLCJpbnZva2VSZWNEYXRlIiwiZHVlVGltZTEiLCJzY2hlZHVsZVJlY3Vyc2l2ZSIsInNjaGVkdWxlTWV0aG9kIiwiY2xlYXJNZXRob2QiLCJJbW1lZGlhdGVTY2hlZHVsZXIiLCJfX3N1cGVyX18iLCJpbW1lZGlhdGVTY2hlZHVsZXIiLCJpbW1lZGlhdGUiLCJDdXJyZW50VGhyZWFkU2NoZWR1bGVyIiwicnVuVHJhbXBvbGluZSIsImRlcXVldWUiLCJzaSIsImVucXVldWUiLCJQcmlvcml0eVF1ZXVlIiwic2NoZWR1bGVSZXF1aXJlZCIsImN1cnJlbnRUaHJlYWQiLCJsb2NhbFRpbWVyIiwiU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZSIsImNyZWF0ZVRpY2siLCJjb21tYW5kIiwiX3BlcmlvZCIsIl9hY3Rpb24iLCJfc3RhdGUiLCJfY2FuY2VsIiwiX3NjaGVkdWxlciIsImxvY2FsU2V0VGltZW91dCIsImxvY2FsQ2xlYXJUaW1lb3V0IiwiV1NjcmlwdCIsInRpbWUiLCJTbGVlcCIsInJ1blRhc2siLCJoYW5kbGUiLCJjdXJyZW50bHlSdW5uaW5nIiwidGFzayIsInRhc2tzQnlIYW5kbGUiLCJwb3N0TWVzc2FnZVN1cHBvcnRlZCIsInBvc3RNZXNzYWdlIiwiaW1wb3J0U2NyaXB0cyIsImlzQXN5bmMiLCJvbGRIYW5kbGVyIiwib25tZXNzYWdlIiwibmV4dEhhbmRsZSIsInJlTmF0aXZlIiwiUmVnRXhwIiwic2V0SW1tZWRpYXRlIiwiTVNHX1BSRUZJWCIsIm9uR2xvYmFsUG9zdE1lc3NhZ2UiLCJldmVudCIsImRhdGEiLCJzdWJzdHJpbmciLCJjdXJyZW50SWQiLCJNZXNzYWdlQ2hhbm5lbCIsImNoYW5uZWwiLCJwb3J0MSIsInBvcnQyIiwic2NyaXB0RWxlbWVudCIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImRvY3VtZW50RWxlbWVudCIsImFwcGVuZENoaWxkIiwiRGVmYXVsdFNjaGVkdWxlciIsInNjaGVkdWxlQWN0aW9uIiwiQ2xlYXJEaXNwb3NhYmxlIiwibWV0aG9kIiwiX2lkIiwiX21ldGhvZCIsImFzeW5jIiwiY2FwYWNpdHkiLCJwcmlvcml0eVByb3RvIiwiaXNIaWdoZXJQcmlvcml0eSIsImxlZnQiLCJyaWdodCIsInBlcmNvbGF0ZSIsInRlbXAiLCJoZWFwaWZ5IiwicGVlayIsInJlbW92ZUF0Iiwib2JzZXJ2YWJsZVByb3RvIiwiTm90aWZpY2F0aW9uIiwiX2FjY2VwdCIsIl9hY2NlcHRPYnNlcnZhYmxlIiwib2JzZXJ2ZXJPck9uTmV4dCIsInRvT2JzZXJ2YWJsZSIsIk9uTmV4dE5vdGlmaWNhdGlvbiIsIk9uRXJyb3JOb3RpZmljYXRpb24iLCJPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbiIsIm5vdGlmaWNhdGlvbkNyZWF0ZU9uTmV4dCIsImNyZWF0ZU9uTmV4dCIsIm5vdGlmaWNhdGlvbkNyZWF0ZU9uRXJyb3IiLCJjcmVhdGVPbkVycm9yIiwibm90aWZpY2F0aW9uQ3JlYXRlT25Db21wbGV0ZWQiLCJjcmVhdGVPbkNvbXBsZXRlZCIsIk9ic2VydmVyIiwib2JzZXJ2ZXJDcmVhdGUiLCJBbm9ueW1vdXNPYnNlcnZlciIsIkFic3RyYWN0T2JzZXJ2ZXIiLCJpc1N0b3BwZWQiLCJjb21wbGV0ZWQiLCJmYWlsIiwiX29uTmV4dCIsIl9vbkVycm9yIiwiX29uQ29tcGxldGVkIiwibWFrZVN1YnNjcmliZSIsIm9sZE9uRXJyb3IiLCJvbGRTdWJzY3JpYmUiLCJfc3Vic2NyaWJlIiwiaXNPYnNlcnZhYmxlIiwiZm9yRWFjaCIsIm9Pck9uTmV4dCIsInN1YnNjcmliZU9uTmV4dCIsInN1YnNjcmliZU9uRXJyb3IiLCJzdWJzY3JpYmVPbkNvbXBsZXRlZCIsIlNjaGVkdWxlZE9ic2VydmVyIiwiaXNBY3F1aXJlZCIsImhhc0ZhdWx0ZWQiLCJlbnN1cmVBY3RpdmUiLCJpc093bmVyIiwid29yayIsIk9ic2VydmFibGVCYXNlIiwiZml4U3Vic2NyaWJlciIsInN1YnNjcmliZXIiLCJhZG8iLCJzdWIiLCJzdWJzY3JpYmVDb3JlIiwiQXV0b0RldGFjaE9ic2VydmVyIiwiRmxhdE1hcE9ic2VydmFibGUiLCJJbm5lck9ic2VydmVyIiwiX3dyYXBSZXN1bHQiLCJpMiIsImZyb20iLCJFbnVtZXJhYmxlIiwiQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUiLCJfbyIsImN1cnJlbnRJdGVtIiwiY3VycmVudFZhbHVlIiwiQ2F0Y2hFcnJvck9ic2VydmFibGUiLCJfcmVjdXJzZSIsImxhc3RFeGNlcHRpb24iLCJjYXRjaEVycm9yIiwiY2F0Y2hFcnJvcldoZW4iLCJub3RpZmljYXRpb25IYW5kbGVyIiwiZXhjZXB0aW9ucyIsIlN1YmplY3QiLCJub3RpZmllciIsImhhbmRsZWQiLCJub3RpZmljYXRpb25EaXNwb3NhYmxlIiwib3V0ZXIiLCJpbm5lciIsImV4biIsImV4IiwiUmVwZWF0RW51bWVyYWJsZSIsInYiLCJSZXBlYXRFbnVtZXJhdG9yIiwibCIsImVudW1lcmFibGVSZXBlYXQiLCJyZXBlYXQiLCJyZXBlYXRDb3VudCIsIk9mRW51bWVyYWJsZSIsIk9mRW51bWVyYXRvciIsImVudW1lcmFibGVPZiIsIm9mIiwiVG9BcnJheU9ic2VydmFibGUiLCJ0b0FycmF5IiwiRGVmZXIiLCJfZiIsImRlZmVyIiwib2JzZXJ2YWJsZUZhY3RvcnkiLCJFbXB0eU9ic2VydmFibGUiLCJFbXB0eVNpbmsiLCJzY2hlZHVsZUl0ZW0iLCJzaW5rIiwiRU1QVFlfT0JTRVJWQUJMRSIsIm9ic2VydmFibGVFbXB0eSIsIkZyb21PYnNlcnZhYmxlIiwiaXRlcmFibGUiLCJtYXBwZXIiLCJGcm9tU2luayIsImxpc3QiLCJwb3ciLCJjaGFyQXQiLCJvYnNlcnZhYmxlRnJvbSIsIm1hcEZuIiwib2JzZXJ2YWJsZUZyb21BcnJheSIsImZyb21BcnJheSIsIk5ldmVyT2JzZXJ2YWJsZSIsIk5FVkVSX09CU0VSVkFCTEUiLCJuZXZlciIsIm9mV2l0aFNjaGVkdWxlciIsIlBhaXJzT2JzZXJ2YWJsZSIsInBhaXJzIiwiUmFuZ2VPYnNlcnZhYmxlIiwicmFuZ2VDb3VudCIsIlJhbmdlU2luayIsInJhbmdlIiwiUmVwZWF0T2JzZXJ2YWJsZSIsIkp1c3RPYnNlcnZhYmxlIiwiSnVzdFNpbmsiLCJUaHJvd09ic2VydmFibGUiLCJUaHJvd1NpbmsiLCJDYXRjaE9ic2VydmFibGUiLCJkMSIsIkNhdGNoT2JzZXJ2ZXIiLCJoYW5kbGVyT3JTZWNvbmQiLCJvYnNlcnZhYmxlQ2F0Y2giLCJDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZSIsInBhcmFtcyIsIl9wYXJhbXMiLCJfY2IiLCJzdWJzY3JpcHRpb25zIiwic2FkIiwiQ29tYmluZUxhdGVzdE9ic2VydmVyIiwibm90VGhlU2FtZSIsImoiLCJmaWx0ZXIiLCJvYnNlcnZhYmxlQ29uY2F0IiwiQ29uY2F0T2JzZXJ2YWJsZSIsIkNvbmNhdFNpbmsiLCJjb25jYXRBbGwiLCJtZXJnZSIsIk1lcmdlT2JzZXJ2YWJsZSIsIm1heENvbmN1cnJlbnQiLCJnIiwiTWVyZ2VPYnNlcnZlciIsImFjdGl2ZUNvdW50IiwiaGFuZGxlU3Vic2NyaWJlIiwiaW5uZXJTb3VyY2UiLCJtYXhDb25jdXJyZW50T3JPdGhlciIsIm9ic2VydmFibGVNZXJnZSIsIm1lcmdlQWxsIiwiQ29tcG9zaXRlRXJyb3IiLCJlcnJvcnMiLCJpbm5lckVycm9ycyIsIk1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUiLCJNZXJnZURlbGF5RXJyb3JPYnNlcnZlciIsIl9ncm91cCIsInNldENvbXBsZXRpb24iLCJfaW5uZXIiLCJtZXJnZURlbGF5RXJyb3IiLCJNZXJnZUFsbE9ic2VydmFibGUiLCJNZXJnZUFsbE9ic2VydmVyIiwiU2tpcFVudGlsT2JzZXJ2YWJsZSIsIl9vcGVuIiwibGVmdFN1YnNjcmlwdGlvbiIsIlNraXBVbnRpbFNvdXJjZU9ic2VydmVyIiwicmlnaHRTdWJzY3JpcHRpb24iLCJTa2lwVW50aWxPdGhlck9ic2VydmVyIiwiX3AiLCJfciIsInNraXBVbnRpbCIsIlN3aXRjaE9ic2VydmFibGUiLCJTd2l0Y2hPYnNlcnZlciIsInN0b3BwZWQiLCJsYXRlc3QiLCJoYXNMYXRlc3QiLCJzd2l0Y2hMYXRlc3QiLCJUYWtlVW50aWxPYnNlcnZhYmxlIiwiVGFrZVVudGlsT2JzZXJ2ZXIiLCJ0YWtlVW50aWwiLCJXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUiLCJfc3MiLCJXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIiLCJXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyIiwiYWxsVmFsdWVzIiwid2l0aExhdGVzdEZyb20iLCJaaXBPYnNlcnZhYmxlIiwiWmlwT2JzZXJ2ZXIiLCJfcSIsIl9kIiwibm90RW1wdHkiLCJzaGlmdEVhY2giLCJxdWV1ZWRWYWx1ZXMiLCJ6aXAiLCJ6aXBJdGVyYWJsZSIsInF1ZXVlcyIsIkRlbWF0ZXJpYWxpemVPYnNlcnZhYmxlIiwiRGVtYXRlcmlhbGl6ZU9ic2VydmVyIiwiZGVtYXRlcmlhbGl6ZSIsIkRpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSIsImtleUZuIiwiRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlciIsImhhc0N1cnJlbnRLZXkiLCJjb21wYXJlckVxdWFscyIsImRpc3RpbmN0VW50aWxDaGFuZ2VkIiwiVGFwT2JzZXJ2YWJsZSIsIl9vTiIsIl9vRSIsIl9vQyIsInQiLCJ0YXAiLCJkb0FjdGlvbiIsImRvT25OZXh0IiwidGFwT25OZXh0IiwiZG9PbkVycm9yIiwidGFwT25FcnJvciIsImRvT25Db21wbGV0ZWQiLCJ0YXBPbkNvbXBsZXRlZCIsIklnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZSIsImlnbm9yZUVsZW1lbnRzIiwiTWF0ZXJpYWxpemVPYnNlcnZhYmxlIiwiTWF0ZXJpYWxpemVPYnNlcnZlciIsInJldHJ5IiwicmV0cnlDb3VudCIsInJldHJ5V2hlbiIsIlNjYW5PYnNlcnZhYmxlIiwiYWNjdW11bGF0b3IiLCJoYXNTZWVkIiwic2VlZCIsIlNjYW5PYnNlcnZlciIsIl9ocyIsIl9oYSIsIl9odiIsInNjYW4iLCJTa2lwTGFzdE9ic2VydmFibGUiLCJfYyIsIlNraXBMYXN0T2JzZXJ2ZXIiLCJza2lwTGFzdCIsIlRha2VMYXN0T2JzZXJ2ZXIiLCJ0YWtlTGFzdCIsImZsYXRNYXBDb25jYXQiLCJjb25jYXRNYXAiLCJNYXBPYnNlcnZhYmxlIiwiaW5uZXJNYXAiLCJpbnRlcm5hbE1hcCIsInNlbGVjdCIsInNlbGVjdG9yRm4iLCJwbHVjayIsInNlbGVjdE1hbnkiLCJmbGF0TWFwTGF0ZXN0IiwiU2tpcE9ic2VydmFibGUiLCJza2lwQ291bnQiLCJza2lwIiwiU2tpcFdoaWxlT2JzZXJ2YWJsZSIsIlNraXBXaGlsZU9ic2VydmVyIiwic2tpcFdoaWxlIiwicHJlZGljYXRlIiwiVGFrZU9ic2VydmFibGUiLCJ0YWtlQ291bnQiLCJ0YWtlIiwiVGFrZVdoaWxlT2JzZXJ2YWJsZSIsIlRha2VXaGlsZU9ic2VydmVyIiwidGFrZVdoaWxlIiwiRmlsdGVyT2JzZXJ2YWJsZSIsImlubmVyUHJlZGljYXRlIiwiaW50ZXJuYWxGaWx0ZXIiLCJzaG91bGRZaWVsZCIsIndoZXJlIiwiZnJvbUNhbGxiYWNrIiwiZnJvbU5vZGVDYWxsYmFjayIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ1c2VOYXRpdmVFdmVudHMiLCJFdmVudE9ic2VydmFibGUiLCJfZWwiLCJjcmVhdGVIYW5kbGVyIiwiZnJvbUV2ZW50IiwiZWxlbWVudCIsImZyb21FdmVudFBhdHRlcm4iLCJoIiwicHVibGlzaCIsInJlZkNvdW50IiwiRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZSIsImRlbCIsIl9hZGQiLCJfZGVsIiwiRXZlbnRQYXR0ZXJuRGlzcG9zYWJsZSIsInJldCIsIl9yZXQiLCJyZXR1cm5WYWx1ZSIsImFkZEhhbmRsZXIiLCJyZW1vdmVIYW5kbGVyIiwiRnJvbVByb21pc2VPYnNlcnZhYmxlIiwic2NoZWR1bGVOZXh0Iiwic2NoZWR1bGVFcnJvciIsInByb21pc2UiLCJ0b1Byb21pc2UiLCJwcm9taXNlQ3RvciIsInJlc29sdmUiLCJyZWplY3QiLCJzdGFydEFzeW5jIiwiZnVuY3Rpb25Bc3luYyIsIk11bHRpY2FzdE9ic2VydmFibGUiLCJmbjEiLCJmbjIiLCJfZm4xIiwiX2ZuMiIsImNvbm5lY3RhYmxlIiwibXVsdGljYXN0IiwiY29ubmVjdCIsInN1YmplY3RPclN1YmplY3RTZWxlY3RvciIsIkNvbm5lY3RhYmxlT2JzZXJ2YWJsZSIsInNoYXJlIiwicHVibGlzaExhc3QiLCJwdWJsaXNoVmFsdWUiLCJpbml0aWFsVmFsdWVPclNlbGVjdG9yIiwiaW5pdGlhbFZhbHVlIiwiQmVoYXZpb3JTdWJqZWN0Iiwic2hhcmVWYWx1ZSIsInJlcGxheSIsImJ1ZmZlclNpemUiLCJ3aW5kb3dTaXplIiwiUmVwbGF5U3ViamVjdCIsInNoYXJlUmVwbGF5IiwiUmVmQ291bnRPYnNlcnZhYmxlIiwiX2NvdW50IiwiX2Nvbm5lY3RhYmxlU3Vic2NyaXB0aW9uIiwic2hvdWxkQ29ubmVjdCIsIl9oYXNTdWJzY3JpcHRpb24iLCJfc3Vic2NyaXB0aW9uIiwiX3NvdXJjZU9ic2VydmFibGUiLCJfc3ViamVjdCIsIkNvbm5lY3REaXNwb3NhYmxlIiwiX2R0Iiwib2JzZXJ2YWJsZWludGVydmFsIiwicGVyaW9kT3JTY2hlZHVsZXIiLCJmaXJzdEFyZyIsIkRlYm91bmNlT2JzZXJ2YWJsZSIsIkRlYm91bmNlT2JzZXJ2ZXIiLCJfdiIsImRlYm91bmNlIiwiVGltZXN0YW1wT2JzZXJ2YWJsZSIsIlRpbWVzdGFtcE9ic2VydmVyIiwic2FtcGxlIiwidGhyb3R0bGVMYXRlc3QiLCJpbnRlcnZhbE9yU2FtcGxlciIsIndpbmRvd0R1cmF0aW9uIiwiZHVyYXRpb24iLCJSYW5nZUVycm9yIiwibGFzdE9uTmV4dCIsIlBhdXNhYmxlT2JzZXJ2YWJsZSIsInBhdXNlciIsImNvbnRyb2xsZXIiLCJjb25uIiwiY29ubmVjdGlvbiIsInBhdXNhYmxlIiwicGF1c2UiLCJyZXN1bWUiLCJQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSIsInByZXZpb3VzU2hvdWxkRmlyZSIsInNob3VsZEZpcmUiLCJwYXVzYWJsZUJ1ZmZlcmVkIiwiQ29udHJvbGxlZE9ic2VydmFibGUiLCJlbmFibGVRdWV1ZSIsIkNvbnRyb2xsZWRTdWJqZWN0IiwicmVxdWVzdCIsIm51bWJlck9mSXRlbXMiLCJyZXF1ZXN0ZWRDb3VudCIsInJlcXVlc3RlZERpc3Bvc2FibGUiLCJoYXNGYWlsZWQiLCJoYXNDb21wbGV0ZWQiLCJkaXNwb3NlQ3VycmVudFJlcXVlc3QiLCJfcHJvY2Vzc1JlcXVlc3QiLCJyZW1haW5pbmciLCJjb250cm9sbGVkIiwicGlwZSIsImRlc3QiLCJvbkRyYWluIiwid3JpdGUiLCJfaXNTdGRpbyIsImVuZCIsIlRyYW5zZHVjZU9ic2VydmVyIiwieGZvcm0iLCJfeGZvcm0iLCJ0cmFuc2R1Y2UiLCJ0cmFuc2R1Y2VyIiwiX19zdWJzY3JpYmUiLCJBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUiLCJJbm5lclN1YnNjcmlwdGlvbiIsIm9ic2VydmVycyIsImhhc0Vycm9yIiwiaGFzT2JzZXJ2ZXJzIiwib3MiLCJBbm9ueW1vdXNTdWJqZWN0IiwiZ2V0VmFsdWUiLCJjcmVhdGVSZW1vdmFibGVEaXNwb3NhYmxlIiwic28iLCJfdHJpbSIsIlBhdXNlciIsIm1lZGlhUXVlcnkiLCJhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fIiwiX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyIsImdlbmVyYXRlQ2FsbGJhY2tGdW5jdGlvbiIsImNlaWwiLCJjbGVhckZ1bmN0aW9uIiwiZnVuY3Rpb25OYW1lIiwicmVtb3ZlU2NyaXB0Iiwic2NyaXB0SWQiLCJzY3JpcHQiLCJnZXRFbGVtZW50QnlJZCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZGVmYXVsdE9wdGlvbnMiLCJqc29ucENhbGxiYWNrIiwiZmV0Y2hKc29ucCIsIm9wdGlvbnMiLCJ0aW1lb3V0SWQiLCJjYWxsYmFja0Z1bmN0aW9uIiwicmVzcG9uc2UiLCJvayIsImpzb25wU2NyaXB0Iiwic2V0QXR0cmlidXRlIiwiY29uZmlnQW5pbWF0aW9uIiwibG9vcCIsImN1cnJlbnRUaW1lIiwiZnJhbWVUaW1lIiwicHJldlRpbWUiLCJhY2N1bXVsYXRlZFRpbWUiLCJ0aW1lU2NhbGUiLCJ0aW1lU3RlcCIsIm1heFN0ZXBzIiwiZnJhbWVOdW1iZXIiLCJhbmltUnVubmluZyIsIl9hbmltUnVubmluZyRpIiwiYW5pbWF0aW9uU3RlcCIsInByZXZQcmV2U3RhdGUiLCJwcmV2U3RhdGUiLCJwcmV2TmV4dFN0YXRlIiwibmV4dFN0YXRlIiwiX3JlZiIsImFscGhhIiwiX2FuaW1SdW5uaW5nJGkyIiwiYW5pbWF0aW9uUmVuZGVyIiwiX3JlZjIiLCJyYWYiLCJfY29uZmlnJHRpbWVTdGVwIiwiX2NvbmZpZyR0aW1lU2NhbGUiLCJfY29uZmlnJG1heFN0ZXBzIiwiX2NvbmZpZyRyYWYiLCJfcmFmMiIsIl9jb25maWckbm93IiwiX3BlcmZvcm1hbmNlTm93MiIsInZhbCIsInN0b3AiLCJuZXdBbmltIiwiX3BlcmZvcm1hbmNlTm93IiwiX3JhZiIsIm1hcE9iamVjdCIsImYiLCJldmVyeU9iaiIsImNvbXBvbmVudHMiLCJSZWFjdCIsImNyZWF0ZUNsYXNzIiwiZGlzcGxheU5hbWUiLCJkZWZhdWx0VmFsdWUiLCJwcm9wTmFtZSIsImVuZFZhbHVlIiwiY2hpbGRyZW4iLCJnZXRJbml0aWFsU3RhdGUiLCJfcHJvcHMiLCJjdXJyZW50U3R5bGUiLCJjdXJyZW50VmVsb2NpdHkiLCJfemVybzIiLCJjb21wb25lbnREaWRNb3VudCIsInN0YXJ0QW5pbWF0aW5nIiwiY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyIsInRpbWVzdGVwIiwibmV3Q3VycmVudFN0eWxlIiwiX3VwZGF0ZVRyZWUiLCJ1cGRhdGVDdXJyZW50U3R5bGUiLCJuZXdDdXJyZW50VmVsb2NpdHkiLCJ1cGRhdGVDdXJyZW50VmVsb2NpdHkiLCJfbm9WZWxvY2l0eTIiLCJzdG9wQW5pbWF0aW9uIiwiaGFzVW5tb3VudGVkIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJzdGFydEFuaW1hdGlvbiIsImludGVycG9sYXRlVmFsdWUiLCJzdHJpcHBlZFN0eWxlIiwiX3N0cmlwU3R5bGUyIiwicmVuZGVyZWRDaGlsZHJlbiIsIkNoaWxkcmVuIiwib25seSIsImRlZmF1bHRTdHlsZXMiLCJhcnJheU9mIiwiX3Byb3BzMiIsImN1cnJlbnRTdHlsZXMiLCJjdXJyZW50VmVsb2NpdGllcyIsIm5ld0N1cnJlbnRTdHlsZXMiLCJuZXdDdXJyZW50VmVsb2NpdGllcyIsImsiLCJvYmplY3RPZiIsImFueSIsImdldERlZmF1bHRQcm9wcyIsIl9wcm9wczMiLCJfcHJvcHM0IiwibWVyZ2VkU3R5bGVzIiwiaGFzTmV3S2V5IiwiX21lcmdlRGlmZjIiLCJfaGFzUmVhY2hlZFN0eWxlMiIsIl9leHRlbmRzMiIsIl9leHRlbmRzMyIsImVudGVyU3R5bGUiLCJtZXJnZWRTdHlsZSIsIl9kZXByZWNhdGVkU3ByaW5ncyIsIl9kZXByZWNhdGVkU3ByaW5nczMiLCJfbm9WZWxvY2l0eSIsIl9oYXNSZWFjaGVkU3R5bGUiLCJfbWVyZ2VEaWZmIiwiX2FuaW1hdGlvbkxvb3AiLCJfYW5pbWF0aW9uTG9vcDIiLCJfemVybyIsIl9kZXByZWNhdGVkU3ByaW5nczIiLCJfc3RyaXBTdHlsZSIsImRlcHJlY2F0ZWRTcHJpbmdzIiwiY29tcG9uZW50V2lsbE1vdW50IiwiaGFzUmVhY2hlZFN0eWxlIiwiZGVzdFZhbHVlIiwibWVyZ2VEaWZmQXJyIiwiX3g0IiwiX3g1IiwiX3g2IiwiX3g3IiwiYXJyQSIsImFyckIiLCJjb2xsQiIsImluZGV4QSIsImluZGV4QiIsIm9uUmVtb3ZlIiwiYWNjdW0iLCJlbmRBIiwiZW5kQiIsImtleUEiLCJrZXlCIiwiZmlsbCIsIm1lcmdlRGlmZiIsIm5vVmVsb2NpdHkiLCJuZXdLZXlzIiwiX3ByZXNldHMiLCJzdGVwcGVyIiwiZnJhbWVSYXRlIiwiZGVzdFgiLCJGc3ByaW5nIiwiRmRhbXBlciIsIm5ld1YiLCJuZXdYIiwiZXJyb3JNYXJnaW4iLCJzdHJpcFN0eWxlIiwibmV4dFN0eWxlIiwicHJldlN0eWxlIiwicHJldlZhbHVlIiwiX3N0eWxlJGtleSRjb25maWciLCJfc3RlcHBlcjIiLCJfc3R5bGUka2V5JGNvbmZpZzIiLCJfc3RlcHBlciIsInplcm8iLCJ2ZW5kb3JzIiwic3VmZml4IiwiY2FmIiwibGFzdCIsImZyYW1lRHVyYXRpb24iLCJfbm93IiwiY3AiLCJjYW5jZWxsZWQiLCJyb3VuZCIsImNhbmNlbCIsImFkZFN0eWxlc1RvRG9tIiwiZG9tU3R5bGUiLCJzdHlsZXNJbkRvbSIsInJlZnMiLCJwYXJ0cyIsImFkZFN0eWxlIiwibGlzdFRvU3R5bGVzIiwibmV3U3R5bGVzIiwiY3NzIiwibWVkaWEiLCJzb3VyY2VNYXAiLCJwYXJ0IiwiY3JlYXRlU3R5bGVFbGVtZW50Iiwic3R5bGVFbGVtZW50IiwiaGVhZCIsImdldEhlYWRFbGVtZW50IiwiY3JlYXRlTGlua0VsZW1lbnQiLCJsaW5rRWxlbWVudCIsInJlbCIsInVwZGF0ZSIsInNpbmdsZXRvbiIsInN0eWxlSW5kZXgiLCJzaW5nbGV0b25Db3VudGVyIiwic2luZ2xldG9uRWxlbWVudCIsImFwcGx5VG9TaW5nbGV0b25UYWciLCJVUkwiLCJjcmVhdGVPYmplY3RVUkwiLCJyZXZva2VPYmplY3RVUkwiLCJCbG9iIiwiYnRvYSIsInVwZGF0ZUxpbmsiLCJhcHBseVRvVGFnIiwibmV3T2JqIiwic3R5bGVTaGVldCIsImNzc1RleHQiLCJyZXBsYWNlVGV4dCIsImNzc05vZGUiLCJjcmVhdGVUZXh0Tm9kZSIsImNoaWxkTm9kZXMiLCJpbnNlcnRCZWZvcmUiLCJmaXJzdENoaWxkIiwidW5lc2NhcGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJKU09OIiwic3RyaW5naWZ5IiwiYmxvYiIsIm9sZFNyYyIsIm1lbW9pemUiLCJtZW1vIiwiaXNPbGRJRSIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsInRvTG93ZXJDYXNlIiwibmV3TGlzdCIsIm1heVJlbW92ZSIsInRleHRTdG9yZSIsInJlcGxhY2VtZW50IiwiQm9vbGVhbiIsImNvbnRlbnQiLCJsb2NhbHMiLCJ3ZWJwYWNrUG9seWZpbGwiLCJkZXByZWNhdGUiLCJwYXRocyJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxnQkFBQUMsVUFBQSxnQkFBQUMsUUFDQUEsT0FBQUQsUUFBQUQsRUFBQUcsUUFBQSxTQUFBQSxRQUFBLGFBQ0Esa0JBQUFDLGdCQUFB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QTMvQixHQUFBNC9CLEVBQ0FELEVBQUEvZSxPQUFBaWYsU0FBQXBpQyxLQUFBLFdyQ2tvVE0sU0FBU2pWLEVBQVFELEVBQVNTLEdzQy94VGhDLEdBQUE4MkMsR0FBQTkyQyxFQUFBLEdBQ0EsaUJBQUE4MkMsU0FBQXQzQyxFQUFBVyxHQUFBMjJDLEVBQUEsS0FFQTkyQyxHQUFBLElBQUE4MkMsS0FDQUEsR0FBQUMsU0FBQXYzQyxFQUFBRCxRQUFBdTNDLEVBQUFDLFN0Q3F6VE0sU0FBU3YzQyxFQUFRRCxHdUM1elR2QkMsRUFBQUQsUUFBQSxzbFR2Q2swVE0sU0FBU0MsRUFBUUQsR3dDbDBUdkJDLEVBQUFELFFBQUEsU0FBQUMsR0FRQSxNQVBBQSxHQUFBdzNDLGtCQUNBeDNDLEVBQUF5M0MsVUFBQSxhQUNBejNDLEVBQUEwM0MsU0FFQTEzQyxFQUFBK3NDLFlBQ0Evc0MsRUFBQXczQyxnQkFBQSxHQUVBeDNDLEl4QzAwVE0sU0FBU0EsRUFBUUQsR3lDbDFUdkJDLEVBQUFELFFBQUFPIiwiZmlsZSI6InJlYWN0LWNsaW1iLXNvY2lhbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJyZWFjdFwiKSwgcmVxdWlyZShcIlJlYWN0RE9NXCIpKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtcInJlYWN0XCIsIFwiUmVhY3RET01cIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wicmVhY3QtY2xpbWItc29jaWFsXCJdID0gZmFjdG9yeShyZXF1aXJlKFwicmVhY3RcIiksIHJlcXVpcmUoXCJSZWFjdERPTVwiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wicmVhY3QtY2xpbWItc29jaWFsXCJdID0gZmFjdG9yeShyb290W1wiUmVhY3RcIl0sIHJvb3RbXCJSZWFjdERPTVwiXSk7XG59KSh0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8zOV9fKSB7XG5yZXR1cm4gXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uXG4gKiovIiwiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicmVhY3RcIiksIHJlcXVpcmUoXCJSZWFjdERPTVwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJyZWFjdFwiLCBcIlJlYWN0RE9NXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInJlYWN0LWNsaW1iLXNvY2lhbFwiXSA9IGZhY3RvcnkocmVxdWlyZShcInJlYWN0XCIpLCByZXF1aXJlKFwiUmVhY3RET01cIikpO1xuXHRlbHNlXG5cdFx0cm9vdFtcInJlYWN0LWNsaW1iLXNvY2lhbFwiXSA9IGZhY3Rvcnkocm9vdFtcIlJlYWN0XCJdLCByb290W1wiUmVhY3RET01cIl0pO1xufSkodGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMzlfXykge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9cIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBfcmVhY3REb20gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDM5KTtcblx0XG5cdHZhciBfcmVhY3REb20yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3REb20pO1xuXHRcblx0dmFyIF9jb21wb25lbnRzV2FsbFdhbGxDb250YWluZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTtcblx0XG5cdHZhciBfY29tcG9uZW50c1dhbGxXYWxsQ29udGFpbmVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudHNXYWxsV2FsbENvbnRhaW5lcik7XG5cdFxuXHR2YXIgX2NvbXBvbmVudHNTbGlkZXNob3dTbGlkZXNob3dDb250YWluZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTtcblx0XG5cdHZhciBfY29tcG9uZW50c1NsaWRlc2hvd1NsaWRlc2hvd0NvbnRhaW5lcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRzU2xpZGVzaG93U2xpZGVzaG93Q29udGFpbmVyKTtcblx0XG5cdF9fd2VicGFja19yZXF1aXJlX18oMzYpO1xuXHRcblx0aWYgKHdpbmRvdykge1xuXHQgICAgd2luZG93LkNsaW1iID0gd2luZG93LkNsaW1iIHx8IHt9O1xuXHRcblx0ICAgIHZhciAkd2FsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2xpbWItd2FsbCcpO1xuXHRcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgJHdhbGxzLmxlbmd0aDsgKytpKSB7XG5cdCAgICAgICAgdmFyICRpdGVtID0gJHdhbGxzW2ldO1xuXHQgICAgICAgIHZhciBjb2xsZWN0aW9uSWQgPSAkaXRlbS5kYXRhc2V0LmNvbGxlY3Rpb25JZDtcblx0ICAgICAgICB2YXIgbGltaXQgPSAkaXRlbS5kYXRhc2V0LmxpbWl0O1xuXHRcblx0ICAgICAgICBfcmVhY3REb20yWydkZWZhdWx0J10ucmVuZGVyKF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzV2FsbFdhbGxDb250YWluZXIyWydkZWZhdWx0J10sIHsgY29sbGVjdGlvbklkOiBjb2xsZWN0aW9uSWQsIGxpbWl0OiBsaW1pdCB9KSwgJGl0ZW0pO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciAkc2xpZGVzaG93cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbGltYi1zbGlkZXNob3cnKTtcblx0XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzbGlkZXNob3dzLmxlbmd0aDsgKytpKSB7XG5cdCAgICAgICAgdmFyICRpdGVtID0gJHNsaWRlc2hvd3NbaV07XG5cdCAgICAgICAgdmFyIGNvbGxlY3Rpb25JZCA9ICRpdGVtLmRhdGFzZXQuY29sbGVjdGlvbklkO1xuXHQgICAgICAgIHZhciBkZWxheSA9IHBhcnNlSW50KCRpdGVtLmRhdGFzZXQuZGVsYXksIDApO1xuXHRcblx0ICAgICAgICBfcmVhY3REb20yWydkZWZhdWx0J10ucmVuZGVyKF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9jb21wb25lbnRzU2xpZGVzaG93U2xpZGVzaG93Q29udGFpbmVyMlsnZGVmYXVsdCddLCB7IGNvbGxlY3Rpb25JZDogY29sbGVjdGlvbklkLCBkZWxheTogZGVsYXkgfSksICRpdGVtKTtcblx0ICAgIH1cblx0fVxuXHRcblx0ZXhwb3J0cy5XYWxsQ29udGFpbmVyID0gX2NvbXBvbmVudHNXYWxsV2FsbENvbnRhaW5lcjJbJ2RlZmF1bHQnXTtcblx0XG5cdHZhciBfY29tcG9uZW50c1dhbGxXYWxsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnV2FsbCcsIHtcblx0ICAgIGVudW1lcmFibGU6IHRydWUsXG5cdCAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgICAgICByZXR1cm4gX2NvbXBvbmVudHNXYWxsV2FsbC5XYWxsO1xuXHQgICAgfVxuXHR9KTtcblx0XG5cdHZhciBfY29tcG9uZW50c1dhbGxUaWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnVGlsZScsIHtcblx0ICAgIGVudW1lcmFibGU6IHRydWUsXG5cdCAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0ICAgICAgICByZXR1cm4gX2NvbXBvbmVudHNXYWxsVGlsZS5UaWxlO1xuXHQgICAgfVxuXHR9KTtcblxuLyoqKi8gfSxcbi8qIDEgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xX187XG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBfY29tcG9uZW50czIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIzKTtcblx0XG5cdHZhciBfY29tcG9uZW50czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21wb25lbnRzMik7XG5cdFxuXHR2YXIgX3Jlb3JkZXJLZXlzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOCk7XG5cdFxuXHR2YXIgX3Jlb3JkZXJLZXlzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Jlb3JkZXJLZXlzKTtcblx0XG5cdHZhciBfY29tcG9uZW50cyA9IF9jb21wb25lbnRzM1snZGVmYXVsdCddKF9yZWFjdDJbJ2RlZmF1bHQnXSk7XG5cdFxuXHR2YXIgU3ByaW5nID0gX2NvbXBvbmVudHMuU3ByaW5nO1xuXHR2YXIgVHJhbnNpdGlvblNwcmluZyA9IF9jb21wb25lbnRzLlRyYW5zaXRpb25TcHJpbmc7XG5cdHZhciBNb3Rpb24gPSBfY29tcG9uZW50cy5Nb3Rpb247XG5cdHZhciBTdGFnZ2VyZWRNb3Rpb24gPSBfY29tcG9uZW50cy5TdGFnZ2VyZWRNb3Rpb247XG5cdHZhciBUcmFuc2l0aW9uTW90aW9uID0gX2NvbXBvbmVudHMuVHJhbnNpdGlvbk1vdGlvbjtcblx0ZXhwb3J0cy5TcHJpbmcgPSBTcHJpbmc7XG5cdGV4cG9ydHMuVHJhbnNpdGlvblNwcmluZyA9IFRyYW5zaXRpb25TcHJpbmc7XG5cdGV4cG9ydHMuTW90aW9uID0gTW90aW9uO1xuXHRleHBvcnRzLlN0YWdnZXJlZE1vdGlvbiA9IFN0YWdnZXJlZE1vdGlvbjtcblx0ZXhwb3J0cy5UcmFuc2l0aW9uTW90aW9uID0gVHJhbnNpdGlvbk1vdGlvbjtcblx0XG5cdHZhciBfc3ByaW5nMiA9IF9fd2VicGFja19yZXF1aXJlX18oMjkpO1xuXHRcblx0dmFyIF9zcHJpbmczID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3ByaW5nMik7XG5cdFxuXHRleHBvcnRzLnNwcmluZyA9IF9zcHJpbmczWydkZWZhdWx0J107XG5cdFxuXHR2YXIgX3ByZXNldHMyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5KTtcblx0XG5cdHZhciBfcHJlc2V0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcmVzZXRzMik7XG5cdFxuXHRleHBvcnRzLnByZXNldHMgPSBfcHJlc2V0czNbJ2RlZmF1bHQnXTtcblx0dmFyIHV0aWxzID0ge1xuXHQgIHJlb3JkZXJLZXlzOiBfcmVvcmRlcktleXMyWydkZWZhdWx0J11cblx0fTtcblx0ZXhwb3J0cy51dGlscyA9IHV0aWxzO1xuXG4vKioqLyB9LFxuLyogMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBcImRlZmF1bHRcIjogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgQXV0aG9yID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7XG5cdCAgICBfaW5oZXJpdHMoQXV0aG9yLCBfQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBBdXRob3IoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1dGhvcik7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKEF1dGhvci5wcm90b3R5cGUpLCBcImNvbnN0cnVjdG9yXCIsIHRoaXMpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKEF1dGhvciwgW3tcblx0ICAgICAgICBrZXk6IFwicmVuZGVyXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgXCJhXCIsXG5cdCAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogXCJjbGltYl9fYXV0aG9yXCIsXG5cdCAgICAgICAgICAgICAgICAgICAgaHJlZjogdGhpcy5wcm9wcy5saW5rIH0sXG5cdCAgICAgICAgICAgICAgICBfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KFwiaW1nXCIsIHsgaGVpZ2h0OiBcIjM0XCIsXG5cdCAgICAgICAgICAgICAgICAgICAgd2lkdGg6IFwiMzRcIixcblx0ICAgICAgICAgICAgICAgICAgICBzcmM6IHRoaXMucHJvcHMucGljdHVyZSxcblx0ICAgICAgICAgICAgICAgICAgICBhbHQ6IFwiUHJvZmlsZSBwaWMgb2YgXCIgKyB0aGlzLnByb3BzLm5hbWUgfSksXG5cdCAgICAgICAgICAgICAgICBfcmVhY3QyW1wiZGVmYXVsdFwiXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgICAgIFwiaDRcIixcblx0ICAgICAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogXCJjbGltYl9fdGlsZV9fYXV0aG9yX191c2VybmFtZVwiIH0sXG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy51c2VybmFtZVxuXHQgICAgICAgICAgICAgICAgKVxuXHQgICAgICAgICAgICApO1xuXHQgICAgICAgIH1cblx0ICAgIH1dLCBbe1xuXHQgICAgICAgIGtleTogXCJwcm9wVHlwZXNcIixcblx0ICAgICAgICB2YWx1ZToge1xuXHQgICAgICAgICAgICBsaW5rOiBfcmVhY3QuUHJvcFR5cGVzLnN0cmluZyxcblx0ICAgICAgICAgICAgcGljdHVyZTogX3JlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgICAgICAgICAgbmFtZTogX3JlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgICAgICAgICAgdXNlcm5hbWU6IF9yZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVudW1lcmFibGU6IHRydWVcblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gQXV0aG9yO1xuXHR9KShfcmVhY3QuQ29tcG9uZW50KTtcblx0XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gQXV0aG9yO1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBcImRlZmF1bHRcIjogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgSW1hZ2UgPSAoZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhJbWFnZSwgX1JlYWN0JENvbXBvbmVudCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gSW1hZ2UoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEltYWdlKTtcblx0XG5cdCAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoSW1hZ2UucHJvdG90eXBlKSwgXCJjb25zdHJ1Y3RvclwiLCB0aGlzKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhJbWFnZSwgW3tcblx0ICAgICAgICBrZXk6IFwicmVuZGVyXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbXCJkZWZhdWx0XCJdLmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgeyBjbGFzc05hbWU6IFwiY2xpbWJfX2ltYWdlXCIsXG5cdCAgICAgICAgICAgICAgICBzcmM6IHRoaXMucHJvcHMuc3JjLCBcImRhdGEtd2lkdGhcIjogdGhpcy5wcm9wcy53aWR0aCwgXCJkYXRhLWhlaWdodFwiOiB0aGlzLnByb3BzLmhlaWdodCB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIEltYWdlO1xuXHR9KShfcmVhY3QyW1wiZGVmYXVsdFwiXS5Db21wb25lbnQpO1xuXHRcblx0SW1hZ2UucHJvcFR5cGVzID0ge1xuXHQgICAgc3JjOiBfcmVhY3QyW1wiZGVmYXVsdFwiXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICB3aWR0aDogX3JlYWN0MltcImRlZmF1bHRcIl0uUHJvcFR5cGVzLm51bWJlcixcblx0ICAgIGhlaWdodDogX3JlYWN0MltcImRlZmF1bHRcIl0uUHJvcFR5cGVzLm51bWJlclxuXHR9O1xuXHRcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBJbWFnZTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgTWVzc2FnZSA9IChmdW5jdGlvbiAoX1JlYWN0JENvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKE1lc3NhZ2UsIF9SZWFjdCRDb21wb25lbnQpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIE1lc3NhZ2UoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lc3NhZ2UpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihNZXNzYWdlLnByb3RvdHlwZSksICdjb25zdHJ1Y3RvcicsIHRoaXMpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKE1lc3NhZ2UsIFt7XG5cdCAgICAgICAga2V5OiAncmVuZGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcblx0ICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSB0aGlzLnByb3BzLmJvZHkucmVwbGFjZSgvPGEgaHJlZj1cImh0dHA6XFwvXFwvcGljLnR3aXR0ZXIuY29tXFwvW14+XSo+KFtePF0rKTxcXC9hPi9nLCAnJyk7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsgY2xhc3NOYW1lOiAnY2xpbWJfX21lc3NhZ2UnLFxuXHQgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHsgX19odG1sOiBtZXNzYWdlIH0gfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBNZXNzYWdlO1xuXHR9KShfcmVhY3QyWydkZWZhdWx0J10uQ29tcG9uZW50KTtcblx0XG5cdE1lc3NhZ2UucHJvcFR5cGVzID0ge1xuXHQgICAgYm9keTogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuXHR9O1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gTWVzc2FnZTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiA2ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmICgndmFsdWUnIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cdFxuXHR2YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXHRcblx0dmFyIF9jb21tb25JbWFnZSA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cdFxuXHR2YXIgX2NvbW1vbkltYWdlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbW1vbkltYWdlKTtcblx0XG5cdHZhciBfY29tbW9uTWVzc2FnZSA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cdFxuXHR2YXIgX2NvbW1vbk1lc3NhZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tbW9uTWVzc2FnZSk7XG5cdFxuXHR2YXIgX2NvbW1vbkF1dGhvciA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdFxuXHR2YXIgX2NvbW1vbkF1dGhvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21tb25BdXRob3IpO1xuXHRcblx0dmFyIFRpbGUgPSAoZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhUaWxlLCBfUmVhY3QkQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBUaWxlKHByb3BzKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRpbGUpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihUaWxlLnByb3RvdHlwZSksICdjb25zdHJ1Y3RvcicsIHRoaXMpLmNhbGwodGhpcywgcHJvcHMpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhUaWxlLCBbe1xuXHQgICAgICAgIGtleTogJ2NyZWF0ZUltYWdlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlSW1hZ2UoKSB7XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5pbWFnZSAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIF9wcm9wcyRpbWFnZSA9IHRoaXMucHJvcHMuaW1hZ2U7XG5cdCAgICAgICAgICAgICAgICB2YXIgc3JjID0gX3Byb3BzJGltYWdlLnVybDtcblx0ICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IF9wcm9wcyRpbWFnZS53aWR0aDtcblx0ICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBfcHJvcHMkaW1hZ2UuaGVpZ2h0O1xuXHRcblx0ICAgICAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfY29tbW9uSW1hZ2UyWydkZWZhdWx0J10sIHsgc3JjOiBzcmMsXG5cdCAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxuXHQgICAgICAgICAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0IH0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdjcmVhdGVNZXNzYWdlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlTWVzc2FnZSgpIHtcblx0XG5cdCAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLm1lc3NhZ2UpIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfY29tbW9uTWVzc2FnZTJbJ2RlZmF1bHQnXSwgeyBib2R5OiB0aGlzLnByb3BzLm1lc3NhZ2UgfSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2NyZWF0ZUNsYXNzU3RyaW5nJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlQ2xhc3NTdHJpbmcoKSB7XG5cdFxuXHQgICAgICAgICAgICB2YXIgY2xhc3NTdHJpbmcgPSAnY2xpbWJfX3RpbGUgY2xpbWJfX3RpbGUtLScgKyB0aGlzLnByb3BzLnNvdXJjZV90eXBlO1xuXHRcblx0ICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuaW1hZ2UpIHtcblx0ICAgICAgICAgICAgICAgIGNsYXNzU3RyaW5nICs9ICcgY2xpbWJfX3RpbGUtLWhhcy1tZWRpYSBjbGltYl9fdGlsZS0taGFzLWltYWdlJztcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGNsYXNzU3RyaW5nICs9ICcgY2xpbWJfX3RpbGUtLWhhcy1uby1pbWFnZSc7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLnZpZGVvX3VybCkge1xuXHQgICAgICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW1lZGlhIGNsaW1iX190aWxlLS1oYXMtdmlkZW8nO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW5vLXZpZGVvJztcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIGNsYXNzU3RyaW5nO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW5kZXInLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdFxuXHQgICAgICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmNyZWF0ZUltYWdlKCk7XG5cdCAgICAgICAgICAgIHZhciBtZXNzYWdlID0gdGhpcy5jcmVhdGVNZXNzYWdlKCk7XG5cdCAgICAgICAgICAgIHZhciBjbGFzc1N0cmluZyA9IHRoaXMuY3JlYXRlQ2xhc3NTdHJpbmcoKTtcblx0ICAgICAgICAgICAgdmFyIGF1dGhvciA9IHRoaXMucHJvcHMuYXV0aG9yO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgJ2RpdicsXG5cdCAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogY2xhc3NTdHJpbmcsXG5cdCAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHRoaXMucHJvcHMuc3R5bGUgfSxcblx0ICAgICAgICAgICAgICAgIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgICAgICdhJyxcblx0ICAgICAgICAgICAgICAgICAgICB7IGhyZWY6IHRoaXMucHJvcHMubGluayB9LFxuXHQgICAgICAgICAgICAgICAgICAgIGltYWdlXG5cdCAgICAgICAgICAgICAgICApLFxuXHQgICAgICAgICAgICAgICAgX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG5cdCAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdjbGltYl9fdGlsZV9fY29udGVudCcgfSxcblx0ICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLFxuXHQgICAgICAgICAgICAgICAgICAgIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9jb21tb25BdXRob3IyWydkZWZhdWx0J10sIGF1dGhvcilcblx0ICAgICAgICAgICAgICAgIClcblx0ICAgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIFRpbGU7XG5cdH0pKF9yZWFjdDJbJ2RlZmF1bHQnXS5Db21wb25lbnQpO1xuXHRcblx0VGlsZS5wcm9wVHlwZXMgPSB7XG5cdFxuXHQgICAgLy8gUmVxdWlyZWQgYXR0cnNcblx0ICAgIGxpbms6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICBzb3VyY2VfdHlwZTogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgIHRpbWVzdGFtcDogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcblx0ICAgIGF1dGhvcjogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zaGFwZSh7XG5cdCAgICAgICAgdXNlcm5hbWU6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICAgICAgcGljdHVyZTogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgICAgICBsaW5rOiBfcmVhY3QyWydkZWZhdWx0J10uUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkXG5cdCAgICB9KSxcblx0XG5cdCAgICAvLyBPcHRpb25hbCBhdHRyc1xuXHQgICAgbWVzc2FnZTogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcsXG5cdCAgICB2aWRlb19zcmM6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc3RyaW5nLFxuXHQgICAgaW1hZ2U6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMuc2hhcGUoe1xuXHQgICAgICAgIHVybDogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblx0ICAgICAgICB3aWR0aDogX3JlYWN0MlsnZGVmYXVsdCddLlByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcblx0ICAgICAgICBoZWlnaHQ6IF9yZWFjdDJbJ2RlZmF1bHQnXS5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWRcblx0ICAgIH0pXG5cdFxuXHR9O1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gVGlsZTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiA3ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfZXh0ZW5kcyA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldOyBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBrZXkpKSB7IHRhcmdldFtrZXldID0gc291cmNlW2tleV07IH0gfSB9IHJldHVybiB0YXJnZXQ7IH07XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoJ3ZhbHVlJyBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfSB9O1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKG9iaiwga2V5cykgeyB2YXIgdGFyZ2V0ID0ge307IGZvciAodmFyIGkgaW4gb2JqKSB7IGlmIChrZXlzLmluZGV4T2YoaSkgPj0gMCkgY29udGludWU7IGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgaSkpIGNvbnRpbnVlOyB0YXJnZXRbaV0gPSBvYmpbaV07IH0gcmV0dXJuIHRhcmdldDsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBfVGlsZSA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdFxuXHR2YXIgX1RpbGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfVGlsZSk7XG5cdFxuXHR2YXIgX3JlYWN0TW90aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdHZhciBXYWxsID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7XG5cdCAgICBfaW5oZXJpdHMoV2FsbCwgX0NvbXBvbmVudCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gV2FsbCgpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV2FsbCk7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFdhbGwucHJvdG90eXBlKSwgJ2NvbnN0cnVjdG9yJywgdGhpcykuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoV2FsbCwgW3tcblx0ICAgICAgICBrZXk6ICdnZXRTdHlsZXMnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdHlsZXMoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICB2YXIgY29uZmlncyA9IHt9O1xuXHQgICAgICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnByb3BzLml0ZW1zKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuXHQgICAgICAgICAgICAgICAgY29uZmlnc1trZXldID0ge1xuXHQgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgxKSxcblx0ICAgICAgICAgICAgICAgICAgICB3aWR0aDogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDMwKSxcblx0ICAgICAgICAgICAgICAgICAgICBtYXJnaW46ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgxKSxcblx0ICAgICAgICAgICAgICAgICAgICBpdGVtOiBfdGhpcy5wcm9wcy5pdGVtc1trZXldXG5cdCAgICAgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbmZpZ3M7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3dpbGxFbnRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpbGxFbnRlcihrZXkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgICAgIG9wYWNpdHk6ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgwKSxcblx0ICAgICAgICAgICAgICAgIHdpZHRoOiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMCksXG5cdCAgICAgICAgICAgICAgICBtYXJnaW46ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgwKSxcblx0ICAgICAgICAgICAgICAgIGl0ZW06IHRoaXMucHJvcHMuaXRlbXNba2V5XVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICd3aWxsTGVhdmUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3aWxsTGVhdmUoa2V5LCBzdHlsZSkge1xuXHQgICAgICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICAgICAgb3BhY2l0eTogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgd2lkdGg6ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgwKSxcblx0ICAgICAgICAgICAgICAgIG1hcmdpbjogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgaXRlbTogc3R5bGUuaXRlbVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW5kZXJUaWxlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyVGlsZShrZXksIGl0ZW1WYWx1ZXMpIHtcblx0ICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtVmFsdWVzLml0ZW07XG5cdFxuXHQgICAgICAgICAgICB2YXIgc3R5bGVDb25maWcgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoaXRlbVZhbHVlcywgWydpdGVtJ10pO1xuXHRcblx0ICAgICAgICAgICAgdmFyIGl0ZW1Qcm9wcyA9IF9vYmplY3RXaXRob3V0UHJvcGVydGllcyhpdGVtLCBbXSk7XG5cdFxuXHQgICAgICAgICAgICB2YXIgc3R5bGUgPSB7XG5cdCAgICAgICAgICAgICAgICBvcGFjaXR5OiBzdHlsZUNvbmZpZy5vcGFjaXR5LFxuXHQgICAgICAgICAgICAgICAgd2lkdGg6IHN0eWxlQ29uZmlnLndpZHRoICsgJyUnLFxuXHQgICAgICAgICAgICAgICAgbWFyZ2luTGVmdDogc3R5bGVDb25maWcubWFyZ2luICsgJyUnLFxuXHQgICAgICAgICAgICAgICAgbWFyZ2luUmlnaHQ6IHN0eWxlQ29uZmlnLm1hcmdpbiArICclJ1xuXHQgICAgICAgICAgICB9O1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9UaWxlMlsnZGVmYXVsdCddLCBfZXh0ZW5kcyh7IGtleToga2V5LFxuXHQgICAgICAgICAgICAgICAgc3R5bGU6IHN0eWxlXG5cdCAgICAgICAgICAgIH0sIGl0ZW1Qcm9wcykpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW5kZXInLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgX3JlYWN0TW90aW9uLlRyYW5zaXRpb25Nb3Rpb24sXG5cdCAgICAgICAgICAgICAgICB7XG5cdCAgICAgICAgICAgICAgICAgICAgc3R5bGVzOiB0aGlzLmdldFN0eWxlcy5iaW5kKHRoaXMpKCksXG5cdCAgICAgICAgICAgICAgICAgICAgd2lsbEVudGVyOiB0aGlzLndpbGxFbnRlci5iaW5kKHRoaXMpLFxuXHQgICAgICAgICAgICAgICAgICAgIHdpbGxMZWF2ZTogdGhpcy53aWxsTGVhdmUuYmluZCh0aGlzKSB9LFxuXHQgICAgICAgICAgICAgICAgZnVuY3Rpb24gKHZhbHVlcykge1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChcblx0ICAgICAgICAgICAgICAgICAgICAgICAgJ2RpdicsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnY2xpbWJfX3dhbGwnIH0sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHZhbHVlcykubWFwKGZ1bmN0aW9uIChrZXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWVzID0gdmFsdWVzW2tleV07XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLnJlbmRlclRpbGUoa2V5LCBpdGVtVmFsdWVzKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSlcblx0ICAgICAgICAgICAgICAgICAgICApO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICApO1xuXHQgICAgICAgIH1cblx0ICAgIH1dLCBbe1xuXHQgICAgICAgIGtleTogJ3Byb3BUeXBlcycsXG5cdCAgICAgICAgdmFsdWU6IHtcblx0ICAgICAgICAgICAgaXRlbXM6IF9yZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWRcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVudW1lcmFibGU6IHRydWVcblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gV2FsbDtcblx0fSkoX3JlYWN0LkNvbXBvbmVudCk7XG5cdFxuXHRleHBvcnRzWydkZWZhdWx0J10gPSBXYWxsO1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDggKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0dmFyIF9yeExpdGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4KTtcblx0XG5cdHZhciBfZmV0Y2hKc29ucCA9IF9fd2VicGFja19yZXF1aXJlX18oMjEpO1xuXHRcblx0dmFyIF9mZXRjaEpzb25wMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZldGNoSnNvbnApO1xuXHRcblx0dmFyIGdldFN0cmVhbSA9IGZ1bmN0aW9uIGdldFN0cmVhbShjb2xsZWN0aW9uSWQpIHtcblx0XG5cdCAgICB2YXIgcG9sbFJhdGUgPSA1ICogMTAwMDtcblx0XG5cdCAgICB2YXIgcmVxdWVzdFN0cmVhbSA9IF9yeExpdGUuT2JzZXJ2YWJsZS5qdXN0KCdodHRwOi8vYXBwLmNsaW1iLnNvY2lhbC9hcGkvdjEvY29sbGVjdGlvbnMvJyArIGNvbGxlY3Rpb25JZCk7XG5cdFxuXHQgICAgdmFyIHVwZGF0ZVN0cmVhbSA9IF9yeExpdGUuT2JzZXJ2YWJsZS5pbnRlcnZhbChwb2xsUmF0ZSkuc3RhcnRXaXRoKG51bGwpO1xuXHRcblx0ICAgIHZhciByZXNwb25zZVN0cmVhbSA9IHVwZGF0ZVN0cmVhbS5jb21iaW5lTGF0ZXN0KHJlcXVlc3RTdHJlYW0sIGZ1bmN0aW9uICh0aWNrLCB1cmwpIHtcblx0ICAgICAgICByZXR1cm4gdXJsO1xuXHQgICAgfSkuZmxhdE1hcChmdW5jdGlvbiAoYmFzZVVybCkge1xuXHRcblx0ICAgICAgICB2YXIgcmVxdWVzdFVybCA9ICcnICsgYmFzZVVybDtcblx0XG5cdCAgICAgICAgcmV0dXJuIF9yeExpdGUuT2JzZXJ2YWJsZS5mcm9tUHJvbWlzZSgoMCwgX2ZldGNoSnNvbnAyWydkZWZhdWx0J10pKHJlcXVlc3RVcmwpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHJlc3AuanNvbigpO1xuXHQgICAgICAgIH0pKTtcblx0ICAgIH0pO1xuXHRcblx0ICAgIHJldHVybiByZXNwb25zZVN0cmVhbTtcblx0fTtcblx0XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IHtcblx0ICAgIGdldFN0cmVhbTogZ2V0U3RyZWFtXG5cdH07XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG5cbi8qKiovIH0sXG4vKiA5ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvLyBbc3RpZmZuZXNzLCBkYW1waW5nXVxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0ge1xuXHQgIG5vV29iYmxlOiBbMTcwLCAyNl0sIC8vIHRoZSBkZWZhdWx0XG5cdCAgZ2VudGxlOiBbMTIwLCAxNF0sXG5cdCAgd29iYmx5OiBbMTgwLCAxMl0sXG5cdCAgc3RpZmY6IFsyMTAsIDIwXVxuXHR9O1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogMTAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqLyhmdW5jdGlvbihwcm9jZXNzKSB7Ly8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjcuMVxuXHQoZnVuY3Rpb24oKSB7XG5cdCAgdmFyIGdldE5hbm9TZWNvbmRzLCBocnRpbWUsIGxvYWRUaW1lO1xuXHRcblx0ICBpZiAoKHR5cGVvZiBwZXJmb3JtYW5jZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBwZXJmb3JtYW5jZSAhPT0gbnVsbCkgJiYgcGVyZm9ybWFuY2Uubm93KSB7XG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gcGVyZm9ybWFuY2Uubm93KCk7XG5cdCAgICB9O1xuXHQgIH0gZWxzZSBpZiAoKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MgIT09IG51bGwpICYmIHByb2Nlc3MuaHJ0aW1lKSB7XG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gKGdldE5hbm9TZWNvbmRzKCkgLSBsb2FkVGltZSkgLyAxZTY7XG5cdCAgICB9O1xuXHQgICAgaHJ0aW1lID0gcHJvY2Vzcy5ocnRpbWU7XG5cdCAgICBnZXROYW5vU2Vjb25kcyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICB2YXIgaHI7XG5cdCAgICAgIGhyID0gaHJ0aW1lKCk7XG5cdCAgICAgIHJldHVybiBoclswXSAqIDFlOSArIGhyWzFdO1xuXHQgICAgfTtcblx0ICAgIGxvYWRUaW1lID0gZ2V0TmFub1NlY29uZHMoKTtcblx0ICB9IGVsc2UgaWYgKERhdGUubm93KSB7XG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gRGF0ZS5ub3coKSAtIGxvYWRUaW1lO1xuXHQgICAgfTtcblx0ICAgIGxvYWRUaW1lID0gRGF0ZS5ub3coKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gbG9hZFRpbWU7XG5cdCAgICB9O1xuXHQgICAgbG9hZFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblx0ICB9XG5cdFxuXHR9KS5jYWxsKHRoaXMpO1xuXHRcblx0LyogV0VCUEFDSyBWQVIgSU5KRUNUSU9OICovfS5jYWxsKGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18oMTEpKSlcblxuLyoqKi8gfSxcbi8qIDExICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcblx0XG5cdHZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblx0dmFyIHF1ZXVlID0gW107XG5cdHZhciBkcmFpbmluZyA9IGZhbHNlO1xuXHR2YXIgY3VycmVudFF1ZXVlO1xuXHR2YXIgcXVldWVJbmRleCA9IC0xO1xuXHRcblx0ZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuXHQgICAgZHJhaW5pbmcgPSBmYWxzZTtcblx0ICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG5cdCAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuXHQgICAgfVxuXHQgICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgIGRyYWluUXVldWUoKTtcblx0ICAgIH1cblx0fVxuXHRcblx0ZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcblx0ICAgIGlmIChkcmFpbmluZykge1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgIH1cblx0ICAgIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuXHQgICAgZHJhaW5pbmcgPSB0cnVlO1xuXHRcblx0ICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG5cdCAgICB3aGlsZShsZW4pIHtcblx0ICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcblx0ICAgICAgICBxdWV1ZSA9IFtdO1xuXHQgICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcblx0ICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuXHQgICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcblx0ICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG5cdCAgICB9XG5cdCAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuXHQgICAgZHJhaW5pbmcgPSBmYWxzZTtcblx0ICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblx0fVxuXHRcblx0cHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcblx0ICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblx0ICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG5cdCAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuXHQgICAgICAgIHNldFRpbWVvdXQoZHJhaW5RdWV1ZSwgMCk7XG5cdCAgICB9XG5cdH07XG5cdFxuXHQvLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5cdGZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuXHQgICAgdGhpcy5mdW4gPSBmdW47XG5cdCAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG5cdH1cblx0SXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG5cdH07XG5cdHByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5cdHByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5cdHByb2Nlc3MuZW52ID0ge307XG5cdHByb2Nlc3MuYXJndiA9IFtdO1xuXHRwcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcblx0cHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXHRcblx0ZnVuY3Rpb24gbm9vcCgpIHt9XG5cdFxuXHRwcm9jZXNzLm9uID0gbm9vcDtcblx0cHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5cdHByb2Nlc3Mub25jZSA9IG5vb3A7XG5cdHByb2Nlc3Mub2ZmID0gbm9vcDtcblx0cHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5cdHByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcblx0cHJvY2Vzcy5lbWl0ID0gbm9vcDtcblx0XG5cdHByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG5cdCAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG5cdH07XG5cdFxuXHRwcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xuXHRwcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuXHQgICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcblx0fTtcblx0cHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcblxuXG4vKioqLyB9LFxuLyogMTIgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgX2NvbW1vbk1lc3NhZ2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xuXHRcblx0dmFyIF9jb21tb25NZXNzYWdlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbW1vbk1lc3NhZ2UpO1xuXHRcblx0dmFyIF9jb21tb25BdXRob3IgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHRcblx0dmFyIF9jb21tb25BdXRob3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tbW9uQXV0aG9yKTtcblx0XG5cdHZhciBQYW5lbCA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKFBhbmVsLCBfQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBQYW5lbCgpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGFuZWwpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihQYW5lbC5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhQYW5lbCwgW3tcblx0ICAgICAgICBrZXk6ICdjcmVhdGVBdXRob3InLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVBdXRob3IoKSB7XG5cdCAgICAgICAgICAgIHZhciBhdXRob3IgPSB0aGlzLnByb3BzLmF1dGhvcjtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfY29tbW9uQXV0aG9yMlsnZGVmYXVsdCddLCBhdXRob3IpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdjcmVhdGVNZXNzYWdlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlTWVzc2FnZSgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9jb21tb25NZXNzYWdlMlsnZGVmYXVsdCddLCB7IGJvZHk6IHRoaXMucHJvcHMubWVzc2FnZSB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVuZGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHRcblx0ICAgICAgICAgICAgdmFyIGF1dGhvciA9IHRoaXMuY3JlYXRlQXV0aG9yKCk7XG5cdCAgICAgICAgICAgIHZhciBtZXNzYWdlID0gdGhpcy5jcmVhdGVNZXNzYWdlKCk7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgICAgICAgICAnZGl2Jyxcblx0ICAgICAgICAgICAgICAgIHsgc3R5bGU6IHRoaXMucHJvcHMuc3R5bGUsXG5cdCAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnY2xpbWItc2xpZGVzaG93X19wYW5lbCcgfSxcblx0ICAgICAgICAgICAgICAgIGF1dGhvcixcblx0ICAgICAgICAgICAgICAgIG1lc3NhZ2Vcblx0ICAgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdCAgICB9XSwgW3tcblx0ICAgICAgICBrZXk6ICdwcm9wVHlwZXMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIG1lc3NhZ2U6IF9yZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICAgICAgICAgIGF1dGhvcjogX3JlYWN0LlByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBQYW5lbDtcblx0fSkoX3JlYWN0LkNvbXBvbmVudCk7XG5cdFxuXHRleHBvcnRzWydkZWZhdWx0J10gPSBQYW5lbDtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAxMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXHRcblx0dmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IGRlc2MgPSBwYXJlbnQgPSBnZXR0ZXIgPSB1bmRlZmluZWQ7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoJ3ZhbHVlJyBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfSB9O1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX29iamVjdFdpdGhvdXRQcm9wZXJ0aWVzKG9iaiwga2V5cykgeyB2YXIgdGFyZ2V0ID0ge307IGZvciAodmFyIGkgaW4gb2JqKSB7IGlmIChrZXlzLmluZGV4T2YoaSkgPj0gMCkgY29udGludWU7IGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgaSkpIGNvbnRpbnVlOyB0YXJnZXRbaV0gPSBvYmpbaV07IH0gcmV0dXJuIHRhcmdldDsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXHRcblx0dmFyIF9yZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX3JlYWN0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlYWN0KTtcblx0XG5cdHZhciBfc2xpZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1KTtcblx0XG5cdHZhciBfc2xpZGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc2xpZGUpO1xuXHRcblx0dmFyIF9yZWFjdE1vdGlvbiA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR2YXIgU2xpZGVzaG93ID0gKGZ1bmN0aW9uIChfQ29tcG9uZW50KSB7XG5cdCAgICBfaW5oZXJpdHMoU2xpZGVzaG93LCBfQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBTbGlkZXNob3cocHJvcHMpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2xpZGVzaG93KTtcblx0XG5cdCAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoU2xpZGVzaG93LnByb3RvdHlwZSksICdjb25zdHJ1Y3RvcicsIHRoaXMpLmNhbGwodGhpcywgcHJvcHMpO1xuXHQgICAgICAgIHRoaXMuc3RhdGUgPSB7XG5cdCAgICAgICAgICAgIGN1cnJlbnRLZXk6ICcnXG5cdCAgICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoU2xpZGVzaG93LCBbe1xuXHQgICAgICAgIGtleTogJ2NvbXBvbmVudERpZE1vdW50Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG5cdCAgICAgICAgICAgIHZhciBkZWxheSA9IHRoaXMucHJvcHMuZGVsYXk7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwodGhpcy5uZXh0U2xpZGUuYmluZCh0aGlzKSwgZGVsYXkgKiAxMDAwKTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY29tcG9uZW50V2lsbFVubW91bnQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcblx0ICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnbmV4dFNsaWRlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbmV4dFNsaWRlKCkge1xuXHQgICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMucHJvcHMuaXRlbXMpO1xuXHQgICAgICAgICAgICB2YXIgcmFuZG9tS2V5ID0ga2V5c1trZXlzLmxlbmd0aCAqIE1hdGgucmFuZG9tKCkgPDwgMF07XG5cdFxuXHQgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcblx0ICAgICAgICAgICAgICAgIGN1cnJlbnRLZXk6IHJhbmRvbUtleVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnZ2V0U3R5bGVzJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3R5bGVzKCkge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgdmFyIGN1cnJlbnRLZXkgPSB0aGlzLnN0YXRlLmN1cnJlbnRLZXk7XG5cdCAgICAgICAgICAgIHZhciBjb25maWdzID0ge307XG5cdCAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMucHJvcHMuaXRlbXMpLm1hcChmdW5jdGlvbiAoa2V5KSB7XG5cdCAgICAgICAgICAgICAgICBjb25maWdzW2tleV0gPSB7XG5cdCAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgICAgIHNjYWxlOiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMCksXG5cdCAgICAgICAgICAgICAgICAgICAgekluZGV4OiAtNSxcblx0ICAgICAgICAgICAgICAgICAgICBpdGVtOiBfdGhpcy5wcm9wcy5pdGVtc1trZXldXG5cdCAgICAgICAgICAgICAgICB9O1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IGN1cnJlbnRLZXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbmZpZ3Nba2V5XSwge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMSksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlOiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMSksXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHpJbmRleDogMVxuXHQgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbmZpZ3M7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3dpbGxFbnRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpbGxFbnRlcihrZXkpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgICAgIG9wYWNpdHk6ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgwKSxcblx0ICAgICAgICAgICAgICAgIHNjYWxlOiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMCksXG5cdCAgICAgICAgICAgICAgICB6SW5kZXg6IC01LFxuXHQgICAgICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3dpbGxMZWF2ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHdpbGxMZWF2ZShrZXksIHN0eWxlKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgICAgICBvcGFjaXR5OiAoMCwgX3JlYWN0TW90aW9uLnNwcmluZykoMCksXG5cdCAgICAgICAgICAgICAgICBzY2FsZTogKDAsIF9yZWFjdE1vdGlvbi5zcHJpbmcpKDApLFxuXHQgICAgICAgICAgICAgICAgekluZGV4OiAtNSxcblx0ICAgICAgICAgICAgICAgIGl0ZW06IHN0eWxlLml0ZW1cblx0ICAgICAgICAgICAgfTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVuZGVyU2xpZGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXJTbGlkZShrZXksIGl0ZW1WYWx1ZXMpIHtcblx0ICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtVmFsdWVzLml0ZW07XG5cdFxuXHQgICAgICAgICAgICB2YXIgc3R5bGVDb25maWcgPSBfb2JqZWN0V2l0aG91dFByb3BlcnRpZXMoaXRlbVZhbHVlcywgWydpdGVtJ10pO1xuXHRcblx0ICAgICAgICAgICAgdmFyIHN0eWxlID0ge1xuXHQgICAgICAgICAgICAgICAgb3BhY2l0eTogc3R5bGVDb25maWcub3BhY2l0eSxcblx0ICAgICAgICAgICAgICAgIHpJbmRleDogTWF0aC5mbG9vcihzdHlsZUNvbmZpZy56SW5kZXgpLFxuXHQgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiAnc2NhbGUoJyArIHN0eWxlQ29uZmlnLnNjYWxlICsgJyknXG5cdCAgICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX3NsaWRlMlsnZGVmYXVsdCddLCB7IGtleToga2V5LFxuXHQgICAgICAgICAgICAgICAgaXNDdXJyZW50OiBrZXkgPT09IHRoaXMuc3RhdGUuY3VycmVudEtleSxcblx0ICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0sXG5cdCAgICAgICAgICAgICAgICBzdHlsZTogc3R5bGUgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbmRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgICAgICAgICBfcmVhY3RNb3Rpb24uVHJhbnNpdGlvbk1vdGlvbixcblx0ICAgICAgICAgICAgICAgIHtcblx0ICAgICAgICAgICAgICAgICAgICBzdHlsZXM6IHRoaXMuZ2V0U3R5bGVzLmJpbmQodGhpcykoKSxcblx0ICAgICAgICAgICAgICAgICAgICB3aWxsRW50ZXI6IHRoaXMud2lsbEVudGVyLmJpbmQodGhpcyksXG5cdCAgICAgICAgICAgICAgICAgICAgd2lsbExlYXZlOiB0aGlzLndpbGxMZWF2ZS5iaW5kKHRoaXMpIH0sXG5cdCAgICAgICAgICAgICAgICBmdW5jdGlvbiAodmFsdWVzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAnZGl2Jyxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdjbGltYl9fc2xpZGVzaG93X19jb250YWluZXInIH0sXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHZhbHVlcykubWFwKGZ1bmN0aW9uIChrZXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWVzID0gdmFsdWVzW2tleV07XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLnJlbmRlclNsaWRlKGtleSwgaXRlbVZhbHVlcyk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cdCAgICAgICAgICAgICAgICAgICAgKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdCAgICB9XSwgW3tcblx0ICAgICAgICBrZXk6ICdwcm9wVHlwZXMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIGl0ZW1zOiBfcmVhY3QuUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuXHQgICAgICAgICAgICBkZWxheTogX3JlYWN0LlByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBTbGlkZXNob3c7XG5cdH0pKF9yZWFjdC5Db21wb25lbnQpO1xuXHRcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gU2xpZGVzaG93O1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDE0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmICgndmFsdWUnIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cdFxuXHR2YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXHRcblx0dmFyIF9jbGltYlNvY2lhbCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdFxuXHR2YXIgX2NsaW1iU29jaWFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NsaW1iU29jaWFsKTtcblx0XG5cdHZhciBfU2xpZGVzaG93ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMyk7XG5cdFxuXHR2YXIgX1NsaWRlc2hvdzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TbGlkZXNob3cpO1xuXHRcblx0dmFyIFNsaWRlc2hvd0NvbnRhaW5lciA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKFNsaWRlc2hvd0NvbnRhaW5lciwgX0NvbXBvbmVudCk7XG5cdFxuXHQgICAgZnVuY3Rpb24gU2xpZGVzaG93Q29udGFpbmVyKHByb3BzKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNsaWRlc2hvd0NvbnRhaW5lcik7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFNsaWRlc2hvd0NvbnRhaW5lci5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5jYWxsKHRoaXMsIHByb3BzKTtcblx0ICAgICAgICB0aGlzLnN0YXRlID0ge1xuXHQgICAgICAgICAgICBpdGVtczoge31cblx0ICAgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhTbGlkZXNob3dDb250YWluZXIsIFt7XG5cdCAgICAgICAga2V5OiAnaW5pdCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICBpZiAoIXRoaXMucHJvcHMuY29sbGVjdGlvbklkKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIF9jbGltYlNvY2lhbDJbJ2RlZmF1bHQnXS5nZXRTdHJlYW0odGhpcy5wcm9wcy5jb2xsZWN0aW9uSWQpLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbXMpIHtcblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgbWFwcGVkSXRlbXMgPSB7fTtcblx0ICAgICAgICAgICAgICAgIGl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkge1xuXHQgICAgICAgICAgICAgICAgICAgIG1hcHBlZEl0ZW1zW2l0ZW0uaWRdID0gaXRlbTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHtcblx0ICAgICAgICAgICAgICAgICAgICBpdGVtczogbWFwcGVkSXRlbXNcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY29tcG9uZW50RGlkTW91bnQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcblx0ICAgICAgICAgICAgdGhpcy5pbml0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbmRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9TbGlkZXNob3cyWydkZWZhdWx0J10sIHsgaXRlbXM6IHRoaXMuc3RhdGUuaXRlbXMsIGRlbGF5OiB0aGlzLnByb3BzLmRlbGF5IH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH1dLCBbe1xuXHQgICAgICAgIGtleTogJ3Byb3BUeXBlcycsXG5cdCAgICAgICAgdmFsdWU6IHtcblx0ICAgICAgICAgICAgY29sbGVjdGlvbklkOiBfcmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuXHQgICAgICAgICAgICBkZWxheTogX3JlYWN0LlByb3BUeXBlcy5udW1iZXJcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVudW1lcmFibGU6IHRydWVcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdkZWZhdWx0UHJvcHMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogJzU2MWJhNjM0NDUyODRlMTc0MGUwMTZmNycsXG5cdCAgICAgICAgICAgIGRlbGF5OiA1XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIFNsaWRlc2hvd0NvbnRhaW5lcjtcblx0fSkoX3JlYWN0LkNvbXBvbmVudCk7XG5cdFxuXHRleHBvcnRzWydkZWZhdWx0J10gPSBTbGlkZXNob3dDb250YWluZXI7XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogMTUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgX1BhbmVsID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMik7XG5cdFxuXHR2YXIgX1BhbmVsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1BhbmVsKTtcblx0XG5cdHZhciBfY29tbW9uSW1hZ2UgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpO1xuXHRcblx0dmFyIF9jb21tb25JbWFnZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb21tb25JbWFnZSk7XG5cdFxuXHR2YXIgX3JlYWN0TW90aW9uID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTtcblx0XG5cdHZhciBTbGlkZSA9IChmdW5jdGlvbiAoX0NvbXBvbmVudCkge1xuXHQgICAgX2luaGVyaXRzKFNsaWRlLCBfQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBTbGlkZShwcm9wcykge1xuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTbGlkZSk7XG5cdFxuXHQgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFNsaWRlLnByb3RvdHlwZSksICdjb25zdHJ1Y3RvcicsIHRoaXMpLmNhbGwodGhpcywgcHJvcHMpO1xuXHQgICAgICAgIHRoaXMuc3RhdGUgPSB7XG5cdCAgICAgICAgICAgIHNob3VsZERpc3BsYXlQYW5lbDogZmFsc2Vcblx0ICAgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhTbGlkZSwgW3tcblx0ICAgICAgICBrZXk6ICdjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIGlmIChuZXh0UHJvcHMuaXNDdXJyZW50KSB7XG5cdCAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZERpc3BsYXlQYW5lbDogdHJ1ZVxuXHQgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfSwgODUwKTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuXHQgICAgICAgICAgICAgICAgICAgIHNob3VsZERpc3BsYXlQYW5lbDogZmFsc2Vcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2NyZWF0ZUltYWdlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlSW1hZ2UoKSB7XG5cdCAgICAgICAgICAgIHZhciBpbWFnZSA9IHRoaXMucHJvcHMuaXRlbS5pbWFnZTtcblx0XG5cdCAgICAgICAgICAgIGlmIChpbWFnZSAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIHNyYyA9IGltYWdlLnVybDtcblx0ICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGltYWdlLndpZHRoO1xuXHQgICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmhlaWdodDtcblx0XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX2NvbW1vbkltYWdlMlsnZGVmYXVsdCddLCB7IHNyYzogc3JjLFxuXHQgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcblx0ICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGhlaWdodCB9KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY3JlYXRlUGFuZWwnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVQYW5lbCgpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICBpZiAoIXRoaXMucHJvcHMuaXRlbS5pbWFnZSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9QYW5lbDJbJ2RlZmF1bHQnXSwgeyBhdXRob3I6IHRoaXMucHJvcHMuaXRlbS5hdXRob3IsIG1lc3NhZ2U6IHRoaXMucHJvcHMuaXRlbS5tZXNzYWdlIH0pO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICB2YXIgcGFuZWxXaWR0aCA9IDMwMDtcblx0XG5cdCAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB7XG5cdCAgICAgICAgICAgICAgICB4OiB0aGlzLnN0YXRlLnNob3VsZERpc3BsYXlQYW5lbCA/ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKSgwKSA6ICgwLCBfcmVhY3RNb3Rpb24uc3ByaW5nKShwYW5lbFdpZHRoKVxuXHQgICAgICAgICAgICB9O1xuXHRcblx0ICAgICAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZXMgPSB7XG5cdCAgICAgICAgICAgICAgICB4OiAwXG5cdCAgICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoXG5cdCAgICAgICAgICAgICAgICBfcmVhY3RNb3Rpb24uTW90aW9uLFxuXHQgICAgICAgICAgICAgICAgeyBkZWZhdWx0U3R5bGU6IGRlZmF1bHRWYWx1ZXMsXG5cdCAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHZhbHVlcyB9LFxuXHQgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGludGVycG9sYXRlZFZhbHVlcykge1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChfUGFuZWwyWydkZWZhdWx0J10sIHsgYXV0aG9yOiBfdGhpczIucHJvcHMuaXRlbS5hdXRob3IsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IF90aGlzMi5wcm9wcy5pdGVtLm1lc3NhZ2UsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7IG1hcmdpbkxlZnQ6ICctJyArIGludGVycG9sYXRlZFZhbHVlcy54ICsgJ3B4Jywgd2lkdGg6IHBhbmVsV2lkdGggfSB9KTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY3JlYXRlQ2xhc3NTdHJpbmcnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVDbGFzc1N0cmluZygpIHtcblx0XG5cdCAgICAgICAgICAgIHZhciBjbGFzc1N0cmluZyA9ICdjbGltYi1zbGlkZXNob3dfX3NsaWRlIGNsaW1iX190aWxlLS0nICsgdGhpcy5wcm9wcy5pdGVtLnNvdXJjZV90eXBlO1xuXHRcblx0ICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuaXRlbS5pbWFnZSkge1xuXHQgICAgICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYi1zbGlkZXNob3dfX3NsaWRlLS1oYXMtbWVkaWEgY2xpbWItc2xpZGVzaG93X19zbGlkZS0taGFzLWltYWdlJztcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGNsYXNzU3RyaW5nICs9ICcgY2xpbWItc2xpZGVzaG93X19zbGlkZS0taGFzLW5vLWltYWdlJztcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMuaXRlbS52aWRlb191cmwpIHtcblx0ICAgICAgICAgICAgICAgIGNsYXNzU3RyaW5nICs9ICcgY2xpbWItc2xpZGVzaG93X19zbGlkZS0taGFzLW1lZGlhIGNsaW1iLXNsaWRlc2hvd19fc2xpZGUtLWhhcy12aWRlbyc7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBjbGFzc1N0cmluZyArPSAnIGNsaW1iLXNsaWRlc2hvd19fc2xpZGUtLWhhcy1uby12aWRlbyc7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiBjbGFzc1N0cmluZztcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVuZGVyJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVuZGVyKCkge1xuXHQgICAgICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmNyZWF0ZUltYWdlKCk7XG5cdCAgICAgICAgICAgIHZhciBwYW5lbCA9IHRoaXMuY3JlYXRlUGFuZWwoKTtcblx0ICAgICAgICAgICAgdmFyIGNsYXNzU3RyaW5nID0gdGhpcy5jcmVhdGVDbGFzc1N0cmluZygpO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KFxuXHQgICAgICAgICAgICAgICAgJ2RpdicsXG5cdCAgICAgICAgICAgICAgICB7IGNsYXNzTmFtZTogY2xhc3NTdHJpbmcsXG5cdCAgICAgICAgICAgICAgICAgICAgc3R5bGU6IHRoaXMucHJvcHMuc3R5bGUgfSxcblx0ICAgICAgICAgICAgICAgIGltYWdlLFxuXHQgICAgICAgICAgICAgICAgcGFuZWxcblx0ICAgICAgICAgICAgKTtcblx0ICAgICAgICB9XG5cdCAgICB9XSwgW3tcblx0ICAgICAgICBrZXk6ICdwcm9wVHlwZXMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIGl0ZW06IF9yZWFjdC5Qcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG5cdCAgICAgICAgICAgIGlzQ3VycmVudDogX3JlYWN0LlByb3BUeXBlcy5ib29sXG5cdCAgICAgICAgfSxcblx0ICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnZGVmYXVsdFByb3BzJyxcblx0ICAgICAgICB2YWx1ZToge1xuXHQgICAgICAgICAgICBpc0N1cnJlbnQ6IGZhbHNlXG5cdCAgICAgICAgfSxcblx0ICAgICAgICBlbnVtZXJhYmxlOiB0cnVlXG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIFNsaWRlO1xuXHR9KShfcmVhY3QuQ29tcG9uZW50KTtcblx0XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IFNsaWRlO1xuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDE2ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cdFxuXHR2YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgZGVzYyA9IHBhcmVudCA9IGdldHRlciA9IHVuZGVmaW5lZDsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmICgndmFsdWUnIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICdmdW5jdGlvbicgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICcgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cdFxuXHR2YXIgX3JlYWN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXHRcblx0dmFyIENsaW1iQmFkZ2UgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhDbGltYkJhZGdlLCBfQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBDbGltYkJhZGdlKCkge1xuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDbGltYkJhZGdlKTtcblx0XG5cdCAgICAgICAgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoQ2xpbWJCYWRnZS5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhDbGltYkJhZGdlLCBbe1xuXHQgICAgICAgIGtleTogJ3JlbmRlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0XG5cdCAgICAgICAgICAgIHZhciBsb2dvID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNyk7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoJ2EnLCB7IGhyZWY6ICdodHRwOi8vY2xpbWIuc29jaWFsLycsXG5cdCAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdjbGltYi1zb2NpYWwtYmFkZ2UnLFxuXHQgICAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHsgX19odG1sOiBsb2dvIH0gfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBDbGltYkJhZGdlO1xuXHR9KShfcmVhY3QuQ29tcG9uZW50KTtcblx0XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IENsaW1iQmFkZ2U7XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogMTcgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblx0XG5cdHZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KF94LCBfeDIsIF94MykgeyB2YXIgX2FnYWluID0gdHJ1ZTsgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7IHZhciBvYmplY3QgPSBfeCwgcHJvcGVydHkgPSBfeDIsIHJlY2VpdmVyID0gX3gzOyBkZXNjID0gcGFyZW50ID0gZ2V0dGVyID0gdW5kZWZpbmVkOyBfYWdhaW4gPSBmYWxzZTsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IF94ID0gcGFyZW50OyBfeDIgPSBwcm9wZXJ0eTsgX3gzID0gcmVjZWl2ZXI7IF9hZ2FpbiA9IHRydWU7IGNvbnRpbnVlIF9mdW5jdGlvbjsgfSB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH0gfTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblx0XG5cdHZhciBfcmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cdFxuXHR2YXIgX2NsaW1iU29jaWFsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0XG5cdHZhciBfY2xpbWJTb2NpYWwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY2xpbWJTb2NpYWwpO1xuXHRcblx0dmFyIF9XYWxsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblx0XG5cdHZhciBfV2FsbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9XYWxsKTtcblx0XG5cdHZhciBfQ2xpbWJCYWRnZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTYpO1xuXHRcblx0dmFyIF9DbGltYkJhZGdlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0NsaW1iQmFkZ2UpO1xuXHRcblx0dmFyIFdhbGxDb250YWluZXIgPSAoZnVuY3Rpb24gKF9Db21wb25lbnQpIHtcblx0ICAgIF9pbmhlcml0cyhXYWxsQ29udGFpbmVyLCBfQ29tcG9uZW50KTtcblx0XG5cdCAgICBmdW5jdGlvbiBXYWxsQ29udGFpbmVyKHByb3BzKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFdhbGxDb250YWluZXIpO1xuXHRcblx0ICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihXYWxsQ29udGFpbmVyLnByb3RvdHlwZSksICdjb25zdHJ1Y3RvcicsIHRoaXMpLmNhbGwodGhpcywgcHJvcHMpO1xuXHQgICAgICAgIHRoaXMuc3RhdGUgPSB7XG5cdCAgICAgICAgICAgIGl0ZW1zOiB7fVxuXHQgICAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFdhbGxDb250YWluZXIsIFt7XG5cdCAgICAgICAga2V5OiAnaW5pdCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICBpZiAoIXRoaXMucHJvcHMuY29sbGVjdGlvbklkKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIF9jbGltYlNvY2lhbDJbJ2RlZmF1bHQnXS5nZXRTdHJlYW0odGhpcy5wcm9wcy5jb2xsZWN0aW9uSWQpLnN1YnNjcmliZShmdW5jdGlvbiAoaXRlbXMpIHtcblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgbWF4U2l6ZSA9IHBhcnNlSW50KF90aGlzLnByb3BzLmxpbWl0LCAwKTtcblx0XG5cdCAgICAgICAgICAgICAgICB2YXIgbWFwcGVkSXRlbXMgPSB7fTtcblx0ICAgICAgICAgICAgICAgIGl0ZW1zLnNwbGljZSgwLCBtYXhTaXplKS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgICAgICAgICAgICAgICAgICBtYXBwZWRJdGVtc1tpdGVtLmlkXSA9IGl0ZW07XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7XG5cdCAgICAgICAgICAgICAgICAgICAgaXRlbXM6IG1hcHBlZEl0ZW1zXG5cdCAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2NvbXBvbmVudERpZE1vdW50Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG5cdCAgICAgICAgICAgIHRoaXMuaW5pdCgpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdjb21wb25lbnREaWRVcGRhdGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wb25lbnREaWRVcGRhdGUoKSB7XG5cdCAgICAgICAgICAgIHZhciBjYiA9IHVuZGVmaW5lZDtcblx0ICAgICAgICAgICAgaWYgKHdpbmRvdy5DbGltYiAmJiB3aW5kb3cuQ2xpbWIub25VcGRhdGUpIHtcblx0ICAgICAgICAgICAgICAgIGNiID0gd2luZG93LkNsaW1iLm9uVXBkYXRlO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgLy8gbm9vcFxuXHQgICAgICAgICAgICAgICAgY2IgPSBmdW5jdGlvbiAoKSB7fTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBjYigpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW5kZXInLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBfcmVhY3QyWydkZWZhdWx0J10uY3JlYXRlRWxlbWVudChcblx0ICAgICAgICAgICAgICAgICdkaXYnLFxuXHQgICAgICAgICAgICAgICAgbnVsbCxcblx0ICAgICAgICAgICAgICAgIF9yZWFjdDJbJ2RlZmF1bHQnXS5jcmVhdGVFbGVtZW50KF9XYWxsMlsnZGVmYXVsdCddLCB7IGl0ZW1zOiB0aGlzLnN0YXRlLml0ZW1zIH0pLFxuXHQgICAgICAgICAgICAgICAgX3JlYWN0MlsnZGVmYXVsdCddLmNyZWF0ZUVsZW1lbnQoX0NsaW1iQmFkZ2UyWydkZWZhdWx0J10sIG51bGwpXG5cdCAgICAgICAgICAgICk7XG5cdCAgICAgICAgfVxuXHQgICAgfV0sIFt7XG5cdCAgICAgICAga2V5OiAncHJvcFR5cGVzJyxcblx0ICAgICAgICB2YWx1ZToge1xuXHQgICAgICAgICAgICBjb2xsZWN0aW9uSWQ6IF9yZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG5cdCAgICAgICAgICAgIGxpbWl0OiBfcmVhY3QuUHJvcFR5cGVzLm9uZU9mVHlwZShbX3JlYWN0LlByb3BUeXBlcy5udW1iZXIsIF9yZWFjdC5Qcm9wVHlwZXMuc3RyaW5nXSlcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGVudW1lcmFibGU6IHRydWVcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdkZWZhdWx0UHJvcHMnLFxuXHQgICAgICAgIHZhbHVlOiB7XG5cdCAgICAgICAgICAgIGNvbGxlY3Rpb25JZDogJzU2MWJhNjM0NDUyODRlMTc0MGUwMTZmNycsXG5cdCAgICAgICAgICAgIGxpbWl0OiAzMFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBXYWxsQ29udGFpbmVyO1xuXHR9KShfcmVhY3QuQ29tcG9uZW50KTtcblx0XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IFdhbGxDb250YWluZXI7XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogMTggKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdHZhciBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsvKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24obW9kdWxlLCBnbG9iYWwsIHByb2Nlc3MpIHsvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCwgQWxsIHJpZ2h0cyByZXNlcnZlZC4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG5cdFxuXHQ7KGZ1bmN0aW9uICh1bmRlZmluZWQpIHtcblx0XG5cdCAgdmFyIG9iamVjdFR5cGVzID0ge1xuXHQgICAgJ2Z1bmN0aW9uJzogdHJ1ZSxcblx0ICAgICdvYmplY3QnOiB0cnVlXG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gY2hlY2tHbG9iYWwodmFsdWUpIHtcblx0ICAgIHJldHVybiAodmFsdWUgJiYgdmFsdWUuT2JqZWN0ID09PSBPYmplY3QpID8gdmFsdWUgOiBudWxsO1xuXHQgIH1cblx0XG5cdCAgdmFyIGZyZWVFeHBvcnRzID0gKG9iamVjdFR5cGVzW3R5cGVvZiBleHBvcnRzXSAmJiBleHBvcnRzICYmICFleHBvcnRzLm5vZGVUeXBlKSA/IGV4cG9ydHMgOiBudWxsO1xuXHQgIHZhciBmcmVlTW9kdWxlID0gKG9iamVjdFR5cGVzW3R5cGVvZiBtb2R1bGVdICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlKSA/IG1vZHVsZSA6IG51bGw7XG5cdCAgdmFyIGZyZWVHbG9iYWwgPSBjaGVja0dsb2JhbChmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlICYmIHR5cGVvZiBnbG9iYWwgPT09ICdvYmplY3QnICYmIGdsb2JhbCk7XG5cdCAgdmFyIGZyZWVTZWxmID0gY2hlY2tHbG9iYWwob2JqZWN0VHlwZXNbdHlwZW9mIHNlbGZdICYmIHNlbGYpO1xuXHQgIHZhciBmcmVlV2luZG93ID0gY2hlY2tHbG9iYWwob2JqZWN0VHlwZXNbdHlwZW9mIHdpbmRvd10gJiYgd2luZG93KTtcblx0ICB2YXIgbW9kdWxlRXhwb3J0cyA9IChmcmVlTW9kdWxlICYmIGZyZWVNb2R1bGUuZXhwb3J0cyA9PT0gZnJlZUV4cG9ydHMpID8gZnJlZUV4cG9ydHMgOiBudWxsO1xuXHQgIHZhciB0aGlzR2xvYmFsID0gY2hlY2tHbG9iYWwob2JqZWN0VHlwZXNbdHlwZW9mIHRoaXNdICYmIHRoaXMpO1xuXHQgIHZhciByb290ID0gZnJlZUdsb2JhbCB8fCAoKGZyZWVXaW5kb3cgIT09ICh0aGlzR2xvYmFsICYmIHRoaXNHbG9iYWwud2luZG93KSkgJiYgZnJlZVdpbmRvdykgfHwgZnJlZVNlbGYgfHwgdGhpc0dsb2JhbCB8fCBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHRcblx0ICB2YXIgUnggPSB7XG5cdCAgICBpbnRlcm5hbHM6IHt9LFxuXHQgICAgY29uZmlnOiB7XG5cdCAgICAgIFByb21pc2U6IHJvb3QuUHJvbWlzZVxuXHQgICAgfSxcblx0ICAgIGhlbHBlcnM6IHsgfVxuXHQgIH07XG5cdFxuXHQgIC8vIERlZmF1bHRzXG5cdCAgdmFyIG5vb3AgPSBSeC5oZWxwZXJzLm5vb3AgPSBmdW5jdGlvbiAoKSB7IH0sXG5cdCAgICBpZGVudGl0eSA9IFJ4LmhlbHBlcnMuaWRlbnRpdHkgPSBmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSxcblx0ICAgIGRlZmF1bHROb3cgPSBSeC5oZWxwZXJzLmRlZmF1bHROb3cgPSBEYXRlLm5vdyxcblx0ICAgIGRlZmF1bHRDb21wYXJlciA9IFJ4LmhlbHBlcnMuZGVmYXVsdENvbXBhcmVyID0gZnVuY3Rpb24gKHgsIHkpIHsgcmV0dXJuIGlzRXF1YWwoeCwgeSk7IH0sXG5cdCAgICBkZWZhdWx0U3ViQ29tcGFyZXIgPSBSeC5oZWxwZXJzLmRlZmF1bHRTdWJDb21wYXJlciA9IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ID4geSA/IDEgOiAoeCA8IHkgPyAtMSA6IDApOyB9LFxuXHQgICAgZGVmYXVsdEtleVNlcmlhbGl6ZXIgPSBSeC5oZWxwZXJzLmRlZmF1bHRLZXlTZXJpYWxpemVyID0gZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgudG9TdHJpbmcoKTsgfSxcblx0ICAgIGRlZmF1bHRFcnJvciA9IFJ4LmhlbHBlcnMuZGVmYXVsdEVycm9yID0gZnVuY3Rpb24gKGVycikgeyB0aHJvdyBlcnI7IH0sXG5cdCAgICBpc1Byb21pc2UgPSBSeC5oZWxwZXJzLmlzUHJvbWlzZSA9IGZ1bmN0aW9uIChwKSB7IHJldHVybiAhIXAgJiYgdHlwZW9mIHAuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBwLnRoZW4gPT09ICdmdW5jdGlvbic7IH0sXG5cdCAgICBpc0Z1bmN0aW9uID0gUnguaGVscGVycy5pc0Z1bmN0aW9uID0gKGZ1bmN0aW9uICgpIHtcblx0XG5cdCAgICAgIHZhciBpc0ZuID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnZnVuY3Rpb24nIHx8IGZhbHNlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICAvLyBmYWxsYmFjayBmb3Igb2xkZXIgdmVyc2lvbnMgb2YgQ2hyb21lIGFuZCBTYWZhcmlcblx0ICAgICAgaWYgKGlzRm4oL3gvKSkge1xuXHQgICAgICAgIGlzRm4gPSBmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnZnVuY3Rpb24nICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG5cdCAgICAgICAgfTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIGlzRm47XG5cdCAgICB9KCkpO1xuXHRcblx0ICAgIGZ1bmN0aW9uIGNsb25lQXJyYXkoYXJyKSB7XG5cdCAgICAgIHZhciBsZW4gPSBhcnIubGVuZ3RoLCBhID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhW2ldID0gYXJyW2ldOyB9XG5cdCAgICAgIHJldHVybiBhO1xuXHQgICAgfVxuXHRcblx0ICB2YXIgZXJyb3JPYmogPSB7ZToge319O1xuXHQgIFxuXHQgIGZ1bmN0aW9uIHRyeUNhdGNoZXJHZW4odHJ5Q2F0Y2hUYXJnZXQpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbiB0cnlDYXRjaGVyKCkge1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIHJldHVybiB0cnlDYXRjaFRhcmdldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgZXJyb3JPYmouZSA9IGU7XG5cdCAgICAgICAgcmV0dXJuIGVycm9yT2JqO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgdmFyIHRyeUNhdGNoID0gUnguaW50ZXJuYWxzLnRyeUNhdGNoID0gZnVuY3Rpb24gdHJ5Q2F0Y2goZm4pIHtcblx0ICAgIGlmICghaXNGdW5jdGlvbihmbikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignZm4gbXVzdCBiZSBhIGZ1bmN0aW9uJyk7IH1cblx0ICAgIHJldHVybiB0cnlDYXRjaGVyR2VuKGZuKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiB0aHJvd2VyKGUpIHtcblx0ICAgIHRocm93IGU7XG5cdCAgfVxuXHRcblx0ICBSeC5jb25maWcubG9uZ1N0YWNrU3VwcG9ydCA9IGZhbHNlO1xuXHQgIHZhciBoYXNTdGFja3MgPSBmYWxzZSwgc3RhY2tzID0gdHJ5Q2F0Y2goZnVuY3Rpb24gKCkgeyB0aHJvdyBuZXcgRXJyb3IoKTsgfSkoKTtcblx0ICBoYXNTdGFja3MgPSAhIXN0YWNrcy5lICYmICEhc3RhY2tzLmUuc3RhY2s7XG5cdFxuXHQgIC8vIEFsbCBjb2RlIGFmdGVyIHRoaXMgcG9pbnQgd2lsbCBiZSBmaWx0ZXJlZCBmcm9tIHN0YWNrIHRyYWNlcyByZXBvcnRlZCBieSBSeEpTXG5cdCAgdmFyIHJTdGFydGluZ0xpbmUgPSBjYXB0dXJlTGluZSgpLCByRmlsZU5hbWU7XG5cdFxuXHQgIHZhciBTVEFDS19KVU1QX1NFUEFSQVRPUiA9ICdGcm9tIHByZXZpb3VzIGV2ZW50Oic7XG5cdFxuXHQgIGZ1bmN0aW9uIG1ha2VTdGFja1RyYWNlTG9uZyhlcnJvciwgb2JzZXJ2YWJsZSkge1xuXHQgICAgLy8gSWYgcG9zc2libGUsIHRyYW5zZm9ybSB0aGUgZXJyb3Igc3RhY2sgdHJhY2UgYnkgcmVtb3ZpbmcgTm9kZSBhbmQgUnhKU1xuXHQgICAgLy8gY3J1ZnQsIHRoZW4gY29uY2F0ZW5hdGluZyB3aXRoIHRoZSBzdGFjayB0cmFjZSBvZiBgb2JzZXJ2YWJsZWAuXG5cdCAgICBpZiAoaGFzU3RhY2tzICYmXG5cdCAgICAgICAgb2JzZXJ2YWJsZS5zdGFjayAmJlxuXHQgICAgICAgIHR5cGVvZiBlcnJvciA9PT0gJ29iamVjdCcgJiZcblx0ICAgICAgICBlcnJvciAhPT0gbnVsbCAmJlxuXHQgICAgICAgIGVycm9yLnN0YWNrICYmXG5cdCAgICAgICAgZXJyb3Iuc3RhY2suaW5kZXhPZihTVEFDS19KVU1QX1NFUEFSQVRPUikgPT09IC0xXG5cdCAgICApIHtcblx0ICAgICAgdmFyIHN0YWNrcyA9IFtdO1xuXHQgICAgICBmb3IgKHZhciBvID0gb2JzZXJ2YWJsZTsgISFvOyBvID0gby5zb3VyY2UpIHtcblx0ICAgICAgICBpZiAoby5zdGFjaykge1xuXHQgICAgICAgICAgc3RhY2tzLnVuc2hpZnQoby5zdGFjayk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICAgIHN0YWNrcy51bnNoaWZ0KGVycm9yLnN0YWNrKTtcblx0XG5cdCAgICAgIHZhciBjb25jYXRlZFN0YWNrcyA9IHN0YWNrcy5qb2luKCdcXG4nICsgU1RBQ0tfSlVNUF9TRVBBUkFUT1IgKyAnXFxuJyk7XG5cdCAgICAgIGVycm9yLnN0YWNrID0gZmlsdGVyU3RhY2tTdHJpbmcoY29uY2F0ZWRTdGFja3MpO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gZmlsdGVyU3RhY2tTdHJpbmcoc3RhY2tTdHJpbmcpIHtcblx0ICAgIHZhciBsaW5lcyA9IHN0YWNrU3RyaW5nLnNwbGl0KCdcXG4nKSwgZGVzaXJlZExpbmVzID0gW107XG5cdCAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbGluZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgdmFyIGxpbmUgPSBsaW5lc1tpXTtcblx0XG5cdCAgICAgIGlmICghaXNJbnRlcm5hbEZyYW1lKGxpbmUpICYmICFpc05vZGVGcmFtZShsaW5lKSAmJiBsaW5lKSB7XG5cdCAgICAgICAgZGVzaXJlZExpbmVzLnB1c2gobGluZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiBkZXNpcmVkTGluZXMuam9pbignXFxuJyk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBpc0ludGVybmFsRnJhbWUoc3RhY2tMaW5lKSB7XG5cdCAgICB2YXIgZmlsZU5hbWVBbmRMaW5lTnVtYmVyID0gZ2V0RmlsZU5hbWVBbmRMaW5lTnVtYmVyKHN0YWNrTGluZSk7XG5cdCAgICBpZiAoIWZpbGVOYW1lQW5kTGluZU51bWJlcikge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdCAgICB2YXIgZmlsZU5hbWUgPSBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMF0sIGxpbmVOdW1iZXIgPSBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMV07XG5cdFxuXHQgICAgcmV0dXJuIGZpbGVOYW1lID09PSByRmlsZU5hbWUgJiZcblx0ICAgICAgbGluZU51bWJlciA+PSByU3RhcnRpbmdMaW5lICYmXG5cdCAgICAgIGxpbmVOdW1iZXIgPD0gckVuZGluZ0xpbmU7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBpc05vZGVGcmFtZShzdGFja0xpbmUpIHtcblx0ICAgIHJldHVybiBzdGFja0xpbmUuaW5kZXhPZignKG1vZHVsZS5qczonKSAhPT0gLTEgfHxcblx0ICAgICAgc3RhY2tMaW5lLmluZGV4T2YoJyhub2RlLmpzOicpICE9PSAtMTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGNhcHR1cmVMaW5lKCkge1xuXHQgICAgaWYgKCFoYXNTdGFja3MpIHsgcmV0dXJuOyB9XG5cdFxuXHQgICAgdHJ5IHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG5cdCAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgIHZhciBsaW5lcyA9IGUuc3RhY2suc3BsaXQoJ1xcbicpO1xuXHQgICAgICB2YXIgZmlyc3RMaW5lID0gbGluZXNbMF0uaW5kZXhPZignQCcpID4gMCA/IGxpbmVzWzFdIDogbGluZXNbMl07XG5cdCAgICAgIHZhciBmaWxlTmFtZUFuZExpbmVOdW1iZXIgPSBnZXRGaWxlTmFtZUFuZExpbmVOdW1iZXIoZmlyc3RMaW5lKTtcblx0ICAgICAgaWYgKCFmaWxlTmFtZUFuZExpbmVOdW1iZXIpIHsgcmV0dXJuOyB9XG5cdFxuXHQgICAgICByRmlsZU5hbWUgPSBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMF07XG5cdCAgICAgIHJldHVybiBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMV07XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBnZXRGaWxlTmFtZUFuZExpbmVOdW1iZXIoc3RhY2tMaW5lKSB7XG5cdCAgICAvLyBOYW1lZCBmdW5jdGlvbnM6ICdhdCBmdW5jdGlvbk5hbWUgKGZpbGVuYW1lOmxpbmVOdW1iZXI6Y29sdW1uTnVtYmVyKSdcblx0ICAgIHZhciBhdHRlbXB0MSA9IC9hdCAuKyBcXCgoLispOihcXGQrKTooPzpcXGQrKVxcKSQvLmV4ZWMoc3RhY2tMaW5lKTtcblx0ICAgIGlmIChhdHRlbXB0MSkgeyByZXR1cm4gW2F0dGVtcHQxWzFdLCBOdW1iZXIoYXR0ZW1wdDFbMl0pXTsgfVxuXHRcblx0ICAgIC8vIEFub255bW91cyBmdW5jdGlvbnM6ICdhdCBmaWxlbmFtZTpsaW5lTnVtYmVyOmNvbHVtbk51bWJlcidcblx0ICAgIHZhciBhdHRlbXB0MiA9IC9hdCAoW14gXSspOihcXGQrKTooPzpcXGQrKSQvLmV4ZWMoc3RhY2tMaW5lKTtcblx0ICAgIGlmIChhdHRlbXB0MikgeyByZXR1cm4gW2F0dGVtcHQyWzFdLCBOdW1iZXIoYXR0ZW1wdDJbMl0pXTsgfVxuXHRcblx0ICAgIC8vIEZpcmVmb3ggc3R5bGU6ICdmdW5jdGlvbkBmaWxlbmFtZTpsaW5lTnVtYmVyIG9yIEBmaWxlbmFtZTpsaW5lTnVtYmVyJ1xuXHQgICAgdmFyIGF0dGVtcHQzID0gLy4qQCguKyk6KFxcZCspJC8uZXhlYyhzdGFja0xpbmUpO1xuXHQgICAgaWYgKGF0dGVtcHQzKSB7IHJldHVybiBbYXR0ZW1wdDNbMV0sIE51bWJlcihhdHRlbXB0M1syXSldOyB9XG5cdCAgfVxuXHRcblx0ICB2YXIgRW1wdHlFcnJvciA9IFJ4LkVtcHR5RXJyb3IgPSBmdW5jdGlvbigpIHtcblx0ICAgIHRoaXMubWVzc2FnZSA9ICdTZXF1ZW5jZSBjb250YWlucyBubyBlbGVtZW50cy4nO1xuXHQgICAgRXJyb3IuY2FsbCh0aGlzKTtcblx0ICB9O1xuXHQgIEVtcHR5RXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuXHQgIEVtcHR5RXJyb3IucHJvdG90eXBlLm5hbWUgPSAnRW1wdHlFcnJvcic7XG5cdFxuXHQgIHZhciBPYmplY3REaXNwb3NlZEVycm9yID0gUnguT2JqZWN0RGlzcG9zZWRFcnJvciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgdGhpcy5tZXNzYWdlID0gJ09iamVjdCBoYXMgYmVlbiBkaXNwb3NlZCc7XG5cdCAgICBFcnJvci5jYWxsKHRoaXMpO1xuXHQgIH07XG5cdCAgT2JqZWN0RGlzcG9zZWRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cdCAgT2JqZWN0RGlzcG9zZWRFcnJvci5wcm90b3R5cGUubmFtZSA9ICdPYmplY3REaXNwb3NlZEVycm9yJztcblx0XG5cdCAgdmFyIEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yID0gUnguQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0aGlzLm1lc3NhZ2UgPSAnQXJndW1lbnQgb3V0IG9mIHJhbmdlJztcblx0ICAgIEVycm9yLmNhbGwodGhpcyk7XG5cdCAgfTtcblx0ICBBcmd1bWVudE91dE9mUmFuZ2VFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cdCAgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnQXJndW1lbnRPdXRPZlJhbmdlRXJyb3InO1xuXHRcblx0ICB2YXIgTm90U3VwcG9ydGVkRXJyb3IgPSBSeC5Ob3RTdXBwb3J0ZWRFcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG5cdCAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlIHx8ICdUaGlzIG9wZXJhdGlvbiBpcyBub3Qgc3VwcG9ydGVkJztcblx0ICAgIEVycm9yLmNhbGwodGhpcyk7XG5cdCAgfTtcblx0ICBOb3RTdXBwb3J0ZWRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cdCAgTm90U3VwcG9ydGVkRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnTm90U3VwcG9ydGVkRXJyb3InO1xuXHRcblx0ICB2YXIgTm90SW1wbGVtZW50ZWRFcnJvciA9IFJ4Lk5vdEltcGxlbWVudGVkRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuXHQgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVGhpcyBvcGVyYXRpb24gaXMgbm90IGltcGxlbWVudGVkJztcblx0ICAgIEVycm9yLmNhbGwodGhpcyk7XG5cdCAgfTtcblx0ICBOb3RJbXBsZW1lbnRlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblx0ICBOb3RJbXBsZW1lbnRlZEVycm9yLnByb3RvdHlwZS5uYW1lID0gJ05vdEltcGxlbWVudGVkRXJyb3InO1xuXHRcblx0ICB2YXIgbm90SW1wbGVtZW50ZWQgPSBSeC5oZWxwZXJzLm5vdEltcGxlbWVudGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXJyb3IoKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgbm90U3VwcG9ydGVkID0gUnguaGVscGVycy5ub3RTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0aHJvdyBuZXcgTm90U3VwcG9ydGVkRXJyb3IoKTtcblx0ICB9O1xuXHRcblx0ICAvLyBTaGltIGluIGl0ZXJhdG9yIHN1cHBvcnRcblx0ICB2YXIgJGl0ZXJhdG9yJCA9ICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIFN5bWJvbC5pdGVyYXRvcikgfHxcblx0ICAgICdfZXM2c2hpbV9pdGVyYXRvcl8nO1xuXHQgIC8vIEJ1ZyBmb3IgbW96aWxsYSB2ZXJzaW9uXG5cdCAgaWYgKHJvb3QuU2V0ICYmIHR5cGVvZiBuZXcgcm9vdC5TZXQoKVsnQEBpdGVyYXRvciddID09PSAnZnVuY3Rpb24nKSB7XG5cdCAgICAkaXRlcmF0b3IkID0gJ0BAaXRlcmF0b3InO1xuXHQgIH1cblx0XG5cdCAgdmFyIGRvbmVFbnVtZXJhdG9yID0gUnguZG9uZUVudW1lcmF0b3IgPSB7IGRvbmU6IHRydWUsIHZhbHVlOiB1bmRlZmluZWQgfTtcblx0XG5cdCAgdmFyIGlzSXRlcmFibGUgPSBSeC5oZWxwZXJzLmlzSXRlcmFibGUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgcmV0dXJuIG8gJiYgb1skaXRlcmF0b3IkXSAhPT0gdW5kZWZpbmVkO1xuXHQgIH07XG5cdFxuXHQgIHZhciBpc0FycmF5TGlrZSA9IFJ4LmhlbHBlcnMuaXNBcnJheUxpa2UgPSBmdW5jdGlvbiAobykge1xuXHQgICAgcmV0dXJuIG8gJiYgby5sZW5ndGggIT09IHVuZGVmaW5lZDtcblx0ICB9O1xuXHRcblx0ICBSeC5oZWxwZXJzLml0ZXJhdG9yID0gJGl0ZXJhdG9yJDtcblx0XG5cdCAgdmFyIGJpbmRDYWxsYmFjayA9IFJ4LmludGVybmFscy5iaW5kQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZnVuYywgdGhpc0FyZywgYXJnQ291bnQpIHtcblx0ICAgIGlmICh0eXBlb2YgdGhpc0FyZyA9PT0gJ3VuZGVmaW5lZCcpIHsgcmV0dXJuIGZ1bmM7IH1cblx0ICAgIHN3aXRjaChhcmdDb3VudCkge1xuXHQgICAgICBjYXNlIDA6XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnKVxuXHQgICAgICAgIH07XG5cdCAgICAgIGNhc2UgMTpcblx0ICAgICAgICByZXR1cm4gZnVuY3Rpb24oYXJnKSB7XG5cdCAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIGFyZyk7XG5cdCAgICAgICAgfVxuXHQgICAgICBjYXNlIDI6XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCkge1xuXHQgICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCB2YWx1ZSwgaW5kZXgpO1xuXHQgICAgICAgIH07XG5cdCAgICAgIGNhc2UgMzpcblx0ICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7XG5cdCAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7XG5cdCAgICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXNBcmcsIGFyZ3VtZW50cyk7XG5cdCAgICB9O1xuXHQgIH07XG5cdFxuXHQgIC8qKiBVc2VkIHRvIGRldGVybWluZSBpZiB2YWx1ZXMgYXJlIG9mIHRoZSBsYW5ndWFnZSB0eXBlIE9iamVjdCAqL1xuXHQgIHZhciBkb250RW51bXMgPSBbJ3RvU3RyaW5nJyxcblx0ICAgICd0b0xvY2FsZVN0cmluZycsXG5cdCAgICAndmFsdWVPZicsXG5cdCAgICAnaGFzT3duUHJvcGVydHknLFxuXHQgICAgJ2lzUHJvdG90eXBlT2YnLFxuXHQgICAgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJyxcblx0ICAgICdjb25zdHJ1Y3RvciddLFxuXHQgIGRvbnRFbnVtc0xlbmd0aCA9IGRvbnRFbnVtcy5sZW5ndGg7XG5cdFxuXHQgIC8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgc2hvcnRjdXRzICovXG5cdCAgdmFyIGFyZ3NDbGFzcyA9ICdbb2JqZWN0IEFyZ3VtZW50c10nLFxuXHQgICAgYXJyYXlDbGFzcyA9ICdbb2JqZWN0IEFycmF5XScsXG5cdCAgICBib29sQ2xhc3MgPSAnW29iamVjdCBCb29sZWFuXScsXG5cdCAgICBkYXRlQ2xhc3MgPSAnW29iamVjdCBEYXRlXScsXG5cdCAgICBlcnJvckNsYXNzID0gJ1tvYmplY3QgRXJyb3JdJyxcblx0ICAgIGZ1bmNDbGFzcyA9ICdbb2JqZWN0IEZ1bmN0aW9uXScsXG5cdCAgICBudW1iZXJDbGFzcyA9ICdbb2JqZWN0IE51bWJlcl0nLFxuXHQgICAgb2JqZWN0Q2xhc3MgPSAnW29iamVjdCBPYmplY3RdJyxcblx0ICAgIHJlZ2V4cENsYXNzID0gJ1tvYmplY3QgUmVnRXhwXScsXG5cdCAgICBzdHJpbmdDbGFzcyA9ICdbb2JqZWN0IFN0cmluZ10nO1xuXHRcblx0ICB2YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLFxuXHQgICAgaGFzT3duUHJvcGVydHkgPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LFxuXHQgICAgc3VwcG9ydHNBcmdzQ2xhc3MgPSB0b1N0cmluZy5jYWxsKGFyZ3VtZW50cykgPT0gYXJnc0NsYXNzLCAvLyBGb3IgbGVzcyA8SUU5ICYmIEZGPDRcblx0ICAgIHN1cHBvcnROb2RlQ2xhc3MsXG5cdCAgICBlcnJvclByb3RvID0gRXJyb3IucHJvdG90eXBlLFxuXHQgICAgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlLFxuXHQgICAgc3RyaW5nUHJvdG8gPSBTdHJpbmcucHJvdG90eXBlLFxuXHQgICAgcHJvcGVydHlJc0VudW1lcmFibGUgPSBvYmplY3RQcm90by5wcm9wZXJ0eUlzRW51bWVyYWJsZTtcblx0XG5cdCAgdHJ5IHtcblx0ICAgIHN1cHBvcnROb2RlQ2xhc3MgPSAhKHRvU3RyaW5nLmNhbGwoZG9jdW1lbnQpID09IG9iamVjdENsYXNzICYmICEoeyAndG9TdHJpbmcnOiAwIH0gKyAnJykpO1xuXHQgIH0gY2F0Y2ggKGUpIHtcblx0ICAgIHN1cHBvcnROb2RlQ2xhc3MgPSB0cnVlO1xuXHQgIH1cblx0XG5cdCAgdmFyIG5vbkVudW1Qcm9wcyA9IHt9O1xuXHQgIG5vbkVudW1Qcm9wc1thcnJheUNsYXNzXSA9IG5vbkVudW1Qcm9wc1tkYXRlQ2xhc3NdID0gbm9uRW51bVByb3BzW251bWJlckNsYXNzXSA9IHsgJ2NvbnN0cnVjdG9yJzogdHJ1ZSwgJ3RvTG9jYWxlU3RyaW5nJzogdHJ1ZSwgJ3RvU3RyaW5nJzogdHJ1ZSwgJ3ZhbHVlT2YnOiB0cnVlIH07XG5cdCAgbm9uRW51bVByb3BzW2Jvb2xDbGFzc10gPSBub25FbnVtUHJvcHNbc3RyaW5nQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlLCAndmFsdWVPZic6IHRydWUgfTtcblx0ICBub25FbnVtUHJvcHNbZXJyb3JDbGFzc10gPSBub25FbnVtUHJvcHNbZnVuY0NsYXNzXSA9IG5vbkVudW1Qcm9wc1tyZWdleHBDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUsICd0b1N0cmluZyc6IHRydWUgfTtcblx0ICBub25FbnVtUHJvcHNbb2JqZWN0Q2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlIH07XG5cdFxuXHQgIHZhciBzdXBwb3J0ID0ge307XG5cdCAgKGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBjdG9yID0gZnVuY3Rpb24oKSB7IHRoaXMueCA9IDE7IH0sXG5cdCAgICAgIHByb3BzID0gW107XG5cdFxuXHQgICAgY3Rvci5wcm90b3R5cGUgPSB7ICd2YWx1ZU9mJzogMSwgJ3knOiAxIH07XG5cdCAgICBmb3IgKHZhciBrZXkgaW4gbmV3IGN0b3IpIHsgcHJvcHMucHVzaChrZXkpOyB9XG5cdCAgICBmb3IgKGtleSBpbiBhcmd1bWVudHMpIHsgfVxuXHRcblx0ICAgIC8vIERldGVjdCBpZiBgbmFtZWAgb3IgYG1lc3NhZ2VgIHByb3BlcnRpZXMgb2YgYEVycm9yLnByb3RvdHlwZWAgYXJlIGVudW1lcmFibGUgYnkgZGVmYXVsdC5cblx0ICAgIHN1cHBvcnQuZW51bUVycm9yUHJvcHMgPSBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGVycm9yUHJvdG8sICdtZXNzYWdlJykgfHwgcHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlcnJvclByb3RvLCAnbmFtZScpO1xuXHRcblx0ICAgIC8vIERldGVjdCBpZiBgcHJvdG90eXBlYCBwcm9wZXJ0aWVzIGFyZSBlbnVtZXJhYmxlIGJ5IGRlZmF1bHQuXG5cdCAgICBzdXBwb3J0LmVudW1Qcm90b3R5cGVzID0gcHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChjdG9yLCAncHJvdG90eXBlJyk7XG5cdFxuXHQgICAgLy8gRGV0ZWN0IGlmIGBhcmd1bWVudHNgIG9iamVjdCBpbmRleGVzIGFyZSBub24tZW51bWVyYWJsZVxuXHQgICAgc3VwcG9ydC5ub25FbnVtQXJncyA9IGtleSAhPSAwO1xuXHRcblx0ICAgIC8vIERldGVjdCBpZiBwcm9wZXJ0aWVzIHNoYWRvd2luZyB0aG9zZSBvbiBgT2JqZWN0LnByb3RvdHlwZWAgYXJlIG5vbi1lbnVtZXJhYmxlLlxuXHQgICAgc3VwcG9ydC5ub25FbnVtU2hhZG93cyA9ICEvdmFsdWVPZi8udGVzdChwcm9wcyk7XG5cdCAgfSgxKSk7XG5cdFxuXHQgIHZhciBpc09iamVjdCA9IFJ4LmludGVybmFscy5pc09iamVjdCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICB2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcblx0ICAgIHJldHVybiB2YWx1ZSAmJiAodHlwZSA9PSAnZnVuY3Rpb24nIHx8IHR5cGUgPT0gJ29iamVjdCcpIHx8IGZhbHNlO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGtleXNJbihvYmplY3QpIHtcblx0ICAgIHZhciByZXN1bHQgPSBbXTtcblx0ICAgIGlmICghaXNPYmplY3Qob2JqZWN0KSkge1xuXHQgICAgICByZXR1cm4gcmVzdWx0O1xuXHQgICAgfVxuXHQgICAgaWYgKHN1cHBvcnQubm9uRW51bUFyZ3MgJiYgb2JqZWN0Lmxlbmd0aCAmJiBpc0FyZ3VtZW50cyhvYmplY3QpKSB7XG5cdCAgICAgIG9iamVjdCA9IHNsaWNlLmNhbGwob2JqZWN0KTtcblx0ICAgIH1cblx0ICAgIHZhciBza2lwUHJvdG8gPSBzdXBwb3J0LmVudW1Qcm90b3R5cGVzICYmIHR5cGVvZiBvYmplY3QgPT0gJ2Z1bmN0aW9uJyxcblx0ICAgICAgICBza2lwRXJyb3JQcm9wcyA9IHN1cHBvcnQuZW51bUVycm9yUHJvcHMgJiYgKG9iamVjdCA9PT0gZXJyb3JQcm90byB8fCBvYmplY3QgaW5zdGFuY2VvZiBFcnJvcik7XG5cdFxuXHQgICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkge1xuXHQgICAgICBpZiAoIShza2lwUHJvdG8gJiYga2V5ID09ICdwcm90b3R5cGUnKSAmJlxuXHQgICAgICAgICAgIShza2lwRXJyb3JQcm9wcyAmJiAoa2V5ID09ICdtZXNzYWdlJyB8fCBrZXkgPT0gJ25hbWUnKSkpIHtcblx0ICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKHN1cHBvcnQubm9uRW51bVNoYWRvd3MgJiYgb2JqZWN0ICE9PSBvYmplY3RQcm90bykge1xuXHQgICAgICB2YXIgY3RvciA9IG9iamVjdC5jb25zdHJ1Y3Rvcixcblx0ICAgICAgICAgIGluZGV4ID0gLTEsXG5cdCAgICAgICAgICBsZW5ndGggPSBkb250RW51bXNMZW5ndGg7XG5cdFxuXHQgICAgICBpZiAob2JqZWN0ID09PSAoY3RvciAmJiBjdG9yLnByb3RvdHlwZSkpIHtcblx0ICAgICAgICB2YXIgY2xhc3NOYW1lID0gb2JqZWN0ID09PSBzdHJpbmdQcm90byA/IHN0cmluZ0NsYXNzIDogb2JqZWN0ID09PSBlcnJvclByb3RvID8gZXJyb3JDbGFzcyA6IHRvU3RyaW5nLmNhbGwob2JqZWN0KSxcblx0ICAgICAgICAgICAgbm9uRW51bSA9IG5vbkVudW1Qcm9wc1tjbGFzc05hbWVdO1xuXHQgICAgICB9XG5cdCAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG5cdCAgICAgICAga2V5ID0gZG9udEVudW1zW2luZGV4XTtcblx0ICAgICAgICBpZiAoIShub25FbnVtICYmIG5vbkVudW1ba2V5XSkgJiYgaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkpIHtcblx0ICAgICAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gcmVzdWx0O1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gaW50ZXJuYWxGb3Iob2JqZWN0LCBjYWxsYmFjaywga2V5c0Z1bmMpIHtcblx0ICAgIHZhciBpbmRleCA9IC0xLFxuXHQgICAgICBwcm9wcyA9IGtleXNGdW5jKG9iamVjdCksXG5cdCAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aDtcblx0XG5cdCAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuXHQgICAgICB2YXIga2V5ID0gcHJvcHNbaW5kZXhdO1xuXHQgICAgICBpZiAoY2FsbGJhY2sob2JqZWN0W2tleV0sIGtleSwgb2JqZWN0KSA9PT0gZmFsc2UpIHtcblx0ICAgICAgICBicmVhaztcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIG9iamVjdDtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGludGVybmFsRm9ySW4ob2JqZWN0LCBjYWxsYmFjaykge1xuXHQgICAgcmV0dXJuIGludGVybmFsRm9yKG9iamVjdCwgY2FsbGJhY2ssIGtleXNJbik7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBpc05vZGUodmFsdWUpIHtcblx0ICAgIC8vIElFIDwgOSBwcmVzZW50cyBET00gbm9kZXMgYXMgYE9iamVjdGAgb2JqZWN0cyBleGNlcHQgdGhleSBoYXZlIGB0b1N0cmluZ2Bcblx0ICAgIC8vIG1ldGhvZHMgdGhhdCBhcmUgYHR5cGVvZmAgXCJzdHJpbmdcIiBhbmQgc3RpbGwgY2FuIGNvZXJjZSBub2RlcyB0byBzdHJpbmdzXG5cdCAgICByZXR1cm4gdHlwZW9mIHZhbHVlLnRvU3RyaW5nICE9ICdmdW5jdGlvbicgJiYgdHlwZW9mICh2YWx1ZSArICcnKSA9PSAnc3RyaW5nJztcblx0ICB9XG5cdFxuXHQgIHZhciBpc0FyZ3VtZW50cyA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdCAgICByZXR1cm4gKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JykgPyB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PSBhcmdzQ2xhc3MgOiBmYWxzZTtcblx0ICB9XG5cdFxuXHQgIC8vIGZhbGxiYWNrIGZvciBicm93c2VycyB0aGF0IGNhbid0IGRldGVjdCBgYXJndW1lbnRzYCBvYmplY3RzIGJ5IFtbQ2xhc3NdXVxuXHQgIGlmICghc3VwcG9ydHNBcmdzQ2xhc3MpIHtcblx0ICAgIGlzQXJndW1lbnRzID0gZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgcmV0dXJuICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcpID8gaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NhbGxlZScpIDogZmFsc2U7XG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgdmFyIGlzRXF1YWwgPSBSeC5pbnRlcm5hbHMuaXNFcXVhbCA9IGZ1bmN0aW9uICh4LCB5KSB7XG5cdCAgICByZXR1cm4gZGVlcEVxdWFscyh4LCB5LCBbXSwgW10pO1xuXHQgIH07XG5cdFxuXHQgIC8qKiBAcHJpdmF0ZVxuXHQgICAqIFVzZWQgZm9yIGRlZXAgY29tcGFyaXNvblxuXHQgICAqKi9cblx0ICBmdW5jdGlvbiBkZWVwRXF1YWxzKGEsIGIsIHN0YWNrQSwgc3RhY2tCKSB7XG5cdCAgICAvLyBleGl0IGVhcmx5IGZvciBpZGVudGljYWwgdmFsdWVzXG5cdCAgICBpZiAoYSA9PT0gYikge1xuXHQgICAgICAvLyB0cmVhdCBgKzBgIHZzLiBgLTBgIGFzIG5vdCBlcXVhbFxuXHQgICAgICByZXR1cm4gYSAhPT0gMCB8fCAoMSAvIGEgPT0gMSAvIGIpO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciB0eXBlID0gdHlwZW9mIGEsXG5cdCAgICAgICAgb3RoZXJUeXBlID0gdHlwZW9mIGI7XG5cdFxuXHQgICAgLy8gZXhpdCBlYXJseSBmb3IgdW5saWtlIHByaW1pdGl2ZSB2YWx1ZXNcblx0ICAgIGlmIChhID09PSBhICYmIChhID09IG51bGwgfHwgYiA9PSBudWxsIHx8XG5cdCAgICAgICAgKHR5cGUgIT0gJ2Z1bmN0aW9uJyAmJiB0eXBlICE9ICdvYmplY3QnICYmIG90aGVyVHlwZSAhPSAnZnVuY3Rpb24nICYmIG90aGVyVHlwZSAhPSAnb2JqZWN0JykpKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBjb21wYXJlIFtbQ2xhc3NdXSBuYW1lc1xuXHQgICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwoYSksXG5cdCAgICAgICAgb3RoZXJDbGFzcyA9IHRvU3RyaW5nLmNhbGwoYik7XG5cdFxuXHQgICAgaWYgKGNsYXNzTmFtZSA9PSBhcmdzQ2xhc3MpIHtcblx0ICAgICAgY2xhc3NOYW1lID0gb2JqZWN0Q2xhc3M7XG5cdCAgICB9XG5cdCAgICBpZiAob3RoZXJDbGFzcyA9PSBhcmdzQ2xhc3MpIHtcblx0ICAgICAgb3RoZXJDbGFzcyA9IG9iamVjdENsYXNzO1xuXHQgICAgfVxuXHQgICAgaWYgKGNsYXNzTmFtZSAhPSBvdGhlckNsYXNzKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0ICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG5cdCAgICAgIGNhc2UgYm9vbENsYXNzOlxuXHQgICAgICBjYXNlIGRhdGVDbGFzczpcblx0ICAgICAgICAvLyBjb2VyY2UgZGF0ZXMgYW5kIGJvb2xlYW5zIHRvIG51bWJlcnMsIGRhdGVzIHRvIG1pbGxpc2Vjb25kcyBhbmQgYm9vbGVhbnNcblx0ICAgICAgICAvLyB0byBgMWAgb3IgYDBgIHRyZWF0aW5nIGludmFsaWQgZGF0ZXMgY29lcmNlZCB0byBgTmFOYCBhcyBub3QgZXF1YWxcblx0ICAgICAgICByZXR1cm4gK2EgPT0gK2I7XG5cdFxuXHQgICAgICBjYXNlIG51bWJlckNsYXNzOlxuXHQgICAgICAgIC8vIHRyZWF0IGBOYU5gIHZzLiBgTmFOYCBhcyBlcXVhbFxuXHQgICAgICAgIHJldHVybiAoYSAhPSArYSkgP1xuXHQgICAgICAgICAgYiAhPSArYiA6XG5cdCAgICAgICAgICAvLyBidXQgdHJlYXQgYC0wYCB2cy4gYCswYCBhcyBub3QgZXF1YWxcblx0ICAgICAgICAgIChhID09IDAgPyAoMSAvIGEgPT0gMSAvIGIpIDogYSA9PSArYik7XG5cdFxuXHQgICAgICBjYXNlIHJlZ2V4cENsYXNzOlxuXHQgICAgICBjYXNlIHN0cmluZ0NsYXNzOlxuXHQgICAgICAgIC8vIGNvZXJjZSByZWdleGVzIHRvIHN0cmluZ3MgKGh0dHA6Ly9lczUuZ2l0aHViLmlvLyN4MTUuMTAuNi40KVxuXHQgICAgICAgIC8vIHRyZWF0IHN0cmluZyBwcmltaXRpdmVzIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIG9iamVjdCBpbnN0YW5jZXMgYXMgZXF1YWxcblx0ICAgICAgICByZXR1cm4gYSA9PSBTdHJpbmcoYik7XG5cdCAgICB9XG5cdCAgICB2YXIgaXNBcnIgPSBjbGFzc05hbWUgPT0gYXJyYXlDbGFzcztcblx0ICAgIGlmICghaXNBcnIpIHtcblx0XG5cdCAgICAgIC8vIGV4aXQgZm9yIGZ1bmN0aW9ucyBhbmQgRE9NIG5vZGVzXG5cdCAgICAgIGlmIChjbGFzc05hbWUgIT0gb2JqZWN0Q2xhc3MgfHwgKCFzdXBwb3J0Lm5vZGVDbGFzcyAmJiAoaXNOb2RlKGEpIHx8IGlzTm9kZShiKSkpKSB7XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICAgIC8vIGluIG9sZGVyIHZlcnNpb25zIG9mIE9wZXJhLCBgYXJndW1lbnRzYCBvYmplY3RzIGhhdmUgYEFycmF5YCBjb25zdHJ1Y3RvcnNcblx0ICAgICAgdmFyIGN0b3JBID0gIXN1cHBvcnQuYXJnc09iamVjdCAmJiBpc0FyZ3VtZW50cyhhKSA/IE9iamVjdCA6IGEuY29uc3RydWN0b3IsXG5cdCAgICAgICAgICBjdG9yQiA9ICFzdXBwb3J0LmFyZ3NPYmplY3QgJiYgaXNBcmd1bWVudHMoYikgPyBPYmplY3QgOiBiLmNvbnN0cnVjdG9yO1xuXHRcblx0ICAgICAgLy8gbm9uIGBPYmplY3RgIG9iamVjdCBpbnN0YW5jZXMgd2l0aCBkaWZmZXJlbnQgY29uc3RydWN0b3JzIGFyZSBub3QgZXF1YWxcblx0ICAgICAgaWYgKGN0b3JBICE9IGN0b3JCICYmXG5cdCAgICAgICAgICAgICEoaGFzT3duUHJvcGVydHkuY2FsbChhLCAnY29uc3RydWN0b3InKSAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGIsICdjb25zdHJ1Y3RvcicpKSAmJlxuXHQgICAgICAgICAgICAhKGlzRnVuY3Rpb24oY3RvckEpICYmIGN0b3JBIGluc3RhbmNlb2YgY3RvckEgJiYgaXNGdW5jdGlvbihjdG9yQikgJiYgY3RvckIgaW5zdGFuY2VvZiBjdG9yQikgJiZcblx0ICAgICAgICAgICAgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpXG5cdCAgICAgICAgICApIHtcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIC8vIGFzc3VtZSBjeWNsaWMgc3RydWN0dXJlcyBhcmUgZXF1YWxcblx0ICAgIC8vIHRoZSBhbGdvcml0aG0gZm9yIGRldGVjdGluZyBjeWNsaWMgc3RydWN0dXJlcyBpcyBhZGFwdGVkIGZyb20gRVMgNS4xXG5cdCAgICAvLyBzZWN0aW9uIDE1LjEyLjMsIGFic3RyYWN0IG9wZXJhdGlvbiBgSk9gIChodHRwOi8vZXM1LmdpdGh1Yi5pby8jeDE1LjEyLjMpXG5cdCAgICB2YXIgaW5pdGVkU3RhY2sgPSAhc3RhY2tBO1xuXHQgICAgc3RhY2tBIHx8IChzdGFja0EgPSBbXSk7XG5cdCAgICBzdGFja0IgfHwgKHN0YWNrQiA9IFtdKTtcblx0XG5cdCAgICB2YXIgbGVuZ3RoID0gc3RhY2tBLmxlbmd0aDtcblx0ICAgIHdoaWxlIChsZW5ndGgtLSkge1xuXHQgICAgICBpZiAoc3RhY2tBW2xlbmd0aF0gPT0gYSkge1xuXHQgICAgICAgIHJldHVybiBzdGFja0JbbGVuZ3RoXSA9PSBiO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgICB2YXIgc2l6ZSA9IDA7XG5cdCAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcblx0XG5cdCAgICAvLyBhZGQgYGFgIGFuZCBgYmAgdG8gdGhlIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzXG5cdCAgICBzdGFja0EucHVzaChhKTtcblx0ICAgIHN0YWNrQi5wdXNoKGIpO1xuXHRcblx0ICAgIC8vIHJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyBhbmQgYXJyYXlzIChzdXNjZXB0aWJsZSB0byBjYWxsIHN0YWNrIGxpbWl0cylcblx0ICAgIGlmIChpc0Fycikge1xuXHQgICAgICAvLyBjb21wYXJlIGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeVxuXHQgICAgICBsZW5ndGggPSBhLmxlbmd0aDtcblx0ICAgICAgc2l6ZSA9IGIubGVuZ3RoO1xuXHQgICAgICByZXN1bHQgPSBzaXplID09IGxlbmd0aDtcblx0XG5cdCAgICAgIGlmIChyZXN1bHQpIHtcblx0ICAgICAgICAvLyBkZWVwIGNvbXBhcmUgdGhlIGNvbnRlbnRzLCBpZ25vcmluZyBub24tbnVtZXJpYyBwcm9wZXJ0aWVzXG5cdCAgICAgICAgd2hpbGUgKHNpemUtLSkge1xuXHQgICAgICAgICAgdmFyIGluZGV4ID0gbGVuZ3RoLFxuXHQgICAgICAgICAgICAgIHZhbHVlID0gYltzaXplXTtcblx0XG5cdCAgICAgICAgICBpZiAoIShyZXN1bHQgPSBkZWVwRXF1YWxzKGFbc2l6ZV0sIHZhbHVlLCBzdGFja0EsIHN0YWNrQikpKSB7XG5cdCAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgZWxzZSB7XG5cdCAgICAgIC8vIGRlZXAgY29tcGFyZSBvYmplY3RzIHVzaW5nIGBmb3JJbmAsIGluc3RlYWQgb2YgYGZvck93bmAsIHRvIGF2b2lkIGBPYmplY3Qua2V5c2Bcblx0ICAgICAgLy8gd2hpY2gsIGluIHRoaXMgY2FzZSwgaXMgbW9yZSBjb3N0bHlcblx0ICAgICAgaW50ZXJuYWxGb3JJbihiLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBiKSB7XG5cdCAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYiwga2V5KSkge1xuXHQgICAgICAgICAgLy8gY291bnQgdGhlIG51bWJlciBvZiBwcm9wZXJ0aWVzLlxuXHQgICAgICAgICAgc2l6ZSsrO1xuXHQgICAgICAgICAgLy8gZGVlcCBjb21wYXJlIGVhY2ggcHJvcGVydHkgdmFsdWUuXG5cdCAgICAgICAgICByZXR1cm4gKHJlc3VsdCA9IGhhc093blByb3BlcnR5LmNhbGwoYSwga2V5KSAmJiBkZWVwRXF1YWxzKGFba2V5XSwgdmFsdWUsIHN0YWNrQSwgc3RhY2tCKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIGlmIChyZXN1bHQpIHtcblx0ICAgICAgICAvLyBlbnN1cmUgYm90aCBvYmplY3RzIGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mIHByb3BlcnRpZXNcblx0ICAgICAgICBpbnRlcm5hbEZvckluKGEsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGEpIHtcblx0ICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGEsIGtleSkpIHtcblx0ICAgICAgICAgICAgLy8gYHNpemVgIHdpbGwgYmUgYC0xYCBpZiBgYWAgaGFzIG1vcmUgcHJvcGVydGllcyB0aGFuIGBiYFxuXHQgICAgICAgICAgICByZXR1cm4gKHJlc3VsdCA9IC0tc2l6ZSA+IC0xKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgc3RhY2tBLnBvcCgpO1xuXHQgICAgc3RhY2tCLnBvcCgpO1xuXHRcblx0ICAgIHJldHVybiByZXN1bHQ7XG5cdCAgfVxuXHRcblx0ICB2YXIgaGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LFxuXHQgICAgICBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcblx0XG5cdCAgdmFyIGluaGVyaXRzID0gUnguaW50ZXJuYWxzLmluaGVyaXRzID0gZnVuY3Rpb24gKGNoaWxkLCBwYXJlbnQpIHtcblx0ICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH1cblx0ICAgIF9fLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7XG5cdCAgICBjaGlsZC5wcm90b3R5cGUgPSBuZXcgX18oKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgYWRkUHJvcGVydGllcyA9IFJ4LmludGVybmFscy5hZGRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKG9iaikge1xuXHQgICAgZm9yKHZhciBzb3VyY2VzID0gW10sIGkgPSAxLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsgc291cmNlcy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cblx0ICAgIGZvciAodmFyIGlkeCA9IDAsIGxuID0gc291cmNlcy5sZW5ndGg7IGlkeCA8IGxuOyBpZHgrKykge1xuXHQgICAgICB2YXIgc291cmNlID0gc291cmNlc1tpZHhdO1xuXHQgICAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkge1xuXHQgICAgICAgIG9ialtwcm9wXSA9IHNvdXJjZVtwcm9wXTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8vIFJ4IFV0aWxzXG5cdCAgdmFyIGFkZFJlZiA9IFJ4LmludGVybmFscy5hZGRSZWYgPSBmdW5jdGlvbiAoeHMsIHIpIHtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHIuZ2V0RGlzcG9zYWJsZSgpLCB4cy5zdWJzY3JpYmUob2JzZXJ2ZXIpKTtcblx0ICAgIH0pO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGFycmF5SW5pdGlhbGl6ZShjb3VudCwgZmFjdG9yeSkge1xuXHQgICAgdmFyIGEgPSBuZXcgQXJyYXkoY291bnQpO1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG5cdCAgICAgIGFbaV0gPSBmYWN0b3J5KCk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gYTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJlcHJlc2VudHMgYSBncm91cCBvZiBkaXNwb3NhYmxlIHJlc291cmNlcyB0aGF0IGFyZSBkaXNwb3NlZCB0b2dldGhlci5cblx0ICAgKiBAY29uc3RydWN0b3Jcblx0ICAgKi9cblx0ICB2YXIgQ29tcG9zaXRlRGlzcG9zYWJsZSA9IFJ4LkNvbXBvc2l0ZURpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgYXJncyA9IFtdLCBpLCBsZW47XG5cdCAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG5cdCAgICAgIGFyZ3MgPSBhcmd1bWVudHNbMF07XG5cdCAgICAgIGxlbiA9IGFyZ3MubGVuZ3RoO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcblx0ICAgICAgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICB9XG5cdCAgICB0aGlzLmRpc3Bvc2FibGVzID0gYXJncztcblx0ICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgdGhpcy5sZW5ndGggPSBhcmdzLmxlbmd0aDtcblx0ICB9O1xuXHRcblx0ICB2YXIgQ29tcG9zaXRlRGlzcG9zYWJsZVByb3RvdHlwZSA9IENvbXBvc2l0ZURpc3Bvc2FibGUucHJvdG90eXBlO1xuXHRcblx0ICAvKipcblx0ICAgKiBBZGRzIGEgZGlzcG9zYWJsZSB0byB0aGUgQ29tcG9zaXRlRGlzcG9zYWJsZSBvciBkaXNwb3NlcyB0aGUgZGlzcG9zYWJsZSBpZiB0aGUgQ29tcG9zaXRlRGlzcG9zYWJsZSBpcyBkaXNwb3NlZC5cblx0ICAgKiBAcGFyYW0ge01peGVkfSBpdGVtIERpc3Bvc2FibGUgdG8gYWRkLlxuXHQgICAqL1xuXHQgIENvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgIGlmICh0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgaXRlbS5kaXNwb3NlKCk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aGlzLmRpc3Bvc2FibGVzLnB1c2goaXRlbSk7XG5cdCAgICAgIHRoaXMubGVuZ3RoKys7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUmVtb3ZlcyBhbmQgZGlzcG9zZXMgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYSBkaXNwb3NhYmxlIGZyb20gdGhlIENvbXBvc2l0ZURpc3Bvc2FibGUuXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gaXRlbSBEaXNwb3NhYmxlIHRvIHJlbW92ZS5cblx0ICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gdHJ1ZSBpZiBmb3VuZDsgZmFsc2Ugb3RoZXJ3aXNlLlxuXHQgICAqL1xuXHQgIENvbXBvc2l0ZURpc3Bvc2FibGVQcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgIHZhciBzaG91bGREaXNwb3NlID0gZmFsc2U7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB2YXIgaWR4ID0gdGhpcy5kaXNwb3NhYmxlcy5pbmRleE9mKGl0ZW0pO1xuXHQgICAgICBpZiAoaWR4ICE9PSAtMSkge1xuXHQgICAgICAgIHNob3VsZERpc3Bvc2UgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZGlzcG9zYWJsZXMuc3BsaWNlKGlkeCwgMSk7XG5cdCAgICAgICAgdGhpcy5sZW5ndGgtLTtcblx0ICAgICAgICBpdGVtLmRpc3Bvc2UoKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIHNob3VsZERpc3Bvc2U7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIERpc3Bvc2VzIGFsbCBkaXNwb3NhYmxlcyBpbiB0aGUgZ3JvdXAgYW5kIHJlbW92ZXMgdGhlbSBmcm9tIHRoZSBncm91cC5cblx0ICAgKi9cblx0ICBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICB2YXIgbGVuID0gdGhpcy5kaXNwb3NhYmxlcy5sZW5ndGgsIGN1cnJlbnREaXNwb3NhYmxlcyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgY3VycmVudERpc3Bvc2FibGVzW2ldID0gdGhpcy5kaXNwb3NhYmxlc1tpXTsgfVxuXHQgICAgICB0aGlzLmRpc3Bvc2FibGVzID0gW107XG5cdCAgICAgIHRoaXMubGVuZ3RoID0gMDtcblx0XG5cdCAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgIGN1cnJlbnREaXNwb3NhYmxlc1tpXS5kaXNwb3NlKCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBQcm92aWRlcyBhIHNldCBvZiBzdGF0aWMgbWV0aG9kcyBmb3IgY3JlYXRpbmcgRGlzcG9zYWJsZXMuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gZGlzcG9zZSBBY3Rpb24gdG8gcnVuIGR1cmluZyB0aGUgZmlyc3QgY2FsbCB0byBkaXNwb3NlLiBUaGUgYWN0aW9uIGlzIGd1YXJhbnRlZWQgdG8gYmUgcnVuIGF0IG1vc3Qgb25jZS5cblx0ICAgKi9cblx0ICB2YXIgRGlzcG9zYWJsZSA9IFJ4LkRpc3Bvc2FibGUgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG5cdCAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgIHRoaXMuYWN0aW9uID0gYWN0aW9uIHx8IG5vb3A7XG5cdCAgfTtcblx0XG5cdCAgLyoqIFBlcmZvcm1zIHRoZSB0YXNrIG9mIGNsZWFuaW5nIHVwIHJlc291cmNlcy4gKi9cblx0ICBEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdGhpcy5hY3Rpb24oKTtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBDcmVhdGVzIGEgZGlzcG9zYWJsZSBvYmplY3QgdGhhdCBpbnZva2VzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIHdoZW4gZGlzcG9zZWQuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gZGlzcG9zZSBBY3Rpb24gdG8gcnVuIGR1cmluZyB0aGUgZmlyc3QgY2FsbCB0byBkaXNwb3NlLiBUaGUgYWN0aW9uIGlzIGd1YXJhbnRlZWQgdG8gYmUgcnVuIGF0IG1vc3Qgb25jZS5cblx0ICAgKiBAcmV0dXJuIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdGhhdCBydW5zIHRoZSBnaXZlbiBhY3Rpb24gdXBvbiBkaXNwb3NhbC5cblx0ICAgKi9cblx0ICB2YXIgZGlzcG9zYWJsZUNyZWF0ZSA9IERpc3Bvc2FibGUuY3JlYXRlID0gZnVuY3Rpb24gKGFjdGlvbikgeyByZXR1cm4gbmV3IERpc3Bvc2FibGUoYWN0aW9uKTsgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogR2V0cyB0aGUgZGlzcG9zYWJsZSB0aGF0IGRvZXMgbm90aGluZyB3aGVuIGRpc3Bvc2VkLlxuXHQgICAqL1xuXHQgIHZhciBkaXNwb3NhYmxlRW1wdHkgPSBEaXNwb3NhYmxlLmVtcHR5ID0geyBkaXNwb3NlOiBub29wIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFZhbGlkYXRlcyB3aGV0aGVyIHRoZSBnaXZlbiBvYmplY3QgaXMgYSBkaXNwb3NhYmxlXG5cdCAgICogQHBhcmFtIHtPYmplY3R9IE9iamVjdCB0byB0ZXN0IHdoZXRoZXIgaXQgaGFzIGEgZGlzcG9zZSBtZXRob2Rcblx0ICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gdHJ1ZSBpZiBhIGRpc3Bvc2FibGUgb2JqZWN0LCBlbHNlIGZhbHNlLlxuXHQgICAqL1xuXHQgIHZhciBpc0Rpc3Bvc2FibGUgPSBEaXNwb3NhYmxlLmlzRGlzcG9zYWJsZSA9IGZ1bmN0aW9uIChkKSB7XG5cdCAgICByZXR1cm4gZCAmJiBpc0Z1bmN0aW9uKGQuZGlzcG9zZSk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIGNoZWNrRGlzcG9zZWQgPSBEaXNwb3NhYmxlLmNoZWNrRGlzcG9zZWQgPSBmdW5jdGlvbiAoZGlzcG9zYWJsZSkge1xuXHQgICAgaWYgKGRpc3Bvc2FibGUuaXNEaXNwb3NlZCkgeyB0aHJvdyBuZXcgT2JqZWN0RGlzcG9zZWRFcnJvcigpOyB9XG5cdCAgfTtcblx0XG5cdCAgdmFyIGRpc3Bvc2FibGVGaXh1cCA9IERpc3Bvc2FibGUuX2ZpeHVwID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuXHQgICAgcmV0dXJuIGlzRGlzcG9zYWJsZShyZXN1bHQpID8gcmVzdWx0IDogZGlzcG9zYWJsZUVtcHR5O1xuXHQgIH07XG5cdFxuXHQgIC8vIFNpbmdsZSBhc3NpZ25tZW50XG5cdCAgdmFyIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlID0gUnguU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG5cdCAgfTtcblx0ICBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzLmN1cnJlbnQ7XG5cdCAgfTtcblx0ICBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZS5wcm90b3R5cGUuc2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgaWYgKHRoaXMuY3VycmVudCkgeyB0aHJvdyBuZXcgRXJyb3IoJ0Rpc3Bvc2FibGUgaGFzIGFscmVhZHkgYmVlbiBhc3NpZ25lZCcpOyB9XG5cdCAgICB2YXIgc2hvdWxkRGlzcG9zZSA9IHRoaXMuaXNEaXNwb3NlZDtcblx0ICAgICFzaG91bGREaXNwb3NlICYmICh0aGlzLmN1cnJlbnQgPSB2YWx1ZSk7XG5cdCAgICBzaG91bGREaXNwb3NlICYmIHZhbHVlICYmIHZhbHVlLmRpc3Bvc2UoKTtcblx0ICB9O1xuXHQgIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgdmFyIG9sZCA9IHRoaXMuY3VycmVudDtcblx0ICAgICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcblx0ICAgICAgb2xkICYmIG9sZC5kaXNwb3NlKCk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgLy8gTXVsdGlwbGUgYXNzaWdubWVudCBkaXNwb3NhYmxlXG5cdCAgdmFyIFNlcmlhbERpc3Bvc2FibGUgPSBSeC5TZXJpYWxEaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuXHQgIH07XG5cdCAgU2VyaWFsRGlzcG9zYWJsZS5wcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzLmN1cnJlbnQ7XG5cdCAgfTtcblx0ICBTZXJpYWxEaXNwb3NhYmxlLnByb3RvdHlwZS5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICB2YXIgc2hvdWxkRGlzcG9zZSA9IHRoaXMuaXNEaXNwb3NlZDtcblx0ICAgIGlmICghc2hvdWxkRGlzcG9zZSkge1xuXHQgICAgICB2YXIgb2xkID0gdGhpcy5jdXJyZW50O1xuXHQgICAgICB0aGlzLmN1cnJlbnQgPSB2YWx1ZTtcblx0ICAgIH1cblx0ICAgIG9sZCAmJiBvbGQuZGlzcG9zZSgpO1xuXHQgICAgc2hvdWxkRGlzcG9zZSAmJiB2YWx1ZSAmJiB2YWx1ZS5kaXNwb3NlKCk7XG5cdCAgfTtcblx0ICBTZXJpYWxEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgdmFyIG9sZCA9IHRoaXMuY3VycmVudDtcblx0ICAgICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcblx0ICAgIH1cblx0ICAgIG9sZCAmJiBvbGQuZGlzcG9zZSgpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBCaW5hcnlEaXNwb3NhYmxlID0gUnguQmluYXJ5RGlzcG9zYWJsZSA9IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG5cdCAgICB0aGlzLl9maXJzdCA9IGZpcnN0O1xuXHQgICAgdGhpcy5fc2Vjb25kID0gc2Vjb25kO1xuXHQgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgfTtcblx0XG5cdCAgQmluYXJ5RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgIHZhciBvbGQxID0gdGhpcy5fZmlyc3Q7XG5cdCAgICAgIHRoaXMuX2ZpcnN0ID0gbnVsbDtcblx0ICAgICAgb2xkMSAmJiBvbGQxLmRpc3Bvc2UoKTtcblx0ICAgICAgdmFyIG9sZDIgPSB0aGlzLl9zZWNvbmQ7XG5cdCAgICAgIHRoaXMuX3NlY29uZCA9IG51bGw7XG5cdCAgICAgIG9sZDIgJiYgb2xkMi5kaXNwb3NlKCk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgdmFyIE5BcnlEaXNwb3NhYmxlID0gUnguTkFyeURpc3Bvc2FibGUgPSBmdW5jdGlvbiAoZGlzcG9zYWJsZXMpIHtcblx0ICAgIHRoaXMuX2Rpc3Bvc2FibGVzID0gZGlzcG9zYWJsZXM7XG5cdCAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICB9O1xuXHRcblx0ICBOQXJ5RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9kaXNwb3NhYmxlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzW2ldLmRpc3Bvc2UoKTtcblx0ICAgICAgfVxuXHQgICAgICB0aGlzLl9kaXNwb3NhYmxlcy5sZW5ndGggPSAwO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJlcHJlc2VudHMgYSBkaXNwb3NhYmxlIHJlc291cmNlIHRoYXQgb25seSBkaXNwb3NlcyBpdHMgdW5kZXJseWluZyBkaXNwb3NhYmxlIHJlc291cmNlIHdoZW4gYWxsIGRlcGVuZGVudCBkaXNwb3NhYmxlIG9iamVjdHMgaGF2ZSBiZWVuIGRpc3Bvc2VkLlxuXHQgICAqL1xuXHQgIHZhciBSZWZDb3VudERpc3Bvc2FibGUgPSBSeC5SZWZDb3VudERpc3Bvc2FibGUgPSAoZnVuY3Rpb24gKCkge1xuXHRcblx0ICAgIGZ1bmN0aW9uIElubmVyRGlzcG9zYWJsZShkaXNwb3NhYmxlKSB7XG5cdCAgICAgIHRoaXMuZGlzcG9zYWJsZSA9IGRpc3Bvc2FibGU7XG5cdCAgICAgIHRoaXMuZGlzcG9zYWJsZS5jb3VudCsrO1xuXHQgICAgICB0aGlzLmlzSW5uZXJEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIElubmVyRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKCF0aGlzLmRpc3Bvc2FibGUuaXNEaXNwb3NlZCAmJiAhdGhpcy5pc0lubmVyRGlzcG9zZWQpIHtcblx0ICAgICAgICB0aGlzLmlzSW5uZXJEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5kaXNwb3NhYmxlLmNvdW50LS07XG5cdCAgICAgICAgaWYgKHRoaXMuZGlzcG9zYWJsZS5jb3VudCA9PT0gMCAmJiB0aGlzLmRpc3Bvc2FibGUuaXNQcmltYXJ5RGlzcG9zZWQpIHtcblx0ICAgICAgICAgIHRoaXMuZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuZGlzcG9zYWJsZS51bmRlcmx5aW5nRGlzcG9zYWJsZS5kaXNwb3NlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIFJlZkNvdW50RGlzcG9zYWJsZSB3aXRoIHRoZSBzcGVjaWZpZWQgZGlzcG9zYWJsZS5cblx0ICAgICAqIEBjb25zdHJ1Y3RvclxuXHQgICAgICogQHBhcmFtIHtEaXNwb3NhYmxlfSBkaXNwb3NhYmxlIFVuZGVybHlpbmcgZGlzcG9zYWJsZS5cblx0ICAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIFJlZkNvdW50RGlzcG9zYWJsZShkaXNwb3NhYmxlKSB7XG5cdCAgICAgIHRoaXMudW5kZXJseWluZ0Rpc3Bvc2FibGUgPSBkaXNwb3NhYmxlO1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5pc1ByaW1hcnlEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmNvdW50ID0gMDtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIERpc3Bvc2VzIHRoZSB1bmRlcmx5aW5nIGRpc3Bvc2FibGUgb25seSB3aGVuIGFsbCBkZXBlbmRlbnQgZGlzcG9zYWJsZXMgaGF2ZSBiZWVuIGRpc3Bvc2VkXG5cdCAgICAgKi9cblx0ICAgIFJlZkNvdW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQgJiYgIXRoaXMuaXNQcmltYXJ5RGlzcG9zZWQpIHtcblx0ICAgICAgICB0aGlzLmlzUHJpbWFyeURpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICBpZiAodGhpcy5jb3VudCA9PT0gMCkge1xuXHQgICAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMudW5kZXJseWluZ0Rpc3Bvc2FibGUuZGlzcG9zZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFJldHVybnMgYSBkZXBlbmRlbnQgZGlzcG9zYWJsZSB0aGF0IHdoZW4gZGlzcG9zZWQgZGVjcmVhc2VzIHRoZSByZWZjb3VudCBvbiB0aGUgdW5kZXJseWluZyBkaXNwb3NhYmxlLlxuXHQgICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IEEgZGVwZW5kZW50IGRpc3Bvc2FibGUgY29udHJpYnV0aW5nIHRvIHRoZSByZWZlcmVuY2UgY291bnQgdGhhdCBtYW5hZ2VzIHRoZSB1bmRlcmx5aW5nIGRpc3Bvc2FibGUncyBsaWZldGltZS5cblx0ICAgICAqL1xuXHQgICAgUmVmQ291bnREaXNwb3NhYmxlLnByb3RvdHlwZS5nZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5pc0Rpc3Bvc2VkID8gZGlzcG9zYWJsZUVtcHR5IDogbmV3IElubmVyRGlzcG9zYWJsZSh0aGlzKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFJlZkNvdW50RGlzcG9zYWJsZTtcblx0ICB9KSgpO1xuXHRcblx0ICB2YXIgU2NoZWR1bGVkSXRlbSA9IFJ4LmludGVybmFscy5TY2hlZHVsZWRJdGVtID0gZnVuY3Rpb24gKHNjaGVkdWxlciwgc3RhdGUsIGFjdGlvbiwgZHVlVGltZSwgY29tcGFyZXIpIHtcblx0ICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuXHQgICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XG5cdCAgICB0aGlzLmR1ZVRpbWUgPSBkdWVUaW1lO1xuXHQgICAgdGhpcy5jb21wYXJlciA9IGNvbXBhcmVyIHx8IGRlZmF1bHRTdWJDb21wYXJlcjtcblx0ICAgIHRoaXMuZGlzcG9zYWJsZSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgIH1cblx0XG5cdCAgU2NoZWR1bGVkSXRlbS5wcm90b3R5cGUuaW52b2tlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdGhpcy5kaXNwb3NhYmxlLnNldERpc3Bvc2FibGUodGhpcy5pbnZva2VDb3JlKCkpO1xuXHQgIH07XG5cdFxuXHQgIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xuXHQgICAgcmV0dXJuIHRoaXMuY29tcGFyZXIodGhpcy5kdWVUaW1lLCBvdGhlci5kdWVUaW1lKTtcblx0ICB9O1xuXHRcblx0ICBTY2hlZHVsZWRJdGVtLnByb3RvdHlwZS5pc0NhbmNlbGxlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzLmRpc3Bvc2FibGUuaXNEaXNwb3NlZDtcblx0ICB9O1xuXHRcblx0ICBTY2hlZHVsZWRJdGVtLnByb3RvdHlwZS5pbnZva2VDb3JlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIGRpc3Bvc2FibGVGaXh1cCh0aGlzLmFjdGlvbih0aGlzLnNjaGVkdWxlciwgdGhpcy5zdGF0ZSkpO1xuXHQgIH07XG5cdFxuXHQgIC8qKiBQcm92aWRlcyBhIHNldCBvZiBzdGF0aWMgcHJvcGVydGllcyB0byBhY2Nlc3MgY29tbW9ubHkgdXNlZCBzY2hlZHVsZXJzLiAqL1xuXHQgIHZhciBTY2hlZHVsZXIgPSBSeC5TY2hlZHVsZXIgPSAoZnVuY3Rpb24gKCkge1xuXHRcblx0ICAgIGZ1bmN0aW9uIFNjaGVkdWxlcigpIHsgfVxuXHRcblx0ICAgIC8qKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGdpdmVuIG9iamVjdCBpcyBhIHNjaGVkdWxlciAqL1xuXHQgICAgU2NoZWR1bGVyLmlzU2NoZWR1bGVyID0gZnVuY3Rpb24gKHMpIHtcblx0ICAgICAgcmV0dXJuIHMgaW5zdGFuY2VvZiBTY2hlZHVsZXI7XG5cdCAgICB9O1xuXHRcblx0ICAgIHZhciBzY2hlZHVsZXJQcm90byA9IFNjaGVkdWxlci5wcm90b3R5cGU7XG5cdFxuXHQgICAgLyoqXG5cdCAgICogU2NoZWR1bGVzIGFuIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgKiBAcGFyYW0gc3RhdGUgU3RhdGUgcGFzc2VkIHRvIHRoZSBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG5cdCAgICovXG5cdCAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG5cdCAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG5cdCAgICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBTY2hlZHVsZXMgYW4gYWN0aW9uIHRvIGJlIGV4ZWN1dGVkIGFmdGVyIGR1ZVRpbWUuXG5cdCAgICogQHBhcmFtIHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IGR1ZVRpbWUgUmVsYXRpdmUgdGltZSBhZnRlciB3aGljaCB0byBleGVjdXRlIHRoZSBhY3Rpb24uXG5cdCAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuXHQgICAqL1xuXHQgICAgc2NoZWR1bGVyUHJvdG8uc2NoZWR1bGVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuXHQgICAgICB2YXIgZHQgPSBkdWVUaW1lO1xuXHQgICAgICBkdCBpbnN0YW5jZW9mIERhdGUgJiYgKGR0ID0gZHQgLSB0aGlzLm5vdygpKTtcblx0ICAgICAgZHQgPSBTY2hlZHVsZXIubm9ybWFsaXplKGR0KTtcblx0XG5cdCAgICAgIGlmIChkdCA9PT0gMCkgeyByZXR1cm4gdGhpcy5zY2hlZHVsZShzdGF0ZSwgYWN0aW9uKTsgfVxuXHRcblx0ICAgICAgcmV0dXJuIHRoaXMuX3NjaGVkdWxlRnV0dXJlKHN0YXRlLCBkdCwgYWN0aW9uKTtcblx0ICAgIH07XG5cdFxuXHQgICAgc2NoZWR1bGVyUHJvdG8uX3NjaGVkdWxlRnV0dXJlID0gZnVuY3Rpb24gKHN0YXRlLCBkdWVUaW1lLCBhY3Rpb24pIHtcblx0ICAgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXJyb3IoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqIEdldHMgdGhlIGN1cnJlbnQgdGltZSBhY2NvcmRpbmcgdG8gdGhlIGxvY2FsIG1hY2hpbmUncyBzeXN0ZW0gY2xvY2suICovXG5cdCAgICBTY2hlZHVsZXIubm93ID0gZGVmYXVsdE5vdztcblx0XG5cdCAgICAvKiogR2V0cyB0aGUgY3VycmVudCB0aW1lIGFjY29yZGluZyB0byB0aGUgbG9jYWwgbWFjaGluZSdzIHN5c3RlbSBjbG9jay4gKi9cblx0ICAgIFNjaGVkdWxlci5wcm90b3R5cGUubm93ID0gZGVmYXVsdE5vdztcblx0XG5cdCAgICAvKipcblx0ICAgICAqIE5vcm1hbGl6ZXMgdGhlIHNwZWNpZmllZCBUaW1lU3BhbiB2YWx1ZSB0byBhIHBvc2l0aXZlIHZhbHVlLlxuXHQgICAgICogQHBhcmFtIHtOdW1iZXJ9IHRpbWVTcGFuIFRoZSB0aW1lIHNwYW4gdmFsdWUgdG8gbm9ybWFsaXplLlxuXHQgICAgICogQHJldHVybnMge051bWJlcn0gVGhlIHNwZWNpZmllZCBUaW1lU3BhbiB2YWx1ZSBpZiBpdCBpcyB6ZXJvIG9yIHBvc2l0aXZlOyBvdGhlcndpc2UsIDBcblx0ICAgICAqL1xuXHQgICAgU2NoZWR1bGVyLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uICh0aW1lU3Bhbikge1xuXHQgICAgICB0aW1lU3BhbiA8IDAgJiYgKHRpbWVTcGFuID0gMCk7XG5cdCAgICAgIHJldHVybiB0aW1lU3Bhbjtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNjaGVkdWxlcjtcblx0ICB9KCkpO1xuXHRcblx0ICB2YXIgbm9ybWFsaXplVGltZSA9IFNjaGVkdWxlci5ub3JtYWxpemUsIGlzU2NoZWR1bGVyID0gU2NoZWR1bGVyLmlzU2NoZWR1bGVyO1xuXHRcblx0ICAoZnVuY3Rpb24gKHNjaGVkdWxlclByb3RvKSB7XG5cdFxuXHQgICAgZnVuY3Rpb24gaW52b2tlUmVjSW1tZWRpYXRlKHNjaGVkdWxlciwgcGFpcikge1xuXHQgICAgICB2YXIgc3RhdGUgPSBwYWlyWzBdLCBhY3Rpb24gPSBwYWlyWzFdLCBncm91cCA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG5cdCAgICAgIGFjdGlvbihzdGF0ZSwgaW5uZXJBY3Rpb24pO1xuXHQgICAgICByZXR1cm4gZ3JvdXA7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBpbm5lckFjdGlvbihzdGF0ZTIpIHtcblx0ICAgICAgICB2YXIgaXNBZGRlZCA9IGZhbHNlLCBpc0RvbmUgPSBmYWxzZTtcblx0XG5cdCAgICAgICAgdmFyIGQgPSBzY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUyLCBzY2hlZHVsZVdvcmspO1xuXHQgICAgICAgIGlmICghaXNEb25lKSB7XG5cdCAgICAgICAgICBncm91cC5hZGQoZCk7XG5cdCAgICAgICAgICBpc0FkZGVkID0gdHJ1ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGZ1bmN0aW9uIHNjaGVkdWxlV29yayhfLCBzdGF0ZTMpIHtcblx0ICAgICAgICAgIGlmIChpc0FkZGVkKSB7XG5cdCAgICAgICAgICAgIGdyb3VwLnJlbW92ZShkKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBhY3Rpb24oc3RhdGUzLCBpbm5lckFjdGlvbik7XG5cdCAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGludm9rZVJlY0RhdGUoc2NoZWR1bGVyLCBwYWlyKSB7XG5cdCAgICAgIHZhciBzdGF0ZSA9IHBhaXJbMF0sIGFjdGlvbiA9IHBhaXJbMV0sIGdyb3VwID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcblx0ICAgICAgYWN0aW9uKHN0YXRlLCBpbm5lckFjdGlvbik7XG5cdCAgICAgIHJldHVybiBncm91cDtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGlubmVyQWN0aW9uKHN0YXRlMiwgZHVlVGltZTEpIHtcblx0ICAgICAgICB2YXIgaXNBZGRlZCA9IGZhbHNlLCBpc0RvbmUgPSBmYWxzZTtcblx0XG5cdCAgICAgICAgdmFyIGQgPSBzY2hlZHVsZXIuc2NoZWR1bGVGdXR1cmUoc3RhdGUyLCBkdWVUaW1lMSwgc2NoZWR1bGVXb3JrKTtcblx0ICAgICAgICBpZiAoIWlzRG9uZSkge1xuXHQgICAgICAgICAgZ3JvdXAuYWRkKGQpO1xuXHQgICAgICAgICAgaXNBZGRlZCA9IHRydWU7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBmdW5jdGlvbiBzY2hlZHVsZVdvcmsoXywgc3RhdGUzKSB7XG5cdCAgICAgICAgICBpZiAoaXNBZGRlZCkge1xuXHQgICAgICAgICAgICBncm91cC5yZW1vdmUoZCk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBpc0RvbmUgPSB0cnVlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgYWN0aW9uKHN0YXRlMywgaW5uZXJBY3Rpb24pO1xuXHQgICAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQgcmVjdXJzaXZlbHkuXG5cdCAgICAgKiBAcGFyYW0ge01peGVkfSBzdGF0ZSBTdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gZXhlY3V0ZSByZWN1cnNpdmVseS4gVGhlIGxhc3QgcGFyYW1ldGVyIHBhc3NlZCB0byB0aGUgYWN0aW9uIGlzIHVzZWQgdG8gdHJpZ2dlciByZWN1cnNpdmUgc2NoZWR1bGluZyBvZiB0aGUgYWN0aW9uLCBwYXNzaW5nIGluIHJlY3Vyc2l2ZSBpbnZvY2F0aW9uIHN0YXRlLlxuXHQgICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuXHQgICAgICovXG5cdCAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZVJlY3Vyc2l2ZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlKFtzdGF0ZSwgYWN0aW9uXSwgaW52b2tlUmVjSW1tZWRpYXRlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBTY2hlZHVsZXMgYW4gYWN0aW9uIHRvIGJlIGV4ZWN1dGVkIHJlY3Vyc2l2ZWx5IGFmdGVyIGEgc3BlY2lmaWVkIHJlbGF0aXZlIG9yIGFic29sdXRlIGR1ZSB0aW1lLlxuXHQgICAgICogQHBhcmFtIHtNaXhlZH0gc3RhdGUgU3RhdGUgcGFzc2VkIHRvIHRoZSBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG5cdCAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGV4ZWN1dGUgcmVjdXJzaXZlbHkuIFRoZSBsYXN0IHBhcmFtZXRlciBwYXNzZWQgdG8gdGhlIGFjdGlvbiBpcyB1c2VkIHRvIHRyaWdnZXIgcmVjdXJzaXZlIHNjaGVkdWxpbmcgb2YgdGhlIGFjdGlvbiwgcGFzc2luZyBpbiB0aGUgcmVjdXJzaXZlIGR1ZSB0aW1lIGFuZCBpbnZvY2F0aW9uIHN0YXRlLlxuXHQgICAgICogQHBhcmFtIHtOdW1iZXIgfCBEYXRlfSBkdWVUaW1lIFJlbGF0aXZlIG9yIGFic29sdXRlIHRpbWUgYWZ0ZXIgd2hpY2ggdG8gZXhlY3V0ZSB0aGUgYWN0aW9uIGZvciB0aGUgZmlyc3QgdGltZS5cblx0ICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCBhY3Rpb24gKGJlc3QgZWZmb3J0KS5cblx0ICAgICAqL1xuXHQgICAgc2NoZWR1bGVyUHJvdG8uc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuXHQgICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZUZ1dHVyZShbc3RhdGUsIGFjdGlvbl0sIGR1ZVRpbWUsIGludm9rZVJlY0RhdGUpO1xuXHQgICAgfTtcblx0XG5cdCAgfShTY2hlZHVsZXIucHJvdG90eXBlKSk7XG5cdFxuXHQgIChmdW5jdGlvbiAoc2NoZWR1bGVyUHJvdG8pIHtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFNjaGVkdWxlcyBhIHBlcmlvZGljIHBpZWNlIG9mIHdvcmsgYnkgZHluYW1pY2FsbHkgZGlzY292ZXJpbmcgdGhlIHNjaGVkdWxlcidzIGNhcGFiaWxpdGllcy4gVGhlIHBlcmlvZGljIHRhc2sgd2lsbCBiZSBzY2hlZHVsZWQgdXNpbmcgd2luZG93LnNldEludGVydmFsIGZvciB0aGUgYmFzZSBpbXBsZW1lbnRhdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7TWl4ZWR9IHN0YXRlIEluaXRpYWwgc3RhdGUgcGFzc2VkIHRvIHRoZSBhY3Rpb24gdXBvbiB0aGUgZmlyc3QgaXRlcmF0aW9uLlxuXHQgICAgICogQHBhcmFtIHtOdW1iZXJ9IHBlcmlvZCBQZXJpb2QgZm9yIHJ1bm5pbmcgdGhlIHdvcmsgcGVyaW9kaWNhbGx5LlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBiZSBleGVjdXRlZCwgcG90ZW50aWFsbHkgdXBkYXRpbmcgdGhlIHN0YXRlLlxuXHQgICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIHJlY3VycmluZyBhY3Rpb24gKGJlc3QgZWZmb3J0KS5cblx0ICAgICAqL1xuXHQgICAgU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZVBlcmlvZGljID0gZnVuY3Rpb24oc3RhdGUsIHBlcmlvZCwgYWN0aW9uKSB7XG5cdCAgICAgIGlmICh0eXBlb2Ygcm9vdC5zZXRJbnRlcnZhbCA9PT0gJ3VuZGVmaW5lZCcpIHsgdGhyb3cgbmV3IE5vdFN1cHBvcnRlZEVycm9yKCk7IH1cblx0ICAgICAgcGVyaW9kID0gbm9ybWFsaXplVGltZShwZXJpb2QpO1xuXHQgICAgICB2YXIgcyA9IHN0YXRlLCBpZCA9IHJvb3Quc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyBzID0gYWN0aW9uKHMpOyB9LCBwZXJpb2QpO1xuXHQgICAgICByZXR1cm4gZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7IHJvb3QuY2xlYXJJbnRlcnZhbChpZCk7IH0pO1xuXHQgICAgfTtcblx0XG5cdCAgfShTY2hlZHVsZXIucHJvdG90eXBlKSk7XG5cdFxuXHQgIC8qKiBHZXRzIGEgc2NoZWR1bGVyIHRoYXQgc2NoZWR1bGVzIHdvcmsgaW1tZWRpYXRlbHkgb24gdGhlIGN1cnJlbnQgdGhyZWFkLiAqL1xuXHQgICB2YXIgSW1tZWRpYXRlU2NoZWR1bGVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEltbWVkaWF0ZVNjaGVkdWxlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEltbWVkaWF0ZVNjaGVkdWxlcigpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgSW1tZWRpYXRlU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG5cdCAgICAgIHJldHVybiBkaXNwb3NhYmxlRml4dXAoYWN0aW9uKHRoaXMsIHN0YXRlKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBJbW1lZGlhdGVTY2hlZHVsZXI7XG5cdCAgfShTY2hlZHVsZXIpKTtcblx0XG5cdCAgdmFyIGltbWVkaWF0ZVNjaGVkdWxlciA9IFNjaGVkdWxlci5pbW1lZGlhdGUgPSBuZXcgSW1tZWRpYXRlU2NoZWR1bGVyKCk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEdldHMgYSBzY2hlZHVsZXIgdGhhdCBzY2hlZHVsZXMgd29yayBhcyBzb29uIGFzIHBvc3NpYmxlIG9uIHRoZSBjdXJyZW50IHRocmVhZC5cblx0ICAgKi9cblx0ICB2YXIgQ3VycmVudFRocmVhZFNjaGVkdWxlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICB2YXIgcXVldWU7XG5cdFxuXHQgICAgZnVuY3Rpb24gcnVuVHJhbXBvbGluZSAoKSB7XG5cdCAgICAgIHdoaWxlIChxdWV1ZS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgdmFyIGl0ZW0gPSBxdWV1ZS5kZXF1ZXVlKCk7XG5cdCAgICAgICAgIWl0ZW0uaXNDYW5jZWxsZWQoKSAmJiBpdGVtLmludm9rZSgpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgaW5oZXJpdHMoQ3VycmVudFRocmVhZFNjaGVkdWxlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcblx0ICAgICAgdmFyIHNpID0gbmV3IFNjaGVkdWxlZEl0ZW0odGhpcywgc3RhdGUsIGFjdGlvbiwgdGhpcy5ub3coKSk7XG5cdFxuXHQgICAgICBpZiAoIXF1ZXVlKSB7XG5cdCAgICAgICAgcXVldWUgPSBuZXcgUHJpb3JpdHlRdWV1ZSg0KTtcblx0ICAgICAgICBxdWV1ZS5lbnF1ZXVlKHNpKTtcblx0XG5cdCAgICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHJ1blRyYW1wb2xpbmUpKCk7XG5cdCAgICAgICAgcXVldWUgPSBudWxsO1xuXHQgICAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHRocm93ZXIocmVzdWx0LmUpOyB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcXVldWUuZW5xdWV1ZShzaSk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIHNpLmRpc3Bvc2FibGU7XG5cdCAgICB9O1xuXHRcblx0ICAgIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlUmVxdWlyZWQgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAhcXVldWU7IH07XG5cdFxuXHQgICAgcmV0dXJuIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXI7XG5cdCAgfShTY2hlZHVsZXIpKTtcblx0XG5cdCAgdmFyIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIgPSBTY2hlZHVsZXIuY3VycmVudFRocmVhZCA9IG5ldyBDdXJyZW50VGhyZWFkU2NoZWR1bGVyKCk7XG5cdFxuXHQgIHZhciBTY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlID0gUnguaW50ZXJuYWxzLlNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gY3JlYXRlVGljayhzZWxmKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiB0aWNrKGNvbW1hbmQsIHJlY3Vyc2UpIHtcblx0ICAgICAgICByZWN1cnNlKDAsIHNlbGYuX3BlcmlvZCk7XG5cdCAgICAgICAgdmFyIHN0YXRlID0gdHJ5Q2F0Y2goc2VsZi5fYWN0aW9uKShzZWxmLl9zdGF0ZSk7XG5cdCAgICAgICAgaWYgKHN0YXRlID09PSBlcnJvck9iaikge1xuXHQgICAgICAgICAgc2VsZi5fY2FuY2VsLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgIHRocm93ZXIoc3RhdGUuZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHNlbGYuX3N0YXRlID0gc3RhdGU7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZShzY2hlZHVsZXIsIHN0YXRlLCBwZXJpb2QsIGFjdGlvbikge1xuXHQgICAgICB0aGlzLl9zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG5cdCAgICAgIHRoaXMuX3BlcmlvZCA9IHBlcmlvZDtcblx0ICAgICAgdGhpcy5fYWN0aW9uID0gYWN0aW9uO1xuXHQgICAgfVxuXHRcblx0ICAgIFNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICB0aGlzLl9jYW5jZWwgPSBkO1xuXHQgICAgICBkLnNldERpc3Bvc2FibGUodGhpcy5fc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlKDAsIHRoaXMuX3BlcmlvZCwgY3JlYXRlVGljayh0aGlzKSkpO1xuXHRcblx0ICAgICAgcmV0dXJuIGQ7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlO1xuXHQgIH0oKSk7XG5cdFxuXHQgIHZhciBzY2hlZHVsZU1ldGhvZCwgY2xlYXJNZXRob2Q7XG5cdFxuXHQgIHZhciBsb2NhbFRpbWVyID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBsb2NhbFNldFRpbWVvdXQsIGxvY2FsQ2xlYXJUaW1lb3V0ID0gbm9vcDtcblx0ICAgIGlmICghIXJvb3Quc2V0VGltZW91dCkge1xuXHQgICAgICBsb2NhbFNldFRpbWVvdXQgPSByb290LnNldFRpbWVvdXQ7XG5cdCAgICAgIGxvY2FsQ2xlYXJUaW1lb3V0ID0gcm9vdC5jbGVhclRpbWVvdXQ7XG5cdCAgICB9IGVsc2UgaWYgKCEhcm9vdC5XU2NyaXB0KSB7XG5cdCAgICAgIGxvY2FsU2V0VGltZW91dCA9IGZ1bmN0aW9uIChmbiwgdGltZSkge1xuXHQgICAgICAgIHJvb3QuV1NjcmlwdC5TbGVlcCh0aW1lKTtcblx0ICAgICAgICBmbigpO1xuXHQgICAgICB9O1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGhyb3cgbmV3IE5vdFN1cHBvcnRlZEVycm9yKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIHtcblx0ICAgICAgc2V0VGltZW91dDogbG9jYWxTZXRUaW1lb3V0LFxuXHQgICAgICBjbGVhclRpbWVvdXQ6IGxvY2FsQ2xlYXJUaW1lb3V0XG5cdCAgICB9O1xuXHQgIH0oKSk7XG5cdCAgdmFyIGxvY2FsU2V0VGltZW91dCA9IGxvY2FsVGltZXIuc2V0VGltZW91dCxcblx0ICAgIGxvY2FsQ2xlYXJUaW1lb3V0ID0gbG9jYWxUaW1lci5jbGVhclRpbWVvdXQ7XG5cdFxuXHQgIChmdW5jdGlvbiAoKSB7XG5cdFxuXHQgICAgdmFyIG5leHRIYW5kbGUgPSAxLCB0YXNrc0J5SGFuZGxlID0ge30sIGN1cnJlbnRseVJ1bm5pbmcgPSBmYWxzZTtcblx0XG5cdCAgICBjbGVhck1ldGhvZCA9IGZ1bmN0aW9uIChoYW5kbGUpIHtcblx0ICAgICAgZGVsZXRlIHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gcnVuVGFzayhoYW5kbGUpIHtcblx0ICAgICAgaWYgKGN1cnJlbnRseVJ1bm5pbmcpIHtcblx0ICAgICAgICBsb2NhbFNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBydW5UYXNrKGhhbmRsZSk7IH0sIDApO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHZhciB0YXNrID0gdGFza3NCeUhhbmRsZVtoYW5kbGVdO1xuXHQgICAgICAgIGlmICh0YXNrKSB7XG5cdCAgICAgICAgICBjdXJyZW50bHlSdW5uaW5nID0gdHJ1ZTtcblx0ICAgICAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0YXNrKSgpO1xuXHQgICAgICAgICAgY2xlYXJNZXRob2QoaGFuZGxlKTtcblx0ICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmcgPSBmYWxzZTtcblx0ICAgICAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHRocm93ZXIocmVzdWx0LmUpOyB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIHJlTmF0aXZlID0gbmV3IFJlZ0V4cCgnXicgK1xuXHQgICAgICBTdHJpbmcodG9TdHJpbmcpXG5cdCAgICAgICAgLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJylcblx0ICAgICAgICAucmVwbGFjZSgvdG9TdHJpbmd8IGZvciBbXlxcXV0rL2csICcuKj8nKSArICckJ1xuXHQgICAgKTtcblx0XG5cdCAgICB2YXIgc2V0SW1tZWRpYXRlID0gdHlwZW9mIChzZXRJbW1lZGlhdGUgPSBmcmVlR2xvYmFsICYmIG1vZHVsZUV4cG9ydHMgJiYgZnJlZUdsb2JhbC5zZXRJbW1lZGlhdGUpID09ICdmdW5jdGlvbicgJiZcblx0ICAgICAgIXJlTmF0aXZlLnRlc3Qoc2V0SW1tZWRpYXRlKSAmJiBzZXRJbW1lZGlhdGU7XG5cdFxuXHQgICAgZnVuY3Rpb24gcG9zdE1lc3NhZ2VTdXBwb3J0ZWQgKCkge1xuXHQgICAgICAvLyBFbnN1cmUgbm90IGluIGEgd29ya2VyXG5cdCAgICAgIGlmICghcm9vdC5wb3N0TWVzc2FnZSB8fCByb290LmltcG9ydFNjcmlwdHMpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdCAgICAgIHZhciBpc0FzeW5jID0gZmFsc2UsIG9sZEhhbmRsZXIgPSByb290Lm9ubWVzc2FnZTtcblx0ICAgICAgLy8gVGVzdCBmb3IgYXN5bmNcblx0ICAgICAgcm9vdC5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7IGlzQXN5bmMgPSB0cnVlOyB9O1xuXHQgICAgICByb290LnBvc3RNZXNzYWdlKCcnLCAnKicpO1xuXHQgICAgICByb290Lm9ubWVzc2FnZSA9IG9sZEhhbmRsZXI7XG5cdFxuXHQgICAgICByZXR1cm4gaXNBc3luYztcblx0ICAgIH1cblx0XG5cdCAgICAvLyBVc2UgaW4gb3JkZXIsIHNldEltbWVkaWF0ZSwgbmV4dFRpY2ssIHBvc3RNZXNzYWdlLCBNZXNzYWdlQ2hhbm5lbCwgc2NyaXB0IHJlYWR5c3RhdGVjaGFuZ2VkLCBzZXRUaW1lb3V0XG5cdCAgICBpZiAoaXNGdW5jdGlvbihzZXRJbW1lZGlhdGUpKSB7XG5cdCAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXHQgICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcblx0ICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcblx0ICAgICAgICBzZXRJbW1lZGlhdGUoZnVuY3Rpb24gKCkgeyBydW5UYXNrKGlkKTsgfSk7XG5cdFxuXHQgICAgICAgIHJldHVybiBpZDtcblx0ICAgICAgfTtcblx0ICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHt9LnRvU3RyaW5nLmNhbGwocHJvY2VzcykgPT09ICdbb2JqZWN0IHByb2Nlc3NdJykge1xuXHQgICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcblx0ICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG5cdCAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG5cdCAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7IHJ1blRhc2soaWQpOyB9KTtcblx0XG5cdCAgICAgICAgcmV0dXJuIGlkO1xuXHQgICAgICB9O1xuXHQgICAgfSBlbHNlIGlmIChwb3N0TWVzc2FnZVN1cHBvcnRlZCgpKSB7XG5cdCAgICAgIHZhciBNU0dfUFJFRklYID0gJ21zLnJ4LnNjaGVkdWxlJyArIE1hdGgucmFuZG9tKCk7XG5cdFxuXHQgICAgICB2YXIgb25HbG9iYWxQb3N0TWVzc2FnZSA9IGZ1bmN0aW9uIChldmVudCkge1xuXHQgICAgICAgIC8vIE9ubHkgaWYgd2UncmUgYSBtYXRjaCB0byBhdm9pZCBhbnkgb3RoZXIgZ2xvYmFsIGV2ZW50c1xuXHQgICAgICAgIGlmICh0eXBlb2YgZXZlbnQuZGF0YSA9PT0gJ3N0cmluZycgJiYgZXZlbnQuZGF0YS5zdWJzdHJpbmcoMCwgTVNHX1BSRUZJWC5sZW5ndGgpID09PSBNU0dfUFJFRklYKSB7XG5cdCAgICAgICAgICBydW5UYXNrKGV2ZW50LmRhdGEuc3Vic3RyaW5nKE1TR19QUkVGSVgubGVuZ3RoKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHRcblx0ICAgICAgcm9vdC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgb25HbG9iYWxQb3N0TWVzc2FnZSwgZmFsc2UpO1xuXHRcblx0ICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG5cdCAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuXHQgICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuXHQgICAgICAgIHJvb3QucG9zdE1lc3NhZ2UoTVNHX1BSRUZJWCArIGN1cnJlbnRJZCwgJyonKTtcblx0ICAgICAgICByZXR1cm4gaWQ7XG5cdCAgICAgIH07XG5cdCAgICB9IGVsc2UgaWYgKCEhcm9vdC5NZXNzYWdlQ2hhbm5lbCkge1xuXHQgICAgICB2YXIgY2hhbm5lbCA9IG5ldyByb290Lk1lc3NhZ2VDaGFubmVsKCk7XG5cdFxuXHQgICAgICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7IHJ1blRhc2soZS5kYXRhKTsgfTtcblx0XG5cdCAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuXHQgICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcblx0ICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcblx0ICAgICAgICBjaGFubmVsLnBvcnQyLnBvc3RNZXNzYWdlKGlkKTtcblx0ICAgICAgICByZXR1cm4gaWQ7XG5cdCAgICAgIH07XG5cdCAgICB9IGVsc2UgaWYgKCdkb2N1bWVudCcgaW4gcm9vdCAmJiAnb25yZWFkeXN0YXRlY2hhbmdlJyBpbiByb290LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpKSB7XG5cdFxuXHQgICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcblx0ICAgICAgICB2YXIgc2NyaXB0RWxlbWVudCA9IHJvb3QuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cdCAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuXHQgICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuXHRcblx0ICAgICAgICBzY3JpcHRFbGVtZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIHJ1blRhc2soaWQpO1xuXHQgICAgICAgICAgc2NyaXB0RWxlbWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuXHQgICAgICAgICAgc2NyaXB0RWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNjcmlwdEVsZW1lbnQpO1xuXHQgICAgICAgICAgc2NyaXB0RWxlbWVudCA9IG51bGw7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICByb290LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChzY3JpcHRFbGVtZW50KTtcblx0ICAgICAgICByZXR1cm4gaWQ7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG5cdCAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuXHQgICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuXHQgICAgICAgIGxvY2FsU2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBydW5UYXNrKGlkKTtcblx0ICAgICAgICB9LCAwKTtcblx0XG5cdCAgICAgICAgcmV0dXJuIGlkO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH0oKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEdldHMgYSBzY2hlZHVsZXIgdGhhdCBzY2hlZHVsZXMgd29yayB2aWEgYSB0aW1lZCBjYWxsYmFjayBiYXNlZCB1cG9uIHBsYXRmb3JtLlxuXHQgICAqL1xuXHQgICB2YXIgRGVmYXVsdFNjaGVkdWxlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICAgaW5oZXJpdHMoRGVmYXVsdFNjaGVkdWxlciwgX19zdXBlcl9fKTtcblx0ICAgICBmdW5jdGlvbiBEZWZhdWx0U2NoZWR1bGVyKCkge1xuXHQgICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgfVxuXHRcblx0ICAgICBmdW5jdGlvbiBzY2hlZHVsZUFjdGlvbihkaXNwb3NhYmxlLCBhY3Rpb24sIHNjaGVkdWxlciwgc3RhdGUpIHtcblx0ICAgICAgIHJldHVybiBmdW5jdGlvbiBzY2hlZHVsZSgpIHtcblx0ICAgICAgICAgIWRpc3Bvc2FibGUuaXNEaXNwb3NlZCAmJiBkaXNwb3NhYmxlLnNldERpc3Bvc2FibGUoRGlzcG9zYWJsZS5fZml4dXAoYWN0aW9uKHNjaGVkdWxlciwgc3RhdGUpKSk7XG5cdCAgICAgICB9O1xuXHQgICAgIH1cblx0XG5cdCAgICAgZnVuY3Rpb24gQ2xlYXJEaXNwb3NhYmxlKG1ldGhvZCwgaWQpIHtcblx0ICAgICAgIHRoaXMuX2lkID0gaWQ7XG5cdCAgICAgICB0aGlzLl9tZXRob2QgPSBtZXRob2Q7XG5cdCAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgICB9XG5cdFxuXHQgICAgIENsZWFyRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgIHRoaXMuX21ldGhvZC5jYWxsKG51bGwsIHRoaXMuX2lkKTtcblx0ICAgICAgIH1cblx0ICAgICB9O1xuXHRcblx0ICAgIERlZmF1bHRTY2hlZHVsZXIucHJvdG90eXBlLnNjaGVkdWxlID0gZnVuY3Rpb24gKHN0YXRlLCBhY3Rpb24pIHtcblx0ICAgICAgdmFyIGRpc3Bvc2FibGUgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcblx0ICAgICAgICAgIGlkID0gc2NoZWR1bGVNZXRob2Qoc2NoZWR1bGVBY3Rpb24oZGlzcG9zYWJsZSwgYWN0aW9uLCB0aGlzLCBzdGF0ZSkpO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoZGlzcG9zYWJsZSwgbmV3IENsZWFyRGlzcG9zYWJsZShjbGVhck1ldGhvZCwgaWQpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgRGVmYXVsdFNjaGVkdWxlci5wcm90b3R5cGUuX3NjaGVkdWxlRnV0dXJlID0gZnVuY3Rpb24gKHN0YXRlLCBkdWVUaW1lLCBhY3Rpb24pIHtcblx0ICAgICAgaWYgKGR1ZVRpbWUgPT09IDApIHsgcmV0dXJuIHRoaXMuc2NoZWR1bGUoc3RhdGUsIGFjdGlvbik7IH1cblx0ICAgICAgdmFyIGRpc3Bvc2FibGUgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcblx0ICAgICAgICAgIGlkID0gbG9jYWxTZXRUaW1lb3V0KHNjaGVkdWxlQWN0aW9uKGRpc3Bvc2FibGUsIGFjdGlvbiwgdGhpcywgc3RhdGUpLCBkdWVUaW1lKTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKGRpc3Bvc2FibGUsIG5ldyBDbGVhckRpc3Bvc2FibGUobG9jYWxDbGVhclRpbWVvdXQsIGlkKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBEZWZhdWx0U2NoZWR1bGVyO1xuXHQgIH0oU2NoZWR1bGVyKSk7XG5cdFxuXHQgIHZhciBkZWZhdWx0U2NoZWR1bGVyID0gU2NoZWR1bGVyWydkZWZhdWx0J10gPSBTY2hlZHVsZXIuYXN5bmMgPSBuZXcgRGVmYXVsdFNjaGVkdWxlcigpO1xuXHRcblx0ICBmdW5jdGlvbiBJbmRleGVkSXRlbShpZCwgdmFsdWUpIHtcblx0ICAgIHRoaXMuaWQgPSBpZDtcblx0ICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0ICB9XG5cdFxuXHQgIEluZGV4ZWRJdGVtLnByb3RvdHlwZS5jb21wYXJlVG8gPSBmdW5jdGlvbiAob3RoZXIpIHtcblx0ICAgIHZhciBjID0gdGhpcy52YWx1ZS5jb21wYXJlVG8ob3RoZXIudmFsdWUpO1xuXHQgICAgYyA9PT0gMCAmJiAoYyA9IHRoaXMuaWQgLSBvdGhlci5pZCk7XG5cdCAgICByZXR1cm4gYztcblx0ICB9O1xuXHRcblx0ICB2YXIgUHJpb3JpdHlRdWV1ZSA9IFJ4LmludGVybmFscy5Qcmlvcml0eVF1ZXVlID0gZnVuY3Rpb24gKGNhcGFjaXR5KSB7XG5cdCAgICB0aGlzLml0ZW1zID0gbmV3IEFycmF5KGNhcGFjaXR5KTtcblx0ICAgIHRoaXMubGVuZ3RoID0gMDtcblx0ICB9O1xuXHRcblx0ICB2YXIgcHJpb3JpdHlQcm90byA9IFByaW9yaXR5UXVldWUucHJvdG90eXBlO1xuXHQgIHByaW9yaXR5UHJvdG8uaXNIaWdoZXJQcmlvcml0eSA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xuXHQgICAgcmV0dXJuIHRoaXMuaXRlbXNbbGVmdF0uY29tcGFyZVRvKHRoaXMuaXRlbXNbcmlnaHRdKSA8IDA7XG5cdCAgfTtcblx0XG5cdCAgcHJpb3JpdHlQcm90by5wZXJjb2xhdGUgPSBmdW5jdGlvbiAoaW5kZXgpIHtcblx0ICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCB8fCBpbmRleCA8IDApIHsgcmV0dXJuOyB9XG5cdCAgICB2YXIgcGFyZW50ID0gaW5kZXggLSAxID4+IDE7XG5cdCAgICBpZiAocGFyZW50IDwgMCB8fCBwYXJlbnQgPT09IGluZGV4KSB7IHJldHVybjsgfVxuXHQgICAgaWYgKHRoaXMuaXNIaWdoZXJQcmlvcml0eShpbmRleCwgcGFyZW50KSkge1xuXHQgICAgICB2YXIgdGVtcCA9IHRoaXMuaXRlbXNbaW5kZXhdO1xuXHQgICAgICB0aGlzLml0ZW1zW2luZGV4XSA9IHRoaXMuaXRlbXNbcGFyZW50XTtcblx0ICAgICAgdGhpcy5pdGVtc1twYXJlbnRdID0gdGVtcDtcblx0ICAgICAgdGhpcy5wZXJjb2xhdGUocGFyZW50KTtcblx0ICAgIH1cblx0ICB9O1xuXHRcblx0ICBwcmlvcml0eVByb3RvLmhlYXBpZnkgPSBmdW5jdGlvbiAoaW5kZXgpIHtcblx0ICAgICtpbmRleCB8fCAoaW5kZXggPSAwKTtcblx0ICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCB8fCBpbmRleCA8IDApIHsgcmV0dXJuOyB9XG5cdCAgICB2YXIgbGVmdCA9IDIgKiBpbmRleCArIDEsXG5cdCAgICAgICAgcmlnaHQgPSAyICogaW5kZXggKyAyLFxuXHQgICAgICAgIGZpcnN0ID0gaW5kZXg7XG5cdCAgICBpZiAobGVmdCA8IHRoaXMubGVuZ3RoICYmIHRoaXMuaXNIaWdoZXJQcmlvcml0eShsZWZ0LCBmaXJzdCkpIHtcblx0ICAgICAgZmlyc3QgPSBsZWZ0O1xuXHQgICAgfVxuXHQgICAgaWYgKHJpZ2h0IDwgdGhpcy5sZW5ndGggJiYgdGhpcy5pc0hpZ2hlclByaW9yaXR5KHJpZ2h0LCBmaXJzdCkpIHtcblx0ICAgICAgZmlyc3QgPSByaWdodDtcblx0ICAgIH1cblx0ICAgIGlmIChmaXJzdCAhPT0gaW5kZXgpIHtcblx0ICAgICAgdmFyIHRlbXAgPSB0aGlzLml0ZW1zW2luZGV4XTtcblx0ICAgICAgdGhpcy5pdGVtc1tpbmRleF0gPSB0aGlzLml0ZW1zW2ZpcnN0XTtcblx0ICAgICAgdGhpcy5pdGVtc1tmaXJzdF0gPSB0ZW1wO1xuXHQgICAgICB0aGlzLmhlYXBpZnkoZmlyc3QpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIHByaW9yaXR5UHJvdG8ucGVlayA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuaXRlbXNbMF0udmFsdWU7IH07XG5cdFxuXHQgIHByaW9yaXR5UHJvdG8ucmVtb3ZlQXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcblx0ICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gdGhpcy5pdGVtc1stLXRoaXMubGVuZ3RoXTtcblx0ICAgIHRoaXMuaXRlbXNbdGhpcy5sZW5ndGhdID0gdW5kZWZpbmVkO1xuXHQgICAgdGhpcy5oZWFwaWZ5KCk7XG5cdCAgfTtcblx0XG5cdCAgcHJpb3JpdHlQcm90by5kZXF1ZXVlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIHJlc3VsdCA9IHRoaXMucGVlaygpO1xuXHQgICAgdGhpcy5yZW1vdmVBdCgwKTtcblx0ICAgIHJldHVybiByZXN1bHQ7XG5cdCAgfTtcblx0XG5cdCAgcHJpb3JpdHlQcm90by5lbnF1ZXVlID0gZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgIHZhciBpbmRleCA9IHRoaXMubGVuZ3RoKys7XG5cdCAgICB0aGlzLml0ZW1zW2luZGV4XSA9IG5ldyBJbmRleGVkSXRlbShQcmlvcml0eVF1ZXVlLmNvdW50KyssIGl0ZW0pO1xuXHQgICAgdGhpcy5wZXJjb2xhdGUoaW5kZXgpO1xuXHQgIH07XG5cdFxuXHQgIHByaW9yaXR5UHJvdG8ucmVtb3ZlID0gZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICBpZiAodGhpcy5pdGVtc1tpXS52YWx1ZSA9PT0gaXRlbSkge1xuXHQgICAgICAgIHRoaXMucmVtb3ZlQXQoaSk7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIHJldHVybiBmYWxzZTtcblx0ICB9O1xuXHQgIFByaW9yaXR5UXVldWUuY291bnQgPSAwO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmVwcmVzZW50cyBhIG5vdGlmaWNhdGlvbiB0byBhbiBvYnNlcnZlci5cblx0ICAgKi9cblx0ICB2YXIgTm90aWZpY2F0aW9uID0gUnguTm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIE5vdGlmaWNhdGlvbigpIHtcblx0XG5cdCAgICB9XG5cdFxuXHQgICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0ID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgICAgdGhyb3cgbmV3IE5vdEltcGxlbWVudGVkRXJyb3IoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogSW52b2tlcyB0aGUgZGVsZWdhdGUgY29ycmVzcG9uZGluZyB0byB0aGUgbm90aWZpY2F0aW9uIG9yIHRoZSBvYnNlcnZlcidzIG1ldGhvZCBjb3JyZXNwb25kaW5nIHRvIHRoZSBub3RpZmljYXRpb24gYW5kIHJldHVybnMgdGhlIHByb2R1Y2VkIHJlc3VsdC5cblx0ICAgICAqXG5cdCAgICAgKiBAbWVtYmVyT2YgTm90aWZpY2F0aW9uXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gb2JzZXJ2ZXJPck9uTmV4dCBEZWxlZ2F0ZSB0byBpbnZva2UgZm9yIGFuIE9uTmV4dCBub3RpZmljYXRpb24gb3IgT2JzZXJ2ZXIgdG8gaW52b2tlIHRoZSBub3RpZmljYXRpb24gb24uLlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25FcnJvciBEZWxlZ2F0ZSB0byBpbnZva2UgZm9yIGFuIE9uRXJyb3Igbm90aWZpY2F0aW9uLlxuXHQgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25Db21wbGV0ZWQgRGVsZWdhdGUgdG8gaW52b2tlIGZvciBhbiBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24uXG5cdCAgICAgKiBAcmV0dXJucyB7QW55fSBSZXN1bHQgcHJvZHVjZWQgYnkgdGhlIG9ic2VydmF0aW9uLlxuXHQgICAgICovXG5cdCAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uIChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgICByZXR1cm4gb2JzZXJ2ZXJPck9uTmV4dCAmJiB0eXBlb2Ygb2JzZXJ2ZXJPck9uTmV4dCA9PT0gJ29iamVjdCcgP1xuXHQgICAgICAgIHRoaXMuX2FjY2VwdE9ic2VydmFibGUob2JzZXJ2ZXJPck9uTmV4dCkgOlxuXHQgICAgICAgIHRoaXMuX2FjY2VwdChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggYSBzaW5nbGUgbm90aWZpY2F0aW9uLlxuXHQgICAgICpcblx0ICAgICAqIEBtZW1iZXJPZiBOb3RpZmljYXRpb25zXG5cdCAgICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHNlbmQgb3V0IHRoZSBub3RpZmljYXRpb24gY2FsbHMgb24uXG5cdCAgICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzdXJmYWNlcyB0aGUgYmVoYXZpb3Igb2YgdGhlIG5vdGlmaWNhdGlvbiB1cG9uIHN1YnNjcmlwdGlvbi5cblx0ICAgICAqL1xuXHQgICAgTm90aWZpY2F0aW9uLnByb3RvdHlwZS50b09ic2VydmFibGUgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG5cdCAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcblx0ICAgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZShzZWxmLCBmdW5jdGlvbiAoXywgbm90aWZpY2F0aW9uKSB7XG5cdCAgICAgICAgICBub3RpZmljYXRpb24uX2FjY2VwdE9ic2VydmFibGUobyk7XG5cdCAgICAgICAgICBub3RpZmljYXRpb24ua2luZCA9PT0gJ04nICYmIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBOb3RpZmljYXRpb247XG5cdCAgfSkoKTtcblx0XG5cdCAgdmFyIE9uTmV4dE5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhPbk5leHROb3RpZmljYXRpb24sIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBPbk5leHROb3RpZmljYXRpb24odmFsdWUpIHtcblx0ICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXHQgICAgICB0aGlzLmtpbmQgPSAnTic7XG5cdCAgICB9XG5cdFxuXHQgICAgT25OZXh0Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0ID0gZnVuY3Rpb24gKG9uTmV4dCkge1xuXHQgICAgICByZXR1cm4gb25OZXh0KHRoaXMudmFsdWUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBPbk5leHROb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHRPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIG8ub25OZXh0KHRoaXMudmFsdWUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBPbk5leHROb3RpZmljYXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gJ09uTmV4dCgnICsgdGhpcy52YWx1ZSArICcpJztcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE9uTmV4dE5vdGlmaWNhdGlvbjtcblx0ICB9KE5vdGlmaWNhdGlvbikpO1xuXHRcblx0ICB2YXIgT25FcnJvck5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhPbkVycm9yTm90aWZpY2F0aW9uLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gT25FcnJvck5vdGlmaWNhdGlvbihlcnJvcikge1xuXHQgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG5cdCAgICAgIHRoaXMua2luZCA9ICdFJztcblx0ICAgIH1cblx0XG5cdCAgICBPbkVycm9yTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0ID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvcikge1xuXHQgICAgICByZXR1cm4gb25FcnJvcih0aGlzLmVycm9yKTtcblx0ICAgIH07XG5cdFxuXHQgICAgT25FcnJvck5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuXHQgICAgfTtcblx0XG5cdCAgICBPbkVycm9yTm90aWZpY2F0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuICdPbkVycm9yKCcgKyB0aGlzLmVycm9yICsgJyknO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gT25FcnJvck5vdGlmaWNhdGlvbjtcblx0ICB9KE5vdGlmaWNhdGlvbikpO1xuXHRcblx0ICB2YXIgT25Db21wbGV0ZWROb3RpZmljYXRpb24gPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoT25Db21wbGV0ZWROb3RpZmljYXRpb24sIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbigpIHtcblx0ICAgICAgdGhpcy5raW5kID0gJ0MnO1xuXHQgICAgfVxuXHRcblx0ICAgIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0ID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcblx0ICAgICAgcmV0dXJuIG9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuICdPbkNvbXBsZXRlZCgpJztcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uO1xuXHQgIH0oTm90aWZpY2F0aW9uKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhbiBPbk5leHQgbm90aWZpY2F0aW9uIHRvIGFuIG9ic2VydmVyLlxuXHQgICAqIEBwYXJhbSB7QW55fSB2YWx1ZSBUaGUgdmFsdWUgY29udGFpbmVkIGluIHRoZSBub3RpZmljYXRpb24uXG5cdCAgICogQHJldHVybnMge05vdGlmaWNhdGlvbn0gVGhlIE9uTmV4dCBub3RpZmljYXRpb24gY29udGFpbmluZyB0aGUgdmFsdWUuXG5cdCAgICovXG5cdCAgdmFyIG5vdGlmaWNhdGlvbkNyZWF0ZU9uTmV4dCA9IE5vdGlmaWNhdGlvbi5jcmVhdGVPbk5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgIHJldHVybiBuZXcgT25OZXh0Tm90aWZpY2F0aW9uKHZhbHVlKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBDcmVhdGVzIGFuIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgYW4gT25FcnJvciBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG5cdCAgICogQHBhcmFtIHtBbnl9IGVycm9yIFRoZSBleGNlcHRpb24gY29udGFpbmVkIGluIHRoZSBub3RpZmljYXRpb24uXG5cdCAgICogQHJldHVybnMge05vdGlmaWNhdGlvbn0gVGhlIE9uRXJyb3Igbm90aWZpY2F0aW9uIGNvbnRhaW5pbmcgdGhlIGV4Y2VwdGlvbi5cblx0ICAgKi9cblx0ICB2YXIgbm90aWZpY2F0aW9uQ3JlYXRlT25FcnJvciA9IE5vdGlmaWNhdGlvbi5jcmVhdGVPbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICByZXR1cm4gbmV3IE9uRXJyb3JOb3RpZmljYXRpb24oZXJyb3IpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhbiBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG5cdCAgICogQHJldHVybnMge05vdGlmaWNhdGlvbn0gVGhlIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbi5cblx0ICAgKi9cblx0ICB2YXIgbm90aWZpY2F0aW9uQ3JlYXRlT25Db21wbGV0ZWQgPSBOb3RpZmljYXRpb24uY3JlYXRlT25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IE9uQ29tcGxldGVkTm90aWZpY2F0aW9uKCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogU3VwcG9ydHMgcHVzaC1zdHlsZSBpdGVyYXRpb24gb3ZlciBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIHZhciBPYnNlcnZlciA9IFJ4Lk9ic2VydmVyID0gZnVuY3Rpb24gKCkgeyB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgQ3JlYXRlcyBhbiBvYnNlcnZlciBmcm9tIHRoZSBzcGVjaWZpZWQgT25OZXh0LCBhbG9uZyB3aXRoIG9wdGlvbmFsIE9uRXJyb3IsIGFuZCBPbkNvbXBsZXRlZCBhY3Rpb25zLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvbk5leHRdIE9ic2VydmVyJ3MgT25OZXh0IGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25FcnJvcl0gT2JzZXJ2ZXIncyBPbkVycm9yIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25Db21wbGV0ZWRdIE9ic2VydmVyJ3MgT25Db21wbGV0ZWQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZlcn0gVGhlIG9ic2VydmVyIG9iamVjdCBpbXBsZW1lbnRlZCB1c2luZyB0aGUgZ2l2ZW4gYWN0aW9ucy5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2ZXJDcmVhdGUgPSBPYnNlcnZlci5jcmVhdGUgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgb25OZXh0IHx8IChvbk5leHQgPSBub29wKTtcblx0ICAgIG9uRXJyb3IgfHwgKG9uRXJyb3IgPSBkZWZhdWx0RXJyb3IpO1xuXHQgICAgb25Db21wbGV0ZWQgfHwgKG9uQ29tcGxldGVkID0gbm9vcCk7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmVyKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIEFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgT2JzZXJ2ZXIgY2xhc3MuXG5cdCAgICogVGhpcyBiYXNlIGNsYXNzIGVuZm9yY2VzIHRoZSBncmFtbWFyIG9mIG9ic2VydmVycyB3aGVyZSBPbkVycm9yIGFuZCBPbkNvbXBsZXRlZCBhcmUgdGVybWluYWwgbWVzc2FnZXMuXG5cdCAgICovXG5cdCAgdmFyIEFic3RyYWN0T2JzZXJ2ZXIgPSBSeC5pbnRlcm5hbHMuQWJzdHJhY3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhBYnN0cmFjdE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ3JlYXRlcyBhIG5ldyBvYnNlcnZlciBpbiBhIG5vbi1zdG9wcGVkIHN0YXRlLlxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBBYnN0cmFjdE9ic2VydmVyKCkge1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIC8vIE11c3QgYmUgaW1wbGVtZW50ZWQgYnkgb3RoZXIgb2JzZXJ2ZXJzXG5cdCAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gbm90SW1wbGVtZW50ZWQ7XG5cdCAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IG5vdEltcGxlbWVudGVkO1xuXHQgICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gbm90SW1wbGVtZW50ZWQ7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBOb3RpZmllcyB0aGUgb2JzZXJ2ZXIgb2YgYSBuZXcgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gdmFsdWUgTmV4dCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAqL1xuXHQgICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICF0aGlzLmlzU3RvcHBlZCAmJiB0aGlzLm5leHQodmFsdWUpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIE5vdGlmaWVzIHRoZSBvYnNlcnZlciB0aGF0IGFuIGV4Y2VwdGlvbiBoYXMgb2NjdXJyZWQuXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gZXJyb3IgVGhlIGVycm9yIHRoYXQgaGFzIG9jY3VycmVkLlxuXHQgICAgICovXG5cdCAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5lcnJvcihlcnJvcik7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBOb3RpZmllcyB0aGUgb2JzZXJ2ZXIgb2YgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgKi9cblx0ICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuY29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBEaXNwb3NlcyB0aGUgb2JzZXJ2ZXIsIGNhdXNpbmcgaXQgdG8gdHJhbnNpdGlvbiB0byB0aGUgc3RvcHBlZCBzdGF0ZS5cblx0ICAgICAqL1xuXHQgICAgQWJzdHJhY3RPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuXHRcblx0ICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZXJyb3IoZSk7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEFic3RyYWN0T2JzZXJ2ZXI7XG5cdCAgfShPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiBDbGFzcyB0byBjcmVhdGUgYW4gT2JzZXJ2ZXIgaW5zdGFuY2UgZnJvbSBkZWxlZ2F0ZS1iYXNlZCBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIG9uKiBtZXRob2RzLlxuXHQgICAqL1xuXHQgIHZhciBBbm9ueW1vdXNPYnNlcnZlciA9IFJ4LkFub255bW91c09ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEFub255bW91c09ic2VydmVyLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ3JlYXRlcyBhbiBvYnNlcnZlciBmcm9tIHRoZSBzcGVjaWZpZWQgT25OZXh0LCBPbkVycm9yLCBhbmQgT25Db21wbGV0ZWQgYWN0aW9ucy5cblx0ICAgICAqIEBwYXJhbSB7QW55fSBvbk5leHQgT2JzZXJ2ZXIncyBPbk5leHQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IG9uRXJyb3IgT2JzZXJ2ZXIncyBPbkVycm9yIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cblx0ICAgICAqIEBwYXJhbSB7QW55fSBvbkNvbXBsZXRlZCBPYnNlcnZlcidzIE9uQ29tcGxldGVkIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gQW5vbnltb3VzT2JzZXJ2ZXIob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5fb25OZXh0ID0gb25OZXh0O1xuXHQgICAgICB0aGlzLl9vbkVycm9yID0gb25FcnJvcjtcblx0ICAgICAgdGhpcy5fb25Db21wbGV0ZWQgPSBvbkNvbXBsZXRlZDtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcblx0ICAgICAqIENhbGxzIHRoZSBvbk5leHQgYWN0aW9uLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IHZhbHVlIE5leHQgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgKi9cblx0ICAgIEFub255bW91c09ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgIHRoaXMuX29uTmV4dCh2YWx1ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ2FsbHMgdGhlIG9uRXJyb3IgYWN0aW9uLlxuXHQgICAgICogQHBhcmFtIHtBbnl9IGVycm9yIFRoZSBlcnJvciB0aGF0IGhhcyBvY2N1cnJlZC5cblx0ICAgICAqL1xuXHQgICAgQW5vbnltb3VzT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgIHRoaXMuX29uRXJyb3IoZXJyb3IpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqICBDYWxscyB0aGUgb25Db21wbGV0ZWQgYWN0aW9uLlxuXHQgICAgICovXG5cdCAgICBBbm9ueW1vdXNPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQW5vbnltb3VzT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIHZhciBvYnNlcnZhYmxlUHJvdG87XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJlcHJlc2VudHMgYSBwdXNoLXN0eWxlIGNvbGxlY3Rpb24uXG5cdCAgICovXG5cdCAgdmFyIE9ic2VydmFibGUgPSBSeC5PYnNlcnZhYmxlID0gKGZ1bmN0aW9uICgpIHtcblx0XG5cdCAgICBmdW5jdGlvbiBtYWtlU3Vic2NyaWJlKHNlbGYsIHN1YnNjcmliZSkge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICB2YXIgb2xkT25FcnJvciA9IG8ub25FcnJvcjtcblx0ICAgICAgICBvLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgICAgbWFrZVN0YWNrVHJhY2VMb25nKGUsIHNlbGYpO1xuXHQgICAgICAgICAgb2xkT25FcnJvci5jYWxsKG8sIGUpO1xuXHQgICAgICAgIH07XG5cdFxuXHQgICAgICAgIHJldHVybiBzdWJzY3JpYmUuY2FsbChzZWxmLCBvKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKCkge1xuXHQgICAgICBpZiAoUnguY29uZmlnLmxvbmdTdGFja1N1cHBvcnQgJiYgaGFzU3RhY2tzKSB7XG5cdCAgICAgICAgdmFyIG9sZFN1YnNjcmliZSA9IHRoaXMuX3N1YnNjcmliZTtcblx0ICAgICAgICB2YXIgZSA9IHRyeUNhdGNoKHRocm93ZXIpKG5ldyBFcnJvcigpKS5lO1xuXHQgICAgICAgIHRoaXMuc3RhY2sgPSBlLnN0YWNrLnN1YnN0cmluZyhlLnN0YWNrLmluZGV4T2YoJ1xcbicpICsgMSk7XG5cdCAgICAgICAgdGhpcy5fc3Vic2NyaWJlID0gbWFrZVN1YnNjcmliZSh0aGlzLCBvbGRTdWJzY3JpYmUpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgb2JzZXJ2YWJsZVByb3RvID0gT2JzZXJ2YWJsZS5wcm90b3R5cGU7XG5cdFxuXHQgICAgLyoqXG5cdCAgICAqIERldGVybWluZXMgd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGFuIE9ic2VydmFibGVcblx0ICAgICogQHBhcmFtIHtBbnl9IEFuIG9iamVjdCB0byBkZXRlcm1pbmUgd2hldGhlciBpdCBpcyBhbiBPYnNlcnZhYmxlXG5cdCAgICAqIEByZXR1cm5zIHtCb29sZWFufSB0cnVlIGlmIGFuIE9ic2VydmFibGUsIGVsc2UgZmFsc2UuXG5cdCAgICAqL1xuXHQgICAgT2JzZXJ2YWJsZS5pc09ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gbyAmJiBpc0Z1bmN0aW9uKG8uc3Vic2NyaWJlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiAgU3Vic2NyaWJlcyBhbiBvIHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAgICogIEBwYXJhbSB7TWl4ZWR9IFtvT3JPbk5leHRdIFRoZSBvYmplY3QgdGhhdCBpcyB0byByZWNlaXZlIG5vdGlmaWNhdGlvbnMgb3IgYW4gYWN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAgICogIEBwYXJhbSB7RnVuY3Rpb259IFtvbkVycm9yXSBBY3Rpb24gdG8gaW52b2tlIHVwb24gZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICAgKiAgQHBhcmFtIHtGdW5jdGlvbn0gW29uQ29tcGxldGVkXSBBY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICAgKiAgQHJldHVybnMge0RpcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG5cdCAgICAgKi9cblx0ICAgIG9ic2VydmFibGVQcm90by5zdWJzY3JpYmUgPSBvYnNlcnZhYmxlUHJvdG8uZm9yRWFjaCA9IGZ1bmN0aW9uIChvT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUodHlwZW9mIG9Pck9uTmV4dCA9PT0gJ29iamVjdCcgP1xuXHQgICAgICAgIG9Pck9uTmV4dCA6XG5cdCAgICAgICAgb2JzZXJ2ZXJDcmVhdGUob09yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkpO1xuXHQgICAgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIFN1YnNjcmliZXMgdG8gdGhlIG5leHQgdmFsdWUgaW4gdGhlIHNlcXVlbmNlIHdpdGggYW4gb3B0aW9uYWwgXCJ0aGlzXCIgYXJndW1lbnQuXG5cdCAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbk5leHQgVGhlIGZ1bmN0aW9uIHRvIGludm9rZSBvbiBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBBIGRpc3Bvc2FibGUgaGFuZGxpbmcgdGhlIHN1YnNjcmlwdGlvbnMgYW5kIHVuc3Vic2NyaXB0aW9ucy5cblx0ICAgICAqL1xuXHQgICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZU9uTmV4dCA9IGZ1bmN0aW9uIChvbk5leHQsIHRoaXNBcmcpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShvYnNlcnZlckNyZWF0ZSh0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbih4KSB7IG9uTmV4dC5jYWxsKHRoaXNBcmcsIHgpOyB9IDogb25OZXh0KSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU3Vic2NyaWJlcyB0byBhbiBleGNlcHRpb25hbCBjb25kaXRpb24gaW4gdGhlIHNlcXVlbmNlIHdpdGggYW4gb3B0aW9uYWwgXCJ0aGlzXCIgYXJndW1lbnQuXG5cdCAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkVycm9yIFRoZSBmdW5jdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IEEgZGlzcG9zYWJsZSBoYW5kbGluZyB0aGUgc3Vic2NyaXB0aW9ucyBhbmQgdW5zdWJzY3JpcHRpb25zLlxuXHQgICAgICovXG5cdCAgICBvYnNlcnZhYmxlUHJvdG8uc3Vic2NyaWJlT25FcnJvciA9IGZ1bmN0aW9uIChvbkVycm9yLCB0aGlzQXJnKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUob2JzZXJ2ZXJDcmVhdGUobnVsbCwgdHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24oZSkgeyBvbkVycm9yLmNhbGwodGhpc0FyZywgZSk7IH0gOiBvbkVycm9yKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogU3Vic2NyaWJlcyB0byB0aGUgbmV4dCB2YWx1ZSBpbiB0aGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBcInRoaXNcIiBhcmd1bWVudC5cblx0ICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uQ29tcGxldGVkIFRoZSBmdW5jdGlvbiB0byBpbnZva2UgdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IEEgZGlzcG9zYWJsZSBoYW5kbGluZyB0aGUgc3Vic2NyaXB0aW9ucyBhbmQgdW5zdWJzY3JpcHRpb25zLlxuXHQgICAgICovXG5cdCAgICBvYnNlcnZhYmxlUHJvdG8uc3Vic2NyaWJlT25Db21wbGV0ZWQgPSBmdW5jdGlvbiAob25Db21wbGV0ZWQsIHRoaXNBcmcpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShvYnNlcnZlckNyZWF0ZShudWxsLCBudWxsLCB0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbigpIHsgb25Db21wbGV0ZWQuY2FsbCh0aGlzQXJnKTsgfSA6IG9uQ29tcGxldGVkKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBPYnNlcnZhYmxlO1xuXHQgIH0pKCk7XG5cdFxuXHQgIHZhciBTY2hlZHVsZWRPYnNlcnZlciA9IFJ4LmludGVybmFscy5TY2hlZHVsZWRPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTY2hlZHVsZWRPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBTY2hlZHVsZWRPYnNlcnZlcihzY2hlZHVsZXIsIG9ic2VydmVyKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgICB0aGlzLmlzQWNxdWlyZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5oYXNGYXVsdGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMucXVldWUgPSBbXTtcblx0ICAgICAgdGhpcy5kaXNwb3NhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblx0ICAgIH1cblx0XG5cdCAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdCAgICAgIHRoaXMucXVldWUucHVzaChmdW5jdGlvbiAoKSB7IHNlbGYub2JzZXJ2ZXIub25OZXh0KHZhbHVlKTsgfSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHZhciBzZWxmID0gdGhpcztcblx0ICAgICAgdGhpcy5xdWV1ZS5wdXNoKGZ1bmN0aW9uICgpIHsgc2VsZi5vYnNlcnZlci5vbkVycm9yKGUpOyB9KTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICB0aGlzLnF1ZXVlLnB1c2goZnVuY3Rpb24gKCkgeyBzZWxmLm9ic2VydmVyLm9uQ29tcGxldGVkKCk7IH0pO1xuXHQgICAgfTtcblx0XG5cdCAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUuZW5zdXJlQWN0aXZlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgaXNPd25lciA9IGZhbHNlO1xuXHQgICAgICBpZiAoIXRoaXMuaGFzRmF1bHRlZCAmJiB0aGlzLnF1ZXVlLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICBpc093bmVyID0gIXRoaXMuaXNBY3F1aXJlZDtcblx0ICAgICAgICB0aGlzLmlzQWNxdWlyZWQgPSB0cnVlO1xuXHQgICAgICB9XG5cdCAgICAgIGlmIChpc093bmVyKSB7XG5cdCAgICAgICAgdGhpcy5kaXNwb3NhYmxlLnNldERpc3Bvc2FibGUodGhpcy5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUodGhpcywgZnVuY3Rpb24gKHBhcmVudCwgc2VsZikge1xuXHQgICAgICAgICAgdmFyIHdvcms7XG5cdCAgICAgICAgICBpZiAocGFyZW50LnF1ZXVlLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICAgICAgd29yayA9IHBhcmVudC5xdWV1ZS5zaGlmdCgpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgcGFyZW50LmlzQWNxdWlyZWQgPSBmYWxzZTtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHdvcmspKCk7XG5cdCAgICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikge1xuXHQgICAgICAgICAgICBwYXJlbnQucXVldWUgPSBbXTtcblx0ICAgICAgICAgICAgcGFyZW50Lmhhc0ZhdWx0ZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICByZXR1cm4gdGhyb3dlcihyZXMuZSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICBzZWxmKHBhcmVudCk7XG5cdCAgICAgICAgfSkpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBfX3N1cGVyX18ucHJvdG90eXBlLmRpc3Bvc2UuY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5kaXNwb3NhYmxlLmRpc3Bvc2UoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNjaGVkdWxlZE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICB2YXIgT2JzZXJ2YWJsZUJhc2UgPSBSeC5PYnNlcnZhYmxlQmFzZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhPYnNlcnZhYmxlQmFzZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBmaXhTdWJzY3JpYmVyKHN1YnNjcmliZXIpIHtcblx0ICAgICAgcmV0dXJuIHN1YnNjcmliZXIgJiYgaXNGdW5jdGlvbihzdWJzY3JpYmVyLmRpc3Bvc2UpID8gc3Vic2NyaWJlciA6XG5cdCAgICAgICAgaXNGdW5jdGlvbihzdWJzY3JpYmVyKSA/IGRpc3Bvc2FibGVDcmVhdGUoc3Vic2NyaWJlcikgOiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2V0RGlzcG9zYWJsZShzLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgYWRvID0gc3RhdGVbMF0sIHNlbGYgPSBzdGF0ZVsxXTtcblx0ICAgICAgdmFyIHN1YiA9IHRyeUNhdGNoKHNlbGYuc3Vic2NyaWJlQ29yZSkuY2FsbChzZWxmLCBhZG8pO1xuXHQgICAgICBpZiAoc3ViID09PSBlcnJvck9iaiAmJiAhYWRvLmZhaWwoZXJyb3JPYmouZSkpIHsgdGhyb3dlcihlcnJvck9iai5lKTsgfVxuXHQgICAgICBhZG8uc2V0RGlzcG9zYWJsZShmaXhTdWJzY3JpYmVyKHN1YikpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIE9ic2VydmFibGVCYXNlKCkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBPYnNlcnZhYmxlQmFzZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBhZG8gPSBuZXcgQXV0b0RldGFjaE9ic2VydmVyKG8pLCBzdGF0ZSA9IFthZG8sIHRoaXNdO1xuXHRcblx0ICAgICAgaWYgKGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZXF1aXJlZCgpKSB7XG5cdCAgICAgICAgY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZSwgc2V0RGlzcG9zYWJsZSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc2V0RGlzcG9zYWJsZShudWxsLCBzdGF0ZSk7XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGFkbztcblx0ICAgIH07XG5cdFxuXHQgICAgT2JzZXJ2YWJsZUJhc2UucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBub3RJbXBsZW1lbnRlZDtcblx0XG5cdCAgICByZXR1cm4gT2JzZXJ2YWJsZUJhc2U7XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHR2YXIgRmxhdE1hcE9ic2VydmFibGUgPSBSeC5GbGF0TWFwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0XG5cdCAgICBpbmhlcml0cyhGbGF0TWFwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBGbGF0TWFwT2JzZXJ2YWJsZShzb3VyY2UsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuXHQgICAgICB0aGlzLnJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihyZXN1bHRTZWxlY3RvcikgPyByZXN1bHRTZWxlY3RvciA6IG51bGw7XG5cdCAgICAgIHRoaXMuc2VsZWN0b3IgPSBiaW5kQ2FsbGJhY2soaXNGdW5jdGlvbihzZWxlY3RvcikgPyBzZWxlY3RvciA6IGZ1bmN0aW9uKCkgeyByZXR1cm4gc2VsZWN0b3I7IH0sIHRoaXNBcmcsIDMpO1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRmxhdE1hcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgdGhpcy5zZWxlY3RvciwgdGhpcy5yZXN1bHRTZWxlY3RvciwgdGhpcykpO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIob2JzZXJ2ZXIsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3Rvciwgc291cmNlKSB7XG5cdCAgICAgIHRoaXMuaSA9IDA7XG5cdCAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3Rvcjtcblx0ICAgICAgdGhpcy5yZXN1bHRTZWxlY3RvciA9IHJlc3VsdFNlbGVjdG9yO1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5vID0gb2JzZXJ2ZXI7XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5fd3JhcFJlc3VsdCA9IGZ1bmN0aW9uKHJlc3VsdCwgeCwgaSkge1xuXHQgICAgICByZXR1cm4gdGhpcy5yZXN1bHRTZWxlY3RvciA/XG5cdCAgICAgICAgcmVzdWx0Lm1hcChmdW5jdGlvbih5LCBpMikgeyByZXR1cm4gdGhpcy5yZXN1bHRTZWxlY3Rvcih4LCB5LCBpLCBpMik7IH0sIHRoaXMpIDpcblx0ICAgICAgICByZXN1bHQ7XG5cdCAgICB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbih4KSB7XG5cdCAgICAgIHZhciBpID0gdGhpcy5pKys7XG5cdCAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLnNlbGVjdG9yKSh4LCBpLCB0aGlzLnNvdXJjZSk7XG5cdCAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihyZXN1bHQuZSk7IH1cblx0XG5cdCAgICAgIGlzUHJvbWlzZShyZXN1bHQpICYmIChyZXN1bHQgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UocmVzdWx0KSk7XG5cdCAgICAgIChpc0FycmF5TGlrZShyZXN1bHQpIHx8IGlzSXRlcmFibGUocmVzdWx0KSkgJiYgKHJlc3VsdCA9IE9ic2VydmFibGUuZnJvbShyZXN1bHQpKTtcblx0ICAgICAgdGhpcy5vLm9uTmV4dCh0aGlzLl93cmFwUmVzdWx0KHJlc3VsdCwgeCwgaSkpO1xuXHQgICAgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uKGUpIHsgdGhpcy5vLm9uRXJyb3IoZSk7IH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbigpIHsgdGhpcy5vLm9uQ29tcGxldGVkKCk7IH07XG5cdFxuXHQgICAgcmV0dXJuIEZsYXRNYXBPYnNlcnZhYmxlO1xuXHRcblx0fShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgRW51bWVyYWJsZSA9IFJ4LmludGVybmFscy5FbnVtZXJhYmxlID0gZnVuY3Rpb24gKCkgeyB9O1xuXHRcblx0ICBmdW5jdGlvbiBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSkge1xuXHQgICAgdGhpcy5fcyA9IHN0YXRlO1xuXHQgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgfVxuXHRcblx0ICBJc0Rpc3Bvc2VkRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgIHRoaXMuX3MuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgdmFyIENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZShzb3VyY2VzKSB7XG5cdCAgICAgIHRoaXMuc291cmNlcyA9IHNvdXJjZXM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIHN0YXRlID0geyBpc0Rpc3Bvc2VkOiBmYWxzZSB9LCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXHQgICAgICB2YXIgY2FuY2VsYWJsZSA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUodGhpcy5zb3VyY2VzWyRpdGVyYXRvciRdKCksIGZ1bmN0aW9uIChlLCBzZWxmKSB7XG5cdCAgICAgICAgaWYgKHN0YXRlLmlzRGlzcG9zZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdmFyIGN1cnJlbnRJdGVtID0gdHJ5Q2F0Y2goZS5uZXh0KS5jYWxsKGUpO1xuXHQgICAgICAgIGlmIChjdXJyZW50SXRlbSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihjdXJyZW50SXRlbS5lKTsgfVxuXHRcblx0ICAgICAgICBpZiAoY3VycmVudEl0ZW0uZG9uZSkge1xuXHQgICAgICAgICAgcmV0dXJuIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vIENoZWNrIGlmIHByb21pc2Vcblx0ICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gY3VycmVudEl0ZW0udmFsdWU7XG5cdCAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblx0XG5cdCAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgICBkLnNldERpc3Bvc2FibGUoY3VycmVudFZhbHVlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCBzZWxmLCBlKSkpO1xuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoW3N1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSwgbmV3IElzRGlzcG9zZWREaXNwb3NhYmxlKHN0YXRlKV0pO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgcywgZSkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcyA9IHM7XG5cdCAgICAgIHRoaXMuX2UgPSBlO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLl9vLm9uTmV4dCh4KTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fcyh0aGlzLl9lKTsgfTtcblx0XG5cdCAgICByZXR1cm4gQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICBFbnVtZXJhYmxlLnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IENvbmNhdEVudW1lcmFibGVPYnNlcnZhYmxlKHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBDYXRjaEVycm9yT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENhdGNoRXJyb3JPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ2F0Y2hFcnJvck9ic2VydmFibGUoc291cmNlcykge1xuXHQgICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBDYXRjaEVycm9yT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBlID0gdGhpcy5zb3VyY2VzWyRpdGVyYXRvciRdKCk7XG5cdFxuXHQgICAgICB2YXIgc3RhdGUgPSB7IGlzRGlzcG9zZWQ6IGZhbHNlIH0sIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cdCAgICAgIHZhciBjYW5jZWxhYmxlID0gY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZShudWxsLCBmdW5jdGlvbiAobGFzdEV4Y2VwdGlvbiwgc2VsZikge1xuXHQgICAgICAgIGlmIChzdGF0ZS5pc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHZhciBjdXJyZW50SXRlbSA9IHRyeUNhdGNoKGUubmV4dCkuY2FsbChlKTtcblx0ICAgICAgICBpZiAoY3VycmVudEl0ZW0gPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IoY3VycmVudEl0ZW0uZSk7IH1cblx0XG5cdCAgICAgICAgaWYgKGN1cnJlbnRJdGVtLmRvbmUpIHtcblx0ICAgICAgICAgIHJldHVybiBsYXN0RXhjZXB0aW9uICE9PSBudWxsID8gby5vbkVycm9yKGxhc3RFeGNlcHRpb24pIDogby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gQ2hlY2sgaWYgcHJvbWlzZVxuXHQgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcblx0ICAgICAgICBpc1Byb21pc2UoY3VycmVudFZhbHVlKSAmJiAoY3VycmVudFZhbHVlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGN1cnJlbnRWYWx1ZSkpO1xuXHRcblx0ICAgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICAgIGQuc2V0RGlzcG9zYWJsZShjdXJyZW50VmFsdWUuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHNlbGYpKSk7XG5cdCAgICAgIH0pO1xuXHQgICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIG5ldyBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSldKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHJlY3Vyc2UpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3JlY3Vyc2UgPSByZWN1cnNlO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KHgpOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9yZWN1cnNlKGUpOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cdFxuXHQgICAgcmV0dXJuIENhdGNoRXJyb3JPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgRW51bWVyYWJsZS5wcm90b3R5cGUuY2F0Y2hFcnJvciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgQ2F0Y2hFcnJvck9ic2VydmFibGUodGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgRW51bWVyYWJsZS5wcm90b3R5cGUuY2F0Y2hFcnJvcldoZW4gPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uSGFuZGxlcikge1xuXHQgICAgdmFyIHNvdXJjZXMgPSB0aGlzO1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBleGNlcHRpb25zID0gbmV3IFN1YmplY3QoKSxcblx0ICAgICAgICBub3RpZmllciA9IG5ldyBTdWJqZWN0KCksXG5cdCAgICAgICAgaGFuZGxlZCA9IG5vdGlmaWNhdGlvbkhhbmRsZXIoZXhjZXB0aW9ucyksXG5cdCAgICAgICAgbm90aWZpY2F0aW9uRGlzcG9zYWJsZSA9IGhhbmRsZWQuc3Vic2NyaWJlKG5vdGlmaWVyKTtcblx0XG5cdCAgICAgIHZhciBlID0gc291cmNlc1skaXRlcmF0b3IkXSgpO1xuXHRcblx0ICAgICAgdmFyIHN0YXRlID0geyBpc0Rpc3Bvc2VkOiBmYWxzZSB9LFxuXHQgICAgICAgIGxhc3RFeGNlcHRpb24sXG5cdCAgICAgICAgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblx0ICAgICAgdmFyIGNhbmNlbGFibGUgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKG51bGwsIGZ1bmN0aW9uIChfLCBzZWxmKSB7XG5cdCAgICAgICAgaWYgKHN0YXRlLmlzRGlzcG9zZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdmFyIGN1cnJlbnRJdGVtID0gdHJ5Q2F0Y2goZS5uZXh0KS5jYWxsKGUpO1xuXHQgICAgICAgIGlmIChjdXJyZW50SXRlbSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihjdXJyZW50SXRlbS5lKTsgfVxuXHRcblx0ICAgICAgICBpZiAoY3VycmVudEl0ZW0uZG9uZSkge1xuXHQgICAgICAgICAgaWYgKGxhc3RFeGNlcHRpb24pIHtcblx0ICAgICAgICAgICAgby5vbkVycm9yKGxhc3RFeGNlcHRpb24pO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gQ2hlY2sgaWYgcHJvbWlzZVxuXHQgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcblx0ICAgICAgICBpc1Byb21pc2UoY3VycmVudFZhbHVlKSAmJiAoY3VycmVudFZhbHVlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGN1cnJlbnRWYWx1ZSkpO1xuXHRcblx0ICAgICAgICB2YXIgb3V0ZXIgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICB2YXIgaW5uZXIgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShuZXcgQmluYXJ5RGlzcG9zYWJsZShpbm5lciwgb3V0ZXIpKTtcblx0ICAgICAgICBvdXRlci5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUoXG5cdCAgICAgICAgICBmdW5jdGlvbih4KSB7IG8ub25OZXh0KHgpOyB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKGV4bikge1xuXHQgICAgICAgICAgICBpbm5lci5zZXREaXNwb3NhYmxlKG5vdGlmaWVyLnN1YnNjcmliZShzZWxmLCBmdW5jdGlvbihleCkge1xuXHQgICAgICAgICAgICAgIG8ub25FcnJvcihleCk7XG5cdCAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgICAgfSkpO1xuXHRcblx0ICAgICAgICAgICAgZXhjZXB0aW9ucy5vbk5leHQoZXhuKTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBmdW5jdGlvbigpIHsgby5vbkNvbXBsZXRlZCgpOyB9KSk7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShbbm90aWZpY2F0aW9uRGlzcG9zYWJsZSwgc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlLCBuZXcgSXNEaXNwb3NlZERpc3Bvc2FibGUoc3RhdGUpXSk7XG5cdCAgICB9KTtcblx0ICB9O1xuXHRcblx0ICB2YXIgUmVwZWF0RW51bWVyYWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhSZXBlYXRFbnVtZXJhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFJlcGVhdEVudW1lcmFibGUodiwgYykge1xuXHQgICAgICB0aGlzLnYgPSB2O1xuXHQgICAgICB0aGlzLmMgPSBjID09IG51bGwgPyAtMSA6IGM7XG5cdCAgICB9XG5cdCAgICBSZXBlYXRFbnVtZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBSZXBlYXRFbnVtZXJhdG9yKHRoaXMpO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBSZXBlYXRFbnVtZXJhdG9yKHApIHtcblx0ICAgICAgdGhpcy52ID0gcC52O1xuXHQgICAgICB0aGlzLmwgPSBwLmM7XG5cdCAgICB9XG5cdCAgICBSZXBlYXRFbnVtZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAodGhpcy5sID09PSAwKSB7IHJldHVybiBkb25lRW51bWVyYXRvcjsgfVxuXHQgICAgICBpZiAodGhpcy5sID4gMCkgeyB0aGlzLmwtLTsgfVxuXHQgICAgICByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMudiB9O1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUmVwZWF0RW51bWVyYWJsZTtcblx0ICB9KEVudW1lcmFibGUpKTtcblx0XG5cdCAgdmFyIGVudW1lcmFibGVSZXBlYXQgPSBFbnVtZXJhYmxlLnJlcGVhdCA9IGZ1bmN0aW9uICh2YWx1ZSwgcmVwZWF0Q291bnQpIHtcblx0ICAgIHJldHVybiBuZXcgUmVwZWF0RW51bWVyYWJsZSh2YWx1ZSwgcmVwZWF0Q291bnQpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBPZkVudW1lcmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhPZkVudW1lcmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBPZkVudW1lcmFibGUocywgZm4sIHRoaXNBcmcpIHtcblx0ICAgICAgdGhpcy5zID0gcztcblx0ICAgICAgdGhpcy5mbiA9IGZuID8gYmluZENhbGxiYWNrKGZuLCB0aGlzQXJnLCAzKSA6IG51bGw7XG5cdCAgICB9XG5cdCAgICBPZkVudW1lcmFibGUucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gbmV3IE9mRW51bWVyYXRvcih0aGlzKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gT2ZFbnVtZXJhdG9yKHApIHtcblx0ICAgICAgdGhpcy5pID0gLTE7XG5cdCAgICAgIHRoaXMucyA9IHAucztcblx0ICAgICAgdGhpcy5sID0gdGhpcy5zLmxlbmd0aDtcblx0ICAgICAgdGhpcy5mbiA9IHAuZm47XG5cdCAgICB9XG5cdCAgICBPZkVudW1lcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgcmV0dXJuICsrdGhpcy5pIDwgdGhpcy5sID9cblx0ICAgICAgIHsgZG9uZTogZmFsc2UsIHZhbHVlOiAhdGhpcy5mbiA/IHRoaXMuc1t0aGlzLmldIDogdGhpcy5mbih0aGlzLnNbdGhpcy5pXSwgdGhpcy5pLCB0aGlzLnMpIH0gOlxuXHQgICAgICAgZG9uZUVudW1lcmF0b3I7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBPZkVudW1lcmFibGU7XG5cdCAgfShFbnVtZXJhYmxlKSk7XG5cdFxuXHQgIHZhciBlbnVtZXJhYmxlT2YgPSBFbnVtZXJhYmxlLm9mID0gZnVuY3Rpb24gKHNvdXJjZSwgc2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0ICAgIHJldHVybiBuZXcgT2ZFbnVtZXJhYmxlKHNvdXJjZSwgc2VsZWN0b3IsIHRoaXNBcmcpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBUb0FycmF5T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRvQXJyYXlPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVG9BcnJheU9ic2VydmFibGUoc291cmNlKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUb0FycmF5T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMuYSA9IFtdO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdCAgICBcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLmEucHVzaCh4KTsgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5vLm9uRXJyb3IoZSk7ICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLm8ub25OZXh0KHRoaXMuYSk7IHRoaXMuby5vbkNvbXBsZXRlZCgpOyB9O1xuXHRcblx0ICAgIHJldHVybiBUb0FycmF5T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogQ3JlYXRlcyBhbiBhcnJheSBmcm9tIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIGEgc2luZ2xlIGVsZW1lbnQgd2l0aCBhIGxpc3QgY29udGFpbmluZyBhbGwgdGhlIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udG9BcnJheSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgVG9BcnJheU9ic2VydmFibGUodGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBmcm9tIGEgc3BlY2lmaWVkIHN1YnNjcmliZSBtZXRob2QgaW1wbGVtZW50YXRpb24uXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuY3JlYXRlKGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB9ICk7XG5cdCAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmNyZWF0ZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHsgcmV0dXJuIFJ4LkRpc3Bvc2FibGUuZW1wdHk7IH0gKTtcblx0ICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuY3JlYXRlKGZ1bmN0aW9uIChvYnNlcnZlcikgeyB9ICk7XG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gc3Vic2NyaWJlIEltcGxlbWVudGF0aW9uIG9mIHRoZSByZXN1bHRpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSdzIHN1YnNjcmliZSBtZXRob2QsIHJldHVybmluZyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSB3cmFwcGVkIGluIGEgRGlzcG9zYWJsZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCB0aGUgc3BlY2lmaWVkIGltcGxlbWVudGF0aW9uIGZvciB0aGUgU3Vic2NyaWJlIG1ldGhvZC5cblx0ICAgKi9cblx0ICBPYnNlcnZhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmUsIHBhcmVudCkge1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKHN1YnNjcmliZSwgcGFyZW50KTtcblx0ICB9O1xuXHRcblx0ICB2YXIgRGVmZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhEZWZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIERlZmVyKGZhY3RvcnkpIHtcblx0ICAgICAgdGhpcy5fZiA9IGZhY3Rvcnk7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIERlZmVyLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuX2YpKCk7XG5cdCAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7IHJldHVybiBvYnNlcnZhYmxlVGhyb3cocmVzdWx0LmUpLnN1YnNjcmliZShvKTt9XG5cdCAgICAgIGlzUHJvbWlzZShyZXN1bHQpICYmIChyZXN1bHQgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UocmVzdWx0KSk7XG5cdCAgICAgIHJldHVybiByZXN1bHQuc3Vic2NyaWJlKG8pO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRGVmZXI7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaW52b2tlcyB0aGUgc3BlY2lmaWVkIGZhY3RvcnkgZnVuY3Rpb24gd2hlbmV2ZXIgYSBuZXcgb2JzZXJ2ZXIgc3Vic2NyaWJlcy5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmRlZmVyKGZ1bmN0aW9uICgpIHsgcmV0dXJuIFJ4Lk9ic2VydmFibGUuZnJvbUFycmF5KFsxLDIsM10pOyB9KTtcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvYnNlcnZhYmxlRmFjdG9yeSBPYnNlcnZhYmxlIGZhY3RvcnkgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIG9ic2VydmVyIHRoYXQgc3Vic2NyaWJlcyB0byB0aGUgcmVzdWx0aW5nIHNlcXVlbmNlIG9yIFByb21pc2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2Ugb2JzZXJ2ZXJzIHRyaWdnZXIgYW4gaW52b2NhdGlvbiBvZiB0aGUgZ2l2ZW4gb2JzZXJ2YWJsZSBmYWN0b3J5IGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlRGVmZXIgPSBPYnNlcnZhYmxlLmRlZmVyID0gZnVuY3Rpb24gKG9ic2VydmFibGVGYWN0b3J5KSB7XG5cdCAgICByZXR1cm4gbmV3IERlZmVyKG9ic2VydmFibGVGYWN0b3J5KTtcblx0ICB9O1xuXHRcblx0ICB2YXIgRW1wdHlPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoRW1wdHlPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRW1wdHlPYnNlcnZhYmxlKHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRW1wdHlPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IEVtcHR5U2luayhvYnNlcnZlciwgdGhpcy5zY2hlZHVsZXIpO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gRW1wdHlTaW5rKG9ic2VydmVyLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzY2hlZHVsZUl0ZW0ocywgc3RhdGUpIHtcblx0ICAgICAgc3RhdGUub25Db21wbGV0ZWQoKTtcblx0ICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgIH1cblx0XG5cdCAgICBFbXB0eVNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIHN0YXRlID0gdGhpcy5vYnNlcnZlcjtcblx0ICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVyID09PSBpbW1lZGlhdGVTY2hlZHVsZXIgP1xuXHQgICAgICAgIHNjaGVkdWxlSXRlbShudWxsLCBzdGF0ZSkgOlxuXHQgICAgICAgIHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKHN0YXRlLCBzY2hlZHVsZUl0ZW0pO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRW1wdHlPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIEVNUFRZX09CU0VSVkFCTEUgPSBuZXcgRW1wdHlPYnNlcnZhYmxlKGltbWVkaWF0ZVNjaGVkdWxlcik7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGFuIGVtcHR5IG9ic2VydmFibGUgc2VxdWVuY2UsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IHRoZSBzaW5nbGUgT25Db21wbGV0ZWQgbWVzc2FnZS5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmVtcHR5KCk7XG5cdCAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmVtcHR5KFJ4LlNjaGVkdWxlci50aW1lb3V0KTtcblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHNlbmQgdGhlIHRlcm1pbmF0aW9uIGNhbGwgb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCBubyBlbGVtZW50cy5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZUVtcHR5ID0gT2JzZXJ2YWJsZS5lbXB0eSA9IGZ1bmN0aW9uIChzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gc2NoZWR1bGVyID09PSBpbW1lZGlhdGVTY2hlZHVsZXIgPyBFTVBUWV9PQlNFUlZBQkxFIDogbmV3IEVtcHR5T2JzZXJ2YWJsZShzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBGcm9tT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEZyb21PYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRnJvbU9ic2VydmFibGUoaXRlcmFibGUsIG1hcHBlciwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMuaXRlcmFibGUgPSBpdGVyYWJsZTtcblx0ICAgICAgdGhpcy5tYXBwZXIgPSBtYXBwZXI7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBGcm9tT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBzaW5rID0gbmV3IEZyb21TaW5rKG8sIHRoaXMpO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEZyb21PYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIEZyb21TaW5rID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIEZyb21TaW5rKG8sIHBhcmVudCkge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICAgIH1cblx0XG5cdCAgICBGcm9tU2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgbGlzdCA9IE9iamVjdCh0aGlzLnBhcmVudC5pdGVyYWJsZSksXG5cdCAgICAgICAgICBpdCA9IGdldEl0ZXJhYmxlKGxpc3QpLFxuXHQgICAgICAgICAgbyA9IHRoaXMubyxcblx0ICAgICAgICAgIG1hcHBlciA9IHRoaXMucGFyZW50Lm1hcHBlcjtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGxvb3BSZWN1cnNpdmUoaSwgcmVjdXJzZSkge1xuXHQgICAgICAgIHZhciBuZXh0ID0gdHJ5Q2F0Y2goaXQubmV4dCkuY2FsbChpdCk7XG5cdCAgICAgICAgaWYgKG5leHQgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IobmV4dC5lKTsgfVxuXHQgICAgICAgIGlmIChuZXh0LmRvbmUpIHsgcmV0dXJuIG8ub25Db21wbGV0ZWQoKTsgfVxuXHRcblx0ICAgICAgICB2YXIgcmVzdWx0ID0gbmV4dC52YWx1ZTtcblx0XG5cdCAgICAgICAgaWYgKGlzRnVuY3Rpb24obWFwcGVyKSkge1xuXHQgICAgICAgICAgcmVzdWx0ID0gdHJ5Q2F0Y2gobWFwcGVyKShyZXN1bHQsIGkpO1xuXHQgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXN1bHQuZSk7IH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIG8ub25OZXh0KHJlc3VsdCk7XG5cdCAgICAgICAgcmVjdXJzZShpICsgMSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBGcm9tU2luaztcblx0ICB9KCkpO1xuXHRcblx0ICB2YXIgbWF4U2FmZUludGVnZXIgPSBNYXRoLnBvdygyLCA1MykgLSAxO1xuXHRcblx0ICBmdW5jdGlvbiBTdHJpbmdJdGVyYWJsZShzKSB7XG5cdCAgICB0aGlzLl9zID0gcztcblx0ICB9XG5cdFxuXHQgIFN0cmluZ0l0ZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgU3RyaW5nSXRlcmF0b3IodGhpcy5fcyk7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gU3RyaW5nSXRlcmF0b3Iocykge1xuXHQgICAgdGhpcy5fcyA9IHM7XG5cdCAgICB0aGlzLl9sID0gcy5sZW5ndGg7XG5cdCAgICB0aGlzLl9pID0gMDtcblx0ICB9XG5cdFxuXHQgIFN0cmluZ0l0ZXJhdG9yLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzO1xuXHQgIH07XG5cdFxuXHQgIFN0cmluZ0l0ZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIHRoaXMuX2kgPCB0aGlzLl9sID8geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMuX3MuY2hhckF0KHRoaXMuX2krKykgfSA6IGRvbmVFbnVtZXJhdG9yO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIEFycmF5SXRlcmFibGUoYSkge1xuXHQgICAgdGhpcy5fYSA9IGE7XG5cdCAgfVxuXHRcblx0ICBBcnJheUl0ZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgQXJyYXlJdGVyYXRvcih0aGlzLl9hKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBBcnJheUl0ZXJhdG9yKGEpIHtcblx0ICAgIHRoaXMuX2EgPSBhO1xuXHQgICAgdGhpcy5fbCA9IHRvTGVuZ3RoKGEpO1xuXHQgICAgdGhpcy5faSA9IDA7XG5cdCAgfVxuXHRcblx0ICBBcnJheUl0ZXJhdG9yLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzO1xuXHQgIH07XG5cdFxuXHQgIEFycmF5SXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcy5faSA8IHRoaXMuX2wgPyB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogdGhpcy5fYVt0aGlzLl9pKytdIH0gOiBkb25lRW51bWVyYXRvcjtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBudW1iZXJJc0Zpbml0ZSh2YWx1ZSkge1xuXHQgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgcm9vdC5pc0Zpbml0ZSh2YWx1ZSk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBpc05hbihuKSB7XG5cdCAgICByZXR1cm4gbiAhPT0gbjtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGdldEl0ZXJhYmxlKG8pIHtcblx0ICAgIHZhciBpID0gb1skaXRlcmF0b3IkXSwgaXQ7XG5cdCAgICBpZiAoIWkgJiYgdHlwZW9mIG8gPT09ICdzdHJpbmcnKSB7XG5cdCAgICAgIGl0ID0gbmV3IFN0cmluZ0l0ZXJhYmxlKG8pO1xuXHQgICAgICByZXR1cm4gaXRbJGl0ZXJhdG9yJF0oKTtcblx0ICAgIH1cblx0ICAgIGlmICghaSAmJiBvLmxlbmd0aCAhPT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgIGl0ID0gbmV3IEFycmF5SXRlcmFibGUobyk7XG5cdCAgICAgIHJldHVybiBpdFskaXRlcmF0b3IkXSgpO1xuXHQgICAgfVxuXHQgICAgaWYgKCFpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ09iamVjdCBpcyBub3QgaXRlcmFibGUnKTsgfVxuXHQgICAgcmV0dXJuIG9bJGl0ZXJhdG9yJF0oKTtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIHNpZ24odmFsdWUpIHtcblx0ICAgIHZhciBudW1iZXIgPSArdmFsdWU7XG5cdCAgICBpZiAobnVtYmVyID09PSAwKSB7IHJldHVybiBudW1iZXI7IH1cblx0ICAgIGlmIChpc05hTihudW1iZXIpKSB7IHJldHVybiBudW1iZXI7IH1cblx0ICAgIHJldHVybiBudW1iZXIgPCAwID8gLTEgOiAxO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gdG9MZW5ndGgobykge1xuXHQgICAgdmFyIGxlbiA9ICtvLmxlbmd0aDtcblx0ICAgIGlmIChpc05hTihsZW4pKSB7IHJldHVybiAwOyB9XG5cdCAgICBpZiAobGVuID09PSAwIHx8ICFudW1iZXJJc0Zpbml0ZShsZW4pKSB7IHJldHVybiBsZW47IH1cblx0ICAgIGxlbiA9IHNpZ24obGVuKSAqIE1hdGguZmxvb3IoTWF0aC5hYnMobGVuKSk7XG5cdCAgICBpZiAobGVuIDw9IDApIHsgcmV0dXJuIDA7IH1cblx0ICAgIGlmIChsZW4gPiBtYXhTYWZlSW50ZWdlcikgeyByZXR1cm4gbWF4U2FmZUludGVnZXI7IH1cblx0ICAgIHJldHVybiBsZW47XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAqIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgT2JzZXJ2YWJsZSBzZXF1ZW5jZSBmcm9tIGFuIGFycmF5LWxpa2Ugb3IgaXRlcmFibGUgb2JqZWN0LlxuXHQgICogQHBhcmFtIHtBbnl9IGFycmF5TGlrZSBBbiBhcnJheS1saWtlIG9yIGl0ZXJhYmxlIG9iamVjdCB0byBjb252ZXJ0IHRvIGFuIE9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbbWFwRm5dIE1hcCBmdW5jdGlvbiB0byBjYWxsIG9uIGV2ZXJ5IGVsZW1lbnQgb2YgdGhlIGFycmF5LlxuXHQgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBUaGUgY29udGV4dCB0byB1c2UgY2FsbGluZyB0aGUgbWFwRm4gaWYgcHJvdmlkZWQuXG5cdCAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gT3B0aW9uYWwgc2NoZWR1bGVyIHRvIHVzZSBmb3Igc2NoZWR1bGluZy4gIElmIG5vdCBwcm92aWRlZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmN1cnJlbnRUaHJlYWQuXG5cdCAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZUZyb20gPSBPYnNlcnZhYmxlLmZyb20gPSBmdW5jdGlvbiAoaXRlcmFibGUsIG1hcEZuLCB0aGlzQXJnLCBzY2hlZHVsZXIpIHtcblx0ICAgIGlmIChpdGVyYWJsZSA9PSBudWxsKSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcignaXRlcmFibGUgY2Fubm90IGJlIG51bGwuJylcblx0ICAgIH1cblx0ICAgIGlmIChtYXBGbiAmJiAhaXNGdW5jdGlvbihtYXBGbikpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdtYXBGbiB3aGVuIHByb3ZpZGVkIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXHQgICAgfVxuXHQgICAgaWYgKG1hcEZuKSB7XG5cdCAgICAgIHZhciBtYXBwZXIgPSBiaW5kQ2FsbGJhY2sobWFwRm4sIHRoaXNBcmcsIDIpO1xuXHQgICAgfVxuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IEZyb21PYnNlcnZhYmxlKGl0ZXJhYmxlLCBtYXBwZXIsIHNjaGVkdWxlcik7XG5cdCAgfVxuXHRcblx0ICB2YXIgRnJvbUFycmF5T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEZyb21BcnJheU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIHNjaGVkdWxlcikge1xuXHQgICAgICB0aGlzLmFyZ3MgPSBhcmdzO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRnJvbUFycmF5T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBGcm9tQXJyYXlTaW5rKG9ic2VydmVyLCB0aGlzKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBGcm9tQXJyYXlPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgZnVuY3Rpb24gRnJvbUFycmF5U2luayhvYnNlcnZlciwgcGFyZW50KSB7XG5cdCAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICB9XG5cdFxuXHQgIGZ1bmN0aW9uIGxvb3BSZWN1cnNpdmUoYXJncywgb2JzZXJ2ZXIpIHtcblx0ICAgIHZhciBsZW4gPSBhcmdzLmxlbmd0aDtcblx0ICAgIHJldHVybiBmdW5jdGlvbiBsb29wIChpLCByZWN1cnNlKSB7XG5cdCAgICAgIGlmIChpIDwgbGVuKSB7XG5cdCAgICAgICAgb2JzZXJ2ZXIub25OZXh0KGFyZ3NbaV0pO1xuXHQgICAgICAgIHJlY3Vyc2UoaSArIDEpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgfVxuXHRcblx0ICBGcm9tQXJyYXlTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gdGhpcy5wYXJlbnQuc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKDAsIGxvb3BSZWN1cnNpdmUodGhpcy5wYXJlbnQuYXJncywgdGhpcy5vYnNlcnZlcikpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICogIENvbnZlcnRzIGFuIGFycmF5IHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UsIHVzaW5nIGFuIG9wdGlvbmFsIHNjaGVkdWxlciB0byBlbnVtZXJhdGUgdGhlIGFycmF5LlxuXHQgICogQGRlcHJlY2F0ZWQgdXNlIE9ic2VydmFibGUuZnJvbSBvciBPYnNlcnZhYmxlLm9mXG5cdCAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZW51bWVyYXRpb24gb2YgdGhlIGlucHV0IHNlcXVlbmNlIG9uLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSBwdWxsZWQgZnJvbSB0aGUgZ2l2ZW4gZW51bWVyYWJsZSBzZXF1ZW5jZS5cblx0ICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlRnJvbUFycmF5ID0gT2JzZXJ2YWJsZS5mcm9tQXJyYXkgPSBmdW5jdGlvbiAoYXJyYXksIHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IEZyb21BcnJheU9ic2VydmFibGUoYXJyYXksIHNjaGVkdWxlcilcblx0ICB9O1xuXHRcblx0ICB2YXIgTmV2ZXJPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTmV2ZXJPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gTmV2ZXJPYnNlcnZhYmxlKCkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBOZXZlck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE5ldmVyT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBORVZFUl9PQlNFUlZBQkxFID0gbmV3IE5ldmVyT2JzZXJ2YWJsZSgpO1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGEgbm9uLXRlcm1pbmF0aW5nIG9ic2VydmFibGUgc2VxdWVuY2UsIHdoaWNoIGNhbiBiZSB1c2VkIHRvIGRlbm90ZSBhbiBpbmZpbml0ZSBkdXJhdGlvbiAoZS5nLiB3aGVuIHVzaW5nIHJlYWN0aXZlIGpvaW5zKS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBvYnNlcnZlcnMgd2lsbCBuZXZlciBnZXQgY2FsbGVkLlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlTmV2ZXIgPSBPYnNlcnZhYmxlLm5ldmVyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIE5FVkVSX09CU0VSVkFCTEU7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gb2JzZXJ2YWJsZU9mIChzY2hlZHVsZXIsIGFycmF5KSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgRnJvbUFycmF5T2JzZXJ2YWJsZShhcnJheSwgc2NoZWR1bGVyKTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICogIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgT2JzZXJ2YWJsZSBpbnN0YW5jZSB3aXRoIGEgdmFyaWFibGUgbnVtYmVyIG9mIGFyZ3VtZW50cywgcmVnYXJkbGVzcyBvZiBudW1iZXIgb3IgdHlwZSBvZiB0aGUgYXJndW1lbnRzLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSBwdWxsZWQgZnJvbSB0aGUgZ2l2ZW4gYXJndW1lbnRzLlxuXHQgICovXG5cdCAgT2JzZXJ2YWJsZS5vZiA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICogIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgT2JzZXJ2YWJsZSBpbnN0YW5jZSB3aXRoIGEgdmFyaWFibGUgbnVtYmVyIG9mIGFyZ3VtZW50cywgcmVnYXJkbGVzcyBvZiBudW1iZXIgb3IgdHlwZSBvZiB0aGUgYXJndW1lbnRzLlxuXHQgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBBIHNjaGVkdWxlciB0byB1c2UgZm9yIHNjaGVkdWxpbmcgdGhlIGFyZ3VtZW50cy5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgcHVsbGVkIGZyb20gdGhlIGdpdmVuIGFyZ3VtZW50cy5cblx0ICAqL1xuXHQgIE9ic2VydmFibGUub2ZXaXRoU2NoZWR1bGVyID0gZnVuY3Rpb24gKHNjaGVkdWxlcikge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0gMSk7XG5cdCAgICBmb3IodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHJldHVybiBuZXcgRnJvbUFycmF5T2JzZXJ2YWJsZShhcmdzLCBzY2hlZHVsZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBQYWlyc09ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhQYWlyc09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBQYWlyc09ic2VydmFibGUob2JqLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5vYmogPSBvYmo7XG5cdCAgICAgIHRoaXMua2V5cyA9IE9iamVjdC5rZXlzKG9iaik7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBQYWlyc09ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgUGFpcnNTaW5rKG9ic2VydmVyLCB0aGlzKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBQYWlyc09ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICBmdW5jdGlvbiBQYWlyc1Npbmsob2JzZXJ2ZXIsIHBhcmVudCkge1xuXHQgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgfVxuXHRcblx0ICBQYWlyc1NpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBvYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXIsIG9iaiA9IHRoaXMucGFyZW50Lm9iaiwga2V5cyA9IHRoaXMucGFyZW50LmtleXMsIGxlbiA9IGtleXMubGVuZ3RoO1xuXHQgICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShpLCByZWN1cnNlKSB7XG5cdCAgICAgIGlmIChpIDwgbGVuKSB7XG5cdCAgICAgICAgdmFyIGtleSA9IGtleXNbaV07XG5cdCAgICAgICAgb2JzZXJ2ZXIub25OZXh0KFtrZXksIG9ialtrZXldXSk7XG5cdCAgICAgICAgcmVjdXJzZShpICsgMSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ29udmVydCBhbiBvYmplY3QgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIFtrZXksIHZhbHVlXSBwYWlycy5cblx0ICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZW51bWVyYXRpb24gb2YgdGhlIGlucHV0IHNlcXVlbmNlIG9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIFtrZXksIHZhbHVlXSBwYWlycyBmcm9tIHRoZSBvYmplY3QuXG5cdCAgICovXG5cdCAgT2JzZXJ2YWJsZS5wYWlycyA9IGZ1bmN0aW9uIChvYmosIHNjaGVkdWxlcikge1xuXHQgICAgc2NoZWR1bGVyIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgUGFpcnNPYnNlcnZhYmxlKG9iaiwgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICAgIHZhciBSYW5nZU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhSYW5nZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBSYW5nZU9ic2VydmFibGUoc3RhcnQsIGNvdW50LCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5zdGFydCA9IHN0YXJ0O1xuXHQgICAgICB0aGlzLnJhbmdlQ291bnQgPSBjb3VudDtcblx0ICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFJhbmdlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBSYW5nZVNpbmsob2JzZXJ2ZXIsIHRoaXMpO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFJhbmdlT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBSYW5nZVNpbmsgPSAoZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gUmFuZ2VTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcblx0ICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuXHQgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKHN0YXJ0LCBjb3VudCwgb2JzZXJ2ZXIpIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uIGxvb3AgKGksIHJlY3Vyc2UpIHtcblx0ICAgICAgICBpZiAoaSA8IGNvdW50KSB7XG5cdCAgICAgICAgICBvYnNlcnZlci5vbk5leHQoc3RhcnQgKyBpKTtcblx0ICAgICAgICAgIHJlY3Vyc2UoaSArIDEpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBSYW5nZVNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZShcblx0ICAgICAgICAwLFxuXHQgICAgICAgIGxvb3BSZWN1cnNpdmUodGhpcy5wYXJlbnQuc3RhcnQsIHRoaXMucGFyZW50LnJhbmdlQ291bnQsIHRoaXMub2JzZXJ2ZXIpXG5cdCAgICAgICk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBSYW5nZVNpbms7XG5cdCAgfSgpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgR2VuZXJhdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2YgaW50ZWdyYWwgbnVtYmVycyB3aXRoaW4gYSBzcGVjaWZpZWQgcmFuZ2UsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IG9ic2VydmVyIG1lc3NhZ2VzLlxuXHQgICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0IFRoZSB2YWx1ZSBvZiB0aGUgZmlyc3QgaW50ZWdlciBpbiB0aGUgc2VxdWVuY2UuXG5cdCAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBzZXF1ZW50aWFsIGludGVnZXJzIHRvIGdlbmVyYXRlLlxuXHQgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIGdlbmVyYXRvciBsb29wIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuY3VycmVudFRocmVhZC5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgYSByYW5nZSBvZiBzZXF1ZW50aWFsIGludGVncmFsIG51bWJlcnMuXG5cdCAgKi9cblx0ICBPYnNlcnZhYmxlLnJhbmdlID0gZnVuY3Rpb24gKHN0YXJ0LCBjb3VudCwgc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgUmFuZ2VPYnNlcnZhYmxlKHN0YXJ0LCBjb3VudCwgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgUmVwZWF0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFJlcGVhdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBSZXBlYXRPYnNlcnZhYmxlKHZhbHVlLCByZXBlYXRDb3VudCwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0ICAgICAgdGhpcy5yZXBlYXRDb3VudCA9IHJlcGVhdENvdW50ID09IG51bGwgPyAtMSA6IHJlcGVhdENvdW50O1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgUmVwZWF0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgc2luayA9IG5ldyBSZXBlYXRTaW5rKG9ic2VydmVyLCB0aGlzKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBSZXBlYXRPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgZnVuY3Rpb24gUmVwZWF0U2luayhvYnNlcnZlciwgcGFyZW50KSB7XG5cdCAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICB9XG5cdFxuXHQgIFJlcGVhdFNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBvYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXIsIHZhbHVlID0gdGhpcy5wYXJlbnQudmFsdWU7XG5cdCAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGksIHJlY3Vyc2UpIHtcblx0ICAgICAgaWYgKGkgPT09IC0xIHx8IGkgPiAwKSB7XG5cdCAgICAgICAgb2JzZXJ2ZXIub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICBpID4gMCAmJiBpLS07XG5cdCAgICAgIH1cblx0ICAgICAgaWYgKGkgPT09IDApIHsgcmV0dXJuIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7IH1cblx0ICAgICAgcmVjdXJzZShpKTtcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gdGhpcy5wYXJlbnQuc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKHRoaXMucGFyZW50LnJlcGVhdENvdW50LCBsb29wUmVjdXJzaXZlKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgR2VuZXJhdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCByZXBlYXRzIHRoZSBnaXZlbiBlbGVtZW50IHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCBvYnNlcnZlciBtZXNzYWdlcy5cblx0ICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBFbGVtZW50IHRvIHJlcGVhdC5cblx0ICAgKiBAcGFyYW0ge051bWJlcn0gcmVwZWF0Q291bnQgW09wdGlvbmFdIE51bWJlciBvZiB0aW1lcyB0byByZXBlYXQgdGhlIGVsZW1lbnQuIElmIG5vdCBzcGVjaWZpZWQsIHJlcGVhdHMgaW5kZWZpbml0ZWx5LlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBzY2hlZHVsZXIgU2NoZWR1bGVyIHRvIHJ1biB0aGUgcHJvZHVjZXIgbG9vcCBvbi4gSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmltbWVkaWF0ZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHJlcGVhdHMgdGhlIGdpdmVuIGVsZW1lbnQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG5cdCAgICovXG5cdCAgT2JzZXJ2YWJsZS5yZXBlYXQgPSBmdW5jdGlvbiAodmFsdWUsIHJlcGVhdENvdW50LCBzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBSZXBlYXRPYnNlcnZhYmxlKHZhbHVlLCByZXBlYXRDb3VudCwgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgSnVzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhKdXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEp1c3RPYnNlcnZhYmxlKHZhbHVlLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgSnVzdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgSnVzdFNpbmsob2JzZXJ2ZXIsIHRoaXMudmFsdWUsIHRoaXMuc2NoZWR1bGVyKTtcblx0ICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIEp1c3RTaW5rKG9ic2VydmVyLCB2YWx1ZSwgc2NoZWR1bGVyKSB7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzY2hlZHVsZUl0ZW0ocywgc3RhdGUpIHtcblx0ICAgICAgdmFyIHZhbHVlID0gc3RhdGVbMF0sIG9ic2VydmVyID0gc3RhdGVbMV07XG5cdCAgICAgIG9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICB9XG5cdFxuXHQgICAgSnVzdFNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIHN0YXRlID0gW3RoaXMudmFsdWUsIHRoaXMub2JzZXJ2ZXJdO1xuXHQgICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZXIgPT09IGltbWVkaWF0ZVNjaGVkdWxlciA/XG5cdCAgICAgICAgc2NoZWR1bGVJdGVtKG51bGwsIHN0YXRlKSA6XG5cdCAgICAgICAgdGhpcy5zY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNjaGVkdWxlSXRlbSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBKdXN0T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyBhIHNpbmdsZSBlbGVtZW50LCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCBvYnNlcnZlciBtZXNzYWdlcy5cblx0ICAgKiAgVGhlcmUgaXMgYW4gYWxpYXMgY2FsbGVkICdqdXN0JyBvciBicm93c2VycyA8SUU5LlxuXHQgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFNpbmdsZSBlbGVtZW50IGluIHRoZSByZXN1bHRpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIFNjaGVkdWxlciB0byBzZW5kIHRoZSBzaW5nbGUgZWxlbWVudCBvbi4gSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmltbWVkaWF0ZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBzaW5nbGUgc3BlY2lmaWVkIGVsZW1lbnQuXG5cdCAgICovXG5cdCAgdmFyIG9ic2VydmFibGVSZXR1cm4gPSBPYnNlcnZhYmxlWydyZXR1cm4nXSA9IE9ic2VydmFibGUuanVzdCA9IGZ1bmN0aW9uICh2YWx1ZSwgc2NoZWR1bGVyKSB7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXIpO1xuXHQgICAgcmV0dXJuIG5ldyBKdXN0T2JzZXJ2YWJsZSh2YWx1ZSwgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgVGhyb3dPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGhyb3dPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVGhyb3dPYnNlcnZhYmxlKGVycm9yLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXHQgICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGhyb3dPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgVGhyb3dTaW5rKG8sIHRoaXMpO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gVGhyb3dTaW5rKG8sIHApIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5wID0gcDtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzY2hlZHVsZUl0ZW0ocywgc3RhdGUpIHtcblx0ICAgICAgdmFyIGUgPSBzdGF0ZVswXSwgbyA9IHN0YXRlWzFdO1xuXHQgICAgICBvLm9uRXJyb3IoZSk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGhyb3dTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnAuc2NoZWR1bGVyLnNjaGVkdWxlKFt0aGlzLnAuZXJyb3IsIHRoaXMub10sIHNjaGVkdWxlSXRlbSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBUaHJvd09ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgdGVybWluYXRlcyB3aXRoIGFuIGV4Y2VwdGlvbiwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgdGhlIHNpbmdsZSBvbkVycm9yIG1lc3NhZ2UuXG5cdCAgICogIFRoZXJlIGlzIGFuIGFsaWFzIHRvIHRoaXMgbWV0aG9kIGNhbGxlZCAndGhyb3dFcnJvcicgZm9yIGJyb3dzZXJzIDxJRTkuXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgQW4gb2JqZWN0IHVzZWQgZm9yIHRoZSBzZXF1ZW5jZSdzIHRlcm1pbmF0aW9uLlxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBzY2hlZHVsZXIgU2NoZWR1bGVyIHRvIHNlbmQgdGhlIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIGNhbGwgb24uIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5pbW1lZGlhdGUuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgdGVybWluYXRlcyBleGNlcHRpb25hbGx5IHdpdGggdGhlIHNwZWNpZmllZCBleGNlcHRpb24gb2JqZWN0LlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlVGhyb3cgPSBPYnNlcnZhYmxlWyd0aHJvdyddID0gZnVuY3Rpb24gKGVycm9yLCBzY2hlZHVsZXIpIHtcblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IFRocm93T2JzZXJ2YWJsZShlcnJvciwgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgQ2F0Y2hPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENhdGNoT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENhdGNoT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9mbiA9IGZuO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBDYXRjaE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgZDEgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblx0ICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoZDEpO1xuXHQgICAgICBkMS5zZXREaXNwb3NhYmxlKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgQ2F0Y2hPYnNlcnZlcihvLCBzdWJzY3JpcHRpb24sIHRoaXMuX2ZuKSkpO1xuXHQgICAgICByZXR1cm4gc3Vic2NyaXB0aW9uO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQ2F0Y2hPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIENhdGNoT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDYXRjaE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ2F0Y2hPYnNlcnZlcihvLCBzLCBmbikge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcyA9IHM7XG5cdCAgICAgIHRoaXMuX2ZuID0gZm47XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIENhdGNoT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLl9vLm9uTmV4dCh4KTsgfTtcblx0ICAgIENhdGNoT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblx0ICAgIENhdGNoT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuX2ZuKShlKTtcblx0ICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcihyZXN1bHQuZSk7IH1cblx0ICAgICAgaXNQcm9taXNlKHJlc3VsdCkgJiYgKHJlc3VsdCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShyZXN1bHQpKTtcblx0XG5cdCAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHRoaXMuX3Muc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgZC5zZXREaXNwb3NhYmxlKHJlc3VsdC5zdWJzY3JpYmUodGhpcy5fbykpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gQ2F0Y2hPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ29udGludWVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0ZXJtaW5hdGVkIGJ5IGFuIGV4Y2VwdGlvbiB3aXRoIHRoZSBuZXh0IG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gaGFuZGxlck9yU2Vjb25kIEV4Y2VwdGlvbiBoYW5kbGVyIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGdpdmVuIHRoZSBlcnJvciB0aGF0IG9jY3VycmVkIGluIHRoZSBmaXJzdCBzZXF1ZW5jZSwgb3IgYSBzZWNvbmQgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1c2VkIHRvIHByb2R1Y2UgcmVzdWx0cyB3aGVuIGFuIGVycm9yIG9jY3VycmVkIGluIHRoZSBmaXJzdCBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBmaXJzdCBzZXF1ZW5jZSdzIGVsZW1lbnRzLCBmb2xsb3dlZCBieSB0aGUgZWxlbWVudHMgb2YgdGhlIGhhbmRsZXIgc2VxdWVuY2UgaW4gY2FzZSBhbiBleGNlcHRpb24gb2NjdXJyZWQuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvWydjYXRjaCddID0gZnVuY3Rpb24gKGhhbmRsZXJPclNlY29uZCkge1xuXHQgICAgcmV0dXJuIGlzRnVuY3Rpb24oaGFuZGxlck9yU2Vjb25kKSA/IG5ldyBDYXRjaE9ic2VydmFibGUodGhpcywgaGFuZGxlck9yU2Vjb25kKSA6IG9ic2VydmFibGVDYXRjaChbdGhpcywgaGFuZGxlck9yU2Vjb25kXSk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogQ29udGludWVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0ZXJtaW5hdGVkIGJ5IGFuIGV4Y2VwdGlvbiB3aXRoIHRoZSBuZXh0IG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHBhcmFtIHtBcnJheSB8IEFyZ3VtZW50c30gYXJncyBBcmd1bWVudHMgb3IgYW4gYXJyYXkgdG8gdXNlIGFzIHRoZSBuZXh0IHNlcXVlbmNlIGlmIGFuIGVycm9yIG9jY3Vycy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIGVsZW1lbnRzIGZyb20gY29uc2VjdXRpdmUgc291cmNlIHNlcXVlbmNlcyB1bnRpbCBhIHNvdXJjZSBzZXF1ZW5jZSB0ZXJtaW5hdGVzIHN1Y2Nlc3NmdWxseS5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZUNhdGNoID0gT2JzZXJ2YWJsZVsnY2F0Y2gnXSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBpdGVtcztcblx0ICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3VtZW50c1swXSkpIHtcblx0ICAgICAgaXRlbXMgPSBhcmd1bWVudHNbMF07XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcblx0ICAgICAgaXRlbXMgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGl0ZW1zW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICB9XG5cdCAgICByZXR1cm4gZW51bWVyYWJsZU9mKGl0ZW1zKS5jYXRjaEVycm9yKCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYW55IG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBQcm9taXNlcyBwcm9kdWNlcyBhbiBlbGVtZW50LlxuXHQgICAqIFRoaXMgY2FuIGJlIGluIHRoZSBmb3JtIG9mIGFuIGFyZ3VtZW50IGxpc3Qgb2Ygb2JzZXJ2YWJsZXMgb3IgYW4gYXJyYXkuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIDEgLSBvYnMgPSBvYnNlcnZhYmxlLmNvbWJpbmVMYXRlc3Qob2JzMSwgb2JzMiwgb2JzMywgZnVuY3Rpb24gKG8xLCBvMiwgbzMpIHsgcmV0dXJuIG8xICsgbzIgKyBvMzsgfSk7XG5cdCAgICogMiAtIG9icyA9IG9ic2VydmFibGUuY29tYmluZUxhdGVzdChbb2JzMSwgb2JzMiwgb2JzM10sIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmNvbWJpbmVMYXRlc3QgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NbMF0pKSB7XG5cdCAgICAgIGFyZ3NbMF0udW5zaGlmdCh0aGlzKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGFyZ3MudW5zaGlmdCh0aGlzKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBjb21iaW5lTGF0ZXN0LmFwcGx5KHRoaXMsIGFyZ3MpO1xuXHQgIH07XG5cdFxuXHQgIGZ1bmN0aW9uIGZhbHNlRmFjdG9yeSgpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdCAgZnVuY3Rpb24gYXJndW1lbnRzVG9BcnJheSgpIHtcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgcmV0dXJuIGFyZ3M7XG5cdCAgfVxuXHRcblx0ICB2YXIgQ29tYmluZUxhdGVzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlKHBhcmFtcywgY2IpIHtcblx0ICAgICAgdGhpcy5fcGFyYW1zID0gcGFyYW1zO1xuXHQgICAgICB0aGlzLl9jYiA9IGNiO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBDb21iaW5lTGF0ZXN0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBsZW4gPSB0aGlzLl9wYXJhbXMubGVuZ3RoLFxuXHQgICAgICAgICAgc3Vic2NyaXB0aW9ucyA9IG5ldyBBcnJheShsZW4pO1xuXHRcblx0ICAgICAgdmFyIHN0YXRlID0ge1xuXHQgICAgICAgIGhhc1ZhbHVlOiBhcnJheUluaXRpYWxpemUobGVuLCBmYWxzZUZhY3RvcnkpLFxuXHQgICAgICAgIGhhc1ZhbHVlQWxsOiBmYWxzZSxcblx0ICAgICAgICBpc0RvbmU6IGFycmF5SW5pdGlhbGl6ZShsZW4sIGZhbHNlRmFjdG9yeSksXG5cdCAgICAgICAgdmFsdWVzOiBuZXcgQXJyYXkobGVuKVxuXHQgICAgICB9O1xuXHRcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLl9wYXJhbXNbaV0sIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgIHN1YnNjcmlwdGlvbnNbaV0gPSBzYWQ7XG5cdCAgICAgICAgaXNQcm9taXNlKHNvdXJjZSkgJiYgKHNvdXJjZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShzb3VyY2UpKTtcblx0ICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKG5ldyBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIob2JzZXJ2ZXIsIGksIHRoaXMuX2NiLCBzdGF0ZSkpKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb25zKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIENvbWJpbmVMYXRlc3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIobywgaSwgY2IsIHN0YXRlKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9pID0gaTtcblx0ICAgICAgdGhpcy5fY2IgPSBjYjtcblx0ICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gbm90VGhlU2FtZShpKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAoeCwgaikge1xuXHQgICAgICAgIHJldHVybiBqICE9PSBpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIENvbWJpbmVMYXRlc3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMuX3N0YXRlLnZhbHVlc1t0aGlzLl9pXSA9IHg7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmhhc1ZhbHVlW3RoaXMuX2ldID0gdHJ1ZTtcblx0ICAgICAgaWYgKHRoaXMuX3N0YXRlLmhhc1ZhbHVlQWxsIHx8ICh0aGlzLl9zdGF0ZS5oYXNWYWx1ZUFsbCA9IHRoaXMuX3N0YXRlLmhhc1ZhbHVlLmV2ZXJ5KGlkZW50aXR5KSkpIHtcblx0ICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5fY2IpLmFwcGx5KG51bGwsIHRoaXMuX3N0YXRlLnZhbHVlcyk7XG5cdCAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgICB0aGlzLl9vLm9uTmV4dChyZXMpO1xuXHQgICAgICB9IGVsc2UgaWYgKHRoaXMuX3N0YXRlLmlzRG9uZS5maWx0ZXIobm90VGhlU2FtZSh0aGlzLl9pKSkuZXZlcnkoaWRlbnRpdHkpKSB7XG5cdCAgICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIENvbWJpbmVMYXRlc3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIENvbWJpbmVMYXRlc3RPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9zdGF0ZS5pc0RvbmVbdGhpcy5faV0gPSB0cnVlO1xuXHQgICAgICB0aGlzLl9zdGF0ZS5pc0RvbmUuZXZlcnkoaWRlbnRpdHkpICYmIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIENvbWJpbmVMYXRlc3RPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbnkgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIG9yIFByb21pc2VzIHByb2R1Y2VzIGFuIGVsZW1lbnQuXG5cdCAgKlxuXHQgICogQGV4YW1wbGVcblx0ICAqIDEgLSBvYnMgPSBSeC5PYnNlcnZhYmxlLmNvbWJpbmVMYXRlc3Qob2JzMSwgb2JzMiwgb2JzMywgZnVuY3Rpb24gKG8xLCBvMiwgbzMpIHsgcmV0dXJuIG8xICsgbzIgKyBvMzsgfSk7XG5cdCAgKiAyIC0gb2JzID0gUnguT2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0KFtvYnMxLCBvYnMyLCBvYnMzXSwgZnVuY3Rpb24gKG8xLCBvMiwgbzMpIHsgcmV0dXJuIG8xICsgbzIgKyBvMzsgfSk7XG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICovXG5cdCAgdmFyIGNvbWJpbmVMYXRlc3QgPSBPYnNlcnZhYmxlLmNvbWJpbmVMYXRlc3QgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHZhciByZXN1bHRTZWxlY3RvciA9IGlzRnVuY3Rpb24oYXJnc1tsZW4gLSAxXSkgPyBhcmdzLnBvcCgpIDogYXJndW1lbnRzVG9BcnJheTtcblx0ICAgIEFycmF5LmlzQXJyYXkoYXJnc1swXSkgJiYgKGFyZ3MgPSBhcmdzWzBdKTtcblx0ICAgIHJldHVybiBuZXcgQ29tYmluZUxhdGVzdE9ic2VydmFibGUoYXJncywgcmVzdWx0U2VsZWN0b3IpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIENvbmNhdGVuYXRlcyBhbGwgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzLiAgVGhpcyB0YWtlcyBpbiBlaXRoZXIgYW4gYXJyYXkgb3IgdmFyaWFibGUgYXJndW1lbnRzIHRvIGNvbmNhdGVuYXRlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGVhY2ggZ2l2ZW4gc2VxdWVuY2UsIGluIHNlcXVlbnRpYWwgb3JkZXIuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmNvbmNhdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGZvcih2YXIgYXJncyA9IFtdLCBpID0gMCwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3MucHVzaChhcmd1bWVudHNbaV0pOyB9XG5cdCAgICBhcmdzLnVuc2hpZnQodGhpcyk7XG5cdCAgICByZXR1cm4gb2JzZXJ2YWJsZUNvbmNhdC5hcHBseShudWxsLCBhcmdzKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgQ29uY2F0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENvbmNhdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBDb25jYXRPYnNlcnZhYmxlKHNvdXJjZXMpIHtcblx0ICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlcztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgQ29uY2F0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgdmFyIHNpbmsgPSBuZXcgQ29uY2F0U2luayh0aGlzLnNvdXJjZXMsIG8pO1xuXHQgICAgICByZXR1cm4gc2luay5ydW4oKTtcblx0ICAgIH07XG5cdFxuXHQgICAgZnVuY3Rpb24gQ29uY2F0U2luayhzb3VyY2VzLCBvKSB7XG5cdCAgICAgIHRoaXMuc291cmNlcyA9IHNvdXJjZXM7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICB9XG5cdCAgICBDb25jYXRTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciBpc0Rpc3Bvc2VkLCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLCBzb3VyY2VzID0gdGhpcy5zb3VyY2VzLCBsZW5ndGggPSBzb3VyY2VzLmxlbmd0aCwgbyA9IHRoaXMubztcblx0ICAgICAgdmFyIGNhbmNlbGFibGUgPSBpbW1lZGlhdGVTY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgZnVuY3Rpb24gKGksIHNlbGYpIHtcblx0ICAgICAgICBpZiAoaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICBpZiAoaSA9PT0gbGVuZ3RoKSB7XG5cdCAgICAgICAgICByZXR1cm4gby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLy8gQ2hlY2sgaWYgcHJvbWlzZVxuXHQgICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBzb3VyY2VzW2ldO1xuXHQgICAgICAgIGlzUHJvbWlzZShjdXJyZW50VmFsdWUpICYmIChjdXJyZW50VmFsdWUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoY3VycmVudFZhbHVlKSk7XG5cdFxuXHQgICAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgICAgZC5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUoXG5cdCAgICAgICAgICBmdW5jdGlvbiAoeCkgeyBvLm9uTmV4dCh4KTsgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uICgpIHsgc2VsZihpICsgMSk7IH1cblx0ICAgICAgICApKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlLCBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgfSkpO1xuXHQgICAgfTtcblx0XG5cdFxuXHQgICAgcmV0dXJuIENvbmNhdE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBDb25jYXRlbmF0ZXMgYWxsIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcy5cblx0ICAgKiBAcGFyYW0ge0FycmF5IHwgQXJndW1lbnRzfSBhcmdzIEFyZ3VtZW50cyBvciBhbiBhcnJheSB0byBjb25jYXQgdG8gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgZWFjaCBnaXZlbiBzZXF1ZW5jZSwgaW4gc2VxdWVudGlhbCBvcmRlci5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZUNvbmNhdCA9IE9ic2VydmFibGUuY29uY2F0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGFyZ3M7XG5cdCAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG5cdCAgICAgIGFyZ3MgPSBhcmd1bWVudHNbMF07XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpO1xuXHQgICAgICBmb3IodmFyIGkgPSAwLCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgfVxuXHQgICAgcmV0dXJuIG5ldyBDb25jYXRPYnNlcnZhYmxlKGFyZ3MpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIENvbmNhdGVuYXRlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIG9ic2VydmFibGUgc2VxdWVuY2VzLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGVhY2ggb2JzZXJ2ZWQgaW5uZXIgc2VxdWVuY2UsIGluIHNlcXVlbnRpYWwgb3JkZXIuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmNvbmNhdEFsbCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzLm1lcmdlKDEpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBNZXJnZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTWVyZ2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIE1lcmdlT2JzZXJ2YWJsZShzb3VyY2UsIG1heENvbmN1cnJlbnQpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMubWF4Q29uY3VycmVudCA9IG1heENvbmN1cnJlbnQ7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIE1lcmdlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBnID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcblx0ICAgICAgZy5hZGQodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNZXJnZU9ic2VydmVyKG9ic2VydmVyLCB0aGlzLm1heENvbmN1cnJlbnQsIGcpKSk7XG5cdCAgICAgIHJldHVybiBnO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTWVyZ2VPYnNlcnZhYmxlO1xuXHRcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBNZXJnZU9ic2VydmVyID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIE1lcmdlT2JzZXJ2ZXIobywgbWF4LCBnKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMubWF4ID0gbWF4O1xuXHQgICAgICB0aGlzLmcgPSBnO1xuXHQgICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5xID0gW107XG5cdCAgICAgIHRoaXMuYWN0aXZlQ291bnQgPSAwO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHQgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUuaGFuZGxlU3Vic2NyaWJlID0gZnVuY3Rpb24gKHhzKSB7XG5cdCAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgdGhpcy5nLmFkZChzYWQpO1xuXHQgICAgICBpc1Byb21pc2UoeHMpICYmICh4cyA9IG9ic2VydmFibGVGcm9tUHJvbWlzZSh4cykpO1xuXHQgICAgICBzYWQuc2V0RGlzcG9zYWJsZSh4cy5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIodGhpcywgc2FkKSkpO1xuXHQgICAgfTtcblx0ICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uIChpbm5lclNvdXJjZSkge1xuXHQgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgaWYodGhpcy5hY3RpdmVDb3VudCA8IHRoaXMubWF4KSB7XG5cdCAgICAgICAgICB0aGlzLmFjdGl2ZUNvdW50Kys7XG5cdCAgICAgICAgICB0aGlzLmhhbmRsZVN1YnNjcmliZShpbm5lclNvdXJjZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRoaXMucS5wdXNoKGlubmVyU291cmNlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5kb25lID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuYWN0aXZlQ291bnQgPT09IDAgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcblx0ICAgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIocGFyZW50LCBzYWQpIHtcblx0ICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICAgICAgICB0aGlzLnNhZCA9IHNhZDtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7IGlmKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLnBhcmVudC5vLm9uTmV4dCh4KTsgfSB9O1xuXHQgICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgICB0aGlzLnBhcmVudC5vLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXHQgICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcblx0ICAgICAgICAgIHBhcmVudC5nLnJlbW92ZSh0aGlzLnNhZCk7XG5cdCAgICAgICAgICBpZiAocGFyZW50LnEubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgICBwYXJlbnQuaGFuZGxlU3Vic2NyaWJlKHBhcmVudC5xLnNoaWZ0KCkpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgcGFyZW50LmFjdGl2ZUNvdW50LS07XG5cdCAgICAgICAgICAgIHBhcmVudC5kb25lICYmIHBhcmVudC5hY3RpdmVDb3VudCA9PT0gMCAmJiBwYXJlbnQuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cdCAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcblx0ICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9O1xuXHRcblx0ICAgICAgcmV0dXJuIE1lcmdlT2JzZXJ2ZXI7XG5cdCAgfSgpKTtcblx0XG5cdFxuXHRcblx0XG5cdFxuXHQgIC8qKlxuXHQgICogTWVyZ2VzIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLCBsaW1pdGluZyB0aGUgbnVtYmVyIG9mIGNvbmN1cnJlbnQgc3Vic2NyaXB0aW9ucyB0byBpbm5lciBzZXF1ZW5jZXMuXG5cdCAgKiBPciBtZXJnZXMgdHdvIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYSBzaW5nbGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqXG5cdCAgKiBAZXhhbXBsZVxuXHQgICogMSAtIG1lcmdlZCA9IHNvdXJjZXMubWVyZ2UoMSk7XG5cdCAgKiAyIC0gbWVyZ2VkID0gc291cmNlLm1lcmdlKG90aGVyU291cmNlKTtcblx0ICAqIEBwYXJhbSB7TWl4ZWR9IFttYXhDb25jdXJyZW50T3JPdGhlcl0gTWF4aW11bSBudW1iZXIgb2YgaW5uZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgYmVpbmcgc3Vic2NyaWJlZCB0byBjb25jdXJyZW50bHkgb3IgdGhlIHNlY29uZCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgbWVyZ2VzIHRoZSBlbGVtZW50cyBvZiB0aGUgaW5uZXIgc2VxdWVuY2VzLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLm1lcmdlID0gZnVuY3Rpb24gKG1heENvbmN1cnJlbnRPck90aGVyKSB7XG5cdCAgICByZXR1cm4gdHlwZW9mIG1heENvbmN1cnJlbnRPck90aGVyICE9PSAnbnVtYmVyJyA/XG5cdCAgICAgIG9ic2VydmFibGVNZXJnZSh0aGlzLCBtYXhDb25jdXJyZW50T3JPdGhlcikgOlxuXHQgICAgICBuZXcgTWVyZ2VPYnNlcnZhYmxlKHRoaXMsIG1heENvbmN1cnJlbnRPck90aGVyKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBNZXJnZXMgYWxsIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIGEgc2luZ2xlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICogVGhlIHNjaGVkdWxlciBpcyBvcHRpb25hbCBhbmQgaWYgbm90IHNwZWNpZmllZCwgdGhlIGltbWVkaWF0ZSBzY2hlZHVsZXIgaXMgdXNlZC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBtZXJnZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcy5cblx0ICAgKi9cblx0ICB2YXIgb2JzZXJ2YWJsZU1lcmdlID0gT2JzZXJ2YWJsZS5tZXJnZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBzY2hlZHVsZXIsIHNvdXJjZXMgPSBbXSwgaSwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcblx0ICAgIGlmICghYXJndW1lbnRzWzBdKSB7XG5cdCAgICAgIHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcjtcblx0ICAgICAgZm9yKGkgPSAxOyBpIDwgbGVuOyBpKyspIHsgc291cmNlcy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cblx0ICAgIH0gZWxzZSBpZiAoaXNTY2hlZHVsZXIoYXJndW1lbnRzWzBdKSkge1xuXHQgICAgICBzY2hlZHVsZXIgPSBhcmd1bWVudHNbMF07XG5cdCAgICAgIGZvcihpID0gMTsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXI7XG5cdCAgICAgIGZvcihpID0gMDsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG5cdCAgICB9XG5cdCAgICBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2VzWzBdKSkge1xuXHQgICAgICBzb3VyY2VzID0gc291cmNlc1swXTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBvYnNlcnZhYmxlT2Yoc2NoZWR1bGVyLCBzb3VyY2VzKS5tZXJnZUFsbCgpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBDb21wb3NpdGVFcnJvciA9IFJ4LkNvbXBvc2l0ZUVycm9yID0gZnVuY3Rpb24oZXJyb3JzKSB7XG5cdCAgICB0aGlzLmlubmVyRXJyb3JzID0gZXJyb3JzO1xuXHQgICAgdGhpcy5tZXNzYWdlID0gJ1RoaXMgY29udGFpbnMgbXVsdGlwbGUgZXJyb3JzLiBDaGVjayB0aGUgaW5uZXJFcnJvcnMnO1xuXHQgICAgRXJyb3IuY2FsbCh0aGlzKTtcblx0ICB9O1xuXHQgIENvbXBvc2l0ZUVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblx0ICBDb21wb3NpdGVFcnJvci5wcm90b3R5cGUubmFtZSA9ICdDb21wb3NpdGVFcnJvcic7XG5cdFxuXHQgIHZhciBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUoc291cmNlKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGdyb3VwID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKSxcblx0ICAgICAgICBtID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksXG5cdCAgICAgICAgc3RhdGUgPSB7IGlzU3RvcHBlZDogZmFsc2UsIGVycm9yczogW10sIG86IG8gfTtcblx0XG5cdCAgICAgIGdyb3VwLmFkZChtKTtcblx0ICAgICAgbS5zZXREaXNwb3NhYmxlKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIoZ3JvdXAsIHN0YXRlKSkpO1xuXHRcblx0ICAgICAgcmV0dXJuIGdyb3VwO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBNZXJnZURlbGF5RXJyb3JPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE1lcmdlRGVsYXlFcnJvck9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIoZ3JvdXAsIHN0YXRlKSB7XG5cdCAgICAgIHRoaXMuX2dyb3VwID0gZ3JvdXA7XG5cdCAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNldENvbXBsZXRpb24obywgZXJyb3JzKSB7XG5cdCAgICAgIGlmIChlcnJvcnMubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9IGVsc2UgaWYgKGVycm9ycy5sZW5ndGggPT09IDEpIHtcblx0ICAgICAgICBvLm9uRXJyb3IoZXJyb3JzWzBdKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBvLm9uRXJyb3IobmV3IENvbXBvc2l0ZUVycm9yKGVycm9ycykpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB2YXIgaW5uZXIgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgdGhpcy5fZ3JvdXAuYWRkKGlubmVyKTtcblx0XG5cdCAgICAgIC8vIENoZWNrIGZvciBwcm9taXNlcyBzdXBwb3J0XG5cdCAgICAgIGlzUHJvbWlzZSh4KSAmJiAoeCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZSh4KSk7XG5cdCAgICAgIGlubmVyLnNldERpc3Bvc2FibGUoeC5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIoaW5uZXIsIHRoaXMuX2dyb3VwLCB0aGlzLl9zdGF0ZSkpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fc3RhdGUuZXJyb3JzLnB1c2goZSk7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgIHRoaXMuX2dyb3VwLmxlbmd0aCA9PT0gMSAmJiBzZXRDb21wbGV0aW9uKHRoaXMuX3N0YXRlLm8sIHRoaXMuX3N0YXRlLmVycm9ycyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgIHRoaXMuX2dyb3VwLmxlbmd0aCA9PT0gMSAmJiBzZXRDb21wbGV0aW9uKHRoaXMuX3N0YXRlLm8sIHRoaXMuX3N0YXRlLmVycm9ycyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKGlubmVyLCBncm91cCwgc3RhdGUpIHtcblx0ICAgICAgdGhpcy5faW5uZXIgPSBpbm5lcjtcblx0ICAgICAgdGhpcy5fZ3JvdXAgPSBncm91cDtcblx0ICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX3N0YXRlLm8ub25OZXh0KHgpOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9zdGF0ZS5lcnJvcnMucHVzaChlKTtcblx0ICAgICAgdGhpcy5fZ3JvdXAucmVtb3ZlKHRoaXMuX2lubmVyKTtcblx0ICAgICAgdGhpcy5fc3RhdGUuaXNTdG9wcGVkICYmIHRoaXMuX2dyb3VwLmxlbmd0aCA9PT0gMSAmJiBzZXRDb21wbGV0aW9uKHRoaXMuX3N0YXRlLm8sIHRoaXMuX3N0YXRlLmVycm9ycyk7XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9ncm91cC5yZW1vdmUodGhpcy5faW5uZXIpO1xuXHQgICAgICB0aGlzLl9zdGF0ZS5pc1N0b3BwZWQgJiYgdGhpcy5fZ3JvdXAubGVuZ3RoID09PSAxICYmIHNldENvbXBsZXRpb24odGhpcy5fc3RhdGUubywgdGhpcy5fc3RhdGUuZXJyb3JzKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAqIEZsYXR0ZW5zIGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBPYnNlcnZhYmxlcyBpbnRvIG9uZSBPYnNlcnZhYmxlLCBpbiBhIHdheSB0aGF0IGFsbG93cyBhbiBPYnNlcnZlciB0b1xuXHQgICogcmVjZWl2ZSBhbGwgc3VjY2Vzc2Z1bGx5IGVtaXR0ZWQgaXRlbXMgZnJvbSBhbGwgb2YgdGhlIHNvdXJjZSBPYnNlcnZhYmxlcyB3aXRob3V0IGJlaW5nIGludGVycnVwdGVkIGJ5XG5cdCAgKiBhbiBlcnJvciBub3RpZmljYXRpb24gZnJvbSBvbmUgb2YgdGhlbS5cblx0ICAqXG5cdCAgKiBUaGlzIGJlaGF2ZXMgbGlrZSBPYnNlcnZhYmxlLnByb3RvdHlwZS5tZXJnZUFsbCBleGNlcHQgdGhhdCBpZiBhbnkgb2YgdGhlIG1lcmdlZCBPYnNlcnZhYmxlcyBub3RpZnkgb2YgYW5cblx0ICAqIGVycm9yIHZpYSB0aGUgT2JzZXJ2ZXIncyBvbkVycm9yLCBtZXJnZURlbGF5RXJyb3Igd2lsbCByZWZyYWluIGZyb20gcHJvcGFnYXRpbmcgdGhhdFxuXHQgICogZXJyb3Igbm90aWZpY2F0aW9uIHVudGlsIGFsbCBvZiB0aGUgbWVyZ2VkIE9ic2VydmFibGVzIGhhdmUgZmluaXNoZWQgZW1pdHRpbmcgaXRlbXMuXG5cdCAgKiBAcGFyYW0ge0FycmF5IHwgQXJndW1lbnRzfSBhcmdzIEFyZ3VtZW50cyBvciBhbiBhcnJheSB0byBtZXJnZS5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBhbiBPYnNlcnZhYmxlIHRoYXQgZW1pdHMgYWxsIG9mIHRoZSBpdGVtcyBlbWl0dGVkIGJ5IHRoZSBPYnNlcnZhYmxlcyBlbWl0dGVkIGJ5IHRoZSBPYnNlcnZhYmxlXG5cdCAgKi9cblx0ICBPYnNlcnZhYmxlLm1lcmdlRGVsYXlFcnJvciA9IGZ1bmN0aW9uKCkge1xuXHQgICAgdmFyIGFyZ3M7XG5cdCAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG5cdCAgICAgIGFyZ3MgPSBhcmd1bWVudHNbMF07XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcblx0ICAgICAgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgfVxuXHQgICAgdmFyIHNvdXJjZSA9IG9ic2VydmFibGVPZihudWxsLCBhcmdzKTtcblx0ICAgIHJldHVybiBuZXcgTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZShzb3VyY2UpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBNZXJnZUFsbE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTWVyZ2VBbGxPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIE1lcmdlQWxsT2JzZXJ2YWJsZShzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIE1lcmdlQWxsT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuXHQgICAgICB2YXIgZyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCksIG0gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgZy5hZGQobSk7XG5cdCAgICAgIG0uc2V0RGlzcG9zYWJsZSh0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IE1lcmdlQWxsT2JzZXJ2ZXIob2JzZXJ2ZXIsIGcpKSk7XG5cdCAgICAgIHJldHVybiBnO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBNZXJnZUFsbE9ic2VydmVyKG8sIGcpIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5nID0gZztcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG5cdCAgICB9XG5cdCAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbihpbm5lclNvdXJjZSkge1xuXHQgICAgICBpZih0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgdmFyIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICB0aGlzLmcuYWRkKHNhZCk7XG5cdFxuXHQgICAgICBpc1Byb21pc2UoaW5uZXJTb3VyY2UpICYmIChpbm5lclNvdXJjZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShpbm5lclNvdXJjZSkpO1xuXHRcblx0ICAgICAgc2FkLnNldERpc3Bvc2FibGUoaW5uZXJTb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKHRoaXMsIHNhZCkpKTtcblx0ICAgIH07XG5cdCAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgTWVyZ2VBbGxPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZy5sZW5ndGggPT09IDEgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcblx0ICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIocGFyZW50LCBzYWQpIHtcblx0ICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG5cdCAgICAgIHRoaXMuc2FkID0gc2FkO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKHgpIHsgaWYgKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLnBhcmVudC5vLm9uTmV4dCh4KTsgfSB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLnBhcmVudC5vLm9uRXJyb3IoZSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICBwYXJlbnQuZy5yZW1vdmUodGhpcy5zYWQpO1xuXHQgICAgICAgIHBhcmVudC5kb25lICYmIHBhcmVudC5nLmxlbmd0aCA9PT0gMSAmJiBwYXJlbnQuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLnBhcmVudC5vLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE1lcmdlQWxsT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogTWVyZ2VzIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgbWVyZ2VzIHRoZSBlbGVtZW50cyBvZiB0aGUgaW5uZXIgc2VxdWVuY2VzLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLm1lcmdlQWxsID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBNZXJnZUFsbE9ic2VydmFibGUodGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFNraXBVbnRpbE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTa2lwVW50aWxPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIFNraXBVbnRpbE9ic2VydmFibGUoc291cmNlLCBvdGhlcikge1xuXHQgICAgICB0aGlzLl9zID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9vID0gaXNQcm9taXNlKG90aGVyKSA/IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikgOiBvdGhlcjtcblx0ICAgICAgdGhpcy5fb3BlbiA9IGZhbHNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTa2lwVW50aWxPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuXHQgICAgICB2YXIgbGVmdFN1YnNjcmlwdGlvbiA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICBsZWZ0U3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUodGhpcy5fcy5zdWJzY3JpYmUobmV3IFNraXBVbnRpbFNvdXJjZU9ic2VydmVyKG8sIHRoaXMpKSk7XG5cdFxuXHQgICAgICBpc1Byb21pc2UodGhpcy5fbykgJiYgKHRoaXMuX28gPSBvYnNlcnZhYmxlRnJvbVByb21pc2UodGhpcy5fbykpO1xuXHRcblx0ICAgICAgdmFyIHJpZ2h0U3Vic2NyaXB0aW9uID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgIHJpZ2h0U3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUodGhpcy5fby5zdWJzY3JpYmUobmV3IFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIobywgdGhpcywgcmlnaHRTdWJzY3JpcHRpb24pKSk7XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUobGVmdFN1YnNjcmlwdGlvbiwgcmlnaHRTdWJzY3JpcHRpb24pO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2tpcFVudGlsT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBTa2lwVW50aWxTb3VyY2VPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNraXBVbnRpbFNvdXJjZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIobywgcCkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcCA9IHA7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5fcC5fb3BlbiAmJiB0aGlzLl9vLm9uTmV4dCh4KTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZXJyKTtcblx0ICAgIH07XG5cdFxuXHQgICAgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9wLl9vcGVuICYmIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICB2YXIgU2tpcFVudGlsT3RoZXJPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTa2lwVW50aWxPdGhlck9ic2VydmVyKG8sIHAsIHIpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX3AgPSBwO1xuXHQgICAgICB0aGlzLl9yID0gcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2tpcFVudGlsT3RoZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5fcC5fb3BlbiA9IHRydWU7XG5cdCAgICAgIHRoaXMuX3IuZGlzcG9zZSgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTa2lwVW50aWxPdGhlck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGVycik7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9yLmRpc3Bvc2UoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgdGhlIHZhbHVlcyBmcm9tIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvbmx5IGFmdGVyIHRoZSBvdGhlciBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2VzIGEgdmFsdWUuXG5cdCAgICogQHBhcmFtIHtPYnNlcnZhYmxlIHwgUHJvbWlzZX0gb3RoZXIgVGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugb3IgUHJvbWlzZSB0aGF0IHRyaWdnZXJzIHByb3BhZ2F0aW9uIG9mIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZSBzdGFydGluZyBmcm9tIHRoZSBwb2ludCB0aGUgb3RoZXIgc2VxdWVuY2UgdHJpZ2dlcmVkIHByb3BhZ2F0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5za2lwVW50aWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcblx0ICAgIHJldHVybiBuZXcgU2tpcFVudGlsT2JzZXJ2YWJsZSh0aGlzLCBvdGhlcik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFN3aXRjaE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTd2l0Y2hPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU3dpdGNoT2JzZXJ2YWJsZShzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFN3aXRjaE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgaW5uZXIgPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLCBzID0gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBTd2l0Y2hPYnNlcnZlcihvLCBpbm5lcikpO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUocywgaW5uZXIpO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhTd2l0Y2hPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBTd2l0Y2hPYnNlcnZlcihvLCBpbm5lcikge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLmlubmVyID0gaW5uZXI7XG5cdCAgICAgIHRoaXMuc3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmxhdGVzdCA9IDA7XG5cdCAgICAgIHRoaXMuaGFzTGF0ZXN0ID0gZmFsc2U7XG5cdCAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBTd2l0Y2hPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uIChpbm5lclNvdXJjZSkge1xuXHQgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLCBpZCA9ICsrdGhpcy5sYXRlc3Q7XG5cdCAgICAgIHRoaXMuaGFzTGF0ZXN0ID0gdHJ1ZTtcblx0ICAgICAgdGhpcy5pbm5lci5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICBpc1Byb21pc2UoaW5uZXJTb3VyY2UpICYmIChpbm5lclNvdXJjZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShpbm5lclNvdXJjZSkpO1xuXHQgICAgICBkLnNldERpc3Bvc2FibGUoaW5uZXJTb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKHRoaXMsIGlkKSkpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTd2l0Y2hPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgU3dpdGNoT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5zdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgIXRoaXMuaGFzTGF0ZXN0ICYmIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIocGFyZW50LCBpZCkge1xuXHQgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcblx0ICAgICAgdGhpcy5pZCA9IGlkO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5wYXJlbnQubGF0ZXN0ID09PSB0aGlzLmlkICYmIHRoaXMucGFyZW50Lm8ub25OZXh0KHgpO1xuXHQgICAgfTtcblx0XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMucGFyZW50LmxhdGVzdCA9PT0gdGhpcy5pZCAmJiB0aGlzLnBhcmVudC5vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKHRoaXMucGFyZW50LmxhdGVzdCA9PT0gdGhpcy5pZCkge1xuXHQgICAgICAgIHRoaXMucGFyZW50Lmhhc0xhdGVzdCA9IGZhbHNlO1xuXHQgICAgICAgIHRoaXMucGFyZW50LmlzU3RvcHBlZCAmJiB0aGlzLnBhcmVudC5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFN3aXRjaE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAqIFRyYW5zZm9ybXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHZhbHVlcyBvbmx5IGZyb20gdGhlIG1vc3QgcmVjZW50IG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBhdCBhbnkgcG9pbnQgaW4gdGltZSBwcm9kdWNlcyB0aGUgZWxlbWVudHMgb2YgdGhlIG1vc3QgcmVjZW50IGlubmVyIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBoYXMgYmVlbiByZWNlaXZlZC5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90b1snc3dpdGNoJ10gPSBvYnNlcnZhYmxlUHJvdG8uc3dpdGNoTGF0ZXN0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBTd2l0Y2hPYnNlcnZhYmxlKHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBUYWtlVW50aWxPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGFrZVVudGlsT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBUYWtlVW50aWxPYnNlcnZhYmxlKHNvdXJjZSwgb3RoZXIpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMub3RoZXIgPSBpc1Byb21pc2Uob3RoZXIpID8gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKG90aGVyKSA6IG90aGVyO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUYWtlVW50aWxPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG5cdCAgICAgICAgdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG8pLFxuXHQgICAgICAgIHRoaXMub3RoZXIuc3Vic2NyaWJlKG5ldyBUYWtlVW50aWxPYnNlcnZlcihvKSlcblx0ICAgICAgKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFRha2VVbnRpbE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgVGFrZVVudGlsT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUYWtlVW50aWxPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFRha2VVbnRpbE9ic2VydmVyKG8pIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRha2VVbnRpbE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFRha2VVbnRpbE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGVycik7XG5cdCAgICB9O1xuXHRcblx0ICAgIFRha2VVbnRpbE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IG5vb3A7XG5cdFxuXHQgICAgcmV0dXJuIFRha2VVbnRpbE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIHRoZSB2YWx1ZXMgZnJvbSB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdW50aWwgdGhlIG90aGVyIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjZXMgYSB2YWx1ZS5cblx0ICAgKiBAcGFyYW0ge09ic2VydmFibGUgfCBQcm9taXNlfSBvdGhlciBPYnNlcnZhYmxlIHNlcXVlbmNlIG9yIFByb21pc2UgdGhhdCB0ZXJtaW5hdGVzIHByb3BhZ2F0aW9uIG9mIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZSB1cCB0byB0aGUgcG9pbnQgdGhlIG90aGVyIHNlcXVlbmNlIGludGVycnVwdGVkIGZ1cnRoZXIgcHJvcGFnYXRpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRha2VVbnRpbCA9IGZ1bmN0aW9uIChvdGhlcikge1xuXHQgICAgcmV0dXJuIG5ldyBUYWtlVW50aWxPYnNlcnZhYmxlKHRoaXMsIG90aGVyKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuXHQgIGZ1bmN0aW9uIGFyZ3VtZW50c1RvQXJyYXkoKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0ICAgIHJldHVybiBhcmdzO1xuXHQgIH1cblx0XG5cdCAgdmFyIFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZShzb3VyY2UsIHNvdXJjZXMsIHJlc3VsdFNlbGVjdG9yKSB7XG5cdCAgICAgIHRoaXMuX3MgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX3NzID0gc291cmNlcztcblx0ICAgICAgdGhpcy5fY2IgPSByZXN1bHRTZWxlY3Rvcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGxlbiA9IHRoaXMuX3NzLmxlbmd0aDtcblx0ICAgICAgdmFyIHN0YXRlID0ge1xuXHQgICAgICAgIGhhc1ZhbHVlOiBhcnJheUluaXRpYWxpemUobGVuLCBmYWxzZUZhY3RvcnkpLFxuXHQgICAgICAgIGhhc1ZhbHVlQWxsOiBmYWxzZSxcblx0ICAgICAgICB2YWx1ZXM6IG5ldyBBcnJheShsZW4pXG5cdCAgICAgIH07XG5cdFxuXHQgICAgICB2YXIgbiA9IHRoaXMuX3NzLmxlbmd0aCwgc3Vic2NyaXB0aW9ucyA9IG5ldyBBcnJheShuICsgMSk7XG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSB7XG5cdCAgICAgICAgdmFyIG90aGVyID0gdGhpcy5fc3NbaV0sIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICAgIGlzUHJvbWlzZShvdGhlcikgJiYgKG90aGVyID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKG90aGVyKSk7XG5cdCAgICAgICAgc2FkLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG5ldyBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIobywgaSwgc3RhdGUpKSk7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICBzYWQuc2V0RGlzcG9zYWJsZSh0aGlzLl9zLnN1YnNjcmliZShuZXcgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlcihvLCB0aGlzLl9jYiwgc3RhdGUpKSk7XG5cdCAgICAgIHN1YnNjcmlwdGlvbnNbbl0gPSBzYWQ7XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbnMpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIobywgaSwgc3RhdGUpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX2kgPSBpO1xuXHQgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLl9zdGF0ZS52YWx1ZXNbdGhpcy5faV0gPSB4O1xuXHQgICAgICB0aGlzLl9zdGF0ZS5oYXNWYWx1ZVt0aGlzLl9pXSA9IHRydWU7XG5cdCAgICAgIHRoaXMuX3N0YXRlLmhhc1ZhbHVlQWxsID0gdGhpcy5fc3RhdGUuaGFzVmFsdWUuZXZlcnkoaWRlbnRpdHkpO1xuXHQgICAgfTtcblx0XG5cdCAgICBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IG5vb3A7XG5cdFxuXHQgICAgcmV0dXJuIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgdmFyIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIobywgY2IsIHN0YXRlKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9jYiA9IGNiO1xuXHQgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdmFyIGFsbFZhbHVlcyA9IFt4XS5jb25jYXQodGhpcy5fc3RhdGUudmFsdWVzKTtcblx0ICAgICAgaWYgKCF0aGlzLl9zdGF0ZS5oYXNWYWx1ZUFsbCkgeyByZXR1cm47IH1cblx0ICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX2NiKS5hcHBseShudWxsLCBhbGxWYWx1ZXMpO1xuXHQgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICB0aGlzLl9vLm9uTmV4dChyZXMpO1xuXHQgICAgfTtcblx0XG5cdCAgICBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiBvbmx5IHdoZW4gdGhlIChmaXJzdCkgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjZXMgYW4gZWxlbWVudC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by53aXRoTGF0ZXN0RnJvbSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7IHRocm93IG5ldyBFcnJvcignaW52YWxpZCBhcmd1bWVudHMnKTsgfVxuXHRcblx0ICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KGxlbik7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuXHQgICAgQXJyYXkuaXNBcnJheShhcmdzWzBdKSAmJiAoYXJncyA9IGFyZ3NbMF0pO1xuXHRcblx0ICAgIHJldHVybiBuZXcgV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlKHRoaXMsIGFyZ3MsIHJlc3VsdFNlbGVjdG9yKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuXHQgIGZ1bmN0aW9uIGVtcHR5QXJyYXlGYWN0b3J5KCkgeyByZXR1cm4gW107IH1cblx0XG5cdCAgdmFyIFppcE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhaaXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gWmlwT2JzZXJ2YWJsZShzb3VyY2VzLCByZXN1bHRTZWxlY3Rvcikge1xuXHQgICAgICB0aGlzLl9zID0gc291cmNlcztcblx0ICAgICAgdGhpcy5fY2IgPSByZXN1bHRTZWxlY3Rvcjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgWmlwT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBuID0gdGhpcy5fcy5sZW5ndGgsXG5cdCAgICAgICAgICBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KG4pO1xuXHQgICAgICAgICAgZG9uZSA9IGFycmF5SW5pdGlhbGl6ZShuLCBmYWxzZUZhY3RvcnkpLFxuXHQgICAgICAgICAgcSA9IGFycmF5SW5pdGlhbGl6ZShuLCBlbXB0eUFycmF5RmFjdG9yeSk7XG5cdFxuXHQgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47IGkrKykge1xuXHQgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLl9zW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgICBzdWJzY3JpcHRpb25zW2ldID0gc2FkO1xuXHQgICAgICAgIGlzUHJvbWlzZShzb3VyY2UpICYmIChzb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uoc291cmNlKSk7XG5cdCAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShuZXcgWmlwT2JzZXJ2ZXIob2JzZXJ2ZXIsIGksIHRoaXMsIHEsIGRvbmUpKSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBaaXBPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFppcE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFppcE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gWmlwT2JzZXJ2ZXIobywgaSwgcCwgcSwgZCkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5faSA9IGk7XG5cdCAgICAgIHRoaXMuX3AgPSBwO1xuXHQgICAgICB0aGlzLl9xID0gcTtcblx0ICAgICAgdGhpcy5fZCA9IGQ7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIG5vdEVtcHR5KHgpIHsgcmV0dXJuIHgubGVuZ3RoID4gMDsgfVxuXHQgICAgZnVuY3Rpb24gc2hpZnRFYWNoKHgpIHsgcmV0dXJuIHguc2hpZnQoKTsgfVxuXHQgICAgZnVuY3Rpb24gbm90VGhlU2FtZShpKSB7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAoeCwgaikge1xuXHQgICAgICAgIHJldHVybiBqICE9PSBpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXHRcblx0ICAgIFppcE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5fcVt0aGlzLl9pXS5wdXNoKHgpO1xuXHQgICAgICBpZiAodGhpcy5fcS5ldmVyeShub3RFbXB0eSkpIHtcblx0ICAgICAgICB2YXIgcXVldWVkVmFsdWVzID0gdGhpcy5fcS5tYXAoc2hpZnRFYWNoKTtcblx0ICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5fcC5fY2IpLmFwcGx5KG51bGwsIHF1ZXVlZFZhbHVlcyk7XG5cdCAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgICB0aGlzLl9vLm9uTmV4dChyZXMpO1xuXHQgICAgICB9IGVsc2UgaWYgKHRoaXMuX2QuZmlsdGVyKG5vdFRoZVNhbWUodGhpcy5faSkpLmV2ZXJ5KGlkZW50aXR5KSkge1xuXHQgICAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICBaaXBPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFppcE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX2RbdGhpcy5faV0gPSB0cnVlO1xuXHQgICAgICB0aGlzLl9kLmV2ZXJ5KGlkZW50aXR5KSAmJiB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBaaXBPYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYWxsIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBhbiBhcnJheSBoYXZlIHByb2R1Y2VkIGFuIGVsZW1lbnQgYXQgYSBjb3JyZXNwb25kaW5nIGluZGV4LlxuXHQgICAqIFRoZSBsYXN0IGVsZW1lbnQgaW4gdGhlIGFyZ3VtZW50cyBtdXN0IGJlIGEgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIHNlcmllcyBvZiBlbGVtZW50cyBhdCBjb3JyZXNwb25kaW5nIGluZGV4ZXMgaW4gdGhlIGFyZ3MuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgcmVzdWx0IG9mIGNvbWJpbmluZyBlbGVtZW50cyBvZiB0aGUgYXJncyB1c2luZyB0aGUgc3BlY2lmaWVkIHJlc3VsdCBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uemlwID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFyZ3VtZW50cycpOyB9XG5cdFxuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICB2YXIgcmVzdWx0U2VsZWN0b3IgPSBpc0Z1bmN0aW9uKGFyZ3NbbGVuIC0gMV0pID8gYXJncy5wb3AoKSA6IGFyZ3VtZW50c1RvQXJyYXk7XG5cdCAgICBBcnJheS5pc0FycmF5KGFyZ3NbMF0pICYmIChhcmdzID0gYXJnc1swXSk7XG5cdFxuXHQgICAgdmFyIHBhcmVudCA9IHRoaXM7XG5cdCAgICBhcmdzLnVuc2hpZnQocGFyZW50KTtcblx0XG5cdCAgICByZXR1cm4gbmV3IFppcE9ic2VydmFibGUoYXJncywgcmVzdWx0U2VsZWN0b3IpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFsbCBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaGF2ZSBwcm9kdWNlZCBhbiBlbGVtZW50IGF0IGEgY29ycmVzcG9uZGluZyBpbmRleC5cblx0ICAgKiBAcGFyYW0gYXJndW1lbnRzIE9ic2VydmFibGUgc291cmNlcy5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSByZXN1bHRTZWxlY3RvciBGdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggc2VyaWVzIG9mIGVsZW1lbnRzIGF0IGNvcnJlc3BvbmRpbmcgaW5kZXhlcyBpbiB0aGUgc291cmNlcy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIE9ic2VydmFibGUuemlwID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICBpZiAoQXJyYXkuaXNBcnJheShhcmdzWzBdKSkge1xuXHQgICAgICBhcmdzID0gaXNGdW5jdGlvbihhcmdzWzFdKSA/IGFyZ3NbMF0uY29uY2F0KGFyZ3NbMV0pIDogYXJnc1swXTtcblx0ICAgIH1cblx0ICAgIHZhciBmaXJzdCA9IGFyZ3Muc2hpZnQoKTtcblx0ICAgIHJldHVybiBmaXJzdC56aXAuYXBwbHkoZmlyc3QsIGFyZ3MpO1xuXHQgIH07XG5cdFxuXHRmdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuXHRmdW5jdGlvbiBlbXB0eUFycmF5RmFjdG9yeSgpIHsgcmV0dXJuIFtdOyB9XG5cdGZ1bmN0aW9uIGFyZ3VtZW50c1RvQXJyYXkoKSB7XG5cdCAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgIHJldHVybiBhcmdzO1xuXHR9XG5cdFxuXHQvKipcblx0ICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYWxsIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBhbiBhcnJheSBoYXZlIHByb2R1Y2VkIGFuIGVsZW1lbnQgYXQgYSBjb3JyZXNwb25kaW5nIGluZGV4LlxuXHQgKiBUaGUgbGFzdCBlbGVtZW50IGluIHRoZSBhcmd1bWVudHMgbXVzdCBiZSBhIGZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBzZXJpZXMgb2YgZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzIGluIHRoZSBhcmdzLlxuXHQgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBhcmdzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgKi9cblx0b2JzZXJ2YWJsZVByb3RvLnppcEl0ZXJhYmxlID0gZnVuY3Rpb24gKCkge1xuXHQgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7IHRocm93IG5ldyBFcnJvcignaW52YWxpZCBhcmd1bWVudHMnKTsgfVxuXHRcblx0ICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuXHRcblx0ICB2YXIgcGFyZW50ID0gdGhpcztcblx0ICBhcmdzLnVuc2hpZnQocGFyZW50KTtcblx0ICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgIHZhciBuID0gYXJncy5sZW5ndGgsXG5cdCAgICAgIHF1ZXVlcyA9IGFycmF5SW5pdGlhbGl6ZShuLCBlbXB0eUFycmF5RmFjdG9yeSksXG5cdCAgICAgIGlzRG9uZSA9IGFycmF5SW5pdGlhbGl6ZShuLCBmYWxzZUZhY3RvcnkpO1xuXHRcblx0ICAgIHZhciBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KG4pO1xuXHQgICAgZm9yICh2YXIgaWR4ID0gMDsgaWR4IDwgbjsgaWR4KyspIHtcblx0ICAgICAgKGZ1bmN0aW9uIChpKSB7XG5cdCAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3NbaV0sIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHRcblx0ICAgICAgICAoaXNBcnJheUxpa2Uoc291cmNlKSB8fCBpc0l0ZXJhYmxlKHNvdXJjZSkpICYmIChzb3VyY2UgPSBvYnNlcnZhYmxlRnJvbShzb3VyY2UpKTtcblx0XG5cdCAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgICAgcXVldWVzW2ldLnB1c2goeCk7XG5cdCAgICAgICAgICBpZiAocXVldWVzLmV2ZXJ5KGZ1bmN0aW9uICh4KSB7IHJldHVybiB4Lmxlbmd0aCA+IDA7IH0pKSB7XG5cdCAgICAgICAgICAgIHZhciBxdWV1ZWRWYWx1ZXMgPSBxdWV1ZXMubWFwKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnNoaWZ0KCk7IH0pLFxuXHQgICAgICAgICAgICAgICAgcmVzID0gdHJ5Q2F0Y2gocmVzdWx0U2VsZWN0b3IpLmFwcGx5KHBhcmVudCwgcXVldWVkVmFsdWVzKTtcblx0ICAgICAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgICAgICAgby5vbk5leHQocmVzKTtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAoaXNEb25lLmZpbHRlcihmdW5jdGlvbiAoeCwgaikgeyByZXR1cm4gaiAhPT0gaTsgfSkuZXZlcnkoaWRlbnRpdHkpKSB7XG5cdCAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9LCBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIGlzRG9uZVtpXSA9IHRydWU7XG5cdCAgICAgICAgICBpc0RvbmUuZXZlcnkoaWRlbnRpdHkpICYmIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9KSk7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcblx0ICAgICAgfSkoaWR4KTtcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG5cdCAgfSwgcGFyZW50KTtcblx0fTtcblx0XG5cdCAgZnVuY3Rpb24gYXNPYnNlcnZhYmxlKHNvdXJjZSkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIHN1YnNjcmliZShvKSB7IHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG8pOyB9O1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogIEhpZGVzIHRoZSBpZGVudGl0eSBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaGlkZXMgdGhlIGlkZW50aXR5IG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmFzT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShhc09ic2VydmFibGUodGhpcyksIHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlKHNvdXJjZSkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIobykpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRGVtYXRlcmlhbGl6ZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgRGVtYXRlcmlhbGl6ZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKERlbWF0ZXJpYWxpemVPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIobykge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgRGVtYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgeC5hY2NlcHQodGhpcy5fbyk7IH07XG5cdCAgICBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fby5vbkVycm9yKGUpOyB9O1xuXHQgICAgRGVtYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblx0XG5cdCAgICByZXR1cm4gRGVtYXRlcmlhbGl6ZU9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiBEZW1hdGVyaWFsaXplcyB0aGUgZXhwbGljaXQgbm90aWZpY2F0aW9uIHZhbHVlcyBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIGltcGxpY2l0IG5vdGlmaWNhdGlvbnMuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgZXhoaWJpdGluZyB0aGUgYmVoYXZpb3IgY29ycmVzcG9uZGluZyB0byB0aGUgc291cmNlIHNlcXVlbmNlJ3Mgbm90aWZpY2F0aW9uIHZhbHVlcy5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uZGVtYXRlcmlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiBuZXcgRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUodGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZShzb3VyY2UsIGtleUZuLCBjb21wYXJlcikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5rZXlGbiA9IGtleUZuO1xuXHQgICAgICB0aGlzLmNvbXBhcmVyID0gY29tcGFyZXI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIobywgdGhpcy5rZXlGbiwgdGhpcy5jb21wYXJlcikpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlcihvLCBrZXlGbiwgY29tcGFyZXIpIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5rZXlGbiA9IGtleUZuO1xuXHQgICAgICB0aGlzLmNvbXBhcmVyID0gY29tcGFyZXI7XG5cdCAgICAgIHRoaXMuaGFzQ3VycmVudEtleSA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmN1cnJlbnRLZXkgPSBudWxsO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdmFyIGtleSA9IHgsIGNvbXBhcmVyRXF1YWxzO1xuXHQgICAgICBpZiAoaXNGdW5jdGlvbih0aGlzLmtleUZuKSkge1xuXHQgICAgICAgIGtleSA9IHRyeUNhdGNoKHRoaXMua2V5Rm4pKHgpO1xuXHQgICAgICAgIGlmIChrZXkgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihrZXkuZSk7IH1cblx0ICAgICAgfVxuXHQgICAgICBpZiAodGhpcy5oYXNDdXJyZW50S2V5KSB7XG5cdCAgICAgICAgY29tcGFyZXJFcXVhbHMgPSB0cnlDYXRjaCh0aGlzLmNvbXBhcmVyKSh0aGlzLmN1cnJlbnRLZXksIGtleSk7XG5cdCAgICAgICAgaWYgKGNvbXBhcmVyRXF1YWxzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IoY29tcGFyZXJFcXVhbHMuZSk7IH1cblx0ICAgICAgfVxuXHQgICAgICBpZiAoIXRoaXMuaGFzQ3VycmVudEtleSB8fCAhY29tcGFyZXJFcXVhbHMpIHtcblx0ICAgICAgICB0aGlzLmhhc0N1cnJlbnRLZXkgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuY3VycmVudEtleSA9IGtleTtcblx0ICAgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0ICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyBvbmx5IGRpc3RpbmN0IGNvbnRpZ3VvdXMgZWxlbWVudHMgYWNjb3JkaW5nIHRvIHRoZSBrZXlGbiBhbmQgdGhlIGNvbXBhcmVyLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gW2tleUZuXSBBIGZ1bmN0aW9uIHRvIGNvbXB1dGUgdGhlIGNvbXBhcmlzb24ga2V5IGZvciBlYWNoIGVsZW1lbnQuIElmIG5vdCBwcm92aWRlZCwgaXQgcHJvamVjdHMgdGhlIHZhbHVlLlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbXBhcmVyXSBFcXVhbGl0eSBjb21wYXJlciBmb3IgY29tcHV0ZWQga2V5IHZhbHVlcy4gSWYgbm90IHByb3ZpZGVkLCBkZWZhdWx0cyB0byBhbiBlcXVhbGl0eSBjb21wYXJlciBmdW5jdGlvbi5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9ubHkgY29udGFpbmluZyB0aGUgZGlzdGluY3QgY29udGlndW91cyBlbGVtZW50cywgYmFzZWQgb24gYSBjb21wdXRlZCBrZXkgdmFsdWUsIGZyb20gdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5kaXN0aW5jdFVudGlsQ2hhbmdlZCA9IGZ1bmN0aW9uIChrZXlGbiwgY29tcGFyZXIpIHtcblx0ICAgIGNvbXBhcmVyIHx8IChjb21wYXJlciA9IGRlZmF1bHRDb21wYXJlcik7XG5cdCAgICByZXR1cm4gbmV3IERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSh0aGlzLCBrZXlGbiwgY29tcGFyZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBUYXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGFwT2JzZXJ2YWJsZSxfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVGFwT2JzZXJ2YWJsZShzb3VyY2UsIG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9vTiA9IG9ic2VydmVyT3JPbk5leHQ7XG5cdCAgICAgIHRoaXMuX29FID0gb25FcnJvcjtcblx0ICAgICAgdGhpcy5fb0MgPSBvbkNvbXBsZXRlZDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVGFwT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuXHQgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBwKSB7XG5cdCAgICAgIHRoaXMubyA9IG87XG5cdCAgICAgIHRoaXMudCA9ICFwLl9vTiB8fCBpc0Z1bmN0aW9uKHAuX29OKSA/XG5cdCAgICAgICAgb2JzZXJ2ZXJDcmVhdGUocC5fb04gfHwgbm9vcCwgcC5fb0UgfHwgbm9vcCwgcC5fb0MgfHwgbm9vcCkgOlxuXHQgICAgICAgIHAuX29OO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuXHQgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy50Lm9uTmV4dCkuY2FsbCh0aGlzLnQsIHgpO1xuXHQgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyB0aGlzLm8ub25FcnJvcihyZXMuZSk7IH1cblx0ICAgICAgdGhpcy5vLm9uTmV4dCh4KTtcblx0ICAgIH07XG5cdCAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uKGVycikge1xuXHQgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy50Lm9uRXJyb3IpLmNhbGwodGhpcy50LCBlcnIpO1xuXHQgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgIHRoaXMuby5vbkVycm9yKGVycik7XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLnQub25Db21wbGV0ZWQpLmNhbGwodGhpcy50KTtcblx0ICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFRhcE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAqICBJbnZva2VzIGFuIGFjdGlvbiBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGFuZCBpbnZva2VzIGFuIGFjdGlvbiB1cG9uIGdyYWNlZnVsIG9yIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb24gfCBPYnNlcnZlcn0gb2JzZXJ2ZXJPck9uTmV4dCBBY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugb3IgYW4gby5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkVycm9yXSAgQWN0aW9uIHRvIGludm9rZSB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLiBVc2VkIGlmIG9ubHkgdGhlIG9ic2VydmVyT3JPbk5leHQgcGFyYW1ldGVyIGlzIGFsc28gYSBmdW5jdGlvbi5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkNvbXBsZXRlZF0gIEFjdGlvbiB0byBpbnZva2UgdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS4gVXNlZCBpZiBvbmx5IHRoZSBvYnNlcnZlck9yT25OZXh0IHBhcmFtZXRlciBpcyBhbHNvIGEgZnVuY3Rpb24uXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoIHRoZSBzaWRlLWVmZmVjdGluZyBiZWhhdmlvciBhcHBsaWVkLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvWydkbyddID0gb2JzZXJ2YWJsZVByb3RvLnRhcCA9IG9ic2VydmFibGVQcm90by5kb0FjdGlvbiA9IGZ1bmN0aW9uIChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuXHQgICAgcmV0dXJuIG5ldyBUYXBPYnNlcnZhYmxlKHRoaXMsIG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAqICBJbnZva2VzIGFuIGFjdGlvbiBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uTmV4dCBBY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG5cdCAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uZG9Pbk5leHQgPSBvYnNlcnZhYmxlUHJvdG8udGFwT25OZXh0ID0gZnVuY3Rpb24gKG9uTmV4dCwgdGhpc0FyZykge1xuXHQgICAgcmV0dXJuIHRoaXMudGFwKHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uICh4KSB7IG9uTmV4dC5jYWxsKHRoaXNBcmcsIHgpOyB9IDogb25OZXh0KTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAqICBJbnZva2VzIGFuIGFjdGlvbiB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRXJyb3IgQWN0aW9uIHRvIGludm9rZSB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoIHRoZSBzaWRlLWVmZmVjdGluZyBiZWhhdmlvciBhcHBsaWVkLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmRvT25FcnJvciA9IG9ic2VydmFibGVQcm90by50YXBPbkVycm9yID0gZnVuY3Rpb24gKG9uRXJyb3IsIHRoaXNBcmcpIHtcblx0ICAgIHJldHVybiB0aGlzLnRhcChub29wLCB0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbiAoZSkgeyBvbkVycm9yLmNhbGwodGhpc0FyZywgZSk7IH0gOiBvbkVycm9yKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAqICBJbnZva2VzIGFuIGFjdGlvbiB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cblx0ICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uQ29tcGxldGVkIEFjdGlvbiB0byBpbnZva2UgdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5kb09uQ29tcGxldGVkID0gb2JzZXJ2YWJsZVByb3RvLnRhcE9uQ29tcGxldGVkID0gZnVuY3Rpb24gKG9uQ29tcGxldGVkLCB0aGlzQXJnKSB7XG5cdCAgICByZXR1cm4gdGhpcy50YXAobm9vcCwgbnVsbCwgdHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24gKCkgeyBvbkNvbXBsZXRlZC5jYWxsKHRoaXNBcmcpOyB9IDogb25Db21wbGV0ZWQpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBJbnZva2VzIGEgc3BlY2lmaWVkIGFjdGlvbiBhZnRlciB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdGVybWluYXRlcyBncmFjZWZ1bGx5IG9yIGV4Y2VwdGlvbmFsbHkuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gZmluYWxseUFjdGlvbiBBY3Rpb24gdG8gaW52b2tlIGFmdGVyIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0ZXJtaW5hdGVzLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBTb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgYWN0aW9uLWludm9raW5nIHRlcm1pbmF0aW9uIGJlaGF2aW9yIGFwcGxpZWQuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvWydmaW5hbGx5J10gPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG5cdCAgICB2YXIgc291cmNlID0gdGhpcztcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHRyeUNhdGNoKHNvdXJjZS5zdWJzY3JpYmUpLmNhbGwoc291cmNlLCBvYnNlcnZlcik7XG5cdCAgICAgIGlmIChzdWJzY3JpcHRpb24gPT09IGVycm9yT2JqKSB7XG5cdCAgICAgICAgYWN0aW9uKCk7XG5cdCAgICAgICAgcmV0dXJuIHRocm93ZXIoc3Vic2NyaXB0aW9uLmUpO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgciA9IHRyeUNhdGNoKHN1YnNjcmlwdGlvbi5kaXNwb3NlKS5jYWxsKHN1YnNjcmlwdGlvbik7XG5cdCAgICAgICAgYWN0aW9uKCk7XG5cdCAgICAgICAgciA9PT0gZXJyb3JPYmogJiYgdGhyb3dlcihyLmUpO1xuXHQgICAgICB9KTtcblx0ICAgIH0sIHRoaXMpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBJZ25vcmVFbGVtZW50c09ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhJZ25vcmVFbGVtZW50c09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlKHNvdXJjZSkge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobykge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gbm9vcDtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG5cdCAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm8ub25FcnJvcihlcnIpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlci5vbkVycm9yKGUpO1xuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBJZ25vcmVFbGVtZW50c09ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgSWdub3JlcyBhbGwgZWxlbWVudHMgaW4gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBsZWF2aW5nIG9ubHkgdGhlIHRlcm1pbmF0aW9uIG1lc3NhZ2VzLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBlbXB0eSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2lnbmFscyB0ZXJtaW5hdGlvbiwgc3VjY2Vzc2Z1bCBvciBleGNlcHRpb25hbCwgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uaWdub3JlRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICByZXR1cm4gbmV3IElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZSh0aGlzKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgTWF0ZXJpYWxpemVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE1hdGVyaWFsaXplT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE1hdGVyaWFsaXplT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBNYXRlcmlhbGl6ZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNYXRlcmlhbGl6ZU9ic2VydmVyKG8pKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE1hdGVyaWFsaXplT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBNYXRlcmlhbGl6ZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKE1hdGVyaWFsaXplT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gTWF0ZXJpYWxpemVPYnNlcnZlcihvKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBNYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fby5vbk5leHQobm90aWZpY2F0aW9uQ3JlYXRlT25OZXh0KHgpKSB9O1xuXHQgICAgTWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uTmV4dChub3RpZmljYXRpb25DcmVhdGVPbkVycm9yKGUpKTsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXHQgICAgTWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uTmV4dChub3RpZmljYXRpb25DcmVhdGVPbkNvbXBsZXRlZCgpKTsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXHRcblx0ICAgIHJldHVybiBNYXRlcmlhbGl6ZU9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgTWF0ZXJpYWxpemVzIHRoZSBpbXBsaWNpdCBub3RpZmljYXRpb25zIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgZXhwbGljaXQgbm90aWZpY2F0aW9uIHZhbHVlcy5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBtYXRlcmlhbGl6ZWQgbm90aWZpY2F0aW9uIHZhbHVlcyBmcm9tIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLm1hdGVyaWFsaXplID0gZnVuY3Rpb24gKCkge1xuXHQgICAgcmV0dXJuIG5ldyBNYXRlcmlhbGl6ZU9ic2VydmFibGUodGhpcyk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJlcGVhdHMgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLiBJZiB0aGUgcmVwZWF0IGNvdW50IGlzIG5vdCBzcGVjaWZpZWQsIHRoZSBzZXF1ZW5jZSByZXBlYXRzIGluZGVmaW5pdGVseS5cblx0ICAgKiBAcGFyYW0ge051bWJlcn0gW3JlcGVhdENvdW50XSAgTnVtYmVyIG9mIHRpbWVzIHRvIHJlcGVhdCB0aGUgc2VxdWVuY2UuIElmIG5vdCBwcm92aWRlZCwgcmVwZWF0cyB0aGUgc2VxdWVuY2UgaW5kZWZpbml0ZWx5LlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNpbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBzZXF1ZW5jZSByZXBlYXRlZGx5LlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5yZXBlYXQgPSBmdW5jdGlvbiAocmVwZWF0Q291bnQpIHtcblx0ICAgIHJldHVybiBlbnVtZXJhYmxlUmVwZWF0KHRoaXMsIHJlcGVhdENvdW50KS5jb25jYXQoKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmVwZWF0cyB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMgb3IgdW50aWwgaXQgc3VjY2Vzc2Z1bGx5IHRlcm1pbmF0ZXMuIElmIHRoZSByZXRyeSBjb3VudCBpcyBub3Qgc3BlY2lmaWVkLCBpdCByZXRyaWVzIGluZGVmaW5pdGVseS5cblx0ICAgKiAgTm90ZSBpZiB5b3UgZW5jb3VudGVyIGFuIGVycm9yIGFuZCB3YW50IGl0IHRvIHJldHJ5IG9uY2UsIHRoZW4geW91IG11c3QgdXNlIC5yZXRyeSgyKTtcblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogIHZhciByZXMgPSByZXRyaWVkID0gcmV0cnkucmVwZWF0KCk7XG5cdCAgICogIHZhciByZXMgPSByZXRyaWVkID0gcmV0cnkucmVwZWF0KDIpO1xuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBbcmV0cnlDb3VudF0gIE51bWJlciBvZiB0aW1lcyB0byByZXRyeSB0aGUgc2VxdWVuY2UuIElmIG5vdCBwcm92aWRlZCwgcmV0cnkgdGhlIHNlcXVlbmNlIGluZGVmaW5pdGVseS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNpbmcgdGhlIGVsZW1lbnRzIG9mIHRoZSBnaXZlbiBzZXF1ZW5jZSByZXBlYXRlZGx5IHVudGlsIGl0IHRlcm1pbmF0ZXMgc3VjY2Vzc2Z1bGx5LlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5yZXRyeSA9IGZ1bmN0aW9uIChyZXRyeUNvdW50KSB7XG5cdCAgICByZXR1cm4gZW51bWVyYWJsZVJlcGVhdCh0aGlzLCByZXRyeUNvdW50KS5jYXRjaEVycm9yKCk7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogIFJlcGVhdHMgdGhlIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHVwb24gZXJyb3IgZWFjaCB0aW1lIHRoZSBub3RpZmllciBlbWl0cyBvciB1bnRpbCBpdCBzdWNjZXNzZnVsbHkgdGVybWluYXRlcy4gXG5cdCAgICogIGlmIHRoZSBub3RpZmllciBjb21wbGV0ZXMsIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbXBsZXRlcy5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogIHZhciB0aW1lciA9IE9ic2VydmFibGUudGltZXIoNTAwKTtcblx0ICAgKiAgdmFyIHNvdXJjZSA9IG9ic2VydmFibGUucmV0cnlXaGVuKHRpbWVyKTtcblx0ICAgKiBAcGFyYW0ge09ic2VydmFibGV9IFtub3RpZmllcl0gQW4gb2JzZXJ2YWJsZSB0aGF0IHRyaWdnZXJzIHRoZSByZXRyaWVzIG9yIGNvbXBsZXRlcyB0aGUgb2JzZXJ2YWJsZSB3aXRoIG9uTmV4dCBvciBvbkNvbXBsZXRlZCByZXNwZWN0aXZlbHkuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2VxdWVuY2UgcmVwZWF0ZWRseSB1bnRpbCBpdCB0ZXJtaW5hdGVzIHN1Y2Nlc3NmdWxseS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucmV0cnlXaGVuID0gZnVuY3Rpb24gKG5vdGlmaWVyKSB7XG5cdCAgICByZXR1cm4gZW51bWVyYWJsZVJlcGVhdCh0aGlzKS5jYXRjaEVycm9yV2hlbihub3RpZmllcik7XG5cdCAgfTtcblx0ICB2YXIgU2Nhbk9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTY2FuT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFNjYW5PYnNlcnZhYmxlKHNvdXJjZSwgYWNjdW11bGF0b3IsIGhhc1NlZWQsIHNlZWQpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSBhY2N1bXVsYXRvcjtcblx0ICAgICAgdGhpcy5oYXNTZWVkID0gaGFzU2VlZDtcblx0ICAgICAgdGhpcy5zZWVkID0gc2VlZDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2Nhbk9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFNjYW5PYnNlcnZlcihvLHRoaXMpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNjYW5PYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFNjYW5PYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTY2FuT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTY2FuT2JzZXJ2ZXIobywgcGFyZW50KSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9wID0gcGFyZW50O1xuXHQgICAgICB0aGlzLl9mbiA9IHBhcmVudC5hY2N1bXVsYXRvcjtcblx0ICAgICAgdGhpcy5faHMgPSBwYXJlbnQuaGFzU2VlZDtcblx0ICAgICAgdGhpcy5fcyA9IHBhcmVudC5zZWVkO1xuXHQgICAgICB0aGlzLl9oYSA9IGZhbHNlO1xuXHQgICAgICB0aGlzLl9hID0gbnVsbDtcblx0ICAgICAgdGhpcy5faHYgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5faSA9IDA7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNjYW5PYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICF0aGlzLl9odiAmJiAodGhpcy5faHYgPSB0cnVlKTtcblx0ICAgICAgaWYgKHRoaXMuX2hhKSB7XG5cdCAgICAgICAgdGhpcy5fYSA9IHRyeUNhdGNoKHRoaXMuX2ZuKSh0aGlzLl9hLCB4LCB0aGlzLl9pLCB0aGlzLl9wKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLl9hID0gdGhpcy5faHMgPyB0cnlDYXRjaCh0aGlzLl9mbikodGhpcy5fcywgeCwgdGhpcy5faSwgdGhpcy5fcCkgOiB4O1xuXHQgICAgICAgIHRoaXMuX2hhID0gdHJ1ZTtcblx0ICAgICAgfVxuXHQgICAgICBpZiAodGhpcy5fYSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcih0aGlzLl9hLmUpOyB9XG5cdCAgICAgIHRoaXMuX28ub25OZXh0KHRoaXMuX2EpO1xuXHQgICAgICB0aGlzLl9pKys7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNjYW5PYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNjYW5PYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAhdGhpcy5faHYgJiYgdGhpcy5faHMgJiYgdGhpcy5fby5vbk5leHQodGhpcy5fcyk7XG5cdCAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNjYW5PYnNlcnZlcjtcblx0ICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgQXBwbGllcyBhbiBhY2N1bXVsYXRvciBmdW5jdGlvbiBvdmVyIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIHJldHVybnMgZWFjaCBpbnRlcm1lZGlhdGUgcmVzdWx0LiBUaGUgb3B0aW9uYWwgc2VlZCB2YWx1ZSBpcyB1c2VkIGFzIHRoZSBpbml0aWFsIGFjY3VtdWxhdG9yIHZhbHVlLlxuXHQgICogIEZvciBhZ2dyZWdhdGlvbiBiZWhhdmlvciB3aXRoIG5vIGludGVybWVkaWF0ZSByZXN1bHRzLCBzZWUgT2JzZXJ2YWJsZS5hZ2dyZWdhdGUuXG5cdCAgKiBAcGFyYW0ge01peGVkfSBbc2VlZF0gVGhlIGluaXRpYWwgYWNjdW11bGF0b3IgdmFsdWUuXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY2N1bXVsYXRvciBBbiBhY2N1bXVsYXRvciBmdW5jdGlvbiB0byBiZSBpbnZva2VkIG9uIGVhY2ggZWxlbWVudC5cblx0ICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIGFjY3VtdWxhdGVkIHZhbHVlcy5cblx0ICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5zY2FuID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGhhc1NlZWQgPSBmYWxzZSwgc2VlZCwgYWNjdW11bGF0b3IgPSBhcmd1bWVudHNbMF07XG5cdCAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMikge1xuXHQgICAgICBoYXNTZWVkID0gdHJ1ZTtcblx0ICAgICAgc2VlZCA9IGFyZ3VtZW50c1sxXTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBuZXcgU2Nhbk9ic2VydmFibGUodGhpcywgYWNjdW11bGF0b3IsIGhhc1NlZWQsIHNlZWQpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBTa2lwTGFzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2tpcExhc3RPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gU2tpcExhc3RPYnNlcnZhYmxlKHNvdXJjZSwgYykge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fYyA9IGM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNraXBMYXN0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFNraXBMYXN0T2JzZXJ2ZXIobywgdGhpcy5fYykpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gU2tpcExhc3RPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFNraXBMYXN0T2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2tpcExhc3RPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFNraXBMYXN0T2JzZXJ2ZXIobywgYykge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fYyA9IGM7XG5cdCAgICAgIHRoaXMuX3EgPSBbXTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2tpcExhc3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIHRoaXMuX3EucHVzaCh4KTtcblx0ICAgICAgdGhpcy5fcS5sZW5ndGggPiB0aGlzLl9jICYmIHRoaXMuX28ub25OZXh0KHRoaXMuX3Euc2hpZnQoKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFNraXBMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBTa2lwTGFzdE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNraXBMYXN0T2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBCeXBhc3NlcyBhIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMgYXQgdGhlIGVuZCBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqIEBkZXNjcmlwdGlvblxuXHQgICAqICBUaGlzIG9wZXJhdG9yIGFjY3VtdWxhdGVzIGEgcXVldWUgd2l0aCBhIGxlbmd0aCBlbm91Z2ggdG8gc3RvcmUgdGhlIGZpcnN0IGBjb3VudGAgZWxlbWVudHMuIEFzIG1vcmUgZWxlbWVudHMgYXJlXG5cdCAgICogIHJlY2VpdmVkLCBlbGVtZW50cyBhcmUgdGFrZW4gZnJvbSB0aGUgZnJvbnQgb2YgdGhlIHF1ZXVlIGFuZCBwcm9kdWNlZCBvbiB0aGUgcmVzdWx0IHNlcXVlbmNlLiBUaGlzIGNhdXNlcyBlbGVtZW50cyB0byBiZSBkZWxheWVkLlxuXHQgICAqIEBwYXJhbSBjb3VudCBOdW1iZXIgb2YgZWxlbWVudHMgdG8gYnlwYXNzIGF0IHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UgZWxlbWVudHMgZXhjZXB0IGZvciB0aGUgYnlwYXNzZWQgb25lcyBhdCB0aGUgZW5kLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5za2lwTGFzdCA9IGZ1bmN0aW9uIChjb3VudCkge1xuXHQgICAgaWYgKGNvdW50IDwgMCkgeyB0aHJvdyBuZXcgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IoKTsgfVxuXHQgICAgcmV0dXJuIG5ldyBTa2lwTGFzdE9ic2VydmFibGUodGhpcywgY291bnQpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBQcmVwZW5kcyBhIHNlcXVlbmNlIG9mIHZhbHVlcyB0byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggYW4gb3B0aW9uYWwgc2NoZWR1bGVyIGFuZCBhbiBhcmd1bWVudCBsaXN0IG9mIHZhbHVlcyB0byBwcmVwZW5kLlxuXHQgICAqICBAZXhhbXBsZVxuXHQgICAqICB2YXIgcmVzID0gc291cmNlLnN0YXJ0V2l0aCgxLCAyLCAzKTtcblx0ICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5zdGFydFdpdGgoUnguU2NoZWR1bGVyLnRpbWVvdXQsIDEsIDIsIDMpO1xuXHQgICAqIEBwYXJhbSB7QXJndW1lbnRzfSBhcmdzIFRoZSBzcGVjaWZpZWQgdmFsdWVzIHRvIHByZXBlbmQgdG8gdGhlIG9ic2VydmFibGUgc2VxdWVuY2Vcblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIHNvdXJjZSBzZXF1ZW5jZSBwcmVwZW5kZWQgd2l0aCB0aGUgc3BlY2lmaWVkIHZhbHVlcy5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uc3RhcnRXaXRoID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIHZhbHVlcywgc2NoZWR1bGVyLCBzdGFydCA9IDA7XG5cdCAgICBpZiAoISFhcmd1bWVudHMubGVuZ3RoICYmIGlzU2NoZWR1bGVyKGFyZ3VtZW50c1swXSkpIHtcblx0ICAgICAgc2NoZWR1bGVyID0gYXJndW1lbnRzWzBdO1xuXHQgICAgICBzdGFydCA9IDE7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXI7XG5cdCAgICB9XG5cdCAgICBmb3IodmFyIGFyZ3MgPSBbXSwgaSA9IHN0YXJ0LCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cblx0ICAgIHJldHVybiBlbnVtZXJhYmxlT2YoW29ic2VydmFibGVGcm9tQXJyYXkoYXJncywgc2NoZWR1bGVyKSwgdGhpc10pLmNvbmNhdCgpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBUYWtlTGFzdE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRha2VMYXN0T2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUYWtlTGFzdE9ic2VydmVyKG8sIGMpIHtcblx0ICAgICAgdGhpcy5fbyA9IG87XG5cdCAgICAgIHRoaXMuX2MgPSBjO1xuXHQgICAgICB0aGlzLl9xID0gW107XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRha2VMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB0aGlzLl9xLnB1c2goeCk7XG5cdCAgICAgIHRoaXMuX3EubGVuZ3RoID4gdGhpcy5fYyAmJiB0aGlzLl9xLnNoaWZ0KCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFRha2VMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBUYWtlTGFzdE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHdoaWxlICh0aGlzLl9xLmxlbmd0aCA+IDApIHsgdGhpcy5fby5vbk5leHQodGhpcy5fcS5zaGlmdCgpKTsgfVxuXHQgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBUYWtlTGFzdE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBhIHNwZWNpZmllZCBudW1iZXIgb2YgY29udGlndW91cyBlbGVtZW50cyBmcm9tIHRoZSBlbmQgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAZGVzY3JpcHRpb25cblx0ICAgKiAgVGhpcyBvcGVyYXRvciBhY2N1bXVsYXRlcyBhIGJ1ZmZlciB3aXRoIGEgbGVuZ3RoIGVub3VnaCB0byBzdG9yZSBlbGVtZW50cyBjb3VudCBlbGVtZW50cy4gVXBvbiBjb21wbGV0aW9uIG9mXG5cdCAgICogIHRoZSBzb3VyY2Ugc2VxdWVuY2UsIHRoaXMgYnVmZmVyIGlzIGRyYWluZWQgb24gdGhlIHJlc3VsdCBzZXF1ZW5jZS4gVGhpcyBjYXVzZXMgdGhlIGVsZW1lbnRzIHRvIGJlIGRlbGF5ZWQuXG5cdCAgICogQHBhcmFtIHtOdW1iZXJ9IGNvdW50IE51bWJlciBvZiBlbGVtZW50cyB0byB0YWtlIGZyb20gdGhlIGVuZCBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRha2VMYXN0ID0gZnVuY3Rpb24gKGNvdW50KSB7XG5cdCAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG5cdCAgICB2YXIgc291cmNlID0gdGhpcztcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShuZXcgVGFrZUxhc3RPYnNlcnZlcihvLCBjb3VudCkpO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9O1xuXHRcblx0b2JzZXJ2YWJsZVByb3RvLmZsYXRNYXBDb25jYXQgPSBvYnNlcnZhYmxlUHJvdG8uY29uY2F0TWFwID0gZnVuY3Rpb24oc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdCAgICByZXR1cm4gbmV3IEZsYXRNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykubWVyZ2UoMSk7XG5cdH07XG5cdCAgdmFyIE1hcE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTWFwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBNYXBPYnNlcnZhYmxlKHNvdXJjZSwgc2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuc2VsZWN0b3IgPSBiaW5kQ2FsbGJhY2soc2VsZWN0b3IsIHRoaXNBcmcsIDMpO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBpbm5lck1hcChzZWxlY3Rvciwgc2VsZikge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gKHgsIGksIG8pIHsgcmV0dXJuIHNlbGVjdG9yLmNhbGwodGhpcywgc2VsZi5zZWxlY3Rvcih4LCBpLCBvKSwgaSwgbyk7IH1cblx0ICAgIH1cblx0XG5cdCAgICBNYXBPYnNlcnZhYmxlLnByb3RvdHlwZS5pbnRlcm5hbE1hcCA9IGZ1bmN0aW9uIChzZWxlY3RvciwgdGhpc0FyZykge1xuXHQgICAgICByZXR1cm4gbmV3IE1hcE9ic2VydmFibGUodGhpcy5zb3VyY2UsIGlubmVyTWFwKHNlbGVjdG9yLCB0aGlzKSwgdGhpc0FyZyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIE1hcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMuc2VsZWN0b3IsIHRoaXMpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG5cdCAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHNlbGVjdG9yLCBzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yO1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5pID0gMDtcblx0ICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbih4KSB7XG5cdCAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLnNlbGVjdG9yKSh4LCB0aGlzLmkrKywgdGhpcy5zb3VyY2UpO1xuXHQgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzdWx0LmUpOyB9XG5cdCAgICAgIHRoaXMuby5vbk5leHQocmVzdWx0KTtcblx0ICAgIH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIE1hcE9ic2VydmFibGU7XG5cdFxuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiBQcm9qZWN0cyBlYWNoIGVsZW1lbnQgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBpbnRvIGEgbmV3IGZvcm0gYnkgaW5jb3Jwb3JhdGluZyB0aGUgZWxlbWVudCdzIGluZGV4LlxuXHQgICogQHBhcmFtIHtGdW5jdGlvbn0gc2VsZWN0b3IgQSB0cmFuc2Zvcm0gZnVuY3Rpb24gdG8gYXBwbHkgdG8gZWFjaCBzb3VyY2UgZWxlbWVudDsgdGhlIHNlY29uZCBwYXJhbWV0ZXIgb2YgdGhlIGZ1bmN0aW9uIHJlcHJlc2VudHMgdGhlIGluZGV4IG9mIHRoZSBzb3VyY2UgZWxlbWVudC5cblx0ICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2UgZWxlbWVudHMgYXJlIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHRyYW5zZm9ybSBmdW5jdGlvbiBvbiBlYWNoIGVsZW1lbnQgb2Ygc291cmNlLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLm1hcCA9IG9ic2VydmFibGVQcm90by5zZWxlY3QgPSBmdW5jdGlvbiAoc2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0ICAgIHZhciBzZWxlY3RvckZuID0gdHlwZW9mIHNlbGVjdG9yID09PSAnZnVuY3Rpb24nID8gc2VsZWN0b3IgOiBmdW5jdGlvbiAoKSB7IHJldHVybiBzZWxlY3RvcjsgfTtcblx0ICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgTWFwT2JzZXJ2YWJsZSA/XG5cdCAgICAgIHRoaXMuaW50ZXJuYWxNYXAoc2VsZWN0b3JGbiwgdGhpc0FyZykgOlxuXHQgICAgICBuZXcgTWFwT2JzZXJ2YWJsZSh0aGlzLCBzZWxlY3RvckZuLCB0aGlzQXJnKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBwbHVja2VyKGFyZ3MsIGxlbikge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIG1hcHBlcih4KSB7XG5cdCAgICAgIHZhciBjdXJyZW50UHJvcCA9IHg7XG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICB2YXIgcCA9IGN1cnJlbnRQcm9wW2FyZ3NbaV1dO1xuXHQgICAgICAgIGlmICh0eXBlb2YgcCAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgICAgICAgIGN1cnJlbnRQcm9wID0gcDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgICAgcmV0dXJuIGN1cnJlbnRQcm9wO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogUmV0cmlldmVzIHRoZSB2YWx1ZSBvZiBhIHNwZWNpZmllZCBuZXN0ZWQgcHJvcGVydHkgZnJvbSBhbGwgZWxlbWVudHMgaW5cblx0ICAgKiB0aGUgT2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcGFyYW0ge0FyZ3VtZW50c30gYXJndW1lbnRzIFRoZSBuZXN0ZWQgcHJvcGVydGllcyB0byBwbHVjay5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gUmV0dXJucyBhIG5ldyBPYnNlcnZhYmxlIHNlcXVlbmNlIG9mIHByb3BlcnR5IHZhbHVlcy5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucGx1Y2sgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgaWYgKGxlbiA9PT0gMCkgeyB0aHJvdyBuZXcgRXJyb3IoJ0xpc3Qgb2YgcHJvcGVydGllcyBjYW5ub3QgYmUgZW1wdHkuJyk7IH1cblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICByZXR1cm4gdGhpcy5tYXAocGx1Y2tlcihhcmdzLCBsZW4pKTtcblx0ICB9O1xuXHRcblx0b2JzZXJ2YWJsZVByb3RvLmZsYXRNYXAgPSBvYnNlcnZhYmxlUHJvdG8uc2VsZWN0TWFueSA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuXHQgICAgcmV0dXJuIG5ldyBGbGF0TWFwT2JzZXJ2YWJsZSh0aGlzLCBzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpLm1lcmdlQWxsKCk7XG5cdH07XG5cdFxuXHRcblx0Ly9cblx0Ly9SeC5PYnNlcnZhYmxlLnByb3RvdHlwZS5mbGF0TWFwV2l0aE1heENvbmN1cnJlbnQgPSBmdW5jdGlvbihsaW1pdCwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG5cdC8vICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5tZXJnZShsaW1pdCk7XG5cdC8vfTtcblx0Ly9cblx0XG5cdFJ4Lk9ic2VydmFibGUucHJvdG90eXBlLmZsYXRNYXBMYXRlc3QgPSBmdW5jdGlvbihzZWxlY3RvciwgcmVzdWx0U2VsZWN0b3IsIHRoaXNBcmcpIHtcblx0ICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5zd2l0Y2hMYXRlc3QoKTtcblx0fTtcblx0ICB2YXIgU2tpcE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhTa2lwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFNraXBPYnNlcnZhYmxlKHNvdXJjZSwgY291bnQpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuc2tpcENvdW50ID0gY291bnQ7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHQgICAgXG5cdCAgICBTa2lwT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgdGhpcy5za2lwQ291bnQpKTtcblx0ICAgIH07XG5cdCAgICBcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgYykge1xuXHQgICAgICB0aGlzLmMgPSBjO1xuXHQgICAgICB0aGlzLnIgPSBjO1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICBpZiAodGhpcy5yIDw9IDApIHsgXG5cdCAgICAgICAgdGhpcy5vLm9uTmV4dCh4KTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLnItLTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbihlKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB0aGlzLm8ub25FcnJvcihlKTsgfVxuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB0aGlzLm8ub25Db21wbGV0ZWQoKTsgfVxuXHQgICAgfTtcblx0ICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZmFpbCA9IGZ1bmN0aW9uKGUpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgfVxuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9O1xuXHQgICAgXG5cdCAgICByZXR1cm4gU2tpcE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpOyAgXG5cdCAgXG5cdCAgLyoqXG5cdCAgICogQnlwYXNzZXMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIHRoZW4gcmV0dXJucyB0aGUgcmVtYWluaW5nIGVsZW1lbnRzLlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHNraXAgYmVmb3JlIHJldHVybmluZyB0aGUgcmVtYWluaW5nIGVsZW1lbnRzLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIHRoYXQgb2NjdXIgYWZ0ZXIgdGhlIHNwZWNpZmllZCBpbmRleCBpbiB0aGUgaW5wdXQgc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNraXAgPSBmdW5jdGlvbiAoY291bnQpIHtcblx0ICAgIGlmIChjb3VudCA8IDApIHsgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yKCk7IH1cblx0ICAgIHJldHVybiBuZXcgU2tpcE9ic2VydmFibGUodGhpcywgY291bnQpO1xuXHQgIH07XG5cdCAgdmFyIFNraXBXaGlsZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2tpcFdoaWxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFNraXBXaGlsZU9ic2VydmFibGUoc291cmNlLCBmbikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fZm4gPSBmbjtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgU2tpcFdoaWxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFNraXBXaGlsZU9ic2VydmVyKG8sIHRoaXMpKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFNraXBXaGlsZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgU2tpcFdoaWxlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoU2tpcFdoaWxlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gU2tpcFdoaWxlT2JzZXJ2ZXIobywgcCkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcCA9IHA7XG5cdCAgICAgIHRoaXMuX2kgPSAwO1xuXHQgICAgICB0aGlzLl9yID0gZmFsc2U7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFNraXBXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgaWYgKCF0aGlzLl9yKSB7XG5cdCAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX3AuX2ZuKSh4LCB0aGlzLl9pKyssIHRoaXMuX3ApO1xuXHQgICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICAgICAgdGhpcy5fciA9ICFyZXM7XG5cdCAgICAgIH1cblx0ICAgICAgdGhpcy5fciAmJiB0aGlzLl9vLm9uTmV4dCh4KTtcblx0ICAgIH07XG5cdCAgICBTa2lwV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG5cdCAgICBTa2lwV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cdFxuXHQgICAgcmV0dXJuIFNraXBXaGlsZU9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgQnlwYXNzZXMgZWxlbWVudHMgaW4gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyBsb25nIGFzIGEgc3BlY2lmaWVkIGNvbmRpdGlvbiBpcyB0cnVlIGFuZCB0aGVuIHJldHVybnMgdGhlIHJlbWFpbmluZyBlbGVtZW50cy5cblx0ICAgKiAgVGhlIGVsZW1lbnQncyBpbmRleCBpcyB1c2VkIGluIHRoZSBsb2dpYyBvZiB0aGUgcHJlZGljYXRlIGZ1bmN0aW9uLlxuXHQgICAqXG5cdCAgICogIHZhciByZXMgPSBzb3VyY2Uuc2tpcFdoaWxlKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgPCAxMDsgfSk7XG5cdCAgICogIHZhciByZXMgPSBzb3VyY2Uuc2tpcFdoaWxlKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHsgcmV0dXJuIHZhbHVlIDwgMTAgfHwgaW5kZXggPCAxMDsgfSk7XG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIGVsZW1lbnQgZm9yIGEgY29uZGl0aW9uOyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuXHQgICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIGZyb20gdGhlIGlucHV0IHNlcXVlbmNlIHN0YXJ0aW5nIGF0IHRoZSBmaXJzdCBlbGVtZW50IGluIHRoZSBsaW5lYXIgc2VyaWVzIHRoYXQgZG9lcyBub3QgcGFzcyB0aGUgdGVzdCBzcGVjaWZpZWQgYnkgcHJlZGljYXRlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5za2lwV2hpbGUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB0aGlzQXJnKSB7XG5cdCAgICB2YXIgZm4gPSBiaW5kQ2FsbGJhY2socHJlZGljYXRlLCB0aGlzQXJnLCAzKTtcblx0ICAgIHJldHVybiBuZXcgU2tpcFdoaWxlT2JzZXJ2YWJsZSh0aGlzLCBmbik7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFRha2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVGFrZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBcblx0ICAgIGZ1bmN0aW9uIFRha2VPYnNlcnZhYmxlKHNvdXJjZSwgY291bnQpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMudGFrZUNvdW50ID0gY291bnQ7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHQgICAgXG5cdCAgICBUYWtlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgdGhpcy50YWtlQ291bnQpKTtcblx0ICAgIH07XG5cdCAgICBcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgYykge1xuXHQgICAgICB0aGlzLm8gPSBvO1xuXHQgICAgICB0aGlzLmMgPSBjO1xuXHQgICAgICB0aGlzLnIgPSBjO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUgPSB7XG5cdCAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgaWYgKHRoaXMuci0tID4gMCkge1xuXHQgICAgICAgICAgdGhpcy5vLm9uTmV4dCh4KTtcblx0ICAgICAgICAgIHRoaXMuciA8PSAwICYmIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycikge1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuby5vbkVycm9yKGVycik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH0sXG5cdCAgICAgIGZhaWw6IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHQgICAgXG5cdCAgICByZXR1cm4gVGFrZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpOyAgXG5cdCAgXG5cdCAgLyoqXG5cdCAgICogIFJldHVybnMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGNvbnRpZ3VvdXMgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgZm9yIHRoZSBlZGdlIGNhc2Ugb2YgdGFrZSgwKS5cblx0ICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byByZXR1cm4uXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB1c2VkIHRvIHByb2R1Y2UgYW4gT25Db21wbGV0ZWQgbWVzc2FnZSBpbiBjYXNlIDxwYXJhbXJlZiBuYW1lPVwiY291bnQgY291bnQ8L3BhcmFtcmVmPiBpcyBzZXQgdG8gMC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIHRoZSBpbnB1dCBzZXF1ZW5jZS5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udGFrZSA9IGZ1bmN0aW9uIChjb3VudCwgc2NoZWR1bGVyKSB7XG5cdCAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG5cdCAgICBpZiAoY291bnQgPT09IDApIHsgcmV0dXJuIG9ic2VydmFibGVFbXB0eShzY2hlZHVsZXIpOyB9XG5cdCAgICByZXR1cm4gbmV3IFRha2VPYnNlcnZhYmxlKHRoaXMsIGNvdW50KTtcblx0ICB9O1xuXHRcblx0ICB2YXIgVGFrZVdoaWxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUYWtlV2hpbGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVGFrZVdoaWxlT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLl9mbiA9IGZuO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUYWtlV2hpbGVPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgVGFrZVdoaWxlT2JzZXJ2ZXIobywgdGhpcykpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gVGFrZVdoaWxlT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBUYWtlV2hpbGVPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUYWtlV2hpbGVPYnNlcnZlciwgX19zdXBlcl9fKTtcblx0XG5cdCAgICBmdW5jdGlvbiBUYWtlV2hpbGVPYnNlcnZlcihvLCBwKSB7XG5cdCAgICAgIHRoaXMuX28gPSBvO1xuXHQgICAgICB0aGlzLl9wID0gcDtcblx0ICAgICAgdGhpcy5faSA9IDA7XG5cdCAgICAgIHRoaXMuX3IgPSB0cnVlO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBUYWtlV2hpbGVPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgIGlmICh0aGlzLl9yKSB7XG5cdCAgICAgICAgdGhpcy5fciA9IHRyeUNhdGNoKHRoaXMuX3AuX2ZuKSh4LCB0aGlzLl9pKyssIHRoaXMuX3ApO1xuXHQgICAgICAgIGlmICh0aGlzLl9yID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHRoaXMuX3IuZSk7IH1cblx0ICAgICAgfVxuXHQgICAgICBpZiAodGhpcy5fcikge1xuXHQgICAgICAgIHRoaXMuX28ub25OZXh0KHgpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICAgIFRha2VXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcblx0ICAgIFRha2VXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblx0XG5cdCAgICByZXR1cm4gVGFrZVdoaWxlT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXR1cm5zIGVsZW1lbnRzIGZyb20gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyBsb25nIGFzIGEgc3BlY2lmaWVkIGNvbmRpdGlvbiBpcyB0cnVlLlxuXHQgICAqICBUaGUgZWxlbWVudCdzIGluZGV4IGlzIHVzZWQgaW4gdGhlIGxvZ2ljIG9mIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24uXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIGVsZW1lbnQgZm9yIGEgY29uZGl0aW9uOyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuXHQgICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIGZyb20gdGhlIGlucHV0IHNlcXVlbmNlIHRoYXQgb2NjdXIgYmVmb3JlIHRoZSBlbGVtZW50IGF0IHdoaWNoIHRoZSB0ZXN0IG5vIGxvbmdlciBwYXNzZXMuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRha2VXaGlsZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHRoaXNBcmcpIHtcblx0ICAgIHZhciBmbiA9IGJpbmRDYWxsYmFjayhwcmVkaWNhdGUsIHRoaXNBcmcsIDMpO1xuXHQgICAgcmV0dXJuIG5ldyBUYWtlV2hpbGVPYnNlcnZhYmxlKHRoaXMsIGZuKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgRmlsdGVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhGaWx0ZXJPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHRcblx0ICAgIGZ1bmN0aW9uIEZpbHRlck9ic2VydmFibGUoc291cmNlLCBwcmVkaWNhdGUsIHRoaXNBcmcpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMucHJlZGljYXRlID0gYmluZENhbGxiYWNrKHByZWRpY2F0ZSwgdGhpc0FyZywgMyk7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEZpbHRlck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMucHJlZGljYXRlLCB0aGlzKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIGlubmVyUHJlZGljYXRlKHByZWRpY2F0ZSwgc2VsZikge1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24oeCwgaSwgbykgeyByZXR1cm4gc2VsZi5wcmVkaWNhdGUoeCwgaSwgbykgJiYgcHJlZGljYXRlLmNhbGwodGhpcywgeCwgaSwgbyk7IH1cblx0ICAgIH1cblx0XG5cdCAgICBGaWx0ZXJPYnNlcnZhYmxlLnByb3RvdHlwZS5pbnRlcm5hbEZpbHRlciA9IGZ1bmN0aW9uKHByZWRpY2F0ZSwgdGhpc0FyZykge1xuXHQgICAgICByZXR1cm4gbmV3IEZpbHRlck9ic2VydmFibGUodGhpcy5zb3VyY2UsIGlubmVyUHJlZGljYXRlKHByZWRpY2F0ZSwgdGhpcyksIHRoaXNBcmcpO1xuXHQgICAgfTtcblx0XG5cdCAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcblx0ICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgcHJlZGljYXRlLCBzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5vID0gbztcblx0ICAgICAgdGhpcy5wcmVkaWNhdGUgPSBwcmVkaWNhdGU7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLmkgPSAwO1xuXHQgICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHgpIHtcblx0ICAgICAgdmFyIHNob3VsZFlpZWxkID0gdHJ5Q2F0Y2godGhpcy5wcmVkaWNhdGUpKHgsIHRoaXMuaSsrLCB0aGlzLnNvdXJjZSk7XG5cdCAgICAgIGlmIChzaG91bGRZaWVsZCA9PT0gZXJyb3JPYmopIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5vLm9uRXJyb3Ioc2hvdWxkWWllbGQuZSk7XG5cdCAgICAgIH1cblx0ICAgICAgc2hvdWxkWWllbGQgJiYgdGhpcy5vLm9uTmV4dCh4KTtcblx0ICAgIH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLm8ub25FcnJvcihlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEZpbHRlck9ic2VydmFibGU7XG5cdFxuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgKiAgRmlsdGVycyB0aGUgZWxlbWVudHMgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBiYXNlZCBvbiBhIHByZWRpY2F0ZSBieSBpbmNvcnBvcmF0aW5nIHRoZSBlbGVtZW50J3MgaW5kZXguXG5cdCAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgQSBmdW5jdGlvbiB0byB0ZXN0IGVhY2ggc291cmNlIGVsZW1lbnQgZm9yIGEgY29uZGl0aW9uOyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuXHQgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG5cdCAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIGVsZW1lbnRzIGZyb20gdGhlIGlucHV0IHNlcXVlbmNlIHRoYXQgc2F0aXNmeSB0aGUgY29uZGl0aW9uLlxuXHQgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLmZpbHRlciA9IG9ic2VydmFibGVQcm90by53aGVyZSA9IGZ1bmN0aW9uIChwcmVkaWNhdGUsIHRoaXNBcmcpIHtcblx0ICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgRmlsdGVyT2JzZXJ2YWJsZSA/IHRoaXMuaW50ZXJuYWxGaWx0ZXIocHJlZGljYXRlLCB0aGlzQXJnKSA6XG5cdCAgICAgIG5ldyBGaWx0ZXJPYnNlcnZhYmxlKHRoaXMsIHByZWRpY2F0ZSwgdGhpc0FyZyk7XG5cdCAgfTtcblx0XG5cdGZ1bmN0aW9uIGNyZWF0ZUNiT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncykge1xuXHQgIHZhciBvID0gbmV3IEFzeW5jU3ViamVjdCgpO1xuXHRcblx0ICBhcmdzLnB1c2goY3JlYXRlQ2JIYW5kbGVyKG8sIGN0eCwgc2VsZWN0b3IpKTtcblx0ICBmbi5hcHBseShjdHgsIGFyZ3MpO1xuXHRcblx0ICByZXR1cm4gby5hc09ic2VydmFibGUoKTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gY3JlYXRlQ2JIYW5kbGVyKG8sIGN0eCwgc2VsZWN0b3IpIHtcblx0ICByZXR1cm4gZnVuY3Rpb24gaGFuZGxlciAoKSB7XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgcmVzdWx0cyA9IG5ldyBBcnJheShsZW4pO1xuXHQgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IHJlc3VsdHNbaV0gPSBhcmd1bWVudHNbaV07IH1cblx0XG5cdCAgICBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHtcblx0ICAgICAgcmVzdWx0cyA9IHRyeUNhdGNoKHNlbGVjdG9yKS5hcHBseShjdHgsIHJlc3VsdHMpO1xuXHQgICAgICBpZiAocmVzdWx0cyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXN1bHRzLmUpOyB9XG5cdCAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoIDw9IDEpIHtcblx0ICAgICAgICBvLm9uTmV4dChyZXN1bHRzWzBdKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICB9O1xuXHR9XG5cdFxuXHQvKipcblx0ICogQ29udmVydHMgYSBjYWxsYmFjayBmdW5jdGlvbiB0byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgKlxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBGdW5jdGlvbiB3aXRoIGEgY2FsbGJhY2sgYXMgdGhlIGxhc3QgcGFyYW1ldGVyIHRvIGNvbnZlcnQgdG8gYW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICogQHBhcmFtIHtNaXhlZH0gW2N0eF0gVGhlIGNvbnRleHQgZm9yIHRoZSBmdW5jIHBhcmFtZXRlciB0byBiZSBleGVjdXRlZC4gIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIHVuZGVmaW5lZC5cblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBBIHNlbGVjdG9yIHdoaWNoIHRha2VzIHRoZSBhcmd1bWVudHMgZnJvbSB0aGUgY2FsbGJhY2sgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG5cdCAqIEByZXR1cm5zIHtGdW5jdGlvbn0gQSBmdW5jdGlvbiwgd2hlbiBleGVjdXRlZCB3aXRoIHRoZSByZXF1aXJlZCBwYXJhbWV0ZXJzIG1pbnVzIHRoZSBjYWxsYmFjaywgcHJvZHVjZXMgYW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIGEgc2luZ2xlIHZhbHVlIG9mIHRoZSBhcmd1bWVudHMgdG8gdGhlIGNhbGxiYWNrIGFzIGFuIGFycmF5LlxuXHQgKi9cblx0T2JzZXJ2YWJsZS5mcm9tQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZm4sIGN0eCwgc2VsZWN0b3IpIHtcblx0ICByZXR1cm4gZnVuY3Rpb24gKCkge1xuXHQgICAgdHlwZW9mIGN0eCA9PT0gJ3VuZGVmaW5lZCcgJiYgKGN0eCA9IHRoaXMpOyBcblx0XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pXG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuXHQgICAgcmV0dXJuIGNyZWF0ZUNiT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncyk7XG5cdCAgfTtcblx0fTtcblx0XG5cdGZ1bmN0aW9uIGNyZWF0ZU5vZGVPYnNlcnZhYmxlKGZuLCBjdHgsIHNlbGVjdG9yLCBhcmdzKSB7XG5cdCAgdmFyIG8gPSBuZXcgQXN5bmNTdWJqZWN0KCk7XG5cdFxuXHQgIGFyZ3MucHVzaChjcmVhdGVOb2RlSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSk7XG5cdCAgZm4uYXBwbHkoY3R4LCBhcmdzKTtcblx0XG5cdCAgcmV0dXJuIG8uYXNPYnNlcnZhYmxlKCk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGNyZWF0ZU5vZGVIYW5kbGVyKG8sIGN0eCwgc2VsZWN0b3IpIHtcblx0ICByZXR1cm4gZnVuY3Rpb24gaGFuZGxlciAoKSB7XG5cdCAgICB2YXIgZXJyID0gYXJndW1lbnRzWzBdO1xuXHQgICAgaWYgKGVycikgeyByZXR1cm4gby5vbkVycm9yKGVycik7IH1cblx0XG5cdCAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgcmVzdWx0cyA9IFtdO1xuXHQgICAgZm9yKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7IHJlc3VsdHNbaSAtIDFdID0gYXJndW1lbnRzW2ldOyB9XG5cdFxuXHQgICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpKSB7XG5cdCAgICAgIHZhciByZXN1bHRzID0gdHJ5Q2F0Y2goc2VsZWN0b3IpLmFwcGx5KGN0eCwgcmVzdWx0cyk7XG5cdCAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cblx0ICAgICAgby5vbk5leHQocmVzdWx0cyk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBpZiAocmVzdWx0cy5sZW5ndGggPD0gMSkge1xuXHQgICAgICAgIG8ub25OZXh0KHJlc3VsdHNbMF0pO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgIH07XG5cdH1cblx0XG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhIE5vZGUuanMgY2FsbGJhY2sgc3R5bGUgZnVuY3Rpb24gdG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS4gIFRoaXMgbXVzdCBiZSBpbiBmdW5jdGlvbiAoZXJyLCAuLi4pIGZvcm1hdC5cblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGNhbGxcblx0ICogQHBhcmFtIHtNaXhlZH0gW2N0eF0gVGhlIGNvbnRleHQgZm9yIHRoZSBmdW5jIHBhcmFtZXRlciB0byBiZSBleGVjdXRlZC4gIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIHVuZGVmaW5lZC5cblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBBIHNlbGVjdG9yIHdoaWNoIHRha2VzIHRoZSBhcmd1bWVudHMgZnJvbSB0aGUgY2FsbGJhY2sgbWludXMgdGhlIGVycm9yIHRvIHByb2R1Y2UgYSBzaW5nbGUgaXRlbSB0byB5aWVsZCBvbiBuZXh0LlxuXHQgKiBAcmV0dXJucyB7RnVuY3Rpb259IEFuIGFzeW5jIGZ1bmN0aW9uIHdoaWNoIHdoZW4gYXBwbGllZCwgcmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGhlIGNhbGxiYWNrIGFyZ3VtZW50cyBhcyBhbiBhcnJheS5cblx0ICovXG5cdE9ic2VydmFibGUuZnJvbU5vZGVDYWxsYmFjayA9IGZ1bmN0aW9uIChmbiwgY3R4LCBzZWxlY3Rvcikge1xuXHQgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICB0eXBlb2YgY3R4ID09PSAndW5kZWZpbmVkJyAmJiAoY3R4ID0gdGhpcyk7IFxuXHQgICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcblx0ICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cdCAgICByZXR1cm4gY3JlYXRlTm9kZU9ic2VydmFibGUoZm4sIGN0eCwgc2VsZWN0b3IsIGFyZ3MpO1xuXHQgIH07XG5cdH07XG5cdFxuXHQgIGZ1bmN0aW9uIGlzTm9kZUxpc3QoZWwpIHtcblx0ICAgIGlmIChyb290LlN0YXRpY05vZGVMaXN0KSB7XG5cdCAgICAgIC8vIElFOCBTcGVjaWZpY1xuXHQgICAgICAvLyBpbnN0YW5jZW9mIGlzIHNsb3dlciB0aGFuIE9iamVjdCN0b1N0cmluZywgYnV0IE9iamVjdCN0b1N0cmluZyB3aWxsIG5vdCB3b3JrIGFzIGludGVuZGVkIGluIElFOFxuXHQgICAgICByZXR1cm4gZWwgaW5zdGFuY2VvZiByb290LlN0YXRpY05vZGVMaXN0IHx8IGVsIGluc3RhbmNlb2Ygcm9vdC5Ob2RlTGlzdDtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZWwpID09PSAnW29iamVjdCBOb2RlTGlzdF0nO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gTGlzdGVuRGlzcG9zYWJsZShlLCBuLCBmbikge1xuXHQgICAgdGhpcy5fZSA9IGU7XG5cdCAgICB0aGlzLl9uID0gbjtcblx0ICAgIHRoaXMuX2ZuID0gZm47XG5cdCAgICB0aGlzLl9lLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5fbiwgdGhpcy5fZm4sIGZhbHNlKTtcblx0ICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgIH1cblx0ICBMaXN0ZW5EaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgdGhpcy5fZS5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX24sIHRoaXMuX2ZuLCBmYWxzZSk7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gY3JlYXRlRXZlbnRMaXN0ZW5lciAoZWwsIGV2ZW50TmFtZSwgaGFuZGxlcikge1xuXHQgICAgdmFyIGRpc3Bvc2FibGVzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcblx0XG5cdCAgICAvLyBBc3VtZSBOb2RlTGlzdCBvciBIVE1MQ29sbGVjdGlvblxuXHQgICAgdmFyIGVsZW1Ub1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlbCk7XG5cdCAgICBpZiAoaXNOb2RlTGlzdChlbCkgfHwgZWxlbVRvU3RyaW5nID09PSAnW29iamVjdCBIVE1MQ29sbGVjdGlvbl0nKSB7XG5cdCAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBlbC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgIGRpc3Bvc2FibGVzLmFkZChjcmVhdGVFdmVudExpc3RlbmVyKGVsLml0ZW0oaSksIGV2ZW50TmFtZSwgaGFuZGxlcikpO1xuXHQgICAgICB9XG5cdCAgICB9IGVsc2UgaWYgKGVsKSB7XG5cdCAgICAgIGRpc3Bvc2FibGVzLmFkZChuZXcgTGlzdGVuRGlzcG9zYWJsZShlbCwgZXZlbnROYW1lLCBoYW5kbGVyKSk7XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIGRpc3Bvc2FibGVzO1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogQ29uZmlndXJhdGlvbiBvcHRpb24gdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdG8gdXNlIG5hdGl2ZSBldmVudHMgb25seVxuXHQgICAqL1xuXHQgIFJ4LmNvbmZpZy51c2VOYXRpdmVFdmVudHMgPSBmYWxzZTtcblx0XG5cdCAgdmFyIEV2ZW50T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEV2ZW50T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIEV2ZW50T2JzZXJ2YWJsZShlbCwgbmFtZSwgZm4pIHtcblx0ICAgICAgdGhpcy5fZWwgPSBlbDtcblx0ICAgICAgdGhpcy5fbiA9IG5hbWU7XG5cdCAgICAgIHRoaXMuX2ZuID0gZm47XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGNyZWF0ZUhhbmRsZXIobywgZm4pIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuXHQgICAgICAgIHZhciByZXN1bHRzID0gYXJndW1lbnRzWzBdO1xuXHQgICAgICAgIGlmIChpc0Z1bmN0aW9uKGZuKSkge1xuXHQgICAgICAgICAgcmVzdWx0cyA9IHRyeUNhdGNoKGZuKS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuXHQgICAgICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBFdmVudE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gY3JlYXRlRXZlbnRMaXN0ZW5lcihcblx0ICAgICAgICB0aGlzLl9lbCxcblx0ICAgICAgICB0aGlzLl9uLFxuXHQgICAgICAgIGNyZWF0ZUhhbmRsZXIobywgdGhpcy5fZm4pKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEV2ZW50T2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSBhZGRpbmcgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIG1hdGNoaW5nIERPTUVsZW1lbnQgb3IgZWFjaCBpdGVtIGluIHRoZSBOb2RlTGlzdC5cblx0ICAgKiBAcGFyYW0ge09iamVjdH0gZWxlbWVudCBUaGUgRE9NRWxlbWVudCBvciBOb2RlTGlzdCB0byBhdHRhY2ggYSBsaXN0ZW5lci5cblx0ICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnROYW1lIFRoZSBldmVudCBuYW1lIHRvIGF0dGFjaCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBldmVudCBoYW5kbGVyIHRvIHByb2R1Y2UgYSBzaW5nbGUgaXRlbSB0byB5aWVsZCBvbiBuZXh0LlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIGV2ZW50cyBmcm9tIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBhbmQgdGhlIHNwZWNpZmllZCBldmVudC5cblx0ICAgKi9cblx0ICBPYnNlcnZhYmxlLmZyb21FdmVudCA9IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudE5hbWUsIHNlbGVjdG9yKSB7XG5cdCAgICAvLyBOb2RlLmpzIHNwZWNpZmljXG5cdCAgICBpZiAoZWxlbWVudC5hZGRMaXN0ZW5lcikge1xuXHQgICAgICByZXR1cm4gZnJvbUV2ZW50UGF0dGVybihcblx0ICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50LmFkZExpc3RlbmVyKGV2ZW50TmFtZSwgaCk7IH0sXG5cdCAgICAgICAgZnVuY3Rpb24gKGgpIHsgZWxlbWVudC5yZW1vdmVMaXN0ZW5lcihldmVudE5hbWUsIGgpOyB9LFxuXHQgICAgICAgIHNlbGVjdG9yKTtcblx0ICAgIH1cblx0XG5cdCAgICAvLyBVc2Ugb25seSBpZiBub24tbmF0aXZlIGV2ZW50cyBhcmUgYWxsb3dlZFxuXHQgICAgaWYgKCFSeC5jb25maWcudXNlTmF0aXZlRXZlbnRzKSB7XG5cdCAgICAgIC8vIEhhbmRsZXMganEsIEFuZ3VsYXIuanMsIFplcHRvLCBNYXJpb25ldHRlLCBFbWJlci5qc1xuXHQgICAgICBpZiAodHlwZW9mIGVsZW1lbnQub24gPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGVsZW1lbnQub2ZmID09PSAnZnVuY3Rpb24nKSB7XG5cdCAgICAgICAgcmV0dXJuIGZyb21FdmVudFBhdHRlcm4oXG5cdCAgICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50Lm9uKGV2ZW50TmFtZSwgaCk7IH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50Lm9mZihldmVudE5hbWUsIGgpOyB9LFxuXHQgICAgICAgICAgc2VsZWN0b3IpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgcmV0dXJuIG5ldyBFdmVudE9ic2VydmFibGUoZWxlbWVudCwgZXZlbnROYW1lLCBzZWxlY3RvcikucHVibGlzaCgpLnJlZkNvdW50KCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIEV2ZW50UGF0dGVybk9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhFdmVudFBhdHRlcm5PYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZShhZGQsIGRlbCwgZm4pIHtcblx0ICAgICAgdGhpcy5fYWRkID0gYWRkO1xuXHQgICAgICB0aGlzLl9kZWwgPSBkZWw7XG5cdCAgICAgIHRoaXMuX2ZuID0gZm47XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIGNyZWF0ZUhhbmRsZXIobywgZm4pIHtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuXHQgICAgICAgIHZhciByZXN1bHRzID0gYXJndW1lbnRzWzBdO1xuXHQgICAgICAgIGlmIChpc0Z1bmN0aW9uKGZuKSkge1xuXHQgICAgICAgICAgcmVzdWx0cyA9IHRyeUNhdGNoKGZuKS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuXHQgICAgICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuXHQgICAgICAgIH1cblx0ICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICBFdmVudFBhdHRlcm5PYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGZuID0gY3JlYXRlSGFuZGxlcihvLCB0aGlzLl9mbik7XG5cdCAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHRoaXMuX2FkZChmbik7XG5cdCAgICAgIHJldHVybiBuZXcgRXZlbnRQYXR0ZXJuRGlzcG9zYWJsZSh0aGlzLl9kZWwsIGZuLCByZXR1cm5WYWx1ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIEV2ZW50UGF0dGVybkRpc3Bvc2FibGUoZGVsLCBmbiwgcmV0KSB7XG5cdCAgICAgIHRoaXMuX2RlbCA9IGRlbDtcblx0ICAgICAgdGhpcy5fZm4gPSBmbjtcblx0ICAgICAgdGhpcy5fcmV0ID0gcmV0O1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICBFdmVudFBhdHRlcm5EaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZighdGhpcy5pc0Rpc3Bvc2VkKSB7XG5cdCAgICAgICAgaXNGdW5jdGlvbih0aGlzLl9kZWwpICYmIHRoaXMuX2RlbCh0aGlzLl9mbiwgdGhpcy5fcmV0KTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBmcm9tIGFuIGV2ZW50IGVtaXR0ZXIgdmlhIGFuIGFkZEhhbmRsZXIvcmVtb3ZlSGFuZGxlciBwYWlyLlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFkZEhhbmRsZXIgVGhlIGZ1bmN0aW9uIHRvIGFkZCBhIGhhbmRsZXIgdG8gdGhlIGVtaXR0ZXIuXG5cdCAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3JlbW92ZUhhbmRsZXJdIFRoZSBvcHRpb25hbCBmdW5jdGlvbiB0byByZW1vdmUgYSBoYW5kbGVyIGZyb20gYW4gZW1pdHRlci5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBldmVudCBoYW5kbGVyIHRvIHByb2R1Y2UgYSBzaW5nbGUgaXRlbSB0byB5aWVsZCBvbiBuZXh0LlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIHdyYXBzIGFuIGV2ZW50IGZyb20gYW4gZXZlbnQgZW1pdHRlclxuXHQgICAqL1xuXHQgIHZhciBmcm9tRXZlbnRQYXR0ZXJuID0gT2JzZXJ2YWJsZS5mcm9tRXZlbnRQYXR0ZXJuID0gZnVuY3Rpb24gKGFkZEhhbmRsZXIsIHJlbW92ZUhhbmRsZXIsIHNlbGVjdG9yKSB7XG5cdCAgICByZXR1cm4gbmV3IEV2ZW50UGF0dGVybk9ic2VydmFibGUoYWRkSGFuZGxlciwgcmVtb3ZlSGFuZGxlciwgc2VsZWN0b3IpLnB1Ymxpc2goKS5yZWZDb3VudCgpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBGcm9tUHJvbWlzZU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhGcm9tUHJvbWlzZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBGcm9tUHJvbWlzZU9ic2VydmFibGUocCwgcykge1xuXHQgICAgICB0aGlzLl9wID0gcDtcblx0ICAgICAgdGhpcy5fcyA9IHM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIHNjaGVkdWxlTmV4dChzLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgbyA9IHN0YXRlWzBdLCBkYXRhID0gc3RhdGVbMV07XG5cdCAgICAgIG8ub25OZXh0KGRhdGEpO1xuXHQgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgZnVuY3Rpb24gc2NoZWR1bGVFcnJvcihzLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgbyA9IHN0YXRlWzBdLCBlcnIgPSBzdGF0ZVsxXTtcblx0ICAgICAgby5vbkVycm9yKGVycik7XG5cdCAgICB9XG5cdFxuXHQgICAgRnJvbVByb21pc2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuXHQgICAgICB2YXIgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIHNlbGYgPSB0aGlzO1xuXHRcblx0ICAgICAgdGhpcy5fcFxuXHQgICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cdCAgICAgICAgICBzYWQuc2V0RGlzcG9zYWJsZShzZWxmLl9zLnNjaGVkdWxlKFtvLCBkYXRhXSwgc2NoZWR1bGVOZXh0KSk7XG5cdCAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuXHQgICAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc2VsZi5fcy5zY2hlZHVsZShbbywgZXJyXSwgc2NoZWR1bGVFcnJvcikpO1xuXHQgICAgICAgIH0pO1xuXHRcblx0ICAgICAgcmV0dXJuIHNhZDtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIEZyb21Qcm9taXNlT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICogQ29udmVydHMgYSBQcm9taXNlIHRvIGFuIE9ic2VydmFibGUgc2VxdWVuY2Vcblx0ICAqIEBwYXJhbSB7UHJvbWlzZX0gQW4gRVM2IENvbXBsaWFudCBwcm9taXNlLlxuXHQgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIE9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggd3JhcHMgdGhlIGV4aXN0aW5nIHByb21pc2Ugc3VjY2VzcyBhbmQgZmFpbHVyZS5cblx0ICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlRnJvbVByb21pc2UgPSBPYnNlcnZhYmxlLmZyb21Qcm9taXNlID0gZnVuY3Rpb24gKHByb21pc2UsIHNjaGVkdWxlcikge1xuXHQgICAgc2NoZWR1bGVyIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcblx0ICAgIHJldHVybiBuZXcgRnJvbVByb21pc2VPYnNlcnZhYmxlKHByb21pc2UsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgLypcblx0ICAgKiBDb252ZXJ0cyBhbiBleGlzdGluZyBvYnNlcnZhYmxlIHNlcXVlbmNlIHRvIGFuIEVTNiBDb21wYXRpYmxlIFByb21pc2Vcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciBwcm9taXNlID0gUnguT2JzZXJ2YWJsZS5yZXR1cm4oNDIpLnRvUHJvbWlzZShSU1ZQLlByb21pc2UpO1xuXHQgICAqXG5cdCAgICogLy8gV2l0aCBjb25maWdcblx0ICAgKiBSeC5jb25maWcuUHJvbWlzZSA9IFJTVlAuUHJvbWlzZTtcblx0ICAgKiB2YXIgcHJvbWlzZSA9IFJ4Lk9ic2VydmFibGUucmV0dXJuKDQyKS50b1Byb21pc2UoKTtcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJvbWlzZUN0b3JdIFRoZSBjb25zdHJ1Y3RvciBvZiB0aGUgcHJvbWlzZS4gSWYgbm90IHByb3ZpZGVkLCBpdCBsb29rcyBmb3IgaXQgaW4gUnguY29uZmlnLlByb21pc2UuXG5cdCAgICogQHJldHVybnMge1Byb21pc2V9IEFuIEVTNiBjb21wYXRpYmxlIHByb21pc2Ugd2l0aCB0aGUgbGFzdCB2YWx1ZSBmcm9tIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by50b1Byb21pc2UgPSBmdW5jdGlvbiAocHJvbWlzZUN0b3IpIHtcblx0ICAgIHByb21pc2VDdG9yIHx8IChwcm9taXNlQ3RvciA9IFJ4LmNvbmZpZy5Qcm9taXNlKTtcblx0ICAgIGlmICghcHJvbWlzZUN0b3IpIHsgdGhyb3cgbmV3IE5vdFN1cHBvcnRlZEVycm9yKCdQcm9taXNlIHR5cGUgbm90IHByb3ZpZGVkIG5vciBpbiBSeC5jb25maWcuUHJvbWlzZScpOyB9XG5cdCAgICB2YXIgc291cmNlID0gdGhpcztcblx0ICAgIHJldHVybiBuZXcgcHJvbWlzZUN0b3IoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAvLyBObyBjYW5jZWxsYXRpb24gY2FuIGJlIGRvbmVcblx0ICAgICAgdmFyIHZhbHVlO1xuXHQgICAgICBzb3VyY2Uuc3Vic2NyaWJlKGZ1bmN0aW9uICh2KSB7XG5cdCAgICAgICAgdmFsdWUgPSB2O1xuXHQgICAgICB9LCByZWplY3QsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXNvbHZlKHZhbHVlKTtcblx0ICAgICAgfSk7XG5cdCAgICB9KTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBJbnZva2VzIHRoZSBhc3luY2hyb25vdXMgZnVuY3Rpb24sIHN1cmZhY2luZyB0aGUgcmVzdWx0IHRocm91Z2ggYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jdGlvbkFzeW5jIEFzeW5jaHJvbm91cyBmdW5jdGlvbiB3aGljaCByZXR1cm5zIGEgUHJvbWlzZSB0byBydW4uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgZXhwb3NpbmcgdGhlIGZ1bmN0aW9uJ3MgcmVzdWx0IHZhbHVlLCBvciBhbiBleGNlcHRpb24uXG5cdCAgICovXG5cdCAgT2JzZXJ2YWJsZS5zdGFydEFzeW5jID0gZnVuY3Rpb24gKGZ1bmN0aW9uQXN5bmMpIHtcblx0ICAgIHZhciBwcm9taXNlID0gdHJ5Q2F0Y2goZnVuY3Rpb25Bc3luYykoKTtcblx0ICAgIGlmIChwcm9taXNlID09PSBlcnJvck9iaikgeyByZXR1cm4gb2JzZXJ2YWJsZVRocm93KHByb21pc2UuZSk7IH1cblx0ICAgIHJldHVybiBvYnNlcnZhYmxlRnJvbVByb21pc2UocHJvbWlzZSk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIE11bHRpY2FzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoTXVsdGljYXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIE11bHRpY2FzdE9ic2VydmFibGUoc291cmNlLCBmbjEsIGZuMikge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fZm4xID0gZm4xO1xuXHQgICAgICB0aGlzLl9mbjIgPSBmbjI7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIE11bHRpY2FzdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgY29ubmVjdGFibGUgPSB0aGlzLnNvdXJjZS5tdWx0aWNhc3QodGhpcy5fZm4xKCkpO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUodGhpcy5fZm4yKGNvbm5lY3RhYmxlKS5zdWJzY3JpYmUobyksIGNvbm5lY3RhYmxlLmNvbm5lY3QoKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBNdWx0aWNhc3RPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogTXVsdGljYXN0cyB0aGUgc291cmNlIHNlcXVlbmNlIG5vdGlmaWNhdGlvbnMgdGhyb3VnaCBhbiBpbnN0YW50aWF0ZWQgc3ViamVjdCBpbnRvIGFsbCB1c2VzIG9mIHRoZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi4gRWFjaFxuXHQgICAqIHN1YnNjcmlwdGlvbiB0byB0aGUgcmVzdWx0aW5nIHNlcXVlbmNlIGNhdXNlcyBhIHNlcGFyYXRlIG11bHRpY2FzdCBpbnZvY2F0aW9uLCBleHBvc2luZyB0aGUgc2VxdWVuY2UgcmVzdWx0aW5nIGZyb20gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uJ3Ncblx0ICAgKiBpbnZvY2F0aW9uLiBGb3Igc3BlY2lhbGl6YXRpb25zIHdpdGggZml4ZWQgc3ViamVjdCB0eXBlcywgc2VlIFB1Ymxpc2gsIFB1Ymxpc2hMYXN0LCBhbmQgUmVwbGF5LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiAxIC0gcmVzID0gc291cmNlLm11bHRpY2FzdChvYnNlcnZhYmxlKTtcblx0ICAgKiAyIC0gcmVzID0gc291cmNlLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgU3ViamVjdCgpOyB9LCBmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSk7XG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFN1YmplY3R9IHN1YmplY3RPclN1YmplY3RTZWxlY3RvclxuXHQgICAqIEZhY3RvcnkgZnVuY3Rpb24gdG8gY3JlYXRlIGFuIGludGVybWVkaWF0ZSBzdWJqZWN0IHRocm91Z2ggd2hpY2ggdGhlIHNvdXJjZSBzZXF1ZW5jZSdzIGVsZW1lbnRzIHdpbGwgYmUgbXVsdGljYXN0IHRvIHRoZSBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKiBPcjpcblx0ICAgKiBTdWJqZWN0IHRvIHB1c2ggc291cmNlIGVsZW1lbnRzIGludG8uXG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIE9wdGlvbmFsIHNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBzdWJqZWN0IHRvIHRoZSBwb2xpY2llcyBlbmZvcmNlZCBieSB0aGUgY3JlYXRlZCBzdWJqZWN0LiBTcGVjaWZpZWQgb25seSBpZiA8cGFyYW1yZWYgbmFtZT1cInN1YmplY3RPclN1YmplY3RTZWxlY3RvclwiIGlzIGEgZmFjdG9yeSBmdW5jdGlvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5tdWx0aWNhc3QgPSBmdW5jdGlvbiAoc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yLCBzZWxlY3Rvcikge1xuXHQgICAgcmV0dXJuIGlzRnVuY3Rpb24oc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yKSA/XG5cdCAgICAgIG5ldyBNdWx0aWNhc3RPYnNlcnZhYmxlKHRoaXMsIHN1YmplY3RPclN1YmplY3RTZWxlY3Rvciwgc2VsZWN0b3IpIDpcblx0ICAgICAgbmV3IENvbm5lY3RhYmxlT2JzZXJ2YWJsZSh0aGlzLCBzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG5cdCAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIHJlZ3VsYXIgU3ViamVjdC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHJlc3JlcyA9IHNvdXJjZS5wdWJsaXNoKCk7XG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gU2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgcmVjZWl2ZSBhbGwgbm90aWZpY2F0aW9ucyBvZiB0aGUgc291cmNlIGZyb20gdGhlIHRpbWUgb2YgdGhlIHN1YnNjcmlwdGlvbiBvbi5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5wdWJsaXNoID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG5cdCAgICByZXR1cm4gc2VsZWN0b3IgJiYgaXNGdW5jdGlvbihzZWxlY3RvcikgP1xuXHQgICAgICB0aGlzLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgU3ViamVjdCgpOyB9LCBzZWxlY3RvcikgOlxuXHQgICAgICB0aGlzLm11bHRpY2FzdChuZXcgU3ViamVjdCgpKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuXHQgICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBwdWJsaXNoIHdoaWNoIGNyZWF0ZXMgYSBzdWJzY3JpcHRpb24gd2hlbiB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyBnb2VzIGZyb20gemVybyB0byBvbmUsIHRoZW4gc2hhcmVzIHRoYXQgc3Vic2NyaXB0aW9uIHdpdGggYWxsIHN1YnNlcXVlbnQgb2JzZXJ2ZXJzIHVudGlsIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIHJldHVybnMgdG8gemVybywgYXQgd2hpY2ggcG9pbnQgdGhlIHN1YnNjcmlwdGlvbiBpcyBkaXNwb3NlZC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5zaGFyZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHJldHVybiB0aGlzLnB1Ymxpc2goKS5yZWZDb3VudCgpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgY29udGFpbmluZyBvbmx5IHRoZSBsYXN0IG5vdGlmaWNhdGlvbi5cblx0ICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgTXVsdGljYXN0IHVzaW5nIGEgQXN5bmNTdWJqZWN0LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hMYXN0KCk7XG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoTGFzdChmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSk7XG5cdCAgICpcblx0ICAgKiBAcGFyYW0gc2VsZWN0b3IgW09wdGlvbmFsXSBTZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2UgYXMgbWFueSB0aW1lcyBhcyBuZWVkZWQsIHdpdGhvdXQgY2F1c2luZyBtdWx0aXBsZSBzdWJzY3JpcHRpb25zIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UuIFN1YnNjcmliZXJzIHRvIHRoZSBnaXZlbiBzb3VyY2Ugd2lsbCBvbmx5IHJlY2VpdmUgdGhlIGxhc3Qgbm90aWZpY2F0aW9uIG9mIHRoZSBzb3VyY2UuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucHVibGlzaExhc3QgPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcblx0ICAgIHJldHVybiBzZWxlY3RvciAmJiBpc0Z1bmN0aW9uKHNlbGVjdG9yKSA/XG5cdCAgICAgIHRoaXMubXVsdGljYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBBc3luY1N1YmplY3QoKTsgfSwgc2VsZWN0b3IpIDpcblx0ICAgICAgdGhpcy5tdWx0aWNhc3QobmV3IEFzeW5jU3ViamVjdCgpKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSBzZWxlY3RvciBvbiBhIGNvbm5lY3RhYmxlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIGFuZCBzdGFydHMgd2l0aCBpbml0aWFsVmFsdWUuXG5cdCAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIEJlaGF2aW9yU3ViamVjdC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoVmFsdWUoNDIpO1xuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucHVibGlzaFZhbHVlKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnNlbGVjdChmdW5jdGlvbiAoeSkgeyByZXR1cm4geSAqIHk7IH0pIH0sIDQyKTtcblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gT3B0aW9uYWwgc2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgcmVjZWl2ZSBpbW1lZGlhdGVseSByZWNlaXZlIHRoZSBpbml0aWFsIHZhbHVlLCBmb2xsb3dlZCBieSBhbGwgbm90aWZpY2F0aW9ucyBvZiB0aGUgc291cmNlIGZyb20gdGhlIHRpbWUgb2YgdGhlIHN1YnNjcmlwdGlvbiBvbi5cblx0ICAgKiBAcGFyYW0ge01peGVkfSBpbml0aWFsVmFsdWUgSW5pdGlhbCB2YWx1ZSByZWNlaXZlZCBieSBvYnNlcnZlcnMgdXBvbiBzdWJzY3JpcHRpb24uXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8ucHVibGlzaFZhbHVlID0gZnVuY3Rpb24gKGluaXRpYWxWYWx1ZU9yU2VsZWN0b3IsIGluaXRpYWxWYWx1ZSkge1xuXHQgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPT09IDIgP1xuXHQgICAgICB0aGlzLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBCZWhhdmlvclN1YmplY3QoaW5pdGlhbFZhbHVlKTtcblx0ICAgICAgfSwgaW5pdGlhbFZhbHVlT3JTZWxlY3RvcikgOlxuXHQgICAgICB0aGlzLm11bHRpY2FzdChuZXcgQmVoYXZpb3JTdWJqZWN0KGluaXRpYWxWYWx1ZU9yU2VsZWN0b3IpKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIGFuZCBzdGFydHMgd2l0aCBhbiBpbml0aWFsVmFsdWUuXG5cdCAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIHB1Ymxpc2hWYWx1ZSB3aGljaCBjcmVhdGVzIGEgc3Vic2NyaXB0aW9uIHdoZW4gdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgZ29lcyBmcm9tIHplcm8gdG8gb25lLCB0aGVuIHNoYXJlcyB0aGF0IHN1YnNjcmlwdGlvbiB3aXRoIGFsbCBzdWJzZXF1ZW50IG9ic2VydmVycyB1bnRpbCB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyByZXR1cm5zIHRvIHplcm8sIGF0IHdoaWNoIHBvaW50IHRoZSBzdWJzY3JpcHRpb24gaXMgZGlzcG9zZWQuXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gaW5pdGlhbFZhbHVlIEluaXRpYWwgdmFsdWUgcmVjZWl2ZWQgYnkgb2JzZXJ2ZXJzIHVwb24gc3Vic2NyaXB0aW9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNoYXJlVmFsdWUgPSBmdW5jdGlvbiAoaW5pdGlhbFZhbHVlKSB7XG5cdCAgICByZXR1cm4gdGhpcy5wdWJsaXNoVmFsdWUoaW5pdGlhbFZhbHVlKS5yZWZDb3VudCgpO1xuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgcmVwbGF5aW5nIG5vdGlmaWNhdGlvbnMgc3ViamVjdCB0byBhIG1heGltdW0gdGltZSBsZW5ndGggZm9yIHRoZSByZXBsYXkgYnVmZmVyLlxuXHQgICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBNdWx0aWNhc3QgdXNpbmcgYSBSZXBsYXlTdWJqZWN0LlxuXHQgICAqXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShudWxsLCAzKTtcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShudWxsLCAzLCA1MDApO1xuXHQgICAqIHZhciByZXMgPSBzb3VyY2UucmVwbGF5KG51bGwsIDMsIDUwMCwgc2NoZWR1bGVyKTtcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC50YWtlKDYpLnJlcGVhdCgpOyB9LCAzLCA1MDAsIHNjaGVkdWxlcik7XG5cdCAgICpcblx0ICAgKiBAcGFyYW0gc2VsZWN0b3IgW09wdGlvbmFsXSBTZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2UgYXMgbWFueSB0aW1lcyBhcyBuZWVkZWQsIHdpdGhvdXQgY2F1c2luZyBtdWx0aXBsZSBzdWJzY3JpcHRpb25zIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UuIFN1YnNjcmliZXJzIHRvIHRoZSBnaXZlbiBzb3VyY2Ugd2lsbCByZWNlaXZlIGFsbCB0aGUgbm90aWZpY2F0aW9ucyBvZiB0aGUgc291cmNlIHN1YmplY3QgdG8gdGhlIHNwZWNpZmllZCByZXBsYXkgYnVmZmVyIHRyaW1taW5nIHBvbGljeS5cblx0ICAgKiBAcGFyYW0gYnVmZmVyU2l6ZSBbT3B0aW9uYWxdIE1heGltdW0gZWxlbWVudCBjb3VudCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cblx0ICAgKiBAcGFyYW0gd2luZG93U2l6ZSBbT3B0aW9uYWxdIE1heGltdW0gdGltZSBsZW5ndGggb2YgdGhlIHJlcGxheSBidWZmZXIuXG5cdCAgICogQHBhcmFtIHNjaGVkdWxlciBbT3B0aW9uYWxdIFNjaGVkdWxlciB3aGVyZSBjb25uZWN0ZWQgb2JzZXJ2ZXJzIHdpdGhpbiB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2lsbCBiZSBpbnZva2VkIG9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnJlcGxheSA9IGZ1bmN0aW9uIChzZWxlY3RvciwgYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSB7XG5cdCAgICByZXR1cm4gc2VsZWN0b3IgJiYgaXNGdW5jdGlvbihzZWxlY3RvcikgP1xuXHQgICAgICB0aGlzLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7IHJldHVybiBuZXcgUmVwbGF5U3ViamVjdChidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpOyB9LCBzZWxlY3RvcikgOlxuXHQgICAgICB0aGlzLm11bHRpY2FzdChuZXcgUmVwbGF5U3ViamVjdChidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIHJlcGxheWluZyBub3RpZmljYXRpb25zIHN1YmplY3QgdG8gYSBtYXhpbXVtIHRpbWUgbGVuZ3RoIGZvciB0aGUgcmVwbGF5IGJ1ZmZlci5cblx0ICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgcmVwbGF5IHdoaWNoIGNyZWF0ZXMgYSBzdWJzY3JpcHRpb24gd2hlbiB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyBnb2VzIGZyb20gemVybyB0byBvbmUsIHRoZW4gc2hhcmVzIHRoYXQgc3Vic2NyaXB0aW9uIHdpdGggYWxsIHN1YnNlcXVlbnQgb2JzZXJ2ZXJzIHVudGlsIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIHJldHVybnMgdG8gemVybywgYXQgd2hpY2ggcG9pbnQgdGhlIHN1YnNjcmlwdGlvbiBpcyBkaXNwb3NlZC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5zaGFyZVJlcGxheSgzKTtcblx0ICAgKiB2YXIgcmVzID0gc291cmNlLnNoYXJlUmVwbGF5KDMsIDUwMCk7XG5cdCAgICogdmFyIHJlcyA9IHNvdXJjZS5zaGFyZVJlcGxheSgzLCA1MDAsIHNjaGVkdWxlcik7XG5cdCAgICpcblx0XG5cdCAgICogQHBhcmFtIGJ1ZmZlclNpemUgW09wdGlvbmFsXSBNYXhpbXVtIGVsZW1lbnQgY291bnQgb2YgdGhlIHJlcGxheSBidWZmZXIuXG5cdCAgICogQHBhcmFtIHdpbmRvdyBbT3B0aW9uYWxdIE1heGltdW0gdGltZSBsZW5ndGggb2YgdGhlIHJlcGxheSBidWZmZXIuXG5cdCAgICogQHBhcmFtIHNjaGVkdWxlciBbT3B0aW9uYWxdIFNjaGVkdWxlciB3aGVyZSBjb25uZWN0ZWQgb2JzZXJ2ZXJzIHdpdGhpbiB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2lsbCBiZSBpbnZva2VkIG9uLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnNoYXJlUmVwbGF5ID0gZnVuY3Rpb24gKGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikge1xuXHQgICAgcmV0dXJuIHRoaXMucmVwbGF5KG51bGwsIGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikucmVmQ291bnQoKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgUmVmQ291bnRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFJlZkNvdW50T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFJlZkNvdW50T2JzZXJ2YWJsZShzb3VyY2UpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2NvdW50ID0gMDtcblx0ICAgICAgdGhpcy5fY29ubmVjdGFibGVTdWJzY3JpcHRpb24gPSBudWxsO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBSZWZDb3VudE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgc2hvdWxkQ29ubmVjdCA9ICsrdGhpcy5fY291bnQgPT09IDEsIHN1YnNjcmlwdGlvbiA9IHRoaXMuc291cmNlLnN1YnNjcmliZShvKTtcblx0ICAgICAgc2hvdWxkQ29ubmVjdCAmJiAodGhpcy5fY29ubmVjdGFibGVTdWJzY3JpcHRpb24gPSB0aGlzLnNvdXJjZS5jb25uZWN0KCkpO1xuXHQgICAgICByZXR1cm4gbmV3IFJlZkNvdW50RGlzcG9zYWJsZSh0aGlzLCBzdWJzY3JpcHRpb24pO1xuXHQgICAgfTtcblx0XG5cdCAgICBmdW5jdGlvbiBSZWZDb3VudERpc3Bvc2FibGUocCwgcykge1xuXHQgICAgICB0aGlzLl9wID0gcDtcblx0ICAgICAgdGhpcy5fcyA9IHM7XG5cdCAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIFJlZkNvdW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuX3MuZGlzcG9zZSgpO1xuXHQgICAgICAgIC0tdGhpcy5fcC5fY291bnQgPT09IDAgJiYgdGhpcy5fcC5fY29ubmVjdGFibGVTdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBSZWZDb3VudE9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXHRcblx0ICB2YXIgQ29ubmVjdGFibGVPYnNlcnZhYmxlID0gUnguQ29ubmVjdGFibGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENvbm5lY3RhYmxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIENvbm5lY3RhYmxlT2JzZXJ2YWJsZShzb3VyY2UsIHN1YmplY3QpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2hhc1N1YnNjcmlwdGlvbiAgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5fc3Vic2NyaXB0aW9uID0gbnVsbDtcblx0ICAgICAgdGhpcy5fc291cmNlT2JzZXJ2YWJsZSA9IHNvdXJjZS5hc09ic2VydmFibGUoKTtcblx0ICAgICAgdGhpcy5fc3ViamVjdCA9IHN1YmplY3Q7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIENvbm5lY3REaXNwb3NhYmxlKHBhcmVudCkge1xuXHQgICAgICB0aGlzLl9wID0gcGFyZW50O1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICBDb25uZWN0RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcblx0ICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuX3AuX2hhc1N1YnNjcmlwdGlvbiA9IGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXHRcblx0ICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKCF0aGlzLl9oYXNTdWJzY3JpcHRpb24pIHtcblx0ICAgICAgICB0aGlzLl9oYXNTdWJzY3JpcHRpb24gPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuXHQgICAgICAgICAgdGhpcy5fc291cmNlT2JzZXJ2YWJsZS5zdWJzY3JpYmUodGhpcy5fc3ViamVjdCksXG5cdCAgICAgICAgICBuZXcgQ29ubmVjdERpc3Bvc2FibGUodGhpcylcblx0ICAgICAgICApO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb247XG5cdCAgICB9O1xuXHRcblx0ICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLl9zdWJqZWN0LnN1YnNjcmliZShvKTtcblx0ICAgIH07XG5cdFxuXHQgICAgQ29ubmVjdGFibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5yZWZDb3VudCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBSZWZDb3VudE9ic2VydmFibGUodGhpcyk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBDb25uZWN0YWJsZU9ic2VydmFibGU7XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIHZhciBUaW1lck9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhUaW1lck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUaW1lck9ic2VydmFibGUoZHQsIHMpIHtcblx0ICAgICAgdGhpcy5fZHQgPSBkdDtcblx0ICAgICAgdGhpcy5fcyA9IHM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRpbWVyT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLl9zLnNjaGVkdWxlRnV0dXJlKG8sIHRoaXMuX2R0LCBzY2hlZHVsZU1ldGhvZCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIGZ1bmN0aW9uIHNjaGVkdWxlTWV0aG9kKHMsIG8pIHtcblx0ICAgICAgby5vbk5leHQoMCk7XG5cdCAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgIH1cblx0XG5cdCAgICByZXR1cm4gVGltZXJPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgZnVuY3Rpb24gX29ic2VydmFibGVUaW1lcihkdWVUaW1lLCBzY2hlZHVsZXIpIHtcblx0ICAgIHJldHVybiBuZXcgVGltZXJPYnNlcnZhYmxlKGR1ZVRpbWUsIHNjaGVkdWxlcik7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBvYnNlcnZhYmxlVGltZXJEYXRlQW5kUGVyaW9kKGR1ZVRpbWUsIHBlcmlvZCwgc2NoZWR1bGVyKSB7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG5cdCAgICAgIHZhciBkID0gZHVlVGltZSwgcCA9IG5vcm1hbGl6ZVRpbWUocGVyaW9kKTtcblx0ICAgICAgcmV0dXJuIHNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZUZ1dHVyZSgwLCBkLCBmdW5jdGlvbiAoY291bnQsIHNlbGYpIHtcblx0ICAgICAgICBpZiAocCA+IDApIHtcblx0ICAgICAgICAgIHZhciBub3cgPSBzY2hlZHVsZXIubm93KCk7XG5cdCAgICAgICAgICBkID0gbmV3IERhdGUoZC5nZXRUaW1lKCkgKyBwKTtcblx0ICAgICAgICAgIGQuZ2V0VGltZSgpIDw9IG5vdyAmJiAoZCA9IG5ldyBEYXRlKG5vdyArIHApKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgb2JzZXJ2ZXIub25OZXh0KGNvdW50KTtcblx0ICAgICAgICBzZWxmKGNvdW50ICsgMSwgbmV3IERhdGUoZCkpO1xuXHQgICAgICB9KTtcblx0ICAgIH0pO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gb2JzZXJ2YWJsZVRpbWVyVGltZVNwYW5BbmRQZXJpb2QoZHVlVGltZSwgcGVyaW9kLCBzY2hlZHVsZXIpIHtcblx0ICAgIHJldHVybiBkdWVUaW1lID09PSBwZXJpb2QgP1xuXHQgICAgICBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcblx0ICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlUGVyaW9kaWMoMCwgcGVyaW9kLCBmdW5jdGlvbiAoY291bnQpIHtcblx0ICAgICAgICAgIG9ic2VydmVyLm9uTmV4dChjb3VudCk7XG5cdCAgICAgICAgICByZXR1cm4gY291bnQgKyAxO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9KSA6XG5cdCAgICAgIG9ic2VydmFibGVEZWZlcihmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIG9ic2VydmFibGVUaW1lckRhdGVBbmRQZXJpb2QobmV3IERhdGUoc2NoZWR1bGVyLm5vdygpICsgZHVlVGltZSksIHBlcmlvZCwgc2NoZWR1bGVyKTtcblx0ICAgICAgfSk7XG5cdCAgfVxuXHRcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcHJvZHVjZXMgYSB2YWx1ZSBhZnRlciBlYWNoIHBlcmlvZC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogIDEgLSByZXMgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMDApO1xuXHQgICAqICAyIC0gcmVzID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDAwLCBSeC5TY2hlZHVsZXIudGltZW91dCk7XG5cdCAgICpcblx0ICAgKiBAcGFyYW0ge051bWJlcn0gcGVyaW9kIFBlcmlvZCBmb3IgcHJvZHVjaW5nIHRoZSB2YWx1ZXMgaW4gdGhlIHJlc3VsdGluZyBzZXF1ZW5jZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKS5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIFJ4LlNjaGVkdWxlci50aW1lb3V0IGlzIHVzZWQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBwcm9kdWNlcyBhIHZhbHVlIGFmdGVyIGVhY2ggcGVyaW9kLlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlaW50ZXJ2YWwgPSBPYnNlcnZhYmxlLmludGVydmFsID0gZnVuY3Rpb24gKHBlcmlvZCwgc2NoZWR1bGVyKSB7XG5cdCAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyVGltZVNwYW5BbmRQZXJpb2QocGVyaW9kLCBwZXJpb2QsIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgPyBzY2hlZHVsZXIgOiBkZWZhdWx0U2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgcHJvZHVjZXMgYSB2YWx1ZSBhZnRlciBkdWVUaW1lIGhhcyBlbGFwc2VkIGFuZCB0aGVuIGFmdGVyIGVhY2ggcGVyaW9kLlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBkdWVUaW1lIEFic29sdXRlIChzcGVjaWZpZWQgYXMgYSBEYXRlIG9iamVjdCkgb3IgcmVsYXRpdmUgdGltZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSBhdCB3aGljaCB0byBwcm9kdWNlIHRoZSBmaXJzdCB2YWx1ZS5cblx0ICAgKiBAcGFyYW0ge01peGVkfSBbcGVyaW9kT3JTY2hlZHVsZXJdICBQZXJpb2QgdG8gcHJvZHVjZSBzdWJzZXF1ZW50IHZhbHVlcyAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSwgb3IgdGhlIHNjaGVkdWxlciB0byBydW4gdGhlIHRpbWVyIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgcmVzdWx0aW5nIHRpbWVyIGlzIG5vdCByZWN1cnJpbmcuXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdICBTY2hlZHVsZXIgdG8gcnVuIHRoZSB0aW1lciBvbi4gSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWVvdXQgc2NoZWR1bGVyIGlzIHVzZWQuXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBwcm9kdWNlcyBhIHZhbHVlIGFmdGVyIGR1ZSB0aW1lIGhhcyBlbGFwc2VkIGFuZCB0aGVuIGVhY2ggcGVyaW9kLlxuXHQgICAqL1xuXHQgIHZhciBvYnNlcnZhYmxlVGltZXIgPSBPYnNlcnZhYmxlLnRpbWVyID0gZnVuY3Rpb24gKGR1ZVRpbWUsIHBlcmlvZE9yU2NoZWR1bGVyLCBzY2hlZHVsZXIpIHtcblx0ICAgIHZhciBwZXJpb2Q7XG5cdCAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcblx0ICAgIGlmIChwZXJpb2RPclNjaGVkdWxlciAhPSBudWxsICYmIHR5cGVvZiBwZXJpb2RPclNjaGVkdWxlciA9PT0gJ251bWJlcicpIHtcblx0ICAgICAgcGVyaW9kID0gcGVyaW9kT3JTY2hlZHVsZXI7XG5cdCAgICB9IGVsc2UgaWYgKGlzU2NoZWR1bGVyKHBlcmlvZE9yU2NoZWR1bGVyKSkge1xuXHQgICAgICBzY2hlZHVsZXIgPSBwZXJpb2RPclNjaGVkdWxlcjtcblx0ICAgIH1cblx0ICAgIGlmICgoZHVlVGltZSBpbnN0YW5jZW9mIERhdGUgfHwgdHlwZW9mIGR1ZVRpbWUgPT09ICdudW1iZXInKSAmJiBwZXJpb2QgPT09IHVuZGVmaW5lZCkge1xuXHQgICAgICByZXR1cm4gX29ic2VydmFibGVUaW1lcihkdWVUaW1lLCBzY2hlZHVsZXIpO1xuXHQgICAgfVxuXHQgICAgaWYgKGR1ZVRpbWUgaW5zdGFuY2VvZiBEYXRlICYmIHBlcmlvZCAhPT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJEYXRlQW5kUGVyaW9kKGR1ZVRpbWUuZ2V0VGltZSgpLCBwZXJpb2RPclNjaGVkdWxlciwgc2NoZWR1bGVyKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZChkdWVUaW1lLCBwZXJpb2QsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUoc291cmNlLCBkdWVUaW1lLCBzY2hlZHVsZXIpIHtcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgYWN0aXZlID0gZmFsc2UsXG5cdCAgICAgICAgY2FuY2VsYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG5cdCAgICAgICAgZXhjZXB0aW9uID0gbnVsbCxcblx0ICAgICAgICBxID0gW10sXG5cdCAgICAgICAgcnVubmluZyA9IGZhbHNlLFxuXHQgICAgICAgIHN1YnNjcmlwdGlvbjtcblx0ICAgICAgc3Vic2NyaXB0aW9uID0gc291cmNlLm1hdGVyaWFsaXplKCkudGltZXN0YW1wKHNjaGVkdWxlcikuc3Vic2NyaWJlKGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHtcblx0ICAgICAgICB2YXIgZCwgc2hvdWxkUnVuO1xuXHQgICAgICAgIGlmIChub3RpZmljYXRpb24udmFsdWUua2luZCA9PT0gJ0UnKSB7XG5cdCAgICAgICAgICBxID0gW107XG5cdCAgICAgICAgICBxLnB1c2gobm90aWZpY2F0aW9uKTtcblx0ICAgICAgICAgIGV4Y2VwdGlvbiA9IG5vdGlmaWNhdGlvbi52YWx1ZS5lcnJvcjtcblx0ICAgICAgICAgIHNob3VsZFJ1biA9ICFydW5uaW5nO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBxLnB1c2goeyB2YWx1ZTogbm90aWZpY2F0aW9uLnZhbHVlLCB0aW1lc3RhbXA6IG5vdGlmaWNhdGlvbi50aW1lc3RhbXAgKyBkdWVUaW1lIH0pO1xuXHQgICAgICAgICAgc2hvdWxkUnVuID0gIWFjdGl2ZTtcblx0ICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGlmIChzaG91bGRSdW4pIHtcblx0ICAgICAgICAgIGlmIChleGNlcHRpb24gIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgby5vbkVycm9yKGV4Y2VwdGlvbik7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgICAgIGNhbmNlbGFibGUuc2V0RGlzcG9zYWJsZShkKTtcblx0ICAgICAgICAgICAgZC5zZXREaXNwb3NhYmxlKHNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZUZ1dHVyZShudWxsLCBkdWVUaW1lLCBmdW5jdGlvbiAoXywgc2VsZikge1xuXHQgICAgICAgICAgICAgIHZhciBlLCByZWN1cnNlRHVlVGltZSwgcmVzdWx0LCBzaG91bGRSZWN1cnNlO1xuXHQgICAgICAgICAgICAgIGlmIChleGNlcHRpb24gIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgcnVubmluZyA9IHRydWU7XG5cdCAgICAgICAgICAgICAgZG8ge1xuXHQgICAgICAgICAgICAgICAgcmVzdWx0ID0gbnVsbDtcblx0ICAgICAgICAgICAgICAgIGlmIChxLmxlbmd0aCA+IDAgJiYgcVswXS50aW1lc3RhbXAgLSBzY2hlZHVsZXIubm93KCkgPD0gMCkge1xuXHQgICAgICAgICAgICAgICAgICByZXN1bHQgPSBxLnNoaWZ0KCkudmFsdWU7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9PSBudWxsKSB7XG5cdCAgICAgICAgICAgICAgICAgIHJlc3VsdC5hY2NlcHQobyk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgfSB3aGlsZSAocmVzdWx0ICE9PSBudWxsKTtcblx0ICAgICAgICAgICAgICBzaG91bGRSZWN1cnNlID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgcmVjdXJzZUR1ZVRpbWUgPSAwO1xuXHQgICAgICAgICAgICAgIGlmIChxLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICAgICAgICAgIHNob3VsZFJlY3Vyc2UgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgcmVjdXJzZUR1ZVRpbWUgPSBNYXRoLm1heCgwLCBxWzBdLnRpbWVzdGFtcCAtIHNjaGVkdWxlci5ub3coKSk7XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICBlID0gZXhjZXB0aW9uO1xuXHQgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICBpZiAoZSAhPT0gbnVsbCkge1xuXHQgICAgICAgICAgICAgICAgby5vbkVycm9yKGUpO1xuXHQgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hvdWxkUmVjdXJzZSkge1xuXHQgICAgICAgICAgICAgICAgc2VsZihudWxsLCByZWN1cnNlRHVlVGltZSk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSk7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gb2JzZXJ2YWJsZURlbGF5QWJzb2x1dGUoc291cmNlLCBkdWVUaW1lLCBzY2hlZHVsZXIpIHtcblx0ICAgIHJldHVybiBvYnNlcnZhYmxlRGVmZXIoZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUoc291cmNlLCBkdWVUaW1lIC0gc2NoZWR1bGVyLm5vdygpLCBzY2hlZHVsZXIpO1xuXHQgICAgfSk7XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiBkZWxheVdpdGhTZWxlY3Rvcihzb3VyY2UsIHN1YnNjcmlwdGlvbkRlbGF5LCBkZWxheUR1cmF0aW9uU2VsZWN0b3IpIHtcblx0ICAgIHZhciBzdWJEZWxheSwgc2VsZWN0b3I7XG5cdCAgICBpZiAoaXNGdW5jdGlvbihzdWJzY3JpcHRpb25EZWxheSkpIHtcblx0ICAgICAgc2VsZWN0b3IgPSBzdWJzY3JpcHRpb25EZWxheTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHN1YkRlbGF5ID0gc3Vic2NyaXB0aW9uRGVsYXk7XG5cdCAgICAgIHNlbGVjdG9yID0gZGVsYXlEdXJhdGlvblNlbGVjdG9yO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBkZWxheXMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpLCBhdEVuZCA9IGZhbHNlLCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gc3RhcnQoKSB7XG5cdCAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShcblx0ICAgICAgICAgIGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgICAgIHZhciBkZWxheSA9IHRyeUNhdGNoKHNlbGVjdG9yKSh4KTtcblx0ICAgICAgICAgICAgaWYgKGRlbGF5ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKGRlbGF5LmUpOyB9XG5cdCAgICAgICAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgICAgIGRlbGF5cy5hZGQoZCk7XG5cdCAgICAgICAgICAgIGQuc2V0RGlzcG9zYWJsZShkZWxheS5zdWJzY3JpYmUoXG5cdCAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgby5vbk5leHQoeCk7XG5cdCAgICAgICAgICAgICAgICBkZWxheXMucmVtb3ZlKGQpO1xuXHQgICAgICAgICAgICAgICAgZG9uZSgpO1xuXHQgICAgICAgICAgICAgIH0sXG5cdCAgICAgICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuXHQgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIG8ub25OZXh0KHgpO1xuXHQgICAgICAgICAgICAgICAgZGVsYXlzLnJlbW92ZShkKTtcblx0ICAgICAgICAgICAgICAgIGRvbmUoKTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICkpO1xuXHQgICAgICAgICAgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcblx0ICAgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgYXRFbmQgPSB0cnVlO1xuXHQgICAgICAgICAgICBzdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuXHQgICAgICAgICAgICBkb25lKCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgKSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGZ1bmN0aW9uIGRvbmUgKCkge1xuXHQgICAgICAgIGF0RW5kICYmIGRlbGF5cy5sZW5ndGggPT09IDAgJiYgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBpZiAoIXN1YkRlbGF5KSB7XG5cdCAgICAgICAgc3RhcnQoKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShzdWJEZWxheS5zdWJzY3JpYmUoc3RhcnQsIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSwgc3RhcnQpKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgZGVsYXlzKTtcblx0ICAgIH0sIHRoaXMpO1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogIFRpbWUgc2hpZnRzIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IGR1ZVRpbWUuXG5cdCAgICogIFRoZSByZWxhdGl2ZSB0aW1lIGludGVydmFscyBiZXR3ZWVuIHRoZSB2YWx1ZXMgYXJlIHByZXNlcnZlZC5cblx0ICAgKlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSBkdWVUaW1lIEFic29sdXRlIChzcGVjaWZpZWQgYXMgYSBEYXRlIG9iamVjdCkgb3IgcmVsYXRpdmUgdGltZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSBieSB3aGljaCB0byBzaGlmdCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZGVsYXkgdGltZXJzIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgdGltZW91dCBzY2hlZHVsZXIgaXMgdXNlZC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGltZS1zaGlmdGVkIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5kZWxheSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBmaXJzdEFyZyA9IGFyZ3VtZW50c1swXTtcblx0ICAgIGlmICh0eXBlb2YgZmlyc3RBcmcgPT09ICdudW1iZXInIHx8IGZpcnN0QXJnIGluc3RhbmNlb2YgRGF0ZSkge1xuXHQgICAgICB2YXIgZHVlVGltZSA9IGZpcnN0QXJnLCBzY2hlZHVsZXIgPSBhcmd1bWVudHNbMV07XG5cdCAgICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHQgICAgICByZXR1cm4gZHVlVGltZSBpbnN0YW5jZW9mIERhdGUgP1xuXHQgICAgICAgIG9ic2VydmFibGVEZWxheUFic29sdXRlKHRoaXMsIGR1ZVRpbWUsIHNjaGVkdWxlcikgOlxuXHQgICAgICAgIG9ic2VydmFibGVEZWxheVJlbGF0aXZlKHRoaXMsIGR1ZVRpbWUsIHNjaGVkdWxlcik7XG5cdCAgICB9IGVsc2UgaWYgKE9ic2VydmFibGUuaXNPYnNlcnZhYmxlKGZpcnN0QXJnKSB8fCBpc0Z1bmN0aW9uKGZpcnN0QXJnKSkge1xuXHQgICAgICByZXR1cm4gZGVsYXlXaXRoU2VsZWN0b3IodGhpcywgZmlyc3RBcmcsIGFyZ3VtZW50c1sxXSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYXJndW1lbnRzJyk7XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgdmFyIERlYm91bmNlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhEZWJvdW5jZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBEZWJvdW5jZU9ic2VydmFibGUoc291cmNlLCBkdCwgcykge1xuXHQgICAgICBpc1NjaGVkdWxlcihzKSB8fCAocyA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fZHQgPSBkdDtcblx0ICAgICAgdGhpcy5fcyA9IHM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIERlYm91bmNlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBjYW5jZWxhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuXHQgICAgICAgIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgRGVib3VuY2VPYnNlcnZlcihvLCB0aGlzLnNvdXJjZSwgdGhpcy5fZHQsIHRoaXMuX3MsIGNhbmNlbGFibGUpKSxcblx0ICAgICAgICBjYW5jZWxhYmxlKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIERlYm91bmNlT2JzZXJ2YWJsZTtcblx0ICB9KE9ic2VydmFibGVCYXNlKSk7XG5cdFxuXHQgIHZhciBEZWJvdW5jZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKERlYm91bmNlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBEZWJvdW5jZU9ic2VydmVyKG9ic2VydmVyLCBzb3VyY2UsIGR1ZVRpbWUsIHNjaGVkdWxlciwgY2FuY2VsYWJsZSkge1xuXHQgICAgICB0aGlzLl9vID0gb2JzZXJ2ZXI7XG5cdCAgICAgIHRoaXMuX3MgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuX2QgPSBkdWVUaW1lO1xuXHQgICAgICB0aGlzLl9zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cdCAgICAgIHRoaXMuX2MgPSBjYW5jZWxhYmxlO1xuXHQgICAgICB0aGlzLl92ID0gbnVsbDtcblx0ICAgICAgdGhpcy5faHYgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5faWQgPSAwO1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBEZWJvdW5jZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5faHYgPSB0cnVlO1xuXHQgICAgICB0aGlzLl92ID0geDtcblx0ICAgICAgdmFyIGN1cnJlbnRJZCA9ICsrdGhpcy5faWQsIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcblx0ICAgICAgdGhpcy5fYy5zZXREaXNwb3NhYmxlKGQpO1xuXHQgICAgICBkLnNldERpc3Bvc2FibGUodGhpcy5fc2NoZWR1bGVyLnNjaGVkdWxlRnV0dXJlKHRoaXMsIHRoaXMuX2QsIGZ1bmN0aW9uIChfLCBzZWxmKSB7XG5cdCAgICAgICAgc2VsZi5faHYgJiYgc2VsZi5faWQgPT09IGN1cnJlbnRJZCAmJiBzZWxmLl9vLm9uTmV4dCh4KTtcblx0ICAgICAgICBzZWxmLl9odiA9IGZhbHNlO1xuXHQgICAgICB9KSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIERlYm91bmNlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgdGhpcy5fYy5kaXNwb3NlKCk7XG5cdCAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcblx0ICAgICAgdGhpcy5faHYgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5faWQrKztcblx0ICAgIH07XG5cdFxuXHQgICAgRGVib3VuY2VPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl9jLmRpc3Bvc2UoKTtcblx0ICAgICAgdGhpcy5faHYgJiYgdGhpcy5fby5vbk5leHQodGhpcy5fdik7XG5cdCAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgdGhpcy5faHYgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5faWQrKztcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIERlYm91bmNlT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIGZ1bmN0aW9uIGRlYm91bmNlV2l0aFNlbGVjdG9yKHNvdXJjZSwgZHVyYXRpb25TZWxlY3Rvcikge1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciB2YWx1ZSwgaGFzVmFsdWUgPSBmYWxzZSwgY2FuY2VsYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksIGlkID0gMDtcblx0ICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHNvdXJjZS5zdWJzY3JpYmUoXG5cdCAgICAgICAgZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICAgIHZhciB0aHJvdHRsZSA9IHRyeUNhdGNoKGR1cmF0aW9uU2VsZWN0b3IpKHgpO1xuXHQgICAgICAgICAgaWYgKHRocm90dGxlID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHRocm90dGxlLmUpOyB9XG5cdFxuXHQgICAgICAgICAgaXNQcm9taXNlKHRocm90dGxlKSAmJiAodGhyb3R0bGUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UodGhyb3R0bGUpKTtcblx0XG5cdCAgICAgICAgICBoYXNWYWx1ZSA9IHRydWU7XG5cdCAgICAgICAgICB2YWx1ZSA9IHg7XG5cdCAgICAgICAgICBpZCsrO1xuXHQgICAgICAgICAgdmFyIGN1cnJlbnRpZCA9IGlkLCBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdCAgICAgICAgICBjYW5jZWxhYmxlLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgICAgICBkLnNldERpc3Bvc2FibGUodGhyb3R0bGUuc3Vic2NyaWJlKFxuXHQgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgaGFzVmFsdWUgJiYgaWQgPT09IGN1cnJlbnRpZCAmJiBvLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICBkLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuXHQgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgaGFzVmFsdWUgJiYgaWQgPT09IGN1cnJlbnRpZCAmJiBvLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICBkLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgKSk7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgICAgY2FuY2VsYWJsZS5kaXNwb3NlKCk7XG5cdCAgICAgICAgICBvLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgICBoYXNWYWx1ZSA9IGZhbHNlO1xuXHQgICAgICAgICAgaWQrKztcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIGNhbmNlbGFibGUuZGlzcG9zZSgpO1xuXHQgICAgICAgICAgaGFzVmFsdWUgJiYgby5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgICAgaGFzVmFsdWUgPSBmYWxzZTtcblx0ICAgICAgICAgIGlkKys7XG5cdCAgICAgICAgfVxuXHQgICAgICApO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfVxuXHRcblx0ICBvYnNlcnZhYmxlUHJvdG8uZGVib3VuY2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBpZiAoaXNGdW5jdGlvbiAoYXJndW1lbnRzWzBdKSkge1xuXHQgICAgICByZXR1cm4gZGVib3VuY2VXaXRoU2VsZWN0b3IodGhpcywgYXJndW1lbnRzWzBdKTtcblx0ICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ251bWJlcicpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBEZWJvdW5jZU9ic2VydmFibGUodGhpcywgYXJndW1lbnRzWzBdLCBhcmd1bWVudHNbMV0pO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50cycpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIHZhciBUaW1lc3RhbXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRpbWVzdGFtcE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUaW1lc3RhbXBPYnNlcnZhYmxlKHNvdXJjZSwgcykge1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcblx0ICAgICAgdGhpcy5fcyA9IHM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRpbWVzdGFtcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBUaW1lc3RhbXBPYnNlcnZlcihvLCB0aGlzLl9zKSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBUaW1lc3RhbXBPYnNlcnZhYmxlO1xuXHQgIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblx0XG5cdCAgdmFyIFRpbWVzdGFtcE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFRpbWVzdGFtcE9ic2VydmVyLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gVGltZXN0YW1wT2JzZXJ2ZXIobywgcykge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5fcyA9IHM7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIFRpbWVzdGFtcE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgdGhpcy5fby5vbk5leHQoeyB2YWx1ZTogeCwgdGltZXN0YW1wOiB0aGlzLl9zLm5vdygpIH0pO1xuXHQgICAgfTtcblx0XG5cdCAgICBUaW1lc3RhbXBPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFRpbWVzdGFtcE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIFRpbWVzdGFtcE9ic2VydmVyO1xuXHQgIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmVjb3JkcyB0aGUgdGltZXN0YW1wIGZvciBlYWNoIHZhbHVlIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG5cdCAgICpcblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqICAxIC0gcmVzID0gc291cmNlLnRpbWVzdGFtcCgpOyAvLyBwcm9kdWNlcyB7IHZhbHVlOiB4LCB0aW1lc3RhbXA6IHRzIH1cblx0ICAgKiAgMiAtIHJlcyA9IHNvdXJjZS50aW1lc3RhbXAoUnguU2NoZWR1bGVyLmRlZmF1bHQpO1xuXHQgICAqXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdICBTY2hlZHVsZXIgdXNlZCB0byBjb21wdXRlIHRpbWVzdGFtcHMuIElmIG5vdCBzcGVjaWZpZWQsIHRoZSBkZWZhdWx0IHNjaGVkdWxlciBpcyB1c2VkLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGltZXN0YW1wIGluZm9ybWF0aW9uIG9uIHZhbHVlcy5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udGltZXN0YW1wID0gZnVuY3Rpb24gKHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gbmV3IFRpbWVzdGFtcE9ic2VydmFibGUodGhpcywgc2NoZWR1bGVyKTtcblx0ICB9O1xuXHRcblx0ICBmdW5jdGlvbiBzYW1wbGVPYnNlcnZhYmxlKHNvdXJjZSwgc2FtcGxlcikge1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBhdEVuZCA9IGZhbHNlLCB2YWx1ZSwgaGFzVmFsdWUgPSBmYWxzZTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIHNhbXBsZVN1YnNjcmliZSgpIHtcblx0ICAgICAgICBpZiAoaGFzVmFsdWUpIHtcblx0ICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG5cdCAgICAgICAgICBvLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGF0RW5kICYmIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgdmFyIHNvdXJjZVN1YnNjcmlwdGlvbiA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgICBzb3VyY2VTdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKFxuXHQgICAgICAgIGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuXHQgICAgICAgICAgaGFzVmFsdWUgPSB0cnVlO1xuXHQgICAgICAgICAgdmFsdWUgPSBuZXdWYWx1ZTtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcblx0ICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBhdEVuZCA9IHRydWU7XG5cdCAgICAgICAgICBzb3VyY2VTdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgKSk7XG5cdFxuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG5cdCAgICAgICAgc291cmNlU3Vic2NyaXB0aW9uLFxuXHQgICAgICAgIHNhbXBsZXIuc3Vic2NyaWJlKHNhbXBsZVN1YnNjcmliZSwgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LCBzYW1wbGVTdWJzY3JpYmUpXG5cdCAgICAgICk7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH1cblx0XG5cdCAgLyoqXG5cdCAgICogIFNhbXBsZXMgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYXQgZWFjaCBpbnRlcnZhbC5cblx0ICAgKlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogIDEgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKHNhbXBsZU9ic2VydmFibGUpOyAvLyBTYW1wbGVyIHRpY2sgc2VxdWVuY2Vcblx0ICAgKiAgMiAtIHJlcyA9IHNvdXJjZS5zYW1wbGUoNTAwMCk7IC8vIDUgc2Vjb25kc1xuXHQgICAqICAyIC0gcmVzID0gc291cmNlLnNhbXBsZSg1MDAwLCBSeC5TY2hlZHVsZXIudGltZW91dCk7IC8vIDUgc2Vjb25kc1xuXHQgICAqXG5cdCAgICogQHBhcmFtIHtNaXhlZH0gaW50ZXJ2YWxPclNhbXBsZXIgSW50ZXJ2YWwgYXQgd2hpY2ggdG8gc2FtcGxlIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpIG9yIFNhbXBsZXIgT2JzZXJ2YWJsZS5cblx0ICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gIFNjaGVkdWxlciB0byBydW4gdGhlIHNhbXBsaW5nIHRpbWVyIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgdGltZW91dCBzY2hlZHVsZXIgaXMgdXNlZC5cblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gU2FtcGxlZCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5zYW1wbGUgPSBvYnNlcnZhYmxlUHJvdG8udGhyb3R0bGVMYXRlc3QgPSBmdW5jdGlvbiAoaW50ZXJ2YWxPclNhbXBsZXIsIHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cdCAgICByZXR1cm4gdHlwZW9mIGludGVydmFsT3JTYW1wbGVyID09PSAnbnVtYmVyJyA/XG5cdCAgICAgIHNhbXBsZU9ic2VydmFibGUodGhpcywgb2JzZXJ2YWJsZWludGVydmFsKGludGVydmFsT3JTYW1wbGVyLCBzY2hlZHVsZXIpKSA6XG5cdCAgICAgIHNhbXBsZU9ic2VydmFibGUodGhpcywgaW50ZXJ2YWxPclNhbXBsZXIpO1xuXHQgIH07XG5cdFxuXHQgIHZhciBUaW1lb3V0RXJyb3IgPSBSeC5UaW1lb3V0RXJyb3IgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG5cdCAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlIHx8ICdUaW1lb3V0IGhhcyBvY2N1cnJlZCc7XG5cdCAgICB0aGlzLm5hbWUgPSAnVGltZW91dEVycm9yJztcblx0ICAgIEVycm9yLmNhbGwodGhpcyk7XG5cdCAgfTtcblx0ICBUaW1lb3V0RXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuXHRcblx0ICBmdW5jdGlvbiB0aW1lb3V0V2l0aFNlbGVjdG9yKHNvdXJjZSwgZmlyc3RUaW1lb3V0LCB0aW1lb3V0RHVyYXRpb25TZWxlY3Rvciwgb3RoZXIpIHtcblx0ICAgIGlmIChpc0Z1bmN0aW9uKGZpcnN0VGltZW91dCkpIHtcblx0ICAgICAgb3RoZXIgPSB0aW1lb3V0RHVyYXRpb25TZWxlY3Rvcjtcblx0ICAgICAgdGltZW91dER1cmF0aW9uU2VsZWN0b3IgPSBmaXJzdFRpbWVvdXQ7XG5cdCAgICAgIGZpcnN0VGltZW91dCA9IG9ic2VydmFibGVOZXZlcigpO1xuXHQgICAgfVxuXHQgICAgb3RoZXIgfHwgKG90aGVyID0gb2JzZXJ2YWJsZVRocm93KG5ldyBUaW1lb3V0RXJyb3IoKSkpO1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLFxuXHQgICAgICAgIHRpbWVyID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSxcblx0ICAgICAgICBvcmlnaW5hbCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHRcblx0ICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3JpZ2luYWwpO1xuXHRcblx0ICAgICAgdmFyIGlkID0gMCwgc3dpdGNoZWQgPSBmYWxzZTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIHNldFRpbWVyKHRpbWVvdXQpIHtcblx0ICAgICAgICB2YXIgbXlJZCA9IGlkLCBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cdFxuXHQgICAgICAgIGZ1bmN0aW9uIHRpbWVyV2lucygpIHtcblx0ICAgICAgICAgIHN3aXRjaGVkID0gKG15SWQgPT09IGlkKTtcblx0ICAgICAgICAgIHJldHVybiBzd2l0Y2hlZDtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRpbWVyLnNldERpc3Bvc2FibGUoZCk7XG5cdCAgICAgICAgZC5zZXREaXNwb3NhYmxlKHRpbWVvdXQuc3Vic2NyaWJlKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIHRpbWVyV2lucygpICYmIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG90aGVyLnN1YnNjcmliZShvKSk7XG5cdCAgICAgICAgICBkLmRpc3Bvc2UoKTtcblx0ICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgICAgdGltZXJXaW5zKCkgJiYgby5vbkVycm9yKGUpO1xuXHQgICAgICAgIH0sIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIHRpbWVyV2lucygpICYmIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG90aGVyLnN1YnNjcmliZShvKSk7XG5cdCAgICAgICAgfSkpO1xuXHQgICAgICB9O1xuXHRcblx0ICAgICAgc2V0VGltZXIoZmlyc3RUaW1lb3V0KTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIG9XaW5zKCkge1xuXHQgICAgICAgIHZhciByZXMgPSAhc3dpdGNoZWQ7XG5cdCAgICAgICAgaWYgKHJlcykgeyBpZCsrOyB9XG5cdCAgICAgICAgcmV0dXJuIHJlcztcblx0ICAgICAgfVxuXHRcblx0ICAgICAgb3JpZ2luYWwuc2V0RGlzcG9zYWJsZShzb3VyY2Uuc3Vic2NyaWJlKGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgaWYgKG9XaW5zKCkpIHtcblx0ICAgICAgICAgIG8ub25OZXh0KHgpO1xuXHQgICAgICAgICAgdmFyIHRpbWVvdXQgPSB0cnlDYXRjaCh0aW1lb3V0RHVyYXRpb25TZWxlY3RvcikoeCk7XG5cdCAgICAgICAgICBpZiAodGltZW91dCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcih0aW1lb3V0LmUpOyB9XG5cdCAgICAgICAgICBzZXRUaW1lcihpc1Byb21pc2UodGltZW91dCkgPyBvYnNlcnZhYmxlRnJvbVByb21pc2UodGltZW91dCkgOiB0aW1lb3V0KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgb1dpbnMoKSAmJiBvLm9uRXJyb3IoZSk7XG5cdCAgICAgIH0sIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBvV2lucygpICYmIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfSkpO1xuXHQgICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCB0aW1lcik7XG5cdCAgICB9LCBzb3VyY2UpO1xuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gdGltZW91dChzb3VyY2UsIGR1ZVRpbWUsIG90aGVyLCBzY2hlZHVsZXIpIHtcblx0ICAgIGlmIChpc1NjaGVkdWxlcihvdGhlcikpIHtcblx0ICAgICAgc2NoZWR1bGVyID0gb3RoZXI7XG5cdCAgICAgIG90aGVyID0gb2JzZXJ2YWJsZVRocm93KG5ldyBUaW1lb3V0RXJyb3IoKSk7XG5cdCAgICB9XG5cdCAgICBpZiAob3RoZXIgaW5zdGFuY2VvZiBFcnJvcikgeyBvdGhlciA9IG9ic2VydmFibGVUaHJvdyhvdGhlcik7IH1cblx0ICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXHRcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgaWQgPSAwLFxuXHQgICAgICAgIG9yaWdpbmFsID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksXG5cdCAgICAgICAgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSxcblx0ICAgICAgICBzd2l0Y2hlZCA9IGZhbHNlLFxuXHQgICAgICAgIHRpbWVyID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblx0XG5cdCAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG9yaWdpbmFsKTtcblx0XG5cdCAgICAgIGZ1bmN0aW9uIGNyZWF0ZVRpbWVyKCkge1xuXHQgICAgICAgIHZhciBteUlkID0gaWQ7XG5cdCAgICAgICAgdGltZXIuc2V0RGlzcG9zYWJsZShzY2hlZHVsZXIuc2NoZWR1bGVGdXR1cmUobnVsbCwgZHVlVGltZSwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgc3dpdGNoZWQgPSBpZCA9PT0gbXlJZDtcblx0ICAgICAgICAgIGlmIChzd2l0Y2hlZCkge1xuXHQgICAgICAgICAgICBpc1Byb21pc2Uob3RoZXIpICYmIChvdGhlciA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikpO1xuXHQgICAgICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShvdGhlci5zdWJzY3JpYmUobykpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0pKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgY3JlYXRlVGltZXIoKTtcblx0XG5cdCAgICAgIG9yaWdpbmFsLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgIGlmICghc3dpdGNoZWQpIHtcblx0ICAgICAgICAgIGlkKys7XG5cdCAgICAgICAgICBvLm9uTmV4dCh4KTtcblx0ICAgICAgICAgIGNyZWF0ZVRpbWVyKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmICghc3dpdGNoZWQpIHtcblx0ICAgICAgICAgIGlkKys7XG5cdCAgICAgICAgICBvLm9uRXJyb3IoZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCFzd2l0Y2hlZCkge1xuXHQgICAgICAgICAgaWQrKztcblx0ICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pKTtcblx0ICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgdGltZXIpO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9XG5cdFxuXHQgIG9ic2VydmFibGVQcm90by50aW1lb3V0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIGZpcnN0QXJnID0gYXJndW1lbnRzWzBdO1xuXHQgICAgaWYgKGZpcnN0QXJnIGluc3RhbmNlb2YgRGF0ZSB8fCB0eXBlb2YgZmlyc3RBcmcgPT09ICdudW1iZXInKSB7XG5cdCAgICAgIHJldHVybiB0aW1lb3V0KHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7XG5cdCAgICB9IGVsc2UgaWYgKE9ic2VydmFibGUuaXNPYnNlcnZhYmxlKGZpcnN0QXJnKSB8fCBpc0Z1bmN0aW9uKGZpcnN0QXJnKSkge1xuXHQgICAgICByZXR1cm4gdGltZW91dFdpdGhTZWxlY3Rvcih0aGlzLCBmaXJzdEFyZywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50cycpO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqIFJldHVybnMgYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIG9ubHkgdGhlIGZpcnN0IGl0ZW0gZW1pdHRlZCBieSB0aGUgc291cmNlIE9ic2VydmFibGUgZHVyaW5nIHNlcXVlbnRpYWwgdGltZSB3aW5kb3dzIG9mIGEgc3BlY2lmaWVkIGR1cmF0aW9uLlxuXHQgICAqIEBwYXJhbSB7TnVtYmVyfSB3aW5kb3dEdXJhdGlvbiB0aW1lIHRvIHdhaXQgYmVmb3JlIGVtaXR0aW5nIGFub3RoZXIgaXRlbSBhZnRlciBlbWl0dGluZyB0aGUgbGFzdCBpdGVtXG5cdCAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIHRoZSBTY2hlZHVsZXIgdG8gdXNlIGludGVybmFsbHkgdG8gbWFuYWdlIHRoZSB0aW1lcnMgdGhhdCBoYW5kbGUgdGltZW91dCBmb3IgZWFjaCBpdGVtLiBJZiBub3QgcHJvdmlkZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci50aW1lb3V0LlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHRoYXQgcGVyZm9ybXMgdGhlIHRocm90dGxlIG9wZXJhdGlvbi5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8udGhyb3R0bGUgPSBmdW5jdGlvbiAod2luZG93RHVyYXRpb24sIHNjaGVkdWxlcikge1xuXHQgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG5cdCAgICB2YXIgZHVyYXRpb24gPSArd2luZG93RHVyYXRpb24gfHwgMDtcblx0ICAgIGlmIChkdXJhdGlvbiA8PSAwKSB7IHRocm93IG5ldyBSYW5nZUVycm9yKCd3aW5kb3dEdXJhdGlvbiBjYW5ub3QgYmUgbGVzcyBvciBlcXVhbCB6ZXJvLicpOyB9XG5cdCAgICB2YXIgc291cmNlID0gdGhpcztcblx0ICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgbGFzdE9uTmV4dCA9IDA7XG5cdCAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKFxuXHQgICAgICAgIGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgICB2YXIgbm93ID0gc2NoZWR1bGVyLm5vdygpO1xuXHQgICAgICAgICAgaWYgKGxhc3RPbk5leHQgPT09IDAgfHwgbm93IC0gbGFzdE9uTmV4dCA+PSBkdXJhdGlvbikge1xuXHQgICAgICAgICAgICBsYXN0T25OZXh0ID0gbm93O1xuXHQgICAgICAgICAgICBvLm9uTmV4dCh4KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9LGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSwgZnVuY3Rpb24gKCkgeyBvLm9uQ29tcGxldGVkKCk7IH1cblx0ICAgICAgKTtcblx0ICAgIH0sIHNvdXJjZSk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIFBhdXNhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhQYXVzYWJsZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBQYXVzYWJsZU9ic2VydmFibGUoc291cmNlLCBwYXVzZXIpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIHRoaXMuY29udHJvbGxlciA9IG5ldyBTdWJqZWN0KCk7XG5cdFxuXHQgICAgICBpZiAocGF1c2VyICYmIHBhdXNlci5zdWJzY3JpYmUpIHtcblx0ICAgICAgICB0aGlzLnBhdXNlciA9IHRoaXMuY29udHJvbGxlci5tZXJnZShwYXVzZXIpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgIH1cblx0XG5cdCAgICBQYXVzYWJsZU9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgY29ubiA9IHRoaXMuc291cmNlLnB1Ymxpc2goKSxcblx0ICAgICAgICBzdWJzY3JpcHRpb24gPSBjb25uLnN1YnNjcmliZShvKSxcblx0ICAgICAgICBjb25uZWN0aW9uID0gZGlzcG9zYWJsZUVtcHR5O1xuXHRcblx0ICAgICAgdmFyIHBhdXNhYmxlID0gdGhpcy5wYXVzZXIuZGlzdGluY3RVbnRpbENoYW5nZWQoKS5zdWJzY3JpYmUoZnVuY3Rpb24gKGIpIHtcblx0ICAgICAgICBpZiAoYikge1xuXHQgICAgICAgICAgY29ubmVjdGlvbiA9IGNvbm4uY29ubmVjdCgpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBjb25uZWN0aW9uLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgIGNvbm5lY3Rpb24gPSBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0XG5cdCAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoW3N1YnNjcmlwdGlvbiwgY29ubmVjdGlvbiwgcGF1c2FibGVdKTtcblx0ICAgIH07XG5cdFxuXHQgICAgUGF1c2FibGVPYnNlcnZhYmxlLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dChmYWxzZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFBhdXNhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLmNvbnRyb2xsZXIub25OZXh0KHRydWUpO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gUGF1c2FibGVPYnNlcnZhYmxlO1xuXHRcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgLyoqXG5cdCAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgYmFzZWQgdXBvbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB5aWVsZHMgdHJ1ZS9mYWxzZS5cblx0ICAgKiBAZXhhbXBsZVxuXHQgICAqIHZhciBwYXVzZXIgPSBuZXcgUnguU3ViamVjdCgpO1xuXHQgICAqIHZhciBzb3VyY2UgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMCkucGF1c2FibGUocGF1c2VyKTtcblx0ICAgKiBAcGFyYW0ge09ic2VydmFibGV9IHBhdXNlciBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1c2VkIHRvIHBhdXNlIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCBpcyBwYXVzZWQgYmFzZWQgdXBvbiB0aGUgcGF1c2VyLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5wYXVzYWJsZSA9IGZ1bmN0aW9uIChwYXVzZXIpIHtcblx0ICAgIHJldHVybiBuZXcgUGF1c2FibGVPYnNlcnZhYmxlKHRoaXMsIHBhdXNlcik7XG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gY29tYmluZUxhdGVzdFNvdXJjZShzb3VyY2UsIHN1YmplY3QsIHJlc3VsdFNlbGVjdG9yKSB7XG5cdCAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgdmFyIGhhc1ZhbHVlID0gW2ZhbHNlLCBmYWxzZV0sXG5cdCAgICAgICAgaGFzVmFsdWVBbGwgPSBmYWxzZSxcblx0ICAgICAgICBpc0RvbmUgPSBmYWxzZSxcblx0ICAgICAgICB2YWx1ZXMgPSBuZXcgQXJyYXkoMiksXG5cdCAgICAgICAgZXJyO1xuXHRcblx0ICAgICAgZnVuY3Rpb24gbmV4dCh4LCBpKSB7XG5cdCAgICAgICAgdmFsdWVzW2ldID0geDtcblx0ICAgICAgICBoYXNWYWx1ZVtpXSA9IHRydWU7XG5cdCAgICAgICAgaWYgKGhhc1ZhbHVlQWxsIHx8IChoYXNWYWx1ZUFsbCA9IGhhc1ZhbHVlLmV2ZXJ5KGlkZW50aXR5KSkpIHtcblx0ICAgICAgICAgIGlmIChlcnIpIHsgcmV0dXJuIG8ub25FcnJvcihlcnIpOyB9XG5cdCAgICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2gocmVzdWx0U2VsZWN0b3IpLmFwcGx5KG51bGwsIHZhbHVlcyk7XG5cdCAgICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlcy5lKTsgfVxuXHQgICAgICAgICAgby5vbk5leHQocmVzKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaXNEb25lICYmIHZhbHVlc1sxXSAmJiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShcblx0ICAgICAgICBzb3VyY2Uuc3Vic2NyaWJlKFxuXHQgICAgICAgICAgZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICAgICAgbmV4dCh4LCAwKTtcblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgICAgICBpZiAodmFsdWVzWzFdKSB7XG5cdCAgICAgICAgICAgICAgby5vbkVycm9yKGUpO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIGVyciA9IGU7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0sXG5cdCAgICAgICAgICBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG5cdCAgICAgICAgICAgIHZhbHVlc1sxXSAmJiBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICB9KSxcblx0ICAgICAgICBzdWJqZWN0LnN1YnNjcmliZShcblx0ICAgICAgICAgIGZ1bmN0aW9uICh4KSB7XG5cdCAgICAgICAgICAgIG5leHQoeCwgMSk7XG5cdCAgICAgICAgICB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuXHQgICAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICBpc0RvbmUgPSB0cnVlO1xuXHQgICAgICAgICAgICBuZXh0KHRydWUsIDEpO1xuXHQgICAgICAgICAgfSlcblx0ICAgICAgICApO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9XG5cdFxuXHQgIHZhciBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlKHNvdXJjZSwgcGF1c2VyKSB7XG5cdCAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgU3ViamVjdCgpO1xuXHRcblx0ICAgICAgaWYgKHBhdXNlciAmJiBwYXVzZXIuc3Vic2NyaWJlKSB7XG5cdCAgICAgICAgdGhpcy5wYXVzZXIgPSB0aGlzLmNvbnRyb2xsZXIubWVyZ2UocGF1c2VyKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0aGlzLnBhdXNlciA9IHRoaXMuY29udHJvbGxlcjtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgcSA9IFtdLCBwcmV2aW91c1Nob3VsZEZpcmU7XG5cdFxuXHQgICAgICBmdW5jdGlvbiBkcmFpblF1ZXVlKCkgeyB3aGlsZSAocS5sZW5ndGggPiAwKSB7IG8ub25OZXh0KHEuc2hpZnQoKSk7IH0gfVxuXHRcblx0ICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9XG5cdCAgICAgICAgY29tYmluZUxhdGVzdFNvdXJjZShcblx0ICAgICAgICAgIHRoaXMuc291cmNlLFxuXHQgICAgICAgICAgdGhpcy5wYXVzZXIuc3RhcnRXaXRoKGZhbHNlKS5kaXN0aW5jdFVudGlsQ2hhbmdlZCgpLFxuXHQgICAgICAgICAgZnVuY3Rpb24gKGRhdGEsIHNob3VsZEZpcmUpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHsgZGF0YTogZGF0YSwgc2hvdWxkRmlyZTogc2hvdWxkRmlyZSB9O1xuXHQgICAgICAgICAgfSlcblx0ICAgICAgICAgIC5zdWJzY3JpYmUoXG5cdCAgICAgICAgICAgIGZ1bmN0aW9uIChyZXN1bHRzKSB7XG5cdCAgICAgICAgICAgICAgaWYgKHByZXZpb3VzU2hvdWxkRmlyZSAhPT0gdW5kZWZpbmVkICYmIHJlc3VsdHMuc2hvdWxkRmlyZSAhPT0gcHJldmlvdXNTaG91bGRGaXJlKSB7XG5cdCAgICAgICAgICAgICAgICBwcmV2aW91c1Nob3VsZEZpcmUgPSByZXN1bHRzLnNob3VsZEZpcmU7XG5cdCAgICAgICAgICAgICAgICAvLyBjaGFuZ2UgaW4gc2hvdWxkRmlyZVxuXHQgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHMuc2hvdWxkRmlyZSkgeyBkcmFpblF1ZXVlKCk7IH1cblx0ICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgcHJldmlvdXNTaG91bGRGaXJlID0gcmVzdWx0cy5zaG91bGRGaXJlO1xuXHQgICAgICAgICAgICAgICAgLy8gbmV3IGRhdGFcblx0ICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLnNob3VsZEZpcmUpIHtcblx0ICAgICAgICAgICAgICAgICAgby5vbk5leHQocmVzdWx0cy5kYXRhKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgIHEucHVzaChyZXN1bHRzLmRhdGEpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgZnVuY3Rpb24gKGVycikge1xuXHQgICAgICAgICAgICAgIGRyYWluUXVldWUoKTtcblx0ICAgICAgICAgICAgICBvLm9uRXJyb3IoZXJyKTtcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgIGRyYWluUXVldWUoKTtcblx0ICAgICAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICk7XG5cdCAgICAgIHJldHVybiBzdWJzY3JpcHRpb247ICAgICAgXG5cdCAgICB9O1xuXHRcblx0ICAgIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dChmYWxzZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIFBhdXNhYmxlQnVmZmVyZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHRoaXMuY29udHJvbGxlci5vbk5leHQodHJ1ZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZTtcblx0XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIFBhdXNlcyB0aGUgdW5kZXJseWluZyBvYnNlcnZhYmxlIHNlcXVlbmNlIGJhc2VkIHVwb24gdGhlIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggeWllbGRzIHRydWUvZmFsc2UsXG5cdCAgICogYW5kIHlpZWxkcyB0aGUgdmFsdWVzIHRoYXQgd2VyZSBidWZmZXJlZCB3aGlsZSBwYXVzZWQuXG5cdCAgICogQGV4YW1wbGVcblx0ICAgKiB2YXIgcGF1c2VyID0gbmV3IFJ4LlN1YmplY3QoKTtcblx0ICAgKiB2YXIgc291cmNlID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDApLnBhdXNhYmxlQnVmZmVyZWQocGF1c2VyKTtcblx0ICAgKiBAcGFyYW0ge09ic2VydmFibGV9IHBhdXNlciBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1c2VkIHRvIHBhdXNlIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuXHQgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCBpcyBwYXVzZWQgYmFzZWQgdXBvbiB0aGUgcGF1c2VyLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5wYXVzYWJsZUJ1ZmZlcmVkID0gZnVuY3Rpb24gKHN1YmplY3QpIHtcblx0ICAgIHJldHVybiBuZXcgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUodGhpcywgc3ViamVjdCk7XG5cdCAgfTtcblx0XG5cdCAgdmFyIENvbnRyb2xsZWRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENvbnRyb2xsZWRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ29udHJvbGxlZE9ic2VydmFibGUgKHNvdXJjZSwgZW5hYmxlUXVldWUsIHNjaGVkdWxlcikge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5zdWJqZWN0ID0gbmV3IENvbnRyb2xsZWRTdWJqZWN0KGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpO1xuXHQgICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZS5tdWx0aWNhc3QodGhpcy5zdWJqZWN0KS5yZWZDb3VudCgpO1xuXHQgICAgfVxuXHRcblx0ICAgIENvbnRyb2xsZWRPYnNlcnZhYmxlLnByb3RvdHlwZS5fc3Vic2NyaWJlID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShvKTtcblx0ICAgIH07XG5cdFxuXHQgICAgQ29udHJvbGxlZE9ic2VydmFibGUucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbiAobnVtYmVyT2ZJdGVtcykge1xuXHQgICAgICByZXR1cm4gdGhpcy5zdWJqZWN0LnJlcXVlc3QobnVtYmVyT2ZJdGVtcyA9PSBudWxsID8gLTEgOiBudW1iZXJPZkl0ZW1zKTtcblx0ICAgIH07XG5cdFxuXHQgICAgcmV0dXJuIENvbnRyb2xsZWRPYnNlcnZhYmxlO1xuXHRcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgdmFyIENvbnRyb2xsZWRTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKENvbnRyb2xsZWRTdWJqZWN0LCBfX3N1cGVyX18pO1xuXHQgICAgZnVuY3Rpb24gQ29udHJvbGxlZFN1YmplY3QoZW5hYmxlUXVldWUsIHNjaGVkdWxlcikge1xuXHQgICAgICBlbmFibGVRdWV1ZSA9PSBudWxsICYmIChlbmFibGVRdWV1ZSA9IHRydWUpO1xuXHRcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMuc3ViamVjdCA9IG5ldyBTdWJqZWN0KCk7XG5cdCAgICAgIHRoaXMuZW5hYmxlUXVldWUgPSBlbmFibGVRdWV1ZTtcblx0ICAgICAgdGhpcy5xdWV1ZSA9IGVuYWJsZVF1ZXVlID8gW10gOiBudWxsO1xuXHQgICAgICB0aGlzLnJlcXVlc3RlZENvdW50ID0gMDtcblx0ICAgICAgdGhpcy5yZXF1ZXN0ZWREaXNwb3NhYmxlID0gbnVsbDtcblx0ICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG5cdCAgICAgIHRoaXMuaGFzRmFpbGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaGFzQ29tcGxldGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyIHx8IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXI7XG5cdCAgICB9XG5cdFxuXHQgICAgYWRkUHJvcGVydGllcyhDb250cm9sbGVkU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLCB7XG5cdCAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuc3ViamVjdC5zdWJzY3JpYmUobyk7XG5cdCAgICAgIH0sXG5cdCAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5oYXNDb21wbGV0ZWQgPSB0cnVlO1xuXHQgICAgICAgIGlmICghdGhpcy5lbmFibGVRdWV1ZSB8fCB0aGlzLnF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgICAgdGhpcy5zdWJqZWN0Lm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICB0aGlzLmRpc3Bvc2VDdXJyZW50UmVxdWVzdCgpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGlzLnF1ZXVlLnB1c2goTm90aWZpY2F0aW9uLmNyZWF0ZU9uQ29tcGxldGVkKCkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgdGhpcy5oYXNGYWlsZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblx0ICAgICAgICBpZiAoIXRoaXMuZW5hYmxlUXVldWUgfHwgdGhpcy5xdWV1ZS5sZW5ndGggPT09IDApIHtcblx0ICAgICAgICAgIHRoaXMuc3ViamVjdC5vbkVycm9yKGVycm9yKTtcblx0ICAgICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRoaXMucXVldWUucHVzaChOb3RpZmljYXRpb24uY3JlYXRlT25FcnJvcihlcnJvcikpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICBpZiAodGhpcy5yZXF1ZXN0ZWRDb3VudCA8PSAwKSB7XG5cdCAgICAgICAgICB0aGlzLmVuYWJsZVF1ZXVlICYmIHRoaXMucXVldWUucHVzaChOb3RpZmljYXRpb24uY3JlYXRlT25OZXh0KHZhbHVlKSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICh0aGlzLnJlcXVlc3RlZENvdW50LS0gPT09IDApICYmIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG5cdCAgICAgICAgICB0aGlzLnN1YmplY3Qub25OZXh0KHZhbHVlKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIF9wcm9jZXNzUmVxdWVzdDogZnVuY3Rpb24gKG51bWJlck9mSXRlbXMpIHtcblx0ICAgICAgICBpZiAodGhpcy5lbmFibGVRdWV1ZSkge1xuXHQgICAgICAgICAgd2hpbGUgKHRoaXMucXVldWUubGVuZ3RoID4gMCAmJiAobnVtYmVyT2ZJdGVtcyA+IDAgfHwgdGhpcy5xdWV1ZVswXS5raW5kICE9PSAnTicpKSB7XG5cdCAgICAgICAgICAgIHZhciBmaXJzdCA9IHRoaXMucXVldWUuc2hpZnQoKTtcblx0ICAgICAgICAgICAgZmlyc3QuYWNjZXB0KHRoaXMuc3ViamVjdCk7XG5cdCAgICAgICAgICAgIGlmIChmaXJzdC5raW5kID09PSAnTicpIHtcblx0ICAgICAgICAgICAgICBudW1iZXJPZkl0ZW1zLS07XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcblx0ICAgICAgICAgICAgICB0aGlzLnF1ZXVlID0gW107XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHJldHVybiBudW1iZXJPZkl0ZW1zO1xuXHQgICAgICB9LFxuXHQgICAgICByZXF1ZXN0OiBmdW5jdGlvbiAobnVtYmVyKSB7XG5cdCAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcblx0ICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cdFxuXHQgICAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSA9IHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKG51bWJlcixcblx0ICAgICAgICBmdW5jdGlvbihzLCBpKSB7XG5cdCAgICAgICAgICB2YXIgcmVtYWluaW5nID0gc2VsZi5fcHJvY2Vzc1JlcXVlc3QoaSk7XG5cdCAgICAgICAgICB2YXIgc3RvcHBlZCA9IHNlbGYuaGFzQ29tcGxldGVkIHx8IHNlbGYuaGFzRmFpbGVkO1xuXHQgICAgICAgICAgaWYgKCFzdG9wcGVkICYmIHJlbWFpbmluZyA+IDApIHtcblx0ICAgICAgICAgICAgc2VsZi5yZXF1ZXN0ZWRDb3VudCA9IHJlbWFpbmluZztcblx0XG5cdCAgICAgICAgICAgIHJldHVybiBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICBzZWxmLnJlcXVlc3RlZENvdW50ID0gMDtcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgLy8gU2NoZWR1bGVkIGl0ZW0gaXMgc3RpbGwgaW4gcHJvZ3Jlc3MuIFJldHVybiBhIG5ld1xuXHQgICAgICAgICAgICAgIC8vIGRpc3Bvc2FibGUgdG8gYWxsb3cgdGhlIHJlcXVlc3QgdG8gYmUgaW50ZXJydXB0ZWRcblx0ICAgICAgICAgICAgICAvLyB2aWEgZGlzcG9zZS5cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZTtcblx0ICAgICAgfSxcblx0ICAgICAgZGlzcG9zZUN1cnJlbnRSZXF1ZXN0OiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSkge1xuXHQgICAgICAgICAgdGhpcy5yZXF1ZXN0ZWREaXNwb3NhYmxlLmRpc3Bvc2UoKTtcblx0ICAgICAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSA9IG51bGw7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICByZXR1cm4gQ29udHJvbGxlZFN1YmplY3Q7XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqIEF0dGFjaGVzIGEgY29udHJvbGxlciB0byB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIHRoZSBhYmlsaXR5IHRvIHF1ZXVlLlxuXHQgICAqIEBleGFtcGxlXG5cdCAgICogdmFyIHNvdXJjZSA9IFJ4Lk9ic2VydmFibGUuaW50ZXJ2YWwoMTAwKS5jb250cm9sbGVkKCk7XG5cdCAgICogc291cmNlLnJlcXVlc3QoMyk7IC8vIFJlYWRzIDMgdmFsdWVzXG5cdCAgICogQHBhcmFtIHtib29sfSBlbmFibGVRdWV1ZSB0cnV0aHkgdmFsdWUgdG8gZGV0ZXJtaW5lIGlmIHZhbHVlcyBzaG91bGQgYmUgcXVldWVkIHBlbmRpbmcgdGhlIG5leHQgcmVxdWVzdFxuXHQgICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBzY2hlZHVsZXIgZGV0ZXJtaW5lcyBob3cgdGhlIHJlcXVlc3RzIHdpbGwgYmUgc2NoZWR1bGVkXG5cdCAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIG9ubHkgcHJvcGFnYXRlcyB2YWx1ZXMgb24gcmVxdWVzdC5cblx0ICAgKi9cblx0ICBvYnNlcnZhYmxlUHJvdG8uY29udHJvbGxlZCA9IGZ1bmN0aW9uIChlbmFibGVRdWV1ZSwgc2NoZWR1bGVyKSB7XG5cdFxuXHQgICAgaWYgKGVuYWJsZVF1ZXVlICYmIGlzU2NoZWR1bGVyKGVuYWJsZVF1ZXVlKSkge1xuXHQgICAgICBzY2hlZHVsZXIgPSBlbmFibGVRdWV1ZTtcblx0ICAgICAgZW5hYmxlUXVldWUgPSB0cnVlO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChlbmFibGVRdWV1ZSA9PSBudWxsKSB7ICBlbmFibGVRdWV1ZSA9IHRydWU7IH1cblx0ICAgIHJldHVybiBuZXcgQ29udHJvbGxlZE9ic2VydmFibGUodGhpcywgZW5hYmxlUXVldWUsIHNjaGVkdWxlcik7XG5cdCAgfTtcblx0XG5cdCAgLyoqXG5cdCAgICogUGlwZXMgdGhlIGV4aXN0aW5nIE9ic2VydmFibGUgc2VxdWVuY2UgaW50byBhIE5vZGUuanMgU3RyZWFtLlxuXHQgICAqIEBwYXJhbSB7U3RyZWFtfSBkZXN0IFRoZSBkZXN0aW5hdGlvbiBOb2RlLmpzIHN0cmVhbS5cblx0ICAgKiBAcmV0dXJucyB7U3RyZWFtfSBUaGUgZGVzdGluYXRpb24gc3RyZWFtLlxuXHQgICAqL1xuXHQgIG9ic2VydmFibGVQcm90by5waXBlID0gZnVuY3Rpb24gKGRlc3QpIHtcblx0ICAgIHZhciBzb3VyY2UgPSB0aGlzLnBhdXNhYmxlQnVmZmVyZWQoKTtcblx0XG5cdCAgICBmdW5jdGlvbiBvbkRyYWluKCkge1xuXHQgICAgICBzb3VyY2UucmVzdW1lKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgZGVzdC5hZGRMaXN0ZW5lcignZHJhaW4nLCBvbkRyYWluKTtcblx0XG5cdCAgICBzb3VyY2Uuc3Vic2NyaWJlKFxuXHQgICAgICBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgICFkZXN0LndyaXRlKFN0cmluZyh4KSkgJiYgc291cmNlLnBhdXNlKCk7XG5cdCAgICAgIH0sXG5cdCAgICAgIGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgICBkZXN0LmVtaXQoJ2Vycm9yJywgZXJyKTtcblx0ICAgICAgfSxcblx0ICAgICAgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIC8vIEhhY2sgY2hlY2sgYmVjYXVzZSBTVERJTyBpcyBub3QgY2xvc2FibGVcblx0ICAgICAgICAhZGVzdC5faXNTdGRpbyAmJiBkZXN0LmVuZCgpO1xuXHQgICAgICAgIGRlc3QucmVtb3ZlTGlzdGVuZXIoJ2RyYWluJywgb25EcmFpbik7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgIHNvdXJjZS5yZXN1bWUoKTtcblx0XG5cdCAgICByZXR1cm4gZGVzdDtcblx0ICB9O1xuXHRcblx0ICB2YXIgVHJhbnNkdWNlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoVHJhbnNkdWNlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBUcmFuc2R1Y2VPYnNlcnZlcihvLCB4Zm9ybSkge1xuXHQgICAgICB0aGlzLl9vID0gbztcblx0ICAgICAgdGhpcy5feGZvcm0gPSB4Zm9ybTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgVHJhbnNkdWNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5feGZvcm1bJ0BAdHJhbnNkdWNlci9zdGVwJ10pLmNhbGwodGhpcy5feGZvcm0sIHRoaXMuX28sIHgpO1xuXHQgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyB0aGlzLl9vLm9uRXJyb3IocmVzLmUpOyB9XG5cdCAgICB9O1xuXHRcblx0ICAgIFRyYW5zZHVjZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcblx0XG5cdCAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB0aGlzLl94Zm9ybVsnQEB0cmFuc2R1Y2VyL3Jlc3VsdCddKHRoaXMuX28pO1xuXHQgICAgfTtcblx0XG5cdCAgICByZXR1cm4gVHJhbnNkdWNlT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIGZ1bmN0aW9uIHRyYW5zZm9ybUZvck9ic2VydmVyKG8pIHtcblx0ICAgIHJldHVybiB7XG5cdCAgICAgICdAQHRyYW5zZHVjZXIvaW5pdCc6IGZ1bmN0aW9uKCkge1xuXHQgICAgICAgIHJldHVybiBvO1xuXHQgICAgICB9LFxuXHQgICAgICAnQEB0cmFuc2R1Y2VyL3N0ZXAnOiBmdW5jdGlvbihvYnMsIGlucHV0KSB7XG5cdCAgICAgICAgcmV0dXJuIG9icy5vbk5leHQoaW5wdXQpO1xuXHQgICAgICB9LFxuXHQgICAgICAnQEB0cmFuc2R1Y2VyL3Jlc3VsdCc6IGZ1bmN0aW9uKG9icykge1xuXHQgICAgICAgIHJldHVybiBvYnMub25Db21wbGV0ZWQoKTtcblx0ICAgICAgfVxuXHQgICAgfTtcblx0ICB9XG5cdFxuXHQgIC8qKlxuXHQgICAqIEV4ZWN1dGVzIGEgdHJhbnNkdWNlciB0byB0cmFuc2Zvcm0gdGhlIG9ic2VydmFibGUgc2VxdWVuY2Vcblx0ICAgKiBAcGFyYW0ge1RyYW5zZHVjZXJ9IHRyYW5zZHVjZXIgQSB0cmFuc2R1Y2VyIHRvIGV4ZWN1dGVcblx0ICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHRzIGZyb20gdGhlIHRyYW5zZHVjZXIuXG5cdCAgICovXG5cdCAgb2JzZXJ2YWJsZVByb3RvLnRyYW5zZHVjZSA9IGZ1bmN0aW9uKHRyYW5zZHVjZXIpIHtcblx0ICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuXHQgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uKG8pIHtcblx0ICAgICAgdmFyIHhmb3JtID0gdHJhbnNkdWNlcih0cmFuc2Zvcm1Gb3JPYnNlcnZlcihvKSk7XG5cdCAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBUcmFuc2R1Y2VPYnNlcnZlcihvLCB4Zm9ybSkpO1xuXHQgICAgfSwgc291cmNlKTtcblx0ICB9O1xuXHRcblx0ICB2YXIgQW5vbnltb3VzT2JzZXJ2YWJsZSA9IFJ4LkFub255bW91c09ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHQgICAgaW5oZXJpdHMoQW5vbnltb3VzT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblx0XG5cdCAgICAvLyBGaXggc3Vic2NyaWJlciB0byBjaGVjayBmb3IgdW5kZWZpbmVkIG9yIGZ1bmN0aW9uIHJldHVybmVkIHRvIGRlY29yYXRlIGFzIERpc3Bvc2FibGVcblx0ICAgIGZ1bmN0aW9uIGZpeFN1YnNjcmliZXIoc3Vic2NyaWJlcikge1xuXHQgICAgICByZXR1cm4gc3Vic2NyaWJlciAmJiBpc0Z1bmN0aW9uKHN1YnNjcmliZXIuZGlzcG9zZSkgPyBzdWJzY3JpYmVyIDpcblx0ICAgICAgICBpc0Z1bmN0aW9uKHN1YnNjcmliZXIpID8gZGlzcG9zYWJsZUNyZWF0ZShzdWJzY3JpYmVyKSA6IGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgIH1cblx0XG5cdCAgICBmdW5jdGlvbiBzZXREaXNwb3NhYmxlKHMsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBhZG8gPSBzdGF0ZVswXSwgc2VsZiA9IHN0YXRlWzFdO1xuXHQgICAgICB2YXIgc3ViID0gdHJ5Q2F0Y2goc2VsZi5fX3N1YnNjcmliZSkuY2FsbChzZWxmLCBhZG8pO1xuXHQgICAgICBpZiAoc3ViID09PSBlcnJvck9iaiAmJiAhYWRvLmZhaWwoZXJyb3JPYmouZSkpIHsgdGhyb3dlcihlcnJvck9iai5lKTsgfVxuXHQgICAgICBhZG8uc2V0RGlzcG9zYWJsZShmaXhTdWJzY3JpYmVyKHN1YikpO1xuXHQgICAgfVxuXHRcblx0ICAgIGZ1bmN0aW9uIEFub255bW91c09ic2VydmFibGUoc3Vic2NyaWJlLCBwYXJlbnQpIHtcblx0ICAgICAgdGhpcy5zb3VyY2UgPSBwYXJlbnQ7XG5cdCAgICAgIHRoaXMuX19zdWJzY3JpYmUgPSBzdWJzY3JpYmU7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIEFub255bW91c09ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuXHQgICAgICB2YXIgYWRvID0gbmV3IEF1dG9EZXRhY2hPYnNlcnZlcihvKSwgc3RhdGUgPSBbYWRvLCB0aGlzXTtcblx0XG5cdCAgICAgIGlmIChjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVxdWlyZWQoKSkge1xuXHQgICAgICAgIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNldERpc3Bvc2FibGUpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHNldERpc3Bvc2FibGUobnVsbCwgc3RhdGUpO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiBhZG87XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBBbm9ueW1vdXNPYnNlcnZhYmxlO1xuXHRcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgdmFyIEF1dG9EZXRhY2hPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhBdXRvRGV0YWNoT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cdFxuXHQgICAgZnVuY3Rpb24gQXV0b0RldGFjaE9ic2VydmVyKG9ic2VydmVyKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG5cdCAgICAgIHRoaXMubSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUgPSBBdXRvRGV0YWNoT2JzZXJ2ZXIucHJvdG90eXBlO1xuXHRcblx0ICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLm9ic2VydmVyLm9uTmV4dCkuY2FsbCh0aGlzLm9ic2VydmVyLCB2YWx1ZSk7XG5cdCAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7XG5cdCAgICAgICAgdGhpcy5kaXNwb3NlKCk7XG5cdCAgICAgICAgdGhyb3dlcihyZXN1bHQuZSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cdFxuXHQgICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuXHQgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5vYnNlcnZlci5vbkVycm9yKS5jYWxsKHRoaXMub2JzZXJ2ZXIsIGVycik7XG5cdCAgICAgIHRoaXMuZGlzcG9zZSgpO1xuXHQgICAgICByZXN1bHQgPT09IGVycm9yT2JqICYmIHRocm93ZXIocmVzdWx0LmUpO1xuXHQgICAgfTtcblx0XG5cdCAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5vYnNlcnZlci5vbkNvbXBsZXRlZCkuY2FsbCh0aGlzLm9ic2VydmVyKTtcblx0ICAgICAgdGhpcy5kaXNwb3NlKCk7XG5cdCAgICAgIHJlc3VsdCA9PT0gZXJyb3JPYmogJiYgdGhyb3dlcihyZXN1bHQuZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKHZhbHVlKSB7IHRoaXMubS5zZXREaXNwb3NhYmxlKHZhbHVlKTsgfTtcblx0ICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5nZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5tLmdldERpc3Bvc2FibGUoKTsgfTtcblx0XG5cdCAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgX19zdXBlcl9fLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMubS5kaXNwb3NlKCk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBBdXRvRGV0YWNoT2JzZXJ2ZXI7XG5cdCAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cdFxuXHQgIHZhciBJbm5lclN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uIChzLCBvKSB7XG5cdCAgICB0aGlzLl9zID0gcztcblx0ICAgIHRoaXMuX28gPSBvO1xuXHQgIH07XG5cdFxuXHQgIElubmVyU3Vic2NyaXB0aW9uLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgaWYgKCF0aGlzLl9zLmlzRGlzcG9zZWQgJiYgdGhpcy5fbyAhPT0gbnVsbCkge1xuXHQgICAgICB2YXIgaWR4ID0gdGhpcy5fcy5vYnNlcnZlcnMuaW5kZXhPZih0aGlzLl9vKTtcblx0ICAgICAgdGhpcy5fcy5vYnNlcnZlcnMuc3BsaWNlKGlkeCwgMSk7XG5cdCAgICAgIHRoaXMuX28gPSBudWxsO1xuXHQgICAgfVxuXHQgIH07XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXByZXNlbnRzIGFuIG9iamVjdCB0aGF0IGlzIGJvdGggYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyB3ZWxsIGFzIGFuIG9ic2VydmVyLlxuXHQgICAqICBFYWNoIG5vdGlmaWNhdGlvbiBpcyBicm9hZGNhc3RlZCB0byBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMuXG5cdCAgICovXG5cdCAgdmFyIFN1YmplY3QgPSBSeC5TdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFN1YmplY3QsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBTdWJqZWN0KCkge1xuXHQgICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXJzID0gW107XG5cdCAgICAgIHRoaXMuaGFzRXJyb3IgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICBhZGRQcm9wZXJ0aWVzKFN1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcblx0ICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gobyk7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IElubmVyU3Vic2NyaXB0aW9uKHRoaXMsIG8pO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuXHQgICAgICAgICAgby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuXHQgICAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG5cdCAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG5cdCAgICAgICAqL1xuXHQgICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7IH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICAgIG9zW2ldLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGV4Y2VwdGlvbi5cblx0ICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIGV4Y2VwdGlvbiB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblx0ICAgICAgICAgIHRoaXMuaGFzRXJyb3IgPSB0cnVlO1xuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICAgIG9zW2ldLm9uRXJyb3IoZXJyb3IpO1xuXHQgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBhcnJpdmFsIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICAgIG9zW2ldLm9uTmV4dCh2YWx1ZSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogVW5zdWJzY3JpYmUgYWxsIG9ic2VydmVycyBhbmQgcmVsZWFzZSByZXNvdXJjZXMuXG5cdCAgICAgICAqL1xuXHQgICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm9ic2VydmVycyA9IG51bGw7XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHRcblx0ICAgIC8qKlxuXHQgICAgICogQ3JlYXRlcyBhIHN1YmplY3QgZnJvbSB0aGUgc3BlY2lmaWVkIG9ic2VydmVyIGFuZCBvYnNlcnZhYmxlLlxuXHQgICAgICogQHBhcmFtIHtPYnNlcnZlcn0gb2JzZXJ2ZXIgVGhlIG9ic2VydmVyIHVzZWQgdG8gc2VuZCBtZXNzYWdlcyB0byB0aGUgc3ViamVjdC5cblx0ICAgICAqIEBwYXJhbSB7T2JzZXJ2YWJsZX0gb2JzZXJ2YWJsZSBUaGUgb2JzZXJ2YWJsZSB1c2VkIHRvIHN1YnNjcmliZSB0byBtZXNzYWdlcyBzZW50IGZyb20gdGhlIHN1YmplY3QuXG5cdCAgICAgKiBAcmV0dXJucyB7U3ViamVjdH0gU3ViamVjdCBpbXBsZW1lbnRlZCB1c2luZyB0aGUgZ2l2ZW4gb2JzZXJ2ZXIgYW5kIG9ic2VydmFibGUuXG5cdCAgICAgKi9cblx0ICAgIFN1YmplY3QuY3JlYXRlID0gZnVuY3Rpb24gKG9ic2VydmVyLCBvYnNlcnZhYmxlKSB7XG5cdCAgICAgIHJldHVybiBuZXcgQW5vbnltb3VzU3ViamVjdChvYnNlcnZlciwgb2JzZXJ2YWJsZSk7XG5cdCAgICB9O1xuXHRcblx0ICAgIHJldHVybiBTdWJqZWN0O1xuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiAgUmVwcmVzZW50cyB0aGUgcmVzdWx0IG9mIGFuIGFzeW5jaHJvbm91cyBvcGVyYXRpb24uXG5cdCAgICogIFRoZSBsYXN0IHZhbHVlIGJlZm9yZSB0aGUgT25Db21wbGV0ZWQgbm90aWZpY2F0aW9uLCBvciB0aGUgZXJyb3IgcmVjZWl2ZWQgdGhyb3VnaCBPbkVycm9yLCBpcyBzZW50IHRvIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycy5cblx0ICAgKi9cblx0ICB2YXIgQXN5bmNTdWJqZWN0ID0gUnguQXN5bmNTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEFzeW5jU3ViamVjdCwgX19zdXBlcl9fKTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqIENyZWF0ZXMgYSBzdWJqZWN0IHRoYXQgY2FuIG9ubHkgcmVjZWl2ZSBvbmUgdmFsdWUgYW5kIHRoYXQgdmFsdWUgaXMgY2FjaGVkIGZvciBhbGwgZnV0dXJlIG9ic2VydmF0aW9ucy5cblx0ICAgICAqIEBjb25zdHJ1Y3RvclxuXHQgICAgICovXG5cdCAgICBmdW5jdGlvbiBBc3luY1N1YmplY3QoKSB7XG5cdCAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5oYXNWYWx1ZSA9IGZhbHNlO1xuXHQgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuXHQgICAgICB0aGlzLmhhc0Vycm9yID0gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgYWRkUHJvcGVydGllcyhBc3luY1N1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcblx0ICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHRcblx0ICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG5cdCAgICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG8pO1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBJbm5lclN1YnNjcmlwdGlvbih0aGlzLCBvKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG5cdCAgICAgICAgICBvLm9uRXJyb3IodGhpcy5lcnJvcik7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhhc1ZhbHVlKSB7XG5cdCAgICAgICAgICBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcblx0ICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cblx0ICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cblx0ICAgICAgICovXG5cdCAgICAgIGhhc09ic2VydmVyczogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UsIGFsc28gY2F1c2luZyB0aGUgbGFzdCByZWNlaXZlZCB2YWx1ZSB0byBiZSBzZW50IG91dCAoaWYgYW55KS5cblx0ICAgICAgICovXG5cdCAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIGksIGxlbjtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHZhciBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7XG5cdFxuXHQgICAgICAgICAgaWYgKHRoaXMuaGFzVmFsdWUpIHtcblx0ICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICAgICAgdmFyIG8gPSBvc1tpXTtcblx0ICAgICAgICAgICAgICBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcblx0ICAgICAgICAgICAgICBvLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgICAgIG9zW2ldLm9uQ29tcGxldGVkKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXJyb3IuXG5cdCAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIFRoZSBFcnJvciB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcblx0ICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHRoaXMuaGFzRXJyb3IgPSB0cnVlO1xuXHQgICAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXHRcblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcblx0ICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIFNlbmRzIGEgdmFsdWUgdG8gdGhlIHN1YmplY3QuIFRoZSBsYXN0IHZhbHVlIHJlY2VpdmVkIGJlZm9yZSBzdWNjZXNzZnVsIHRlcm1pbmF0aW9uIHdpbGwgYmUgc2VudCB0byBhbGwgc3Vic2NyaWJlZCBhbmQgZnV0dXJlIG9ic2VydmVycy5cblx0ICAgICAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIHN0b3JlIGluIHRoZSBzdWJqZWN0LlxuXHQgICAgICAgKi9cblx0ICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cdCAgICAgICAgdGhpcy5oYXNWYWx1ZSA9IHRydWU7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBVbnN1YnNjcmliZSBhbGwgb2JzZXJ2ZXJzIGFuZCByZWxlYXNlIHJlc291cmNlcy5cblx0ICAgICAgICovXG5cdCAgICAgIGRpc3Bvc2U6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcblx0ICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcblx0ICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIEFzeW5jU3ViamVjdDtcblx0ICB9KE9ic2VydmFibGUpKTtcblx0XG5cdCAgdmFyIEFub255bW91c1N1YmplY3QgPSBSeC5Bbm9ueW1vdXNTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKEFub255bW91c1N1YmplY3QsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBBbm9ueW1vdXNTdWJqZWN0KG9ic2VydmVyLCBvYnNlcnZhYmxlKSB7XG5cdCAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcblx0ICAgICAgdGhpcy5vYnNlcnZhYmxlID0gb2JzZXJ2YWJsZTtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgYWRkUHJvcGVydGllcyhBbm9ueW1vdXNTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG5cdCAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2YWJsZS5zdWJzY3JpYmUobyk7XG5cdCAgICAgIH0sXG5cdCAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICB9LFxuXHQgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICB0aGlzLm9ic2VydmVyLm9uRXJyb3IoZXJyb3IpO1xuXHQgICAgICB9LFxuXHQgICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXIub25OZXh0KHZhbHVlKTtcblx0ICAgICAgfVxuXHQgICAgfSk7XG5cdFxuXHQgICAgcmV0dXJuIEFub255bW91c1N1YmplY3Q7XG5cdCAgfShPYnNlcnZhYmxlKSk7XG5cdFxuXHQgIC8qKlxuXHQgICAqICBSZXByZXNlbnRzIGEgdmFsdWUgdGhhdCBjaGFuZ2VzIG92ZXIgdGltZS5cblx0ICAgKiAgT2JzZXJ2ZXJzIGNhbiBzdWJzY3JpYmUgdG8gdGhlIHN1YmplY3QgdG8gcmVjZWl2ZSB0aGUgbGFzdCAob3IgaW5pdGlhbCkgdmFsdWUgYW5kIGFsbCBzdWJzZXF1ZW50IG5vdGlmaWNhdGlvbnMuXG5cdCAgICovXG5cdCAgdmFyIEJlaGF2aW9yU3ViamVjdCA9IFJ4LkJlaGF2aW9yU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG5cdCAgICBpbmhlcml0cyhCZWhhdmlvclN1YmplY3QsIF9fc3VwZXJfXyk7XG5cdCAgICBmdW5jdGlvbiBCZWhhdmlvclN1YmplY3QodmFsdWUpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcblx0ICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcblx0ICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG5cdCAgICAgIHRoaXMuaGFzRXJyb3IgPSBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICBhZGRQcm9wZXJ0aWVzKEJlaGF2aW9yU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuXHQgICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvKTtcblx0ICAgICAgICAgIG8ub25OZXh0KHRoaXMudmFsdWUpO1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBJbm5lclN1YnNjcmlwdGlvbih0aGlzLCBvKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3IpIHtcblx0ICAgICAgICAgIG8ub25FcnJvcih0aGlzLmVycm9yKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogR2V0cyB0aGUgY3VycmVudCB2YWx1ZSBvciB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuXHQgICAgICAgKiBWYWx1ZSBpcyBmcm96ZW4gYWZ0ZXIgb25Db21wbGV0ZWQgaXMgY2FsbGVkLlxuXHQgICAgICAgKiBBZnRlciBvbkVycm9yIGlzIGNhbGxlZCBhbHdheXMgdGhyb3dzIHRoZSBzcGVjaWZpZWQgZXhjZXB0aW9uLlxuXHQgICAgICAgKiBBbiBleGNlcHRpb24gaXMgYWx3YXlzIHRocm93biBhZnRlciBkaXNwb3NlIGlzIGNhbGxlZC5cblx0ICAgICAgICogQHJldHVybnMge01peGVkfSBUaGUgaW5pdGlhbCB2YWx1ZSBwYXNzZWQgdG8gdGhlIGNvbnN0cnVjdG9yIHVudGlsIG9uTmV4dCBpcyBjYWxsZWQ7IGFmdGVyIHdoaWNoLCB0aGUgbGFzdCB2YWx1ZSBwYXNzZWQgdG8gb25OZXh0LlxuXHQgICAgICAgKi9cblx0ICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuXHQgICAgICAgICAgICAgIHRocm93IHRoaXMuZXJyb3I7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cblx0ICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cblx0ICAgICAgICovXG5cdCAgICAgIGhhc09ic2VydmVyczogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5vYnNlcnZlcnMubGVuZ3RoID4gMDsgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZS5cblx0ICAgICAgICovXG5cdCAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgb3NbaV0ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGV4Y2VwdGlvbi5cblx0ICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIGV4Y2VwdGlvbiB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXHRcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgIG9zW2ldLm9uRXJyb3IoZXJyb3IpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgYXJyaXZhbCBvZiB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuXHQgICAgICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25OZXh0OiBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICBvc1tpXS5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLyoqXG5cdCAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuXHQgICAgICAgKi9cblx0ICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBudWxsO1xuXHQgICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuXHQgICAgICAgIHRoaXMuZXJyb3IgPSBudWxsO1xuXHQgICAgICB9XG5cdCAgICB9KTtcblx0XG5cdCAgICByZXR1cm4gQmVoYXZpb3JTdWJqZWN0O1xuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICAvKipcblx0ICAgKiBSZXByZXNlbnRzIGFuIG9iamVjdCB0aGF0IGlzIGJvdGggYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyB3ZWxsIGFzIGFuIG9ic2VydmVyLlxuXHQgICAqIEVhY2ggbm90aWZpY2F0aW9uIGlzIGJyb2FkY2FzdGVkIHRvIGFsbCBzdWJzY3JpYmVkIGFuZCBmdXR1cmUgb2JzZXJ2ZXJzLCBzdWJqZWN0IHRvIGJ1ZmZlciB0cmltbWluZyBwb2xpY2llcy5cblx0ICAgKi9cblx0ICB2YXIgUmVwbGF5U3ViamVjdCA9IFJ4LlJlcGxheVN1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXHRcblx0ICAgIHZhciBtYXhTYWZlSW50ZWdlciA9IE1hdGgucG93KDIsIDUzKSAtIDE7XG5cdFxuXHQgICAgZnVuY3Rpb24gY3JlYXRlUmVtb3ZhYmxlRGlzcG9zYWJsZShzdWJqZWN0LCBvYnNlcnZlcikge1xuXHQgICAgICByZXR1cm4gZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgb2JzZXJ2ZXIuZGlzcG9zZSgpO1xuXHQgICAgICAgICFzdWJqZWN0LmlzRGlzcG9zZWQgJiYgc3ViamVjdC5vYnNlcnZlcnMuc3BsaWNlKHN1YmplY3Qub2JzZXJ2ZXJzLmluZGV4T2Yob2JzZXJ2ZXIpLCAxKTtcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdFxuXHQgICAgaW5oZXJpdHMoUmVwbGF5U3ViamVjdCwgX19zdXBlcl9fKTtcblx0XG5cdCAgICAvKipcblx0ICAgICAqICBJbml0aWFsaXplcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgUmVwbGF5U3ViamVjdCBjbGFzcyB3aXRoIHRoZSBzcGVjaWZpZWQgYnVmZmVyIHNpemUsIHdpbmRvdyBzaXplIGFuZCBzY2hlZHVsZXIuXG5cdCAgICAgKiAgQHBhcmFtIHtOdW1iZXJ9IFtidWZmZXJTaXplXSBNYXhpbXVtIGVsZW1lbnQgY291bnQgb2YgdGhlIHJlcGxheSBidWZmZXIuXG5cdCAgICAgKiAgQHBhcmFtIHtOdW1iZXJ9IFt3aW5kb3dTaXplXSBNYXhpbXVtIHRpbWUgbGVuZ3RoIG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuXHQgICAgICogIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdGhlIG9ic2VydmVycyBhcmUgaW52b2tlZCBvbi5cblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gUmVwbGF5U3ViamVjdChidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpIHtcblx0ICAgICAgdGhpcy5idWZmZXJTaXplID0gYnVmZmVyU2l6ZSA9PSBudWxsID8gbWF4U2FmZUludGVnZXIgOiBidWZmZXJTaXplO1xuXHQgICAgICB0aGlzLndpbmRvd1NpemUgPSB3aW5kb3dTaXplID09IG51bGwgPyBtYXhTYWZlSW50ZWdlciA6IHdpbmRvd1NpemU7XG5cdCAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyIHx8IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXI7XG5cdCAgICAgIHRoaXMucSA9IFtdO1xuXHQgICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuXHQgICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcblx0ICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuXHQgICAgICB0aGlzLmVycm9yID0gbnVsbDtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgYWRkUHJvcGVydGllcyhSZXBsYXlTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG5cdCAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICB2YXIgc28gPSBuZXcgU2NoZWR1bGVkT2JzZXJ2ZXIodGhpcy5zY2hlZHVsZXIsIG8pLCBzdWJzY3JpcHRpb24gPSBjcmVhdGVSZW1vdmFibGVEaXNwb3NhYmxlKHRoaXMsIHNvKTtcblx0XG5cdCAgICAgICAgdGhpcy5fdHJpbSh0aGlzLnNjaGVkdWxlci5ub3coKSk7XG5cdCAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChzbyk7XG5cdFxuXHQgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLnEubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgIHNvLm9uTmV4dCh0aGlzLnFbaV0udmFsdWUpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgaWYgKHRoaXMuaGFzRXJyb3IpIHtcblx0ICAgICAgICAgIHNvLm9uRXJyb3IodGhpcy5lcnJvcik7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzU3RvcHBlZCkge1xuXHQgICAgICAgICAgc28ub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHNvLmVuc3VyZUFjdGl2ZSgpO1xuXHQgICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG5cdCAgICAgIH0sXG5cdCAgICAgIC8qKlxuXHQgICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG5cdCAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG5cdCAgICAgICAqL1xuXHQgICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5vYnNlcnZlcnMubGVuZ3RoID4gMDtcblx0ICAgICAgfSxcblx0ICAgICAgX3RyaW06IGZ1bmN0aW9uIChub3cpIHtcblx0ICAgICAgICB3aGlsZSAodGhpcy5xLmxlbmd0aCA+IHRoaXMuYnVmZmVyU2l6ZSkge1xuXHQgICAgICAgICAgdGhpcy5xLnNoaWZ0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIHdoaWxlICh0aGlzLnEubGVuZ3RoID4gMCAmJiAobm93IC0gdGhpcy5xWzBdLmludGVydmFsKSA+IHRoaXMud2luZG93U2l6ZSkge1xuXHQgICAgICAgICAgdGhpcy5xLnNoaWZ0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBhcnJpdmFsIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG5cdCAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG5cdCAgICAgICAqL1xuXHQgICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG5cdCAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuXHQgICAgICAgIHZhciBub3cgPSB0aGlzLnNjaGVkdWxlci5ub3coKTtcblx0ICAgICAgICB0aGlzLnEucHVzaCh7IGludGVydmFsOiBub3csIHZhbHVlOiB2YWx1ZSB9KTtcblx0ICAgICAgICB0aGlzLl90cmltKG5vdyk7XG5cdFxuXHQgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgdmFyIG9ic2VydmVyID0gb3NbaV07XG5cdCAgICAgICAgICBvYnNlcnZlci5vbk5leHQodmFsdWUpO1xuXHQgICAgICAgICAgb2JzZXJ2ZXIuZW5zdXJlQWN0aXZlKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBleGNlcHRpb24uXG5cdCAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIFRoZSBleGNlcHRpb24gdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG5cdCAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcblx0ICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG5cdCAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblx0ICAgICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcblx0ICAgICAgICB2YXIgbm93ID0gdGhpcy5zY2hlZHVsZXIubm93KCk7XG5cdCAgICAgICAgdGhpcy5fdHJpbShub3cpO1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgdmFyIG9ic2VydmVyID0gb3NbaV07XG5cdCAgICAgICAgICBvYnNlcnZlci5vbkVycm9yKGVycm9yKTtcblx0ICAgICAgICAgIG9ic2VydmVyLmVuc3VyZUFjdGl2ZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuXHQgICAgICAgKi9cblx0ICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXHQgICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cblx0ICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG5cdCAgICAgICAgdmFyIG5vdyA9IHRoaXMuc2NoZWR1bGVyLm5vdygpO1xuXHQgICAgICAgIHRoaXMuX3RyaW0obm93KTtcblx0ICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0ICAgICAgICAgIHZhciBvYnNlcnZlciA9IG9zW2ldO1xuXHQgICAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcblx0ICAgICAgICAgIG9ic2VydmVyLmVuc3VyZUFjdGl2ZSgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuXHQgICAgICB9LFxuXHQgICAgICAvKipcblx0ICAgICAgICogVW5zdWJzY3JpYmUgYWxsIG9ic2VydmVycyBhbmQgcmVsZWFzZSByZXNvdXJjZXMuXG5cdCAgICAgICAqL1xuXHQgICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLm9ic2VydmVycyA9IG51bGw7XG5cdCAgICAgIH1cblx0ICAgIH0pO1xuXHRcblx0ICAgIHJldHVybiBSZXBsYXlTdWJqZWN0O1xuXHQgIH0oT2JzZXJ2YWJsZSkpO1xuXHRcblx0ICAvKipcblx0ICAqIFVzZWQgdG8gcGF1c2UgYW5kIHJlc3VtZSBzdHJlYW1zLlxuXHQgICovXG5cdCAgUnguUGF1c2VyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcblx0ICAgIGluaGVyaXRzKFBhdXNlciwgX19zdXBlcl9fKTtcblx0ICAgIGZ1bmN0aW9uIFBhdXNlcigpIHtcblx0ICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXG5cdCAgICAgKiBQYXVzZXMgdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UuXG5cdCAgICAgKi9cblx0ICAgIFBhdXNlci5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7IHRoaXMub25OZXh0KGZhbHNlKTsgfTtcblx0XG5cdCAgICAvKipcblx0ICAgICogUmVzdW1lcyB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cblx0ICAgICovXG5cdCAgICBQYXVzZXIucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5vbk5leHQodHJ1ZSk7IH07XG5cdFxuXHQgICAgcmV0dXJuIFBhdXNlcjtcblx0ICB9KFN1YmplY3QpKTtcblx0XG5cdCAgaWYgKHRydWUpIHtcblx0ICAgIHJvb3QuUnggPSBSeDtcblx0XG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fID0gZnVuY3Rpb24oKSB7XG5cdCAgICAgIHJldHVybiBSeDtcblx0ICAgIH0uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fLCBleHBvcnRzLCBtb2R1bGUpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlKSB7XG5cdCAgICAvLyBpbiBOb2RlLmpzIG9yIFJpbmdvSlNcblx0ICAgIGlmIChtb2R1bGVFeHBvcnRzKSB7XG5cdCAgICAgIChmcmVlTW9kdWxlLmV4cG9ydHMgPSBSeCkuUnggPSBSeDtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGZyZWVFeHBvcnRzLlJ4ID0gUng7XG5cdCAgICB9XG5cdCAgfSBlbHNlIHtcblx0ICAgIC8vIGluIGEgYnJvd3NlciBvciBSaGlub1xuXHQgICAgcm9vdC5SeCA9IFJ4O1xuXHQgIH1cblx0XG5cdCAgLy8gQWxsIGNvZGUgYmVmb3JlIHRoaXMgcG9pbnQgd2lsbCBiZSBmaWx0ZXJlZCBmcm9tIHN0YWNrIHRyYWNlcy5cblx0ICB2YXIgckVuZGluZ0xpbmUgPSBjYXB0dXJlTGluZSgpO1xuXHRcblx0fS5jYWxsKHRoaXMpKTtcblx0XG5cdC8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDM4KShtb2R1bGUpLCAoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDExKSkpXG5cbi8qKiovIH0sXG4vKiAxOSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0ZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXygyMCkoKTtcblx0Ly8gaW1wb3J0c1xuXHRcblx0XG5cdC8vIG1vZHVsZVxuXHRleHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIuY2xpbWJfX3dhbGx7d2lkdGg6MTAwJTtwYWRkaW5nOjA7bWFyZ2luOjA7LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOy1tcy1mbGV4LXBhY2s6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpyb3c7LW1zLWZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LWRpcmVjdGlvbjpyb3c7LXdlYmtpdC1mbGV4LXdyYXA6d3JhcDstbXMtZmxleC13cmFwOndyYXA7ZmxleC13cmFwOndyYXA7Zm9udC1zaXplOjEwMCV9LmNsaW1iX190aWxlLC5jbGltYl9fd2FsbHtkaXNwbGF5Oi13ZWJraXQtZmxleDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleH0uY2xpbWJfX3RpbGV7LXdlYmtpdC1mbGV4LXNocmluazowOy1tcy1mbGV4LW5lZ2F0aXZlOjA7ZmxleC1zaHJpbms6MDtoZWlnaHQ6NDI1cHg7Ym94LXNpemluZzpib3JkZXItYm94Oy13ZWJraXQtanVzdGlmeS1jb250ZW50OmZsZXgtZW5kOy1tcy1mbGV4LXBhY2s6ZW5kO2p1c3RpZnktY29udGVudDpmbGV4LWVuZDstd2Via2l0LWZsZXgtZGlyZWN0aW9uOmNvbHVtbjstbXMtZmxleC1kaXJlY3Rpb246Y29sdW1uO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjttYXJnaW4tYm90dG9tOjIwcHg7b3ZlcmZsb3c6aGlkZGVuO3RleHQtYWxpZ246bGVmdDtib3JkZXItcmFkaXVzOjdweDtiYWNrZ3JvdW5kLWNvbG9yOiNmNmY2ZjY7LXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbjtiYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbjstd2Via2l0LXBlcnNwZWN0aXZlOjEwMDBweDtwZXJzcGVjdGl2ZToxMDAwcHh9LmNsaW1iX190aWxlX19jb250ZW50e3otaW5kZXg6MTtwYWRkaW5nOjI2cHg7YmFja2dyb3VuZC1jb2xvcjojZjZmNmY2fS5jbGltYl9fdGlsZS0taGFzLW5vLWltYWdlIC5jbGltYl9fdGlsZV9fY29udGVudHtoZWlnaHQ6MTAwJTtkaXNwbGF5Oi13ZWJraXQtZmxleDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstd2Via2l0LWZsZXgtZGlyZWN0aW9uOmNvbHVtbjstbXMtZmxleC1kaXJlY3Rpb246Y29sdW1uO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjstd2Via2l0LWp1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOy1tcy1mbGV4LXBhY2s6anVzdGlmeTtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2Vlbjtib3gtc2l6aW5nOmJvcmRlci1ib3h9LmNsaW1iX19pbWFnZXtkaXNwbGF5OmJsb2NrO21heC13aWR0aDoxMDAlO3otaW5kZXg6NX0uY2xpbWJfX3RpbGUgLmNsaW1iX19pbWFnZXtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3JkZXItdG9wLWxlZnQtcmFkaXVzOjdweDtib3JkZXItdG9wLXJpZ2h0LXJhZGl1czo3cHh9LmNsaW1iLXNsaWRlc2hvdyAuY2xpbWJfX2ltYWdle2JveC1zaGFkb3c6MCAwIDE0cHggMCByZ2JhKDAsMCwwLC43NSk7Ym9yZGVyLXJhZGl1czo3cHh9LmNsaW1iX19tZXNzYWdle3otaW5kZXg6MX0uY2xpbWJfX21lc3NhZ2U+YXt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7bWF4LXdpZHRoOjI2MHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOmJvdHRvbX0uY2xpbWItdGlsZSAuY2xpbWJfX21lc3NhZ2V7bWFyZ2luLWJvdHRvbToyNHB4fS5jbGltYl9fdGlsZS0taGFzLW5vLWltYWdlIC5jbGltYl9fbWVzc2FnZXtmb250LXNpemU6MTg1JX0uY2xpbWItc2xpZGVzaG93X19zbGlkZS0taGFzLW5vLWltYWdlIC5jbGltYl9fbWVzc2FnZXtmb250LXNpemU6MjIwJX0uY2xpbWJfX2F1dGhvcntkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW46LTEwcHh9LmNsaW1iX19hdXRob3IgaW1ne2JvcmRlci1yYWRpdXM6MjVweH0uY2xpbWJfX2F1dGhvciAuY2xpbWJfX3RpbGVfX2F1dGhvcl9fdXNlcm5hbWV7ZGlzcGxheTppbmxpbmUtYmxvY2s7bWFyZ2luOjAgMCAwIDEwcHg7bGluZS1oZWlnaHQ6MzRweDt2ZXJ0aWNhbC1hbGlnbjp0b3B9LmNsaW1iLXNvY2lhbC1iYWRnZXtwb3NpdGlvbjpmaXhlZDtib3R0b206MjBweDtyaWdodDoyMHB4O3otaW5kZXg6OTtiYWNrZ3JvdW5kLWNvbG9yOiNhOWNhZTI7d2lkdGg6MjAwcHg7aGVpZ2h0OjY2cHg7Ym9yZGVyLXJhZGl1czo1cHh9LmNsaW1iLXNvY2lhbC1iYWRnZT5zcGFue3Bvc2l0aW9uOmFic29sdXRlIWltcG9ydGFudDt0b3A6LTk5OTlweCFpbXBvcnRhbnQ7bGVmdDotOTk5OXB4IWltcG9ydGFudH0uY2xpbWItc2xpZGVzaG93e2hlaWdodDoxMDB2aDt3aWR0aDoxMDB2dztmb250LXNpemU6MTYwJX0uY2xpbWJfX3NsaWRlc2hvd19fY29udGFpbmVye3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7cG9zaXRpb246cmVsYXRpdmV9LmNsaW1iLXNsaWRlc2hvd19fc2xpZGV7cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtkaXNwbGF5Oi13ZWJraXQtZmxleDtkaXNwbGF5Oi1tcy1mbGV4Ym94O2Rpc3BsYXk6ZmxleDstd2Via2l0LWFsaWduLWl0ZW1zOmNlbnRlcjstbXMtZmxleC1hbGlnbjpjZW50ZXI7YWxpZ24taXRlbXM6Y2VudGVyOy13ZWJraXQtZmxleC1kaXJlY3Rpb246cm93Oy1tcy1mbGV4LWRpcmVjdGlvbjpyb3c7ZmxleC1kaXJlY3Rpb246cm93Oy13ZWJraXQtanVzdGlmeS1jb250ZW50OmNlbnRlcjstbXMtZmxleC1wYWNrOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5jbGltYi1zbGlkZXNob3dfX3BhbmVsLC5jbGltYi1zbGlkZXNob3dfX3NsaWRley13ZWJraXQtYmFja2ZhY2UtdmlzaWJpbGl0eTpoaWRkZW47YmFja2ZhY2UtdmlzaWJpbGl0eTpoaWRkZW47LXdlYmtpdC1wZXJzcGVjdGl2ZToxMDAwcHg7cGVyc3BlY3RpdmU6MTAwMHB4fS5jbGltYi1zbGlkZXNob3dfX3BhbmVse2JveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmlubGluZS1ibG9jaztwb3NpdGlvbjpyZWxhdGl2ZTtwYWRkaW5nOjMwcHggMTVweCA1cHg7d2lkdGg6NTAlO2JvcmRlci1yYWRpdXM6M3B4O2JhY2tncm91bmQtY29sb3I6I2Y2ZjZmNn0uY2xpbWItc2xpZGVzaG93X19zbGlkZS0taGFzLW5vLWltYWdlIC5jbGltYi1zbGlkZXNob3dfX3BhbmVse3BhZGRpbmc6MzBweDtib3JkZXItcmFkaXVzOjdweDtib3gtc2hhZG93OjAgMCAxNHB4IDAgcmdiYSgwLDAsMCwuNzUpfVwiLCBcIlwiXSk7XG5cdFxuXHQvLyBleHBvcnRzXG5cblxuLyoqKi8gfSxcbi8qIDIwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvKlxyXG5cdFx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuXHRcdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuXHQqL1xyXG5cdC8vIGNzcyBiYXNlIGNvZGUsIGluamVjdGVkIGJ5IHRoZSBjc3MtbG9hZGVyXHJcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBsaXN0ID0gW107XHJcblx0XHJcblx0XHQvLyByZXR1cm4gdGhlIGxpc3Qgb2YgbW9kdWxlcyBhcyBjc3Mgc3RyaW5nXHJcblx0XHRsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XHJcblx0XHRcdHZhciByZXN1bHQgPSBbXTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgaXRlbSA9IHRoaXNbaV07XHJcblx0XHRcdFx0aWYoaXRlbVsyXSkge1xyXG5cdFx0XHRcdFx0cmVzdWx0LnB1c2goXCJAbWVkaWEgXCIgKyBpdGVtWzJdICsgXCJ7XCIgKyBpdGVtWzFdICsgXCJ9XCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRyZXN1bHQucHVzaChpdGVtWzFdKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIHJlc3VsdC5qb2luKFwiXCIpO1xyXG5cdFx0fTtcclxuXHRcclxuXHRcdC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XHJcblx0XHRsaXN0LmkgPSBmdW5jdGlvbihtb2R1bGVzLCBtZWRpYVF1ZXJ5KSB7XHJcblx0XHRcdGlmKHR5cGVvZiBtb2R1bGVzID09PSBcInN0cmluZ1wiKVxyXG5cdFx0XHRcdG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsIFwiXCJdXTtcclxuXHRcdFx0dmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR2YXIgaWQgPSB0aGlzW2ldWzBdO1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBpZCA9PT0gXCJudW1iZXJcIilcclxuXHRcdFx0XHRcdGFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaWRdID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIGl0ZW0gPSBtb2R1bGVzW2ldO1xyXG5cdFx0XHRcdC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcclxuXHRcdFx0XHQvLyB0aGlzIGltcGxlbWVudGF0aW9uIGlzIG5vdCAxMDAlIHBlcmZlY3QgZm9yIHdlaXJkIG1lZGlhIHF1ZXJ5IGNvbWJpbmF0aW9uc1xyXG5cdFx0XHRcdC8vICB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXHJcblx0XHRcdFx0Ly8gIEkgaG9wZSB0aGlzIHdpbGwgbmV2ZXIgb2NjdXIgKEhleSB0aGlzIHdheSB3ZSBoYXZlIHNtYWxsZXIgYnVuZGxlcylcclxuXHRcdFx0XHRpZih0eXBlb2YgaXRlbVswXSAhPT0gXCJudW1iZXJcIiB8fCAhYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpdGVtWzBdXSkge1xyXG5cdFx0XHRcdFx0aWYobWVkaWFRdWVyeSAmJiAhaXRlbVsyXSkge1xyXG5cdFx0XHRcdFx0XHRpdGVtWzJdID0gbWVkaWFRdWVyeTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZihtZWRpYVF1ZXJ5KSB7XHJcblx0XHRcdFx0XHRcdGl0ZW1bMl0gPSBcIihcIiArIGl0ZW1bMl0gKyBcIikgYW5kIChcIiArIG1lZGlhUXVlcnkgKyBcIilcIjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGxpc3QucHVzaChpdGVtKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0XHRyZXR1cm4gbGlzdDtcclxuXHR9O1xyXG5cblxuLyoqKi8gfSxcbi8qIDIxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXzsoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHQgIGlmICh0cnVlKSB7XG5cdCAgICAhKF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18gPSBbZXhwb3J0cywgbW9kdWxlXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID0gKGZhY3RvcnkpLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9ICh0eXBlb2YgX19XRUJQQUNLX0FNRF9ERUZJTkVfRkFDVE9SWV9fID09PSAnZnVuY3Rpb24nID8gKF9fV0VCUEFDS19BTURfREVGSU5FX0ZBQ1RPUllfXy5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSkgOiBfX1dFQlBBQ0tfQU1EX0RFRklORV9GQUNUT1JZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cdCAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgIGZhY3RvcnkoZXhwb3J0cywgbW9kdWxlKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgdmFyIG1vZCA9IHtcblx0ICAgICAgZXhwb3J0czoge31cblx0ICAgIH07XG5cdCAgICBmYWN0b3J5KG1vZC5leHBvcnRzLCBtb2QpO1xuXHQgICAgZ2xvYmFsLmZldGNoSnNvbnAgPSBtb2QuZXhwb3J0cztcblx0ICB9XG5cdH0pKHRoaXMsIGZ1bmN0aW9uIChleHBvcnRzLCBtb2R1bGUpIHtcblx0ICAndXNlIHN0cmljdCc7XG5cdFxuXHQgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcblx0ICAgIHRpbWVvdXQ6IDUwMDAsXG5cdCAgICBqc29ucENhbGxiYWNrOiAnY2FsbGJhY2snXG5cdCAgfTtcblx0XG5cdCAgZnVuY3Rpb24gZ2VuZXJhdGVDYWxsYmFja0Z1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuICdqc29ucF8nICsgRGF0ZS5ub3coKSArICdfJyArIE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTAwMDAwKTtcblx0ICB9XG5cdFxuXHQgIC8vIEtub3duIGlzc3VlOiBXaWxsIHRocm93ICdVbmNhdWdodCBSZWZlcmVuY2VFcnJvcjogY2FsbGJhY2tfKioqIGlzIG5vdCBkZWZpbmVkJyBlcnJvciBpZiByZXF1ZXN0IHRpbWVvdXRcblx0ICBmdW5jdGlvbiBjbGVhckZ1bmN0aW9uKGZ1bmN0aW9uTmFtZSkge1xuXHQgICAgLy8gSUU4IHRocm93cyBhbiBleGNlcHRpb24gd2hlbiB5b3UgdHJ5IHRvIGRlbGV0ZSBhIHByb3BlcnR5IG9uIHdpbmRvd1xuXHQgICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMTgyNDIyOC83NTEwODlcblx0ICAgIHRyeSB7XG5cdCAgICAgIGRlbGV0ZSB3aW5kb3dbZnVuY3Rpb25OYW1lXTtcblx0ICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgd2luZG93W2Z1bmN0aW9uTmFtZV0gPSB1bmRlZmluZWQ7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICBmdW5jdGlvbiByZW1vdmVTY3JpcHQoc2NyaXB0SWQpIHtcblx0ICAgIHZhciBzY3JpcHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzY3JpcHRJZCk7XG5cdCAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImhlYWRcIilbMF0ucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcblx0ICB9XG5cdFxuXHQgIHZhciBmZXRjaEpzb25wID0gZnVuY3Rpb24gZmV0Y2hKc29ucCh1cmwpIHtcblx0ICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07XG5cdFxuXHQgICAgdmFyIHRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQgIT0gbnVsbCA/IG9wdGlvbnMudGltZW91dCA6IGRlZmF1bHRPcHRpb25zLnRpbWVvdXQ7XG5cdCAgICB2YXIganNvbnBDYWxsYmFjayA9IG9wdGlvbnMuanNvbnBDYWxsYmFjayAhPSBudWxsID8gb3B0aW9ucy5qc29ucENhbGxiYWNrIDogZGVmYXVsdE9wdGlvbnMuanNvbnBDYWxsYmFjaztcblx0XG5cdCAgICB2YXIgdGltZW91dElkID0gdW5kZWZpbmVkO1xuXHRcblx0ICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgIHZhciBjYWxsYmFja0Z1bmN0aW9uID0gZ2VuZXJhdGVDYWxsYmFja0Z1bmN0aW9uKCk7XG5cdFxuXHQgICAgICB3aW5kb3dbY2FsbGJhY2tGdW5jdGlvbl0gPSBmdW5jdGlvbiAocmVzcG9uc2UpIHtcblx0ICAgICAgICByZXNvbHZlKHtcblx0ICAgICAgICAgIG9rOiB0cnVlLFxuXHQgICAgICAgICAgLy8ga2VlcCBjb25zaXN0ZW50IHdpdGggZmV0Y2ggQVBJXG5cdCAgICAgICAgICBqc29uOiBmdW5jdGlvbiBqc29uKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3BvbnNlKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgaWYgKHRpbWVvdXRJZCkgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG5cdFxuXHQgICAgICAgIHJlbW92ZVNjcmlwdChqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbik7XG5cdFxuXHQgICAgICAgIGNsZWFyRnVuY3Rpb24oY2FsbGJhY2tGdW5jdGlvbik7XG5cdCAgICAgIH07XG5cdFxuXHQgICAgICAvLyBDaGVjayBpZiB0aGUgdXNlciBzZXQgdGhlaXIgb3duIHBhcmFtcywgYW5kIGlmIG5vdCBhZGQgYSA/IHRvIHN0YXJ0IGEgbGlzdCBvZiBwYXJhbXNcblx0ICAgICAgdXJsICs9IHVybC5pbmRleE9mKCc/JykgPT09IC0xID8gJz8nIDogJyYnO1xuXHRcblx0ICAgICAgdmFyIGpzb25wU2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XG5cdCAgICAgIGpzb25wU2NyaXB0LnNldEF0dHJpYnV0ZShcInNyY1wiLCB1cmwgKyBqc29ucENhbGxiYWNrICsgJz0nICsgY2FsbGJhY2tGdW5jdGlvbik7XG5cdCAgICAgIGpzb25wU2NyaXB0LmlkID0ganNvbnBDYWxsYmFjayArICdfJyArIGNhbGxiYWNrRnVuY3Rpb247XG5cdCAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5hcHBlbmRDaGlsZChqc29ucFNjcmlwdCk7XG5cdFxuXHQgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZWplY3QobmV3IEVycm9yKCdKU09OUCByZXF1ZXN0IHRvICcgKyB1cmwgKyAnIHRpbWVkIG91dCcpKTtcblx0XG5cdCAgICAgICAgY2xlYXJGdW5jdGlvbihjYWxsYmFja0Z1bmN0aW9uKTtcblx0ICAgICAgICByZW1vdmVTY3JpcHQoanNvbnBDYWxsYmFjayArICdfJyArIGNhbGxiYWNrRnVuY3Rpb24pO1xuXHQgICAgICB9LCB0aW1lb3V0KTtcblx0ICAgIH0pO1xuXHQgIH07XG5cdFxuXHQgIC8vIGV4cG9ydCBhcyBnbG9iYWwgZnVuY3Rpb25cblx0ICAvKlxuXHQgIGxldCBsb2NhbDtcblx0ICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgIGxvY2FsID0gZ2xvYmFsO1xuXHQgIH0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG5cdCAgICBsb2NhbCA9IHNlbGY7XG5cdCAgfSBlbHNlIHtcblx0ICAgIHRyeSB7XG5cdCAgICAgIGxvY2FsID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0ICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb2x5ZmlsbCBmYWlsZWQgYmVjYXVzZSBnbG9iYWwgb2JqZWN0IGlzIHVuYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKTtcblx0ICAgIH1cblx0ICB9XG5cdCAgXG5cdCAgbG9jYWwuZmV0Y2hKc29ucCA9IGZldGNoSnNvbnA7XG5cdCAgKi9cblx0XG5cdCAgbW9kdWxlLmV4cG9ydHMgPSBmZXRjaEpzb25wO1xuXHR9KTtcblxuLyoqKi8gfSxcbi8qIDIyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzWydkZWZhdWx0J10gPSBjb25maWdBbmltYXRpb247XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX3BlcmZvcm1hbmNlTm93ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMCk7XG5cdFxuXHR2YXIgX3BlcmZvcm1hbmNlTm93MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BlcmZvcm1hbmNlTm93KTtcblx0XG5cdHZhciBfcmFmID0gX193ZWJwYWNrX3JlcXVpcmVfXygzNCk7XG5cdFxuXHR2YXIgX3JhZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yYWYpO1xuXHRcblx0ZnVuY3Rpb24gY29uZmlnQW5pbWF0aW9uKCkge1xuXHQgIHZhciBjb25maWcgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1swXTtcblx0ICB2YXIgX2NvbmZpZyR0aW1lU3RlcCA9IGNvbmZpZy50aW1lU3RlcDtcblx0ICB2YXIgdGltZVN0ZXAgPSBfY29uZmlnJHRpbWVTdGVwID09PSB1bmRlZmluZWQgPyAxIC8gNjAgKiAxMDAwIDogX2NvbmZpZyR0aW1lU3RlcDtcblx0ICB2YXIgX2NvbmZpZyR0aW1lU2NhbGUgPSBjb25maWcudGltZVNjYWxlO1xuXHQgIHZhciB0aW1lU2NhbGUgPSBfY29uZmlnJHRpbWVTY2FsZSA9PT0gdW5kZWZpbmVkID8gMSA6IF9jb25maWckdGltZVNjYWxlO1xuXHQgIHZhciBfY29uZmlnJG1heFN0ZXBzID0gY29uZmlnLm1heFN0ZXBzO1xuXHQgIHZhciBtYXhTdGVwcyA9IF9jb25maWckbWF4U3RlcHMgPT09IHVuZGVmaW5lZCA/IDEwIDogX2NvbmZpZyRtYXhTdGVwcztcblx0ICB2YXIgX2NvbmZpZyRyYWYgPSBjb25maWcucmFmO1xuXHQgIHZhciByYWYgPSBfY29uZmlnJHJhZiA9PT0gdW5kZWZpbmVkID8gX3JhZjJbJ2RlZmF1bHQnXSA6IF9jb25maWckcmFmO1xuXHQgIHZhciBfY29uZmlnJG5vdyA9IGNvbmZpZy5ub3c7XG5cdCAgdmFyIG5vdyA9IF9jb25maWckbm93ID09PSB1bmRlZmluZWQgPyBfcGVyZm9ybWFuY2VOb3cyWydkZWZhdWx0J10gOiBfY29uZmlnJG5vdztcblx0XG5cdCAgdmFyIGFuaW1SdW5uaW5nID0gW107XG5cdCAgdmFyIHJ1bm5pbmcgPSBmYWxzZTtcblx0ICB2YXIgcHJldlRpbWUgPSAwO1xuXHQgIHZhciBhY2N1bXVsYXRlZFRpbWUgPSAwO1xuXHRcblx0ICBmdW5jdGlvbiBsb29wKCkge1xuXHQgICAgdmFyIGN1cnJlbnRUaW1lID0gbm93KCk7XG5cdCAgICB2YXIgZnJhbWVUaW1lID0gY3VycmVudFRpbWUgLSBwcmV2VGltZTsgLy8gZGVsdGFcblx0XG5cdCAgICBwcmV2VGltZSA9IGN1cnJlbnRUaW1lO1xuXHQgICAgYWNjdW11bGF0ZWRUaW1lICs9IGZyYW1lVGltZSAqIHRpbWVTY2FsZTtcblx0XG5cdCAgICBpZiAoYWNjdW11bGF0ZWRUaW1lID4gdGltZVN0ZXAgKiBtYXhTdGVwcykge1xuXHQgICAgICBhY2N1bXVsYXRlZFRpbWUgPSAwO1xuXHQgICAgfVxuXHRcblx0ICAgIHZhciBmcmFtZU51bWJlciA9IE1hdGguY2VpbChhY2N1bXVsYXRlZFRpbWUgLyB0aW1lU3RlcCk7XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1SdW5uaW5nLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIHZhciBfYW5pbVJ1bm5pbmckaSA9IGFuaW1SdW5uaW5nW2ldO1xuXHQgICAgICB2YXIgYWN0aXZlID0gX2FuaW1SdW5uaW5nJGkuYWN0aXZlO1xuXHQgICAgICB2YXIgYW5pbWF0aW9uU3RlcCA9IF9hbmltUnVubmluZyRpLmFuaW1hdGlvblN0ZXA7XG5cdCAgICAgIHZhciBwcmV2UHJldlN0YXRlID0gX2FuaW1SdW5uaW5nJGkucHJldlN0YXRlO1xuXHQgICAgICB2YXIgcHJldk5leHRTdGF0ZSA9IGFuaW1SdW5uaW5nW2ldLm5leHRTdGF0ZTtcblx0XG5cdCAgICAgIGlmICghYWN0aXZlKSB7XG5cdCAgICAgICAgY29udGludWU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIC8vIFNlZW1zIGxpa2UgYmVjYXVzZSB0aGUgVFMgc2V0cyBkZXN0VmFscyBhcyBlbnRlclZhbHMgZm9yIHRoZSBmaXJzdFxuXHQgICAgICAvLyB0aWNrLCB3ZSBtaWdodCByZW5kZXIgdGhhdCB2YWx1ZSB0d2ljZS4gV2UgcmVuZGVyIGl0IG9uY2UsIGN1cnJWYWx1ZSBpc1xuXHQgICAgICAvLyBlbnRlclZhbCBhbmQgZGVzdFZhbCBpcyBlbnRlclZhbC4gVGhlIG5leHQgdGljayBpcyBmYXN0ZXIgdGhhbiAxNm1zLFxuXHQgICAgICAvLyBzbyBhY2N1bXVsYXRlZFRpbWUgKHdoaWNoIHdvdWxkIGJlIGFib3V0IC0xNm1zIGZyb20gdGhlIHByZXZpb3VzIHRpY2spXG5cdCAgICAgIC8vIGlzIG5lZ2F0aXZlICgtMTZtcyArIGFueSBudW1iZXIgbGVzcyB0aGFuIDE2bXMgPCAwKS4gU28gd2UganVzdCByZW5kZXJcblx0ICAgICAgLy8gcGFydCB3YXlzIHRvd2FyZHMgdGhlIG5leHRTdGF0ZSwgYnV0IHRoYXQncyBlbnRlclZhbCBzdGlsbC4gV2UgcmVuZGVyXG5cdCAgICAgIC8vIHNheSA3NSUgYmV0d2VlbiBjdXJyVmFsdWUgKD09PSBlbnRlclZhbCkgYW5kIGRlc3RWYWx1ZSAoPT09IGVudGVyVmFsKS5cblx0ICAgICAgLy8gU28gd2UgcmVuZGVyIHRoZSBzYW1lIHZhbHVlIGEgc2Vjb25kIHRpbWUuXG5cdCAgICAgIC8vIFRoZSBzb2x1dGlvbiBiZWxvdyBpcyB0byByZWNhbGN1bGF0ZSB0aGUgZGVzdGluYXRpb24gc3RhdGUgZXZlbiB3aGVuXG5cdCAgICAgIC8vIHlvdSdyZSBtb3ZpbmcgcGFydGlhbGx5IHRvd2FyZHMgaXQuXG5cdCAgICAgIGlmIChhY2N1bXVsYXRlZFRpbWUgPD0gMCkge1xuXHQgICAgICAgIGFuaW1SdW5uaW5nW2ldLm5leHRTdGF0ZSA9IGFuaW1hdGlvblN0ZXAodGltZVN0ZXAgLyAxMDAwLCBwcmV2UHJldlN0YXRlKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZyYW1lTnVtYmVyOyBqKyspIHtcblx0ICAgICAgICAgIGFuaW1SdW5uaW5nW2ldLm5leHRTdGF0ZSA9IGFuaW1hdGlvblN0ZXAodGltZVN0ZXAgLyAxMDAwLCBwcmV2TmV4dFN0YXRlKTtcblx0ICAgICAgICAgIHZhciBfcmVmID0gW3ByZXZOZXh0U3RhdGUsIGFuaW1SdW5uaW5nW2ldLm5leHRTdGF0ZV07XG5cdCAgICAgICAgICBhbmltUnVubmluZ1tpXS5wcmV2U3RhdGUgPSBfcmVmWzBdO1xuXHQgICAgICAgICAgcHJldk5leHRTdGF0ZSA9IF9yZWZbMV07XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgYWNjdW11bGF0ZWRUaW1lID0gYWNjdW11bGF0ZWRUaW1lIC0gZnJhbWVOdW1iZXIgKiB0aW1lU3RlcDtcblx0XG5cdCAgICAvLyBSZW5kZXIgYW5kIGZpbHRlciBpbiBvbmUgaXRlcmF0aW9uLlxuXHQgICAgdmFyIGFscGhhID0gMSArIGFjY3VtdWxhdGVkVGltZSAvIHRpbWVTdGVwO1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbmltUnVubmluZy5sZW5ndGg7IGkrKykge1xuXHQgICAgICB2YXIgX2FuaW1SdW5uaW5nJGkyID0gYW5pbVJ1bm5pbmdbaV07XG5cdCAgICAgIHZhciBhbmltYXRpb25SZW5kZXIgPSBfYW5pbVJ1bm5pbmckaTIuYW5pbWF0aW9uUmVuZGVyO1xuXHQgICAgICB2YXIgbmV4dFN0YXRlID0gX2FuaW1SdW5uaW5nJGkyLm5leHRTdGF0ZTtcblx0ICAgICAgdmFyIHByZXZTdGF0ZSA9IF9hbmltUnVubmluZyRpMi5wcmV2U3RhdGU7XG5cdFxuXHQgICAgICAvLyBNaWdodCBtdXRhdGUgYW5pbVJ1bm5pbmcuLi4uLi4uLlxuXHQgICAgICBhbmltYXRpb25SZW5kZXIoYWxwaGEsIG5leHRTdGF0ZSwgcHJldlN0YXRlKTtcblx0ICAgIH1cblx0XG5cdCAgICBhbmltUnVubmluZyA9IGFuaW1SdW5uaW5nLmZpbHRlcihmdW5jdGlvbiAoX3JlZjIpIHtcblx0ICAgICAgdmFyIGFjdGl2ZSA9IF9yZWYyLmFjdGl2ZTtcblx0ICAgICAgcmV0dXJuIGFjdGl2ZTtcblx0ICAgIH0pO1xuXHRcblx0ICAgIGlmIChhbmltUnVubmluZy5sZW5ndGggPT09IDApIHtcblx0ICAgICAgcnVubmluZyA9IGZhbHNlO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgcmFmKGxvb3ApO1xuXHQgICAgfVxuXHQgIH1cblx0XG5cdCAgZnVuY3Rpb24gc3RhcnQoKSB7XG5cdCAgICBpZiAoIXJ1bm5pbmcpIHtcblx0ICAgICAgcnVubmluZyA9IHRydWU7XG5cdCAgICAgIHByZXZUaW1lID0gbm93KCk7XG5cdCAgICAgIGFjY3VtdWxhdGVkVGltZSA9IDA7XG5cdCAgICAgIHJhZihsb29wKTtcblx0ICAgIH1cblx0ICB9XG5cdFxuXHQgIHJldHVybiBmdW5jdGlvbiBzdGFydEFuaW1hdGlvbihzdGF0ZSwgYW5pbWF0aW9uU3RlcCwgYW5pbWF0aW9uUmVuZGVyKSB7XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1SdW5uaW5nLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIHZhciB2YWwgPSBhbmltUnVubmluZ1tpXTtcblx0ICAgICAgaWYgKHZhbC5hbmltYXRpb25TdGVwID09PSBhbmltYXRpb25TdGVwKSB7XG5cdCAgICAgICAgdmFsLmFjdGl2ZSA9IHRydWU7XG5cdCAgICAgICAgdmFsLnByZXZTdGF0ZSA9IHN0YXRlO1xuXHQgICAgICAgIHN0YXJ0KCk7XG5cdCAgICAgICAgcmV0dXJuIHZhbC5zdG9wO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIG5ld0FuaW0gPSB7XG5cdCAgICAgIGFuaW1hdGlvblN0ZXA6IGFuaW1hdGlvblN0ZXAsXG5cdCAgICAgIGFuaW1hdGlvblJlbmRlcjogYW5pbWF0aW9uUmVuZGVyLFxuXHQgICAgICBwcmV2U3RhdGU6IHN0YXRlLFxuXHQgICAgICBuZXh0U3RhdGU6IHN0YXRlLFxuXHQgICAgICBhY3RpdmU6IHRydWVcblx0ICAgIH07XG5cdFxuXHQgICAgbmV3QW5pbS5zdG9wID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gbmV3QW5pbS5hY3RpdmUgPSBmYWxzZTtcblx0ICAgIH07XG5cdCAgICBhbmltUnVubmluZy5wdXNoKG5ld0FuaW0pO1xuXHRcblx0ICAgIHN0YXJ0KCk7XG5cdFxuXHQgICAgcmV0dXJuIG5ld0FuaW0uc3RvcDtcblx0ICB9O1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDIzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRcblx0dmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblx0XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IGNvbXBvbmVudHM7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX25vVmVsb2NpdHkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI3KTtcblx0XG5cdHZhciBfbm9WZWxvY2l0eTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ub1ZlbG9jaXR5KTtcblx0XG5cdHZhciBfaGFzUmVhY2hlZFN0eWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXygyNSk7XG5cdFxuXHR2YXIgX2hhc1JlYWNoZWRTdHlsZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNSZWFjaGVkU3R5bGUpO1xuXHRcblx0dmFyIF9tZXJnZURpZmYgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDI2KTtcblx0XG5cdHZhciBfbWVyZ2VEaWZmMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lcmdlRGlmZik7XG5cdFxuXHR2YXIgX2FuaW1hdGlvbkxvb3AgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIyKTtcblx0XG5cdHZhciBfYW5pbWF0aW9uTG9vcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hbmltYXRpb25Mb29wKTtcblx0XG5cdHZhciBfemVybyA9IF9fd2VicGFja19yZXF1aXJlX18oMzMpO1xuXHRcblx0dmFyIF96ZXJvMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3plcm8pO1xuXHRcblx0dmFyIF91cGRhdGVUcmVlID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMik7XG5cdFxuXHR2YXIgX2RlcHJlY2F0ZWRTcHJpbmdzMiA9IF9fd2VicGFja19yZXF1aXJlX18oMjQpO1xuXHRcblx0dmFyIF9kZXByZWNhdGVkU3ByaW5nczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZXByZWNhdGVkU3ByaW5nczIpO1xuXHRcblx0dmFyIF9zdHJpcFN0eWxlID0gX193ZWJwYWNrX3JlcXVpcmVfXygzMSk7XG5cdFxuXHR2YXIgX3N0cmlwU3R5bGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RyaXBTdHlsZSk7XG5cdFxuXHR2YXIgc3RhcnRBbmltYXRpb24gPSBfYW5pbWF0aW9uTG9vcDJbJ2RlZmF1bHQnXSgpO1xuXHRcblx0ZnVuY3Rpb24gbWFwT2JqZWN0KGYsIG9iaikge1xuXHQgIHZhciByZXQgPSB7fTtcblx0ICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdCAgICBpZiAoIW9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgcmV0W2tleV0gPSBmKG9ialtrZXldLCBrZXkpO1xuXHQgIH1cblx0ICByZXR1cm4gcmV0O1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBldmVyeU9iaihmLCBvYmopIHtcblx0ICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG5cdCAgICBpZiAoIW9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgaWYgKCFmKG9ialtrZXldLCBrZXkpKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0ICB9XG5cdCAgcmV0dXJuIHRydWU7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGNvbXBvbmVudHMoUmVhY3QpIHtcblx0ICB2YXIgUHJvcFR5cGVzID0gUmVhY3QuUHJvcFR5cGVzO1xuXHRcblx0ICB2YXIgTW90aW9uID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXHQgICAgZGlzcGxheU5hbWU6ICdNb3Rpb24nLFxuXHRcblx0ICAgIHByb3BUeXBlczoge1xuXHQgICAgICAvLyBUT09EOiB3YXJuIGFnYWluc3QgcHV0dGluZyBhIGNvbmZpZyBpbiBoZXJlXG5cdCAgICAgIGRlZmF1bHRWYWx1ZTogZnVuY3Rpb24gZGVmYXVsdFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG5cdCAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdTcHJpbmdcXCdzIGBkZWZhdWx0VmFsdWVgIGhhcyBiZWVuIGNoYW5nZWQgdG8gYGRlZmF1bHRTdHlsZWAuICcgKyAnSXRzIGZvcm1hdCByZWNlaXZlZCBhIGZldyAoZWFzeSB0byB1cGRhdGUhKSBjaGFuZ2VzIGFzIHdlbGwuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBlbmRWYWx1ZTogZnVuY3Rpb24gZW5kVmFsdWUocHJvcCwgcHJvcE5hbWUpIHtcblx0ICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcblx0ICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1NwcmluZ1xcJ3MgYGVuZFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBzdHlsZWAuIEl0cyBmb3JtYXQgJyArICdyZWNlaXZlZCBhIGZldyAoZWFzeSB0byB1cGRhdGUhKSBjaGFuZ2VzIGFzIHdlbGwuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICBkZWZhdWx0U3R5bGU6IFByb3BUeXBlcy5vYmplY3QsXG5cdCAgICAgIHN0eWxlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG5cdCAgICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG5cdCAgICB9LFxuXHRcblx0ICAgIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24gZ2V0SW5pdGlhbFN0YXRlKCkge1xuXHQgICAgICB2YXIgX3Byb3BzID0gdGhpcy5wcm9wcztcblx0ICAgICAgdmFyIGRlZmF1bHRTdHlsZSA9IF9wcm9wcy5kZWZhdWx0U3R5bGU7XG5cdCAgICAgIHZhciBzdHlsZSA9IF9wcm9wcy5zdHlsZTtcblx0XG5cdCAgICAgIHZhciBjdXJyZW50U3R5bGUgPSBkZWZhdWx0U3R5bGUgfHwgc3R5bGU7XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgY3VycmVudFN0eWxlOiBjdXJyZW50U3R5bGUsXG5cdCAgICAgICAgY3VycmVudFZlbG9jaXR5OiBtYXBPYmplY3QoX3plcm8yWydkZWZhdWx0J10sIGN1cnJlbnRTdHlsZSlcblx0ICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgY29tcG9uZW50RGlkTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuXHQgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKSB7XG5cdCAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgYW5pbWF0aW9uU3RlcDogZnVuY3Rpb24gYW5pbWF0aW9uU3RlcCh0aW1lc3RlcCwgc3RhdGUpIHtcblx0ICAgICAgdmFyIGN1cnJlbnRTdHlsZSA9IHN0YXRlLmN1cnJlbnRTdHlsZTtcblx0ICAgICAgdmFyIGN1cnJlbnRWZWxvY2l0eSA9IHN0YXRlLmN1cnJlbnRWZWxvY2l0eTtcblx0ICAgICAgdmFyIHN0eWxlID0gdGhpcy5wcm9wcy5zdHlsZTtcblx0XG5cdCAgICAgIHZhciBuZXdDdXJyZW50U3R5bGUgPSBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50U3R5bGUodGltZXN0ZXAsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXR5LCBzdHlsZSk7XG5cdCAgICAgIHZhciBuZXdDdXJyZW50VmVsb2NpdHkgPSBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50VmVsb2NpdHkodGltZXN0ZXAsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXR5LCBzdHlsZSk7XG5cdFxuXHQgICAgICAvLyBUT09EOiB0aGlzIGlzbid0IG5lY2Vzc2FyeSBhbnltb3JlLiBJdCB3YXMgdXNlZCBvbmx5IGFnYWluc3QgZW5kVmFsdWUgZnVuY1xuXHQgICAgICBpZiAoX25vVmVsb2NpdHkyWydkZWZhdWx0J10oY3VycmVudFZlbG9jaXR5LCBuZXdDdXJyZW50U3R5bGUpICYmIF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKG5ld0N1cnJlbnRWZWxvY2l0eSwgbmV3Q3VycmVudFN0eWxlKSkge1xuXHQgICAgICAgIC8vIGNoZWNrIGV4cGxhbmF0aW9uIGluIGBNb3Rpb24uYW5pbWF0aW9uUmVuZGVyYFxuXHQgICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpOyAvLyBOYXN0eSBzaWRlIGVmZmVjdHMuLi4uXG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgY3VycmVudFN0eWxlOiBuZXdDdXJyZW50U3R5bGUsXG5cdCAgICAgICAgY3VycmVudFZlbG9jaXR5OiBuZXdDdXJyZW50VmVsb2NpdHlcblx0ICAgICAgfTtcblx0ICAgIH0sXG5cdFxuXHQgICAgc3RvcEFuaW1hdGlvbjogbnVsbCxcblx0XG5cdCAgICAvLyB1c2VkIGluIGFuaW1hdGlvblJlbmRlclxuXHQgICAgaGFzVW5tb3VudGVkOiBmYWxzZSxcblx0XG5cdCAgICBjb21wb25lbnRXaWxsVW5tb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG5cdCAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuXHQgICAgICB0aGlzLmhhc1VubW91bnRlZCA9IHRydWU7XG5cdCAgICB9LFxuXHRcblx0ICAgIHN0YXJ0QW5pbWF0aW5nOiBmdW5jdGlvbiBzdGFydEFuaW1hdGluZygpIHtcblx0ICAgICAgLy8gSXMgc21hcnQgZW5vdWdoIHRvIG5vdCBzdGFydCBpdCB0d2ljZVxuXHQgICAgICB0aGlzLnN0b3BBbmltYXRpb24gPSBzdGFydEFuaW1hdGlvbih0aGlzLnN0YXRlLCB0aGlzLmFuaW1hdGlvblN0ZXAsIHRoaXMuYW5pbWF0aW9uUmVuZGVyKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgYW5pbWF0aW9uUmVuZGVyOiBmdW5jdGlvbiBhbmltYXRpb25SZW5kZXIoYWxwaGEsIG5leHRTdGF0ZSwgcHJldlN0YXRlKSB7XG5cdCAgICAgIC8vIGB0aGlzLmhhc1VubW91bnRlZGAgbWlnaHQgYmUgdHJ1ZSBpbiB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbjpcblx0ICAgICAgLy8gdXNlciBkb2VzIHNvbWUgY2hlY2tzIGluIGBzdHlsZWAgYW5kIGNhbGxzIGFuIG93bmVyIGhhbmRsZXJcblx0ICAgICAgLy8gb3duZXIgc2V0cyBzdGF0ZSBpbiB0aGUgY2FsbGJhY2ssIHRyaWdnZXJpbmcgYSByZS1yZW5kZXJcblx0ICAgICAgLy8gdW5tb3VudHMgTW90aW9uXG5cdCAgICAgIGlmICghdGhpcy5oYXNVbm1vdW50ZWQpIHtcblx0ICAgICAgICB0aGlzLnNldFN0YXRlKHtcblx0ICAgICAgICAgIGN1cnJlbnRTdHlsZTogX3VwZGF0ZVRyZWUuaW50ZXJwb2xhdGVWYWx1ZShhbHBoYSwgbmV4dFN0YXRlLmN1cnJlbnRTdHlsZSwgcHJldlN0YXRlLmN1cnJlbnRTdHlsZSksXG5cdCAgICAgICAgICBjdXJyZW50VmVsb2NpdHk6IG5leHRTdGF0ZS5jdXJyZW50VmVsb2NpdHlcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSBfc3RyaXBTdHlsZTJbJ2RlZmF1bHQnXSh0aGlzLnN0YXRlLmN1cnJlbnRTdHlsZSk7XG5cdCAgICAgIHZhciByZW5kZXJlZENoaWxkcmVuID0gdGhpcy5wcm9wcy5jaGlsZHJlbihzdHJpcHBlZFN0eWxlKTtcblx0ICAgICAgcmV0dXJuIHJlbmRlcmVkQ2hpbGRyZW4gJiYgUmVhY3QuQ2hpbGRyZW4ub25seShyZW5kZXJlZENoaWxkcmVuKTtcblx0ICAgIH1cblx0ICB9KTtcblx0XG5cdCAgdmFyIFN0YWdnZXJlZE1vdGlvbiA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0ICAgIGRpc3BsYXlOYW1lOiAnU3RhZ2dlcmVkTW90aW9uJyxcblx0XG5cdCAgICBwcm9wVHlwZXM6IHtcblx0ICAgICAgZGVmYXVsdFN0eWxlOiBmdW5jdGlvbiBkZWZhdWx0U3R5bGUocHJvcCwgcHJvcE5hbWUpIHtcblx0ICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcblx0ICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgU3RhZ2dlcmVkTW90aW9uYFxcJ3MgYGRlZmF1bHRTdHlsZXNgLicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgc3R5bGU6IGZ1bmN0aW9uIHN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG5cdCAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG5cdCAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdZb3UgZm9yZ290IHRoZSBcInNcIiBmb3IgYFN0YWdnZXJlZE1vdGlvbmBcXCdzIGBzdHlsZXNgLicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgLy8gVE9PRDogd2FybiBhZ2FpbnN0IHB1dHRpbmcgY29uZmlncyBpbiBoZXJlXG5cdCAgICAgIGRlZmF1bHRTdHlsZXM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5vYmplY3QpLFxuXHQgICAgICBzdHlsZXM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG5cdCAgICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG5cdCAgICB9LFxuXHRcblx0ICAgIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24gZ2V0SW5pdGlhbFN0YXRlKCkge1xuXHQgICAgICB2YXIgX3Byb3BzMiA9IHRoaXMucHJvcHM7XG5cdCAgICAgIHZhciBzdHlsZXMgPSBfcHJvcHMyLnN0eWxlcztcblx0ICAgICAgdmFyIGRlZmF1bHRTdHlsZXMgPSBfcHJvcHMyLmRlZmF1bHRTdHlsZXM7XG5cdFxuXHQgICAgICB2YXIgY3VycmVudFN0eWxlcyA9IGRlZmF1bHRTdHlsZXMgPyBkZWZhdWx0U3R5bGVzIDogc3R5bGVzKCk7XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgY3VycmVudFN0eWxlczogY3VycmVudFN0eWxlcyxcblx0ICAgICAgICBjdXJyZW50VmVsb2NpdGllczogY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKHMpIHtcblx0ICAgICAgICAgIHJldHVybiBtYXBPYmplY3QoX3plcm8yWydkZWZhdWx0J10sIHMpO1xuXHQgICAgICAgIH0pXG5cdCAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcblx0ICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuXHQgICAgfSxcblx0XG5cdCAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzOiBmdW5jdGlvbiBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKCkge1xuXHQgICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG5cdCAgICB9LFxuXHRcblx0ICAgIGFuaW1hdGlvblN0ZXA6IGZ1bmN0aW9uIGFuaW1hdGlvblN0ZXAodGltZXN0ZXAsIHN0YXRlKSB7XG5cdCAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gc3RhdGUuY3VycmVudFN0eWxlcztcblx0ICAgICAgdmFyIGN1cnJlbnRWZWxvY2l0aWVzID0gc3RhdGUuY3VycmVudFZlbG9jaXRpZXM7XG5cdFxuXHQgICAgICB2YXIgc3R5bGVzID0gdGhpcy5wcm9wcy5zdHlsZXMoY3VycmVudFN0eWxlcy5tYXAoX3N0cmlwU3R5bGUyWydkZWZhdWx0J10pKTtcblx0XG5cdCAgICAgIHZhciBuZXdDdXJyZW50U3R5bGVzID0gY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKGN1cnJlbnRTdHlsZSwgaSkge1xuXHQgICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50U3R5bGUodGltZXN0ZXAsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXRpZXNbaV0sIHN0eWxlc1tpXSk7XG5cdCAgICAgIH0pO1xuXHQgICAgICB2YXIgbmV3Q3VycmVudFZlbG9jaXRpZXMgPSBjdXJyZW50U3R5bGVzLm1hcChmdW5jdGlvbiAoY3VycmVudFN0eWxlLCBpKSB7XG5cdCAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRWZWxvY2l0eSh0aW1lc3RlcCwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdGllc1tpXSwgc3R5bGVzW2ldKTtcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICAvLyBUT0RPOiBpcyB0aGlzIHJpZ2h0P1xuXHQgICAgICBpZiAoY3VycmVudFZlbG9jaXRpZXMuZXZlcnkoZnVuY3Rpb24gKHYsIGspIHtcblx0ICAgICAgICByZXR1cm4gX25vVmVsb2NpdHkyWydkZWZhdWx0J10odiwgY3VycmVudFN0eWxlc1trXSk7XG5cdCAgICAgIH0pICYmIG5ld0N1cnJlbnRWZWxvY2l0aWVzLmV2ZXJ5KGZ1bmN0aW9uICh2LCBrKSB7XG5cdCAgICAgICAgcmV0dXJuIF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKHYsIG5ld0N1cnJlbnRTdHlsZXNba10pO1xuXHQgICAgICB9KSkge1xuXHQgICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIGN1cnJlbnRTdHlsZXM6IG5ld0N1cnJlbnRTdHlsZXMsXG5cdCAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5ld0N1cnJlbnRWZWxvY2l0aWVzXG5cdCAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIHN0b3BBbmltYXRpb246IG51bGwsXG5cdFxuXHQgICAgLy8gdXNlZCBpbiBhbmltYXRpb25SZW5kZXJcblx0ICAgIGhhc1VubW91bnRlZDogZmFsc2UsXG5cdFxuXHQgICAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuXHQgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcblx0ICAgICAgdGhpcy5oYXNVbm1vdW50ZWQgPSB0cnVlO1xuXHQgICAgfSxcblx0XG5cdCAgICBzdGFydEFuaW1hdGluZzogZnVuY3Rpb24gc3RhcnRBbmltYXRpbmcoKSB7XG5cdCAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbiA9IHN0YXJ0QW5pbWF0aW9uKHRoaXMuc3RhdGUsIHRoaXMuYW5pbWF0aW9uU3RlcCwgdGhpcy5hbmltYXRpb25SZW5kZXIpO1xuXHQgICAgfSxcblx0XG5cdCAgICBhbmltYXRpb25SZW5kZXI6IGZ1bmN0aW9uIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpIHtcblx0ICAgICAgLy8gU2VlIGNvbW1lbnQgaW4gTW90aW9uLlxuXHQgICAgICBpZiAoIXRoaXMuaGFzVW5tb3VudGVkKSB7XG5cdCAgICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBuZXh0U3RhdGUuY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKHN0eWxlLCBpKSB7XG5cdCAgICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUuaW50ZXJwb2xhdGVWYWx1ZShhbHBoYSwgc3R5bGUsIHByZXZTdGF0ZS5jdXJyZW50U3R5bGVzW2ldKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgICB0aGlzLnNldFN0YXRlKHtcblx0ICAgICAgICAgIGN1cnJlbnRTdHlsZXM6IGN1cnJlbnRTdHlsZXMsXG5cdCAgICAgICAgICBjdXJyZW50VmVsb2NpdGllczogbmV4dFN0YXRlLmN1cnJlbnRWZWxvY2l0aWVzXG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdFxuXHQgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICAgIHZhciBzdHJpcHBlZFN0eWxlID0gdGhpcy5zdGF0ZS5jdXJyZW50U3R5bGVzLm1hcChfc3RyaXBTdHlsZTJbJ2RlZmF1bHQnXSk7XG5cdCAgICAgIHZhciByZW5kZXJlZENoaWxkcmVuID0gdGhpcy5wcm9wcy5jaGlsZHJlbihzdHJpcHBlZFN0eWxlKTtcblx0ICAgICAgcmV0dXJuIHJlbmRlcmVkQ2hpbGRyZW4gJiYgUmVhY3QuQ2hpbGRyZW4ub25seShyZW5kZXJlZENoaWxkcmVuKTtcblx0ICAgIH1cblx0ICB9KTtcblx0XG5cdCAgdmFyIFRyYW5zaXRpb25Nb3Rpb24gPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgICBkaXNwbGF5TmFtZTogJ1RyYW5zaXRpb25Nb3Rpb24nLFxuXHRcblx0ICAgIHByb3BUeXBlczoge1xuXHQgICAgICBkZWZhdWx0VmFsdWU6IGZ1bmN0aW9uIGRlZmF1bHRWYWx1ZShwcm9wLCBwcm9wTmFtZSkge1xuXHQgICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignVHJhbnNpdGlvblNwcmluZ1xcJ3MgYGRlZmF1bHRWYWx1ZWAgaGFzIGJlZW4gY2hhbmdlZCB0byAnICsgJ2BkZWZhdWx0U3R5bGVzYC4gSXRzIGZvcm1hdCByZWNlaXZlZCBhIGZldyAoZWFzeSB0byB1cGRhdGUhKSAnICsgJ2NoYW5nZXMgYXMgd2VsbC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIGVuZFZhbHVlOiBmdW5jdGlvbiBlbmRWYWx1ZShwcm9wLCBwcm9wTmFtZSkge1xuXHQgICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignVHJhbnNpdGlvblNwcmluZ1xcJ3MgYGVuZFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBzdHlsZXNgLiAnICsgJ0l0cyBmb3JtYXQgcmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgY2hhbmdlcyBhcyB3ZWxsLicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSxcblx0ICAgICAgZGVmYXVsdFN0eWxlOiBmdW5jdGlvbiBkZWZhdWx0U3R5bGUocHJvcCwgcHJvcE5hbWUpIHtcblx0ICAgICAgICBpZiAocHJvcFtwcm9wTmFtZV0pIHtcblx0ICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgVHJhbnNpdGlvbk1vdGlvbmBcXCdzIGBkZWZhdWx0U3R5bGVzYC4nKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sXG5cdCAgICAgIHN0eWxlOiBmdW5jdGlvbiBzdHlsZShwcm9wLCBwcm9wTmFtZSkge1xuXHQgICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuXHQgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignWW91IGZvcmdvdCB0aGUgXCJzXCIgZm9yIGBUcmFuc2l0aW9uTW90aW9uYFxcJ3MgYHN0eWxlc2AuJyk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LFxuXHQgICAgICAvLyBUT09EOiB3YXJuIGFnYWluc3QgcHV0dGluZyBjb25maWdzIGluIGhlcmVcblx0ICAgICAgZGVmYXVsdFN0eWxlczogUHJvcFR5cGVzLm9iamVjdE9mKFByb3BUeXBlcy5hbnkpLFxuXHQgICAgICBzdHlsZXM6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5mdW5jLCBQcm9wVHlwZXMub2JqZWN0T2YoUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkKV0pLmlzUmVxdWlyZWQsXG5cdCAgICAgIHdpbGxMZWF2ZTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmZ1bmNdKSxcblx0ICAgICAgLy8gVE9PRDogd2FybiBhZ2FpbnN0IHB1dHRpbmcgY29uZmlncyBpbiBoZXJlXG5cdCAgICAgIHdpbGxFbnRlcjogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmZ1bmNdKSxcblx0ICAgICAgY2hpbGRyZW46IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWRcblx0ICAgIH0sXG5cdFxuXHQgICAgZ2V0RGVmYXVsdFByb3BzOiBmdW5jdGlvbiBnZXREZWZhdWx0UHJvcHMoKSB7XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgd2lsbEVudGVyOiBmdW5jdGlvbiB3aWxsRW50ZXIoa2V5LCB2YWx1ZSkge1xuXHQgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgd2lsbExlYXZlOiBmdW5jdGlvbiB3aWxsTGVhdmUoKSB7XG5cdCAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24gZ2V0SW5pdGlhbFN0YXRlKCkge1xuXHQgICAgICB2YXIgX3Byb3BzMyA9IHRoaXMucHJvcHM7XG5cdCAgICAgIHZhciBzdHlsZXMgPSBfcHJvcHMzLnN0eWxlcztcblx0ICAgICAgdmFyIGRlZmF1bHRTdHlsZXMgPSBfcHJvcHMzLmRlZmF1bHRTdHlsZXM7XG5cdFxuXHQgICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHVuZGVmaW5lZDtcblx0ICAgICAgaWYgKGRlZmF1bHRTdHlsZXMgPT0gbnVsbCkge1xuXHQgICAgICAgIGlmICh0eXBlb2Ygc3R5bGVzID09PSAnZnVuY3Rpb24nKSB7XG5cdCAgICAgICAgICBjdXJyZW50U3R5bGVzID0gc3R5bGVzKCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGN1cnJlbnRTdHlsZXMgPSBzdHlsZXM7XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGN1cnJlbnRTdHlsZXMgPSBkZWZhdWx0U3R5bGVzO1xuXHQgICAgICB9XG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgY3VycmVudFN0eWxlczogY3VycmVudFN0eWxlcyxcblx0ICAgICAgICBjdXJyZW50VmVsb2NpdGllczogbWFwT2JqZWN0KGZ1bmN0aW9uIChzKSB7XG5cdCAgICAgICAgICByZXR1cm4gbWFwT2JqZWN0KF96ZXJvMlsnZGVmYXVsdCddLCBzKTtcblx0ICAgICAgICB9LCBjdXJyZW50U3R5bGVzKVxuXHQgICAgICB9O1xuXHQgICAgfSxcblx0XG5cdCAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG5cdCAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcblx0ICAgIH0sXG5cdFxuXHQgICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcygpIHtcblx0ICAgICAgdGhpcy5zdGFydEFuaW1hdGluZygpO1xuXHQgICAgfSxcblx0XG5cdCAgICBhbmltYXRpb25TdGVwOiBmdW5jdGlvbiBhbmltYXRpb25TdGVwKHRpbWVzdGVwLCBzdGF0ZSkge1xuXHQgICAgICB2YXIgY3VycmVudFN0eWxlcyA9IHN0YXRlLmN1cnJlbnRTdHlsZXM7XG5cdCAgICAgIHZhciBjdXJyZW50VmVsb2NpdGllcyA9IHN0YXRlLmN1cnJlbnRWZWxvY2l0aWVzO1xuXHQgICAgICB2YXIgX3Byb3BzNCA9IHRoaXMucHJvcHM7XG5cdCAgICAgIHZhciBzdHlsZXMgPSBfcHJvcHM0LnN0eWxlcztcblx0ICAgICAgdmFyIHdpbGxFbnRlciA9IF9wcm9wczQud2lsbEVudGVyO1xuXHQgICAgICB2YXIgd2lsbExlYXZlID0gX3Byb3BzNC53aWxsTGVhdmU7XG5cdFxuXHQgICAgICBpZiAodHlwZW9mIHN0eWxlcyA9PT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgICAgIHN0eWxlcyA9IHN0eWxlcyhjdXJyZW50U3R5bGVzKTtcblx0ICAgICAgfVxuXHRcblx0ICAgICAgLy8gVE9ETzogaHVoP1xuXHQgICAgICB2YXIgbWVyZ2VkU3R5bGVzID0gc3R5bGVzOyAvLyBzZXQgbWVyZ2VkU3R5bGVzIHRvIHN0eWxlcyBhcyB0aGUgZGVmYXVsdFxuXHQgICAgICB2YXIgaGFzTmV3S2V5ID0gZmFsc2U7XG5cdFxuXHQgICAgICBtZXJnZWRTdHlsZXMgPSBfbWVyZ2VEaWZmMlsnZGVmYXVsdCddKGN1cnJlbnRTdHlsZXMsIHN0eWxlcyxcblx0ICAgICAgLy8gVE9ETzogc3RvcCBhbGxvY2F0aW5nIGxpa2UgY3JhenkgaW4gdGhpcyB3aG9sZSBjb2RlIHBhdGhcblx0ICAgICAgZnVuY3Rpb24gKGtleSkge1xuXHQgICAgICAgIHZhciByZXMgPSB3aWxsTGVhdmUoa2V5LCBjdXJyZW50U3R5bGVzW2tleV0sIHN0eWxlcywgY3VycmVudFN0eWxlcywgY3VycmVudFZlbG9jaXRpZXMpO1xuXHQgICAgICAgIGlmIChyZXMgPT0gbnVsbCkge1xuXHQgICAgICAgICAgLy8gRm9yIGxlZ2FjeSByZWFzb24uIFdlIHdvbid0IGFsbG93IHJldHVybmluZyBudWxsIHNvb25cblx0ICAgICAgICAgIC8vIFRPRE86IHJlbW92ZSwgYWZ0ZXIgbmV4dCByZWxlYXNlXG5cdCAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIGlmIChfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXShjdXJyZW50VmVsb2NpdGllc1trZXldLCBjdXJyZW50U3R5bGVzW2tleV0pICYmIF9oYXNSZWFjaGVkU3R5bGUyWydkZWZhdWx0J10oY3VycmVudFN0eWxlc1trZXldLCByZXMpKSB7XG5cdCAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIHJlcztcblx0ICAgICAgfSk7XG5cdFxuXHQgICAgICBPYmplY3Qua2V5cyhtZXJnZWRTdHlsZXMpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG5cdCAgICAgICAgcmV0dXJuICFjdXJyZW50U3R5bGVzLmhhc093blByb3BlcnR5KGtleSk7XG5cdCAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuXHQgICAgICAgIHZhciBfZXh0ZW5kczIsIF9leHRlbmRzMztcblx0XG5cdCAgICAgICAgaGFzTmV3S2V5ID0gdHJ1ZTtcblx0ICAgICAgICB2YXIgZW50ZXJTdHlsZSA9IHdpbGxFbnRlcihrZXksIG1lcmdlZFN0eWxlc1trZXldLCBzdHlsZXMsIGN1cnJlbnRTdHlsZXMsIGN1cnJlbnRWZWxvY2l0aWVzKTtcblx0XG5cdCAgICAgICAgLy8gV2UgY2FuIG11dGF0ZSB0aGlzIGhlcmUgYmVjYXVzZSBtZXJnZURpZmYgcmV0dXJucyBhIG5ldyBPYmpcblx0ICAgICAgICBtZXJnZWRTdHlsZXNba2V5XSA9IGVudGVyU3R5bGU7XG5cdFxuXHQgICAgICAgIGN1cnJlbnRTdHlsZXMgPSBfZXh0ZW5kcyh7fSwgY3VycmVudFN0eWxlcywgKF9leHRlbmRzMiA9IHt9LCBfZXh0ZW5kczJba2V5XSA9IGVudGVyU3R5bGUsIF9leHRlbmRzMikpO1xuXHQgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzID0gX2V4dGVuZHMoe30sIGN1cnJlbnRWZWxvY2l0aWVzLCAoX2V4dGVuZHMzID0ge30sIF9leHRlbmRzM1trZXldID0gbWFwT2JqZWN0KF96ZXJvMlsnZGVmYXVsdCddLCBlbnRlclN0eWxlKSwgX2V4dGVuZHMzKSk7XG5cdCAgICAgIH0pO1xuXHRcblx0ICAgICAgdmFyIG5ld0N1cnJlbnRTdHlsZXMgPSBtYXBPYmplY3QoZnVuY3Rpb24gKG1lcmdlZFN0eWxlLCBrZXkpIHtcblx0ICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFN0eWxlKHRpbWVzdGVwLCBjdXJyZW50U3R5bGVzW2tleV0sIGN1cnJlbnRWZWxvY2l0aWVzW2tleV0sIG1lcmdlZFN0eWxlKTtcblx0ICAgICAgfSwgbWVyZ2VkU3R5bGVzKTtcblx0ICAgICAgdmFyIG5ld0N1cnJlbnRWZWxvY2l0aWVzID0gbWFwT2JqZWN0KGZ1bmN0aW9uIChtZXJnZWRTdHlsZSwga2V5KSB7XG5cdCAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRWZWxvY2l0eSh0aW1lc3RlcCwgY3VycmVudFN0eWxlc1trZXldLCBjdXJyZW50VmVsb2NpdGllc1trZXldLCBtZXJnZWRTdHlsZSk7XG5cdCAgICAgIH0sIG1lcmdlZFN0eWxlcyk7XG5cdFxuXHQgICAgICBpZiAoIWhhc05ld0tleSAmJiBldmVyeU9iaihmdW5jdGlvbiAodiwgaykge1xuXHQgICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBjdXJyZW50U3R5bGVzW2tdKTtcblx0ICAgICAgfSwgY3VycmVudFZlbG9jaXRpZXMpICYmIGV2ZXJ5T2JqKGZ1bmN0aW9uICh2LCBrKSB7XG5cdCAgICAgICAgcmV0dXJuIF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKHYsIG5ld0N1cnJlbnRTdHlsZXNba10pO1xuXHQgICAgICB9LCBuZXdDdXJyZW50VmVsb2NpdGllcykpIHtcblx0ICAgICAgICAvLyBjaGVjayBleHBsYW5hdGlvbiBpbiBgTW90aW9uLmFuaW1hdGlvblJlbmRlcmBcblx0ICAgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTsgLy8gTmFzdHkgc2lkZSBlZmZlY3RzLi4uLlxuXHQgICAgICB9XG5cdFxuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIGN1cnJlbnRTdHlsZXM6IG5ld0N1cnJlbnRTdHlsZXMsXG5cdCAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5ld0N1cnJlbnRWZWxvY2l0aWVzXG5cdCAgICAgIH07XG5cdCAgICB9LFxuXHRcblx0ICAgIHN0b3BBbmltYXRpb246IG51bGwsXG5cdFxuXHQgICAgLy8gdXNlZCBpbiBhbmltYXRpb25SZW5kZXJcblx0ICAgIGhhc1VubW91bnRlZDogZmFsc2UsXG5cdFxuXHQgICAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuXHQgICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcblx0ICAgICAgdGhpcy5oYXNVbm1vdW50ZWQgPSB0cnVlO1xuXHQgICAgfSxcblx0XG5cdCAgICBzdGFydEFuaW1hdGluZzogZnVuY3Rpb24gc3RhcnRBbmltYXRpbmcoKSB7XG5cdCAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbiA9IHN0YXJ0QW5pbWF0aW9uKHRoaXMuc3RhdGUsIHRoaXMuYW5pbWF0aW9uU3RlcCwgdGhpcy5hbmltYXRpb25SZW5kZXIpO1xuXHQgICAgfSxcblx0XG5cdCAgICBhbmltYXRpb25SZW5kZXI6IGZ1bmN0aW9uIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpIHtcblx0ICAgICAgLy8gU2VlIGNvbW1lbnQgaW4gTW90aW9uLlxuXHQgICAgICBpZiAoIXRoaXMuaGFzVW5tb3VudGVkKSB7XG5cdCAgICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBtYXBPYmplY3QoZnVuY3Rpb24gKHN0eWxlLCBrZXkpIHtcblx0ICAgICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS5pbnRlcnBvbGF0ZVZhbHVlKGFscGhhLCBzdHlsZSwgcHJldlN0YXRlLmN1cnJlbnRTdHlsZXNba2V5XSk7XG5cdCAgICAgICAgfSwgbmV4dFN0YXRlLmN1cnJlbnRTdHlsZXMpO1xuXHQgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuXHQgICAgICAgICAgY3VycmVudFN0eWxlczogY3VycmVudFN0eWxlcyxcblx0ICAgICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBuZXh0U3RhdGUuY3VycmVudFZlbG9jaXRpZXNcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgdmFyIHN0cmlwcGVkU3R5bGUgPSBtYXBPYmplY3QoX3N0cmlwU3R5bGUyWydkZWZhdWx0J10sIHRoaXMuc3RhdGUuY3VycmVudFN0eWxlcyk7XG5cdCAgICAgIHZhciByZW5kZXJlZENoaWxkcmVuID0gdGhpcy5wcm9wcy5jaGlsZHJlbihzdHJpcHBlZFN0eWxlKTtcblx0ICAgICAgcmV0dXJuIHJlbmRlcmVkQ2hpbGRyZW4gJiYgUmVhY3QuQ2hpbGRyZW4ub25seShyZW5kZXJlZENoaWxkcmVuKTtcblx0ICAgIH1cblx0ICB9KTtcblx0XG5cdCAgdmFyIF9kZXByZWNhdGVkU3ByaW5ncyA9IF9kZXByZWNhdGVkU3ByaW5nczNbJ2RlZmF1bHQnXShSZWFjdCk7XG5cdFxuXHQgIHZhciBTcHJpbmcgPSBfZGVwcmVjYXRlZFNwcmluZ3MuU3ByaW5nO1xuXHQgIHZhciBUcmFuc2l0aW9uU3ByaW5nID0gX2RlcHJlY2F0ZWRTcHJpbmdzLlRyYW5zaXRpb25TcHJpbmc7XG5cdFxuXHQgIHJldHVybiB7IFNwcmluZzogU3ByaW5nLCBUcmFuc2l0aW9uU3ByaW5nOiBUcmFuc2l0aW9uU3ByaW5nLCBNb3Rpb246IE1vdGlvbiwgU3RhZ2dlcmVkTW90aW9uOiBTdGFnZ2VyZWRNb3Rpb24sIFRyYW5zaXRpb25Nb3Rpb246IFRyYW5zaXRpb25Nb3Rpb24gfTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiAyNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1snZGVmYXVsdCddID0gZGVwcmVjYXRlZFNwcmluZ3M7XG5cdHZhciBoYXNXYXJuZWRGb3JTcHJpbmcgPSB7fTtcblx0dmFyIGhhc1dhcm5lZEZvclRyYW5zaXRpb25TcHJpbmcgPSB7fTtcblx0XG5cdGZ1bmN0aW9uIGRlcHJlY2F0ZWRTcHJpbmdzKFJlYWN0KSB7XG5cdCAgdmFyIFNwcmluZyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0ICAgIGRpc3BsYXlOYW1lOiAnU3ByaW5nJyxcblx0XG5cdCAgICBjb21wb25lbnRXaWxsTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcblx0ICAgICAgaWYgKGZhbHNlKSB7XG5cdCAgICAgICAgdmFyIG93bmVyTmFtZSA9IHRoaXMuX3JlYWN0SW50ZXJuYWxJbnN0YW5jZS5fY3VycmVudEVsZW1lbnQuX293bmVyICYmIHRoaXMuX3JlYWN0SW50ZXJuYWxJbnN0YW5jZS5fY3VycmVudEVsZW1lbnQuX293bmVyLmdldE5hbWUoKTtcblx0ICAgICAgICBpZiAoIWhhc1dhcm5lZEZvclNwcmluZ1tvd25lck5hbWVdKSB7XG5cdCAgICAgICAgICBoYXNXYXJuZWRGb3JTcHJpbmdbb3duZXJOYW1lXSA9IHRydWU7XG5cdCAgICAgICAgICBjb25zb2xlLmVycm9yKCdTcHJpbmcgKHVzZWQgaW4gJXNyZW5kZXIpIGhhcyBub3cgYmVlbiByZW5hbWVkIHRvIE1vdGlvbi4gJyArICdQbGVhc2Ugc2VlIHRoZSByZWxlYXNlIG5vdGUgZm9yIHRoZSB1cGdyYWRlIHBhdGguIFRoYW5rIHlvdSEnLCBvd25lck5hbWUgPyBvd25lck5hbWUgKyAnXFwncyAnIDogJ1JlYWN0LicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICB9XG5cdCAgfSk7XG5cdFxuXHQgIHZhciBUcmFuc2l0aW9uU3ByaW5nID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXHQgICAgZGlzcGxheU5hbWU6ICdUcmFuc2l0aW9uU3ByaW5nJyxcblx0XG5cdCAgICBjb21wb25lbnRXaWxsTW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcblx0ICAgICAgaWYgKGZhbHNlKSB7XG5cdCAgICAgICAgdmFyIG93bmVyTmFtZSA9IHRoaXMuX3JlYWN0SW50ZXJuYWxJbnN0YW5jZS5fY3VycmVudEVsZW1lbnQuX293bmVyICYmIHRoaXMuX3JlYWN0SW50ZXJuYWxJbnN0YW5jZS5fY3VycmVudEVsZW1lbnQuX293bmVyLmdldE5hbWUoKTtcblx0ICAgICAgICBpZiAoIWhhc1dhcm5lZEZvclRyYW5zaXRpb25TcHJpbmdbb3duZXJOYW1lXSkge1xuXHQgICAgICAgICAgaGFzV2FybmVkRm9yVHJhbnNpdGlvblNwcmluZ1tvd25lck5hbWVdID0gdHJ1ZTtcblx0ICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RyYW5zaXRpb25TcHJpbmcgKHVzZWQgaW4gJXNyZW5kZXIpIGhhcyBub3cgYmVlbiByZW5hbWVkIHRvICcgKyAnVHJhbnNpdGlvbk1vdGlvbi4gUGxlYXNlIHNlZSB0aGUgcmVsZWFzZSBub3RlIGZvciB0aGUgdXBncmFkZSAnICsgJ3BhdGguIFRoYW5rIHlvdSEnLCBvd25lck5hbWUgPyBvd25lck5hbWUgKyAnXFwncyAnIDogJ1JlYWN0LicpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfSxcblx0XG5cdCAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcigpIHtcblx0ICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICB9XG5cdCAgfSk7XG5cdFxuXHQgIHJldHVybiB7IFNwcmluZzogU3ByaW5nLCBUcmFuc2l0aW9uU3ByaW5nOiBUcmFuc2l0aW9uU3ByaW5nIH07XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG4vKioqLyB9LFxuLyogMjUgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBoYXNSZWFjaGVkU3R5bGU7XG5cdFxuXHRmdW5jdGlvbiBoYXNSZWFjaGVkU3R5bGUoY3VycmVudFN0eWxlLCBzdHlsZSkge1xuXHQgIGZvciAodmFyIGtleSBpbiBzdHlsZSkge1xuXHQgICAgaWYgKCFzdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IGN1cnJlbnRTdHlsZVtrZXldO1xuXHQgICAgdmFyIGRlc3RWYWx1ZSA9IHN0eWxlW2tleV07XG5cdCAgICBpZiAoIWRlc3RWYWx1ZS5jb25maWcpIHtcblx0ICAgICAgLy8gbm90IGEgc3ByaW5nIGNvbmZpZ1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIGlmIChjdXJyZW50VmFsdWUuY29uZmlnICYmIGN1cnJlbnRWYWx1ZS52YWwgIT09IGRlc3RWYWx1ZS52YWwpIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHQgICAgaWYgKCFjdXJyZW50VmFsdWUuY29uZmlnICYmIGN1cnJlbnRWYWx1ZSAhPT0gZGVzdFZhbHVlLnZhbCkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gdHJ1ZTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDI2ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvLyB0aGlzIGZ1bmN0aW9uIGlzIGFsbG9jYXRpb24tbGVzcyB0aGFua3MgdG8gYmFiZWwsIHdoaWNoIHRyYW5zZm9ybXMgdGhlIHRhaWxcblx0Ly8gY2FsbHMgaW50byBsb29wc1xuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gbWVyZ2VEaWZmO1xuXHRmdW5jdGlvbiBtZXJnZURpZmZBcnIoX3gsIF94MiwgX3gzLCBfeDQsIF94NSwgX3g2LCBfeDcpIHtcblx0ICB2YXIgX2FnYWluID0gdHJ1ZTtcblx0XG5cdCAgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7XG5cdCAgICB2YXIgYXJyQSA9IF94LFxuXHQgICAgICAgIGFyckIgPSBfeDIsXG5cdCAgICAgICAgY29sbEIgPSBfeDMsXG5cdCAgICAgICAgaW5kZXhBID0gX3g0LFxuXHQgICAgICAgIGluZGV4QiA9IF94NSxcblx0ICAgICAgICBvblJlbW92ZSA9IF94Nixcblx0ICAgICAgICBhY2N1bSA9IF94Nztcblx0ICAgIGVuZEEgPSBlbmRCID0ga2V5QSA9IGtleUIgPSBmaWxsID0gZmlsbCA9IHVuZGVmaW5lZDtcblx0ICAgIF9hZ2FpbiA9IGZhbHNlO1xuXHRcblx0ICAgIHZhciBlbmRBID0gaW5kZXhBID09PSBhcnJBLmxlbmd0aDtcblx0ICAgIHZhciBlbmRCID0gaW5kZXhCID09PSBhcnJCLmxlbmd0aDtcblx0ICAgIHZhciBrZXlBID0gYXJyQVtpbmRleEFdO1xuXHQgICAgdmFyIGtleUIgPSBhcnJCW2luZGV4Ql07XG5cdCAgICBpZiAoZW5kQSAmJiBlbmRCKSB7XG5cdCAgICAgIC8vIHJldHVybmluZyBudWxsIGhlcmUsIG90aGVyd2lzZSBsaW50IGNvbXBsYWlucyB0aGF0IHdlJ3JlIG5vdCBleHBlY3Rpbmdcblx0ICAgICAgLy8gYSByZXR1cm4gdmFsdWUgaW4gc3Vic2VxdWVudCBjYWxscy4gV2Uga25vdyB3aGF0IHdlJ3JlIGRvaW5nLlxuXHQgICAgICByZXR1cm4gbnVsbDtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoZW5kQSkge1xuXHQgICAgICBhY2N1bVtrZXlCXSA9IGNvbGxCW2tleUJdO1xuXHQgICAgICBfeCA9IGFyckE7XG5cdCAgICAgIF94MiA9IGFyckI7XG5cdCAgICAgIF94MyA9IGNvbGxCO1xuXHQgICAgICBfeDQgPSBpbmRleEE7XG5cdCAgICAgIF94NSA9IGluZGV4QiArIDE7XG5cdCAgICAgIF94NiA9IG9uUmVtb3ZlO1xuXHQgICAgICBfeDcgPSBhY2N1bTtcblx0ICAgICAgX2FnYWluID0gdHJ1ZTtcblx0ICAgICAgY29udGludWUgX2Z1bmN0aW9uO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmIChlbmRCKSB7XG5cdCAgICAgIHZhciBmaWxsID0gb25SZW1vdmUoa2V5QSk7XG5cdCAgICAgIGlmIChmaWxsICE9IG51bGwpIHtcblx0ICAgICAgICBhY2N1bVtrZXlBXSA9IGZpbGw7XG5cdCAgICAgIH1cblx0ICAgICAgX3ggPSBhcnJBO1xuXHQgICAgICBfeDIgPSBhcnJCO1xuXHQgICAgICBfeDMgPSBjb2xsQjtcblx0ICAgICAgX3g0ID0gaW5kZXhBICsgMTtcblx0ICAgICAgX3g1ID0gaW5kZXhCO1xuXHQgICAgICBfeDYgPSBvblJlbW92ZTtcblx0ICAgICAgX3g3ID0gYWNjdW07XG5cdCAgICAgIF9hZ2FpbiA9IHRydWU7XG5cdCAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoa2V5QSA9PT0ga2V5Qikge1xuXHQgICAgICBhY2N1bVtrZXlBXSA9IGNvbGxCW2tleUFdO1xuXHQgICAgICBfeCA9IGFyckE7XG5cdCAgICAgIF94MiA9IGFyckI7XG5cdCAgICAgIF94MyA9IGNvbGxCO1xuXHQgICAgICBfeDQgPSBpbmRleEEgKyAxO1xuXHQgICAgICBfeDUgPSBpbmRleEIgKyAxO1xuXHQgICAgICBfeDYgPSBvblJlbW92ZTtcblx0ICAgICAgX3g3ID0gYWNjdW07XG5cdCAgICAgIF9hZ2FpbiA9IHRydWU7XG5cdCAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcblx0ICAgIH1cblx0XG5cdCAgICBpZiAoIWNvbGxCLmhhc093blByb3BlcnR5KGtleUEpKSB7XG5cdCAgICAgIHZhciBmaWxsID0gb25SZW1vdmUoa2V5QSk7XG5cdCAgICAgIGlmIChmaWxsICE9IG51bGwpIHtcblx0ICAgICAgICBhY2N1bVtrZXlBXSA9IGZpbGw7XG5cdCAgICAgIH1cblx0ICAgICAgX3ggPSBhcnJBO1xuXHQgICAgICBfeDIgPSBhcnJCO1xuXHQgICAgICBfeDMgPSBjb2xsQjtcblx0ICAgICAgX3g0ID0gaW5kZXhBICsgMTtcblx0ICAgICAgX3g1ID0gaW5kZXhCO1xuXHQgICAgICBfeDYgPSBvblJlbW92ZTtcblx0ICAgICAgX3g3ID0gYWNjdW07XG5cdCAgICAgIF9hZ2FpbiA9IHRydWU7XG5cdCAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcblx0ICAgIH1cblx0XG5cdCAgICBfeCA9IGFyckE7XG5cdCAgICBfeDIgPSBhcnJCO1xuXHQgICAgX3gzID0gY29sbEI7XG5cdCAgICBfeDQgPSBpbmRleEEgKyAxO1xuXHQgICAgX3g1ID0gaW5kZXhCO1xuXHQgICAgX3g2ID0gb25SZW1vdmU7XG5cdCAgICBfeDcgPSBhY2N1bTtcblx0ICAgIF9hZ2FpbiA9IHRydWU7XG5cdCAgICBjb250aW51ZSBfZnVuY3Rpb247XG5cdCAgfVxuXHR9XG5cdFxuXHRmdW5jdGlvbiBtZXJnZURpZmYoYSwgYiwgb25SZW1vdmUpIHtcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgLy8gaWYgYW55b25lIGNhbiBtYWtlIHRoaXMgd29yayB3aXRob3V0IGFsbG9jYXRpbmcgdGhlIGFycmF5cyBoZXJlLCB3ZSdsbFxuXHQgIC8vIGdpdmUgeW91IGEgbWVkYWxcblx0ICBtZXJnZURpZmZBcnIoT2JqZWN0LmtleXMoYSksIE9iamVjdC5rZXlzKGIpLCBiLCAwLCAwLCBvblJlbW92ZSwgcmV0KTtcblx0ICByZXR1cm4gcmV0O1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogMjcgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdC8vIGN1cnJlbnRTdHlsZSBrZWVwcyB0aGUgaW5mbyBhYm91dCB3aGV0aGVyIGEgcHJvcCBpcyBjb25maWd1cmVkIGFzIGEgc3ByaW5nXG5cdC8vIG9yIGlmIGl0J3MganVzdCBhIHJhbmRvbSBwcm9wIHRoYXQgaGFwcGVucyB0byBiZSBwcmVzZW50IG9uIHRoZSBzdHlsZVxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gbm9WZWxvY2l0eTtcblx0XG5cdGZ1bmN0aW9uIG5vVmVsb2NpdHkoY3VycmVudFZlbG9jaXR5LCBjdXJyZW50U3R5bGUpIHtcblx0ICBmb3IgKHZhciBrZXkgaW4gY3VycmVudFZlbG9jaXR5KSB7XG5cdCAgICBpZiAoIWN1cnJlbnRWZWxvY2l0eS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgaWYgKGN1cnJlbnRTdHlsZVtrZXldLmNvbmZpZyAmJiBjdXJyZW50VmVsb2NpdHlba2V5XSAhPT0gMCkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdCAgfVxuXHQgIHJldHVybiB0cnVlO1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogMjggKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSByZW9yZGVyS2V5cztcblx0XG5cdGZ1bmN0aW9uIHJlb3JkZXJLZXlzKG9iaiwgZikge1xuXHQgIHZhciBuZXdLZXlzID0gZihPYmplY3Qua2V5cyhvYmopKTtcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgZm9yICh2YXIgaSA9IDA7IGkgPCBuZXdLZXlzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICB2YXIga2V5ID0gbmV3S2V5c1tpXTtcblx0ICAgIHJldFtrZXldID0gb2JqW2tleV07XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gcmV0O1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG4vKioqLyB9LFxuLyogMjkgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbJ2RlZmF1bHQnXSA9IHNwcmluZztcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblx0XG5cdHZhciBfcHJlc2V0cyA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cdFxuXHR2YXIgX3ByZXNldHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJlc2V0cyk7XG5cdFxuXHQvLyBpbnN0ZWFkIG9mIGV4cG9zaW5nIHt2YWw6IGJsYSwgY29uZmlnOiBibGF9LCB1c2UgYSBoZWxwZXJcblx0XG5cdGZ1bmN0aW9uIHNwcmluZyh2YWwpIHtcblx0ICB2YXIgY29uZmlnID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gX3ByZXNldHMyWydkZWZhdWx0J10ubm9Xb2JibGUgOiBhcmd1bWVudHNbMV07XG5cdFxuXHQgIHJldHVybiB7IHZhbDogdmFsLCBjb25maWc6IGNvbmZpZyB9O1xuXHR9XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuLyoqKi8gfSxcbi8qIDMwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdGV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5cdGV4cG9ydHNbXCJkZWZhdWx0XCJdID0gc3RlcHBlcjtcblx0dmFyIGVycm9yTWFyZ2luID0gMC4wMDAxO1xuXHRcblx0ZnVuY3Rpb24gc3RlcHBlcihmcmFtZVJhdGUsIHgsIHYsIGRlc3RYLCBrLCBiKSB7XG5cdCAgLy8gU3ByaW5nIHN0aWZmbmVzcywgaW4ga2cgLyBzXjJcblx0XG5cdCAgLy8gZm9yIGFuaW1hdGlvbnMsIGRlc3RYIGlzIHJlYWxseSBzcHJpbmcgbGVuZ3RoIChzcHJpbmcgYXQgcmVzdCkuIGluaXRpYWxcblx0ICAvLyBwb3NpdGlvbiBpcyBjb25zaWRlcmVkIGFzIHRoZSBzdHJldGNoZWQvY29tcHJlc3NlZCBwb3NpdGlvbiBvZiBhIHNwcmluZ1xuXHQgIHZhciBGc3ByaW5nID0gLWsgKiAoeCAtIGRlc3RYKTtcblx0XG5cdCAgLy8gRGFtcGluZywgaW4ga2cgLyBzXG5cdCAgdmFyIEZkYW1wZXIgPSAtYiAqIHY7XG5cdFxuXHQgIC8vIHVzdWFsbHkgd2UgcHV0IG1hc3MgaGVyZSwgYnV0IGZvciBhbmltYXRpb24gcHVycG9zZXMsIHNwZWNpZnlpbmcgbWFzcyBpcyBhXG5cdCAgLy8gYml0IHJlZHVuZGFudC4geW91IGNvdWxkIHNpbXBseSBhZGp1c3QgayBhbmQgYiBhY2NvcmRpbmdseVxuXHQgIC8vIGxldCBhID0gKEZzcHJpbmcgKyBGZGFtcGVyKSAvIG1hc3M7XG5cdCAgdmFyIGEgPSBGc3ByaW5nICsgRmRhbXBlcjtcblx0XG5cdCAgdmFyIG5ld1YgPSB2ICsgYSAqIGZyYW1lUmF0ZTtcblx0ICB2YXIgbmV3WCA9IHggKyBuZXdWICogZnJhbWVSYXRlO1xuXHRcblx0ICBpZiAoTWF0aC5hYnMobmV3ViAtIHYpIDwgZXJyb3JNYXJnaW4gJiYgTWF0aC5hYnMobmV3WCAtIHgpIDwgZXJyb3JNYXJnaW4pIHtcblx0ICAgIHJldHVybiBbZGVzdFgsIDBdO1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIFtuZXdYLCBuZXdWXTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDMxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQvLyB0dXJuIHt4OiB7dmFsOiAxLCBjb25maWc6IFsxLCAyXX0sIHk6IDJ9IGludG8ge3g6IDEsIHk6IDJ9XG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBzdHJpcFN0eWxlO1xuXHRcblx0ZnVuY3Rpb24gc3RyaXBTdHlsZShzdHlsZSkge1xuXHQgIHZhciByZXQgPSB7fTtcblx0ICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcblx0ICAgIGlmICghc3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIHJldFtrZXldID0gc3R5bGVba2V5XS52YWwgPT0gbnVsbCA/IHN0eWxlW2tleV0gOiBzdHlsZVtrZXldLnZhbDtcblx0ICB9XG5cdCAgcmV0dXJuIHJldDtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDMyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRleHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXHRleHBvcnRzLmludGVycG9sYXRlVmFsdWUgPSBpbnRlcnBvbGF0ZVZhbHVlO1xuXHRleHBvcnRzLnVwZGF0ZUN1cnJlbnRTdHlsZSA9IHVwZGF0ZUN1cnJlbnRTdHlsZTtcblx0ZXhwb3J0cy51cGRhdGVDdXJyZW50VmVsb2NpdHkgPSB1cGRhdGVDdXJyZW50VmVsb2NpdHk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cdFxuXHR2YXIgX3N0ZXBwZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMwKTtcblx0XG5cdHZhciBfc3RlcHBlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zdGVwcGVyKTtcblx0XG5cdC8vIFRPRE86IHJlZmFjdG9yIGNvbW1vbiBsb2dpYyB3aXRoIHVwZGF0ZUN1cnJWYWx1ZSBhbmQgdXBkYXRlQ3VyclZlbG9jaXR5XG5cdFxuXHRmdW5jdGlvbiBpbnRlcnBvbGF0ZVZhbHVlKGFscGhhLCBuZXh0U3R5bGUsIHByZXZTdHlsZSkge1xuXHQgIC8vIG1pZ2h0IGJlIHVzZWQgYnkgYSBUcmFuc2l0aW9uTW90aW9uLCB3aGVyZSBwcmV2U3R5bGUgbWlnaHQgbm90IGV4aXN0IGFueW1vcmVcblx0ICBpZiAoIXByZXZTdHlsZSkge1xuXHQgICAgcmV0dXJuIG5leHRTdHlsZTtcblx0ICB9XG5cdFxuXHQgIHZhciByZXQgPSB7fTtcblx0ICBmb3IgKHZhciBrZXkgaW4gbmV4dFN0eWxlKSB7XG5cdCAgICBpZiAoIW5leHRTdHlsZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmICghbmV4dFN0eWxlW2tleV0uY29uZmlnKSB7XG5cdCAgICAgIHJldFtrZXldID0gbmV4dFN0eWxlW2tleV07XG5cdCAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWcsIG5vdCBzb21ldGhpbmcgd2Ugd2FudCB0byBpbnRlcnBvbGF0ZVxuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIHZhciBwcmV2VmFsdWUgPSBwcmV2U3R5bGVba2V5XS5jb25maWcgPyBwcmV2U3R5bGVba2V5XS52YWwgOiBwcmV2U3R5bGVba2V5XTtcblx0ICAgIHJldFtrZXldID0ge1xuXHQgICAgICB2YWw6IG5leHRTdHlsZVtrZXldLnZhbCAqIGFscGhhICsgcHJldlZhbHVlICogKDEgLSBhbHBoYSksXG5cdCAgICAgIGNvbmZpZzogbmV4dFN0eWxlW2tleV0uY29uZmlnXG5cdCAgICB9O1xuXHQgIH1cblx0XG5cdCAgcmV0dXJuIHJldDtcblx0fVxuXHRcblx0Ly8gVE9ETzogcmVmYWN0b3IgY29tbW9uIGxvZ2ljIHdpdGggdXBkYXRlQ3VycmVudFZlbG9jaXR5XG5cdFxuXHRmdW5jdGlvbiB1cGRhdGVDdXJyZW50U3R5bGUoZnJhbWVSYXRlLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpIHtcblx0ICB2YXIgcmV0ID0ge307XG5cdCAgZm9yICh2YXIga2V5IGluIHN0eWxlKSB7XG5cdCAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICBpZiAoIXN0eWxlW2tleV0uY29uZmlnKSB7XG5cdCAgICAgIHJldFtrZXldID0gc3R5bGVba2V5XTtcblx0ICAgICAgLy8gbm90IGEgc3ByaW5nIGNvbmZpZywgbm90IHNvbWV0aGluZyB3ZSB3YW50IHRvIGludGVycG9sYXRlXG5cdCAgICAgIGNvbnRpbnVlO1xuXHQgICAgfVxuXHQgICAgdmFyIF9zdHlsZSRrZXkkY29uZmlnID0gc3R5bGVba2V5XS5jb25maWc7XG5cdCAgICB2YXIgayA9IF9zdHlsZSRrZXkkY29uZmlnWzBdO1xuXHQgICAgdmFyIGIgPSBfc3R5bGUka2V5JGNvbmZpZ1sxXTtcblx0XG5cdCAgICB2YXIgdmFsID0gX3N0ZXBwZXIyWydkZWZhdWx0J10oZnJhbWVSYXRlLFxuXHQgICAgLy8gbWlnaHQgaGF2ZSBiZWVuIGEgbm9uLXNwcmluZ2VkIHByb3AgdGhhdCBqdXN0IGJlY2FtZSBvbmVcblx0ICAgIGN1cnJlbnRTdHlsZVtrZXldLnZhbCA9PSBudWxsID8gY3VycmVudFN0eWxlW2tleV0gOiBjdXJyZW50U3R5bGVba2V5XS52YWwsIGN1cnJlbnRWZWxvY2l0eVtrZXldLCBzdHlsZVtrZXldLnZhbCwgaywgYilbMF07XG5cdCAgICByZXRba2V5XSA9IHtcblx0ICAgICAgdmFsOiB2YWwsXG5cdCAgICAgIGNvbmZpZzogc3R5bGVba2V5XS5jb25maWdcblx0ICAgIH07XG5cdCAgfVxuXHQgIHJldHVybiByZXQ7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRWZWxvY2l0eShmcmFtZVJhdGUsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXR5LCBzdHlsZSkge1xuXHQgIHZhciByZXQgPSB7fTtcblx0ICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcblx0ICAgIGlmICghc3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHQgICAgICBjb250aW51ZTtcblx0ICAgIH1cblx0ICAgIGlmICghc3R5bGVba2V5XS5jb25maWcpIHtcblx0ICAgICAgLy8gbm90IGEgc3ByaW5nIGNvbmZpZywgbm90IHNvbWV0aGluZyB3ZSB3YW50IHRvIGludGVycG9sYXRlXG5cdCAgICAgIHJldFtrZXldID0gMDtcblx0ICAgICAgY29udGludWU7XG5cdCAgICB9XG5cdCAgICB2YXIgX3N0eWxlJGtleSRjb25maWcyID0gc3R5bGVba2V5XS5jb25maWc7XG5cdCAgICB2YXIgayA9IF9zdHlsZSRrZXkkY29uZmlnMlswXTtcblx0ICAgIHZhciBiID0gX3N0eWxlJGtleSRjb25maWcyWzFdO1xuXHRcblx0ICAgIHZhciB2YWwgPSBfc3RlcHBlcjJbJ2RlZmF1bHQnXShmcmFtZVJhdGUsXG5cdCAgICAvLyBtaWdodCBoYXZlIGJlZW4gYSBub24tc3ByaW5nZWQgcHJvcCB0aGF0IGp1c3QgYmVjYW1lIG9uZVxuXHQgICAgY3VycmVudFN0eWxlW2tleV0udmFsID09IG51bGwgPyBjdXJyZW50U3R5bGVba2V5XSA6IGN1cnJlbnRTdHlsZVtrZXldLnZhbCwgY3VycmVudFZlbG9jaXR5W2tleV0sIHN0eWxlW2tleV0udmFsLCBrLCBiKVsxXTtcblx0ICAgIHJldFtrZXldID0gdmFsO1xuXHQgIH1cblx0ICByZXR1cm4gcmV0O1xuXHR9XG5cbi8qKiovIH0sXG4vKiAzMyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0Ly8gdXNlZCBieSB0aGUgdHJlZS13YWxraW5nIHVwZGF0ZXMgYW5kIHNwcmluZ3MuIEF2b2lkcyBzb21lIGFsbG9jYXRpb25zXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0ZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblx0ZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB6ZXJvO1xuXHRcblx0ZnVuY3Rpb24gemVybygpIHtcblx0ICByZXR1cm4gMDtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuLyoqKi8gfSxcbi8qIDM0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgbm93ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMClcblx0ICAsIGdsb2JhbCA9IHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnID8ge30gOiB3aW5kb3dcblx0ICAsIHZlbmRvcnMgPSBbJ21veicsICd3ZWJraXQnXVxuXHQgICwgc3VmZml4ID0gJ0FuaW1hdGlvbkZyYW1lJ1xuXHQgICwgcmFmID0gZ2xvYmFsWydyZXF1ZXN0JyArIHN1ZmZpeF1cblx0ICAsIGNhZiA9IGdsb2JhbFsnY2FuY2VsJyArIHN1ZmZpeF0gfHwgZ2xvYmFsWydjYW5jZWxSZXF1ZXN0JyArIHN1ZmZpeF1cblx0XG5cdGZvcih2YXIgaSA9IDA7IGkgPCB2ZW5kb3JzLmxlbmd0aCAmJiAhcmFmOyBpKyspIHtcblx0ICByYWYgPSBnbG9iYWxbdmVuZG9yc1tpXSArICdSZXF1ZXN0JyArIHN1ZmZpeF1cblx0ICBjYWYgPSBnbG9iYWxbdmVuZG9yc1tpXSArICdDYW5jZWwnICsgc3VmZml4XVxuXHQgICAgICB8fCBnbG9iYWxbdmVuZG9yc1tpXSArICdDYW5jZWxSZXF1ZXN0JyArIHN1ZmZpeF1cblx0fVxuXHRcblx0Ly8gU29tZSB2ZXJzaW9ucyBvZiBGRiBoYXZlIHJBRiBidXQgbm90IGNBRlxuXHRpZighcmFmIHx8ICFjYWYpIHtcblx0ICB2YXIgbGFzdCA9IDBcblx0ICAgICwgaWQgPSAwXG5cdCAgICAsIHF1ZXVlID0gW11cblx0ICAgICwgZnJhbWVEdXJhdGlvbiA9IDEwMDAgLyA2MFxuXHRcblx0ICByYWYgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuXHQgICAgaWYocXVldWUubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgIHZhciBfbm93ID0gbm93KClcblx0ICAgICAgICAsIG5leHQgPSBNYXRoLm1heCgwLCBmcmFtZUR1cmF0aW9uIC0gKF9ub3cgLSBsYXN0KSlcblx0ICAgICAgbGFzdCA9IG5leHQgKyBfbm93XG5cdCAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgdmFyIGNwID0gcXVldWUuc2xpY2UoMClcblx0ICAgICAgICAvLyBDbGVhciBxdWV1ZSBoZXJlIHRvIHByZXZlbnRcblx0ICAgICAgICAvLyBjYWxsYmFja3MgZnJvbSBhcHBlbmRpbmcgbGlzdGVuZXJzXG5cdCAgICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgZnJhbWUncyBxdWV1ZVxuXHQgICAgICAgIHF1ZXVlLmxlbmd0aCA9IDBcblx0ICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY3AubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgIGlmKCFjcFtpXS5jYW5jZWxsZWQpIHtcblx0ICAgICAgICAgICAgdHJ5e1xuXHQgICAgICAgICAgICAgIGNwW2ldLmNhbGxiYWNrKGxhc3QpXG5cdCAgICAgICAgICAgIH0gY2F0Y2goZSkge1xuXHQgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IHRocm93IGUgfSwgMClcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfSwgTWF0aC5yb3VuZChuZXh0KSlcblx0ICAgIH1cblx0ICAgIHF1ZXVlLnB1c2goe1xuXHQgICAgICBoYW5kbGU6ICsraWQsXG5cdCAgICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcblx0ICAgICAgY2FuY2VsbGVkOiBmYWxzZVxuXHQgICAgfSlcblx0ICAgIHJldHVybiBpZFxuXHQgIH1cblx0XG5cdCAgY2FmID0gZnVuY3Rpb24oaGFuZGxlKSB7XG5cdCAgICBmb3IodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgaWYocXVldWVbaV0uaGFuZGxlID09PSBoYW5kbGUpIHtcblx0ICAgICAgICBxdWV1ZVtpXS5jYW5jZWxsZWQgPSB0cnVlXG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cdH1cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4pIHtcblx0ICAvLyBXcmFwIGluIGEgbmV3IGZ1bmN0aW9uIHRvIHByZXZlbnRcblx0ICAvLyBgY2FuY2VsYCBwb3RlbnRpYWxseSBiZWluZyBhc3NpZ25lZFxuXHQgIC8vIHRvIHRoZSBuYXRpdmUgckFGIGZ1bmN0aW9uXG5cdCAgcmV0dXJuIHJhZi5jYWxsKGdsb2JhbCwgZm4pXG5cdH1cblx0bW9kdWxlLmV4cG9ydHMuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG5cdCAgY2FmLmFwcGx5KGdsb2JhbCwgYXJndW1lbnRzKVxuXHR9XG5cblxuLyoqKi8gfSxcbi8qIDM1ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQvKlxyXG5cdFx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuXHRcdEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcclxuXHQqL1xyXG5cdHZhciBzdHlsZXNJbkRvbSA9IHt9LFxyXG5cdFx0bWVtb2l6ZSA9IGZ1bmN0aW9uKGZuKSB7XHJcblx0XHRcdHZhciBtZW1vO1xyXG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdGlmICh0eXBlb2YgbWVtbyA9PT0gXCJ1bmRlZmluZWRcIikgbWVtbyA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcblx0XHRcdFx0cmV0dXJuIG1lbW87XHJcblx0XHRcdH07XHJcblx0XHR9LFxyXG5cdFx0aXNPbGRJRSA9IG1lbW9pemUoZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiAvbXNpZSBbNi05XVxcYi8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpKTtcclxuXHRcdH0pLFxyXG5cdFx0Z2V0SGVhZEVsZW1lbnQgPSBtZW1vaXplKGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0cmV0dXJuIGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdO1xyXG5cdFx0fSksXHJcblx0XHRzaW5nbGV0b25FbGVtZW50ID0gbnVsbCxcclxuXHRcdHNpbmdsZXRvbkNvdW50ZXIgPSAwO1xyXG5cdFxyXG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obGlzdCwgb3B0aW9ucykge1xyXG5cdFx0aWYodHJ1ZSkge1xyXG5cdFx0XHRpZih0eXBlb2YgZG9jdW1lbnQgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBFcnJvcihcIlRoZSBzdHlsZS1sb2FkZXIgY2Fubm90IGJlIHVzZWQgaW4gYSBub24tYnJvd3NlciBlbnZpcm9ubWVudFwiKTtcclxuXHRcdH1cclxuXHRcclxuXHRcdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG5cdFx0Ly8gRm9yY2Ugc2luZ2xlLXRhZyBzb2x1dGlvbiBvbiBJRTYtOSwgd2hpY2ggaGFzIGEgaGFyZCBsaW1pdCBvbiB0aGUgIyBvZiA8c3R5bGU+XHJcblx0XHQvLyB0YWdzIGl0IHdpbGwgYWxsb3cgb24gYSBwYWdlXHJcblx0XHRpZiAodHlwZW9mIG9wdGlvbnMuc2luZ2xldG9uID09PSBcInVuZGVmaW5lZFwiKSBvcHRpb25zLnNpbmdsZXRvbiA9IGlzT2xkSUUoKTtcclxuXHRcclxuXHRcdHZhciBzdHlsZXMgPSBsaXN0VG9TdHlsZXMobGlzdCk7XHJcblx0XHRhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpO1xyXG5cdFxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZShuZXdMaXN0KSB7XHJcblx0XHRcdHZhciBtYXlSZW1vdmUgPSBbXTtcclxuXHRcdFx0Zm9yKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xyXG5cdFx0XHRcdHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdO1xyXG5cdFx0XHRcdGRvbVN0eWxlLnJlZnMtLTtcclxuXHRcdFx0XHRtYXlSZW1vdmUucHVzaChkb21TdHlsZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYobmV3TGlzdCkge1xyXG5cdFx0XHRcdHZhciBuZXdTdHlsZXMgPSBsaXN0VG9TdHlsZXMobmV3TGlzdCk7XHJcblx0XHRcdFx0YWRkU3R5bGVzVG9Eb20obmV3U3R5bGVzLCBvcHRpb25zKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbWF5UmVtb3ZlLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIGRvbVN0eWxlID0gbWF5UmVtb3ZlW2ldO1xyXG5cdFx0XHRcdGlmKGRvbVN0eWxlLnJlZnMgPT09IDApIHtcclxuXHRcdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKylcclxuXHRcdFx0XHRcdFx0ZG9tU3R5bGUucGFydHNbal0oKTtcclxuXHRcdFx0XHRcdGRlbGV0ZSBzdHlsZXNJbkRvbVtkb21TdHlsZS5pZF07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBhZGRTdHlsZXNUb0RvbShzdHlsZXMsIG9wdGlvbnMpIHtcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0dmFyIGl0ZW0gPSBzdHlsZXNbaV07XHJcblx0XHRcdHZhciBkb21TdHlsZSA9IHN0eWxlc0luRG9tW2l0ZW0uaWRdO1xyXG5cdFx0XHRpZihkb21TdHlsZSkge1xyXG5cdFx0XHRcdGRvbVN0eWxlLnJlZnMrKztcclxuXHRcdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgZG9tU3R5bGUucGFydHMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdGRvbVN0eWxlLnBhcnRzW2pdKGl0ZW0ucGFydHNbal0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRmb3IoOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0ZG9tU3R5bGUucGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHZhciBwYXJ0cyA9IFtdO1xyXG5cdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBpdGVtLnBhcnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRwYXJ0cy5wdXNoKGFkZFN0eWxlKGl0ZW0ucGFydHNbal0sIG9wdGlvbnMpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0c3R5bGVzSW5Eb21baXRlbS5pZF0gPSB7aWQ6IGl0ZW0uaWQsIHJlZnM6IDEsIHBhcnRzOiBwYXJ0c307XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gbGlzdFRvU3R5bGVzKGxpc3QpIHtcclxuXHRcdHZhciBzdHlsZXMgPSBbXTtcclxuXHRcdHZhciBuZXdTdHlsZXMgPSB7fTtcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBpdGVtID0gbGlzdFtpXTtcclxuXHRcdFx0dmFyIGlkID0gaXRlbVswXTtcclxuXHRcdFx0dmFyIGNzcyA9IGl0ZW1bMV07XHJcblx0XHRcdHZhciBtZWRpYSA9IGl0ZW1bMl07XHJcblx0XHRcdHZhciBzb3VyY2VNYXAgPSBpdGVtWzNdO1xyXG5cdFx0XHR2YXIgcGFydCA9IHtjc3M6IGNzcywgbWVkaWE6IG1lZGlhLCBzb3VyY2VNYXA6IHNvdXJjZU1hcH07XHJcblx0XHRcdGlmKCFuZXdTdHlsZXNbaWRdKVxyXG5cdFx0XHRcdHN0eWxlcy5wdXNoKG5ld1N0eWxlc1tpZF0gPSB7aWQ6IGlkLCBwYXJ0czogW3BhcnRdfSk7XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRuZXdTdHlsZXNbaWRdLnBhcnRzLnB1c2gocGFydCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gc3R5bGVzO1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBjcmVhdGVTdHlsZUVsZW1lbnQoKSB7XHJcblx0XHR2YXIgc3R5bGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xyXG5cdFx0dmFyIGhlYWQgPSBnZXRIZWFkRWxlbWVudCgpO1xyXG5cdFx0c3R5bGVFbGVtZW50LnR5cGUgPSBcInRleHQvY3NzXCI7XHJcblx0XHRoZWFkLmFwcGVuZENoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0XHRyZXR1cm4gc3R5bGVFbGVtZW50O1xyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBjcmVhdGVMaW5rRWxlbWVudCgpIHtcclxuXHRcdHZhciBsaW5rRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xyXG5cdFx0dmFyIGhlYWQgPSBnZXRIZWFkRWxlbWVudCgpO1xyXG5cdFx0bGlua0VsZW1lbnQucmVsID0gXCJzdHlsZXNoZWV0XCI7XHJcblx0XHRoZWFkLmFwcGVuZENoaWxkKGxpbmtFbGVtZW50KTtcclxuXHRcdHJldHVybiBsaW5rRWxlbWVudDtcclxuXHR9XHJcblx0XHJcblx0ZnVuY3Rpb24gYWRkU3R5bGUob2JqLCBvcHRpb25zKSB7XHJcblx0XHR2YXIgc3R5bGVFbGVtZW50LCB1cGRhdGUsIHJlbW92ZTtcclxuXHRcclxuXHRcdGlmIChvcHRpb25zLnNpbmdsZXRvbikge1xyXG5cdFx0XHR2YXIgc3R5bGVJbmRleCA9IHNpbmdsZXRvbkNvdW50ZXIrKztcclxuXHRcdFx0c3R5bGVFbGVtZW50ID0gc2luZ2xldG9uRWxlbWVudCB8fCAoc2luZ2xldG9uRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudCgpKTtcclxuXHRcdFx0dXBkYXRlID0gYXBwbHlUb1NpbmdsZXRvblRhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCwgc3R5bGVJbmRleCwgZmFsc2UpO1xyXG5cdFx0XHRyZW1vdmUgPSBhcHBseVRvU2luZ2xldG9uVGFnLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50LCBzdHlsZUluZGV4LCB0cnVlKTtcclxuXHRcdH0gZWxzZSBpZihvYmouc291cmNlTWFwICYmXHJcblx0XHRcdHR5cGVvZiBVUkwgPT09IFwiZnVuY3Rpb25cIiAmJlxyXG5cdFx0XHR0eXBlb2YgVVJMLmNyZWF0ZU9iamVjdFVSTCA9PT0gXCJmdW5jdGlvblwiICYmXHJcblx0XHRcdHR5cGVvZiBVUkwucmV2b2tlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdFx0dHlwZW9mIEJsb2IgPT09IFwiZnVuY3Rpb25cIiAmJlxyXG5cdFx0XHR0eXBlb2YgYnRvYSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudCA9IGNyZWF0ZUxpbmtFbGVtZW50KCk7XHJcblx0XHRcdHVwZGF0ZSA9IHVwZGF0ZUxpbmsuYmluZChudWxsLCBzdHlsZUVsZW1lbnQpO1xyXG5cdFx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdFx0XHRcdGlmKHN0eWxlRWxlbWVudC5ocmVmKVxyXG5cdFx0XHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChzdHlsZUVsZW1lbnQuaHJlZik7XHJcblx0XHRcdH07XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQgPSBjcmVhdGVTdHlsZUVsZW1lbnQoKTtcclxuXHRcdFx0dXBkYXRlID0gYXBwbHlUb1RhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRcdHJlbW92ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHN0eWxlRWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudCk7XHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0XHJcblx0XHR1cGRhdGUob2JqKTtcclxuXHRcclxuXHRcdHJldHVybiBmdW5jdGlvbiB1cGRhdGVTdHlsZShuZXdPYmopIHtcclxuXHRcdFx0aWYobmV3T2JqKSB7XHJcblx0XHRcdFx0aWYobmV3T2JqLmNzcyA9PT0gb2JqLmNzcyAmJiBuZXdPYmoubWVkaWEgPT09IG9iai5tZWRpYSAmJiBuZXdPYmouc291cmNlTWFwID09PSBvYmouc291cmNlTWFwKVxyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdHVwZGF0ZShvYmogPSBuZXdPYmopO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHJlbW92ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH1cclxuXHRcclxuXHR2YXIgcmVwbGFjZVRleHQgPSAoZnVuY3Rpb24gKCkge1xyXG5cdFx0dmFyIHRleHRTdG9yZSA9IFtdO1xyXG5cdFxyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uIChpbmRleCwgcmVwbGFjZW1lbnQpIHtcclxuXHRcdFx0dGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xyXG5cdFx0XHRyZXR1cm4gdGV4dFN0b3JlLmZpbHRlcihCb29sZWFuKS5qb2luKCdcXG4nKTtcclxuXHRcdH07XHJcblx0fSkoKTtcclxuXHRcclxuXHRmdW5jdGlvbiBhcHBseVRvU2luZ2xldG9uVGFnKHN0eWxlRWxlbWVudCwgaW5kZXgsIHJlbW92ZSwgb2JqKSB7XHJcblx0XHR2YXIgY3NzID0gcmVtb3ZlID8gXCJcIiA6IG9iai5jc3M7XHJcblx0XHJcblx0XHRpZiAoc3R5bGVFbGVtZW50LnN0eWxlU2hlZXQpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dmFyIGNzc05vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpO1xyXG5cdFx0XHR2YXIgY2hpbGROb2RlcyA9IHN0eWxlRWxlbWVudC5jaGlsZE5vZGVzO1xyXG5cdFx0XHRpZiAoY2hpbGROb2Rlc1tpbmRleF0pIHN0eWxlRWxlbWVudC5yZW1vdmVDaGlsZChjaGlsZE5vZGVzW2luZGV4XSk7XHJcblx0XHRcdGlmIChjaGlsZE5vZGVzLmxlbmd0aCkge1xyXG5cdFx0XHRcdHN0eWxlRWxlbWVudC5pbnNlcnRCZWZvcmUoY3NzTm9kZSwgY2hpbGROb2Rlc1tpbmRleF0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHN0eWxlRWxlbWVudC5hcHBlbmRDaGlsZChjc3NOb2RlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRmdW5jdGlvbiBhcHBseVRvVGFnKHN0eWxlRWxlbWVudCwgb2JqKSB7XHJcblx0XHR2YXIgY3NzID0gb2JqLmNzcztcclxuXHRcdHZhciBtZWRpYSA9IG9iai5tZWRpYTtcclxuXHRcdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xyXG5cdFxyXG5cdFx0aWYobWVkaWEpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1lZGlhXCIsIG1lZGlhKVxyXG5cdFx0fVxyXG5cdFxyXG5cdFx0aWYoc3R5bGVFbGVtZW50LnN0eWxlU2hlZXQpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzcztcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHdoaWxlKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKSB7XHJcblx0XHRcdFx0c3R5bGVFbGVtZW50LnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGZ1bmN0aW9uIHVwZGF0ZUxpbmsobGlua0VsZW1lbnQsIG9iaikge1xyXG5cdFx0dmFyIGNzcyA9IG9iai5jc3M7XHJcblx0XHR2YXIgbWVkaWEgPSBvYmoubWVkaWE7XHJcblx0XHR2YXIgc291cmNlTWFwID0gb2JqLnNvdXJjZU1hcDtcclxuXHRcclxuXHRcdGlmKHNvdXJjZU1hcCkge1xyXG5cdFx0XHQvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yNjYwMzg3NVxyXG5cdFx0XHRjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiICsgYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoc291cmNlTWFwKSkpKSArIFwiICovXCI7XHJcblx0XHR9XHJcblx0XHJcblx0XHR2YXIgYmxvYiA9IG5ldyBCbG9iKFtjc3NdLCB7IHR5cGU6IFwidGV4dC9jc3NcIiB9KTtcclxuXHRcclxuXHRcdHZhciBvbGRTcmMgPSBsaW5rRWxlbWVudC5ocmVmO1xyXG5cdFxyXG5cdFx0bGlua0VsZW1lbnQuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcblx0XHJcblx0XHRpZihvbGRTcmMpXHJcblx0XHRcdFVSTC5yZXZva2VPYmplY3RVUkwob2xkU3JjKTtcclxuXHR9XHJcblxuXG4vKioqLyB9LFxuLyogMzYgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdC8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cdFxuXHQvLyBsb2FkIHRoZSBzdHlsZXNcblx0dmFyIGNvbnRlbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE5KTtcblx0aWYodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG5cdC8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cblx0dmFyIHVwZGF0ZSA9IF9fd2VicGFja19yZXF1aXJlX18oMzUpKGNvbnRlbnQsIHt9KTtcblx0aWYoY29udGVudC5sb2NhbHMpIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHM7XG5cdC8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcblx0aWYoZmFsc2UpIHtcblx0XHQvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFnc1xuXHRcdGlmKCFjb250ZW50LmxvY2Fscykge1xuXHRcdFx0bW9kdWxlLmhvdC5hY2NlcHQoXCIhIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhLi8uLi8uLi9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcz9icm93c2Vycz1sYXN0IDIgdmVyc2lvbiEuLy4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9pbmRleC5qcyEuL21haW4uc2Nzc1wiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2F1dG9wcmVmaXhlci1sb2FkZXIvaW5kZXguanM/YnJvd3NlcnM9bGFzdCAyIHZlcnNpb24hLi8uLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhLi9tYWluLnNjc3NcIik7XG5cdFx0XHRcdGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuXHRcdFx0XHR1cGRhdGUobmV3Q29udGVudCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0Ly8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuXHRcdG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xuXHR9XG5cbi8qKiovIH0sXG4vKiAzNyAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgdmlld0JveD1cXFwiMCAwIDI2ODEgODE0XFxcIiB2ZXJzaW9uPVxcXCIxLjFcXFwiIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgeG1sbnM6eGxpbms9XFxcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcXFwiIHhtbG5zOnNrZXRjaD1cXFwiaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoL25zXFxcIj48dGl0bGU+Q2xpbWIgTG9nbyBCZXRhPC90aXRsZT48ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz48ZGVmcz48L2RlZnM+PGcgaWQ9XFxcIlBhZ2UtMVxcXCIgc3Ryb2tlPVxcXCJub25lXFxcIiBzdHJva2Utd2lkdGg9XFxcIjFcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgc2tldGNoOnR5cGU9XFxcIk1TUGFnZVxcXCI+PGcgaWQ9XFxcIkNsaW1iLUxvZ28tQmV0YVxcXCIgc2tldGNoOnR5cGU9XFxcIk1TQXJ0Ym9hcmRHcm91cFxcXCIgZmlsbD1cXFwiIzE5Mzc0RFxcXCI+PGcgaWQ9XFxcImNsaS0tLS1iLnNvY2lhbC0rLVBhdGgtQ29weS0rLVR5cGUtc29tZXRoaW5nLUNvcHktQ29weS1Db3B5LUNvcHktQ29weVxcXCIgc2tldGNoOnR5cGU9XFxcIk1TTGF5ZXJHcm91cFxcXCIgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMjA2LjAwMDAwMCwgMjQ5LjAwMDAwMClcXFwiPjxnIGlkPVxcXCJjbGktLS0tYi5zb2NpYWwtKy1QYXRoLUNvcHlcXFwiIHNrZXRjaDp0eXBlPVxcXCJNU1NoYXBlR3JvdXBcXFwiPjxwYXRoIGQ9XFxcIk03MjMuMzc0MjA3LDE4Ny40NDIyMTEgTDc2Ny4wMjc2NDEsMzM3LjM4MzU3NSBDNzY3LjUxMDg4OSwzNDEuMjY1NTUyIDc3MS44NjAxMjQsMzQ1LjE0NzUyOSA3NzYuMjA5MzU5LDM0NS4xNDc1MjkgTDgzMy4yMzI2NjQsMzQ1LjE0NzUyOSBDODM5LjAzMTY0NCwzNDUuMTQ3NTI5IDg0My4zODA4NzksMzQwLjc4MDMwNSA4NDIuNDE0MzgzLDMzNC40NzIwOTIgTDczOS40ODI0ODUsOC4zODYwMTk4MiBDNzM4Ljk5OTIzNyw0LjAxODc5NTY0IDczNC42NTAwMDIsMC42MjIwNjU3MjggNzMwLjc4NDAxNSwwLjYyMjA2NTcyOCBMNzIzLjA1MjA0MSwwLjYyMjA2NTcyOCBDNzIwLjYzNTgsMC42MjIwNjU3MjggNzE2LjI4NjU2NSwyLjU2MzA1NDI1IDcxNC44MzY4Miw1LjQ3NDUzNzA0IEw2NDMuNTE0MzAyLDIwOS4wMTkwNjIgTDU3Ni40OTQwMDMsMTA1LjQzMTc4OCBDNTczLjcyMTA1OCwxMDEuMTQ1ODk1IDU2Ny4zNDI1MzksOTcuNjcxNDkxOSA1NjIuMjU1Niw5Ny42NzE0OTE5IEw1NTIuMTc5MDMzLDk3LjY3MTQ5MTkgQzU0Ny4wODgzMjYsOTcuNjcxNDkxOSA1NDEuNTI5Mzg0LDEwMS41NTg3NDkgNTM5Ljc3MDA2MSwxMDYuMzM0MTg3IEw0NTQuOTgwMDY4LDMzNi40ODQ4MzMgQzQ1My4yMTc0OSwzNDEuMjY5MTA4IDQ1NS45MjcwODYsMzQ1LjE0NzUyOSA0NjEuMDE0MTAyLDM0NS4xNDc1MjkgTDUyMi4xMzgwNjcsMzQ1LjE0NzUyOSBDNTI3LjIzMzE1LDM0NS4xNDc1MjkgNTMyLjc5MTA1NCwzNDEuMjYxNzMzIDUzNC41NTI3OTcsMzM2LjQ2NjE3MSBMNTcxLjQ3MzE0NCwyMzUuOTY2OTI0IEw2NDIuMTA4NTI4LDM0Ni4xMDc3MTIgQzY0My40ODcxNDEsMzQ4LjI1NzM2MyA2NDYuNjY3MDkyLDM1MCA2NDkuMjEyMzA3LDM1MCBMNjU5Ljk3MTQxMiwzNTAgQzY2Mi41MTYxMDgsMzUwIDY2NS4yODIwNDQsMzQ4LjA0NTA3OCA2NjYuMTQxOTgyLDM0NS42NTM5MTggTDY4My44MjcyNjEsMjk2LjQ3Nzg3MiBMNzIzLjM3NDIwNywxODcuNDQyMjExIFpcXFwiIGlkPVxcXCJQYXRoLUNvcHlcXFwiPjwvcGF0aD48cGF0aCBkPVxcXCJNMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBDMC4xNDUyMTM0NDEsMzA1LjIzNDA0IDQ5LjA4NzIzNzcsMzQ4Ljg0NTc0NSAxMDQuMzI4NzMsMzQ4Ljg0NTc0NSBDMTM5LjIxODA5NCwzNDguODQ1NzQ1IDE2NC40MTU5NjgsMzM1LjI3NzY1OSAxODIuMzQ1MjI0LDMwOC4xNDE0ODcgQzE4NS43MzcyNDYsMzAzLjI5NTc0MiAxODMuMzE0MzczLDI5OC40NDk5OTcgMTc4Ljk1MzIwMywyOTQuNTczNDAxIEwxNDkuODc4NzMzLDI2OS4zNzU1MjcgQzE0Ni45NzEyODYsMjY2Ljk1MjY1NSAxNDIuNjEwMTE2LDI2Ny45MjE4MDQgMTM5LjIxODA5NCwyNzEuMzEzODI1IEMxMzEuNDY0OTAyLDI3OS4wNjcwMTcgMTIzLjIyNzEzNiwyODYuMzM1NjM1IDEwNi4yNjcwMjgsMjg2LjMzNTYzNSBDODQuOTQ1NzUwNSwyODYuMzM1NjM1IDY4LjQ3MDIxNzYsMjY4Ljg5MDk1MyA2OC40NzAyMTc2LDI0Ny4wODUxMDEgQzY4LjQ3MDIxNzYsMjI1Ljc2MzgyMyA4NS45MTQ4OTk1LDIwNy44MzQ1NjYgMTA3LjIzNjE3NywyMDcuODM0NTY2IEMxMTguMzgxMzkxLDIwNy44MzQ1NjYgMTI4LjU1NzQ1NSwyMTMuMTY0ODg2IDEzNS4zNDE0OTgsMjIwLjQzMzUwMyBDMTM3Ljc2NDM3MSwyMjIuODU2Mzc2IDE0My41NzkyNjUsMjIzLjgyNTUyNSAxNDYuMDAyMTM3LDIyMS40MDI2NTIgTDE3NS4wNzY2MDcsMTkzLjc4MTkwNiBDMTc5LjQzNzc3NywxODkuOTA1MzEgMTgwLjg5MTUwMSwxODQuNTc0OTkgMTc3LjQ5OTQ4LDE4MC4yMTM4MiBDMTU5LjA4NTY0OSwxNTcuOTIzMzkzIDEzNS4zNDE0OTgsMTQ1LjMyNDQ1NiAxMDQuODEzMzA1LDE0NS4zMjQ0NTYgQzQ5LjU3MTgxMjIsMTQ1LjMyNDQ1NiAwLjE0NTIxMzQ0MSwxODkuOTA1MzEgMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBMMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBaIE0yMTguNjg4MzEyLDMzNC43OTMwODUgQzIxOC42ODgzMTIsMzM5LjYzODgzIDIyMy4wNDk0ODIsMzQ0IDIyNy44OTUyMjcsMzQ0IEwyODEuMTk4NDIyLDM0NCBDMjg2LjA0NDE2NywzNDQgMjkwLjQwNTMzNywzMzkuNjM4ODMgMjkwLjQwNTMzNywzMzQuNzkzMDg1IEwyOTAuNDA1MzM3LDE0LjAwNDc2NzIgQzI5MC40MDUzMzcsOS4xNTkwMjIyNiAyODYuMDQ0MTY3LDQuNzk3ODUxNzkgMjgxLjE5ODQyMiw0Ljc5Nzg1MTc5IEwyMjcuODk1MjI3LDQuNzk3ODUxNzkgQzIyMy4wNDk0ODIsNC43OTc4NTE3OSAyMTguNjg4MzEyLDkuMTU5MDIyMjYgMjE4LjY4ODMxMiwxNC4wMDQ3NjcyIEwyMTguNjg4MzEyLDMzNC43OTMwODUgWiBNMzc4LjExMzMyMSw5MS41MzY2ODY4IEMzOTkuNDM0NTk5LDkxLjUzNjY4NjggNDE2Ljg3OTI4MSw3NC41NzY1Nzk0IDQxNi44NzkyODEsNTMuMjU1MzAxNSBDNDE2Ljg3OTI4MSwzMS45MzQwMjM2IDM5OS40MzQ1OTksMTQuNDg5MzQxNyAzNzguMTEzMzIxLDE0LjQ4OTM0MTcgQzM1Ni43OTIwNDQsMTQuNDg5MzQxNyAzMzkuODMxOTM2LDMxLjkzNDAyMzYgMzM5LjgzMTkzNiw1My4yNTUzMDE1IEMzMzkuODMxOTM2LDc0LjU3NjU3OTQgMzU2Ljc5MjA0NCw5MS41MzY2ODY4IDM3OC4xMTMzMjEsOTEuNTM2Njg2OCBMMzc4LjExMzMyMSw5MS41MzY2ODY4IFogTTM0Mi43MzkzODMsMzM0Ljc5MzA4NSBDMzQyLjczOTM4MywzMzkuNjM4ODMgMzQ3LjEwMDU1NCwzNDQgMzUxLjk0NjI5OSwzNDQgTDQwNS4yNDk0OTMsMzQ0IEM0MTAuMDk1MjM4LDM0NCA0MTQuNDU2NDA5LDMzOS42Mzg4MyA0MTQuNDU2NDA5LDMzNC43OTMwODUgTDQxNC40NTY0MDksMTU5LjM3NzExNiBDNDE0LjQ1NjQwOSwxNTQuMDQ2Nzk3IDQxMC4wOTUyMzgsMTUwLjE3MDIwMSA0MDUuMjQ5NDkzLDE1MC4xNzAyMDEgTDM1MS45NDYyOTksMTUwLjE3MDIwMSBDMzQ3LjEwMDU1NCwxNTAuMTcwMjAxIDM0Mi43MzkzODMsMTU0LjA0Njc5NyAzNDIuNzM5MzgzLDE1OS4zNzcxMTYgTDM0Mi43MzkzODMsMzM0Ljc5MzA4NSBaIE04ODkuMTU0MzEsMzM0Ljc5MzA4NSBDODg5LjE1NDMxLDMzOS42Mzg4MyA4OTMuNTE1NDgxLDM0NCA4OTguMzYxMjI2LDM0NCBMOTIxLjEzNjIyNywzNDQgQzkyNS45ODE5NzIsMzQ0IDkyOS4zNzM5OTQsMzM5LjYzODgzIDkzMS4zMTIyOTIsMzM0LjMwODUxIEw5MzcuMTI3MTg1LDMxOC4zMTc1NTIgQzkzNy4xMjcxODUsMzE4LjMxNzU1MiA5NTkuNDE3NjEyLDM0OC44NDU3NDUgMTAwMi4wNjAxNywzNDguODQ1NzQ1IEMxMDU2LjgxNzA5LDM0OC44NDU3NDUgMTA5OC4wMDU5MiwzMDIuODExMTY4IDEwOTguMDA1OTIsMjQ3LjA4NTEwMSBDMTA5OC4wMDU5MiwxNzguNzYwMDk2IDEwNTMuNDI1MDYsMTQ1LjMyNDQ1NiAxMDAxLjU3NTU5LDE0NS4zMjQ0NTYgQzk4NS4xMDAwNjEsMTQ1LjMyNDQ1NiA5NjcuMTcwODA0LDE1MS4xMzkzNSA5NjEuMzU1OTEsMTU0LjUzMTM3MSBMOTYxLjM1NTkxLDE0LjAwNDc2NzIgQzk2MS4zNTU5MSw5LjE1OTAyMjI2IDk1Ni45OTQ3NCw0Ljc5Nzg1MTc5IDk1Mi4xNDg5OTUsNC43OTc4NTE3OSBMODk4LjM2MTIyNiw0Ljc5Nzg1MTc5IEM4OTMuNTE1NDgxLDQuNzk3ODUxNzkgODg5LjE1NDMxLDkuMTU5MDIyMjYgODg5LjE1NDMxLDE0LjAwNDc2NzIgTDg4OS4xNTQzMSwzMzQuNzkzMDg1IFogTTk1My42MDI3MTgsMjQ2LjYwMDUyNiBDOTUzLjYwMjcxOCwyMjQuNzk0Njc0IDk3MC4wNzgyNTEsMjA3LjgzNDU2NiA5OTIuMzY4Njc4LDIwNy44MzQ1NjYgQzEwMTQuNjU5MTEsMjA3LjgzNDU2NiAxMDMxLjYxOTIxLDIyNC43OTQ2NzQgMTAzMS42MTkyMSwyNDYuNjAwNTI2IEMxMDMxLjYxOTIxLDI2OC44OTA5NTMgMTAxNC42NTkxMSwyODYuMzM1NjM1IDk5Mi4zNjg2NzgsMjg2LjMzNTYzNSBDOTcwLjA3ODI1MSwyODYuMzM1NjM1IDk1My42MDI3MTgsMjY4Ljg5MDk1MyA5NTMuNjAyNzE4LDI0Ni42MDA1MjYgTDk1My42MDI3MTgsMjQ2LjYwMDUyNiBaIE0xMTM0LjI1NjQ1LDMyMS4yMjQ5OTkgQzExMzQuMjU2NDUsMzM2LjI0NjgwOCAxMTQ2Ljg1NTM5LDM0OC44NDU3NDUgMTE2MS44NzcyLDM0OC44NDU3NDUgQzExNzcuMzgzNTgsMzQ4Ljg0NTc0NSAxMTg5LjQ5Nzk1LDMzNi4yNDY4MDggMTE4OS40OTc5NSwzMjEuMjI0OTk5IEMxMTg5LjQ5Nzk1LDMwNS43MTg2MTUgMTE3Ny4zODM1OCwyOTMuNjA0MjUyIDExNjEuODc3MiwyOTMuNjA0MjUyIEMxMTQ2Ljg1NTM5LDI5My42MDQyNTIgMTEzNC4yNTY0NSwzMDUuNzE4NjE1IDExMzQuMjU2NDUsMzIxLjIyNDk5OSBMMTEzNC4yNTY0NSwzMjEuMjI0OTk5IFogTTEyMzYuMDE3MSwzMzIuODU0Nzg3IEMxMjQ1LjcwODU5LDM0MC42MDc5NzkgMTI2OS45MzczMSwzNDguODQ1NzQ1IDEzMDEuOTE5MjMsMzQ4Ljg0NTc0NSBDMTM1Ni42NzYxNSwzNDguODQ1NzQ1IDEzODMuODEyMzIsMzIxLjIyNDk5OSAxMzgzLjgxMjMyLDI4Ny4zMDQ3ODQgQzEzODMuODEyMzIsMjQ4LjUzODgyNCAxMzU2LjY3NjE1LDIzMy4wMzI0NCAxMzE3LjQyNTYxLDIxOS40NjQzNTQgQzEzMDAuOTUwMDgsMjEzLjY0OTQ2IDEyOTUuNjE5NzYsMjA4LjgwMzcxNSAxMjk1LjYxOTc2LDIwMy45NTc5NyBDMTI5NS42MTk3NiwxOTguNjI3NjUxIDEyOTkuOTgwOTMsMTk3LjE3MzkyNyAxMzA2LjI4MDQsMTk3LjE3MzkyNyBDMTMyNS4xNzg4LDE5Ny4xNzM5MjcgMTM0Ny40NjkyMywyMDguMzE5MTQxIDEzNDcuNDY5MjMsMjA4LjMxOTE0MSBDMTM1MS4zNDU4MywyMDkuNzcyODY0IDEzNTYuMTkxNTcsMjA4LjMxOTE0MSAxMzU3LjY0NTMsMjA1LjQxMTY5NCBMMTM3NS41NzQ1NSwxNzIuNDYwNjI4IEMxMzc4LjQ4MiwxNjcuNjE0ODgzIDEzNzUuMDg5OTgsMTYzLjI1MzcxMiAxMzcwLjcyODgxLDE2MC4zNDYyNjUgQzEzNjAuMDY4MTcsMTUzLjU2MjIyMyAxMzM2LjgwODU5LDE0NS4zMjQ0NTYgMTMwNi4yODA0LDE0NS4zMjQ0NTYgQzEyNTMuOTQ2MzUsMTQ1LjMyNDQ1NiAxMjMwLjY4Njc4LDE3MS40OTE0NzkgMTIzMC42ODY3OCwyMDMuOTU3OTcgQzEyMzAuNjg2NzgsMjM0LjAwMTU4OSAxMjQ3LjE2MjMxLDI1NS44MDc0NDEgMTI4NC45NTkxMiwyNjguODkwOTUzIEMxMzA5LjY3MjQyLDI3Ny42MTMyOTQgMTMxMi41Nzk4NywyODQuMzk3MzM3IDEzMTIuNTc5ODcsMjg5LjI0MzA4MiBDMTMxMi41Nzk4NywyOTUuMDU3OTc2IDEzMDguMjE4NywyOTcuOTY1NDIzIDEzMDMuMzcyOTUsMjk3Ljk2NTQyMyBDMTI4Mi41MzYyNSwyOTcuOTY1NDIzIDEyNTkuNzYxMjUsMjg1LjM2NjQ4NiAxMjU5Ljc2MTI1LDI4NS4zNjY0ODYgQzEyNTUuODg0NjUsMjgzLjQyODE4OCAxMjUxLjAzODkxLDI4Ni4zMzU2MzUgMTI0OS41ODUxOCwyODkuMjQzMDgyIEwxMjMyLjYyNTA4LDMyMi42Nzg3MjIgQzEyMzAuMjAyMiwzMjcuMDM5ODkzIDEyMzIuNjI1MDgsMzI5Ljk0NzM0IDEyMzYuMDE3MSwzMzIuODU0Nzg3IEwxMjM2LjAxNzEsMzMyLjg1NDc4NyBaIE0xNDA3LjU1NjQ3LDI0Ni42MDA1MjYgQzE0MDcuNTU2NDcsMzAyLjMyNjU5MyAxNDUzLjEwNjQ3LDM0OC44NDU3NDUgMTUwOC4zNDc5NiwzNDguODQ1NzQ1IEMxNTYzLjU4OTQ2LDM0OC44NDU3NDUgMTYwOS4xMzk0NiwzMDIuMzI2NTkzIDE2MDkuMTM5NDYsMjQ2LjYwMDUyNiBDMTYwOS4xMzk0NiwxOTEuODQzNjA4IDE1NjMuNTg5NDYsMTQ1LjMyNDQ1NiAxNTA4LjM0Nzk2LDE0NS4zMjQ0NTYgQzE0NTMuMTA2NDcsMTQ1LjMyNDQ1NiAxNDA3LjU1NjQ3LDE5MS44NDM2MDggMTQwNy41NTY0NywyNDYuNjAwNTI2IEwxNDA3LjU1NjQ3LDI0Ni42MDA1MjYgWiBNMTQ3MC4wNjY1OCwyNDYuNjAwNTI2IEMxNDcwLjA2NjU4LDIyNS4yNzkyNDggMTQ4Ny4wMjY2OSwyMDcuODM0NTY2IDE1MDguMzQ3OTYsMjA3LjgzNDU2NiBDMTUyOS42NjkyNCwyMDcuODM0NTY2IDE1NDYuNjI5MzUsMjI1LjI3OTI0OCAxNTQ2LjYyOTM1LDI0Ni42MDA1MjYgQzE1NDYuNjI5MzUsMjY4LjQwNjM3OCAxNTI5LjY2OTI0LDI4Ni4zMzU2MzUgMTUwOC4zNDc5NiwyODYuMzM1NjM1IEMxNDg3LjAyNjY5LDI4Ni4zMzU2MzUgMTQ3MC4wNjY1OCwyNjguNDA2Mzc4IDE0NzAuMDY2NTgsMjQ2LjYwMDUyNiBMMTQ3MC4wNjY1OCwyNDYuNjAwNTI2IFogTTE2MzEuNDI5ODksMjQ3LjA4NTEwMSBDMTYzMS40Mjk4OSwzMDUuMjM0MDQgMTY4MC4zNzE5MSwzNDguODQ1NzQ1IDE3MzUuNjEzNCwzNDguODQ1NzQ1IEMxNzcwLjUwMjc3LDM0OC44NDU3NDUgMTc5NS43MDA2NCwzMzUuMjc3NjU5IDE4MTMuNjI5OSwzMDguMTQxNDg3IEMxODE3LjAyMTkyLDMwMy4yOTU3NDIgMTgxNC41OTkwNSwyOTguNDQ5OTk3IDE4MTAuMjM3ODgsMjk0LjU3MzQwMSBMMTc4MS4xNjM0MSwyNjkuMzc1NTI3IEMxNzc4LjI1NTk2LDI2Ni45NTI2NTUgMTc3My44OTQ3OSwyNjcuOTIxODA0IDE3NzAuNTAyNzcsMjcxLjMxMzgyNSBDMTc2Mi43NDk1OCwyNzkuMDY3MDE3IDE3NTQuNTExODEsMjg2LjMzNTYzNSAxNzM3LjU1MTcsMjg2LjMzNTYzNSBDMTcxNi4yMzA0MiwyODYuMzM1NjM1IDE2OTkuNzU0ODksMjY4Ljg5MDk1MyAxNjk5Ljc1NDg5LDI0Ny4wODUxMDEgQzE2OTkuNzU0ODksMjI1Ljc2MzgyMyAxNzE3LjE5OTU3LDIwNy44MzQ1NjYgMTczOC41MjA4NSwyMDcuODM0NTY2IEMxNzQ5LjY2NjA2LDIwNy44MzQ1NjYgMTc1OS44NDIxMywyMTMuMTY0ODg2IDE3NjYuNjI2MTcsMjIwLjQzMzUwMyBDMTc2OS4wNDkwNCwyMjIuODU2Mzc2IDE3NzQuODYzOTQsMjIzLjgyNTUyNSAxNzc3LjI4NjgxLDIyMS40MDI2NTIgTDE4MDYuMzYxMjgsMTkzLjc4MTkwNiBDMTgxMC43MjI0NSwxODkuOTA1MzEgMTgxMi4xNzYxNywxODQuNTc0OTkgMTgwOC43ODQxNSwxODAuMjEzODIgQzE3OTAuMzcwMzIsMTU3LjkyMzM5MyAxNzY2LjYyNjE3LDE0NS4zMjQ0NTYgMTczNi4wOTc5OCwxNDUuMzI0NDU2IEMxNjgwLjg1NjQ5LDE0NS4zMjQ0NTYgMTYzMS40Mjk4OSwxODkuOTA1MzEgMTYzMS40Mjk4OSwyNDcuMDg1MTAxIEwxNjMxLjQyOTg5LDI0Ny4wODUxMDEgWiBNMTg4NS4zNDY5Miw5MS41MzY2ODY4IEMxOTA2LjY2ODIsOTEuNTM2Njg2OCAxOTI0LjExMjg4LDc0LjU3NjU3OTQgMTkyNC4xMTI4OCw1My4yNTUzMDE1IEMxOTI0LjExMjg4LDMxLjkzNDAyMzYgMTkwNi42NjgyLDE0LjQ4OTM0MTcgMTg4NS4zNDY5MiwxNC40ODkzNDE3IEMxODY0LjAyNTY1LDE0LjQ4OTM0MTcgMTg0Ny4wNjU1NCwzMS45MzQwMjM2IDE4NDcuMDY1NTQsNTMuMjU1MzAxNSBDMTg0Ny4wNjU1NCw3NC41NzY1Nzk0IDE4NjQuMDI1NjUsOTEuNTM2Njg2OCAxODg1LjM0NjkyLDkxLjUzNjY4NjggTDE4ODUuMzQ2OTIsOTEuNTM2Njg2OCBaIE0xODQ5Ljk3Mjk5LDMzNC43OTMwODUgQzE4NDkuOTcyOTksMzM5LjYzODgzIDE4NTQuMzM0MTYsMzQ0IDE4NTkuMTc5OSwzNDQgTDE5MTIuNDgzMSwzNDQgQzE5MTcuMzI4ODQsMzQ0IDE5MjEuNjkwMDEsMzM5LjYzODgzIDE5MjEuNjkwMDEsMzM0Ljc5MzA4NSBMMTkyMS42OTAwMSwxNTkuMzc3MTE2IEMxOTIxLjY5MDAxLDE1NC4wNDY3OTcgMTkxNy4zMjg4NCwxNTAuMTcwMjAxIDE5MTIuNDgzMSwxNTAuMTcwMjAxIEwxODU5LjE3OTksMTUwLjE3MDIwMSBDMTg1NC4zMzQxNiwxNTAuMTcwMjAxIDE4NDkuOTcyOTksMTU0LjA0Njc5NyAxODQ5Ljk3Mjk5LDE1OS4zNzcxMTYgTDE4NDkuOTcyOTksMzM0Ljc5MzA4NSBaIE0xOTYwLjk0MDU1LDI4NC44ODE5MTEgQzE5NjAuOTQwNTUsMzIzLjE2MzI5NyAxOTg5LjUzMDQ0LDM0OC44NDU3NDUgMjAyNy44MTE4MywzNDguODQ1NzQ1IEMyMDU4LjM0MDAyLDM0OC44NDU3NDUgMjA3NS4zMDAxMywzMzQuNzkzMDg1IDIwODYuNDQ1MzQsMzI0LjYxNzAyIEwyMDkzLjIyOTM4LDMzNy43MDA1MzIgQzIwOTUuNjUyMjYsMzQzLjAzMDg1MSAyMDk5LjA0NDI4LDM0NCAyMTAxLjk1MTcyLDM0NCBMMjEyMy4yNzMsMzQ0IEMyMTI4LjExODc1LDM0NCAyMTMyLjQ3OTkyLDMzOS42Mzg4MyAyMTMyLjQ3OTkyLDMzNC43OTMwODUgTDIxMzIuNDc5OTIsMjI3LjcwMjEyMSBDMjEzMi40Nzk5MiwxNzAuNTIyMzMgMjExMC42NzQwNywxNDUuMzI0NDU2IDIwNTAuNTg2ODMsMTQ1LjMyNDQ1NiBDMjAyNC40MTk4LDE0NS4zMjQ0NTYgMTk5MC40OTk1OSwxNTEuMTM5MzUgMTk4Ni4xMzg0MiwxNTIuNTkzMDc0IEMxOTgxLjc3NzI1LDE1NC4wNDY3OTcgMTk3Ny40MTYwOCwxNTcuNDM4ODE4IDE5NzguODY5OCwxNjUuNjc2NTg1IEwxOTgzLjIzMDk3LDE5Ni4yMDQ3NzggQzE5ODQuMjAwMTIsMjAzLjQ3MzM5NiAxOTg3LjU5MjE0LDIwOC44MDM3MTUgMTk5NC44NjA3NiwyMDYuMzgwODQzIEMyMDA3LjQ1OTcsMjAyLjUwNDI0NyAyMDMwLjIzNDcsMTk5LjExMjIyNSAyMDQzLjMxODIxLDE5OS4xMTIyMjUgQzIwNjYuNTc3NzksMTk5LjExMjIyNSAyMDY5LjQ4NTIzLDIwOC44MDM3MTUgMjA2OS40ODUyMywyMjcuNzAyMTIxIEMyMDY5LjQ4NTIzLDIyNy43MDIxMjEgMjA1My45Nzg4NSwyMTkuOTQ4OTI5IDIwMzIuMTczLDIxOS45NDg5MjkgQzE5ODguMDc2NzIsMjE5Ljk0ODkyOSAxOTYwLjk0MDU1LDI0Ny41Njk2NzUgMTk2MC45NDA1NSwyODQuODgxOTExIEwxOTYwLjk0MDU1LDI4NC44ODE5MTEgWiBNMjAyMy45MzUyMywyODAuMDM2MTY2IEMyMDIzLjkzNTIzLDI2OC44OTA5NTMgMjAzMy4xNDIxNSwyNTkuNjg0MDM3IDIwNDQuNzcxOTMsMjU5LjY4NDAzNyBDMjA1Ni40MDE3MiwyNTkuNjg0MDM3IDIwNjUuNjA4NjQsMjY4Ljg5MDk1MyAyMDY2LjA5MzIxLDI4MC4wMzYxNjYgQzIwNjYuMDkzMjEsMjkxLjY2NTk1NCAyMDU2LjQwMTcyLDMwMS4zNTc0NDQgMjA0NC43NzE5MywzMDEuMzU3NDQ0IEMyMDMzLjE0MjE1LDMwMS4zNTc0NDQgMjAyMy45MzUyMywyOTEuNjY1OTU0IDIwMjMuOTM1MjMsMjgwLjAzNjE2NiBMMjAyMy45MzUyMywyODAuMDM2MTY2IFogTTIxODEuOTA2NTIsMzM0Ljc5MzA4NSBDMjE4MS45MDY1MiwzMzkuNjM4ODMgMjE4Ni4yNjc2OSwzNDQgMjE5MS4xMTM0MywzNDQgTDIyNDQuNDE2NjMsMzQ0IEMyMjQ5LjI2MjM3LDM0NCAyMjUzLjYyMzU0LDMzOS42Mzg4MyAyMjUzLjYyMzU0LDMzNC43OTMwODUgTDIyNTMuNjIzNTQsMTQuMDA0NzY3MiBDMjI1My42MjM1NCw5LjE1OTAyMjI2IDIyNDkuMjYyMzcsNC43OTc4NTE3OSAyMjQ0LjQxNjYzLDQuNzk3ODUxNzkgTDIxOTEuMTEzNDMsNC43OTc4NTE3OSBDMjE4Ni4yNjc2OSw0Ljc5Nzg1MTc5IDIxODEuOTA2NTIsOS4xNTkwMjIyNiAyMTgxLjkwNjUyLDE0LjAwNDc2NzIgTDIxODEuOTA2NTIsMzM0Ljc5MzA4NSBaXFxcIiBpZD1cXFwiY2xpLS0tLWIuc29jaWFsXFxcIj48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPlwiXG5cbi8qKiovIH0sXG4vKiAzOCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHtcclxuXHRcdGlmKCFtb2R1bGUud2VicGFja1BvbHlmaWxsKSB7XHJcblx0XHRcdG1vZHVsZS5kZXByZWNhdGUgPSBmdW5jdGlvbigpIHt9O1xyXG5cdFx0XHRtb2R1bGUucGF0aHMgPSBbXTtcclxuXHRcdFx0Ly8gbW9kdWxlLnBhcmVudCA9IHVuZGVmaW5lZCBieSBkZWZhdWx0XHJcblx0XHRcdG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0XHRtb2R1bGUud2VicGFja1BvbHlmaWxsID0gMTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBtb2R1bGU7XHJcblx0fVxyXG5cblxuLyoqKi8gfSxcbi8qIDM5ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMzlfXztcblxuLyoqKi8gfVxuLyoqKioqKi8gXSlcbn0pO1xuO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHJlYWN0LWNsaW1iLXNvY2lhbC5taW4uanNcbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCIvXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL2Jvb3RzdHJhcCBhNDJlZjI1YTRjZDcyN2ZjMjI0NFxuICoqLyIsImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJztcblxuaW1wb3J0IFdhbGxDb250YWluZXIgZnJvbSAnLi9jb21wb25lbnRzL3dhbGwvV2FsbENvbnRhaW5lcic7XG5pbXBvcnQgU2xpZGVzaG93Q29udGFpbmVyIGZyb20gJy4vY29tcG9uZW50cy9zbGlkZXNob3cvU2xpZGVzaG93Q29udGFpbmVyJztcblxuaW1wb3J0ICcuL3N0eWxlL21haW4uc2Nzcyc7XG5cbmlmICh3aW5kb3cpIHtcbiAgICB3aW5kb3cuQ2xpbWIgPSB3aW5kb3cuQ2xpbWIgfHwge307XG5cbiAgICBjb25zdCAkd2FsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2xpbWItd2FsbCcpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAkd2FsbHMubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgY29uc3QgJGl0ZW0gPSAkd2FsbHNbaV07XG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb25JZCA9ICRpdGVtLmRhdGFzZXQuY29sbGVjdGlvbklkO1xuICAgICAgICBjb25zdCBsaW1pdCA9ICRpdGVtLmRhdGFzZXQubGltaXQ7XG5cbiAgICAgICAgUmVhY3RET00ucmVuZGVyKFxuICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChXYWxsQ29udGFpbmVyLCB7Y29sbGVjdGlvbklkLCBsaW1pdH0pLFxuICAgICAgICAgICAgJGl0ZW1cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCAkc2xpZGVzaG93cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbGltYi1zbGlkZXNob3cnKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgJHNsaWRlc2hvd3MubGVuZ3RoOyArK2kpIHtcbiAgICAgICAgY29uc3QgJGl0ZW0gPSAkc2xpZGVzaG93c1tpXTtcbiAgICAgICAgY29uc3QgY29sbGVjdGlvbklkID0gJGl0ZW0uZGF0YXNldC5jb2xsZWN0aW9uSWQ7XG4gICAgICAgIGNvbnN0IGRlbGF5ID0gcGFyc2VJbnQoJGl0ZW0uZGF0YXNldC5kZWxheSwgMCk7XG5cbiAgICAgICAgUmVhY3RET00ucmVuZGVyKFxuICAgICAgICAgICAgUmVhY3QuY3JlYXRlRWxlbWVudChTbGlkZXNob3dDb250YWluZXIsIHtjb2xsZWN0aW9uSWQsIGRlbGF5fSksXG4gICAgICAgICAgICAkaXRlbVxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IHtXYWxsQ29udGFpbmVyfTtcbmV4cG9ydCB7V2FsbH0gZnJvbSAnLi9jb21wb25lbnRzL3dhbGwvV2FsbCc7XG5leHBvcnQge1RpbGV9IGZyb20gJy4vY29tcG9uZW50cy93YWxsL1RpbGUnO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvaW5kZXguanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMV9fO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwge1wicm9vdFwiOlwiUmVhY3RcIixcImNvbW1vbmpzMlwiOlwicmVhY3RcIixcImNvbW1vbmpzXCI6XCJyZWFjdFwiLFwiYW1kXCI6XCJyZWFjdFwifVxuICoqIG1vZHVsZSBpZCA9IDFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3JlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcblxudmFyIF9yZWFjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZWFjdCk7XG5cbnZhciBfY29tcG9uZW50czIgPSByZXF1aXJlKCcuL2NvbXBvbmVudHMnKTtcblxudmFyIF9jb21wb25lbnRzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2NvbXBvbmVudHMyKTtcblxudmFyIF9yZW9yZGVyS2V5cyA9IHJlcXVpcmUoJy4vcmVvcmRlcktleXMnKTtcblxudmFyIF9yZW9yZGVyS2V5czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW9yZGVyS2V5cyk7XG5cbnZhciBfY29tcG9uZW50cyA9IF9jb21wb25lbnRzM1snZGVmYXVsdCddKF9yZWFjdDJbJ2RlZmF1bHQnXSk7XG5cbnZhciBTcHJpbmcgPSBfY29tcG9uZW50cy5TcHJpbmc7XG52YXIgVHJhbnNpdGlvblNwcmluZyA9IF9jb21wb25lbnRzLlRyYW5zaXRpb25TcHJpbmc7XG52YXIgTW90aW9uID0gX2NvbXBvbmVudHMuTW90aW9uO1xudmFyIFN0YWdnZXJlZE1vdGlvbiA9IF9jb21wb25lbnRzLlN0YWdnZXJlZE1vdGlvbjtcbnZhciBUcmFuc2l0aW9uTW90aW9uID0gX2NvbXBvbmVudHMuVHJhbnNpdGlvbk1vdGlvbjtcbmV4cG9ydHMuU3ByaW5nID0gU3ByaW5nO1xuZXhwb3J0cy5UcmFuc2l0aW9uU3ByaW5nID0gVHJhbnNpdGlvblNwcmluZztcbmV4cG9ydHMuTW90aW9uID0gTW90aW9uO1xuZXhwb3J0cy5TdGFnZ2VyZWRNb3Rpb24gPSBTdGFnZ2VyZWRNb3Rpb247XG5leHBvcnRzLlRyYW5zaXRpb25Nb3Rpb24gPSBUcmFuc2l0aW9uTW90aW9uO1xuXG52YXIgX3NwcmluZzIgPSByZXF1aXJlKCcuL3NwcmluZycpO1xuXG52YXIgX3NwcmluZzMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zcHJpbmcyKTtcblxuZXhwb3J0cy5zcHJpbmcgPSBfc3ByaW5nM1snZGVmYXVsdCddO1xuXG52YXIgX3ByZXNldHMyID0gcmVxdWlyZSgnLi9wcmVzZXRzJyk7XG5cbnZhciBfcHJlc2V0czMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wcmVzZXRzMik7XG5cbmV4cG9ydHMucHJlc2V0cyA9IF9wcmVzZXRzM1snZGVmYXVsdCddO1xudmFyIHV0aWxzID0ge1xuICByZW9yZGVyS2V5czogX3Jlb3JkZXJLZXlzMlsnZGVmYXVsdCddXG59O1xuZXhwb3J0cy51dGlscyA9IHV0aWxzO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvcmVhY3QtbW90aW9uLmpzXG4gKiogbW9kdWxlIGlkID0gMlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50LCBQcm9wVHlwZXN9IGZyb20gJ3JlYWN0JztcblxuXG5jbGFzcyBBdXRob3IgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgbGluazogUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgICAgcGljdHVyZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgICBuYW1lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIHVzZXJuYW1lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcbiAgICB9O1xuXG4gICAgcmVuZGVyKCkge1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8YSBjbGFzc05hbWU9XCJjbGltYl9fYXV0aG9yXCJcbiAgICAgICAgICAgICAgIGhyZWY9eyB0aGlzLnByb3BzLmxpbmsgfT5cblxuICAgICAgICAgICAgICAgIDxpbWcgaGVpZ2h0PVwiMzRcIlxuICAgICAgICAgICAgICAgICAgICAgd2lkdGg9XCIzNFwiXG4gICAgICAgICAgICAgICAgICAgICBzcmM9eyB0aGlzLnByb3BzLnBpY3R1cmV9XG4gICAgICAgICAgICAgICAgICAgICBhbHQ9eyBgUHJvZmlsZSBwaWMgb2YgJHt0aGlzLnByb3BzLm5hbWV9YCB9Lz5cblxuICAgICAgICAgICAgICAgIDxoNCBjbGFzc05hbWU9XCJjbGltYl9fdGlsZV9fYXV0aG9yX191c2VybmFtZVwiPlxuICAgICAgICAgICAgICAgICAgICB7IHRoaXMucHJvcHMudXNlcm5hbWUgfVxuICAgICAgICAgICAgICAgIDwvaDQ+XG4gICAgICAgICAgICA8L2E+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBdXRob3I7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL2NvbW1vbi9BdXRob3IuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuXG5jbGFzcyBJbWFnZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8aW1nIGNsYXNzTmFtZT1cImNsaW1iX19pbWFnZVwiXG4gICAgICAgICAgICAgICAgIHNyYz17IHRoaXMucHJvcHMuc3JjIH0gZGF0YS13aWR0aD17IHRoaXMucHJvcHMud2lkdGggfSBkYXRhLWhlaWdodD17IHRoaXMucHJvcHMuaGVpZ2h0IH0vPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuSW1hZ2UucHJvcFR5cGVzID0ge1xuICAgIHNyYzogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIHdpZHRoOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLFxuICAgIGhlaWdodDogUmVhY3QuUHJvcFR5cGVzLm51bWJlclxufTtcblxuZXhwb3J0IGRlZmF1bHQgSW1hZ2U7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL2NvbW1vbi9JbWFnZS5qc3hcbiAqKi8iLCJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5cbmNsYXNzIE1lc3NhZ2UgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuXG4gICAgcmVuZGVyKCkge1xuXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLnByb3BzLmJvZHlcbiAgICAgICAgICAgIC5yZXBsYWNlKC88YSBocmVmPVwiaHR0cDpcXC9cXC9waWMudHdpdHRlci5jb21cXC9bXj5dKj4oW148XSspPFxcL2E+L2csICcnKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjbGltYl9fbWVzc2FnZVwiXG4gICAgICAgICAgICAgICAgIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MPXt7X19odG1sOiBtZXNzYWdlfX0+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbk1lc3NhZ2UucHJvcFR5cGVzID0ge1xuICAgIGJvZHk6IFJlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxufTtcblxuZXhwb3J0IGRlZmF1bHQgTWVzc2FnZTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvY29tbW9uL01lc3NhZ2UuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBJbWFnZSBmcm9tICcuLy4uL2NvbW1vbi9JbWFnZSc7XG5pbXBvcnQgTWVzc2FnZSBmcm9tICcuLy4uL2NvbW1vbi9NZXNzYWdlJztcbmltcG9ydCBBdXRob3IgZnJvbSAnLi8uLi9jb21tb24vQXV0aG9yJztcblxuXG5jbGFzcyBUaWxlIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG5cbiAgICBjcmVhdGVJbWFnZSgpIHtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pbWFnZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3Qge3VybDogc3JjLCB3aWR0aCwgaGVpZ2h0fSA9IHRoaXMucHJvcHMuaW1hZ2U7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxJbWFnZSBzcmM9eyBzcmMgfVxuICAgICAgICAgICAgICAgICAgICAgICB3aWR0aD17IHdpZHRoIH1cbiAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXsgaGVpZ2h0IH0vPlxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjcmVhdGVNZXNzYWdlKCkge1xuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLm1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPE1lc3NhZ2UgYm9keT17IHRoaXMucHJvcHMubWVzc2FnZSB9Lz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY3JlYXRlQ2xhc3NTdHJpbmcoKSB7XG5cbiAgICAgICAgbGV0IGNsYXNzU3RyaW5nID0gYGNsaW1iX190aWxlIGNsaW1iX190aWxlLS0ke3RoaXMucHJvcHMuc291cmNlX3R5cGV9YDtcblxuICAgICAgICBpZiAodGhpcy5wcm9wcy5pbWFnZSkge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW1lZGlhIGNsaW1iX190aWxlLS1oYXMtaW1hZ2UnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW5vLWltYWdlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLnZpZGVvX3VybCkge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW1lZGlhIGNsaW1iX190aWxlLS1oYXMtdmlkZW8nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYl9fdGlsZS0taGFzLW5vLXZpZGVvJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjbGFzc1N0cmluZztcbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG5cbiAgICAgICAgY29uc3QgaW1hZ2UgPSB0aGlzLmNyZWF0ZUltYWdlKCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmNyZWF0ZU1lc3NhZ2UoKTtcbiAgICAgICAgY29uc3QgY2xhc3NTdHJpbmcgPSB0aGlzLmNyZWF0ZUNsYXNzU3RyaW5nKCk7XG4gICAgICAgIGNvbnN0IHthdXRob3J9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9eyBjbGFzc1N0cmluZyB9XG4gICAgICAgICAgICAgICAgIHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfT5cblxuICAgICAgICAgICAgICAgIDxhIGhyZWY9eyB0aGlzLnByb3BzLmxpbmsgfT5cbiAgICAgICAgICAgICAgICAgICAgeyBpbWFnZSB9XG4gICAgICAgICAgICAgICAgPC9hPlxuXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjbGltYl9fdGlsZV9fY29udGVudFwiPlxuICAgICAgICAgICAgICAgICAgICB7IG1lc3NhZ2UgfVxuXG4gICAgICAgICAgICAgICAgICAgIDxBdXRob3Igey4uLmF1dGhvcn0gLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuXG5UaWxlLnByb3BUeXBlcyA9IHtcblxuICAgIC8vIFJlcXVpcmVkIGF0dHJzXG4gICAgbGluazogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIHNvdXJjZV90eXBlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgdGltZXN0YW1wOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgYXV0aG9yOiBSZWFjdC5Qcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICB1c2VybmFtZTogUmVhY3QuUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgICBwaWN0dXJlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIGxpbms6IFJlYWN0LlByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuICAgIH0pLFxuXG4gICAgLy8gT3B0aW9uYWwgYXR0cnNcbiAgICBtZXNzYWdlOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLFxuICAgIHZpZGVvX3NyYzogUmVhY3QuUHJvcFR5cGVzLnN0cmluZyxcbiAgICBpbWFnZTogUmVhY3QuUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgdXJsOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIHdpZHRoOiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgICAgIGhlaWdodDogUmVhY3QuUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkXG4gICAgfSlcblxufTtcblxuZXhwb3J0IGRlZmF1bHQgVGlsZTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvd2FsbC9UaWxlLmpzeFxuICoqLyIsImltcG9ydCBSZWFjdCwge0NvbXBvbmVudCwgUHJvcFR5cGVzfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgVGlsZSBmcm9tICcuL1RpbGUnO1xuaW1wb3J0IHtUcmFuc2l0aW9uTW90aW9uLCBzcHJpbmd9IGZyb20gJ3JlYWN0LW1vdGlvbic7XG5cblxuY2xhc3MgV2FsbCBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBpdGVtczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIGdldFN0eWxlcygpIHtcbiAgICAgICAgY29uc3QgY29uZmlncyA9IHt9O1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnByb3BzLml0ZW1zKS5tYXAoa2V5ID0+IHtcbiAgICAgICAgICAgIGNvbmZpZ3Nba2V5XSA9IHtcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiBzcHJpbmcoMSksXG4gICAgICAgICAgICAgICAgd2lkdGg6IHNwcmluZygzMCksXG4gICAgICAgICAgICAgICAgbWFyZ2luOiBzcHJpbmcoMSksXG4gICAgICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvbmZpZ3M7XG4gICAgfVxuXG4gICAgd2lsbEVudGVyKGtleSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgb3BhY2l0eTogc3ByaW5nKDApLFxuICAgICAgICAgICAgd2lkdGg6IHNwcmluZygwKSxcbiAgICAgICAgICAgIG1hcmdpbjogc3ByaW5nKDApLFxuICAgICAgICAgICAgaXRlbTogdGhpcy5wcm9wcy5pdGVtc1trZXldXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgd2lsbExlYXZlKGtleSwgc3R5bGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG9wYWNpdHk6IHNwcmluZygwKSxcbiAgICAgICAgICAgIHdpZHRoOiBzcHJpbmcoMCksXG4gICAgICAgICAgICBtYXJnaW46IHNwcmluZygwKSxcbiAgICAgICAgICAgIGl0ZW06IHN0eWxlLml0ZW1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZW5kZXJUaWxlKGtleSwgaXRlbVZhbHVlcykge1xuXG4gICAgICAgIGNvbnN0IHtpdGVtLCAuLi5zdHlsZUNvbmZpZ30gPSBpdGVtVmFsdWVzO1xuICAgICAgICBjb25zdCB7Li4uaXRlbVByb3BzfSA9IGl0ZW07XG5cbiAgICAgICAgY29uc3Qgc3R5bGUgPSB7XG4gICAgICAgICAgICBvcGFjaXR5OiBzdHlsZUNvbmZpZy5vcGFjaXR5LFxuICAgICAgICAgICAgd2lkdGg6IGAke3N0eWxlQ29uZmlnLndpZHRofSVgLFxuICAgICAgICAgICAgbWFyZ2luTGVmdDogYCR7c3R5bGVDb25maWcubWFyZ2lufSVgLFxuICAgICAgICAgICAgbWFyZ2luUmlnaHQ6IGAke3N0eWxlQ29uZmlnLm1hcmdpbn0lYFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8VGlsZSBrZXk9e2tleX1cbiAgICAgICAgICAgICAgICAgIHN0eWxlPXtzdHlsZX1cbiAgICAgICAgICAgICAgICB7Li4uaXRlbVByb3BzIH0gLz5cbiAgICAgICAgKTtcblxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxUcmFuc2l0aW9uTW90aW9uXG4gICAgICAgICAgICAgICAgc3R5bGVzPXt0aGlzLmdldFN0eWxlcy5iaW5kKHRoaXMpKCl9XG4gICAgICAgICAgICAgICAgd2lsbEVudGVyPXt0aGlzLndpbGxFbnRlci5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICAgIHdpbGxMZWF2ZT17dGhpcy53aWxsTGVhdmUuYmluZCh0aGlzKX0+XG4gICAgICAgICAgICAgICAge3ZhbHVlcyA9PlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNsaW1iX193YWxsXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICB7T2JqZWN0LmtleXModmFsdWVzKS5tYXAoa2V5ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtVmFsdWVzID0gdmFsdWVzW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyVGlsZShrZXksIGl0ZW1WYWx1ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvVHJhbnNpdGlvbk1vdGlvbj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFdhbGw7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL3dhbGwvV2FsbC5qc3hcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ICdkZWZhdWx0Jzogb2JqIH07IH1cblxudmFyIF9yeExpdGUgPSByZXF1aXJlKCdyeC1saXRlJyk7XG5cbnZhciBfZmV0Y2hKc29ucCA9IHJlcXVpcmUoJ2ZldGNoLWpzb25wJyk7XG5cbnZhciBfZmV0Y2hKc29ucDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mZXRjaEpzb25wKTtcblxudmFyIGdldFN0cmVhbSA9IGZ1bmN0aW9uIGdldFN0cmVhbShjb2xsZWN0aW9uSWQpIHtcblxuICAgIHZhciBwb2xsUmF0ZSA9IDUgKiAxMDAwO1xuXG4gICAgdmFyIHJlcXVlc3RTdHJlYW0gPSBfcnhMaXRlLk9ic2VydmFibGUuanVzdCgnaHR0cDovL2FwcC5jbGltYi5zb2NpYWwvYXBpL3YxL2NvbGxlY3Rpb25zLycgKyBjb2xsZWN0aW9uSWQpO1xuXG4gICAgdmFyIHVwZGF0ZVN0cmVhbSA9IF9yeExpdGUuT2JzZXJ2YWJsZS5pbnRlcnZhbChwb2xsUmF0ZSkuc3RhcnRXaXRoKG51bGwpO1xuXG4gICAgdmFyIHJlc3BvbnNlU3RyZWFtID0gdXBkYXRlU3RyZWFtLmNvbWJpbmVMYXRlc3QocmVxdWVzdFN0cmVhbSwgZnVuY3Rpb24gKHRpY2ssIHVybCkge1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgIH0pLmZsYXRNYXAoZnVuY3Rpb24gKGJhc2VVcmwpIHtcblxuICAgICAgICB2YXIgcmVxdWVzdFVybCA9ICcnICsgYmFzZVVybDtcblxuICAgICAgICByZXR1cm4gX3J4TGl0ZS5PYnNlcnZhYmxlLmZyb21Qcm9taXNlKCgwLCBfZmV0Y2hKc29ucDJbJ2RlZmF1bHQnXSkocmVxdWVzdFVybCkudGhlbihmdW5jdGlvbiAocmVzcCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3AuanNvbigpO1xuICAgICAgICB9KSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzcG9uc2VTdHJlYW07XG59O1xuXG5leHBvcnRzWydkZWZhdWx0J10gPSB7XG4gICAgZ2V0U3RyZWFtOiBnZXRTdHJlYW1cbn07XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2NsaW1iLXNvY2lhbC9kaXN0L2luZGV4LmpzXG4gKiogbW9kdWxlIGlkID0gOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gW3N0aWZmbmVzcywgZGFtcGluZ11cblwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB7XG4gIG5vV29iYmxlOiBbMTcwLCAyNl0sIC8vIHRoZSBkZWZhdWx0XG4gIGdlbnRsZTogWzEyMCwgMTRdLFxuICB3b2JibHk6IFsxODAsIDEyXSxcbiAgc3RpZmY6IFsyMTAsIDIwXVxufTtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9wcmVzZXRzLmpzXG4gKiogbW9kdWxlIGlkID0gOVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjcuMVxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2V0TmFub1NlY29uZHMsIGhydGltZSwgbG9hZFRpbWU7XG5cbiAgaWYgKCh0eXBlb2YgcGVyZm9ybWFuY2UgIT09IFwidW5kZWZpbmVkXCIgJiYgcGVyZm9ybWFuY2UgIT09IG51bGwpICYmIHBlcmZvcm1hbmNlLm5vdykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgfTtcbiAgfSBlbHNlIGlmICgodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2VzcyAhPT0gbnVsbCkgJiYgcHJvY2Vzcy5ocnRpbWUpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIChnZXROYW5vU2Vjb25kcygpIC0gbG9hZFRpbWUpIC8gMWU2O1xuICAgIH07XG4gICAgaHJ0aW1lID0gcHJvY2Vzcy5ocnRpbWU7XG4gICAgZ2V0TmFub1NlY29uZHMgPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBocjtcbiAgICAgIGhyID0gaHJ0aW1lKCk7XG4gICAgICByZXR1cm4gaHJbMF0gKiAxZTkgKyBoclsxXTtcbiAgICB9O1xuICAgIGxvYWRUaW1lID0gZ2V0TmFub1NlY29uZHMoKTtcbiAgfSBlbHNlIGlmIChEYXRlLm5vdykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gRGF0ZS5ub3coKSAtIGxvYWRUaW1lO1xuICAgIH07XG4gICAgbG9hZFRpbWUgPSBEYXRlLm5vdygpO1xuICB9IGVsc2Uge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCkgLSBsb2FkVGltZTtcbiAgICB9O1xuICAgIGxvYWRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gIH1cblxufSkuY2FsbCh0aGlzKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9+L3BlcmZvcm1hbmNlLW5vdy9saWIvcGVyZm9ybWFuY2Utbm93LmpzXG4gKiogbW9kdWxlIGlkID0gMTBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBzZXRUaW1lb3V0KGRyYWluUXVldWUsIDApO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAod2VicGFjaykvfi9ub2RlLWxpYnMtYnJvd3Nlci9+L3Byb2Nlc3MvYnJvd3Nlci5qc1xuICoqIG1vZHVsZSBpZCA9IDExXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJpbXBvcnQgUmVhY3QsIHtDb21wb25lbnQsIFByb3BUeXBlc30gZnJvbSAncmVhY3QnO1xuaW1wb3J0IE1lc3NhZ2UgZnJvbSAnLi4vY29tbW9uL01lc3NhZ2UnO1xuaW1wb3J0IEF1dGhvciBmcm9tICcuLi9jb21tb24vQXV0aG9yJztcblxuXG5jbGFzcyBQYW5lbCBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgICAgICBtZXNzYWdlOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIGF1dGhvcjogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkXG4gICAgfTtcblxuICAgIGNyZWF0ZUF1dGhvcigpIHtcbiAgICAgICAgY29uc3Qge2F1dGhvcn0gPSB0aGlzLnByb3BzO1xuXG4gICAgICAgIHJldHVybihcbiAgICAgICAgICAgIDxBdXRob3Igey4uLmF1dGhvcn0gLz5cbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBjcmVhdGVNZXNzYWdlKCkge1xuICAgICAgICByZXR1cm4oXG4gICAgICAgICAgICA8TWVzc2FnZSBib2R5PXt0aGlzLnByb3BzLm1lc3NhZ2V9IC8+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuXG4gICAgICAgIGNvbnN0IGF1dGhvciA9IHRoaXMuY3JlYXRlQXV0aG9yKCk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0aGlzLmNyZWF0ZU1lc3NhZ2UoKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBzdHlsZT17dGhpcy5wcm9wcy5zdHlsZX1cbiAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiY2xpbWItc2xpZGVzaG93X19wYW5lbFwiPlxuXG4gICAgICAgICAgICAgICAge2F1dGhvcn1cbiAgICAgICAgICAgICAgICB7bWVzc2FnZX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUGFuZWw7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL3NsaWRlc2hvdy9QYW5lbC5qc3hcbiAqKi8iLCJpbXBvcnQgUmVhY3QsIHtDb21wb25lbnQsIFByb3BUeXBlc30gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFNsaWRlIGZyb20gJy4vc2xpZGUnO1xuaW1wb3J0IHtUcmFuc2l0aW9uTW90aW9uLCBzcHJpbmd9IGZyb20gJ3JlYWN0LW1vdGlvbic7XG5cblxuY2xhc3MgU2xpZGVzaG93IGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG5cbiAgICBzdGF0ZSA9IHtcbiAgICAgICAgY3VycmVudEtleTogJydcbiAgICB9O1xuXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgaXRlbXM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgICAgZGVsYXk6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZFxuICAgIH07XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgY29uc3Qge2RlbGF5fSA9IHRoaXMucHJvcHM7XG4gICAgICAgIHRoaXMudGltZXIgPSBzZXRJbnRlcnZhbCh0aGlzLm5leHRTbGlkZS5iaW5kKHRoaXMpLCBkZWxheSAqIDEwMDApO1xuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXIpO1xuICAgIH1cblxuICAgIG5leHRTbGlkZSgpIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMucHJvcHMuaXRlbXMpO1xuICAgICAgICBjb25zdCByYW5kb21LZXkgPSBrZXlzW2tleXMubGVuZ3RoICogTWF0aC5yYW5kb20oKSA8PCAwXTtcblxuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgIGN1cnJlbnRLZXk6IHJhbmRvbUtleVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRTdHlsZXMoKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRLZXkgPSB0aGlzLnN0YXRlLmN1cnJlbnRLZXk7XG4gICAgICAgIGNvbnN0IGNvbmZpZ3MgPSB7fTtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5wcm9wcy5pdGVtcykubWFwKGtleSA9PiB7XG4gICAgICAgICAgICBjb25maWdzW2tleV0gPSB7XG4gICAgICAgICAgICAgICAgb3BhY2l0eTogc3ByaW5nKDApLFxuICAgICAgICAgICAgICAgIHNjYWxlOiBzcHJpbmcoMCksXG4gICAgICAgICAgICAgICAgekluZGV4OiAtNSxcbiAgICAgICAgICAgICAgICBpdGVtOiB0aGlzLnByb3BzLml0ZW1zW2tleV1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChrZXkgPT09IGN1cnJlbnRLZXkpIHtcbiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbmZpZ3Nba2V5XSwge1xuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiBzcHJpbmcoMSksXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlOiBzcHJpbmcoMSksXG4gICAgICAgICAgICAgICAgICAgIHpJbmRleDogMVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY29uZmlncztcbiAgICB9XG5cbiAgICB3aWxsRW50ZXIoa2V5KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvcGFjaXR5OiBzcHJpbmcoMCksXG4gICAgICAgICAgICBzY2FsZTogc3ByaW5nKDApLFxuICAgICAgICAgICAgekluZGV4OiAtNSxcbiAgICAgICAgICAgIGl0ZW06IHRoaXMucHJvcHMuaXRlbXNba2V5XVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHdpbGxMZWF2ZShrZXksIHN0eWxlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvcGFjaXR5OiBzcHJpbmcoMCksXG4gICAgICAgICAgICBzY2FsZTogc3ByaW5nKDApLFxuICAgICAgICAgICAgekluZGV4OiAtNSxcbiAgICAgICAgICAgIGl0ZW06IHN0eWxlLml0ZW1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICByZW5kZXJTbGlkZShrZXksIGl0ZW1WYWx1ZXMpIHtcblxuICAgICAgICBjb25zdCB7aXRlbSwgLi4uc3R5bGVDb25maWd9ID0gaXRlbVZhbHVlcztcblxuICAgICAgICBjb25zdCBzdHlsZSA9IHtcbiAgICAgICAgICAgIG9wYWNpdHk6IHN0eWxlQ29uZmlnLm9wYWNpdHksXG4gICAgICAgICAgICB6SW5kZXg6IE1hdGguZmxvb3Ioc3R5bGVDb25maWcuekluZGV4KSxcbiAgICAgICAgICAgIHRyYW5zZm9ybTogYHNjYWxlKCR7c3R5bGVDb25maWcuc2NhbGV9KWBcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPFNsaWRlIGtleT17a2V5fVxuICAgICAgICAgICAgICAgICAgIGlzQ3VycmVudD17a2V5ID09PSB0aGlzLnN0YXRlLmN1cnJlbnRLZXl9XG4gICAgICAgICAgICAgICAgICAgaXRlbT17aXRlbX1cbiAgICAgICAgICAgICAgICAgICBzdHlsZT17c3R5bGV9IC8+XG4gICAgICAgICk7XG5cbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8VHJhbnNpdGlvbk1vdGlvblxuICAgICAgICAgICAgICAgIHN0eWxlcz17dGhpcy5nZXRTdHlsZXMuYmluZCh0aGlzKSgpfVxuICAgICAgICAgICAgICAgIHdpbGxFbnRlcj17dGhpcy53aWxsRW50ZXIuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgICB3aWxsTGVhdmU9e3RoaXMud2lsbExlYXZlLmJpbmQodGhpcyl9PlxuICAgICAgICAgICAgICAgIHt2YWx1ZXMgPT5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjbGltYl9fc2xpZGVzaG93X19jb250YWluZXJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtPYmplY3Qua2V5cyh2YWx1ZXMpLm1hcChrZXkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1WYWx1ZXMgPSB2YWx1ZXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJTbGlkZShrZXksIGl0ZW1WYWx1ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIDwvVHJhbnNpdGlvbk1vdGlvbj5cbiAgICAgICAgKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNsaWRlc2hvdztcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvc2xpZGVzaG93L1NsaWRlc2hvdy5qc3hcbiAqKi8iLCJpbXBvcnQgUmVhY3QsIHtDb21wb25lbnQsIFByb3BUeXBlc30gZnJvbSAncmVhY3QnO1xuaW1wb3J0IGNsaW1iIGZyb20gJ2NsaW1iLXNvY2lhbCc7XG5pbXBvcnQgU2xpZGVzaG93IGZyb20gJy4vU2xpZGVzaG93JztcblxuXG5jbGFzcyBTbGlkZXNob3dDb250YWluZXIgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgIH1cblxuICAgIHN0YXRlID0ge1xuICAgICAgICBpdGVtczoge31cbiAgICB9O1xuXG4gICAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAgICAgY29sbGVjdGlvbklkOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIGRlbGF5OiBQcm9wVHlwZXMubnVtYmVyXG4gICAgfTtcblxuICAgIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgICAgIGNvbGxlY3Rpb25JZDogJzU2MWJhNjM0NDUyODRlMTc0MGUwMTZmNycsXG4gICAgICAgIGRlbGF5OiA1XG4gICAgfTtcblxuXG4gICAgaW5pdCgpIHtcblxuICAgICAgICBpZiAoIXRoaXMucHJvcHMuY29sbGVjdGlvbklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjbGltYlxuICAgICAgICAgICAgLmdldFN0cmVhbSh0aGlzLnByb3BzLmNvbGxlY3Rpb25JZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoaXRlbXMgPT4ge1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbWFwcGVkSXRlbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBpdGVtcy5tYXAoaXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG1hcHBlZEl0ZW1zW2l0ZW0uaWRdID0gaXRlbTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICBpdGVtczogbWFwcGVkSXRlbXNcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIHRoaXMuaW5pdCgpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxTbGlkZXNob3cgaXRlbXM9e3RoaXMuc3RhdGUuaXRlbXN9IGRlbGF5PXt0aGlzLnByb3BzLmRlbGF5fS8+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTbGlkZXNob3dDb250YWluZXI7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL34vZXNsaW50LWxvYWRlciEuL3NyYy9jb21wb25lbnRzL3NsaWRlc2hvdy9TbGlkZXNob3dDb250YWluZXIuanN4XG4gKiovIiwiaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50LCBQcm9wVHlwZXN9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQYW5lbCBmcm9tICcuL1BhbmVsJztcbmltcG9ydCBJbWFnZSBmcm9tICcuLi9jb21tb24vSW1hZ2UnO1xuaW1wb3J0IHtNb3Rpb24sIHNwcmluZ30gZnJvbSAncmVhY3QtbW90aW9uJztcblxuY2xhc3MgU2xpZGUgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgIH1cblxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGl0ZW06IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgICAgaXNDdXJyZW50OiBQcm9wVHlwZXMuYm9vbFxuICAgIH07XG5cbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBpc0N1cnJlbnQ6IGZhbHNlXG4gICAgfTtcblxuICAgIHN0YXRlID0ge1xuICAgICAgICBzaG91bGREaXNwbGF5UGFuZWw6IGZhbHNlXG4gICAgfTtcblxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICAgIGlmIChuZXh0UHJvcHMuaXNDdXJyZW50KSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkRGlzcGxheVBhbmVsOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCA4NTApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICAgICAgc2hvdWxkRGlzcGxheVBhbmVsOiBmYWxzZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjcmVhdGVJbWFnZSgpIHtcblxuICAgICAgICBjb25zdCB7aW1hZ2V9ID0gdGhpcy5wcm9wcy5pdGVtO1xuXG4gICAgICAgIGlmIChpbWFnZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgY29uc3Qge3VybDogc3JjLCB3aWR0aCwgaGVpZ2h0fSA9IGltYWdlO1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICA8SW1hZ2Ugc3JjPXsgc3JjIH1cbiAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg9eyB3aWR0aCB9XG4gICAgICAgICAgICAgICAgICAgICAgIGhlaWdodD17IGhlaWdodCB9Lz5cbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY3JlYXRlUGFuZWwoKSB7XG5cbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLml0ZW0uaW1hZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgPFBhbmVsIGF1dGhvcj17dGhpcy5wcm9wcy5pdGVtLmF1dGhvcn0gbWVzc2FnZT17dGhpcy5wcm9wcy5pdGVtLm1lc3NhZ2V9IC8+XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGFuZWxXaWR0aCA9IDMwMDtcblxuICAgICAgICBjb25zdCB2YWx1ZXMgPSB7XG4gICAgICAgICAgICB4OiB0aGlzLnN0YXRlLnNob3VsZERpc3BsYXlQYW5lbCA/IHNwcmluZygwKSA6IHNwcmluZyhwYW5lbFdpZHRoKVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGRlZmF1bHRWYWx1ZXMgPSB7XG4gICAgICAgICAgICB4OiAwXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxNb3Rpb24gZGVmYXVsdFN0eWxlPXtkZWZhdWx0VmFsdWVzfVxuICAgICAgICAgICAgICAgICAgICBzdHlsZT17dmFsdWVzfT5cbiAgICAgICAgICAgICAgICB7aW50ZXJwb2xhdGVkVmFsdWVzID0+XG4gICAgICAgICAgICAgICAgICAgIDxQYW5lbCBhdXRob3I9e3RoaXMucHJvcHMuaXRlbS5hdXRob3J9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlPXt0aGlzLnByb3BzLml0ZW0ubWVzc2FnZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7bWFyZ2luTGVmdDogYC0ke2ludGVycG9sYXRlZFZhbHVlcy54fXB4YCwgd2lkdGg6IHBhbmVsV2lkdGh9fSAvPlxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgPC9Nb3Rpb24+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgY3JlYXRlQ2xhc3NTdHJpbmcoKSB7XG5cbiAgICAgICAgbGV0IGNsYXNzU3RyaW5nID0gYGNsaW1iLXNsaWRlc2hvd19fc2xpZGUgY2xpbWJfX3RpbGUtLSR7dGhpcy5wcm9wcy5pdGVtLnNvdXJjZV90eXBlfWA7XG5cbiAgICAgICAgaWYgKHRoaXMucHJvcHMuaXRlbS5pbWFnZSkge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYi1zbGlkZXNob3dfX3NsaWRlLS1oYXMtbWVkaWEgY2xpbWItc2xpZGVzaG93X19zbGlkZS0taGFzLWltYWdlJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNsYXNzU3RyaW5nICs9ICcgY2xpbWItc2xpZGVzaG93X19zbGlkZS0taGFzLW5vLWltYWdlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnByb3BzLml0ZW0udmlkZW9fdXJsKSB7XG4gICAgICAgICAgICBjbGFzc1N0cmluZyArPSAnIGNsaW1iLXNsaWRlc2hvd19fc2xpZGUtLWhhcy1tZWRpYSBjbGltYi1zbGlkZXNob3dfX3NsaWRlLS1oYXMtdmlkZW8nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2xhc3NTdHJpbmcgKz0gJyBjbGltYi1zbGlkZXNob3dfX3NsaWRlLS1oYXMtbm8tdmlkZW8nO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNsYXNzU3RyaW5nO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgaW1hZ2UgPSB0aGlzLmNyZWF0ZUltYWdlKCk7XG4gICAgICAgIGNvbnN0IHBhbmVsID0gdGhpcy5jcmVhdGVQYW5lbCgpO1xuICAgICAgICBjb25zdCBjbGFzc1N0cmluZyA9IHRoaXMuY3JlYXRlQ2xhc3NTdHJpbmcoKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9eyBjbGFzc1N0cmluZyB9XG4gICAgICAgICAgICAgICAgIHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfT5cbiAgICAgICAgICAgICAgICB7aW1hZ2V9XG4gICAgICAgICAgICAgICAge3BhbmVsfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG5cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNsaWRlO1xuXG5cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvc2xpZGVzaG93L3NsaWRlLmpzeFxuICoqLyIsImltcG9ydCBSZWFjdCwge0NvbXBvbmVudH0gZnJvbSAncmVhY3QnO1xuXG5cbmNsYXNzIENsaW1iQmFkZ2UgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gICAgcmVuZGVyKCkge1xuXG4gICAgICAgIGNvbnN0IGxvZ28gPSByZXF1aXJlKCcuLi8uLi9pbWcvY2xpbWJfbG9nby5zdmcnKTtcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGEgaHJlZj1cImh0dHA6Ly9jbGltYi5zb2NpYWwvXCJcbiAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cImNsaW1iLXNvY2lhbC1iYWRnZVwiXG4gICAgICAgICAgICAgICBkYW5nZXJvdXNseVNldElubmVySFRNTD17e19faHRtbDogbG9nb319PlxuICAgICAgICAgICAgPC9hPlxuICAgICAgICApO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2xpbWJCYWRnZTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vfi9lc2xpbnQtbG9hZGVyIS4vc3JjL2NvbXBvbmVudHMvd2FsbC9DbGltYkJhZGdlLmpzeFxuICoqLyIsImltcG9ydCBSZWFjdCwge0NvbXBvbmVudCwgUHJvcFR5cGVzfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgY2xpbWIgZnJvbSAnY2xpbWItc29jaWFsJztcbmltcG9ydCBXYWxsIGZyb20gJy4vV2FsbCc7XG5pbXBvcnQgQmFkZ2UgZnJvbSAnLi9DbGltYkJhZGdlJztcblxuXG5jbGFzcyBXYWxsQ29udGFpbmVyIGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG5cbiAgICBzdGF0ZSA9IHtcbiAgICAgICAgaXRlbXM6IHt9XG4gICAgfTtcblxuICAgIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgICAgIGNvbGxlY3Rpb25JZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgICBsaW1pdDogUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICAgICAgICBQcm9wVHlwZXMubnVtYmVyLFxuICAgICAgICAgICAgUHJvcFR5cGVzLnN0cmluZ1xuICAgICAgICBdKVxuICAgIH07XG5cbiAgICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgICAgICBjb2xsZWN0aW9uSWQ6ICc1NjFiYTYzNDQ1Mjg0ZTE3NDBlMDE2ZjcnLFxuICAgICAgICBsaW1pdDogMzBcbiAgICB9O1xuXG4gICAgaW5pdCgpIHtcblxuICAgICAgICBpZiAoIXRoaXMucHJvcHMuY29sbGVjdGlvbklkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjbGltYlxuICAgICAgICAgICAgLmdldFN0cmVhbSh0aGlzLnByb3BzLmNvbGxlY3Rpb25JZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoaXRlbXMgPT4ge1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbWF4U2l6ZSA9IHBhcnNlSW50KHRoaXMucHJvcHMubGltaXQsIDApO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbWFwcGVkSXRlbXMgPSB7fTtcbiAgICAgICAgICAgICAgICBpdGVtcy5zcGxpY2UoMCwgbWF4U2l6ZSkubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBtYXBwZWRJdGVtc1tpdGVtLmlkXSA9IGl0ZW07XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICAgICAgaXRlbXM6IG1hcHBlZEl0ZW1zXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgICB0aGlzLmluaXQoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgICAgIGxldCBjYjtcbiAgICAgICAgaWYgKHdpbmRvdy5DbGltYiAmJiB3aW5kb3cuQ2xpbWIub25VcGRhdGUpIHtcbiAgICAgICAgICAgIGNiID0gd2luZG93LkNsaW1iLm9uVXBkYXRlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gbm9vcFxuICAgICAgICAgICAgY2IgPSAoKSA9PiB7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNiKCk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgICAgICA8V2FsbCBpdGVtcz17dGhpcy5zdGF0ZS5pdGVtc30vPlxuICAgICAgICAgICAgICAgIDxCYWRnZSAvPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBXYWxsQ29udGFpbmVyO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9+L2VzbGludC1sb2FkZXIhLi9zcmMvY29tcG9uZW50cy93YWxsL1dhbGxDb250YWluZXIuanN4XG4gKiovIiwiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQsIEFsbCByaWdodHMgcmVzZXJ2ZWQuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuXG47KGZ1bmN0aW9uICh1bmRlZmluZWQpIHtcblxuICB2YXIgb2JqZWN0VHlwZXMgPSB7XG4gICAgJ2Z1bmN0aW9uJzogdHJ1ZSxcbiAgICAnb2JqZWN0JzogdHJ1ZVxuICB9O1xuXG4gIGZ1bmN0aW9uIGNoZWNrR2xvYmFsKHZhbHVlKSB7XG4gICAgcmV0dXJuICh2YWx1ZSAmJiB2YWx1ZS5PYmplY3QgPT09IE9iamVjdCkgPyB2YWx1ZSA6IG51bGw7XG4gIH1cblxuICB2YXIgZnJlZUV4cG9ydHMgPSAob2JqZWN0VHlwZXNbdHlwZW9mIGV4cG9ydHNdICYmIGV4cG9ydHMgJiYgIWV4cG9ydHMubm9kZVR5cGUpID8gZXhwb3J0cyA6IG51bGw7XG4gIHZhciBmcmVlTW9kdWxlID0gKG9iamVjdFR5cGVzW3R5cGVvZiBtb2R1bGVdICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlKSA/IG1vZHVsZSA6IG51bGw7XG4gIHZhciBmcmVlR2xvYmFsID0gY2hlY2tHbG9iYWwoZnJlZUV4cG9ydHMgJiYgZnJlZU1vZHVsZSAmJiB0eXBlb2YgZ2xvYmFsID09PSAnb2JqZWN0JyAmJiBnbG9iYWwpO1xuICB2YXIgZnJlZVNlbGYgPSBjaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2Ygc2VsZl0gJiYgc2VsZik7XG4gIHZhciBmcmVlV2luZG93ID0gY2hlY2tHbG9iYWwob2JqZWN0VHlwZXNbdHlwZW9mIHdpbmRvd10gJiYgd2luZG93KTtcbiAgdmFyIG1vZHVsZUV4cG9ydHMgPSAoZnJlZU1vZHVsZSAmJiBmcmVlTW9kdWxlLmV4cG9ydHMgPT09IGZyZWVFeHBvcnRzKSA/IGZyZWVFeHBvcnRzIDogbnVsbDtcbiAgdmFyIHRoaXNHbG9iYWwgPSBjaGVja0dsb2JhbChvYmplY3RUeXBlc1t0eXBlb2YgdGhpc10gJiYgdGhpcyk7XG4gIHZhciByb290ID0gZnJlZUdsb2JhbCB8fCAoKGZyZWVXaW5kb3cgIT09ICh0aGlzR2xvYmFsICYmIHRoaXNHbG9iYWwud2luZG93KSkgJiYgZnJlZVdpbmRvdykgfHwgZnJlZVNlbGYgfHwgdGhpc0dsb2JhbCB8fCBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXG4gIHZhciBSeCA9IHtcbiAgICBpbnRlcm5hbHM6IHt9LFxuICAgIGNvbmZpZzoge1xuICAgICAgUHJvbWlzZTogcm9vdC5Qcm9taXNlXG4gICAgfSxcbiAgICBoZWxwZXJzOiB7IH1cbiAgfTtcblxuICAvLyBEZWZhdWx0c1xuICB2YXIgbm9vcCA9IFJ4LmhlbHBlcnMubm9vcCA9IGZ1bmN0aW9uICgpIHsgfSxcbiAgICBpZGVudGl0eSA9IFJ4LmhlbHBlcnMuaWRlbnRpdHkgPSBmdW5jdGlvbiAoeCkgeyByZXR1cm4geDsgfSxcbiAgICBkZWZhdWx0Tm93ID0gUnguaGVscGVycy5kZWZhdWx0Tm93ID0gRGF0ZS5ub3csXG4gICAgZGVmYXVsdENvbXBhcmVyID0gUnguaGVscGVycy5kZWZhdWx0Q29tcGFyZXIgPSBmdW5jdGlvbiAoeCwgeSkgeyByZXR1cm4gaXNFcXVhbCh4LCB5KTsgfSxcbiAgICBkZWZhdWx0U3ViQ29tcGFyZXIgPSBSeC5oZWxwZXJzLmRlZmF1bHRTdWJDb21wYXJlciA9IGZ1bmN0aW9uICh4LCB5KSB7IHJldHVybiB4ID4geSA/IDEgOiAoeCA8IHkgPyAtMSA6IDApOyB9LFxuICAgIGRlZmF1bHRLZXlTZXJpYWxpemVyID0gUnguaGVscGVycy5kZWZhdWx0S2V5U2VyaWFsaXplciA9IGZ1bmN0aW9uICh4KSB7IHJldHVybiB4LnRvU3RyaW5nKCk7IH0sXG4gICAgZGVmYXVsdEVycm9yID0gUnguaGVscGVycy5kZWZhdWx0RXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7IHRocm93IGVycjsgfSxcbiAgICBpc1Byb21pc2UgPSBSeC5oZWxwZXJzLmlzUHJvbWlzZSA9IGZ1bmN0aW9uIChwKSB7IHJldHVybiAhIXAgJiYgdHlwZW9mIHAuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBwLnRoZW4gPT09ICdmdW5jdGlvbic7IH0sXG4gICAgaXNGdW5jdGlvbiA9IFJ4LmhlbHBlcnMuaXNGdW5jdGlvbiA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAgIHZhciBpc0ZuID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJyB8fCBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gZmFsbGJhY2sgZm9yIG9sZGVyIHZlcnNpb25zIG9mIENocm9tZSBhbmQgU2FmYXJpXG4gICAgICBpZiAoaXNGbigveC8pKSB7XG4gICAgICAgIGlzRm4gPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJyAmJiB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gaXNGbjtcbiAgICB9KCkpO1xuXG4gICAgZnVuY3Rpb24gY2xvbmVBcnJheShhcnIpIHtcbiAgICAgIHZhciBsZW4gPSBhcnIubGVuZ3RoLCBhID0gbmV3IEFycmF5KGxlbik7XG4gICAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYVtpXSA9IGFycltpXTsgfVxuICAgICAgcmV0dXJuIGE7XG4gICAgfVxuXG4gIHZhciBlcnJvck9iaiA9IHtlOiB7fX07XG4gIFxuICBmdW5jdGlvbiB0cnlDYXRjaGVyR2VuKHRyeUNhdGNoVGFyZ2V0KSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIHRyeUNhdGNoZXIoKSB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gdHJ5Q2F0Y2hUYXJnZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgZXJyb3JPYmouZSA9IGU7XG4gICAgICAgIHJldHVybiBlcnJvck9iajtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgdmFyIHRyeUNhdGNoID0gUnguaW50ZXJuYWxzLnRyeUNhdGNoID0gZnVuY3Rpb24gdHJ5Q2F0Y2goZm4pIHtcbiAgICBpZiAoIWlzRnVuY3Rpb24oZm4pKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ2ZuIG11c3QgYmUgYSBmdW5jdGlvbicpOyB9XG4gICAgcmV0dXJuIHRyeUNhdGNoZXJHZW4oZm4pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHRocm93ZXIoZSkge1xuICAgIHRocm93IGU7XG4gIH1cblxuICBSeC5jb25maWcubG9uZ1N0YWNrU3VwcG9ydCA9IGZhbHNlO1xuICB2YXIgaGFzU3RhY2tzID0gZmFsc2UsIHN0YWNrcyA9IHRyeUNhdGNoKGZ1bmN0aW9uICgpIHsgdGhyb3cgbmV3IEVycm9yKCk7IH0pKCk7XG4gIGhhc1N0YWNrcyA9ICEhc3RhY2tzLmUgJiYgISFzdGFja3MuZS5zdGFjaztcblxuICAvLyBBbGwgY29kZSBhZnRlciB0aGlzIHBvaW50IHdpbGwgYmUgZmlsdGVyZWQgZnJvbSBzdGFjayB0cmFjZXMgcmVwb3J0ZWQgYnkgUnhKU1xuICB2YXIgclN0YXJ0aW5nTGluZSA9IGNhcHR1cmVMaW5lKCksIHJGaWxlTmFtZTtcblxuICB2YXIgU1RBQ0tfSlVNUF9TRVBBUkFUT1IgPSAnRnJvbSBwcmV2aW91cyBldmVudDonO1xuXG4gIGZ1bmN0aW9uIG1ha2VTdGFja1RyYWNlTG9uZyhlcnJvciwgb2JzZXJ2YWJsZSkge1xuICAgIC8vIElmIHBvc3NpYmxlLCB0cmFuc2Zvcm0gdGhlIGVycm9yIHN0YWNrIHRyYWNlIGJ5IHJlbW92aW5nIE5vZGUgYW5kIFJ4SlNcbiAgICAvLyBjcnVmdCwgdGhlbiBjb25jYXRlbmF0aW5nIHdpdGggdGhlIHN0YWNrIHRyYWNlIG9mIGBvYnNlcnZhYmxlYC5cbiAgICBpZiAoaGFzU3RhY2tzICYmXG4gICAgICAgIG9ic2VydmFibGUuc3RhY2sgJiZcbiAgICAgICAgdHlwZW9mIGVycm9yID09PSAnb2JqZWN0JyAmJlxuICAgICAgICBlcnJvciAhPT0gbnVsbCAmJlxuICAgICAgICBlcnJvci5zdGFjayAmJlxuICAgICAgICBlcnJvci5zdGFjay5pbmRleE9mKFNUQUNLX0pVTVBfU0VQQVJBVE9SKSA9PT0gLTFcbiAgICApIHtcbiAgICAgIHZhciBzdGFja3MgPSBbXTtcbiAgICAgIGZvciAodmFyIG8gPSBvYnNlcnZhYmxlOyAhIW87IG8gPSBvLnNvdXJjZSkge1xuICAgICAgICBpZiAoby5zdGFjaykge1xuICAgICAgICAgIHN0YWNrcy51bnNoaWZ0KG8uc3RhY2spO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzdGFja3MudW5zaGlmdChlcnJvci5zdGFjayk7XG5cbiAgICAgIHZhciBjb25jYXRlZFN0YWNrcyA9IHN0YWNrcy5qb2luKCdcXG4nICsgU1RBQ0tfSlVNUF9TRVBBUkFUT1IgKyAnXFxuJyk7XG4gICAgICBlcnJvci5zdGFjayA9IGZpbHRlclN0YWNrU3RyaW5nKGNvbmNhdGVkU3RhY2tzKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBmaWx0ZXJTdGFja1N0cmluZyhzdGFja1N0cmluZykge1xuICAgIHZhciBsaW5lcyA9IHN0YWNrU3RyaW5nLnNwbGl0KCdcXG4nKSwgZGVzaXJlZExpbmVzID0gW107XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpbmVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICB2YXIgbGluZSA9IGxpbmVzW2ldO1xuXG4gICAgICBpZiAoIWlzSW50ZXJuYWxGcmFtZShsaW5lKSAmJiAhaXNOb2RlRnJhbWUobGluZSkgJiYgbGluZSkge1xuICAgICAgICBkZXNpcmVkTGluZXMucHVzaChsaW5lKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGRlc2lyZWRMaW5lcy5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzSW50ZXJuYWxGcmFtZShzdGFja0xpbmUpIHtcbiAgICB2YXIgZmlsZU5hbWVBbmRMaW5lTnVtYmVyID0gZ2V0RmlsZU5hbWVBbmRMaW5lTnVtYmVyKHN0YWNrTGluZSk7XG4gICAgaWYgKCFmaWxlTmFtZUFuZExpbmVOdW1iZXIpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGZpbGVOYW1lID0gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzBdLCBsaW5lTnVtYmVyID0gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzFdO1xuXG4gICAgcmV0dXJuIGZpbGVOYW1lID09PSByRmlsZU5hbWUgJiZcbiAgICAgIGxpbmVOdW1iZXIgPj0gclN0YXJ0aW5nTGluZSAmJlxuICAgICAgbGluZU51bWJlciA8PSByRW5kaW5nTGluZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzTm9kZUZyYW1lKHN0YWNrTGluZSkge1xuICAgIHJldHVybiBzdGFja0xpbmUuaW5kZXhPZignKG1vZHVsZS5qczonKSAhPT0gLTEgfHxcbiAgICAgIHN0YWNrTGluZS5pbmRleE9mKCcobm9kZS5qczonKSAhPT0gLTE7XG4gIH1cblxuICBmdW5jdGlvbiBjYXB0dXJlTGluZSgpIHtcbiAgICBpZiAoIWhhc1N0YWNrcykgeyByZXR1cm47IH1cblxuICAgIHRyeSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB2YXIgbGluZXMgPSBlLnN0YWNrLnNwbGl0KCdcXG4nKTtcbiAgICAgIHZhciBmaXJzdExpbmUgPSBsaW5lc1swXS5pbmRleE9mKCdAJykgPiAwID8gbGluZXNbMV0gOiBsaW5lc1syXTtcbiAgICAgIHZhciBmaWxlTmFtZUFuZExpbmVOdW1iZXIgPSBnZXRGaWxlTmFtZUFuZExpbmVOdW1iZXIoZmlyc3RMaW5lKTtcbiAgICAgIGlmICghZmlsZU5hbWVBbmRMaW5lTnVtYmVyKSB7IHJldHVybjsgfVxuXG4gICAgICByRmlsZU5hbWUgPSBmaWxlTmFtZUFuZExpbmVOdW1iZXJbMF07XG4gICAgICByZXR1cm4gZmlsZU5hbWVBbmRMaW5lTnVtYmVyWzFdO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEZpbGVOYW1lQW5kTGluZU51bWJlcihzdGFja0xpbmUpIHtcbiAgICAvLyBOYW1lZCBmdW5jdGlvbnM6ICdhdCBmdW5jdGlvbk5hbWUgKGZpbGVuYW1lOmxpbmVOdW1iZXI6Y29sdW1uTnVtYmVyKSdcbiAgICB2YXIgYXR0ZW1wdDEgPSAvYXQgLisgXFwoKC4rKTooXFxkKyk6KD86XFxkKylcXCkkLy5leGVjKHN0YWNrTGluZSk7XG4gICAgaWYgKGF0dGVtcHQxKSB7IHJldHVybiBbYXR0ZW1wdDFbMV0sIE51bWJlcihhdHRlbXB0MVsyXSldOyB9XG5cbiAgICAvLyBBbm9ueW1vdXMgZnVuY3Rpb25zOiAnYXQgZmlsZW5hbWU6bGluZU51bWJlcjpjb2x1bW5OdW1iZXInXG4gICAgdmFyIGF0dGVtcHQyID0gL2F0IChbXiBdKyk6KFxcZCspOig/OlxcZCspJC8uZXhlYyhzdGFja0xpbmUpO1xuICAgIGlmIChhdHRlbXB0MikgeyByZXR1cm4gW2F0dGVtcHQyWzFdLCBOdW1iZXIoYXR0ZW1wdDJbMl0pXTsgfVxuXG4gICAgLy8gRmlyZWZveCBzdHlsZTogJ2Z1bmN0aW9uQGZpbGVuYW1lOmxpbmVOdW1iZXIgb3IgQGZpbGVuYW1lOmxpbmVOdW1iZXInXG4gICAgdmFyIGF0dGVtcHQzID0gLy4qQCguKyk6KFxcZCspJC8uZXhlYyhzdGFja0xpbmUpO1xuICAgIGlmIChhdHRlbXB0MykgeyByZXR1cm4gW2F0dGVtcHQzWzFdLCBOdW1iZXIoYXR0ZW1wdDNbMl0pXTsgfVxuICB9XG5cbiAgdmFyIEVtcHR5RXJyb3IgPSBSeC5FbXB0eUVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gJ1NlcXVlbmNlIGNvbnRhaW5zIG5vIGVsZW1lbnRzLic7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgRW1wdHlFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG4gIEVtcHR5RXJyb3IucHJvdG90eXBlLm5hbWUgPSAnRW1wdHlFcnJvcic7XG5cbiAgdmFyIE9iamVjdERpc3Bvc2VkRXJyb3IgPSBSeC5PYmplY3REaXNwb3NlZEVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gJ09iamVjdCBoYXMgYmVlbiBkaXNwb3NlZCc7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgT2JqZWN0RGlzcG9zZWRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG4gIE9iamVjdERpc3Bvc2VkRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnT2JqZWN0RGlzcG9zZWRFcnJvcic7XG5cbiAgdmFyIEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yID0gUnguQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gJ0FyZ3VtZW50IG91dCBvZiByYW5nZSc7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuICBBcmd1bWVudE91dE9mUmFuZ2VFcnJvci5wcm90b3R5cGUubmFtZSA9ICdBcmd1bWVudE91dE9mUmFuZ2VFcnJvcic7XG5cbiAgdmFyIE5vdFN1cHBvcnRlZEVycm9yID0gUnguTm90U3VwcG9ydGVkRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgJ1RoaXMgb3BlcmF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQnO1xuICAgIEVycm9yLmNhbGwodGhpcyk7XG4gIH07XG4gIE5vdFN1cHBvcnRlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgTm90U3VwcG9ydGVkRXJyb3IucHJvdG90eXBlLm5hbWUgPSAnTm90U3VwcG9ydGVkRXJyb3InO1xuXG4gIHZhciBOb3RJbXBsZW1lbnRlZEVycm9yID0gUnguTm90SW1wbGVtZW50ZWRFcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVGhpcyBvcGVyYXRpb24gaXMgbm90IGltcGxlbWVudGVkJztcbiAgICBFcnJvci5jYWxsKHRoaXMpO1xuICB9O1xuICBOb3RJbXBsZW1lbnRlZEVycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcbiAgTm90SW1wbGVtZW50ZWRFcnJvci5wcm90b3R5cGUubmFtZSA9ICdOb3RJbXBsZW1lbnRlZEVycm9yJztcblxuICB2YXIgbm90SW1wbGVtZW50ZWQgPSBSeC5oZWxwZXJzLm5vdEltcGxlbWVudGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gIH07XG5cbiAgdmFyIG5vdFN1cHBvcnRlZCA9IFJ4LmhlbHBlcnMubm90U3VwcG9ydGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcigpO1xuICB9O1xuXG4gIC8vIFNoaW0gaW4gaXRlcmF0b3Igc3VwcG9ydFxuICB2YXIgJGl0ZXJhdG9yJCA9ICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIFN5bWJvbC5pdGVyYXRvcikgfHxcbiAgICAnX2VzNnNoaW1faXRlcmF0b3JfJztcbiAgLy8gQnVnIGZvciBtb3ppbGxhIHZlcnNpb25cbiAgaWYgKHJvb3QuU2V0ICYmIHR5cGVvZiBuZXcgcm9vdC5TZXQoKVsnQEBpdGVyYXRvciddID09PSAnZnVuY3Rpb24nKSB7XG4gICAgJGl0ZXJhdG9yJCA9ICdAQGl0ZXJhdG9yJztcbiAgfVxuXG4gIHZhciBkb25lRW51bWVyYXRvciA9IFJ4LmRvbmVFbnVtZXJhdG9yID0geyBkb25lOiB0cnVlLCB2YWx1ZTogdW5kZWZpbmVkIH07XG5cbiAgdmFyIGlzSXRlcmFibGUgPSBSeC5oZWxwZXJzLmlzSXRlcmFibGUgPSBmdW5jdGlvbiAobykge1xuICAgIHJldHVybiBvICYmIG9bJGl0ZXJhdG9yJF0gIT09IHVuZGVmaW5lZDtcbiAgfTtcblxuICB2YXIgaXNBcnJheUxpa2UgPSBSeC5oZWxwZXJzLmlzQXJyYXlMaWtlID0gZnVuY3Rpb24gKG8pIHtcbiAgICByZXR1cm4gbyAmJiBvLmxlbmd0aCAhPT0gdW5kZWZpbmVkO1xuICB9O1xuXG4gIFJ4LmhlbHBlcnMuaXRlcmF0b3IgPSAkaXRlcmF0b3IkO1xuXG4gIHZhciBiaW5kQ2FsbGJhY2sgPSBSeC5pbnRlcm5hbHMuYmluZENhbGxiYWNrID0gZnVuY3Rpb24gKGZ1bmMsIHRoaXNBcmcsIGFyZ0NvdW50KSB7XG4gICAgaWYgKHR5cGVvZiB0aGlzQXJnID09PSAndW5kZWZpbmVkJykgeyByZXR1cm4gZnVuYzsgfVxuICAgIHN3aXRjaChhcmdDb3VudCkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnKVxuICAgICAgICB9O1xuICAgICAgY2FzZSAxOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oYXJnKSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCBhcmcpO1xuICAgICAgICB9XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCk7XG4gICAgICAgIH07XG4gICAgICBjYXNlIDM6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpc0FyZywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9O1xuXG4gIC8qKiBVc2VkIHRvIGRldGVybWluZSBpZiB2YWx1ZXMgYXJlIG9mIHRoZSBsYW5ndWFnZSB0eXBlIE9iamVjdCAqL1xuICB2YXIgZG9udEVudW1zID0gWyd0b1N0cmluZycsXG4gICAgJ3RvTG9jYWxlU3RyaW5nJyxcbiAgICAndmFsdWVPZicsXG4gICAgJ2hhc093blByb3BlcnR5JyxcbiAgICAnaXNQcm90b3R5cGVPZicsXG4gICAgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJyxcbiAgICAnY29uc3RydWN0b3InXSxcbiAgZG9udEVudW1zTGVuZ3RoID0gZG9udEVudW1zLmxlbmd0aDtcblxuICAvKiogYE9iamVjdCN0b1N0cmluZ2AgcmVzdWx0IHNob3J0Y3V0cyAqL1xuICB2YXIgYXJnc0NsYXNzID0gJ1tvYmplY3QgQXJndW1lbnRzXScsXG4gICAgYXJyYXlDbGFzcyA9ICdbb2JqZWN0IEFycmF5XScsXG4gICAgYm9vbENsYXNzID0gJ1tvYmplY3QgQm9vbGVhbl0nLFxuICAgIGRhdGVDbGFzcyA9ICdbb2JqZWN0IERhdGVdJyxcbiAgICBlcnJvckNsYXNzID0gJ1tvYmplY3QgRXJyb3JdJyxcbiAgICBmdW5jQ2xhc3MgPSAnW29iamVjdCBGdW5jdGlvbl0nLFxuICAgIG51bWJlckNsYXNzID0gJ1tvYmplY3QgTnVtYmVyXScsXG4gICAgb2JqZWN0Q2xhc3MgPSAnW29iamVjdCBPYmplY3RdJyxcbiAgICByZWdleHBDbGFzcyA9ICdbb2JqZWN0IFJlZ0V4cF0nLFxuICAgIHN0cmluZ0NsYXNzID0gJ1tvYmplY3QgU3RyaW5nXSc7XG5cbiAgdmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyxcbiAgICBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksXG4gICAgc3VwcG9ydHNBcmdzQ2xhc3MgPSB0b1N0cmluZy5jYWxsKGFyZ3VtZW50cykgPT0gYXJnc0NsYXNzLCAvLyBGb3IgbGVzcyA8SUU5ICYmIEZGPDRcbiAgICBzdXBwb3J0Tm9kZUNsYXNzLFxuICAgIGVycm9yUHJvdG8gPSBFcnJvci5wcm90b3R5cGUsXG4gICAgb2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlLFxuICAgIHN0cmluZ1Byb3RvID0gU3RyaW5nLnByb3RvdHlwZSxcbiAgICBwcm9wZXJ0eUlzRW51bWVyYWJsZSA9IG9iamVjdFByb3RvLnByb3BlcnR5SXNFbnVtZXJhYmxlO1xuXG4gIHRyeSB7XG4gICAgc3VwcG9ydE5vZGVDbGFzcyA9ICEodG9TdHJpbmcuY2FsbChkb2N1bWVudCkgPT0gb2JqZWN0Q2xhc3MgJiYgISh7ICd0b1N0cmluZyc6IDAgfSArICcnKSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBzdXBwb3J0Tm9kZUNsYXNzID0gdHJ1ZTtcbiAgfVxuXG4gIHZhciBub25FbnVtUHJvcHMgPSB7fTtcbiAgbm9uRW51bVByb3BzW2FycmF5Q2xhc3NdID0gbm9uRW51bVByb3BzW2RhdGVDbGFzc10gPSBub25FbnVtUHJvcHNbbnVtYmVyQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9Mb2NhbGVTdHJpbmcnOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlLCAndmFsdWVPZic6IHRydWUgfTtcbiAgbm9uRW51bVByb3BzW2Jvb2xDbGFzc10gPSBub25FbnVtUHJvcHNbc3RyaW5nQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlLCAndmFsdWVPZic6IHRydWUgfTtcbiAgbm9uRW51bVByb3BzW2Vycm9yQ2xhc3NdID0gbm9uRW51bVByb3BzW2Z1bmNDbGFzc10gPSBub25FbnVtUHJvcHNbcmVnZXhwQ2xhc3NdID0geyAnY29uc3RydWN0b3InOiB0cnVlLCAndG9TdHJpbmcnOiB0cnVlIH07XG4gIG5vbkVudW1Qcm9wc1tvYmplY3RDbGFzc10gPSB7ICdjb25zdHJ1Y3Rvcic6IHRydWUgfTtcblxuICB2YXIgc3VwcG9ydCA9IHt9O1xuICAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBjdG9yID0gZnVuY3Rpb24oKSB7IHRoaXMueCA9IDE7IH0sXG4gICAgICBwcm9wcyA9IFtdO1xuXG4gICAgY3Rvci5wcm90b3R5cGUgPSB7ICd2YWx1ZU9mJzogMSwgJ3knOiAxIH07XG4gICAgZm9yICh2YXIga2V5IGluIG5ldyBjdG9yKSB7IHByb3BzLnB1c2goa2V5KTsgfVxuICAgIGZvciAoa2V5IGluIGFyZ3VtZW50cykgeyB9XG5cbiAgICAvLyBEZXRlY3QgaWYgYG5hbWVgIG9yIGBtZXNzYWdlYCBwcm9wZXJ0aWVzIG9mIGBFcnJvci5wcm90b3R5cGVgIGFyZSBlbnVtZXJhYmxlIGJ5IGRlZmF1bHQuXG4gICAgc3VwcG9ydC5lbnVtRXJyb3JQcm9wcyA9IHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZXJyb3JQcm90bywgJ21lc3NhZ2UnKSB8fCBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGVycm9yUHJvdG8sICduYW1lJyk7XG5cbiAgICAvLyBEZXRlY3QgaWYgYHByb3RvdHlwZWAgcHJvcGVydGllcyBhcmUgZW51bWVyYWJsZSBieSBkZWZhdWx0LlxuICAgIHN1cHBvcnQuZW51bVByb3RvdHlwZXMgPSBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGN0b3IsICdwcm90b3R5cGUnKTtcblxuICAgIC8vIERldGVjdCBpZiBgYXJndW1lbnRzYCBvYmplY3QgaW5kZXhlcyBhcmUgbm9uLWVudW1lcmFibGVcbiAgICBzdXBwb3J0Lm5vbkVudW1BcmdzID0ga2V5ICE9IDA7XG5cbiAgICAvLyBEZXRlY3QgaWYgcHJvcGVydGllcyBzaGFkb3dpbmcgdGhvc2Ugb24gYE9iamVjdC5wcm90b3R5cGVgIGFyZSBub24tZW51bWVyYWJsZS5cbiAgICBzdXBwb3J0Lm5vbkVudW1TaGFkb3dzID0gIS92YWx1ZU9mLy50ZXN0KHByb3BzKTtcbiAgfSgxKSk7XG5cbiAgdmFyIGlzT2JqZWN0ID0gUnguaW50ZXJuYWxzLmlzT2JqZWN0ID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICB2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcbiAgICByZXR1cm4gdmFsdWUgJiYgKHR5cGUgPT0gJ2Z1bmN0aW9uJyB8fCB0eXBlID09ICdvYmplY3QnKSB8fCBmYWxzZTtcbiAgfTtcblxuICBmdW5jdGlvbiBrZXlzSW4ob2JqZWN0KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIGlmICghaXNPYmplY3Qob2JqZWN0KSkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgaWYgKHN1cHBvcnQubm9uRW51bUFyZ3MgJiYgb2JqZWN0Lmxlbmd0aCAmJiBpc0FyZ3VtZW50cyhvYmplY3QpKSB7XG4gICAgICBvYmplY3QgPSBzbGljZS5jYWxsKG9iamVjdCk7XG4gICAgfVxuICAgIHZhciBza2lwUHJvdG8gPSBzdXBwb3J0LmVudW1Qcm90b3R5cGVzICYmIHR5cGVvZiBvYmplY3QgPT0gJ2Z1bmN0aW9uJyxcbiAgICAgICAgc2tpcEVycm9yUHJvcHMgPSBzdXBwb3J0LmVudW1FcnJvclByb3BzICYmIChvYmplY3QgPT09IGVycm9yUHJvdG8gfHwgb2JqZWN0IGluc3RhbmNlb2YgRXJyb3IpO1xuXG4gICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkge1xuICAgICAgaWYgKCEoc2tpcFByb3RvICYmIGtleSA9PSAncHJvdG90eXBlJykgJiZcbiAgICAgICAgICAhKHNraXBFcnJvclByb3BzICYmIChrZXkgPT0gJ21lc3NhZ2UnIHx8IGtleSA9PSAnbmFtZScpKSkge1xuICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzdXBwb3J0Lm5vbkVudW1TaGFkb3dzICYmIG9iamVjdCAhPT0gb2JqZWN0UHJvdG8pIHtcbiAgICAgIHZhciBjdG9yID0gb2JqZWN0LmNvbnN0cnVjdG9yLFxuICAgICAgICAgIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gZG9udEVudW1zTGVuZ3RoO1xuXG4gICAgICBpZiAob2JqZWN0ID09PSAoY3RvciAmJiBjdG9yLnByb3RvdHlwZSkpIHtcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9IG9iamVjdCA9PT0gc3RyaW5nUHJvdG8gPyBzdHJpbmdDbGFzcyA6IG9iamVjdCA9PT0gZXJyb3JQcm90byA/IGVycm9yQ2xhc3MgOiB0b1N0cmluZy5jYWxsKG9iamVjdCksXG4gICAgICAgICAgICBub25FbnVtID0gbm9uRW51bVByb3BzW2NsYXNzTmFtZV07XG4gICAgICB9XG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICBrZXkgPSBkb250RW51bXNbaW5kZXhdO1xuICAgICAgICBpZiAoIShub25FbnVtICYmIG5vbkVudW1ba2V5XSkgJiYgaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkpIHtcbiAgICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBmdW5jdGlvbiBpbnRlcm5hbEZvcihvYmplY3QsIGNhbGxiYWNrLCBrZXlzRnVuYykge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgcHJvcHMgPSBrZXlzRnVuYyhvYmplY3QpLFxuICAgICAgbGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIHZhciBrZXkgPSBwcm9wc1tpbmRleF07XG4gICAgICBpZiAoY2FsbGJhY2sob2JqZWN0W2tleV0sIGtleSwgb2JqZWN0KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cblxuICBmdW5jdGlvbiBpbnRlcm5hbEZvckluKG9iamVjdCwgY2FsbGJhY2spIHtcbiAgICByZXR1cm4gaW50ZXJuYWxGb3Iob2JqZWN0LCBjYWxsYmFjaywga2V5c0luKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzTm9kZSh2YWx1ZSkge1xuICAgIC8vIElFIDwgOSBwcmVzZW50cyBET00gbm9kZXMgYXMgYE9iamVjdGAgb2JqZWN0cyBleGNlcHQgdGhleSBoYXZlIGB0b1N0cmluZ2BcbiAgICAvLyBtZXRob2RzIHRoYXQgYXJlIGB0eXBlb2ZgIFwic3RyaW5nXCIgYW5kIHN0aWxsIGNhbiBjb2VyY2Ugbm9kZXMgdG8gc3RyaW5nc1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUudG9TdHJpbmcgIT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgKHZhbHVlICsgJycpID09ICdzdHJpbmcnO1xuICB9XG5cbiAgdmFyIGlzQXJndW1lbnRzID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JykgPyB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PSBhcmdzQ2xhc3MgOiBmYWxzZTtcbiAgfVxuXG4gIC8vIGZhbGxiYWNrIGZvciBicm93c2VycyB0aGF0IGNhbid0IGRldGVjdCBgYXJndW1lbnRzYCBvYmplY3RzIGJ5IFtbQ2xhc3NdXVxuICBpZiAoIXN1cHBvcnRzQXJnc0NsYXNzKSB7XG4gICAgaXNBcmd1bWVudHMgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcpID8gaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NhbGxlZScpIDogZmFsc2U7XG4gICAgfTtcbiAgfVxuXG4gIHZhciBpc0VxdWFsID0gUnguaW50ZXJuYWxzLmlzRXF1YWwgPSBmdW5jdGlvbiAoeCwgeSkge1xuICAgIHJldHVybiBkZWVwRXF1YWxzKHgsIHksIFtdLCBbXSk7XG4gIH07XG5cbiAgLyoqIEBwcml2YXRlXG4gICAqIFVzZWQgZm9yIGRlZXAgY29tcGFyaXNvblxuICAgKiovXG4gIGZ1bmN0aW9uIGRlZXBFcXVhbHMoYSwgYiwgc3RhY2tBLCBzdGFja0IpIHtcbiAgICAvLyBleGl0IGVhcmx5IGZvciBpZGVudGljYWwgdmFsdWVzXG4gICAgaWYgKGEgPT09IGIpIHtcbiAgICAgIC8vIHRyZWF0IGArMGAgdnMuIGAtMGAgYXMgbm90IGVxdWFsXG4gICAgICByZXR1cm4gYSAhPT0gMCB8fCAoMSAvIGEgPT0gMSAvIGIpO1xuICAgIH1cblxuICAgIHZhciB0eXBlID0gdHlwZW9mIGEsXG4gICAgICAgIG90aGVyVHlwZSA9IHR5cGVvZiBiO1xuXG4gICAgLy8gZXhpdCBlYXJseSBmb3IgdW5saWtlIHByaW1pdGl2ZSB2YWx1ZXNcbiAgICBpZiAoYSA9PT0gYSAmJiAoYSA9PSBudWxsIHx8IGIgPT0gbnVsbCB8fFxuICAgICAgICAodHlwZSAhPSAnZnVuY3Rpb24nICYmIHR5cGUgIT0gJ29iamVjdCcgJiYgb3RoZXJUeXBlICE9ICdmdW5jdGlvbicgJiYgb3RoZXJUeXBlICE9ICdvYmplY3QnKSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBjb21wYXJlIFtbQ2xhc3NdXSBuYW1lc1xuICAgIHZhciBjbGFzc05hbWUgPSB0b1N0cmluZy5jYWxsKGEpLFxuICAgICAgICBvdGhlckNsYXNzID0gdG9TdHJpbmcuY2FsbChiKTtcblxuICAgIGlmIChjbGFzc05hbWUgPT0gYXJnc0NsYXNzKSB7XG4gICAgICBjbGFzc05hbWUgPSBvYmplY3RDbGFzcztcbiAgICB9XG4gICAgaWYgKG90aGVyQ2xhc3MgPT0gYXJnc0NsYXNzKSB7XG4gICAgICBvdGhlckNsYXNzID0gb2JqZWN0Q2xhc3M7XG4gICAgfVxuICAgIGlmIChjbGFzc05hbWUgIT0gb3RoZXJDbGFzcykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBzd2l0Y2ggKGNsYXNzTmFtZSkge1xuICAgICAgY2FzZSBib29sQ2xhc3M6XG4gICAgICBjYXNlIGRhdGVDbGFzczpcbiAgICAgICAgLy8gY29lcmNlIGRhdGVzIGFuZCBib29sZWFucyB0byBudW1iZXJzLCBkYXRlcyB0byBtaWxsaXNlY29uZHMgYW5kIGJvb2xlYW5zXG4gICAgICAgIC8vIHRvIGAxYCBvciBgMGAgdHJlYXRpbmcgaW52YWxpZCBkYXRlcyBjb2VyY2VkIHRvIGBOYU5gIGFzIG5vdCBlcXVhbFxuICAgICAgICByZXR1cm4gK2EgPT0gK2I7XG5cbiAgICAgIGNhc2UgbnVtYmVyQ2xhc3M6XG4gICAgICAgIC8vIHRyZWF0IGBOYU5gIHZzLiBgTmFOYCBhcyBlcXVhbFxuICAgICAgICByZXR1cm4gKGEgIT0gK2EpID9cbiAgICAgICAgICBiICE9ICtiIDpcbiAgICAgICAgICAvLyBidXQgdHJlYXQgYC0wYCB2cy4gYCswYCBhcyBub3QgZXF1YWxcbiAgICAgICAgICAoYSA9PSAwID8gKDEgLyBhID09IDEgLyBiKSA6IGEgPT0gK2IpO1xuXG4gICAgICBjYXNlIHJlZ2V4cENsYXNzOlxuICAgICAgY2FzZSBzdHJpbmdDbGFzczpcbiAgICAgICAgLy8gY29lcmNlIHJlZ2V4ZXMgdG8gc3RyaW5ncyAoaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS4xMC42LjQpXG4gICAgICAgIC8vIHRyZWF0IHN0cmluZyBwcmltaXRpdmVzIGFuZCB0aGVpciBjb3JyZXNwb25kaW5nIG9iamVjdCBpbnN0YW5jZXMgYXMgZXF1YWxcbiAgICAgICAgcmV0dXJuIGEgPT0gU3RyaW5nKGIpO1xuICAgIH1cbiAgICB2YXIgaXNBcnIgPSBjbGFzc05hbWUgPT0gYXJyYXlDbGFzcztcbiAgICBpZiAoIWlzQXJyKSB7XG5cbiAgICAgIC8vIGV4aXQgZm9yIGZ1bmN0aW9ucyBhbmQgRE9NIG5vZGVzXG4gICAgICBpZiAoY2xhc3NOYW1lICE9IG9iamVjdENsYXNzIHx8ICghc3VwcG9ydC5ub2RlQ2xhc3MgJiYgKGlzTm9kZShhKSB8fCBpc05vZGUoYikpKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICAvLyBpbiBvbGRlciB2ZXJzaW9ucyBvZiBPcGVyYSwgYGFyZ3VtZW50c2Agb2JqZWN0cyBoYXZlIGBBcnJheWAgY29uc3RydWN0b3JzXG4gICAgICB2YXIgY3RvckEgPSAhc3VwcG9ydC5hcmdzT2JqZWN0ICYmIGlzQXJndW1lbnRzKGEpID8gT2JqZWN0IDogYS5jb25zdHJ1Y3RvcixcbiAgICAgICAgICBjdG9yQiA9ICFzdXBwb3J0LmFyZ3NPYmplY3QgJiYgaXNBcmd1bWVudHMoYikgPyBPYmplY3QgOiBiLmNvbnN0cnVjdG9yO1xuXG4gICAgICAvLyBub24gYE9iamVjdGAgb2JqZWN0IGluc3RhbmNlcyB3aXRoIGRpZmZlcmVudCBjb25zdHJ1Y3RvcnMgYXJlIG5vdCBlcXVhbFxuICAgICAgaWYgKGN0b3JBICE9IGN0b3JCICYmXG4gICAgICAgICAgICAhKGhhc093blByb3BlcnR5LmNhbGwoYSwgJ2NvbnN0cnVjdG9yJykgJiYgaGFzT3duUHJvcGVydHkuY2FsbChiLCAnY29uc3RydWN0b3InKSkgJiZcbiAgICAgICAgICAgICEoaXNGdW5jdGlvbihjdG9yQSkgJiYgY3RvckEgaW5zdGFuY2VvZiBjdG9yQSAmJiBpc0Z1bmN0aW9uKGN0b3JCKSAmJiBjdG9yQiBpbnN0YW5jZW9mIGN0b3JCKSAmJlxuICAgICAgICAgICAgKCdjb25zdHJ1Y3RvcicgaW4gYSAmJiAnY29uc3RydWN0b3InIGluIGIpXG4gICAgICAgICAgKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gYXNzdW1lIGN5Y2xpYyBzdHJ1Y3R1cmVzIGFyZSBlcXVhbFxuICAgIC8vIHRoZSBhbGdvcml0aG0gZm9yIGRldGVjdGluZyBjeWNsaWMgc3RydWN0dXJlcyBpcyBhZGFwdGVkIGZyb20gRVMgNS4xXG4gICAgLy8gc2VjdGlvbiAxNS4xMi4zLCBhYnN0cmFjdCBvcGVyYXRpb24gYEpPYCAoaHR0cDovL2VzNS5naXRodWIuaW8vI3gxNS4xMi4zKVxuICAgIHZhciBpbml0ZWRTdGFjayA9ICFzdGFja0E7XG4gICAgc3RhY2tBIHx8IChzdGFja0EgPSBbXSk7XG4gICAgc3RhY2tCIHx8IChzdGFja0IgPSBbXSk7XG5cbiAgICB2YXIgbGVuZ3RoID0gc3RhY2tBLmxlbmd0aDtcbiAgICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICAgIGlmIChzdGFja0FbbGVuZ3RoXSA9PSBhKSB7XG4gICAgICAgIHJldHVybiBzdGFja0JbbGVuZ3RoXSA9PSBiO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgc2l6ZSA9IDA7XG4gICAgdmFyIHJlc3VsdCA9IHRydWU7XG5cbiAgICAvLyBhZGQgYGFgIGFuZCBgYmAgdG8gdGhlIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzXG4gICAgc3RhY2tBLnB1c2goYSk7XG4gICAgc3RhY2tCLnB1c2goYik7XG5cbiAgICAvLyByZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgYW5kIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG4gICAgaWYgKGlzQXJyKSB7XG4gICAgICAvLyBjb21wYXJlIGxlbmd0aHMgdG8gZGV0ZXJtaW5lIGlmIGEgZGVlcCBjb21wYXJpc29uIGlzIG5lY2Vzc2FyeVxuICAgICAgbGVuZ3RoID0gYS5sZW5ndGg7XG4gICAgICBzaXplID0gYi5sZW5ndGg7XG4gICAgICByZXN1bHQgPSBzaXplID09IGxlbmd0aDtcblxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAvLyBkZWVwIGNvbXBhcmUgdGhlIGNvbnRlbnRzLCBpZ25vcmluZyBub24tbnVtZXJpYyBwcm9wZXJ0aWVzXG4gICAgICAgIHdoaWxlIChzaXplLS0pIHtcbiAgICAgICAgICB2YXIgaW5kZXggPSBsZW5ndGgsXG4gICAgICAgICAgICAgIHZhbHVlID0gYltzaXplXTtcblxuICAgICAgICAgIGlmICghKHJlc3VsdCA9IGRlZXBFcXVhbHMoYVtzaXplXSwgdmFsdWUsIHN0YWNrQSwgc3RhY2tCKSkpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIC8vIGRlZXAgY29tcGFyZSBvYmplY3RzIHVzaW5nIGBmb3JJbmAsIGluc3RlYWQgb2YgYGZvck93bmAsIHRvIGF2b2lkIGBPYmplY3Qua2V5c2BcbiAgICAgIC8vIHdoaWNoLCBpbiB0aGlzIGNhc2UsIGlzIG1vcmUgY29zdGx5XG4gICAgICBpbnRlcm5hbEZvckluKGIsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGIpIHtcbiAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYiwga2V5KSkge1xuICAgICAgICAgIC8vIGNvdW50IHRoZSBudW1iZXIgb2YgcHJvcGVydGllcy5cbiAgICAgICAgICBzaXplKys7XG4gICAgICAgICAgLy8gZGVlcCBjb21wYXJlIGVhY2ggcHJvcGVydHkgdmFsdWUuXG4gICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKGEsIGtleSkgJiYgZGVlcEVxdWFscyhhW2tleV0sIHZhbHVlLCBzdGFja0EsIHN0YWNrQikpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAvLyBlbnN1cmUgYm90aCBvYmplY3RzIGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mIHByb3BlcnRpZXNcbiAgICAgICAgaW50ZXJuYWxGb3JJbihhLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBhKSB7XG4gICAgICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwoYSwga2V5KSkge1xuICAgICAgICAgICAgLy8gYHNpemVgIHdpbGwgYmUgYC0xYCBpZiBgYWAgaGFzIG1vcmUgcHJvcGVydGllcyB0aGFuIGBiYFxuICAgICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSAtLXNpemUgPiAtMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgc3RhY2tBLnBvcCgpO1xuICAgIHN0YWNrQi5wb3AoKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICB2YXIgaGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LFxuICAgICAgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbiAgdmFyIGluaGVyaXRzID0gUnguaW50ZXJuYWxzLmluaGVyaXRzID0gZnVuY3Rpb24gKGNoaWxkLCBwYXJlbnQpIHtcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9XG4gICAgX18ucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTtcbiAgICBjaGlsZC5wcm90b3R5cGUgPSBuZXcgX18oKTtcbiAgfTtcblxuICB2YXIgYWRkUHJvcGVydGllcyA9IFJ4LmludGVybmFscy5hZGRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKG9iaikge1xuICAgIGZvcih2YXIgc291cmNlcyA9IFtdLCBpID0gMSwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG4gICAgZm9yICh2YXIgaWR4ID0gMCwgbG4gPSBzb3VyY2VzLmxlbmd0aDsgaWR4IDwgbG47IGlkeCsrKSB7XG4gICAgICB2YXIgc291cmNlID0gc291cmNlc1tpZHhdO1xuICAgICAgZm9yICh2YXIgcHJvcCBpbiBzb3VyY2UpIHtcbiAgICAgICAgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvLyBSeCBVdGlsc1xuICB2YXIgYWRkUmVmID0gUnguaW50ZXJuYWxzLmFkZFJlZiA9IGZ1bmN0aW9uICh4cywgcikge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShyLmdldERpc3Bvc2FibGUoKSwgeHMuc3Vic2NyaWJlKG9ic2VydmVyKSk7XG4gICAgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gYXJyYXlJbml0aWFsaXplKGNvdW50LCBmYWN0b3J5KSB7XG4gICAgdmFyIGEgPSBuZXcgQXJyYXkoY291bnQpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgYVtpXSA9IGZhY3RvcnkoKTtcbiAgICB9XG4gICAgcmV0dXJuIGE7XG4gIH1cblxuICAvKipcbiAgICogUmVwcmVzZW50cyBhIGdyb3VwIG9mIGRpc3Bvc2FibGUgcmVzb3VyY2VzIHRoYXQgYXJlIGRpc3Bvc2VkIHRvZ2V0aGVyLlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIHZhciBDb21wb3NpdGVEaXNwb3NhYmxlID0gUnguQ29tcG9zaXRlRGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXJncyA9IFtdLCBpLCBsZW47XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgYXJncyA9IGFyZ3VtZW50c1swXTtcbiAgICAgIGxlbiA9IGFyZ3MubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIH1cbiAgICB0aGlzLmRpc3Bvc2FibGVzID0gYXJncztcbiAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICB0aGlzLmxlbmd0aCA9IGFyZ3MubGVuZ3RoO1xuICB9O1xuXG4gIHZhciBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlID0gQ29tcG9zaXRlRGlzcG9zYWJsZS5wcm90b3R5cGU7XG5cbiAgLyoqXG4gICAqIEFkZHMgYSBkaXNwb3NhYmxlIHRvIHRoZSBDb21wb3NpdGVEaXNwb3NhYmxlIG9yIGRpc3Bvc2VzIHRoZSBkaXNwb3NhYmxlIGlmIHRoZSBDb21wb3NpdGVEaXNwb3NhYmxlIGlzIGRpc3Bvc2VkLlxuICAgKiBAcGFyYW0ge01peGVkfSBpdGVtIERpc3Bvc2FibGUgdG8gYWRkLlxuICAgKi9cbiAgQ29tcG9zaXRlRGlzcG9zYWJsZVByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgIGlmICh0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIGl0ZW0uZGlzcG9zZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRpc3Bvc2FibGVzLnB1c2goaXRlbSk7XG4gICAgICB0aGlzLmxlbmd0aCsrO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlcyBhbmQgZGlzcG9zZXMgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgYSBkaXNwb3NhYmxlIGZyb20gdGhlIENvbXBvc2l0ZURpc3Bvc2FibGUuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGl0ZW0gRGlzcG9zYWJsZSB0byByZW1vdmUuXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSB0cnVlIGlmIGZvdW5kOyBmYWxzZSBvdGhlcndpc2UuXG4gICAqL1xuICBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIHNob3VsZERpc3Bvc2UgPSBmYWxzZTtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdmFyIGlkeCA9IHRoaXMuZGlzcG9zYWJsZXMuaW5kZXhPZihpdGVtKTtcbiAgICAgIGlmIChpZHggIT09IC0xKSB7XG4gICAgICAgIHNob3VsZERpc3Bvc2UgPSB0cnVlO1xuICAgICAgICB0aGlzLmRpc3Bvc2FibGVzLnNwbGljZShpZHgsIDEpO1xuICAgICAgICB0aGlzLmxlbmd0aC0tO1xuICAgICAgICBpdGVtLmRpc3Bvc2UoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNob3VsZERpc3Bvc2U7XG4gIH07XG5cbiAgLyoqXG4gICAqICBEaXNwb3NlcyBhbGwgZGlzcG9zYWJsZXMgaW4gdGhlIGdyb3VwIGFuZCByZW1vdmVzIHRoZW0gZnJvbSB0aGUgZ3JvdXAuXG4gICAqL1xuICBDb21wb3NpdGVEaXNwb3NhYmxlUHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICB2YXIgbGVuID0gdGhpcy5kaXNwb3NhYmxlcy5sZW5ndGgsIGN1cnJlbnREaXNwb3NhYmxlcyA9IG5ldyBBcnJheShsZW4pO1xuICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGN1cnJlbnREaXNwb3NhYmxlc1tpXSA9IHRoaXMuZGlzcG9zYWJsZXNbaV07IH1cbiAgICAgIHRoaXMuZGlzcG9zYWJsZXMgPSBbXTtcbiAgICAgIHRoaXMubGVuZ3RoID0gMDtcblxuICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGN1cnJlbnREaXNwb3NhYmxlc1tpXS5kaXNwb3NlKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBQcm92aWRlcyBhIHNldCBvZiBzdGF0aWMgbWV0aG9kcyBmb3IgY3JlYXRpbmcgRGlzcG9zYWJsZXMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGRpc3Bvc2UgQWN0aW9uIHRvIHJ1biBkdXJpbmcgdGhlIGZpcnN0IGNhbGwgdG8gZGlzcG9zZS4gVGhlIGFjdGlvbiBpcyBndWFyYW50ZWVkIHRvIGJlIHJ1biBhdCBtb3N0IG9uY2UuXG4gICAqL1xuICB2YXIgRGlzcG9zYWJsZSA9IFJ4LkRpc3Bvc2FibGUgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgdGhpcy5hY3Rpb24gPSBhY3Rpb24gfHwgbm9vcDtcbiAgfTtcblxuICAvKiogUGVyZm9ybXMgdGhlIHRhc2sgb2YgY2xlYW5pbmcgdXAgcmVzb3VyY2VzLiAqL1xuICBEaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICB0aGlzLmFjdGlvbigpO1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBkaXNwb3NhYmxlIG9iamVjdCB0aGF0IGludm9rZXMgdGhlIHNwZWNpZmllZCBhY3Rpb24gd2hlbiBkaXNwb3NlZC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZGlzcG9zZSBBY3Rpb24gdG8gcnVuIGR1cmluZyB0aGUgZmlyc3QgY2FsbCB0byBkaXNwb3NlLiBUaGUgYWN0aW9uIGlzIGd1YXJhbnRlZWQgdG8gYmUgcnVuIGF0IG1vc3Qgb25jZS5cbiAgICogQHJldHVybiB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHRoYXQgcnVucyB0aGUgZ2l2ZW4gYWN0aW9uIHVwb24gZGlzcG9zYWwuXG4gICAqL1xuICB2YXIgZGlzcG9zYWJsZUNyZWF0ZSA9IERpc3Bvc2FibGUuY3JlYXRlID0gZnVuY3Rpb24gKGFjdGlvbikgeyByZXR1cm4gbmV3IERpc3Bvc2FibGUoYWN0aW9uKTsgfTtcblxuICAvKipcbiAgICogR2V0cyB0aGUgZGlzcG9zYWJsZSB0aGF0IGRvZXMgbm90aGluZyB3aGVuIGRpc3Bvc2VkLlxuICAgKi9cbiAgdmFyIGRpc3Bvc2FibGVFbXB0eSA9IERpc3Bvc2FibGUuZW1wdHkgPSB7IGRpc3Bvc2U6IG5vb3AgfTtcblxuICAvKipcbiAgICogVmFsaWRhdGVzIHdoZXRoZXIgdGhlIGdpdmVuIG9iamVjdCBpcyBhIGRpc3Bvc2FibGVcbiAgICogQHBhcmFtIHtPYmplY3R9IE9iamVjdCB0byB0ZXN0IHdoZXRoZXIgaXQgaGFzIGEgZGlzcG9zZSBtZXRob2RcbiAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgaWYgYSBkaXNwb3NhYmxlIG9iamVjdCwgZWxzZSBmYWxzZS5cbiAgICovXG4gIHZhciBpc0Rpc3Bvc2FibGUgPSBEaXNwb3NhYmxlLmlzRGlzcG9zYWJsZSA9IGZ1bmN0aW9uIChkKSB7XG4gICAgcmV0dXJuIGQgJiYgaXNGdW5jdGlvbihkLmRpc3Bvc2UpO1xuICB9O1xuXG4gIHZhciBjaGVja0Rpc3Bvc2VkID0gRGlzcG9zYWJsZS5jaGVja0Rpc3Bvc2VkID0gZnVuY3Rpb24gKGRpc3Bvc2FibGUpIHtcbiAgICBpZiAoZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkKSB7IHRocm93IG5ldyBPYmplY3REaXNwb3NlZEVycm9yKCk7IH1cbiAgfTtcblxuICB2YXIgZGlzcG9zYWJsZUZpeHVwID0gRGlzcG9zYWJsZS5fZml4dXAgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgcmV0dXJuIGlzRGlzcG9zYWJsZShyZXN1bHQpID8gcmVzdWx0IDogZGlzcG9zYWJsZUVtcHR5O1xuICB9O1xuXG4gIC8vIFNpbmdsZSBhc3NpZ25tZW50XG4gIHZhciBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSA9IFJ4LlNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG4gIH07XG4gIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlLnByb3RvdHlwZS5nZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnQ7XG4gIH07XG4gIFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlLnByb3RvdHlwZS5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuY3VycmVudCkgeyB0aHJvdyBuZXcgRXJyb3IoJ0Rpc3Bvc2FibGUgaGFzIGFscmVhZHkgYmVlbiBhc3NpZ25lZCcpOyB9XG4gICAgdmFyIHNob3VsZERpc3Bvc2UgPSB0aGlzLmlzRGlzcG9zZWQ7XG4gICAgIXNob3VsZERpc3Bvc2UgJiYgKHRoaXMuY3VycmVudCA9IHZhbHVlKTtcbiAgICBzaG91bGREaXNwb3NlICYmIHZhbHVlICYmIHZhbHVlLmRpc3Bvc2UoKTtcbiAgfTtcbiAgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICB2YXIgb2xkID0gdGhpcy5jdXJyZW50O1xuICAgICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcbiAgICAgIG9sZCAmJiBvbGQuZGlzcG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICAvLyBNdWx0aXBsZSBhc3NpZ25tZW50IGRpc3Bvc2FibGVcbiAgdmFyIFNlcmlhbERpc3Bvc2FibGUgPSBSeC5TZXJpYWxEaXNwb3NhYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG4gIH07XG4gIFNlcmlhbERpc3Bvc2FibGUucHJvdG90eXBlLmdldERpc3Bvc2FibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudDtcbiAgfTtcbiAgU2VyaWFsRGlzcG9zYWJsZS5wcm90b3R5cGUuc2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHZhciBzaG91bGREaXNwb3NlID0gdGhpcy5pc0Rpc3Bvc2VkO1xuICAgIGlmICghc2hvdWxkRGlzcG9zZSkge1xuICAgICAgdmFyIG9sZCA9IHRoaXMuY3VycmVudDtcbiAgICAgIHRoaXMuY3VycmVudCA9IHZhbHVlO1xuICAgIH1cbiAgICBvbGQgJiYgb2xkLmRpc3Bvc2UoKTtcbiAgICBzaG91bGREaXNwb3NlICYmIHZhbHVlICYmIHZhbHVlLmRpc3Bvc2UoKTtcbiAgfTtcbiAgU2VyaWFsRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIHZhciBvbGQgPSB0aGlzLmN1cnJlbnQ7XG4gICAgICB0aGlzLmN1cnJlbnQgPSBudWxsO1xuICAgIH1cbiAgICBvbGQgJiYgb2xkLmRpc3Bvc2UoKTtcbiAgfTtcblxuICB2YXIgQmluYXJ5RGlzcG9zYWJsZSA9IFJ4LkJpbmFyeURpc3Bvc2FibGUgPSBmdW5jdGlvbiAoZmlyc3QsIHNlY29uZCkge1xuICAgIHRoaXMuX2ZpcnN0ID0gZmlyc3Q7XG4gICAgdGhpcy5fc2Vjb25kID0gc2Vjb25kO1xuICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICB9O1xuXG4gIEJpbmFyeURpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICB2YXIgb2xkMSA9IHRoaXMuX2ZpcnN0O1xuICAgICAgdGhpcy5fZmlyc3QgPSBudWxsO1xuICAgICAgb2xkMSAmJiBvbGQxLmRpc3Bvc2UoKTtcbiAgICAgIHZhciBvbGQyID0gdGhpcy5fc2Vjb25kO1xuICAgICAgdGhpcy5fc2Vjb25kID0gbnVsbDtcbiAgICAgIG9sZDIgJiYgb2xkMi5kaXNwb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBOQXJ5RGlzcG9zYWJsZSA9IFJ4Lk5BcnlEaXNwb3NhYmxlID0gZnVuY3Rpb24gKGRpc3Bvc2FibGVzKSB7XG4gICAgdGhpcy5fZGlzcG9zYWJsZXMgPSBkaXNwb3NhYmxlcztcbiAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgfTtcblxuICBOQXJ5RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9kaXNwb3NhYmxlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB0aGlzLl9kaXNwb3NhYmxlc1tpXS5kaXNwb3NlKCk7XG4gICAgICB9XG4gICAgICB0aGlzLl9kaXNwb3NhYmxlcy5sZW5ndGggPSAwO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUmVwcmVzZW50cyBhIGRpc3Bvc2FibGUgcmVzb3VyY2UgdGhhdCBvbmx5IGRpc3Bvc2VzIGl0cyB1bmRlcmx5aW5nIGRpc3Bvc2FibGUgcmVzb3VyY2Ugd2hlbiBhbGwgZGVwZW5kZW50IGRpc3Bvc2FibGUgb2JqZWN0cyBoYXZlIGJlZW4gZGlzcG9zZWQuXG4gICAqL1xuICB2YXIgUmVmQ291bnREaXNwb3NhYmxlID0gUnguUmVmQ291bnREaXNwb3NhYmxlID0gKGZ1bmN0aW9uICgpIHtcblxuICAgIGZ1bmN0aW9uIElubmVyRGlzcG9zYWJsZShkaXNwb3NhYmxlKSB7XG4gICAgICB0aGlzLmRpc3Bvc2FibGUgPSBkaXNwb3NhYmxlO1xuICAgICAgdGhpcy5kaXNwb3NhYmxlLmNvdW50Kys7XG4gICAgICB0aGlzLmlzSW5uZXJEaXNwb3NlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIElubmVyRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5kaXNwb3NhYmxlLmlzRGlzcG9zZWQgJiYgIXRoaXMuaXNJbm5lckRpc3Bvc2VkKSB7XG4gICAgICAgIHRoaXMuaXNJbm5lckRpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5kaXNwb3NhYmxlLmNvdW50LS07XG4gICAgICAgIGlmICh0aGlzLmRpc3Bvc2FibGUuY291bnQgPT09IDAgJiYgdGhpcy5kaXNwb3NhYmxlLmlzUHJpbWFyeURpc3Bvc2VkKSB7XG4gICAgICAgICAgdGhpcy5kaXNwb3NhYmxlLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuZGlzcG9zYWJsZS51bmRlcmx5aW5nRGlzcG9zYWJsZS5kaXNwb3NlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIFJlZkNvdW50RGlzcG9zYWJsZSB3aXRoIHRoZSBzcGVjaWZpZWQgZGlzcG9zYWJsZS5cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0Rpc3Bvc2FibGV9IGRpc3Bvc2FibGUgVW5kZXJseWluZyBkaXNwb3NhYmxlLlxuICAgICAgKi9cbiAgICBmdW5jdGlvbiBSZWZDb3VudERpc3Bvc2FibGUoZGlzcG9zYWJsZSkge1xuICAgICAgdGhpcy51bmRlcmx5aW5nRGlzcG9zYWJsZSA9IGRpc3Bvc2FibGU7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNQcmltYXJ5RGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuY291bnQgPSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc3Bvc2VzIHRoZSB1bmRlcmx5aW5nIGRpc3Bvc2FibGUgb25seSB3aGVuIGFsbCBkZXBlbmRlbnQgZGlzcG9zYWJsZXMgaGF2ZSBiZWVuIGRpc3Bvc2VkXG4gICAgICovXG4gICAgUmVmQ291bnREaXNwb3NhYmxlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQgJiYgIXRoaXMuaXNQcmltYXJ5RGlzcG9zZWQpIHtcbiAgICAgICAgdGhpcy5pc1ByaW1hcnlEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLmNvdW50ID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLnVuZGVybHlpbmdEaXNwb3NhYmxlLmRpc3Bvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgZGVwZW5kZW50IGRpc3Bvc2FibGUgdGhhdCB3aGVuIGRpc3Bvc2VkIGRlY3JlYXNlcyB0aGUgcmVmY291bnQgb24gdGhlIHVuZGVybHlpbmcgZGlzcG9zYWJsZS5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkZXBlbmRlbnQgZGlzcG9zYWJsZSBjb250cmlidXRpbmcgdG8gdGhlIHJlZmVyZW5jZSBjb3VudCB0aGF0IG1hbmFnZXMgdGhlIHVuZGVybHlpbmcgZGlzcG9zYWJsZSdzIGxpZmV0aW1lLlxuICAgICAqL1xuICAgIFJlZkNvdW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzRGlzcG9zZWQgPyBkaXNwb3NhYmxlRW1wdHkgOiBuZXcgSW5uZXJEaXNwb3NhYmxlKHRoaXMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gUmVmQ291bnREaXNwb3NhYmxlO1xuICB9KSgpO1xuXG4gIHZhciBTY2hlZHVsZWRJdGVtID0gUnguaW50ZXJuYWxzLlNjaGVkdWxlZEl0ZW0gPSBmdW5jdGlvbiAoc2NoZWR1bGVyLCBzdGF0ZSwgYWN0aW9uLCBkdWVUaW1lLCBjb21wYXJlcikge1xuICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcbiAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcbiAgICB0aGlzLmR1ZVRpbWUgPSBkdWVUaW1lO1xuICAgIHRoaXMuY29tcGFyZXIgPSBjb21wYXJlciB8fCBkZWZhdWx0U3ViQ29tcGFyZXI7XG4gICAgdGhpcy5kaXNwb3NhYmxlID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gIH1cblxuICBTY2hlZHVsZWRJdGVtLnByb3RvdHlwZS5pbnZva2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5kaXNwb3NhYmxlLnNldERpc3Bvc2FibGUodGhpcy5pbnZva2VDb3JlKCkpO1xuICB9O1xuXG4gIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmNvbXBhcmVUbyA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHJldHVybiB0aGlzLmNvbXBhcmVyKHRoaXMuZHVlVGltZSwgb3RoZXIuZHVlVGltZSk7XG4gIH07XG5cbiAgU2NoZWR1bGVkSXRlbS5wcm90b3R5cGUuaXNDYW5jZWxsZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGlzcG9zYWJsZS5pc0Rpc3Bvc2VkO1xuICB9O1xuXG4gIFNjaGVkdWxlZEl0ZW0ucHJvdG90eXBlLmludm9rZUNvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRpc3Bvc2FibGVGaXh1cCh0aGlzLmFjdGlvbih0aGlzLnNjaGVkdWxlciwgdGhpcy5zdGF0ZSkpO1xuICB9O1xuXG4gIC8qKiBQcm92aWRlcyBhIHNldCBvZiBzdGF0aWMgcHJvcGVydGllcyB0byBhY2Nlc3MgY29tbW9ubHkgdXNlZCBzY2hlZHVsZXJzLiAqL1xuICB2YXIgU2NoZWR1bGVyID0gUnguU2NoZWR1bGVyID0gKGZ1bmN0aW9uICgpIHtcblxuICAgIGZ1bmN0aW9uIFNjaGVkdWxlcigpIHsgfVxuXG4gICAgLyoqIERldGVybWluZXMgd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgc2NoZWR1bGVyICovXG4gICAgU2NoZWR1bGVyLmlzU2NoZWR1bGVyID0gZnVuY3Rpb24gKHMpIHtcbiAgICAgIHJldHVybiBzIGluc3RhbmNlb2YgU2NoZWR1bGVyO1xuICAgIH07XG5cbiAgICB2YXIgc2NoZWR1bGVyUHJvdG8gPSBTY2hlZHVsZXIucHJvdG90eXBlO1xuXG4gICAgLyoqXG4gICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG4gICAqIEBwYXJhbSBzdGF0ZSBTdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBiZSBleGVjdXRlZC5cbiAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuICAgKi9cbiAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG4gICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICAgIH07XG5cbiAgLyoqXG4gICAqIFNjaGVkdWxlcyBhbiBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQgYWZ0ZXIgZHVlVGltZS5cbiAgICogQHBhcmFtIHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgKiBAcGFyYW0ge051bWJlcn0gZHVlVGltZSBSZWxhdGl2ZSB0aW1lIGFmdGVyIHdoaWNoIHRvIGV4ZWN1dGUgdGhlIGFjdGlvbi5cbiAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IFRoZSBkaXNwb3NhYmxlIG9iamVjdCB1c2VkIHRvIGNhbmNlbCB0aGUgc2NoZWR1bGVkIGFjdGlvbiAoYmVzdCBlZmZvcnQpLlxuICAgKi9cbiAgICBzY2hlZHVsZXJQcm90by5zY2hlZHVsZUZ1dHVyZSA9IGZ1bmN0aW9uIChzdGF0ZSwgZHVlVGltZSwgYWN0aW9uKSB7XG4gICAgICB2YXIgZHQgPSBkdWVUaW1lO1xuICAgICAgZHQgaW5zdGFuY2VvZiBEYXRlICYmIChkdCA9IGR0IC0gdGhpcy5ub3coKSk7XG4gICAgICBkdCA9IFNjaGVkdWxlci5ub3JtYWxpemUoZHQpO1xuXG4gICAgICBpZiAoZHQgPT09IDApIHsgcmV0dXJuIHRoaXMuc2NoZWR1bGUoc3RhdGUsIGFjdGlvbik7IH1cblxuICAgICAgcmV0dXJuIHRoaXMuX3NjaGVkdWxlRnV0dXJlKHN0YXRlLCBkdCwgYWN0aW9uKTtcbiAgICB9O1xuXG4gICAgc2NoZWR1bGVyUHJvdG8uX3NjaGVkdWxlRnV0dXJlID0gZnVuY3Rpb24gKHN0YXRlLCBkdWVUaW1lLCBhY3Rpb24pIHtcbiAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gICAgfTtcblxuICAgIC8qKiBHZXRzIHRoZSBjdXJyZW50IHRpbWUgYWNjb3JkaW5nIHRvIHRoZSBsb2NhbCBtYWNoaW5lJ3Mgc3lzdGVtIGNsb2NrLiAqL1xuICAgIFNjaGVkdWxlci5ub3cgPSBkZWZhdWx0Tm93O1xuXG4gICAgLyoqIEdldHMgdGhlIGN1cnJlbnQgdGltZSBhY2NvcmRpbmcgdG8gdGhlIGxvY2FsIG1hY2hpbmUncyBzeXN0ZW0gY2xvY2suICovXG4gICAgU2NoZWR1bGVyLnByb3RvdHlwZS5ub3cgPSBkZWZhdWx0Tm93O1xuXG4gICAgLyoqXG4gICAgICogTm9ybWFsaXplcyB0aGUgc3BlY2lmaWVkIFRpbWVTcGFuIHZhbHVlIHRvIGEgcG9zaXRpdmUgdmFsdWUuXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHRpbWVTcGFuIFRoZSB0aW1lIHNwYW4gdmFsdWUgdG8gbm9ybWFsaXplLlxuICAgICAqIEByZXR1cm5zIHtOdW1iZXJ9IFRoZSBzcGVjaWZpZWQgVGltZVNwYW4gdmFsdWUgaWYgaXQgaXMgemVybyBvciBwb3NpdGl2ZTsgb3RoZXJ3aXNlLCAwXG4gICAgICovXG4gICAgU2NoZWR1bGVyLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uICh0aW1lU3Bhbikge1xuICAgICAgdGltZVNwYW4gPCAwICYmICh0aW1lU3BhbiA9IDApO1xuICAgICAgcmV0dXJuIHRpbWVTcGFuO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2NoZWR1bGVyO1xuICB9KCkpO1xuXG4gIHZhciBub3JtYWxpemVUaW1lID0gU2NoZWR1bGVyLm5vcm1hbGl6ZSwgaXNTY2hlZHVsZXIgPSBTY2hlZHVsZXIuaXNTY2hlZHVsZXI7XG5cbiAgKGZ1bmN0aW9uIChzY2hlZHVsZXJQcm90bykge1xuXG4gICAgZnVuY3Rpb24gaW52b2tlUmVjSW1tZWRpYXRlKHNjaGVkdWxlciwgcGFpcikge1xuICAgICAgdmFyIHN0YXRlID0gcGFpclswXSwgYWN0aW9uID0gcGFpclsxXSwgZ3JvdXAgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuICAgICAgYWN0aW9uKHN0YXRlLCBpbm5lckFjdGlvbik7XG4gICAgICByZXR1cm4gZ3JvdXA7XG5cbiAgICAgIGZ1bmN0aW9uIGlubmVyQWN0aW9uKHN0YXRlMikge1xuICAgICAgICB2YXIgaXNBZGRlZCA9IGZhbHNlLCBpc0RvbmUgPSBmYWxzZTtcblxuICAgICAgICB2YXIgZCA9IHNjaGVkdWxlci5zY2hlZHVsZShzdGF0ZTIsIHNjaGVkdWxlV29yayk7XG4gICAgICAgIGlmICghaXNEb25lKSB7XG4gICAgICAgICAgZ3JvdXAuYWRkKGQpO1xuICAgICAgICAgIGlzQWRkZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2NoZWR1bGVXb3JrKF8sIHN0YXRlMykge1xuICAgICAgICAgIGlmIChpc0FkZGVkKSB7XG4gICAgICAgICAgICBncm91cC5yZW1vdmUoZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFjdGlvbihzdGF0ZTMsIGlubmVyQWN0aW9uKTtcbiAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW52b2tlUmVjRGF0ZShzY2hlZHVsZXIsIHBhaXIpIHtcbiAgICAgIHZhciBzdGF0ZSA9IHBhaXJbMF0sIGFjdGlvbiA9IHBhaXJbMV0sIGdyb3VwID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcbiAgICAgIGFjdGlvbihzdGF0ZSwgaW5uZXJBY3Rpb24pO1xuICAgICAgcmV0dXJuIGdyb3VwO1xuXG4gICAgICBmdW5jdGlvbiBpbm5lckFjdGlvbihzdGF0ZTIsIGR1ZVRpbWUxKSB7XG4gICAgICAgIHZhciBpc0FkZGVkID0gZmFsc2UsIGlzRG9uZSA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBkID0gc2NoZWR1bGVyLnNjaGVkdWxlRnV0dXJlKHN0YXRlMiwgZHVlVGltZTEsIHNjaGVkdWxlV29yayk7XG4gICAgICAgIGlmICghaXNEb25lKSB7XG4gICAgICAgICAgZ3JvdXAuYWRkKGQpO1xuICAgICAgICAgIGlzQWRkZWQgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2NoZWR1bGVXb3JrKF8sIHN0YXRlMykge1xuICAgICAgICAgIGlmIChpc0FkZGVkKSB7XG4gICAgICAgICAgICBncm91cC5yZW1vdmUoZCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFjdGlvbihzdGF0ZTMsIGlubmVyQWN0aW9uKTtcbiAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2NoZWR1bGVzIGFuIGFjdGlvbiB0byBiZSBleGVjdXRlZCByZWN1cnNpdmVseS5cbiAgICAgKiBAcGFyYW0ge01peGVkfSBzdGF0ZSBTdGF0ZSBwYXNzZWQgdG8gdGhlIGFjdGlvbiB0byBiZSBleGVjdXRlZC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY3Rpb24gQWN0aW9uIHRvIGV4ZWN1dGUgcmVjdXJzaXZlbHkuIFRoZSBsYXN0IHBhcmFtZXRlciBwYXNzZWQgdG8gdGhlIGFjdGlvbiBpcyB1c2VkIHRvIHRyaWdnZXIgcmVjdXJzaXZlIHNjaGVkdWxpbmcgb2YgdGhlIGFjdGlvbiwgcGFzc2luZyBpbiByZWN1cnNpdmUgaW52b2NhdGlvbiBzdGF0ZS5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG4gICAgICovXG4gICAgc2NoZWR1bGVyUHJvdG8uc2NoZWR1bGVSZWN1cnNpdmUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGUoW3N0YXRlLCBhY3Rpb25dLCBpbnZva2VSZWNJbW1lZGlhdGUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTY2hlZHVsZXMgYW4gYWN0aW9uIHRvIGJlIGV4ZWN1dGVkIHJlY3Vyc2l2ZWx5IGFmdGVyIGEgc3BlY2lmaWVkIHJlbGF0aXZlIG9yIGFic29sdXRlIGR1ZSB0aW1lLlxuICAgICAqIEBwYXJhbSB7TWl4ZWR9IHN0YXRlIFN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFjdGlvbiBBY3Rpb24gdG8gZXhlY3V0ZSByZWN1cnNpdmVseS4gVGhlIGxhc3QgcGFyYW1ldGVyIHBhc3NlZCB0byB0aGUgYWN0aW9uIGlzIHVzZWQgdG8gdHJpZ2dlciByZWN1cnNpdmUgc2NoZWR1bGluZyBvZiB0aGUgYWN0aW9uLCBwYXNzaW5nIGluIHRoZSByZWN1cnNpdmUgZHVlIHRpbWUgYW5kIGludm9jYXRpb24gc3RhdGUuXG4gICAgICogQHBhcmFtIHtOdW1iZXIgfCBEYXRlfSBkdWVUaW1lIFJlbGF0aXZlIG9yIGFic29sdXRlIHRpbWUgYWZ0ZXIgd2hpY2ggdG8gZXhlY3V0ZSB0aGUgYWN0aW9uIGZvciB0aGUgZmlyc3QgdGltZS5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gVGhlIGRpc3Bvc2FibGUgb2JqZWN0IHVzZWQgdG8gY2FuY2VsIHRoZSBzY2hlZHVsZWQgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG4gICAgICovXG4gICAgc2NoZWR1bGVyUHJvdG8uc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVGdXR1cmUoW3N0YXRlLCBhY3Rpb25dLCBkdWVUaW1lLCBpbnZva2VSZWNEYXRlKTtcbiAgICB9O1xuXG4gIH0oU2NoZWR1bGVyLnByb3RvdHlwZSkpO1xuXG4gIChmdW5jdGlvbiAoc2NoZWR1bGVyUHJvdG8pIHtcblxuICAgIC8qKlxuICAgICAqIFNjaGVkdWxlcyBhIHBlcmlvZGljIHBpZWNlIG9mIHdvcmsgYnkgZHluYW1pY2FsbHkgZGlzY292ZXJpbmcgdGhlIHNjaGVkdWxlcidzIGNhcGFiaWxpdGllcy4gVGhlIHBlcmlvZGljIHRhc2sgd2lsbCBiZSBzY2hlZHVsZWQgdXNpbmcgd2luZG93LnNldEludGVydmFsIGZvciB0aGUgYmFzZSBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKiBAcGFyYW0ge01peGVkfSBzdGF0ZSBJbml0aWFsIHN0YXRlIHBhc3NlZCB0byB0aGUgYWN0aW9uIHVwb24gdGhlIGZpcnN0IGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gcGVyaW9kIFBlcmlvZCBmb3IgcnVubmluZyB0aGUgd29yayBwZXJpb2RpY2FsbHkuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYWN0aW9uIEFjdGlvbiB0byBiZSBleGVjdXRlZCwgcG90ZW50aWFsbHkgdXBkYXRpbmcgdGhlIHN0YXRlLlxuICAgICAqIEByZXR1cm5zIHtEaXNwb3NhYmxlfSBUaGUgZGlzcG9zYWJsZSBvYmplY3QgdXNlZCB0byBjYW5jZWwgdGhlIHNjaGVkdWxlZCByZWN1cnJpbmcgYWN0aW9uIChiZXN0IGVmZm9ydCkuXG4gICAgICovXG4gICAgU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZVBlcmlvZGljID0gZnVuY3Rpb24oc3RhdGUsIHBlcmlvZCwgYWN0aW9uKSB7XG4gICAgICBpZiAodHlwZW9mIHJvb3Quc2V0SW50ZXJ2YWwgPT09ICd1bmRlZmluZWQnKSB7IHRocm93IG5ldyBOb3RTdXBwb3J0ZWRFcnJvcigpOyB9XG4gICAgICBwZXJpb2QgPSBub3JtYWxpemVUaW1lKHBlcmlvZCk7XG4gICAgICB2YXIgcyA9IHN0YXRlLCBpZCA9IHJvb3Quc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyBzID0gYWN0aW9uKHMpOyB9LCBwZXJpb2QpO1xuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkgeyByb290LmNsZWFySW50ZXJ2YWwoaWQpOyB9KTtcbiAgICB9O1xuXG4gIH0oU2NoZWR1bGVyLnByb3RvdHlwZSkpO1xuXG4gIC8qKiBHZXRzIGEgc2NoZWR1bGVyIHRoYXQgc2NoZWR1bGVzIHdvcmsgaW1tZWRpYXRlbHkgb24gdGhlIGN1cnJlbnQgdGhyZWFkLiAqL1xuICAgdmFyIEltbWVkaWF0ZVNjaGVkdWxlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoSW1tZWRpYXRlU2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEltbWVkaWF0ZVNjaGVkdWxlcigpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIEltbWVkaWF0ZVNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVGaXh1cChhY3Rpb24odGhpcywgc3RhdGUpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEltbWVkaWF0ZVNjaGVkdWxlcjtcbiAgfShTY2hlZHVsZXIpKTtcblxuICB2YXIgaW1tZWRpYXRlU2NoZWR1bGVyID0gU2NoZWR1bGVyLmltbWVkaWF0ZSA9IG5ldyBJbW1lZGlhdGVTY2hlZHVsZXIoKTtcblxuICAvKipcbiAgICogR2V0cyBhIHNjaGVkdWxlciB0aGF0IHNjaGVkdWxlcyB3b3JrIGFzIHNvb24gYXMgcG9zc2libGUgb24gdGhlIGN1cnJlbnQgdGhyZWFkLlxuICAgKi9cbiAgdmFyIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIHZhciBxdWV1ZTtcblxuICAgIGZ1bmN0aW9uIHJ1blRyYW1wb2xpbmUgKCkge1xuICAgICAgd2hpbGUgKHF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmFyIGl0ZW0gPSBxdWV1ZS5kZXF1ZXVlKCk7XG4gICAgICAgICFpdGVtLmlzQ2FuY2VsbGVkKCkgJiYgaXRlbS5pbnZva2UoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpbmhlcml0cyhDdXJyZW50VGhyZWFkU2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEN1cnJlbnRUaHJlYWRTY2hlZHVsZXIoKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBDdXJyZW50VGhyZWFkU2NoZWR1bGVyLnByb3RvdHlwZS5zY2hlZHVsZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYWN0aW9uKSB7XG4gICAgICB2YXIgc2kgPSBuZXcgU2NoZWR1bGVkSXRlbSh0aGlzLCBzdGF0ZSwgYWN0aW9uLCB0aGlzLm5vdygpKTtcblxuICAgICAgaWYgKCFxdWV1ZSkge1xuICAgICAgICBxdWV1ZSA9IG5ldyBQcmlvcml0eVF1ZXVlKDQpO1xuICAgICAgICBxdWV1ZS5lbnF1ZXVlKHNpKTtcblxuICAgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2gocnVuVHJhbXBvbGluZSkoKTtcbiAgICAgICAgcXVldWUgPSBudWxsO1xuICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyB0aHJvd2VyKHJlc3VsdC5lKTsgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWUuZW5xdWV1ZShzaSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2kuZGlzcG9zYWJsZTtcbiAgICB9O1xuXG4gICAgQ3VycmVudFRocmVhZFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGVSZXF1aXJlZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICFxdWV1ZTsgfTtcblxuICAgIHJldHVybiBDdXJyZW50VGhyZWFkU2NoZWR1bGVyO1xuICB9KFNjaGVkdWxlcikpO1xuXG4gIHZhciBjdXJyZW50VGhyZWFkU2NoZWR1bGVyID0gU2NoZWR1bGVyLmN1cnJlbnRUaHJlYWQgPSBuZXcgQ3VycmVudFRocmVhZFNjaGVkdWxlcigpO1xuXG4gIHZhciBTY2hlZHVsZVBlcmlvZGljUmVjdXJzaXZlID0gUnguaW50ZXJuYWxzLlNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVRpY2soc2VsZikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIHRpY2soY29tbWFuZCwgcmVjdXJzZSkge1xuICAgICAgICByZWN1cnNlKDAsIHNlbGYuX3BlcmlvZCk7XG4gICAgICAgIHZhciBzdGF0ZSA9IHRyeUNhdGNoKHNlbGYuX2FjdGlvbikoc2VsZi5fc3RhdGUpO1xuICAgICAgICBpZiAoc3RhdGUgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgc2VsZi5fY2FuY2VsLmRpc3Bvc2UoKTtcbiAgICAgICAgICB0aHJvd2VyKHN0YXRlLmUpO1xuICAgICAgICB9XG4gICAgICAgIHNlbGYuX3N0YXRlID0gc3RhdGU7XG4gICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIFNjaGVkdWxlUGVyaW9kaWNSZWN1cnNpdmUoc2NoZWR1bGVyLCBzdGF0ZSwgcGVyaW9kLCBhY3Rpb24pIHtcbiAgICAgIHRoaXMuX3NjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICB0aGlzLl9wZXJpb2QgPSBwZXJpb2Q7XG4gICAgICB0aGlzLl9hY3Rpb24gPSBhY3Rpb247XG4gICAgfVxuXG4gICAgU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgdGhpcy5fY2FuY2VsID0gZDtcbiAgICAgIGQuc2V0RGlzcG9zYWJsZSh0aGlzLl9zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmVGdXR1cmUoMCwgdGhpcy5fcGVyaW9kLCBjcmVhdGVUaWNrKHRoaXMpKSk7XG5cbiAgICAgIHJldHVybiBkO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2NoZWR1bGVQZXJpb2RpY1JlY3Vyc2l2ZTtcbiAgfSgpKTtcblxuICB2YXIgc2NoZWR1bGVNZXRob2QsIGNsZWFyTWV0aG9kO1xuXG4gIHZhciBsb2NhbFRpbWVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbG9jYWxTZXRUaW1lb3V0LCBsb2NhbENsZWFyVGltZW91dCA9IG5vb3A7XG4gICAgaWYgKCEhcm9vdC5zZXRUaW1lb3V0KSB7XG4gICAgICBsb2NhbFNldFRpbWVvdXQgPSByb290LnNldFRpbWVvdXQ7XG4gICAgICBsb2NhbENsZWFyVGltZW91dCA9IHJvb3QuY2xlYXJUaW1lb3V0O1xuICAgIH0gZWxzZSBpZiAoISFyb290LldTY3JpcHQpIHtcbiAgICAgIGxvY2FsU2V0VGltZW91dCA9IGZ1bmN0aW9uIChmbiwgdGltZSkge1xuICAgICAgICByb290LldTY3JpcHQuU2xlZXAodGltZSk7XG4gICAgICAgIGZuKCk7XG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgTm90U3VwcG9ydGVkRXJyb3IoKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc2V0VGltZW91dDogbG9jYWxTZXRUaW1lb3V0LFxuICAgICAgY2xlYXJUaW1lb3V0OiBsb2NhbENsZWFyVGltZW91dFxuICAgIH07XG4gIH0oKSk7XG4gIHZhciBsb2NhbFNldFRpbWVvdXQgPSBsb2NhbFRpbWVyLnNldFRpbWVvdXQsXG4gICAgbG9jYWxDbGVhclRpbWVvdXQgPSBsb2NhbFRpbWVyLmNsZWFyVGltZW91dDtcblxuICAoZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIG5leHRIYW5kbGUgPSAxLCB0YXNrc0J5SGFuZGxlID0ge30sIGN1cnJlbnRseVJ1bm5pbmcgPSBmYWxzZTtcblxuICAgIGNsZWFyTWV0aG9kID0gZnVuY3Rpb24gKGhhbmRsZSkge1xuICAgICAgZGVsZXRlIHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcnVuVGFzayhoYW5kbGUpIHtcbiAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nKSB7XG4gICAgICAgIGxvY2FsU2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJ1blRhc2soaGFuZGxlKTsgfSwgMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgdGFzayA9IHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcbiAgICAgICAgaWYgKHRhc2spIHtcbiAgICAgICAgICBjdXJyZW50bHlSdW5uaW5nID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGFzaykoKTtcbiAgICAgICAgICBjbGVhck1ldGhvZChoYW5kbGUpO1xuICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyB0aHJvd2VyKHJlc3VsdC5lKTsgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHJlTmF0aXZlID0gbmV3IFJlZ0V4cCgnXicgK1xuICAgICAgU3RyaW5nKHRvU3RyaW5nKVxuICAgICAgICAucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKVxuICAgICAgICAucmVwbGFjZSgvdG9TdHJpbmd8IGZvciBbXlxcXV0rL2csICcuKj8nKSArICckJ1xuICAgICk7XG5cbiAgICB2YXIgc2V0SW1tZWRpYXRlID0gdHlwZW9mIChzZXRJbW1lZGlhdGUgPSBmcmVlR2xvYmFsICYmIG1vZHVsZUV4cG9ydHMgJiYgZnJlZUdsb2JhbC5zZXRJbW1lZGlhdGUpID09ICdmdW5jdGlvbicgJiZcbiAgICAgICFyZU5hdGl2ZS50ZXN0KHNldEltbWVkaWF0ZSkgJiYgc2V0SW1tZWRpYXRlO1xuXG4gICAgZnVuY3Rpb24gcG9zdE1lc3NhZ2VTdXBwb3J0ZWQgKCkge1xuICAgICAgLy8gRW5zdXJlIG5vdCBpbiBhIHdvcmtlclxuICAgICAgaWYgKCFyb290LnBvc3RNZXNzYWdlIHx8IHJvb3QuaW1wb3J0U2NyaXB0cykgeyByZXR1cm4gZmFsc2U7IH1cbiAgICAgIHZhciBpc0FzeW5jID0gZmFsc2UsIG9sZEhhbmRsZXIgPSByb290Lm9ubWVzc2FnZTtcbiAgICAgIC8vIFRlc3QgZm9yIGFzeW5jXG4gICAgICByb290Lm9ubWVzc2FnZSA9IGZ1bmN0aW9uICgpIHsgaXNBc3luYyA9IHRydWU7IH07XG4gICAgICByb290LnBvc3RNZXNzYWdlKCcnLCAnKicpO1xuICAgICAgcm9vdC5vbm1lc3NhZ2UgPSBvbGRIYW5kbGVyO1xuXG4gICAgICByZXR1cm4gaXNBc3luYztcbiAgICB9XG5cbiAgICAvLyBVc2UgaW4gb3JkZXIsIHNldEltbWVkaWF0ZSwgbmV4dFRpY2ssIHBvc3RNZXNzYWdlLCBNZXNzYWdlQ2hhbm5lbCwgc2NyaXB0IHJlYWR5c3RhdGVjaGFuZ2VkLCBzZXRUaW1lb3V0XG4gICAgaWYgKGlzRnVuY3Rpb24oc2V0SW1tZWRpYXRlKSkge1xuICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcbiAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG4gICAgICAgIHNldEltbWVkaWF0ZShmdW5jdGlvbiAoKSB7IHJ1blRhc2soaWQpOyB9KTtcblxuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHt9LnRvU3RyaW5nLmNhbGwocHJvY2VzcykgPT09ICdbb2JqZWN0IHByb2Nlc3NdJykge1xuICAgICAgc2NoZWR1bGVNZXRob2QgPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIHZhciBpZCA9IG5leHRIYW5kbGUrKztcbiAgICAgICAgdGFza3NCeUhhbmRsZVtpZF0gPSBhY3Rpb247XG4gICAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkgeyBydW5UYXNrKGlkKTsgfSk7XG5cbiAgICAgICAgcmV0dXJuIGlkO1xuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHBvc3RNZXNzYWdlU3VwcG9ydGVkKCkpIHtcbiAgICAgIHZhciBNU0dfUFJFRklYID0gJ21zLnJ4LnNjaGVkdWxlJyArIE1hdGgucmFuZG9tKCk7XG5cbiAgICAgIHZhciBvbkdsb2JhbFBvc3RNZXNzYWdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIE9ubHkgaWYgd2UncmUgYSBtYXRjaCB0byBhdm9pZCBhbnkgb3RoZXIgZ2xvYmFsIGV2ZW50c1xuICAgICAgICBpZiAodHlwZW9mIGV2ZW50LmRhdGEgPT09ICdzdHJpbmcnICYmIGV2ZW50LmRhdGEuc3Vic3RyaW5nKDAsIE1TR19QUkVGSVgubGVuZ3RoKSA9PT0gTVNHX1BSRUZJWCkge1xuICAgICAgICAgIHJ1blRhc2soZXZlbnQuZGF0YS5zdWJzdHJpbmcoTVNHX1BSRUZJWC5sZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgcm9vdC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgb25HbG9iYWxQb3N0TWVzc2FnZSwgZmFsc2UpO1xuXG4gICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcbiAgICAgICAgcm9vdC5wb3N0TWVzc2FnZShNU0dfUFJFRklYICsgY3VycmVudElkLCAnKicpO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAoISFyb290Lk1lc3NhZ2VDaGFubmVsKSB7XG4gICAgICB2YXIgY2hhbm5lbCA9IG5ldyByb290Lk1lc3NhZ2VDaGFubmVsKCk7XG5cbiAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsgcnVuVGFzayhlLmRhdGEpOyB9O1xuXG4gICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIGlkID0gbmV4dEhhbmRsZSsrO1xuICAgICAgICB0YXNrc0J5SGFuZGxlW2lkXSA9IGFjdGlvbjtcbiAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZShpZCk7XG4gICAgICAgIHJldHVybiBpZDtcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmICgnZG9jdW1lbnQnIGluIHJvb3QgJiYgJ29ucmVhZHlzdGF0ZWNoYW5nZScgaW4gcm9vdC5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKSkge1xuXG4gICAgICBzY2hlZHVsZU1ldGhvZCA9IGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgdmFyIHNjcmlwdEVsZW1lbnQgPSByb290LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG4gICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuXG4gICAgICAgIHNjcmlwdEVsZW1lbnQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJ1blRhc2soaWQpO1xuICAgICAgICAgIHNjcmlwdEVsZW1lbnQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICBzY3JpcHRFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc2NyaXB0RWxlbWVudCk7XG4gICAgICAgICAgc2NyaXB0RWxlbWVudCA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIHJvb3QuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKHNjcmlwdEVsZW1lbnQpO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuXG4gICAgfSBlbHNlIHtcbiAgICAgIHNjaGVkdWxlTWV0aG9kID0gZnVuY3Rpb24gKGFjdGlvbikge1xuICAgICAgICB2YXIgaWQgPSBuZXh0SGFuZGxlKys7XG4gICAgICAgIHRhc2tzQnlIYW5kbGVbaWRdID0gYWN0aW9uO1xuICAgICAgICBsb2NhbFNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJ1blRhc2soaWQpO1xuICAgICAgICB9LCAwKTtcblxuICAgICAgICByZXR1cm4gaWQ7XG4gICAgICB9O1xuICAgIH1cbiAgfSgpKTtcblxuICAvKipcbiAgICogR2V0cyBhIHNjaGVkdWxlciB0aGF0IHNjaGVkdWxlcyB3b3JrIHZpYSBhIHRpbWVkIGNhbGxiYWNrIGJhc2VkIHVwb24gcGxhdGZvcm0uXG4gICAqL1xuICAgdmFyIERlZmF1bHRTY2hlZHVsZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgICBpbmhlcml0cyhEZWZhdWx0U2NoZWR1bGVyLCBfX3N1cGVyX18pO1xuICAgICBmdW5jdGlvbiBEZWZhdWx0U2NoZWR1bGVyKCkge1xuICAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgICB9XG5cbiAgICAgZnVuY3Rpb24gc2NoZWR1bGVBY3Rpb24oZGlzcG9zYWJsZSwgYWN0aW9uLCBzY2hlZHVsZXIsIHN0YXRlKSB7XG4gICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNjaGVkdWxlKCkge1xuICAgICAgICAgIWRpc3Bvc2FibGUuaXNEaXNwb3NlZCAmJiBkaXNwb3NhYmxlLnNldERpc3Bvc2FibGUoRGlzcG9zYWJsZS5fZml4dXAoYWN0aW9uKHNjaGVkdWxlciwgc3RhdGUpKSk7XG4gICAgICAgfTtcbiAgICAgfVxuXG4gICAgIGZ1bmN0aW9uIENsZWFyRGlzcG9zYWJsZShtZXRob2QsIGlkKSB7XG4gICAgICAgdGhpcy5faWQgPSBpZDtcbiAgICAgICB0aGlzLl9tZXRob2QgPSBtZXRob2Q7XG4gICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgIH1cblxuICAgICBDbGVhckRpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgaWYgKCF0aGlzLmlzRGlzcG9zZWQpIHtcbiAgICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICB0aGlzLl9tZXRob2QuY2FsbChudWxsLCB0aGlzLl9pZCk7XG4gICAgICAgfVxuICAgICB9O1xuXG4gICAgRGVmYXVsdFNjaGVkdWxlci5wcm90b3R5cGUuc2NoZWR1bGUgPSBmdW5jdGlvbiAoc3RhdGUsIGFjdGlvbikge1xuICAgICAgdmFyIGRpc3Bvc2FibGUgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcbiAgICAgICAgICBpZCA9IHNjaGVkdWxlTWV0aG9kKHNjaGVkdWxlQWN0aW9uKGRpc3Bvc2FibGUsIGFjdGlvbiwgdGhpcywgc3RhdGUpKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShkaXNwb3NhYmxlLCBuZXcgQ2xlYXJEaXNwb3NhYmxlKGNsZWFyTWV0aG9kLCBpZCkpO1xuICAgIH07XG5cbiAgICBEZWZhdWx0U2NoZWR1bGVyLnByb3RvdHlwZS5fc2NoZWR1bGVGdXR1cmUgPSBmdW5jdGlvbiAoc3RhdGUsIGR1ZVRpbWUsIGFjdGlvbikge1xuICAgICAgaWYgKGR1ZVRpbWUgPT09IDApIHsgcmV0dXJuIHRoaXMuc2NoZWR1bGUoc3RhdGUsIGFjdGlvbik7IH1cbiAgICAgIHZhciBkaXNwb3NhYmxlID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksXG4gICAgICAgICAgaWQgPSBsb2NhbFNldFRpbWVvdXQoc2NoZWR1bGVBY3Rpb24oZGlzcG9zYWJsZSwgYWN0aW9uLCB0aGlzLCBzdGF0ZSksIGR1ZVRpbWUpO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKGRpc3Bvc2FibGUsIG5ldyBDbGVhckRpc3Bvc2FibGUobG9jYWxDbGVhclRpbWVvdXQsIGlkKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBEZWZhdWx0U2NoZWR1bGVyO1xuICB9KFNjaGVkdWxlcikpO1xuXG4gIHZhciBkZWZhdWx0U2NoZWR1bGVyID0gU2NoZWR1bGVyWydkZWZhdWx0J10gPSBTY2hlZHVsZXIuYXN5bmMgPSBuZXcgRGVmYXVsdFNjaGVkdWxlcigpO1xuXG4gIGZ1bmN0aW9uIEluZGV4ZWRJdGVtKGlkLCB2YWx1ZSkge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gIH1cblxuICBJbmRleGVkSXRlbS5wcm90b3R5cGUuY29tcGFyZVRvID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgdmFyIGMgPSB0aGlzLnZhbHVlLmNvbXBhcmVUbyhvdGhlci52YWx1ZSk7XG4gICAgYyA9PT0gMCAmJiAoYyA9IHRoaXMuaWQgLSBvdGhlci5pZCk7XG4gICAgcmV0dXJuIGM7XG4gIH07XG5cbiAgdmFyIFByaW9yaXR5UXVldWUgPSBSeC5pbnRlcm5hbHMuUHJpb3JpdHlRdWV1ZSA9IGZ1bmN0aW9uIChjYXBhY2l0eSkge1xuICAgIHRoaXMuaXRlbXMgPSBuZXcgQXJyYXkoY2FwYWNpdHkpO1xuICAgIHRoaXMubGVuZ3RoID0gMDtcbiAgfTtcblxuICB2YXIgcHJpb3JpdHlQcm90byA9IFByaW9yaXR5UXVldWUucHJvdG90eXBlO1xuICBwcmlvcml0eVByb3RvLmlzSGlnaGVyUHJpb3JpdHkgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcbiAgICByZXR1cm4gdGhpcy5pdGVtc1tsZWZ0XS5jb21wYXJlVG8odGhpcy5pdGVtc1tyaWdodF0pIDwgMDtcbiAgfTtcblxuICBwcmlvcml0eVByb3RvLnBlcmNvbGF0ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgIGlmIChpbmRleCA+PSB0aGlzLmxlbmd0aCB8fCBpbmRleCA8IDApIHsgcmV0dXJuOyB9XG4gICAgdmFyIHBhcmVudCA9IGluZGV4IC0gMSA+PiAxO1xuICAgIGlmIChwYXJlbnQgPCAwIHx8IHBhcmVudCA9PT0gaW5kZXgpIHsgcmV0dXJuOyB9XG4gICAgaWYgKHRoaXMuaXNIaWdoZXJQcmlvcml0eShpbmRleCwgcGFyZW50KSkge1xuICAgICAgdmFyIHRlbXAgPSB0aGlzLml0ZW1zW2luZGV4XTtcbiAgICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gdGhpcy5pdGVtc1twYXJlbnRdO1xuICAgICAgdGhpcy5pdGVtc1twYXJlbnRdID0gdGVtcDtcbiAgICAgIHRoaXMucGVyY29sYXRlKHBhcmVudCk7XG4gICAgfVxuICB9O1xuXG4gIHByaW9yaXR5UHJvdG8uaGVhcGlmeSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICtpbmRleCB8fCAoaW5kZXggPSAwKTtcbiAgICBpZiAoaW5kZXggPj0gdGhpcy5sZW5ndGggfHwgaW5kZXggPCAwKSB7IHJldHVybjsgfVxuICAgIHZhciBsZWZ0ID0gMiAqIGluZGV4ICsgMSxcbiAgICAgICAgcmlnaHQgPSAyICogaW5kZXggKyAyLFxuICAgICAgICBmaXJzdCA9IGluZGV4O1xuICAgIGlmIChsZWZ0IDwgdGhpcy5sZW5ndGggJiYgdGhpcy5pc0hpZ2hlclByaW9yaXR5KGxlZnQsIGZpcnN0KSkge1xuICAgICAgZmlyc3QgPSBsZWZ0O1xuICAgIH1cbiAgICBpZiAocmlnaHQgPCB0aGlzLmxlbmd0aCAmJiB0aGlzLmlzSGlnaGVyUHJpb3JpdHkocmlnaHQsIGZpcnN0KSkge1xuICAgICAgZmlyc3QgPSByaWdodDtcbiAgICB9XG4gICAgaWYgKGZpcnN0ICE9PSBpbmRleCkge1xuICAgICAgdmFyIHRlbXAgPSB0aGlzLml0ZW1zW2luZGV4XTtcbiAgICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gdGhpcy5pdGVtc1tmaXJzdF07XG4gICAgICB0aGlzLml0ZW1zW2ZpcnN0XSA9IHRlbXA7XG4gICAgICB0aGlzLmhlYXBpZnkoZmlyc3QpO1xuICAgIH1cbiAgfTtcblxuICBwcmlvcml0eVByb3RvLnBlZWsgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLml0ZW1zWzBdLnZhbHVlOyB9O1xuXG4gIHByaW9yaXR5UHJvdG8ucmVtb3ZlQXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICB0aGlzLml0ZW1zW2luZGV4XSA9IHRoaXMuaXRlbXNbLS10aGlzLmxlbmd0aF07XG4gICAgdGhpcy5pdGVtc1t0aGlzLmxlbmd0aF0gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5oZWFwaWZ5KCk7XG4gIH07XG5cbiAgcHJpb3JpdHlQcm90by5kZXF1ZXVlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciByZXN1bHQgPSB0aGlzLnBlZWsoKTtcbiAgICB0aGlzLnJlbW92ZUF0KDApO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH07XG5cbiAgcHJpb3JpdHlQcm90by5lbnF1ZXVlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICB2YXIgaW5kZXggPSB0aGlzLmxlbmd0aCsrO1xuICAgIHRoaXMuaXRlbXNbaW5kZXhdID0gbmV3IEluZGV4ZWRJdGVtKFByaW9yaXR5UXVldWUuY291bnQrKywgaXRlbSk7XG4gICAgdGhpcy5wZXJjb2xhdGUoaW5kZXgpO1xuICB9O1xuXG4gIHByaW9yaXR5UHJvdG8ucmVtb3ZlID0gZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLml0ZW1zW2ldLnZhbHVlID09PSBpdGVtKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlQXQoaSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIFByaW9yaXR5UXVldWUuY291bnQgPSAwO1xuXG4gIC8qKlxuICAgKiAgUmVwcmVzZW50cyBhIG5vdGlmaWNhdGlvbiB0byBhbiBvYnNlcnZlci5cbiAgICovXG4gIHZhciBOb3RpZmljYXRpb24gPSBSeC5Ob3RpZmljYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE5vdGlmaWNhdGlvbigpIHtcblxuICAgIH1cblxuICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICB0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFcnJvcigpO1xuICAgIH07XG5cbiAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHRPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBOb3RJbXBsZW1lbnRlZEVycm9yKCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEludm9rZXMgdGhlIGRlbGVnYXRlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIG5vdGlmaWNhdGlvbiBvciB0aGUgb2JzZXJ2ZXIncyBtZXRob2QgY29ycmVzcG9uZGluZyB0byB0aGUgbm90aWZpY2F0aW9uIGFuZCByZXR1cm5zIHRoZSBwcm9kdWNlZCByZXN1bHQuXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTm90aWZpY2F0aW9uXG4gICAgICogQHBhcmFtIHtBbnl9IG9ic2VydmVyT3JPbk5leHQgRGVsZWdhdGUgdG8gaW52b2tlIGZvciBhbiBPbk5leHQgbm90aWZpY2F0aW9uIG9yIE9ic2VydmVyIHRvIGludm9rZSB0aGUgbm90aWZpY2F0aW9uIG9uLi5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkVycm9yIERlbGVnYXRlIHRvIGludm9rZSBmb3IgYW4gT25FcnJvciBub3RpZmljYXRpb24uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25Db21wbGV0ZWQgRGVsZWdhdGUgdG8gaW52b2tlIGZvciBhbiBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24uXG4gICAgICogQHJldHVybnMge0FueX0gUmVzdWx0IHByb2R1Y2VkIGJ5IHRoZSBvYnNlcnZhdGlvbi5cbiAgICAgKi9cbiAgICBOb3RpZmljYXRpb24ucHJvdG90eXBlLmFjY2VwdCA9IGZ1bmN0aW9uIChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuICAgICAgcmV0dXJuIG9ic2VydmVyT3JPbk5leHQgJiYgdHlwZW9mIG9ic2VydmVyT3JPbk5leHQgPT09ICdvYmplY3QnID9cbiAgICAgICAgdGhpcy5fYWNjZXB0T2JzZXJ2YWJsZShvYnNlcnZlck9yT25OZXh0KSA6XG4gICAgICAgIHRoaXMuX2FjY2VwdChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIGEgc2luZ2xlIG5vdGlmaWNhdGlvbi5cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBOb3RpZmljYXRpb25zXG4gICAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBzZW5kIG91dCB0aGUgbm90aWZpY2F0aW9uIGNhbGxzIG9uLlxuICAgICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHN1cmZhY2VzIHRoZSBiZWhhdmlvciBvZiB0aGUgbm90aWZpY2F0aW9uIHVwb24gc3Vic2NyaXB0aW9uLlxuICAgICAqL1xuICAgIE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9PYnNlcnZhYmxlID0gZnVuY3Rpb24gKHNjaGVkdWxlcikge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcbiAgICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlKHNlbGYsIGZ1bmN0aW9uIChfLCBub3RpZmljYXRpb24pIHtcbiAgICAgICAgICBub3RpZmljYXRpb24uX2FjY2VwdE9ic2VydmFibGUobyk7XG4gICAgICAgICAgbm90aWZpY2F0aW9uLmtpbmQgPT09ICdOJyAmJiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiBOb3RpZmljYXRpb247XG4gIH0pKCk7XG5cbiAgdmFyIE9uTmV4dE5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoT25OZXh0Tm90aWZpY2F0aW9uLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE9uTmV4dE5vdGlmaWNhdGlvbih2YWx1ZSkge1xuICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgdGhpcy5raW5kID0gJ04nO1xuICAgIH1cblxuICAgIE9uTmV4dE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdCA9IGZ1bmN0aW9uIChvbk5leHQpIHtcbiAgICAgIHJldHVybiBvbk5leHQodGhpcy52YWx1ZSk7XG4gICAgfTtcblxuICAgIE9uTmV4dE5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIG8ub25OZXh0KHRoaXMudmFsdWUpO1xuICAgIH07XG5cbiAgICBPbk5leHROb3RpZmljYXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuICdPbk5leHQoJyArIHRoaXMudmFsdWUgKyAnKSc7XG4gICAgfTtcblxuICAgIHJldHVybiBPbk5leHROb3RpZmljYXRpb247XG4gIH0oTm90aWZpY2F0aW9uKSk7XG5cbiAgdmFyIE9uRXJyb3JOb3RpZmljYXRpb24gPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE9uRXJyb3JOb3RpZmljYXRpb24sIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gT25FcnJvck5vdGlmaWNhdGlvbihlcnJvcikge1xuICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuICAgICAgdGhpcy5raW5kID0gJ0UnO1xuICAgIH1cblxuICAgIE9uRXJyb3JOb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHQgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yKSB7XG4gICAgICByZXR1cm4gb25FcnJvcih0aGlzLmVycm9yKTtcbiAgICB9O1xuXG4gICAgT25FcnJvck5vdGlmaWNhdGlvbi5wcm90b3R5cGUuX2FjY2VwdE9ic2VydmFibGUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIG8ub25FcnJvcih0aGlzLmVycm9yKTtcbiAgICB9O1xuXG4gICAgT25FcnJvck5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gJ09uRXJyb3IoJyArIHRoaXMuZXJyb3IgKyAnKSc7XG4gICAgfTtcblxuICAgIHJldHVybiBPbkVycm9yTm90aWZpY2F0aW9uO1xuICB9KE5vdGlmaWNhdGlvbikpO1xuXG4gIHZhciBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoT25Db21wbGV0ZWROb3RpZmljYXRpb24sIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gT25Db21wbGV0ZWROb3RpZmljYXRpb24oKSB7XG4gICAgICB0aGlzLmtpbmQgPSAnQyc7XG4gICAgfVxuXG4gICAgT25Db21wbGV0ZWROb3RpZmljYXRpb24ucHJvdG90eXBlLl9hY2NlcHQgPSBmdW5jdGlvbiAob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuICAgICAgcmV0dXJuIG9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIE9uQ29tcGxldGVkTm90aWZpY2F0aW9uLnByb3RvdHlwZS5fYWNjZXB0T2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gJ09uQ29tcGxldGVkKCknO1xuICAgIH07XG5cbiAgICByZXR1cm4gT25Db21wbGV0ZWROb3RpZmljYXRpb247XG4gIH0oTm90aWZpY2F0aW9uKSk7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhbiBPbk5leHQgbm90aWZpY2F0aW9uIHRvIGFuIG9ic2VydmVyLlxuICAgKiBAcGFyYW0ge0FueX0gdmFsdWUgVGhlIHZhbHVlIGNvbnRhaW5lZCBpbiB0aGUgbm90aWZpY2F0aW9uLlxuICAgKiBAcmV0dXJucyB7Tm90aWZpY2F0aW9ufSBUaGUgT25OZXh0IG5vdGlmaWNhdGlvbiBjb250YWluaW5nIHRoZSB2YWx1ZS5cbiAgICovXG4gIHZhciBub3RpZmljYXRpb25DcmVhdGVPbk5leHQgPSBOb3RpZmljYXRpb24uY3JlYXRlT25OZXh0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgcmV0dXJuIG5ldyBPbk5leHROb3RpZmljYXRpb24odmFsdWUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIG9iamVjdCB0aGF0IHJlcHJlc2VudHMgYW4gT25FcnJvciBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG4gICAqIEBwYXJhbSB7QW55fSBlcnJvciBUaGUgZXhjZXB0aW9uIGNvbnRhaW5lZCBpbiB0aGUgbm90aWZpY2F0aW9uLlxuICAgKiBAcmV0dXJucyB7Tm90aWZpY2F0aW9ufSBUaGUgT25FcnJvciBub3RpZmljYXRpb24gY29udGFpbmluZyB0aGUgZXhjZXB0aW9uLlxuICAgKi9cbiAgdmFyIG5vdGlmaWNhdGlvbkNyZWF0ZU9uRXJyb3IgPSBOb3RpZmljYXRpb24uY3JlYXRlT25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgIHJldHVybiBuZXcgT25FcnJvck5vdGlmaWNhdGlvbihlcnJvcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhbiBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24gdG8gYW4gb2JzZXJ2ZXIuXG4gICAqIEByZXR1cm5zIHtOb3RpZmljYXRpb259IFRoZSBPbkNvbXBsZXRlZCBub3RpZmljYXRpb24uXG4gICAqL1xuICB2YXIgbm90aWZpY2F0aW9uQ3JlYXRlT25Db21wbGV0ZWQgPSBOb3RpZmljYXRpb24uY3JlYXRlT25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBPbkNvbXBsZXRlZE5vdGlmaWNhdGlvbigpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdXBwb3J0cyBwdXNoLXN0eWxlIGl0ZXJhdGlvbiBvdmVyIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqL1xuICB2YXIgT2JzZXJ2ZXIgPSBSeC5PYnNlcnZlciA9IGZ1bmN0aW9uICgpIHsgfTtcblxuICAvKipcbiAgICogIENyZWF0ZXMgYW4gb2JzZXJ2ZXIgZnJvbSB0aGUgc3BlY2lmaWVkIE9uTmV4dCwgYWxvbmcgd2l0aCBvcHRpb25hbCBPbkVycm9yLCBhbmQgT25Db21wbGV0ZWQgYWN0aW9ucy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uTmV4dF0gT2JzZXJ2ZXIncyBPbk5leHQgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb25FcnJvcl0gT2JzZXJ2ZXIncyBPbkVycm9yIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW29uQ29tcGxldGVkXSBPYnNlcnZlcidzIE9uQ29tcGxldGVkIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICogQHJldHVybnMge09ic2VydmVyfSBUaGUgb2JzZXJ2ZXIgb2JqZWN0IGltcGxlbWVudGVkIHVzaW5nIHRoZSBnaXZlbiBhY3Rpb25zLlxuICAgKi9cbiAgdmFyIG9ic2VydmVyQ3JlYXRlID0gT2JzZXJ2ZXIuY3JlYXRlID0gZnVuY3Rpb24gKG9uTmV4dCwgb25FcnJvciwgb25Db21wbGV0ZWQpIHtcbiAgICBvbk5leHQgfHwgKG9uTmV4dCA9IG5vb3ApO1xuICAgIG9uRXJyb3IgfHwgKG9uRXJyb3IgPSBkZWZhdWx0RXJyb3IpO1xuICAgIG9uQ29tcGxldGVkIHx8IChvbkNvbXBsZXRlZCA9IG5vb3ApO1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2ZXIob25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgT2JzZXJ2ZXIgY2xhc3MuXG4gICAqIFRoaXMgYmFzZSBjbGFzcyBlbmZvcmNlcyB0aGUgZ3JhbW1hciBvZiBvYnNlcnZlcnMgd2hlcmUgT25FcnJvciBhbmQgT25Db21wbGV0ZWQgYXJlIHRlcm1pbmFsIG1lc3NhZ2VzLlxuICAgKi9cbiAgdmFyIEFic3RyYWN0T2JzZXJ2ZXIgPSBSeC5pbnRlcm5hbHMuQWJzdHJhY3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQWJzdHJhY3RPYnNlcnZlciwgX19zdXBlcl9fKTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgb2JzZXJ2ZXIgaW4gYSBub24tc3RvcHBlZCBzdGF0ZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBYnN0cmFjdE9ic2VydmVyKCkge1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBNdXN0IGJlIGltcGxlbWVudGVkIGJ5IG90aGVyIG9ic2VydmVyc1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBub3RJbXBsZW1lbnRlZDtcbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IG5vdEltcGxlbWVudGVkO1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IG5vdEltcGxlbWVudGVkO1xuXG4gICAgLyoqXG4gICAgICogTm90aWZpZXMgdGhlIG9ic2VydmVyIG9mIGEgbmV3IGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuICAgICAqIEBwYXJhbSB7QW55fSB2YWx1ZSBOZXh0IGVsZW1lbnQgaW4gdGhlIHNlcXVlbmNlLlxuICAgICAqL1xuICAgIEFic3RyYWN0T2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgIXRoaXMuaXNTdG9wcGVkICYmIHRoaXMubmV4dCh2YWx1ZSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIHRoZSBvYnNlcnZlciB0aGF0IGFuIGV4Y2VwdGlvbiBoYXMgb2NjdXJyZWQuXG4gICAgICogQHBhcmFtIHtBbnl9IGVycm9yIFRoZSBlcnJvciB0aGF0IGhhcyBvY2N1cnJlZC5cbiAgICAgKi9cbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5lcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIE5vdGlmaWVzIHRoZSBvYnNlcnZlciBvZiB0aGUgZW5kIG9mIHRoZSBzZXF1ZW5jZS5cbiAgICAgKi9cbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBEaXNwb3NlcyB0aGUgb2JzZXJ2ZXIsIGNhdXNpbmcgaXQgdG8gdHJhbnNpdGlvbiB0byB0aGUgc3RvcHBlZCBzdGF0ZS5cbiAgICAgKi9cbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG5cbiAgICBBYnN0cmFjdE9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLmVycm9yKGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICByZXR1cm4gQWJzdHJhY3RPYnNlcnZlcjtcbiAgfShPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBDbGFzcyB0byBjcmVhdGUgYW4gT2JzZXJ2ZXIgaW5zdGFuY2UgZnJvbSBkZWxlZ2F0ZS1iYXNlZCBpbXBsZW1lbnRhdGlvbnMgb2YgdGhlIG9uKiBtZXRob2RzLlxuICAgKi9cbiAgdmFyIEFub255bW91c09ic2VydmVyID0gUnguQW5vbnltb3VzT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEFub255bW91c09ic2VydmVyLCBfX3N1cGVyX18pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBvYnNlcnZlciBmcm9tIHRoZSBzcGVjaWZpZWQgT25OZXh0LCBPbkVycm9yLCBhbmQgT25Db21wbGV0ZWQgYWN0aW9ucy5cbiAgICAgKiBAcGFyYW0ge0FueX0gb25OZXh0IE9ic2VydmVyJ3MgT25OZXh0IGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FueX0gb25FcnJvciBPYnNlcnZlcidzIE9uRXJyb3IgYWN0aW9uIGltcGxlbWVudGF0aW9uLlxuICAgICAqIEBwYXJhbSB7QW55fSBvbkNvbXBsZXRlZCBPYnNlcnZlcidzIE9uQ29tcGxldGVkIGFjdGlvbiBpbXBsZW1lbnRhdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBbm9ueW1vdXNPYnNlcnZlcihvbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuX29uTmV4dCA9IG9uTmV4dDtcbiAgICAgIHRoaXMuX29uRXJyb3IgPSBvbkVycm9yO1xuICAgICAgdGhpcy5fb25Db21wbGV0ZWQgPSBvbkNvbXBsZXRlZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYWxscyB0aGUgb25OZXh0IGFjdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FueX0gdmFsdWUgTmV4dCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cbiAgICAgKi9cbiAgICBBbm9ueW1vdXNPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdGhpcy5fb25OZXh0KHZhbHVlKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FsbHMgdGhlIG9uRXJyb3IgYWN0aW9uLlxuICAgICAqIEBwYXJhbSB7QW55fSBlcnJvciBUaGUgZXJyb3IgdGhhdCBoYXMgb2NjdXJyZWQuXG4gICAgICovXG4gICAgQW5vbnltb3VzT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICB0aGlzLl9vbkVycm9yKGVycm9yKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogIENhbGxzIHRoZSBvbkNvbXBsZXRlZCBhY3Rpb24uXG4gICAgICovXG4gICAgQW5vbnltb3VzT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX29uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBBbm9ueW1vdXNPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgdmFyIG9ic2VydmFibGVQcm90bztcblxuICAvKipcbiAgICogUmVwcmVzZW50cyBhIHB1c2gtc3R5bGUgY29sbGVjdGlvbi5cbiAgICovXG4gIHZhciBPYnNlcnZhYmxlID0gUnguT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICBmdW5jdGlvbiBtYWtlU3Vic2NyaWJlKHNlbGYsIHN1YnNjcmliZSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIHZhciBvbGRPbkVycm9yID0gby5vbkVycm9yO1xuICAgICAgICBvLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIG1ha2VTdGFja1RyYWNlTG9uZyhlLCBzZWxmKTtcbiAgICAgICAgICBvbGRPbkVycm9yLmNhbGwobywgZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHN1YnNjcmliZS5jYWxsKHNlbGYsIG8pO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlKCkge1xuICAgICAgaWYgKFJ4LmNvbmZpZy5sb25nU3RhY2tTdXBwb3J0ICYmIGhhc1N0YWNrcykge1xuICAgICAgICB2YXIgb2xkU3Vic2NyaWJlID0gdGhpcy5fc3Vic2NyaWJlO1xuICAgICAgICB2YXIgZSA9IHRyeUNhdGNoKHRocm93ZXIpKG5ldyBFcnJvcigpKS5lO1xuICAgICAgICB0aGlzLnN0YWNrID0gZS5zdGFjay5zdWJzdHJpbmcoZS5zdGFjay5pbmRleE9mKCdcXG4nKSArIDEpO1xuICAgICAgICB0aGlzLl9zdWJzY3JpYmUgPSBtYWtlU3Vic2NyaWJlKHRoaXMsIG9sZFN1YnNjcmliZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgb2JzZXJ2YWJsZVByb3RvID0gT2JzZXJ2YWJsZS5wcm90b3R5cGU7XG5cbiAgICAvKipcbiAgICAqIERldGVybWluZXMgd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGFuIE9ic2VydmFibGVcbiAgICAqIEBwYXJhbSB7QW55fSBBbiBvYmplY3QgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgaXQgaXMgYW4gT2JzZXJ2YWJsZVxuICAgICogQHJldHVybnMge0Jvb2xlYW59IHRydWUgaWYgYW4gT2JzZXJ2YWJsZSwgZWxzZSBmYWxzZS5cbiAgICAqL1xuICAgIE9ic2VydmFibGUuaXNPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiBvICYmIGlzRnVuY3Rpb24oby5zdWJzY3JpYmUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiAgU3Vic2NyaWJlcyBhbiBvIHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgICAqICBAcGFyYW0ge01peGVkfSBbb09yT25OZXh0XSBUaGUgb2JqZWN0IHRoYXQgaXMgdG8gcmVjZWl2ZSBub3RpZmljYXRpb25zIG9yIGFuIGFjdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiAgQHBhcmFtIHtGdW5jdGlvbn0gW29uRXJyb3JdIEFjdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiAgQHBhcmFtIHtGdW5jdGlvbn0gW29uQ29tcGxldGVkXSBBY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAgICogIEByZXR1cm5zIHtEaXBvc2FibGV9IEEgZGlzcG9zYWJsZSBoYW5kbGluZyB0aGUgc3Vic2NyaXB0aW9ucyBhbmQgdW5zdWJzY3JpcHRpb25zLlxuICAgICAqL1xuICAgIG9ic2VydmFibGVQcm90by5zdWJzY3JpYmUgPSBvYnNlcnZhYmxlUHJvdG8uZm9yRWFjaCA9IGZ1bmN0aW9uIChvT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3Vic2NyaWJlKHR5cGVvZiBvT3JPbk5leHQgPT09ICdvYmplY3QnID9cbiAgICAgICAgb09yT25OZXh0IDpcbiAgICAgICAgb2JzZXJ2ZXJDcmVhdGUob09yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmVzIHRvIHRoZSBuZXh0IHZhbHVlIGluIHRoZSBzZXF1ZW5jZSB3aXRoIGFuIG9wdGlvbmFsIFwidGhpc1wiIGFyZ3VtZW50LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uTmV4dCBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIG9uIGVhY2ggZWxlbWVudCBpbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG4gICAgICovXG4gICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZU9uTmV4dCA9IGZ1bmN0aW9uIChvbk5leHQsIHRoaXNBcmcpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpYmUob2JzZXJ2ZXJDcmVhdGUodHlwZW9mIHRoaXNBcmcgIT09ICd1bmRlZmluZWQnID8gZnVuY3Rpb24oeCkgeyBvbk5leHQuY2FsbCh0aGlzQXJnLCB4KTsgfSA6IG9uTmV4dCkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmVzIHRvIGFuIGV4Y2VwdGlvbmFsIGNvbmRpdGlvbiBpbiB0aGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBcInRoaXNcIiBhcmd1bWVudC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkVycm9yIFRoZSBmdW5jdGlvbiB0byBpbnZva2UgdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICAgKiBAcmV0dXJucyB7RGlzcG9zYWJsZX0gQSBkaXNwb3NhYmxlIGhhbmRsaW5nIHRoZSBzdWJzY3JpcHRpb25zIGFuZCB1bnN1YnNjcmlwdGlvbnMuXG4gICAgICovXG4gICAgb2JzZXJ2YWJsZVByb3RvLnN1YnNjcmliZU9uRXJyb3IgPSBmdW5jdGlvbiAob25FcnJvciwgdGhpc0FyZykge1xuICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShvYnNlcnZlckNyZWF0ZShudWxsLCB0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbihlKSB7IG9uRXJyb3IuY2FsbCh0aGlzQXJnLCBlKTsgfSA6IG9uRXJyb3IpKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlcyB0byB0aGUgbmV4dCB2YWx1ZSBpbiB0aGUgc2VxdWVuY2Ugd2l0aCBhbiBvcHRpb25hbCBcInRoaXNcIiBhcmd1bWVudC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbkNvbXBsZXRlZCBUaGUgZnVuY3Rpb24gdG8gaW52b2tlIHVwb24gZ3JhY2VmdWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAgICogQHBhcmFtIHtBbnl9IFt0aGlzQXJnXSBPYmplY3QgdG8gdXNlIGFzIHRoaXMgd2hlbiBleGVjdXRpbmcgY2FsbGJhY2suXG4gICAgICogQHJldHVybnMge0Rpc3Bvc2FibGV9IEEgZGlzcG9zYWJsZSBoYW5kbGluZyB0aGUgc3Vic2NyaXB0aW9ucyBhbmQgdW5zdWJzY3JpcHRpb25zLlxuICAgICAqL1xuICAgIG9ic2VydmFibGVQcm90by5zdWJzY3JpYmVPbkNvbXBsZXRlZCA9IGZ1bmN0aW9uIChvbkNvbXBsZXRlZCwgdGhpc0FyZykge1xuICAgICAgcmV0dXJuIHRoaXMuX3N1YnNjcmliZShvYnNlcnZlckNyZWF0ZShudWxsLCBudWxsLCB0eXBlb2YgdGhpc0FyZyAhPT0gJ3VuZGVmaW5lZCcgPyBmdW5jdGlvbigpIHsgb25Db21wbGV0ZWQuY2FsbCh0aGlzQXJnKTsgfSA6IG9uQ29tcGxldGVkKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBPYnNlcnZhYmxlO1xuICB9KSgpO1xuXG4gIHZhciBTY2hlZHVsZWRPYnNlcnZlciA9IFJ4LmludGVybmFscy5TY2hlZHVsZWRPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2NoZWR1bGVkT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBTY2hlZHVsZWRPYnNlcnZlcihzY2hlZHVsZXIsIG9ic2VydmVyKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy5pc0FjcXVpcmVkID0gZmFsc2U7XG4gICAgICB0aGlzLmhhc0ZhdWx0ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMucXVldWUgPSBbXTtcbiAgICAgIHRoaXMuZGlzcG9zYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG4gICAgfVxuXG4gICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHRoaXMucXVldWUucHVzaChmdW5jdGlvbiAoKSB7IHNlbGYub2JzZXJ2ZXIub25OZXh0KHZhbHVlKTsgfSk7XG4gICAgfTtcblxuICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB0aGlzLnF1ZXVlLnB1c2goZnVuY3Rpb24gKCkgeyBzZWxmLm9ic2VydmVyLm9uRXJyb3IoZSk7IH0pO1xuICAgIH07XG5cbiAgICBTY2hlZHVsZWRPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5xdWV1ZS5wdXNoKGZ1bmN0aW9uICgpIHsgc2VsZi5vYnNlcnZlci5vbkNvbXBsZXRlZCgpOyB9KTtcbiAgICB9O1xuXG4gICAgU2NoZWR1bGVkT2JzZXJ2ZXIucHJvdG90eXBlLmVuc3VyZUFjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBpc093bmVyID0gZmFsc2U7XG4gICAgICBpZiAoIXRoaXMuaGFzRmF1bHRlZCAmJiB0aGlzLnF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgaXNPd25lciA9ICF0aGlzLmlzQWNxdWlyZWQ7XG4gICAgICAgIHRoaXMuaXNBY3F1aXJlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAoaXNPd25lcikge1xuICAgICAgICB0aGlzLmRpc3Bvc2FibGUuc2V0RGlzcG9zYWJsZSh0aGlzLnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSh0aGlzLCBmdW5jdGlvbiAocGFyZW50LCBzZWxmKSB7XG4gICAgICAgICAgdmFyIHdvcms7XG4gICAgICAgICAgaWYgKHBhcmVudC5xdWV1ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB3b3JrID0gcGFyZW50LnF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBhcmVudC5pc0FjcXVpcmVkID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh3b3JrKSgpO1xuICAgICAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7XG4gICAgICAgICAgICBwYXJlbnQucXVldWUgPSBbXTtcbiAgICAgICAgICAgIHBhcmVudC5oYXNGYXVsdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiB0aHJvd2VyKHJlcy5lKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2VsZihwYXJlbnQpO1xuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIFNjaGVkdWxlZE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgX19zdXBlcl9fLnByb3RvdHlwZS5kaXNwb3NlLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLmRpc3Bvc2FibGUuZGlzcG9zZSgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2NoZWR1bGVkT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIHZhciBPYnNlcnZhYmxlQmFzZSA9IFJ4Lk9ic2VydmFibGVCYXNlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhPYnNlcnZhYmxlQmFzZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIGZpeFN1YnNjcmliZXIoc3Vic2NyaWJlcikge1xuICAgICAgcmV0dXJuIHN1YnNjcmliZXIgJiYgaXNGdW5jdGlvbihzdWJzY3JpYmVyLmRpc3Bvc2UpID8gc3Vic2NyaWJlciA6XG4gICAgICAgIGlzRnVuY3Rpb24oc3Vic2NyaWJlcikgPyBkaXNwb3NhYmxlQ3JlYXRlKHN1YnNjcmliZXIpIDogZGlzcG9zYWJsZUVtcHR5O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNldERpc3Bvc2FibGUocywgc3RhdGUpIHtcbiAgICAgIHZhciBhZG8gPSBzdGF0ZVswXSwgc2VsZiA9IHN0YXRlWzFdO1xuICAgICAgdmFyIHN1YiA9IHRyeUNhdGNoKHNlbGYuc3Vic2NyaWJlQ29yZSkuY2FsbChzZWxmLCBhZG8pO1xuICAgICAgaWYgKHN1YiA9PT0gZXJyb3JPYmogJiYgIWFkby5mYWlsKGVycm9yT2JqLmUpKSB7IHRocm93ZXIoZXJyb3JPYmouZSk7IH1cbiAgICAgIGFkby5zZXREaXNwb3NhYmxlKGZpeFN1YnNjcmliZXIoc3ViKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZUJhc2UoKSB7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBPYnNlcnZhYmxlQmFzZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgYWRvID0gbmV3IEF1dG9EZXRhY2hPYnNlcnZlcihvKSwgc3RhdGUgPSBbYWRvLCB0aGlzXTtcblxuICAgICAgaWYgKGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZXF1aXJlZCgpKSB7XG4gICAgICAgIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNldERpc3Bvc2FibGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0RGlzcG9zYWJsZShudWxsLCBzdGF0ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYWRvO1xuICAgIH07XG5cbiAgICBPYnNlcnZhYmxlQmFzZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IG5vdEltcGxlbWVudGVkO1xuXG4gICAgcmV0dXJuIE9ic2VydmFibGVCYXNlO1xuICB9KE9ic2VydmFibGUpKTtcblxudmFyIEZsYXRNYXBPYnNlcnZhYmxlID0gUnguRmxhdE1hcE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG5cbiAgICBpbmhlcml0cyhGbGF0TWFwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIEZsYXRNYXBPYnNlcnZhYmxlKHNvdXJjZSwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgICB0aGlzLnJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihyZXN1bHRTZWxlY3RvcikgPyByZXN1bHRTZWxlY3RvciA6IG51bGw7XG4gICAgICB0aGlzLnNlbGVjdG9yID0gYmluZENhbGxiYWNrKGlzRnVuY3Rpb24oc2VsZWN0b3IpID8gc2VsZWN0b3IgOiBmdW5jdGlvbigpIHsgcmV0dXJuIHNlbGVjdG9yOyB9LCB0aGlzQXJnLCAzKTtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRmxhdE1hcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMuc2VsZWN0b3IsIHRoaXMucmVzdWx0U2VsZWN0b3IsIHRoaXMpKTtcbiAgICB9O1xuXG4gICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvYnNlcnZlciwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCBzb3VyY2UpIHtcbiAgICAgIHRoaXMuaSA9IDA7XG4gICAgICB0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICB0aGlzLnJlc3VsdFNlbGVjdG9yID0gcmVzdWx0U2VsZWN0b3I7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMubyA9IG9ic2VydmVyO1xuICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLl93cmFwUmVzdWx0ID0gZnVuY3Rpb24ocmVzdWx0LCB4LCBpKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZXN1bHRTZWxlY3RvciA/XG4gICAgICAgIHJlc3VsdC5tYXAoZnVuY3Rpb24oeSwgaTIpIHsgcmV0dXJuIHRoaXMucmVzdWx0U2VsZWN0b3IoeCwgeSwgaSwgaTIpOyB9LCB0aGlzKSA6XG4gICAgICAgIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgIHZhciBpID0gdGhpcy5pKys7XG4gICAgICB2YXIgcmVzdWx0ID0gdHJ5Q2F0Y2godGhpcy5zZWxlY3RvcikoeCwgaSwgdGhpcy5zb3VyY2UpO1xuICAgICAgaWYgKHJlc3VsdCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuXG4gICAgICBpc1Byb21pc2UocmVzdWx0KSAmJiAocmVzdWx0ID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHJlc3VsdCkpO1xuICAgICAgKGlzQXJyYXlMaWtlKHJlc3VsdCkgfHwgaXNJdGVyYWJsZShyZXN1bHQpKSAmJiAocmVzdWx0ID0gT2JzZXJ2YWJsZS5mcm9tKHJlc3VsdCkpO1xuICAgICAgdGhpcy5vLm9uTmV4dCh0aGlzLl93cmFwUmVzdWx0KHJlc3VsdCwgeCwgaSkpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uKGUpIHsgdGhpcy5vLm9uRXJyb3IoZSk7IH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkgeyB0aGlzLm8ub25Db21wbGV0ZWQoKTsgfTtcblxuICAgIHJldHVybiBGbGF0TWFwT2JzZXJ2YWJsZTtcblxufShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBFbnVtZXJhYmxlID0gUnguaW50ZXJuYWxzLkVudW1lcmFibGUgPSBmdW5jdGlvbiAoKSB7IH07XG5cbiAgZnVuY3Rpb24gSXNEaXNwb3NlZERpc3Bvc2FibGUoc3RhdGUpIHtcbiAgICB0aGlzLl9zID0gc3RhdGU7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gIH1cblxuICBJc0Rpc3Bvc2VkRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX3MuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIHZhciBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZShzb3VyY2VzKSB7XG4gICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHN0YXRlID0geyBpc0Rpc3Bvc2VkOiBmYWxzZSB9LCBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuICAgICAgdmFyIGNhbmNlbGFibGUgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKHRoaXMuc291cmNlc1skaXRlcmF0b3IkXSgpLCBmdW5jdGlvbiAoZSwgc2VsZikge1xuICAgICAgICBpZiAoc3RhdGUuaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdmFyIGN1cnJlbnRJdGVtID0gdHJ5Q2F0Y2goZS5uZXh0KS5jYWxsKGUpO1xuICAgICAgICBpZiAoY3VycmVudEl0ZW0gPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IoY3VycmVudEl0ZW0uZSk7IH1cblxuICAgICAgICBpZiAoY3VycmVudEl0ZW0uZG9uZSkge1xuICAgICAgICAgIHJldHVybiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcbiAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblxuICAgICAgICB2YXIgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgICAgZC5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobywgc2VsZiwgZSkpKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIG5ldyBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSldKTtcbiAgICB9O1xuXG4gICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBzLCBlKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgdGhpcy5fZSA9IGU7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KHgpOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX3ModGhpcy5fZSk7IH07XG5cbiAgICByZXR1cm4gQ29uY2F0RW51bWVyYWJsZU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICBFbnVtZXJhYmxlLnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBDb25jYXRFbnVtZXJhYmxlT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICB2YXIgQ2F0Y2hFcnJvck9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ2F0Y2hFcnJvck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ2F0Y2hFcnJvck9ic2VydmFibGUoc291cmNlcykge1xuICAgICAgdGhpcy5zb3VyY2VzID0gc291cmNlcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIENhdGNoRXJyb3JPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBlID0gdGhpcy5zb3VyY2VzWyRpdGVyYXRvciRdKCk7XG5cbiAgICAgIHZhciBzdGF0ZSA9IHsgaXNEaXNwb3NlZDogZmFsc2UgfSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcbiAgICAgIHZhciBjYW5jZWxhYmxlID0gY3VycmVudFRocmVhZFNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZShudWxsLCBmdW5jdGlvbiAobGFzdEV4Y2VwdGlvbiwgc2VsZikge1xuICAgICAgICBpZiAoc3RhdGUuaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdmFyIGN1cnJlbnRJdGVtID0gdHJ5Q2F0Y2goZS5uZXh0KS5jYWxsKGUpO1xuICAgICAgICBpZiAoY3VycmVudEl0ZW0gPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IoY3VycmVudEl0ZW0uZSk7IH1cblxuICAgICAgICBpZiAoY3VycmVudEl0ZW0uZG9uZSkge1xuICAgICAgICAgIHJldHVybiBsYXN0RXhjZXB0aW9uICE9PSBudWxsID8gby5vbkVycm9yKGxhc3RFeGNlcHRpb24pIDogby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgcHJvbWlzZVxuICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gY3VycmVudEl0ZW0udmFsdWU7XG4gICAgICAgIGlzUHJvbWlzZShjdXJyZW50VmFsdWUpICYmIChjdXJyZW50VmFsdWUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoY3VycmVudFZhbHVlKSk7XG5cbiAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICAgIGQuc2V0RGlzcG9zYWJsZShjdXJyZW50VmFsdWUuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHNlbGYpKSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoW3N1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSwgbmV3IElzRGlzcG9zZWREaXNwb3NhYmxlKHN0YXRlKV0pO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHJlY3Vyc2UpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcmVjdXJzZSA9IHJlY3Vyc2U7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX28ub25OZXh0KHgpOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhpcy5fcmVjdXJzZShlKTsgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblxuICAgIHJldHVybiBDYXRjaEVycm9yT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIEVudW1lcmFibGUucHJvdG90eXBlLmNhdGNoRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBDYXRjaEVycm9yT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICBFbnVtZXJhYmxlLnByb3RvdHlwZS5jYXRjaEVycm9yV2hlbiA9IGZ1bmN0aW9uIChub3RpZmljYXRpb25IYW5kbGVyKSB7XG4gICAgdmFyIHNvdXJjZXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGV4Y2VwdGlvbnMgPSBuZXcgU3ViamVjdCgpLFxuICAgICAgICBub3RpZmllciA9IG5ldyBTdWJqZWN0KCksXG4gICAgICAgIGhhbmRsZWQgPSBub3RpZmljYXRpb25IYW5kbGVyKGV4Y2VwdGlvbnMpLFxuICAgICAgICBub3RpZmljYXRpb25EaXNwb3NhYmxlID0gaGFuZGxlZC5zdWJzY3JpYmUobm90aWZpZXIpO1xuXG4gICAgICB2YXIgZSA9IHNvdXJjZXNbJGl0ZXJhdG9yJF0oKTtcblxuICAgICAgdmFyIHN0YXRlID0geyBpc0Rpc3Bvc2VkOiBmYWxzZSB9LFxuICAgICAgICBsYXN0RXhjZXB0aW9uLFxuICAgICAgICBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpO1xuICAgICAgdmFyIGNhbmNlbGFibGUgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlKG51bGwsIGZ1bmN0aW9uIChfLCBzZWxmKSB7XG4gICAgICAgIGlmIChzdGF0ZS5pc0Rpc3Bvc2VkKSB7IHJldHVybjsgfVxuICAgICAgICB2YXIgY3VycmVudEl0ZW0gPSB0cnlDYXRjaChlLm5leHQpLmNhbGwoZSk7XG4gICAgICAgIGlmIChjdXJyZW50SXRlbSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihjdXJyZW50SXRlbS5lKTsgfVxuXG4gICAgICAgIGlmIChjdXJyZW50SXRlbS5kb25lKSB7XG4gICAgICAgICAgaWYgKGxhc3RFeGNlcHRpb24pIHtcbiAgICAgICAgICAgIG8ub25FcnJvcihsYXN0RXhjZXB0aW9uKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50SXRlbS52YWx1ZTtcbiAgICAgICAgaXNQcm9taXNlKGN1cnJlbnRWYWx1ZSkgJiYgKGN1cnJlbnRWYWx1ZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShjdXJyZW50VmFsdWUpKTtcblxuICAgICAgICB2YXIgb3V0ZXIgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgdmFyIGlubmVyID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG5ldyBCaW5hcnlEaXNwb3NhYmxlKGlubmVyLCBvdXRlcikpO1xuICAgICAgICBvdXRlci5zZXREaXNwb3NhYmxlKGN1cnJlbnRWYWx1ZS5zdWJzY3JpYmUoXG4gICAgICAgICAgZnVuY3Rpb24oeCkgeyBvLm9uTmV4dCh4KTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoZXhuKSB7XG4gICAgICAgICAgICBpbm5lci5zZXREaXNwb3NhYmxlKG5vdGlmaWVyLnN1YnNjcmliZShzZWxmLCBmdW5jdGlvbihleCkge1xuICAgICAgICAgICAgICBvLm9uRXJyb3IoZXgpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgZXhjZXB0aW9ucy5vbk5leHQoZXhuKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZ1bmN0aW9uKCkgeyBvLm9uQ29tcGxldGVkKCk7IH0pKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKFtub3RpZmljYXRpb25EaXNwb3NhYmxlLCBzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUsIG5ldyBJc0Rpc3Bvc2VkRGlzcG9zYWJsZShzdGF0ZSldKTtcbiAgICB9KTtcbiAgfTtcblxuICB2YXIgUmVwZWF0RW51bWVyYWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoUmVwZWF0RW51bWVyYWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIFJlcGVhdEVudW1lcmFibGUodiwgYykge1xuICAgICAgdGhpcy52ID0gdjtcbiAgICAgIHRoaXMuYyA9IGMgPT0gbnVsbCA/IC0xIDogYztcbiAgICB9XG4gICAgUmVwZWF0RW51bWVyYWJsZS5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3IFJlcGVhdEVudW1lcmF0b3IodGhpcyk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFJlcGVhdEVudW1lcmF0b3IocCkge1xuICAgICAgdGhpcy52ID0gcC52O1xuICAgICAgdGhpcy5sID0gcC5jO1xuICAgIH1cbiAgICBSZXBlYXRFbnVtZXJhdG9yLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMubCA9PT0gMCkgeyByZXR1cm4gZG9uZUVudW1lcmF0b3I7IH1cbiAgICAgIGlmICh0aGlzLmwgPiAwKSB7IHRoaXMubC0tOyB9XG4gICAgICByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMudiB9O1xuICAgIH07XG5cbiAgICByZXR1cm4gUmVwZWF0RW51bWVyYWJsZTtcbiAgfShFbnVtZXJhYmxlKSk7XG5cbiAgdmFyIGVudW1lcmFibGVSZXBlYXQgPSBFbnVtZXJhYmxlLnJlcGVhdCA9IGZ1bmN0aW9uICh2YWx1ZSwgcmVwZWF0Q291bnQpIHtcbiAgICByZXR1cm4gbmV3IFJlcGVhdEVudW1lcmFibGUodmFsdWUsIHJlcGVhdENvdW50KTtcbiAgfTtcblxuICB2YXIgT2ZFbnVtZXJhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE9mRW51bWVyYWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBPZkVudW1lcmFibGUocywgZm4sIHRoaXNBcmcpIHtcbiAgICAgIHRoaXMucyA9IHM7XG4gICAgICB0aGlzLmZuID0gZm4gPyBiaW5kQ2FsbGJhY2soZm4sIHRoaXNBcmcsIDMpIDogbnVsbDtcbiAgICB9XG4gICAgT2ZFbnVtZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBuZXcgT2ZFbnVtZXJhdG9yKHRoaXMpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBPZkVudW1lcmF0b3IocCkge1xuICAgICAgdGhpcy5pID0gLTE7XG4gICAgICB0aGlzLnMgPSBwLnM7XG4gICAgICB0aGlzLmwgPSB0aGlzLnMubGVuZ3RoO1xuICAgICAgdGhpcy5mbiA9IHAuZm47XG4gICAgfVxuICAgIE9mRW51bWVyYXRvci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgcmV0dXJuICsrdGhpcy5pIDwgdGhpcy5sID9cbiAgICAgICB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogIXRoaXMuZm4gPyB0aGlzLnNbdGhpcy5pXSA6IHRoaXMuZm4odGhpcy5zW3RoaXMuaV0sIHRoaXMuaSwgdGhpcy5zKSB9IDpcbiAgICAgICBkb25lRW51bWVyYXRvcjtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE9mRW51bWVyYWJsZTtcbiAgfShFbnVtZXJhYmxlKSk7XG5cbiAgdmFyIGVudW1lcmFibGVPZiA9IEVudW1lcmFibGUub2YgPSBmdW5jdGlvbiAoc291cmNlLCBzZWxlY3RvciwgdGhpc0FyZykge1xuICAgIHJldHVybiBuZXcgT2ZFbnVtZXJhYmxlKHNvdXJjZSwgc2VsZWN0b3IsIHRoaXNBcmcpO1xuICB9O1xuXG4gIHZhciBUb0FycmF5T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUb0FycmF5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUb0FycmF5T2JzZXJ2YWJsZShzb3VyY2UpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVG9BcnJheU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8pKTtcbiAgICB9O1xuXG4gICAgaW5oZXJpdHMoSW5uZXJPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvKSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy5hID0gW107XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuICAgIFxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLmEucHVzaCh4KTsgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuby5vbkVycm9yKGUpOyAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7IHRoaXMuby5vbk5leHQodGhpcy5hKTsgdGhpcy5vLm9uQ29tcGxldGVkKCk7IH07XG5cbiAgICByZXR1cm4gVG9BcnJheU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgKiBDcmVhdGVzIGFuIGFycmF5IGZyb20gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIGEgc2luZ2xlIGVsZW1lbnQgd2l0aCBhIGxpc3QgY29udGFpbmluZyBhbGwgdGhlIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICovXG4gIG9ic2VydmFibGVQcm90by50b0FycmF5ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgVG9BcnJheU9ic2VydmFibGUodGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqICBDcmVhdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgZnJvbSBhIHNwZWNpZmllZCBzdWJzY3JpYmUgbWV0aG9kIGltcGxlbWVudGF0aW9uLlxuICAgKiBAZXhhbXBsZVxuICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuY3JlYXRlKGZ1bmN0aW9uIChvYnNlcnZlcikgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB9ICk7XG4gICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IHJldHVybiBSeC5EaXNwb3NhYmxlLmVtcHR5OyB9ICk7XG4gICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5jcmVhdGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7IH0gKTtcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gc3Vic2NyaWJlIEltcGxlbWVudGF0aW9uIG9mIHRoZSByZXN1bHRpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSdzIHN1YnNjcmliZSBtZXRob2QsIHJldHVybmluZyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSB3cmFwcGVkIGluIGEgRGlzcG9zYWJsZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGhlIHNwZWNpZmllZCBpbXBsZW1lbnRhdGlvbiBmb3IgdGhlIFN1YnNjcmliZSBtZXRob2QuXG4gICAqL1xuICBPYnNlcnZhYmxlLmNyZWF0ZSA9IGZ1bmN0aW9uIChzdWJzY3JpYmUsIHBhcmVudCkge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShzdWJzY3JpYmUsIHBhcmVudCk7XG4gIH07XG5cbiAgdmFyIERlZmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERlZmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIERlZmVyKGZhY3RvcnkpIHtcbiAgICAgIHRoaXMuX2YgPSBmYWN0b3J5O1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVmZXIucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuX2YpKCk7XG4gICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gb2JzZXJ2YWJsZVRocm93KHJlc3VsdC5lKS5zdWJzY3JpYmUobyk7fVxuICAgICAgaXNQcm9taXNlKHJlc3VsdCkgJiYgKHJlc3VsdCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShyZXN1bHQpKTtcbiAgICAgIHJldHVybiByZXN1bHQuc3Vic2NyaWJlKG8pO1xuICAgIH07XG5cbiAgICByZXR1cm4gRGVmZXI7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGludm9rZXMgdGhlIHNwZWNpZmllZCBmYWN0b3J5IGZ1bmN0aW9uIHdoZW5ldmVyIGEgbmV3IG9ic2VydmVyIHN1YnNjcmliZXMuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICB2YXIgcmVzID0gUnguT2JzZXJ2YWJsZS5kZWZlcihmdW5jdGlvbiAoKSB7IHJldHVybiBSeC5PYnNlcnZhYmxlLmZyb21BcnJheShbMSwyLDNdKTsgfSk7XG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9ic2VydmFibGVGYWN0b3J5IE9ic2VydmFibGUgZmFjdG9yeSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggb2JzZXJ2ZXIgdGhhdCBzdWJzY3JpYmVzIHRvIHRoZSByZXN1bHRpbmcgc2VxdWVuY2Ugb3IgUHJvbWlzZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2hvc2Ugb2JzZXJ2ZXJzIHRyaWdnZXIgYW4gaW52b2NhdGlvbiBvZiB0aGUgZ2l2ZW4gb2JzZXJ2YWJsZSBmYWN0b3J5IGZ1bmN0aW9uLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVEZWZlciA9IE9ic2VydmFibGUuZGVmZXIgPSBmdW5jdGlvbiAob2JzZXJ2YWJsZUZhY3RvcnkpIHtcbiAgICByZXR1cm4gbmV3IERlZmVyKG9ic2VydmFibGVGYWN0b3J5KTtcbiAgfTtcblxuICB2YXIgRW1wdHlPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEVtcHR5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBFbXB0eU9ic2VydmFibGUoc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIEVtcHR5T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgRW1wdHlTaW5rKG9ic2VydmVyLCB0aGlzLnNjaGVkdWxlcik7XG4gICAgICByZXR1cm4gc2luay5ydW4oKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gRW1wdHlTaW5rKG9ic2VydmVyLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjaGVkdWxlSXRlbShzLCBzdGF0ZSkge1xuICAgICAgc3RhdGUub25Db21wbGV0ZWQoKTtcbiAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgfVxuXG4gICAgRW1wdHlTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc3RhdGUgPSB0aGlzLm9ic2VydmVyO1xuICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVyID09PSBpbW1lZGlhdGVTY2hlZHVsZXIgP1xuICAgICAgICBzY2hlZHVsZUl0ZW0obnVsbCwgc3RhdGUpIDpcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNjaGVkdWxlSXRlbSk7XG4gICAgfTtcblxuICAgIHJldHVybiBFbXB0eU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgRU1QVFlfT0JTRVJWQUJMRSA9IG5ldyBFbXB0eU9ic2VydmFibGUoaW1tZWRpYXRlU2NoZWR1bGVyKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gZW1wdHkgb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgdGhlIHNpbmdsZSBPbkNvbXBsZXRlZCBtZXNzYWdlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAgdmFyIHJlcyA9IFJ4Lk9ic2VydmFibGUuZW1wdHkoKTtcbiAgICogIHZhciByZXMgPSBSeC5PYnNlcnZhYmxlLmVtcHR5KFJ4LlNjaGVkdWxlci50aW1lb3V0KTtcbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBzZW5kIHRoZSB0ZXJtaW5hdGlvbiBjYWxsIG9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIG5vIGVsZW1lbnRzLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVFbXB0eSA9IE9ic2VydmFibGUuZW1wdHkgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gc2NoZWR1bGVyID09PSBpbW1lZGlhdGVTY2hlZHVsZXIgPyBFTVBUWV9PQlNFUlZBQkxFIDogbmV3IEVtcHR5T2JzZXJ2YWJsZShzY2hlZHVsZXIpO1xuICB9O1xuXG4gIHZhciBGcm9tT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhGcm9tT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBGcm9tT2JzZXJ2YWJsZShpdGVyYWJsZSwgbWFwcGVyLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuaXRlcmFibGUgPSBpdGVyYWJsZTtcbiAgICAgIHRoaXMubWFwcGVyID0gbWFwcGVyO1xuICAgICAgdGhpcy5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBGcm9tT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgc2luayA9IG5ldyBGcm9tU2luayhvLCB0aGlzKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRnJvbU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgRnJvbVNpbmsgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZyb21TaW5rKG8sIHBhcmVudCkge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgIH1cblxuICAgIEZyb21TaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgbGlzdCA9IE9iamVjdCh0aGlzLnBhcmVudC5pdGVyYWJsZSksXG4gICAgICAgICAgaXQgPSBnZXRJdGVyYWJsZShsaXN0KSxcbiAgICAgICAgICBvID0gdGhpcy5vLFxuICAgICAgICAgIG1hcHBlciA9IHRoaXMucGFyZW50Lm1hcHBlcjtcblxuICAgICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShpLCByZWN1cnNlKSB7XG4gICAgICAgIHZhciBuZXh0ID0gdHJ5Q2F0Y2goaXQubmV4dCkuY2FsbChpdCk7XG4gICAgICAgIGlmIChuZXh0ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKG5leHQuZSk7IH1cbiAgICAgICAgaWYgKG5leHQuZG9uZSkgeyByZXR1cm4gby5vbkNvbXBsZXRlZCgpOyB9XG5cbiAgICAgICAgdmFyIHJlc3VsdCA9IG5leHQudmFsdWU7XG5cbiAgICAgICAgaWYgKGlzRnVuY3Rpb24obWFwcGVyKSkge1xuICAgICAgICAgIHJlc3VsdCA9IHRyeUNhdGNoKG1hcHBlcikocmVzdWx0LCBpKTtcbiAgICAgICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuICAgICAgICB9XG5cbiAgICAgICAgby5vbk5leHQocmVzdWx0KTtcbiAgICAgICAgcmVjdXJzZShpICsgMSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSk7XG4gICAgfTtcblxuICAgIHJldHVybiBGcm9tU2luaztcbiAgfSgpKTtcblxuICB2YXIgbWF4U2FmZUludGVnZXIgPSBNYXRoLnBvdygyLCA1MykgLSAxO1xuXG4gIGZ1bmN0aW9uIFN0cmluZ0l0ZXJhYmxlKHMpIHtcbiAgICB0aGlzLl9zID0gcztcbiAgfVxuXG4gIFN0cmluZ0l0ZXJhYmxlLnByb3RvdHlwZVskaXRlcmF0b3IkXSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IFN0cmluZ0l0ZXJhdG9yKHRoaXMuX3MpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIFN0cmluZ0l0ZXJhdG9yKHMpIHtcbiAgICB0aGlzLl9zID0gcztcbiAgICB0aGlzLl9sID0gcy5sZW5ndGg7XG4gICAgdGhpcy5faSA9IDA7XG4gIH1cblxuICBTdHJpbmdJdGVyYXRvci5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgU3RyaW5nSXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2kgPCB0aGlzLl9sID8geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMuX3MuY2hhckF0KHRoaXMuX2krKykgfSA6IGRvbmVFbnVtZXJhdG9yO1xuICB9O1xuXG4gIGZ1bmN0aW9uIEFycmF5SXRlcmFibGUoYSkge1xuICAgIHRoaXMuX2EgPSBhO1xuICB9XG5cbiAgQXJyYXlJdGVyYWJsZS5wcm90b3R5cGVbJGl0ZXJhdG9yJF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBBcnJheUl0ZXJhdG9yKHRoaXMuX2EpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIEFycmF5SXRlcmF0b3IoYSkge1xuICAgIHRoaXMuX2EgPSBhO1xuICAgIHRoaXMuX2wgPSB0b0xlbmd0aChhKTtcbiAgICB0aGlzLl9pID0gMDtcbiAgfVxuXG4gIEFycmF5SXRlcmF0b3IucHJvdG90eXBlWyRpdGVyYXRvciRdID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIEFycmF5SXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2kgPCB0aGlzLl9sID8geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMuX2FbdGhpcy5faSsrXSB9IDogZG9uZUVudW1lcmF0b3I7XG4gIH07XG5cbiAgZnVuY3Rpb24gbnVtYmVySXNGaW5pdGUodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiByb290LmlzRmluaXRlKHZhbHVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzTmFuKG4pIHtcbiAgICByZXR1cm4gbiAhPT0gbjtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldEl0ZXJhYmxlKG8pIHtcbiAgICB2YXIgaSA9IG9bJGl0ZXJhdG9yJF0sIGl0O1xuICAgIGlmICghaSAmJiB0eXBlb2YgbyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGl0ID0gbmV3IFN0cmluZ0l0ZXJhYmxlKG8pO1xuICAgICAgcmV0dXJuIGl0WyRpdGVyYXRvciRdKCk7XG4gICAgfVxuICAgIGlmICghaSAmJiBvLmxlbmd0aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpdCA9IG5ldyBBcnJheUl0ZXJhYmxlKG8pO1xuICAgICAgcmV0dXJuIGl0WyRpdGVyYXRvciRdKCk7XG4gICAgfVxuICAgIGlmICghaSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdPYmplY3QgaXMgbm90IGl0ZXJhYmxlJyk7IH1cbiAgICByZXR1cm4gb1skaXRlcmF0b3IkXSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2lnbih2YWx1ZSkge1xuICAgIHZhciBudW1iZXIgPSArdmFsdWU7XG4gICAgaWYgKG51bWJlciA9PT0gMCkgeyByZXR1cm4gbnVtYmVyOyB9XG4gICAgaWYgKGlzTmFOKG51bWJlcikpIHsgcmV0dXJuIG51bWJlcjsgfVxuICAgIHJldHVybiBudW1iZXIgPCAwID8gLTEgOiAxO1xuICB9XG5cbiAgZnVuY3Rpb24gdG9MZW5ndGgobykge1xuICAgIHZhciBsZW4gPSArby5sZW5ndGg7XG4gICAgaWYgKGlzTmFOKGxlbikpIHsgcmV0dXJuIDA7IH1cbiAgICBpZiAobGVuID09PSAwIHx8ICFudW1iZXJJc0Zpbml0ZShsZW4pKSB7IHJldHVybiBsZW47IH1cbiAgICBsZW4gPSBzaWduKGxlbikgKiBNYXRoLmZsb29yKE1hdGguYWJzKGxlbikpO1xuICAgIGlmIChsZW4gPD0gMCkgeyByZXR1cm4gMDsgfVxuICAgIGlmIChsZW4gPiBtYXhTYWZlSW50ZWdlcikgeyByZXR1cm4gbWF4U2FmZUludGVnZXI7IH1cbiAgICByZXR1cm4gbGVuO1xuICB9XG5cbiAgLyoqXG4gICogVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyBPYnNlcnZhYmxlIHNlcXVlbmNlIGZyb20gYW4gYXJyYXktbGlrZSBvciBpdGVyYWJsZSBvYmplY3QuXG4gICogQHBhcmFtIHtBbnl9IGFycmF5TGlrZSBBbiBhcnJheS1saWtlIG9yIGl0ZXJhYmxlIG9iamVjdCB0byBjb252ZXJ0IHRvIGFuIE9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gW21hcEZuXSBNYXAgZnVuY3Rpb24gdG8gY2FsbCBvbiBldmVyeSBlbGVtZW50IG9mIHRoZSBhcnJheS5cbiAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIFRoZSBjb250ZXh0IHRvIHVzZSBjYWxsaW5nIHRoZSBtYXBGbiBpZiBwcm92aWRlZC5cbiAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gT3B0aW9uYWwgc2NoZWR1bGVyIHRvIHVzZSBmb3Igc2NoZWR1bGluZy4gIElmIG5vdCBwcm92aWRlZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmN1cnJlbnRUaHJlYWQuXG4gICovXG4gIHZhciBvYnNlcnZhYmxlRnJvbSA9IE9ic2VydmFibGUuZnJvbSA9IGZ1bmN0aW9uIChpdGVyYWJsZSwgbWFwRm4sIHRoaXNBcmcsIHNjaGVkdWxlcikge1xuICAgIGlmIChpdGVyYWJsZSA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2l0ZXJhYmxlIGNhbm5vdCBiZSBudWxsLicpXG4gICAgfVxuICAgIGlmIChtYXBGbiAmJiAhaXNGdW5jdGlvbihtYXBGbikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignbWFwRm4gd2hlbiBwcm92aWRlZCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgaWYgKG1hcEZuKSB7XG4gICAgICB2YXIgbWFwcGVyID0gYmluZENhbGxiYWNrKG1hcEZuLCB0aGlzQXJnLCAyKTtcbiAgICB9XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBGcm9tT2JzZXJ2YWJsZShpdGVyYWJsZSwgbWFwcGVyLCBzY2hlZHVsZXIpO1xuICB9XG5cbiAgdmFyIEZyb21BcnJheU9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRnJvbUFycmF5T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIHNjaGVkdWxlcikge1xuICAgICAgdGhpcy5hcmdzID0gYXJncztcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRnJvbUFycmF5T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgRnJvbUFycmF5U2luayhvYnNlcnZlciwgdGhpcyk7XG4gICAgICByZXR1cm4gc2luay5ydW4oKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEZyb21BcnJheU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICBmdW5jdGlvbiBGcm9tQXJyYXlTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcbiAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIH1cblxuICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGFyZ3MsIG9ic2VydmVyKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3MubGVuZ3RoO1xuICAgIHJldHVybiBmdW5jdGlvbiBsb29wIChpLCByZWN1cnNlKSB7XG4gICAgICBpZiAoaSA8IGxlbikge1xuICAgICAgICBvYnNlcnZlci5vbk5leHQoYXJnc1tpXSk7XG4gICAgICAgIHJlY3Vyc2UoaSArIDEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgRnJvbUFycmF5U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSh0aGlzLnBhcmVudC5hcmdzLCB0aGlzLm9ic2VydmVyKSk7XG4gIH07XG5cbiAgLyoqXG4gICogIENvbnZlcnRzIGFuIGFycmF5IHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UsIHVzaW5nIGFuIG9wdGlvbmFsIHNjaGVkdWxlciB0byBlbnVtZXJhdGUgdGhlIGFycmF5LlxuICAqIEBkZXByZWNhdGVkIHVzZSBPYnNlcnZhYmxlLmZyb20gb3IgT2JzZXJ2YWJsZS5vZlxuICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSBlbnVtZXJhdGlvbiBvZiB0aGUgaW5wdXQgc2VxdWVuY2Ugb24uXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdob3NlIGVsZW1lbnRzIGFyZSBwdWxsZWQgZnJvbSB0aGUgZ2l2ZW4gZW51bWVyYWJsZSBzZXF1ZW5jZS5cbiAgKi9cbiAgdmFyIG9ic2VydmFibGVGcm9tQXJyYXkgPSBPYnNlcnZhYmxlLmZyb21BcnJheSA9IGZ1bmN0aW9uIChhcnJheSwgc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpXG4gIH07XG5cbiAgdmFyIE5ldmVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhOZXZlck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gTmV2ZXJPYnNlcnZhYmxlKCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgTmV2ZXJPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgIH07XG5cbiAgICByZXR1cm4gTmV2ZXJPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIE5FVkVSX09CU0VSVkFCTEUgPSBuZXcgTmV2ZXJPYnNlcnZhYmxlKCk7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBub24tdGVybWluYXRpbmcgb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgd2hpY2ggY2FuIGJlIHVzZWQgdG8gZGVub3RlIGFuIGluZmluaXRlIGR1cmF0aW9uIChlLmcuIHdoZW4gdXNpbmcgcmVhY3RpdmUgam9pbnMpLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBvYnNlcnZlcnMgd2lsbCBuZXZlciBnZXQgY2FsbGVkLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVOZXZlciA9IE9ic2VydmFibGUubmV2ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIE5FVkVSX09CU0VSVkFCTEU7XG4gIH07XG5cbiAgZnVuY3Rpb24gb2JzZXJ2YWJsZU9mIChzY2hlZHVsZXIsIGFycmF5KSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFycmF5LCBzY2hlZHVsZXIpO1xuICB9XG5cbiAgLyoqXG4gICogIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgT2JzZXJ2YWJsZSBpbnN0YW5jZSB3aXRoIGEgdmFyaWFibGUgbnVtYmVyIG9mIGFyZ3VtZW50cywgcmVnYXJkbGVzcyBvZiBudW1iZXIgb3IgdHlwZSBvZiB0aGUgYXJndW1lbnRzLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgcHVsbGVkIGZyb20gdGhlIGdpdmVuIGFyZ3VtZW50cy5cbiAgKi9cbiAgT2JzZXJ2YWJsZS5vZiA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuICB9O1xuXG4gIC8qKlxuICAqICBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgbmV3IE9ic2VydmFibGUgaW5zdGFuY2Ugd2l0aCBhIHZhcmlhYmxlIG51bWJlciBvZiBhcmd1bWVudHMsIHJlZ2FyZGxlc3Mgb2YgbnVtYmVyIG9yIHR5cGUgb2YgdGhlIGFyZ3VtZW50cy5cbiAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gc2NoZWR1bGVyIEEgc2NoZWR1bGVyIHRvIHVzZSBmb3Igc2NoZWR1bGluZyB0aGUgYXJndW1lbnRzLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgcHVsbGVkIGZyb20gdGhlIGdpdmVuIGFyZ3VtZW50cy5cbiAgKi9cbiAgT2JzZXJ2YWJsZS5vZldpdGhTY2hlZHVsZXIgPSBmdW5jdGlvbiAoc2NoZWR1bGVyKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuIC0gMSk7XG4gICAgZm9yKHZhciBpID0gMTsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIG5ldyBGcm9tQXJyYXlPYnNlcnZhYmxlKGFyZ3MsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIFBhaXJzT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhQYWlyc09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUGFpcnNPYnNlcnZhYmxlKG9iaiwgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLm9iaiA9IG9iajtcbiAgICAgIHRoaXMua2V5cyA9IE9iamVjdC5rZXlzKG9iaik7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFBhaXJzT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHNpbmsgPSBuZXcgUGFpcnNTaW5rKG9ic2VydmVyLCB0aGlzKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICByZXR1cm4gUGFpcnNPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgZnVuY3Rpb24gUGFpcnNTaW5rKG9ic2VydmVyLCBwYXJlbnQpIHtcbiAgICB0aGlzLm9ic2VydmVyID0gb2JzZXJ2ZXI7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gIH1cblxuICBQYWlyc1NpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb2JzZXJ2ZXIgPSB0aGlzLm9ic2VydmVyLCBvYmogPSB0aGlzLnBhcmVudC5vYmosIGtleXMgPSB0aGlzLnBhcmVudC5rZXlzLCBsZW4gPSBrZXlzLmxlbmd0aDtcbiAgICBmdW5jdGlvbiBsb29wUmVjdXJzaXZlKGksIHJlY3Vyc2UpIHtcbiAgICAgIGlmIChpIDwgbGVuKSB7XG4gICAgICAgIHZhciBrZXkgPSBrZXlzW2ldO1xuICAgICAgICBvYnNlcnZlci5vbk5leHQoW2tleSwgb2JqW2tleV1dKTtcbiAgICAgICAgcmVjdXJzZShpICsgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvYnNlcnZlci5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoMCwgbG9vcFJlY3Vyc2l2ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgYW4gb2JqZWN0IGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBba2V5LCB2YWx1ZV0gcGFpcnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZW51bWVyYXRpb24gb2YgdGhlIGlucHV0IHNlcXVlbmNlIG9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBba2V5LCB2YWx1ZV0gcGFpcnMgZnJvbSB0aGUgb2JqZWN0LlxuICAgKi9cbiAgT2JzZXJ2YWJsZS5wYWlycyA9IGZ1bmN0aW9uIChvYmosIHNjaGVkdWxlcikge1xuICAgIHNjaGVkdWxlciB8fCAoc2NoZWR1bGVyID0gY3VycmVudFRocmVhZFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBQYWlyc09ic2VydmFibGUob2JqLCBzY2hlZHVsZXIpO1xuICB9O1xuXG4gICAgdmFyIFJhbmdlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhSYW5nZU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUmFuZ2VPYnNlcnZhYmxlKHN0YXJ0LCBjb3VudCwgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLnN0YXJ0ID0gc3RhcnQ7XG4gICAgICB0aGlzLnJhbmdlQ291bnQgPSBjb3VudDtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgUmFuZ2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICB2YXIgc2luayA9IG5ldyBSYW5nZVNpbmsob2JzZXJ2ZXIsIHRoaXMpO1xuICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBSYW5nZU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgUmFuZ2VTaW5rID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSYW5nZVNpbmsob2JzZXJ2ZXIsIHBhcmVudCkge1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShzdGFydCwgY291bnQsIG9ic2VydmVyKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gbG9vcCAoaSwgcmVjdXJzZSkge1xuICAgICAgICBpZiAoaSA8IGNvdW50KSB7XG4gICAgICAgICAgb2JzZXJ2ZXIub25OZXh0KHN0YXJ0ICsgaSk7XG4gICAgICAgICAgcmVjdXJzZShpICsgMSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBSYW5nZVNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiB0aGlzLnBhcmVudC5zY2hlZHVsZXIuc2NoZWR1bGVSZWN1cnNpdmUoXG4gICAgICAgIDAsXG4gICAgICAgIGxvb3BSZWN1cnNpdmUodGhpcy5wYXJlbnQuc3RhcnQsIHRoaXMucGFyZW50LnJhbmdlQ291bnQsIHRoaXMub2JzZXJ2ZXIpXG4gICAgICApO1xuICAgIH07XG5cbiAgICByZXR1cm4gUmFuZ2VTaW5rO1xuICB9KCkpO1xuXG4gIC8qKlxuICAqICBHZW5lcmF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBpbnRlZ3JhbCBudW1iZXJzIHdpdGhpbiBhIHNwZWNpZmllZCByYW5nZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgdG8gc2VuZCBvdXQgb2JzZXJ2ZXIgbWVzc2FnZXMuXG4gICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0IFRoZSB2YWx1ZSBvZiB0aGUgZmlyc3QgaW50ZWdlciBpbiB0aGUgc2VxdWVuY2UuXG4gICogQHBhcmFtIHtOdW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2Ygc2VxdWVudGlhbCBpbnRlZ2VycyB0byBnZW5lcmF0ZS5cbiAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHRvIHJ1biB0aGUgZ2VuZXJhdG9yIGxvb3Agb24uIElmIG5vdCBzcGVjaWZpZWQsIGRlZmF1bHRzIHRvIFNjaGVkdWxlci5jdXJyZW50VGhyZWFkLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgYSByYW5nZSBvZiBzZXF1ZW50aWFsIGludGVncmFsIG51bWJlcnMuXG4gICovXG4gIE9ic2VydmFibGUucmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQsIGNvdW50LCBzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBjdXJyZW50VGhyZWFkU2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IFJhbmdlT2JzZXJ2YWJsZShzdGFydCwgY291bnQsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIFJlcGVhdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoUmVwZWF0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBSZXBlYXRPYnNlcnZhYmxlKHZhbHVlLCByZXBlYXRDb3VudCwgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICB0aGlzLnJlcGVhdENvdW50ID0gcmVwZWF0Q291bnQgPT0gbnVsbCA/IC0xIDogcmVwZWF0Q291bnQ7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFJlcGVhdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IFJlcGVhdFNpbmsob2JzZXJ2ZXIsIHRoaXMpO1xuICAgICAgcmV0dXJuIHNpbmsucnVuKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBSZXBlYXRPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgZnVuY3Rpb24gUmVwZWF0U2luayhvYnNlcnZlciwgcGFyZW50KSB7XG4gICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICB9XG5cbiAgUmVwZWF0U2luay5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBvYnNlcnZlciA9IHRoaXMub2JzZXJ2ZXIsIHZhbHVlID0gdGhpcy5wYXJlbnQudmFsdWU7XG4gICAgZnVuY3Rpb24gbG9vcFJlY3Vyc2l2ZShpLCByZWN1cnNlKSB7XG4gICAgICBpZiAoaSA9PT0gLTEgfHwgaSA+IDApIHtcbiAgICAgICAgb2JzZXJ2ZXIub25OZXh0KHZhbHVlKTtcbiAgICAgICAgaSA+IDAgJiYgaS0tO1xuICAgICAgfVxuICAgICAgaWYgKGkgPT09IDApIHsgcmV0dXJuIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7IH1cbiAgICAgIHJlY3Vyc2UoaSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucGFyZW50LnNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSh0aGlzLnBhcmVudC5yZXBlYXRDb3VudCwgbG9vcFJlY3Vyc2l2ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqICBHZW5lcmF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHJlcGVhdHMgdGhlIGdpdmVuIGVsZW1lbnQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IG9ic2VydmVyIG1lc3NhZ2VzLlxuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBFbGVtZW50IHRvIHJlcGVhdC5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IHJlcGVhdENvdW50IFtPcHRpb25hXSBOdW1iZXIgb2YgdGltZXMgdG8gcmVwZWF0IHRoZSBlbGVtZW50LiBJZiBub3Qgc3BlY2lmaWVkLCByZXBlYXRzIGluZGVmaW5pdGVseS5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBTY2hlZHVsZXIgdG8gcnVuIHRoZSBwcm9kdWNlciBsb29wIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuaW1tZWRpYXRlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHJlcGVhdHMgdGhlIGdpdmVuIGVsZW1lbnQgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMuXG4gICAqL1xuICBPYnNlcnZhYmxlLnJlcGVhdCA9IGZ1bmN0aW9uICh2YWx1ZSwgcmVwZWF0Q291bnQsIHNjaGVkdWxlcikge1xuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIpO1xuICAgIHJldHVybiBuZXcgUmVwZWF0T2JzZXJ2YWJsZSh2YWx1ZSwgcmVwZWF0Q291bnQsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIEp1c3RPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEp1c3RPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEp1c3RPYnNlcnZhYmxlKHZhbHVlLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSnVzdE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IEp1c3RTaW5rKG9ic2VydmVyLCB0aGlzLnZhbHVlLCB0aGlzLnNjaGVkdWxlcik7XG4gICAgICByZXR1cm4gc2luay5ydW4oKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gSnVzdFNpbmsob2JzZXJ2ZXIsIHZhbHVlLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjaGVkdWxlSXRlbShzLCBzdGF0ZSkge1xuICAgICAgdmFyIHZhbHVlID0gc3RhdGVbMF0sIG9ic2VydmVyID0gc3RhdGVbMV07XG4gICAgICBvYnNlcnZlci5vbk5leHQodmFsdWUpO1xuICAgICAgb2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgfVxuXG4gICAgSnVzdFNpbmsucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzdGF0ZSA9IFt0aGlzLnZhbHVlLCB0aGlzLm9ic2VydmVyXTtcbiAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlciA9PT0gaW1tZWRpYXRlU2NoZWR1bGVyID9cbiAgICAgICAgc2NoZWR1bGVJdGVtKG51bGwsIHN0YXRlKSA6XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKHN0YXRlLCBzY2hlZHVsZUl0ZW0pO1xuICAgIH07XG5cbiAgICByZXR1cm4gSnVzdE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIGEgc2luZ2xlIGVsZW1lbnQsIHVzaW5nIHRoZSBzcGVjaWZpZWQgc2NoZWR1bGVyIHRvIHNlbmQgb3V0IG9ic2VydmVyIG1lc3NhZ2VzLlxuICAgKiAgVGhlcmUgaXMgYW4gYWxpYXMgY2FsbGVkICdqdXN0JyBvciBicm93c2VycyA8SUU5LlxuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBTaW5nbGUgZWxlbWVudCBpbiB0aGUgcmVzdWx0aW5nIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBzY2hlZHVsZXIgU2NoZWR1bGVyIHRvIHNlbmQgdGhlIHNpbmdsZSBlbGVtZW50IG9uLiBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byBTY2hlZHVsZXIuaW1tZWRpYXRlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBzaW5nbGUgc3BlY2lmaWVkIGVsZW1lbnQuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZVJldHVybiA9IE9ic2VydmFibGVbJ3JldHVybiddID0gT2JzZXJ2YWJsZS5qdXN0ID0gZnVuY3Rpb24gKHZhbHVlLCBzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXIpO1xuICAgIHJldHVybiBuZXcgSnVzdE9ic2VydmFibGUodmFsdWUsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIFRocm93T2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUaHJvd09ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGhyb3dPYnNlcnZhYmxlKGVycm9yLCBzY2hlZHVsZXIpIHtcbiAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGhyb3dPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IFRocm93U2luayhvLCB0aGlzKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBUaHJvd1NpbmsobywgcCkge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMucCA9IHA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVJdGVtKHMsIHN0YXRlKSB7XG4gICAgICB2YXIgZSA9IHN0YXRlWzBdLCBvID0gc3RhdGVbMV07XG4gICAgICBvLm9uRXJyb3IoZSk7XG4gICAgfVxuXG4gICAgVGhyb3dTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5wLnNjaGVkdWxlci5zY2hlZHVsZShbdGhpcy5wLmVycm9yLCB0aGlzLm9dLCBzY2hlZHVsZUl0ZW0pO1xuICAgIH07XG5cbiAgICByZXR1cm4gVGhyb3dPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCB0ZXJtaW5hdGVzIHdpdGggYW4gZXhjZXB0aW9uLCB1c2luZyB0aGUgc3BlY2lmaWVkIHNjaGVkdWxlciB0byBzZW5kIG91dCB0aGUgc2luZ2xlIG9uRXJyb3IgbWVzc2FnZS5cbiAgICogIFRoZXJlIGlzIGFuIGFsaWFzIHRvIHRoaXMgbWV0aG9kIGNhbGxlZCAndGhyb3dFcnJvcicgZm9yIGJyb3dzZXJzIDxJRTkuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIEFuIG9iamVjdCB1c2VkIGZvciB0aGUgc2VxdWVuY2UncyB0ZXJtaW5hdGlvbi5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBTY2hlZHVsZXIgdG8gc2VuZCB0aGUgZXhjZXB0aW9uYWwgdGVybWluYXRpb24gY2FsbCBvbi4gSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLmltbWVkaWF0ZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgdGVybWluYXRlcyBleGNlcHRpb25hbGx5IHdpdGggdGhlIHNwZWNpZmllZCBleGNlcHRpb24gb2JqZWN0LlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVUaHJvdyA9IE9ic2VydmFibGVbJ3Rocm93J10gPSBmdW5jdGlvbiAoZXJyb3IsIHNjaGVkdWxlcikge1xuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcik7XG4gICAgcmV0dXJuIG5ldyBUaHJvd09ic2VydmFibGUoZXJyb3IsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgdmFyIENhdGNoT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ2F0Y2hPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIENhdGNoT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX2ZuID0gZm47XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBDYXRjaE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGQxID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIHN1YnNjcmlwdGlvbiA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG4gICAgICBzdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZShkMSk7XG4gICAgICBkMS5zZXREaXNwb3NhYmxlKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgQ2F0Y2hPYnNlcnZlcihvLCBzdWJzY3JpcHRpb24sIHRoaXMuX2ZuKSkpO1xuICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbjtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENhdGNoT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBDYXRjaE9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENhdGNoT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ2F0Y2hPYnNlcnZlcihvLCBzLCBmbikge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIHRoaXMuX2ZuID0gZm47XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBDYXRjaE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgdGhpcy5fby5vbk5leHQoeCk7IH07XG4gICAgQ2F0Y2hPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuICAgIENhdGNoT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHZhciByZXN1bHQgPSB0cnlDYXRjaCh0aGlzLl9mbikoZSk7XG4gICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlc3VsdC5lKTsgfVxuICAgICAgaXNQcm9taXNlKHJlc3VsdCkgJiYgKHJlc3VsdCA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShyZXN1bHQpKTtcblxuICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHRoaXMuX3Muc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgIGQuc2V0RGlzcG9zYWJsZShyZXN1bHQuc3Vic2NyaWJlKHRoaXMuX28pKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENhdGNoT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBDb250aW51ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRlcm1pbmF0ZWQgYnkgYW4gZXhjZXB0aW9uIHdpdGggdGhlIG5leHQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtNaXhlZH0gaGFuZGxlck9yU2Vjb25kIEV4Y2VwdGlvbiBoYW5kbGVyIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGdpdmVuIHRoZSBlcnJvciB0aGF0IG9jY3VycmVkIGluIHRoZSBmaXJzdCBzZXF1ZW5jZSwgb3IgYSBzZWNvbmQgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB1c2VkIHRvIHByb2R1Y2UgcmVzdWx0cyB3aGVuIGFuIGVycm9yIG9jY3VycmVkIGluIHRoZSBmaXJzdCBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgZmlyc3Qgc2VxdWVuY2UncyBlbGVtZW50cywgZm9sbG93ZWQgYnkgdGhlIGVsZW1lbnRzIG9mIHRoZSBoYW5kbGVyIHNlcXVlbmNlIGluIGNhc2UgYW4gZXhjZXB0aW9uIG9jY3VycmVkLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvWydjYXRjaCddID0gZnVuY3Rpb24gKGhhbmRsZXJPclNlY29uZCkge1xuICAgIHJldHVybiBpc0Z1bmN0aW9uKGhhbmRsZXJPclNlY29uZCkgPyBuZXcgQ2F0Y2hPYnNlcnZhYmxlKHRoaXMsIGhhbmRsZXJPclNlY29uZCkgOiBvYnNlcnZhYmxlQ2F0Y2goW3RoaXMsIGhhbmRsZXJPclNlY29uZF0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDb250aW51ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRlcm1pbmF0ZWQgYnkgYW4gZXhjZXB0aW9uIHdpdGggdGhlIG5leHQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtBcnJheSB8IEFyZ3VtZW50c30gYXJncyBBcmd1bWVudHMgb3IgYW4gYXJyYXkgdG8gdXNlIGFzIHRoZSBuZXh0IHNlcXVlbmNlIGlmIGFuIGVycm9yIG9jY3Vycy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyBlbGVtZW50cyBmcm9tIGNvbnNlY3V0aXZlIHNvdXJjZSBzZXF1ZW5jZXMgdW50aWwgYSBzb3VyY2Ugc2VxdWVuY2UgdGVybWluYXRlcyBzdWNjZXNzZnVsbHkuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZUNhdGNoID0gT2JzZXJ2YWJsZVsnY2F0Y2gnXSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgaXRlbXM7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgaXRlbXMgPSBhcmd1bWVudHNbMF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhciBsZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgICAgaXRlbXMgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBpdGVtc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIH1cbiAgICByZXR1cm4gZW51bWVyYWJsZU9mKGl0ZW1zKS5jYXRjaEVycm9yKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFueSBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgb3IgUHJvbWlzZXMgcHJvZHVjZXMgYW4gZWxlbWVudC5cbiAgICogVGhpcyBjYW4gYmUgaW4gdGhlIGZvcm0gb2YgYW4gYXJndW1lbnQgbGlzdCBvZiBvYnNlcnZhYmxlcyBvciBhbiBhcnJheS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogMSAtIG9icyA9IG9ic2VydmFibGUuY29tYmluZUxhdGVzdChvYnMxLCBvYnMyLCBvYnMzLCBmdW5jdGlvbiAobzEsIG8yLCBvMykgeyByZXR1cm4gbzEgKyBvMiArIG8zOyB9KTtcbiAgICogMiAtIG9icyA9IG9ic2VydmFibGUuY29tYmluZUxhdGVzdChbb2JzMSwgb2JzMiwgb2JzM10sIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmNvbWJpbmVMYXRlc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NbMF0pKSB7XG4gICAgICBhcmdzWzBdLnVuc2hpZnQodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFyZ3MudW5zaGlmdCh0aGlzKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbWJpbmVMYXRlc3QuYXBwbHkodGhpcywgYXJncyk7XG4gIH07XG5cbiAgZnVuY3Rpb24gZmFsc2VGYWN0b3J5KCkgeyByZXR1cm4gZmFsc2U7IH1cbiAgZnVuY3Rpb24gYXJndW1lbnRzVG9BcnJheSgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIGFyZ3M7XG4gIH1cblxuICB2YXIgQ29tYmluZUxhdGVzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ29tYmluZUxhdGVzdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29tYmluZUxhdGVzdE9ic2VydmFibGUocGFyYW1zLCBjYikge1xuICAgICAgdGhpcy5fcGFyYW1zID0gcGFyYW1zO1xuICAgICAgdGhpcy5fY2IgPSBjYjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLl9wYXJhbXMubGVuZ3RoLFxuICAgICAgICAgIHN1YnNjcmlwdGlvbnMgPSBuZXcgQXJyYXkobGVuKTtcblxuICAgICAgdmFyIHN0YXRlID0ge1xuICAgICAgICBoYXNWYWx1ZTogYXJyYXlJbml0aWFsaXplKGxlbiwgZmFsc2VGYWN0b3J5KSxcbiAgICAgICAgaGFzVmFsdWVBbGw6IGZhbHNlLFxuICAgICAgICBpc0RvbmU6IGFycmF5SW5pdGlhbGl6ZShsZW4sIGZhbHNlRmFjdG9yeSksXG4gICAgICAgIHZhbHVlczogbmV3IEFycmF5KGxlbilcbiAgICAgIH07XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IHRoaXMuX3BhcmFtc1tpXSwgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgIHN1YnNjcmlwdGlvbnNbaV0gPSBzYWQ7XG4gICAgICAgIGlzUHJvbWlzZShzb3VyY2UpICYmIChzb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uoc291cmNlKSk7XG4gICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUobmV3IENvbWJpbmVMYXRlc3RPYnNlcnZlcihvYnNlcnZlciwgaSwgdGhpcy5fY2IsIHN0YXRlKSkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3IE5BcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbnMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gQ29tYmluZUxhdGVzdE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgQ29tYmluZUxhdGVzdE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29tYmluZUxhdGVzdE9ic2VydmVyKG8sIGksIGNiLCBzdGF0ZSkge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9pID0gaTtcbiAgICAgIHRoaXMuX2NiID0gY2I7XG4gICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbm90VGhlU2FtZShpKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHgsIGopIHtcbiAgICAgICAgcmV0dXJuIGogIT09IGk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIENvbWJpbmVMYXRlc3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9zdGF0ZS52YWx1ZXNbdGhpcy5faV0gPSB4O1xuICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVbdGhpcy5faV0gPSB0cnVlO1xuICAgICAgaWYgKHRoaXMuX3N0YXRlLmhhc1ZhbHVlQWxsIHx8ICh0aGlzLl9zdGF0ZS5oYXNWYWx1ZUFsbCA9IHRoaXMuX3N0YXRlLmhhc1ZhbHVlLmV2ZXJ5KGlkZW50aXR5KSkpIHtcbiAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX2NiKS5hcHBseShudWxsLCB0aGlzLl9zdGF0ZS52YWx1ZXMpO1xuICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgICB0aGlzLl9vLm9uTmV4dChyZXMpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLl9zdGF0ZS5pc0RvbmUuZmlsdGVyKG5vdFRoZVNhbWUodGhpcy5faSkpLmV2ZXJ5KGlkZW50aXR5KSkge1xuICAgICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIENvbWJpbmVMYXRlc3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBDb21iaW5lTGF0ZXN0T2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3N0YXRlLmlzRG9uZVt0aGlzLl9pXSA9IHRydWU7XG4gICAgICB0aGlzLl9zdGF0ZS5pc0RvbmUuZXZlcnkoaWRlbnRpdHkpICYmIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENvbWJpbmVMYXRlc3RPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYW55IG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBQcm9taXNlcyBwcm9kdWNlcyBhbiBlbGVtZW50LlxuICAqXG4gICogQGV4YW1wbGVcbiAgKiAxIC0gb2JzID0gUnguT2JzZXJ2YWJsZS5jb21iaW5lTGF0ZXN0KG9iczEsIG9iczIsIG9iczMsIGZ1bmN0aW9uIChvMSwgbzIsIG8zKSB7IHJldHVybiBvMSArIG8yICsgbzM7IH0pO1xuICAqIDIgLSBvYnMgPSBSeC5PYnNlcnZhYmxlLmNvbWJpbmVMYXRlc3QoW29iczEsIG9iczIsIG9iczNdLCBmdW5jdGlvbiAobzEsIG8yLCBvMykgeyByZXR1cm4gbzEgKyBvMiArIG8zOyB9KTtcbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAqL1xuICB2YXIgY29tYmluZUxhdGVzdCA9IE9ic2VydmFibGUuY29tYmluZUxhdGVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuICAgIEFycmF5LmlzQXJyYXkoYXJnc1swXSkgJiYgKGFyZ3MgPSBhcmdzWzBdKTtcbiAgICByZXR1cm4gbmV3IENvbWJpbmVMYXRlc3RPYnNlcnZhYmxlKGFyZ3MsIHJlc3VsdFNlbGVjdG9yKTtcbiAgfTtcblxuICAvKipcbiAgICogQ29uY2F0ZW5hdGVzIGFsbCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuICBUaGlzIHRha2VzIGluIGVpdGhlciBhbiBhcnJheSBvciB2YXJpYWJsZSBhcmd1bWVudHMgdG8gY29uY2F0ZW5hdGUuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGVhY2ggZ2l2ZW4gc2VxdWVuY2UsIGluIHNlcXVlbnRpYWwgb3JkZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uY29uY2F0ID0gZnVuY3Rpb24gKCkge1xuICAgIGZvcih2YXIgYXJncyA9IFtdLCBpID0gMCwgbGVuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3MucHVzaChhcmd1bWVudHNbaV0pOyB9XG4gICAgYXJncy51bnNoaWZ0KHRoaXMpO1xuICAgIHJldHVybiBvYnNlcnZhYmxlQ29uY2F0LmFwcGx5KG51bGwsIGFyZ3MpO1xuICB9O1xuXG4gIHZhciBDb25jYXRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENvbmNhdE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29uY2F0T2JzZXJ2YWJsZShzb3VyY2VzKSB7XG4gICAgICB0aGlzLnNvdXJjZXMgPSBzb3VyY2VzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgQ29uY2F0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG8pIHtcbiAgICAgIHZhciBzaW5rID0gbmV3IENvbmNhdFNpbmsodGhpcy5zb3VyY2VzLCBvKTtcbiAgICAgIHJldHVybiBzaW5rLnJ1bigpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBDb25jYXRTaW5rKHNvdXJjZXMsIG8pIHtcbiAgICAgIHRoaXMuc291cmNlcyA9IHNvdXJjZXM7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgIH1cbiAgICBDb25jYXRTaW5rLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaXNEaXNwb3NlZCwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKSwgc291cmNlcyA9IHRoaXMuc291cmNlcywgbGVuZ3RoID0gc291cmNlcy5sZW5ndGgsIG8gPSB0aGlzLm87XG4gICAgICB2YXIgY2FuY2VsYWJsZSA9IGltbWVkaWF0ZVNjaGVkdWxlci5zY2hlZHVsZVJlY3Vyc2l2ZSgwLCBmdW5jdGlvbiAoaSwgc2VsZikge1xuICAgICAgICBpZiAoaXNEaXNwb3NlZCkgeyByZXR1cm47IH1cbiAgICAgICAgaWYgKGkgPT09IGxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiBwcm9taXNlXG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSBzb3VyY2VzW2ldO1xuICAgICAgICBpc1Byb21pc2UoY3VycmVudFZhbHVlKSAmJiAoY3VycmVudFZhbHVlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGN1cnJlbnRWYWx1ZSkpO1xuXG4gICAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgICBkLnNldERpc3Bvc2FibGUoY3VycmVudFZhbHVlLnN1YnNjcmliZShcbiAgICAgICAgICBmdW5jdGlvbiAoeCkgeyBvLm9uTmV4dCh4KTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sXG4gICAgICAgICAgZnVuY3Rpb24gKCkgeyBzZWxmKGkgKyAxKTsgfVxuICAgICAgICApKTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCBjYW5jZWxhYmxlLCBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICB9KSk7XG4gICAgfTtcblxuXG4gICAgcmV0dXJuIENvbmNhdE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgICogQ29uY2F0ZW5hdGVzIGFsbCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG4gICAqIEBwYXJhbSB7QXJyYXkgfCBBcmd1bWVudHN9IGFyZ3MgQXJndW1lbnRzIG9yIGFuIGFycmF5IHRvIGNvbmNhdCB0byB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgZWFjaCBnaXZlbiBzZXF1ZW5jZSwgaW4gc2VxdWVudGlhbCBvcmRlci5cbiAgICovXG4gIHZhciBvYnNlcnZhYmxlQ29uY2F0ID0gT2JzZXJ2YWJsZS5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFyZ3M7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgYXJncyA9IGFyZ3VtZW50c1swXTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKTtcbiAgICAgIGZvcih2YXIgaSA9IDAsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgQ29uY2F0T2JzZXJ2YWJsZShhcmdzKTtcbiAgfTtcblxuICAvKipcbiAgICogQ29uY2F0ZW5hdGVzIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGVhY2ggb2JzZXJ2ZWQgaW5uZXIgc2VxdWVuY2UsIGluIHNlcXVlbnRpYWwgb3JkZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uY29uY2F0QWxsID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLm1lcmdlKDEpO1xuICB9O1xuXG4gIHZhciBNZXJnZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE1lcmdlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIE1lcmdlT2JzZXJ2YWJsZShzb3VyY2UsIG1heENvbmN1cnJlbnQpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5tYXhDb25jdXJyZW50ID0gbWF4Q29uY3VycmVudDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE1lcmdlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uKG9ic2VydmVyKSB7XG4gICAgICB2YXIgZyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG4gICAgICBnLmFkZCh0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IE1lcmdlT2JzZXJ2ZXIob2JzZXJ2ZXIsIHRoaXMubWF4Q29uY3VycmVudCwgZykpKTtcbiAgICAgIHJldHVybiBnO1xuICAgIH07XG5cbiAgICByZXR1cm4gTWVyZ2VPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgTWVyZ2VPYnNlcnZlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWVyZ2VPYnNlcnZlcihvLCBtYXgsIGcpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLm1heCA9IG1heDtcbiAgICAgIHRoaXMuZyA9IGc7XG4gICAgICB0aGlzLmRvbmUgPSBmYWxzZTtcbiAgICAgIHRoaXMucSA9IFtdO1xuICAgICAgdGhpcy5hY3RpdmVDb3VudCA9IDA7XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5oYW5kbGVTdWJzY3JpYmUgPSBmdW5jdGlvbiAoeHMpIHtcbiAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHRoaXMuZy5hZGQoc2FkKTtcbiAgICAgIGlzUHJvbWlzZSh4cykgJiYgKHhzID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHhzKSk7XG4gICAgICBzYWQuc2V0RGlzcG9zYWJsZSh4cy5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIodGhpcywgc2FkKSkpO1xuICAgIH07XG4gICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUub25OZXh0ID0gZnVuY3Rpb24gKGlubmVyU291cmNlKSB7XG4gICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmKHRoaXMuYWN0aXZlQ291bnQgPCB0aGlzLm1heCkge1xuICAgICAgICAgIHRoaXMuYWN0aXZlQ291bnQrKztcbiAgICAgICAgICB0aGlzLmhhbmRsZVN1YnNjcmliZShpbm5lclNvdXJjZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xLnB1c2goaW5uZXJTb3VyY2UpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgTWVyZ2VPYnNlcnZlci5wcm90b3R5cGUub25FcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmRvbmUgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuYWN0aXZlQ291bnQgPT09IDAgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBNZXJnZU9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcbiAgICAgIE1lcmdlT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfTtcblxuICAgICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihwYXJlbnQsIHNhZCkge1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5zYWQgPSBzYWQ7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoeCkgeyBpZighdGhpcy5pc1N0b3BwZWQpIHsgdGhpcy5wYXJlbnQuby5vbk5leHQoeCk7IH0gfTtcbiAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICAgIHBhcmVudC5nLnJlbW92ZSh0aGlzLnNhZCk7XG4gICAgICAgICAgaWYgKHBhcmVudC5xLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHBhcmVudC5oYW5kbGVTdWJzY3JpYmUocGFyZW50LnEuc2hpZnQoKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBhcmVudC5hY3RpdmVDb3VudC0tO1xuICAgICAgICAgICAgcGFyZW50LmRvbmUgJiYgcGFyZW50LmFjdGl2ZUNvdW50ID09PSAwICYmIHBhcmVudC5vLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH07XG4gICAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLnBhcmVudC5vLm9uRXJyb3IoZSk7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gTWVyZ2VPYnNlcnZlcjtcbiAgfSgpKTtcblxuXG5cblxuXG4gIC8qKlxuICAqIE1lcmdlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgbGltaXRpbmcgdGhlIG51bWJlciBvZiBjb25jdXJyZW50IHN1YnNjcmlwdGlvbnMgdG8gaW5uZXIgc2VxdWVuY2VzLlxuICAqIE9yIG1lcmdlcyB0d28gb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhIHNpbmdsZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqXG4gICogQGV4YW1wbGVcbiAgKiAxIC0gbWVyZ2VkID0gc291cmNlcy5tZXJnZSgxKTtcbiAgKiAyIC0gbWVyZ2VkID0gc291cmNlLm1lcmdlKG90aGVyU291cmNlKTtcbiAgKiBAcGFyYW0ge01peGVkfSBbbWF4Q29uY3VycmVudE9yT3RoZXJdIE1heGltdW0gbnVtYmVyIG9mIGlubmVyIG9ic2VydmFibGUgc2VxdWVuY2VzIGJlaW5nIHN1YnNjcmliZWQgdG8gY29uY3VycmVudGx5IG9yIHRoZSBzZWNvbmQgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBtZXJnZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBpbm5lciBzZXF1ZW5jZXMuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5tZXJnZSA9IGZ1bmN0aW9uIChtYXhDb25jdXJyZW50T3JPdGhlcikge1xuICAgIHJldHVybiB0eXBlb2YgbWF4Q29uY3VycmVudE9yT3RoZXIgIT09ICdudW1iZXInID9cbiAgICAgIG9ic2VydmFibGVNZXJnZSh0aGlzLCBtYXhDb25jdXJyZW50T3JPdGhlcikgOlxuICAgICAgbmV3IE1lcmdlT2JzZXJ2YWJsZSh0aGlzLCBtYXhDb25jdXJyZW50T3JPdGhlcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1lcmdlcyBhbGwgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYSBzaW5nbGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogVGhlIHNjaGVkdWxlciBpcyBvcHRpb25hbCBhbmQgaWYgbm90IHNwZWNpZmllZCwgdGhlIGltbWVkaWF0ZSBzY2hlZHVsZXIgaXMgdXNlZC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgbWVyZ2VzIHRoZSBlbGVtZW50cyBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZU1lcmdlID0gT2JzZXJ2YWJsZS5tZXJnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2NoZWR1bGVyLCBzb3VyY2VzID0gW10sIGksIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgaWYgKCFhcmd1bWVudHNbMF0pIHtcbiAgICAgIHNjaGVkdWxlciA9IGltbWVkaWF0ZVNjaGVkdWxlcjtcbiAgICAgIGZvcihpID0gMTsgaSA8IGxlbjsgaSsrKSB7IHNvdXJjZXMucHVzaChhcmd1bWVudHNbaV0pOyB9XG4gICAgfSBlbHNlIGlmIChpc1NjaGVkdWxlcihhcmd1bWVudHNbMF0pKSB7XG4gICAgICBzY2hlZHVsZXIgPSBhcmd1bWVudHNbMF07XG4gICAgICBmb3IoaSA9IDE7IGkgPCBsZW47IGkrKykgeyBzb3VyY2VzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuICAgIH0gZWxzZSB7XG4gICAgICBzY2hlZHVsZXIgPSBpbW1lZGlhdGVTY2hlZHVsZXI7XG4gICAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgeyBzb3VyY2VzLnB1c2goYXJndW1lbnRzW2ldKTsgfVxuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShzb3VyY2VzWzBdKSkge1xuICAgICAgc291cmNlcyA9IHNvdXJjZXNbMF07XG4gICAgfVxuICAgIHJldHVybiBvYnNlcnZhYmxlT2Yoc2NoZWR1bGVyLCBzb3VyY2VzKS5tZXJnZUFsbCgpO1xuICB9O1xuXG4gIHZhciBDb21wb3NpdGVFcnJvciA9IFJ4LkNvbXBvc2l0ZUVycm9yID0gZnVuY3Rpb24oZXJyb3JzKSB7XG4gICAgdGhpcy5pbm5lckVycm9ycyA9IGVycm9ycztcbiAgICB0aGlzLm1lc3NhZ2UgPSAnVGhpcyBjb250YWlucyBtdWx0aXBsZSBlcnJvcnMuIENoZWNrIHRoZSBpbm5lckVycm9ycyc7XG4gICAgRXJyb3IuY2FsbCh0aGlzKTtcbiAgfTtcbiAgQ29tcG9zaXRlRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuICBDb21wb3NpdGVFcnJvci5wcm90b3R5cGUubmFtZSA9ICdDb21wb3NpdGVFcnJvcic7XG5cbiAgdmFyIE1lcmdlRGVsYXlFcnJvck9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTWVyZ2VEZWxheUVycm9yT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBncm91cCA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCksXG4gICAgICAgIG0gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKSxcbiAgICAgICAgc3RhdGUgPSB7IGlzU3RvcHBlZDogZmFsc2UsIGVycm9yczogW10sIG86IG8gfTtcblxuICAgICAgZ3JvdXAuYWRkKG0pO1xuICAgICAgbS5zZXREaXNwb3NhYmxlKHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIoZ3JvdXAsIHN0YXRlKSkpO1xuXG4gICAgICByZXR1cm4gZ3JvdXA7XG4gICAgfTtcblxuICAgIHJldHVybiBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKE1lcmdlRGVsYXlFcnJvck9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE1lcmdlRGVsYXlFcnJvck9ic2VydmVyKGdyb3VwLCBzdGF0ZSkge1xuICAgICAgdGhpcy5fZ3JvdXAgPSBncm91cDtcbiAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRDb21wbGV0aW9uKG8sIGVycm9ycykge1xuICAgICAgaWYgKGVycm9ycy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfSBlbHNlIGlmIChlcnJvcnMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIG8ub25FcnJvcihlcnJvcnNbMF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgby5vbkVycm9yKG5ldyBDb21wb3NpdGVFcnJvcihlcnJvcnMpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB2YXIgaW5uZXIgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHRoaXMuX2dyb3VwLmFkZChpbm5lcik7XG5cbiAgICAgIC8vIENoZWNrIGZvciBwcm9taXNlcyBzdXBwb3J0XG4gICAgICBpc1Byb21pc2UoeCkgJiYgKHggPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoeCkpO1xuICAgICAgaW5uZXIuc2V0RGlzcG9zYWJsZSh4LnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihpbm5lciwgdGhpcy5fZ3JvdXAsIHRoaXMuX3N0YXRlKSkpO1xuICAgIH07XG5cbiAgICBNZXJnZURlbGF5RXJyb3JPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fc3RhdGUuZXJyb3JzLnB1c2goZSk7XG4gICAgICB0aGlzLl9zdGF0ZS5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgdGhpcy5fZ3JvdXAubGVuZ3RoID09PSAxICYmIHNldENvbXBsZXRpb24odGhpcy5fc3RhdGUubywgdGhpcy5fc3RhdGUuZXJyb3JzKTtcbiAgICB9O1xuXG4gICAgTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIoaW5uZXIsIGdyb3VwLCBzdGF0ZSkge1xuICAgICAgdGhpcy5faW5uZXIgPSBpbm5lcjtcbiAgICAgIHRoaXMuX2dyb3VwID0gZ3JvdXA7XG4gICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7IHRoaXMuX3N0YXRlLm8ub25OZXh0KHgpOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX3N0YXRlLmVycm9ycy5wdXNoKGUpO1xuICAgICAgdGhpcy5fZ3JvdXAucmVtb3ZlKHRoaXMuX2lubmVyKTtcbiAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCAmJiB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fZ3JvdXAucmVtb3ZlKHRoaXMuX2lubmVyKTtcbiAgICAgIHRoaXMuX3N0YXRlLmlzU3RvcHBlZCAmJiB0aGlzLl9ncm91cC5sZW5ndGggPT09IDEgJiYgc2V0Q29tcGxldGlvbih0aGlzLl9zdGF0ZS5vLCB0aGlzLl9zdGF0ZS5lcnJvcnMpO1xuICAgIH07XG5cbiAgICByZXR1cm4gTWVyZ2VEZWxheUVycm9yT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAqIEZsYXR0ZW5zIGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBPYnNlcnZhYmxlcyBpbnRvIG9uZSBPYnNlcnZhYmxlLCBpbiBhIHdheSB0aGF0IGFsbG93cyBhbiBPYnNlcnZlciB0b1xuICAqIHJlY2VpdmUgYWxsIHN1Y2Nlc3NmdWxseSBlbWl0dGVkIGl0ZW1zIGZyb20gYWxsIG9mIHRoZSBzb3VyY2UgT2JzZXJ2YWJsZXMgd2l0aG91dCBiZWluZyBpbnRlcnJ1cHRlZCBieVxuICAqIGFuIGVycm9yIG5vdGlmaWNhdGlvbiBmcm9tIG9uZSBvZiB0aGVtLlxuICAqXG4gICogVGhpcyBiZWhhdmVzIGxpa2UgT2JzZXJ2YWJsZS5wcm90b3R5cGUubWVyZ2VBbGwgZXhjZXB0IHRoYXQgaWYgYW55IG9mIHRoZSBtZXJnZWQgT2JzZXJ2YWJsZXMgbm90aWZ5IG9mIGFuXG4gICogZXJyb3IgdmlhIHRoZSBPYnNlcnZlcidzIG9uRXJyb3IsIG1lcmdlRGVsYXlFcnJvciB3aWxsIHJlZnJhaW4gZnJvbSBwcm9wYWdhdGluZyB0aGF0XG4gICogZXJyb3Igbm90aWZpY2F0aW9uIHVudGlsIGFsbCBvZiB0aGUgbWVyZ2VkIE9ic2VydmFibGVzIGhhdmUgZmluaXNoZWQgZW1pdHRpbmcgaXRlbXMuXG4gICogQHBhcmFtIHtBcnJheSB8IEFyZ3VtZW50c30gYXJncyBBcmd1bWVudHMgb3IgYW4gYXJyYXkgdG8gbWVyZ2UuXG4gICogQHJldHVybnMge09ic2VydmFibGV9IGFuIE9ic2VydmFibGUgdGhhdCBlbWl0cyBhbGwgb2YgdGhlIGl0ZW1zIGVtaXR0ZWQgYnkgdGhlIE9ic2VydmFibGVzIGVtaXR0ZWQgYnkgdGhlIE9ic2VydmFibGVcbiAgKi9cbiAgT2JzZXJ2YWJsZS5tZXJnZURlbGF5RXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXJncztcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG4gICAgICBhcmdzID0gYXJndW1lbnRzWzBdO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgfVxuICAgIHZhciBzb3VyY2UgPSBvYnNlcnZhYmxlT2YobnVsbCwgYXJncyk7XG4gICAgcmV0dXJuIG5ldyBNZXJnZURlbGF5RXJyb3JPYnNlcnZhYmxlKHNvdXJjZSk7XG4gIH07XG5cbiAgdmFyIE1lcmdlQWxsT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTWVyZ2VBbGxPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gTWVyZ2VBbGxPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBNZXJnZUFsbE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBnID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKSwgbSA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgZy5hZGQobSk7XG4gICAgICBtLnNldERpc3Bvc2FibGUodGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNZXJnZUFsbE9ic2VydmVyKG9ic2VydmVyLCBnKSkpO1xuICAgICAgcmV0dXJuIGc7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIE1lcmdlQWxsT2JzZXJ2ZXIobywgZykge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMuZyA9IGc7XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5kb25lID0gZmFsc2U7XG4gICAgfVxuICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uKGlubmVyU291cmNlKSB7XG4gICAgICBpZih0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHRoaXMuZy5hZGQoc2FkKTtcblxuICAgICAgaXNQcm9taXNlKGlubmVyU291cmNlKSAmJiAoaW5uZXJTb3VyY2UgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UoaW5uZXJTb3VyY2UpKTtcblxuICAgICAgc2FkLnNldERpc3Bvc2FibGUoaW5uZXJTb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKHRoaXMsIHNhZCkpKTtcbiAgICB9O1xuICAgIE1lcmdlQWxsT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZG9uZSA9IHRydWU7XG4gICAgICAgIHRoaXMuZy5sZW5ndGggPT09IDEgJiYgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcbiAgICBNZXJnZUFsbE9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm8ub25FcnJvcihlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihwYXJlbnQsIHNhZCkge1xuICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICB0aGlzLnNhZCA9IHNhZDtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uTmV4dCA9IGZ1bmN0aW9uICh4KSB7IGlmICghdGhpcy5pc1N0b3BwZWQpIHsgdGhpcy5wYXJlbnQuby5vbk5leHQoeCk7IH0gfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIGlmKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uQ29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICBwYXJlbnQuZy5yZW1vdmUodGhpcy5zYWQpO1xuICAgICAgICBwYXJlbnQuZG9uZSAmJiBwYXJlbnQuZy5sZW5ndGggPT09IDEgJiYgcGFyZW50Lm8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE1lcmdlQWxsT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqIE1lcmdlcyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9mIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBtZXJnZXMgdGhlIGVsZW1lbnRzIG9mIHRoZSBpbm5lciBzZXF1ZW5jZXMuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5tZXJnZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IE1lcmdlQWxsT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICB2YXIgU2tpcFVudGlsT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTa2lwVW50aWxPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gU2tpcFVudGlsT2JzZXJ2YWJsZShzb3VyY2UsIG90aGVyKSB7XG4gICAgICB0aGlzLl9zID0gc291cmNlO1xuICAgICAgdGhpcy5fbyA9IGlzUHJvbWlzZShvdGhlcikgPyBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpIDogb3RoZXI7XG4gICAgICB0aGlzLl9vcGVuID0gZmFsc2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwVW50aWxPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuICAgICAgdmFyIGxlZnRTdWJzY3JpcHRpb24gPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIGxlZnRTdWJzY3JpcHRpb24uc2V0RGlzcG9zYWJsZSh0aGlzLl9zLnN1YnNjcmliZShuZXcgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIobywgdGhpcykpKTtcblxuICAgICAgaXNQcm9taXNlKHRoaXMuX28pICYmICh0aGlzLl9vID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHRoaXMuX28pKTtcblxuICAgICAgdmFyIHJpZ2h0U3Vic2NyaXB0aW9uID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICByaWdodFN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHRoaXMuX28uc3Vic2NyaWJlKG5ldyBTa2lwVW50aWxPdGhlck9ic2VydmVyKG8sIHRoaXMsIHJpZ2h0U3Vic2NyaXB0aW9uKSkpO1xuXG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUobGVmdFN1YnNjcmlwdGlvbiwgcmlnaHRTdWJzY3JpcHRpb24pO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcFVudGlsT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBTa2lwVW50aWxTb3VyY2VPYnNlcnZlciA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTa2lwVW50aWxTb3VyY2VPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwVW50aWxTb3VyY2VPYnNlcnZlcihvLCBwKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3AgPSBwO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdGhpcy5fcC5fb3BlbiAmJiB0aGlzLl9vLm9uTmV4dCh4KTtcbiAgICB9O1xuXG4gICAgU2tpcFVudGlsU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGVycik7XG4gICAgfTtcblxuICAgIFNraXBVbnRpbFNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX3AuX29wZW4gJiYgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcFVudGlsU291cmNlT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIHZhciBTa2lwVW50aWxPdGhlck9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBVbnRpbE90aGVyT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gU2tpcFVudGlsT3RoZXJPYnNlcnZlcihvLCBwLCByKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3AgPSBwO1xuICAgICAgdGhpcy5fciA9IHI7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwVW50aWxPdGhlck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fcC5fb3BlbiA9IHRydWU7XG4gICAgICB0aGlzLl9yLmRpc3Bvc2UoKTtcbiAgICB9O1xuXG4gICAgU2tpcFVudGlsT3RoZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZXJyKTtcbiAgICB9O1xuXG4gICAgU2tpcFVudGlsT3RoZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9yLmRpc3Bvc2UoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFNraXBVbnRpbE90aGVyT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB2YWx1ZXMgZnJvbSB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2Ugb25seSBhZnRlciB0aGUgb3RoZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBwcm9kdWNlcyBhIHZhbHVlLlxuICAgKiBAcGFyYW0ge09ic2VydmFibGUgfCBQcm9taXNlfSBvdGhlciBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvciBQcm9taXNlIHRoYXQgdHJpZ2dlcnMgcHJvcGFnYXRpb24gb2YgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgZWxlbWVudHMgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZSBzdGFydGluZyBmcm9tIHRoZSBwb2ludCB0aGUgb3RoZXIgc2VxdWVuY2UgdHJpZ2dlcmVkIHByb3BhZ2F0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNraXBVbnRpbCA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgIHJldHVybiBuZXcgU2tpcFVudGlsT2JzZXJ2YWJsZSh0aGlzLCBvdGhlcik7XG4gIH07XG5cbiAgdmFyIFN3aXRjaE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU3dpdGNoT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTd2l0Y2hPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTd2l0Y2hPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBpbm5lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksIHMgPSB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFN3aXRjaE9ic2VydmVyKG8sIGlubmVyKSk7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUocywgaW5uZXIpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhTd2l0Y2hPYnNlcnZlciwgQWJzdHJhY3RPYnNlcnZlcik7XG4gICAgZnVuY3Rpb24gU3dpdGNoT2JzZXJ2ZXIobywgaW5uZXIpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmlubmVyID0gaW5uZXI7XG4gICAgICB0aGlzLnN0b3BwZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMubGF0ZXN0ID0gMDtcbiAgICAgIHRoaXMuaGFzTGF0ZXN0ID0gZmFsc2U7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU3dpdGNoT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoaW5uZXJTb3VyY2UpIHtcbiAgICAgIHZhciBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIGlkID0gKyt0aGlzLmxhdGVzdDtcbiAgICAgIHRoaXMuaGFzTGF0ZXN0ID0gdHJ1ZTtcbiAgICAgIHRoaXMuaW5uZXIuc2V0RGlzcG9zYWJsZShkKTtcbiAgICAgIGlzUHJvbWlzZShpbm5lclNvdXJjZSkgJiYgKGlubmVyU291cmNlID0gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKGlubmVyU291cmNlKSk7XG4gICAgICBkLnNldERpc3Bvc2FibGUoaW5uZXJTb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKHRoaXMsIGlkKSkpO1xuICAgIH07XG5cbiAgICBTd2l0Y2hPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIFN3aXRjaE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnN0b3BwZWQgPSB0cnVlO1xuICAgICAgIXRoaXMuaGFzTGF0ZXN0ICYmIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKHBhcmVudCwgaWQpIHtcbiAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMucGFyZW50LmxhdGVzdCA9PT0gdGhpcy5pZCAmJiB0aGlzLnBhcmVudC5vLm9uTmV4dCh4KTtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5wYXJlbnQubGF0ZXN0ID09PSB0aGlzLmlkICYmIHRoaXMucGFyZW50Lm8ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHRoaXMucGFyZW50LmxhdGVzdCA9PT0gdGhpcy5pZCkge1xuICAgICAgICB0aGlzLnBhcmVudC5oYXNMYXRlc3QgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5wYXJlbnQuaXNTdG9wcGVkICYmIHRoaXMucGFyZW50Lm8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIFN3aXRjaE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgKiBUcmFuc2Zvcm1zIGFuIG9ic2VydmFibGUgc2VxdWVuY2Ugb2Ygb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2luZyB2YWx1ZXMgb25seSBmcm9tIHRoZSBtb3N0IHJlY2VudCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGF0IGFueSBwb2ludCBpbiB0aW1lIHByb2R1Y2VzIHRoZSBlbGVtZW50cyBvZiB0aGUgbW9zdCByZWNlbnQgaW5uZXIgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGhhcyBiZWVuIHJlY2VpdmVkLlxuICAqL1xuICBvYnNlcnZhYmxlUHJvdG9bJ3N3aXRjaCddID0gb2JzZXJ2YWJsZVByb3RvLnN3aXRjaExhdGVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IFN3aXRjaE9ic2VydmFibGUodGhpcyk7XG4gIH07XG5cbiAgdmFyIFRha2VVbnRpbE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGFrZVVudGlsT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIFRha2VVbnRpbE9ic2VydmFibGUoc291cmNlLCBvdGhlcikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLm90aGVyID0gaXNQcm9taXNlKG90aGVyKSA/IG9ic2VydmFibGVGcm9tUHJvbWlzZShvdGhlcikgOiBvdGhlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRha2VVbnRpbE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG4gICAgICAgIHRoaXMuc291cmNlLnN1YnNjcmliZShvKSxcbiAgICAgICAgdGhpcy5vdGhlci5zdWJzY3JpYmUobmV3IFRha2VVbnRpbE9ic2VydmVyKG8pKVxuICAgICAgKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRha2VVbnRpbE9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgVGFrZVVudGlsT2JzZXJ2ZXIgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGFrZVVudGlsT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGFrZVVudGlsT2JzZXJ2ZXIobykge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUYWtlVW50aWxPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgVGFrZVVudGlsT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGVycik7XG4gICAgfTtcblxuICAgIFRha2VVbnRpbE9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IG5vb3A7XG5cbiAgICByZXR1cm4gVGFrZVVudGlsT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSB2YWx1ZXMgZnJvbSB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdW50aWwgdGhlIG90aGVyIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjZXMgYSB2YWx1ZS5cbiAgICogQHBhcmFtIHtPYnNlcnZhYmxlIHwgUHJvbWlzZX0gb3RoZXIgT2JzZXJ2YWJsZSBzZXF1ZW5jZSBvciBQcm9taXNlIHRoYXQgdGVybWluYXRlcyBwcm9wYWdhdGlvbiBvZiBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgc291cmNlIHNlcXVlbmNlIHVwIHRvIHRoZSBwb2ludCB0aGUgb3RoZXIgc2VxdWVuY2UgaW50ZXJydXB0ZWQgZnVydGhlciBwcm9wYWdhdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50YWtlVW50aWwgPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICByZXR1cm4gbmV3IFRha2VVbnRpbE9ic2VydmFibGUodGhpcywgb3RoZXIpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIGZhbHNlRmFjdG9yeSgpIHsgcmV0dXJuIGZhbHNlOyB9XG4gIGZ1bmN0aW9uIGFyZ3VtZW50c1RvQXJyYXkoKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIHJldHVybiBhcmdzO1xuICB9XG5cbiAgdmFyIFdpdGhMYXRlc3RGcm9tT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlKHNvdXJjZSwgc291cmNlcywgcmVzdWx0U2VsZWN0b3IpIHtcbiAgICAgIHRoaXMuX3MgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9zcyA9IHNvdXJjZXM7XG4gICAgICB0aGlzLl9jYiA9IHJlc3VsdFNlbGVjdG9yO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBsZW4gPSB0aGlzLl9zcy5sZW5ndGg7XG4gICAgICB2YXIgc3RhdGUgPSB7XG4gICAgICAgIGhhc1ZhbHVlOiBhcnJheUluaXRpYWxpemUobGVuLCBmYWxzZUZhY3RvcnkpLFxuICAgICAgICBoYXNWYWx1ZUFsbDogZmFsc2UsXG4gICAgICAgIHZhbHVlczogbmV3IEFycmF5KGxlbilcbiAgICAgIH07XG5cbiAgICAgIHZhciBuID0gdGhpcy5fc3MubGVuZ3RoLCBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KG4gKyAxKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIHZhciBvdGhlciA9IHRoaXMuX3NzW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgaXNQcm9taXNlKG90aGVyKSAmJiAob3RoZXIgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpKTtcbiAgICAgICAgc2FkLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG5ldyBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIobywgaSwgc3RhdGUpKSk7XG4gICAgICAgIHN1YnNjcmlwdGlvbnNbaV0gPSBzYWQ7XG4gICAgICB9XG5cbiAgICAgIHZhciBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHRoaXMuX3Muc3Vic2NyaWJlKG5ldyBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyKG8sIHRoaXMuX2NiLCBzdGF0ZSkpKTtcbiAgICAgIHN1YnNjcmlwdGlvbnNbbl0gPSBzYWQ7XG5cbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG4gICAgfTtcblxuICAgIHJldHVybiBXaXRoTGF0ZXN0RnJvbU9ic2VydmFibGU7XG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICB2YXIgV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyKG8sIGksIHN0YXRlKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX2kgPSBpO1xuICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9zdGF0ZS52YWx1ZXNbdGhpcy5faV0gPSB4O1xuICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVbdGhpcy5faV0gPSB0cnVlO1xuICAgICAgdGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwgPSB0aGlzLl9zdGF0ZS5oYXNWYWx1ZS5ldmVyeShpZGVudGl0eSk7XG4gICAgfTtcblxuICAgIFdpdGhMYXRlc3RGcm9tT3RoZXJPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBXaXRoTGF0ZXN0RnJvbU90aGVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IG5vb3A7XG5cbiAgICByZXR1cm4gV2l0aExhdGVzdEZyb21PdGhlck9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICB2YXIgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyKG8sIGNiLCBzdGF0ZSkge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9jYiA9IGNiO1xuICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFdpdGhMYXRlc3RGcm9tU291cmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdmFyIGFsbFZhbHVlcyA9IFt4XS5jb25jYXQodGhpcy5fc3RhdGUudmFsdWVzKTtcbiAgICAgIGlmICghdGhpcy5fc3RhdGUuaGFzVmFsdWVBbGwpIHsgcmV0dXJuOyB9XG4gICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5fY2IpLmFwcGx5KG51bGwsIGFsbFZhbHVlcyk7XG4gICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgdGhpcy5fby5vbk5leHQocmVzKTtcbiAgICB9O1xuXG4gICAgV2l0aExhdGVzdEZyb21Tb3VyY2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBXaXRoTGF0ZXN0RnJvbVNvdXJjZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gb25seSB3aGVuIHRoZSAoZmlyc3QpIHNvdXJjZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2VzIGFuIGVsZW1lbnQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIHNvdXJjZXMgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ud2l0aExhdGVzdEZyb20gPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFyZ3VtZW50cycpOyB9XG5cbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuICAgIEFycmF5LmlzQXJyYXkoYXJnc1swXSkgJiYgKGFyZ3MgPSBhcmdzWzBdKTtcblxuICAgIHJldHVybiBuZXcgV2l0aExhdGVzdEZyb21PYnNlcnZhYmxlKHRoaXMsIGFyZ3MsIHJlc3VsdFNlbGVjdG9yKTtcbiAgfTtcblxuICBmdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuICBmdW5jdGlvbiBlbXB0eUFycmF5RmFjdG9yeSgpIHsgcmV0dXJuIFtdOyB9XG5cbiAgdmFyIFppcE9ic2VydmFibGUgPSAoZnVuY3Rpb24oX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoWmlwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBaaXBPYnNlcnZhYmxlKHNvdXJjZXMsIHJlc3VsdFNlbGVjdG9yKSB7XG4gICAgICB0aGlzLl9zID0gc291cmNlcztcbiAgICAgIHRoaXMuX2NiID0gcmVzdWx0U2VsZWN0b3I7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBaaXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24ob2JzZXJ2ZXIpIHtcbiAgICAgIHZhciBuID0gdGhpcy5fcy5sZW5ndGgsXG4gICAgICAgICAgc3Vic2NyaXB0aW9ucyA9IG5ldyBBcnJheShuKTtcbiAgICAgICAgICBkb25lID0gYXJyYXlJbml0aWFsaXplKG4sIGZhbHNlRmFjdG9yeSksXG4gICAgICAgICAgcSA9IGFycmF5SW5pdGlhbGl6ZShuLCBlbXB0eUFycmF5RmFjdG9yeSk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLl9zW2ldLCBzYWQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcbiAgICAgICAgaXNQcm9taXNlKHNvdXJjZSkgJiYgKHNvdXJjZSA9IG9ic2VydmFibGVGcm9tUHJvbWlzZShzb3VyY2UpKTtcbiAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShuZXcgWmlwT2JzZXJ2ZXIob2JzZXJ2ZXIsIGksIHRoaXMsIHEsIGRvbmUpKSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgTkFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9ucyk7XG4gICAgfTtcblxuICAgIHJldHVybiBaaXBPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFppcE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhaaXBPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBaaXBPYnNlcnZlcihvLCBpLCBwLCBxLCBkKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX2kgPSBpO1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9xID0gcTtcbiAgICAgIHRoaXMuX2QgPSBkO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbm90RW1wdHkoeCkgeyByZXR1cm4geC5sZW5ndGggPiAwOyB9XG4gICAgZnVuY3Rpb24gc2hpZnRFYWNoKHgpIHsgcmV0dXJuIHguc2hpZnQoKTsgfVxuICAgIGZ1bmN0aW9uIG5vdFRoZVNhbWUoaSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uICh4LCBqKSB7XG4gICAgICAgIHJldHVybiBqICE9PSBpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBaaXBPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9xW3RoaXMuX2ldLnB1c2goeCk7XG4gICAgICBpZiAodGhpcy5fcS5ldmVyeShub3RFbXB0eSkpIHtcbiAgICAgICAgdmFyIHF1ZXVlZFZhbHVlcyA9IHRoaXMuX3EubWFwKHNoaWZ0RWFjaCk7XG4gICAgICAgIHZhciByZXMgPSB0cnlDYXRjaCh0aGlzLl9wLl9jYikuYXBwbHkobnVsbCwgcXVldWVkVmFsdWVzKTtcbiAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcihyZXMuZSk7IH1cbiAgICAgICAgdGhpcy5fby5vbk5leHQocmVzKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5fZC5maWx0ZXIobm90VGhlU2FtZSh0aGlzLl9pKSkuZXZlcnkoaWRlbnRpdHkpKSB7XG4gICAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgWmlwT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgWmlwT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX2RbdGhpcy5faV0gPSB0cnVlO1xuICAgICAgdGhpcy5fZC5ldmVyeShpZGVudGl0eSkgJiYgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gWmlwT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiBNZXJnZXMgdGhlIHNwZWNpZmllZCBvYnNlcnZhYmxlIHNlcXVlbmNlcyBpbnRvIG9uZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IHVzaW5nIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aGVuZXZlciBhbGwgb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2VzIG9yIGFuIGFycmF5IGhhdmUgcHJvZHVjZWQgYW4gZWxlbWVudCBhdCBhIGNvcnJlc3BvbmRpbmcgaW5kZXguXG4gICAqIFRoZSBsYXN0IGVsZW1lbnQgaW4gdGhlIGFyZ3VtZW50cyBtdXN0IGJlIGEgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBlYWNoIHNlcmllcyBvZiBlbGVtZW50cyBhdCBjb3JyZXNwb25kaW5nIGluZGV4ZXMgaW4gdGhlIGFyZ3MuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIGFyZ3MgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uemlwID0gZnVuY3Rpb24gKCkge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7IHRocm93IG5ldyBFcnJvcignaW52YWxpZCBhcmd1bWVudHMnKTsgfVxuXG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIHZhciByZXN1bHRTZWxlY3RvciA9IGlzRnVuY3Rpb24oYXJnc1tsZW4gLSAxXSkgPyBhcmdzLnBvcCgpIDogYXJndW1lbnRzVG9BcnJheTtcbiAgICBBcnJheS5pc0FycmF5KGFyZ3NbMF0pICYmIChhcmdzID0gYXJnc1swXSk7XG5cbiAgICB2YXIgcGFyZW50ID0gdGhpcztcbiAgICBhcmdzLnVuc2hpZnQocGFyZW50KTtcblxuICAgIHJldHVybiBuZXcgWmlwT2JzZXJ2YWJsZShhcmdzLCByZXN1bHRTZWxlY3Rvcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1lcmdlcyB0aGUgc3BlY2lmaWVkIG9ic2VydmFibGUgc2VxdWVuY2VzIGludG8gb25lIG9ic2VydmFibGUgc2VxdWVuY2UgYnkgdXNpbmcgdGhlIHNlbGVjdG9yIGZ1bmN0aW9uIHdoZW5ldmVyIGFsbCBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaGF2ZSBwcm9kdWNlZCBhbiBlbGVtZW50IGF0IGEgY29ycmVzcG9uZGluZyBpbmRleC5cbiAgICogQHBhcmFtIGFyZ3VtZW50cyBPYnNlcnZhYmxlIHNvdXJjZXMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IHJlc3VsdFNlbGVjdG9yIEZ1bmN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBzZXJpZXMgb2YgZWxlbWVudHMgYXQgY29ycmVzcG9uZGluZyBpbmRleGVzIGluIHRoZSBzb3VyY2VzLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHQgb2YgY29tYmluaW5nIGVsZW1lbnRzIG9mIHRoZSBzb3VyY2VzIHVzaW5nIHRoZSBzcGVjaWZpZWQgcmVzdWx0IHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgT2JzZXJ2YWJsZS56aXAgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTsgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KGFyZ3NbMF0pKSB7XG4gICAgICBhcmdzID0gaXNGdW5jdGlvbihhcmdzWzFdKSA/IGFyZ3NbMF0uY29uY2F0KGFyZ3NbMV0pIDogYXJnc1swXTtcbiAgICB9XG4gICAgdmFyIGZpcnN0ID0gYXJncy5zaGlmdCgpO1xuICAgIHJldHVybiBmaXJzdC56aXAuYXBwbHkoZmlyc3QsIGFyZ3MpO1xuICB9O1xuXG5mdW5jdGlvbiBmYWxzZUZhY3RvcnkoKSB7IHJldHVybiBmYWxzZTsgfVxuZnVuY3Rpb24gZW1wdHlBcnJheUZhY3RvcnkoKSB7IHJldHVybiBbXTsgfVxuZnVuY3Rpb24gYXJndW1lbnRzVG9BcnJheSgpIHtcbiAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgcmV0dXJuIGFyZ3M7XG59XG5cbi8qKlxuICogTWVyZ2VzIHRoZSBzcGVjaWZpZWQgb2JzZXJ2YWJsZSBzZXF1ZW5jZXMgaW50byBvbmUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSB1c2luZyB0aGUgc2VsZWN0b3IgZnVuY3Rpb24gd2hlbmV2ZXIgYWxsIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlcyBvciBhbiBhcnJheSBoYXZlIHByb2R1Y2VkIGFuIGVsZW1lbnQgYXQgYSBjb3JyZXNwb25kaW5nIGluZGV4LlxuICogVGhlIGxhc3QgZWxlbWVudCBpbiB0aGUgYXJndW1lbnRzIG11c3QgYmUgYSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGVhY2ggc2VyaWVzIG9mIGVsZW1lbnRzIGF0IGNvcnJlc3BvbmRpbmcgaW5kZXhlcyBpbiB0aGUgYXJncy5cbiAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHJlc3VsdCBvZiBjb21iaW5pbmcgZWxlbWVudHMgb2YgdGhlIGFyZ3MgdXNpbmcgdGhlIHNwZWNpZmllZCByZXN1bHQgc2VsZWN0b3IgZnVuY3Rpb24uXG4gKi9cbm9ic2VydmFibGVQcm90by56aXBJdGVyYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIGFyZ3VtZW50cycpOyB9XG5cbiAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKTtcbiAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgdmFyIHJlc3VsdFNlbGVjdG9yID0gaXNGdW5jdGlvbihhcmdzW2xlbiAtIDFdKSA/IGFyZ3MucG9wKCkgOiBhcmd1bWVudHNUb0FycmF5O1xuXG4gIHZhciBwYXJlbnQgPSB0aGlzO1xuICBhcmdzLnVuc2hpZnQocGFyZW50KTtcbiAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgdmFyIG4gPSBhcmdzLmxlbmd0aCxcbiAgICAgIHF1ZXVlcyA9IGFycmF5SW5pdGlhbGl6ZShuLCBlbXB0eUFycmF5RmFjdG9yeSksXG4gICAgICBpc0RvbmUgPSBhcnJheUluaXRpYWxpemUobiwgZmFsc2VGYWN0b3J5KTtcblxuICAgIHZhciBzdWJzY3JpcHRpb25zID0gbmV3IEFycmF5KG4pO1xuICAgIGZvciAodmFyIGlkeCA9IDA7IGlkeCA8IG47IGlkeCsrKSB7XG4gICAgICAoZnVuY3Rpb24gKGkpIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3NbaV0sIHNhZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuXG4gICAgICAgIChpc0FycmF5TGlrZShzb3VyY2UpIHx8IGlzSXRlcmFibGUoc291cmNlKSkgJiYgKHNvdXJjZSA9IG9ic2VydmFibGVGcm9tKHNvdXJjZSkpO1xuXG4gICAgICAgIHNhZC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICBxdWV1ZXNbaV0ucHVzaCh4KTtcbiAgICAgICAgICBpZiAocXVldWVzLmV2ZXJ5KGZ1bmN0aW9uICh4KSB7IHJldHVybiB4Lmxlbmd0aCA+IDA7IH0pKSB7XG4gICAgICAgICAgICB2YXIgcXVldWVkVmFsdWVzID0gcXVldWVzLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5zaGlmdCgpOyB9KSxcbiAgICAgICAgICAgICAgICByZXMgPSB0cnlDYXRjaChyZXN1bHRTZWxlY3RvcikuYXBwbHkocGFyZW50LCBxdWV1ZWRWYWx1ZXMpO1xuICAgICAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXMuZSk7IH1cbiAgICAgICAgICAgIG8ub25OZXh0KHJlcyk7XG4gICAgICAgICAgfSBlbHNlIGlmIChpc0RvbmUuZmlsdGVyKGZ1bmN0aW9uICh4LCBqKSB7IHJldHVybiBqICE9PSBpOyB9KS5ldmVyeShpZGVudGl0eSkpIHtcbiAgICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlzRG9uZVtpXSA9IHRydWU7XG4gICAgICAgICAgaXNEb25lLmV2ZXJ5KGlkZW50aXR5KSAmJiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgc3Vic2NyaXB0aW9uc1tpXSA9IHNhZDtcbiAgICAgIH0pKGlkeCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbnMpO1xuICB9LCBwYXJlbnQpO1xufTtcblxuICBmdW5jdGlvbiBhc09ic2VydmFibGUoc291cmNlKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIHN1YnNjcmliZShvKSB7IHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG8pOyB9O1xuICB9XG5cbiAgLyoqXG4gICAqICBIaWRlcyB0aGUgaWRlbnRpdHkgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBoaWRlcyB0aGUgaWRlbnRpdHkgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5hc09ic2VydmFibGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGFzT2JzZXJ2YWJsZSh0aGlzKSwgdGhpcyk7XG4gIH07XG5cbiAgdmFyIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBEZW1hdGVyaWFsaXplT2JzZXJ2YWJsZShzb3VyY2UpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgRGVtYXRlcmlhbGl6ZU9ic2VydmVyKG8pKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERlbWF0ZXJpYWxpemVPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIERlbWF0ZXJpYWxpemVPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRGVtYXRlcmlhbGl6ZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gRGVtYXRlcmlhbGl6ZU9ic2VydmVyKG8pIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVtYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHsgeC5hY2NlcHQodGhpcy5fbyk7IH07XG4gICAgRGVtYXRlcmlhbGl6ZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcbiAgICBEZW1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXG4gICAgcmV0dXJuIERlbWF0ZXJpYWxpemVPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgLyoqXG4gICAqIERlbWF0ZXJpYWxpemVzIHRoZSBleHBsaWNpdCBub3RpZmljYXRpb24gdmFsdWVzIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgaW1wbGljaXQgbm90aWZpY2F0aW9ucy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgZXhoaWJpdGluZyB0aGUgYmVoYXZpb3IgY29ycmVzcG9uZGluZyB0byB0aGUgc291cmNlIHNlcXVlbmNlJ3Mgbm90aWZpY2F0aW9uIHZhbHVlcy5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5kZW1hdGVyaWFsaXplID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgRGVtYXRlcmlhbGl6ZU9ic2VydmFibGUodGhpcyk7XG4gIH07XG5cbiAgdmFyIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZhYmxlKHNvdXJjZSwga2V5Rm4sIGNvbXBhcmVyKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMua2V5Rm4gPSBrZXlGbjtcbiAgICAgIHRoaXMuY29tcGFyZXIgPSBjb21wYXJlcjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyKG8sIHRoaXMua2V5Rm4sIHRoaXMuY29tcGFyZXIpKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gRGlzdGluY3RVbnRpbENoYW5nZWRPYnNlcnZlcihvLCBrZXlGbiwgY29tcGFyZXIpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmtleUZuID0ga2V5Rm47XG4gICAgICB0aGlzLmNvbXBhcmVyID0gY29tcGFyZXI7XG4gICAgICB0aGlzLmhhc0N1cnJlbnRLZXkgPSBmYWxzZTtcbiAgICAgIHRoaXMuY3VycmVudEtleSA9IG51bGw7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHZhciBrZXkgPSB4LCBjb21wYXJlckVxdWFscztcbiAgICAgIGlmIChpc0Z1bmN0aW9uKHRoaXMua2V5Rm4pKSB7XG4gICAgICAgIGtleSA9IHRyeUNhdGNoKHRoaXMua2V5Rm4pKHgpO1xuICAgICAgICBpZiAoa2V5ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3Ioa2V5LmUpOyB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5oYXNDdXJyZW50S2V5KSB7XG4gICAgICAgIGNvbXBhcmVyRXF1YWxzID0gdHJ5Q2F0Y2godGhpcy5jb21wYXJlcikodGhpcy5jdXJyZW50S2V5LCBrZXkpO1xuICAgICAgICBpZiAoY29tcGFyZXJFcXVhbHMgPT09IGVycm9yT2JqKSB7IHJldHVybiB0aGlzLm8ub25FcnJvcihjb21wYXJlckVxdWFscy5lKTsgfVxuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLmhhc0N1cnJlbnRLZXkgfHwgIWNvbXBhcmVyRXF1YWxzKSB7XG4gICAgICAgIHRoaXMuaGFzQ3VycmVudEtleSA9IHRydWU7XG4gICAgICAgIHRoaXMuY3VycmVudEtleSA9IGtleTtcbiAgICAgICAgdGhpcy5vLm9uTmV4dCh4KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24oZSkge1xuICAgICAgdGhpcy5vLm9uRXJyb3IoZSk7XG4gICAgfTtcbiAgICBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERpc3RpbmN0VW50aWxDaGFuZ2VkT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAqICBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyBvbmx5IGRpc3RpbmN0IGNvbnRpZ3VvdXMgZWxlbWVudHMgYWNjb3JkaW5nIHRvIHRoZSBrZXlGbiBhbmQgdGhlIGNvbXBhcmVyLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IFtrZXlGbl0gQSBmdW5jdGlvbiB0byBjb21wdXRlIHRoZSBjb21wYXJpc29uIGtleSBmb3IgZWFjaCBlbGVtZW50LiBJZiBub3QgcHJvdmlkZWQsIGl0IHByb2plY3RzIHRoZSB2YWx1ZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGFyZXJdIEVxdWFsaXR5IGNvbXBhcmVyIGZvciBjb21wdXRlZCBrZXkgdmFsdWVzLiBJZiBub3QgcHJvdmlkZWQsIGRlZmF1bHRzIHRvIGFuIGVxdWFsaXR5IGNvbXBhcmVyIGZ1bmN0aW9uLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIG9ubHkgY29udGFpbmluZyB0aGUgZGlzdGluY3QgY29udGlndW91cyBlbGVtZW50cywgYmFzZWQgb24gYSBjb21wdXRlZCBrZXkgdmFsdWUsIGZyb20gdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLmRpc3RpbmN0VW50aWxDaGFuZ2VkID0gZnVuY3Rpb24gKGtleUZuLCBjb21wYXJlcikge1xuICAgIGNvbXBhcmVyIHx8IChjb21wYXJlciA9IGRlZmF1bHRDb21wYXJlcik7XG4gICAgcmV0dXJuIG5ldyBEaXN0aW5jdFVudGlsQ2hhbmdlZE9ic2VydmFibGUodGhpcywga2V5Rm4sIGNvbXBhcmVyKTtcbiAgfTtcblxuICB2YXIgVGFwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYXBPYnNlcnZhYmxlLF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGFwT2JzZXJ2YWJsZShzb3VyY2UsIG9ic2VydmVyT3JPbk5leHQsIG9uRXJyb3IsIG9uQ29tcGxldGVkKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX29OID0gb2JzZXJ2ZXJPck9uTmV4dDtcbiAgICAgIHRoaXMuX29FID0gb25FcnJvcjtcbiAgICAgIHRoaXMuX29DID0gb25Db21wbGV0ZWQ7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUYXBPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24obykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgcCkge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMudCA9ICFwLl9vTiB8fCBpc0Z1bmN0aW9uKHAuX29OKSA/XG4gICAgICAgIG9ic2VydmVyQ3JlYXRlKHAuX29OIHx8IG5vb3AsIHAuX29FIHx8IG5vb3AsIHAuX29DIHx8IG5vb3ApIDpcbiAgICAgICAgcC5fb047XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgQWJzdHJhY3RPYnNlcnZlci5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMudC5vbk5leHQpLmNhbGwodGhpcy50LCB4KTtcbiAgICAgIGlmIChyZXMgPT09IGVycm9yT2JqKSB7IHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgdGhpcy5vLm9uTmV4dCh4KTtcbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24oZXJyKSB7XG4gICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy50Lm9uRXJyb3IpLmNhbGwodGhpcy50LCBlcnIpO1xuICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgdGhpcy5vLm9uRXJyb3IoZXJyKTtcbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMudC5vbkNvbXBsZXRlZCkuY2FsbCh0aGlzLnQpO1xuICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBUYXBPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICogIEludm9rZXMgYW4gYWN0aW9uIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIGludm9rZXMgYW4gYWN0aW9uIHVwb24gZ3JhY2VmdWwgb3IgZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9uIHwgT2JzZXJ2ZXJ9IG9ic2VydmVyT3JPbk5leHQgQWN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIG9yIGFuIG8uXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gW29uRXJyb3JdICBBY3Rpb24gdG8gaW52b2tlIHVwb24gZXhjZXB0aW9uYWwgdGVybWluYXRpb24gb2YgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuIFVzZWQgaWYgb25seSB0aGUgb2JzZXJ2ZXJPck9uTmV4dCBwYXJhbWV0ZXIgaXMgYWxzbyBhIGZ1bmN0aW9uLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IFtvbkNvbXBsZXRlZF0gIEFjdGlvbiB0byBpbnZva2UgdXBvbiBncmFjZWZ1bCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS4gVXNlZCBpZiBvbmx5IHRoZSBvYnNlcnZlck9yT25OZXh0IHBhcmFtZXRlciBpcyBhbHNvIGEgZnVuY3Rpb24uXG4gICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aCB0aGUgc2lkZS1lZmZlY3RpbmcgYmVoYXZpb3IgYXBwbGllZC5cbiAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvWydkbyddID0gb2JzZXJ2YWJsZVByb3RvLnRhcCA9IG9ic2VydmFibGVQcm90by5kb0FjdGlvbiA9IGZ1bmN0aW9uIChvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCkge1xuICAgIHJldHVybiBuZXcgVGFwT2JzZXJ2YWJsZSh0aGlzLCBvYnNlcnZlck9yT25OZXh0LCBvbkVycm9yLCBvbkNvbXBsZXRlZCk7XG4gIH07XG5cbiAgLyoqXG4gICogIEludm9rZXMgYW4gYWN0aW9uIGZvciBlYWNoIGVsZW1lbnQgaW4gdGhlIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICogIFRoaXMgbWV0aG9kIGNhbiBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcsIGxvZ2dpbmcsIGV0Yy4gb2YgcXVlcnkgYmVoYXZpb3IgYnkgaW50ZXJjZXB0aW5nIHRoZSBtZXNzYWdlIHN0cmVhbSB0byBydW4gYXJiaXRyYXJ5IGFjdGlvbnMgZm9yIG1lc3NhZ2VzIG9uIHRoZSBwaXBlbGluZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvbk5leHQgQWN0aW9uIHRvIGludm9rZSBmb3IgZWFjaCBlbGVtZW50IGluIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5kb09uTmV4dCA9IG9ic2VydmFibGVQcm90by50YXBPbk5leHQgPSBmdW5jdGlvbiAob25OZXh0LCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIHRoaXMudGFwKHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uICh4KSB7IG9uTmV4dC5jYWxsKHRoaXNBcmcsIHgpOyB9IDogb25OZXh0KTtcbiAgfTtcblxuICAvKipcbiAgKiAgSW52b2tlcyBhbiBhY3Rpb24gdXBvbiBleGNlcHRpb25hbCB0ZXJtaW5hdGlvbiBvZiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgKiAgVGhpcyBtZXRob2QgY2FuIGJlIHVzZWQgZm9yIGRlYnVnZ2luZywgbG9nZ2luZywgZXRjLiBvZiBxdWVyeSBiZWhhdmlvciBieSBpbnRlcmNlcHRpbmcgdGhlIG1lc3NhZ2Ugc3RyZWFtIHRvIHJ1biBhcmJpdHJhcnkgYWN0aW9ucyBmb3IgbWVzc2FnZXMgb24gdGhlIHBpcGVsaW5lLlxuICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uRXJyb3IgQWN0aW9uIHRvIGludm9rZSB1cG9uIGV4Y2VwdGlvbmFsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5kb09uRXJyb3IgPSBvYnNlcnZhYmxlUHJvdG8udGFwT25FcnJvciA9IGZ1bmN0aW9uIChvbkVycm9yLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIHRoaXMudGFwKG5vb3AsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uIChlKSB7IG9uRXJyb3IuY2FsbCh0aGlzQXJnLCBlKTsgfSA6IG9uRXJyb3IpO1xuICB9O1xuXG4gIC8qKlxuICAqICBJbnZva2VzIGFuIGFjdGlvbiB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqICBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBmb3IgZGVidWdnaW5nLCBsb2dnaW5nLCBldGMuIG9mIHF1ZXJ5IGJlaGF2aW9yIGJ5IGludGVyY2VwdGluZyB0aGUgbWVzc2FnZSBzdHJlYW0gdG8gcnVuIGFyYml0cmFyeSBhY3Rpb25zIGZvciBtZXNzYWdlcyBvbiB0aGUgcGlwZWxpbmUuXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gb25Db21wbGV0ZWQgQWN0aW9uIHRvIGludm9rZSB1cG9uIGdyYWNlZnVsIHRlcm1pbmF0aW9uIG9mIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAqIEBwYXJhbSB7QW55fSBbdGhpc0FyZ10gT2JqZWN0IHRvIHVzZSBhcyB0aGlzIHdoZW4gZXhlY3V0aW5nIGNhbGxiYWNrLlxuICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHdpdGggdGhlIHNpZGUtZWZmZWN0aW5nIGJlaGF2aW9yIGFwcGxpZWQuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5kb09uQ29tcGxldGVkID0gb2JzZXJ2YWJsZVByb3RvLnRhcE9uQ29tcGxldGVkID0gZnVuY3Rpb24gKG9uQ29tcGxldGVkLCB0aGlzQXJnKSB7XG4gICAgcmV0dXJuIHRoaXMudGFwKG5vb3AsIG51bGwsIHR5cGVvZiB0aGlzQXJnICE9PSAndW5kZWZpbmVkJyA/IGZ1bmN0aW9uICgpIHsgb25Db21wbGV0ZWQuY2FsbCh0aGlzQXJnKTsgfSA6IG9uQ29tcGxldGVkKTtcbiAgfTtcblxuICAvKipcbiAgICogIEludm9rZXMgYSBzcGVjaWZpZWQgYWN0aW9uIGFmdGVyIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0ZXJtaW5hdGVzIGdyYWNlZnVsbHkgb3IgZXhjZXB0aW9uYWxseS5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZmluYWxseUFjdGlvbiBBY3Rpb24gdG8gaW52b2tlIGFmdGVyIHRoZSBzb3VyY2Ugb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0ZXJtaW5hdGVzLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gU291cmNlIHNlcXVlbmNlIHdpdGggdGhlIGFjdGlvbi1pbnZva2luZyB0ZXJtaW5hdGlvbiBiZWhhdmlvciBhcHBsaWVkLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvWydmaW5hbGx5J10gPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgdmFyIHNvdXJjZSA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvYnNlcnZlcikge1xuICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IHRyeUNhdGNoKHNvdXJjZS5zdWJzY3JpYmUpLmNhbGwoc291cmNlLCBvYnNlcnZlcik7XG4gICAgICBpZiAoc3Vic2NyaXB0aW9uID09PSBlcnJvck9iaikge1xuICAgICAgICBhY3Rpb24oKTtcbiAgICAgICAgcmV0dXJuIHRocm93ZXIoc3Vic2NyaXB0aW9uLmUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRpc3Bvc2FibGVDcmVhdGUoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgciA9IHRyeUNhdGNoKHN1YnNjcmlwdGlvbi5kaXNwb3NlKS5jYWxsKHN1YnNjcmlwdGlvbik7XG4gICAgICAgIGFjdGlvbigpO1xuICAgICAgICByID09PSBlcnJvck9iaiAmJiB0aHJvd2VyKHIuZSk7XG4gICAgICB9KTtcbiAgICB9LCB0aGlzKTtcbiAgfTtcblxuICB2YXIgSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZShzb3VyY2UpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSWdub3JlRWxlbWVudHNPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IElubmVyT2JzZXJ2ZXIobykpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8pIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBub29wO1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLm9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm8ub25FcnJvcihlcnIpO1xuICAgICAgfVxuICAgIH07XG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUub25Db21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZighdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbigpIHsgdGhpcy5pc1N0b3BwZWQgPSB0cnVlOyB9O1xuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmZhaWwgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIub25FcnJvcihlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIElnbm9yZUVsZW1lbnRzT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAgKiAgSWdub3JlcyBhbGwgZWxlbWVudHMgaW4gYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBsZWF2aW5nIG9ubHkgdGhlIHRlcm1pbmF0aW9uIG1lc3NhZ2VzLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gZW1wdHkgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNpZ25hbHMgdGVybWluYXRpb24sIHN1Y2Nlc3NmdWwgb3IgZXhjZXB0aW9uYWwsIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uaWdub3JlRWxlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyBJZ25vcmVFbGVtZW50c09ic2VydmFibGUodGhpcyk7XG4gIH07XG5cbiAgdmFyIE1hdGVyaWFsaXplT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTWF0ZXJpYWxpemVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIE1hdGVyaWFsaXplT2JzZXJ2YWJsZShzb3VyY2UsIGZuKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE1hdGVyaWFsaXplT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBNYXRlcmlhbGl6ZU9ic2VydmVyKG8pKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE1hdGVyaWFsaXplT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBNYXRlcmlhbGl6ZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhNYXRlcmlhbGl6ZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gTWF0ZXJpYWxpemVPYnNlcnZlcihvKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIE1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkgeyB0aGlzLl9vLm9uTmV4dChub3RpZmljYXRpb25DcmVhdGVPbk5leHQoeCkpIH07XG4gICAgTWF0ZXJpYWxpemVPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uTmV4dChub3RpZmljYXRpb25DcmVhdGVPbkVycm9yKGUpKTsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuICAgIE1hdGVyaWFsaXplT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbk5leHQobm90aWZpY2F0aW9uQ3JlYXRlT25Db21wbGV0ZWQoKSk7IHRoaXMuX28ub25Db21wbGV0ZWQoKTsgfTtcblxuICAgIHJldHVybiBNYXRlcmlhbGl6ZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIE1hdGVyaWFsaXplcyB0aGUgaW1wbGljaXQgbm90aWZpY2F0aW9ucyBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGFzIGV4cGxpY2l0IG5vdGlmaWNhdGlvbiB2YWx1ZXMuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIG1hdGVyaWFsaXplZCBub3RpZmljYXRpb24gdmFsdWVzIGZyb20gdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5tYXRlcmlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IE1hdGVyaWFsaXplT2JzZXJ2YWJsZSh0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogIFJlcGVhdHMgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIHRpbWVzLiBJZiB0aGUgcmVwZWF0IGNvdW50IGlzIG5vdCBzcGVjaWZpZWQsIHRoZSBzZXF1ZW5jZSByZXBlYXRzIGluZGVmaW5pdGVseS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtyZXBlYXRDb3VudF0gIE51bWJlciBvZiB0aW1lcyB0byByZXBlYXQgdGhlIHNlcXVlbmNlLiBJZiBub3QgcHJvdmlkZWQsIHJlcGVhdHMgdGhlIHNlcXVlbmNlIGluZGVmaW5pdGVseS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHByb2R1Y2luZyB0aGUgZWxlbWVudHMgb2YgdGhlIGdpdmVuIHNlcXVlbmNlIHJlcGVhdGVkbHkuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucmVwZWF0ID0gZnVuY3Rpb24gKHJlcGVhdENvdW50KSB7XG4gICAgcmV0dXJuIGVudW1lcmFibGVSZXBlYXQodGhpcywgcmVwZWF0Q291bnQpLmNvbmNhdCgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiAgUmVwZWF0cyB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgdGltZXMgb3IgdW50aWwgaXQgc3VjY2Vzc2Z1bGx5IHRlcm1pbmF0ZXMuIElmIHRoZSByZXRyeSBjb3VudCBpcyBub3Qgc3BlY2lmaWVkLCBpdCByZXRyaWVzIGluZGVmaW5pdGVseS5cbiAgICogIE5vdGUgaWYgeW91IGVuY291bnRlciBhbiBlcnJvciBhbmQgd2FudCBpdCB0byByZXRyeSBvbmNlLCB0aGVuIHlvdSBtdXN0IHVzZSAucmV0cnkoMik7XG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICB2YXIgcmVzID0gcmV0cmllZCA9IHJldHJ5LnJlcGVhdCgpO1xuICAgKiAgdmFyIHJlcyA9IHJldHJpZWQgPSByZXRyeS5yZXBlYXQoMik7XG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbcmV0cnlDb3VudF0gIE51bWJlciBvZiB0aW1lcyB0byByZXRyeSB0aGUgc2VxdWVuY2UuIElmIG5vdCBwcm92aWRlZCwgcmV0cnkgdGhlIHNlcXVlbmNlIGluZGVmaW5pdGVseS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2VxdWVuY2UgcmVwZWF0ZWRseSB1bnRpbCBpdCB0ZXJtaW5hdGVzIHN1Y2Nlc3NmdWxseS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5yZXRyeSA9IGZ1bmN0aW9uIChyZXRyeUNvdW50KSB7XG4gICAgcmV0dXJuIGVudW1lcmFibGVSZXBlYXQodGhpcywgcmV0cnlDb3VudCkuY2F0Y2hFcnJvcigpO1xuICB9O1xuXG4gIC8qKlxuICAgKiAgUmVwZWF0cyB0aGUgc291cmNlIG9ic2VydmFibGUgc2VxdWVuY2UgdXBvbiBlcnJvciBlYWNoIHRpbWUgdGhlIG5vdGlmaWVyIGVtaXRzIG9yIHVudGlsIGl0IHN1Y2Nlc3NmdWxseSB0ZXJtaW5hdGVzLiBcbiAgICogIGlmIHRoZSBub3RpZmllciBjb21wbGV0ZXMsIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbXBsZXRlcy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogIHZhciB0aW1lciA9IE9ic2VydmFibGUudGltZXIoNTAwKTtcbiAgICogIHZhciBzb3VyY2UgPSBvYnNlcnZhYmxlLnJldHJ5V2hlbih0aW1lcik7XG4gICAqIEBwYXJhbSB7T2JzZXJ2YWJsZX0gW25vdGlmaWVyXSBBbiBvYnNlcnZhYmxlIHRoYXQgdHJpZ2dlcnMgdGhlIHJldHJpZXMgb3IgY29tcGxldGVzIHRoZSBvYnNlcnZhYmxlIHdpdGggb25OZXh0IG9yIG9uQ29tcGxldGVkIHJlc3BlY3RpdmVseS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgcHJvZHVjaW5nIHRoZSBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gc2VxdWVuY2UgcmVwZWF0ZWRseSB1bnRpbCBpdCB0ZXJtaW5hdGVzIHN1Y2Nlc3NmdWxseS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5yZXRyeVdoZW4gPSBmdW5jdGlvbiAobm90aWZpZXIpIHtcbiAgICByZXR1cm4gZW51bWVyYWJsZVJlcGVhdCh0aGlzKS5jYXRjaEVycm9yV2hlbihub3RpZmllcik7XG4gIH07XG4gIHZhciBTY2FuT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTY2FuT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTY2FuT2JzZXJ2YWJsZShzb3VyY2UsIGFjY3VtdWxhdG9yLCBoYXNTZWVkLCBzZWVkKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuYWNjdW11bGF0b3IgPSBhY2N1bXVsYXRvcjtcbiAgICAgIHRoaXMuaGFzU2VlZCA9IGhhc1NlZWQ7XG4gICAgICB0aGlzLnNlZWQgPSBzZWVkO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2Nhbk9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBTY2FuT2JzZXJ2ZXIobyx0aGlzKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBTY2FuT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBTY2FuT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNjYW5PYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTY2FuT2JzZXJ2ZXIobywgcGFyZW50KSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3AgPSBwYXJlbnQ7XG4gICAgICB0aGlzLl9mbiA9IHBhcmVudC5hY2N1bXVsYXRvcjtcbiAgICAgIHRoaXMuX2hzID0gcGFyZW50Lmhhc1NlZWQ7XG4gICAgICB0aGlzLl9zID0gcGFyZW50LnNlZWQ7XG4gICAgICB0aGlzLl9oYSA9IGZhbHNlO1xuICAgICAgdGhpcy5fYSA9IG51bGw7XG4gICAgICB0aGlzLl9odiA9IGZhbHNlO1xuICAgICAgdGhpcy5faSA9IDA7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTY2FuT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgIXRoaXMuX2h2ICYmICh0aGlzLl9odiA9IHRydWUpO1xuICAgICAgaWYgKHRoaXMuX2hhKSB7XG4gICAgICAgIHRoaXMuX2EgPSB0cnlDYXRjaCh0aGlzLl9mbikodGhpcy5fYSwgeCwgdGhpcy5faSwgdGhpcy5fcCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9hID0gdGhpcy5faHMgPyB0cnlDYXRjaCh0aGlzLl9mbikodGhpcy5fcywgeCwgdGhpcy5faSwgdGhpcy5fcCkgOiB4O1xuICAgICAgICB0aGlzLl9oYSA9IHRydWU7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fYSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcih0aGlzLl9hLmUpOyB9XG4gICAgICB0aGlzLl9vLm9uTmV4dCh0aGlzLl9hKTtcbiAgICAgIHRoaXMuX2krKztcbiAgICB9O1xuXG4gICAgU2Nhbk9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9vLm9uRXJyb3IoZSk7XG4gICAgfTtcblxuICAgIFNjYW5PYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgIXRoaXMuX2h2ICYmIHRoaXMuX2hzICYmIHRoaXMuX28ub25OZXh0KHRoaXMuX3MpO1xuICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2Nhbk9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgKiAgQXBwbGllcyBhbiBhY2N1bXVsYXRvciBmdW5jdGlvbiBvdmVyIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIHJldHVybnMgZWFjaCBpbnRlcm1lZGlhdGUgcmVzdWx0LiBUaGUgb3B0aW9uYWwgc2VlZCB2YWx1ZSBpcyB1c2VkIGFzIHRoZSBpbml0aWFsIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAqICBGb3IgYWdncmVnYXRpb24gYmVoYXZpb3Igd2l0aCBubyBpbnRlcm1lZGlhdGUgcmVzdWx0cywgc2VlIE9ic2VydmFibGUuYWdncmVnYXRlLlxuICAqIEBwYXJhbSB7TWl4ZWR9IFtzZWVkXSBUaGUgaW5pdGlhbCBhY2N1bXVsYXRvciB2YWx1ZS5cbiAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhY2N1bXVsYXRvciBBbiBhY2N1bXVsYXRvciBmdW5jdGlvbiB0byBiZSBpbnZva2VkIG9uIGVhY2ggZWxlbWVudC5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSBhY2N1bXVsYXRlZCB2YWx1ZXMuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5zY2FuID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBoYXNTZWVkID0gZmFsc2UsIHNlZWQsIGFjY3VtdWxhdG9yID0gYXJndW1lbnRzWzBdO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBoYXNTZWVkID0gdHJ1ZTtcbiAgICAgIHNlZWQgPSBhcmd1bWVudHNbMV07XG4gICAgfVxuICAgIHJldHVybiBuZXcgU2Nhbk9ic2VydmFibGUodGhpcywgYWNjdW11bGF0b3IsIGhhc1NlZWQsIHNlZWQpO1xuICB9O1xuXG4gIHZhciBTa2lwTGFzdE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBMYXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwTGFzdE9ic2VydmFibGUoc291cmNlLCBjKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX2MgPSBjO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2tpcExhc3RPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobmV3IFNraXBMYXN0T2JzZXJ2ZXIobywgdGhpcy5fYykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcExhc3RPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFNraXBMYXN0T2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFNraXBMYXN0T2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gU2tpcExhc3RPYnNlcnZlcihvLCBjKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX2MgPSBjO1xuICAgICAgdGhpcy5fcSA9IFtdO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgU2tpcExhc3RPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB0aGlzLl9xLnB1c2goeCk7XG4gICAgICB0aGlzLl9xLmxlbmd0aCA+IHRoaXMuX2MgJiYgdGhpcy5fby5vbk5leHQodGhpcy5fcS5zaGlmdCgpKTtcbiAgICB9O1xuXG4gICAgU2tpcExhc3RPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgdGhpcy5fby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBTa2lwTGFzdE9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBTa2lwTGFzdE9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIEJ5cGFzc2VzIGEgc3BlY2lmaWVkIG51bWJlciBvZiBlbGVtZW50cyBhdCB0aGUgZW5kIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiAgVGhpcyBvcGVyYXRvciBhY2N1bXVsYXRlcyBhIHF1ZXVlIHdpdGggYSBsZW5ndGggZW5vdWdoIHRvIHN0b3JlIHRoZSBmaXJzdCBgY291bnRgIGVsZW1lbnRzLiBBcyBtb3JlIGVsZW1lbnRzIGFyZVxuICAgKiAgcmVjZWl2ZWQsIGVsZW1lbnRzIGFyZSB0YWtlbiBmcm9tIHRoZSBmcm9udCBvZiB0aGUgcXVldWUgYW5kIHByb2R1Y2VkIG9uIHRoZSByZXN1bHQgc2VxdWVuY2UuIFRoaXMgY2F1c2VzIGVsZW1lbnRzIHRvIGJlIGRlbGF5ZWQuXG4gICAqIEBwYXJhbSBjb3VudCBOdW1iZXIgb2YgZWxlbWVudHMgdG8gYnlwYXNzIGF0IHRoZSBlbmQgb2YgdGhlIHNvdXJjZSBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgY29udGFpbmluZyB0aGUgc291cmNlIHNlcXVlbmNlIGVsZW1lbnRzIGV4Y2VwdCBmb3IgdGhlIGJ5cGFzc2VkIG9uZXMgYXQgdGhlIGVuZC5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5za2lwTGFzdCA9IGZ1bmN0aW9uIChjb3VudCkge1xuICAgIGlmIChjb3VudCA8IDApIHsgdGhyb3cgbmV3IEFyZ3VtZW50T3V0T2ZSYW5nZUVycm9yKCk7IH1cbiAgICByZXR1cm4gbmV3IFNraXBMYXN0T2JzZXJ2YWJsZSh0aGlzLCBjb3VudCk7XG4gIH07XG5cbiAgLyoqXG4gICAqICBQcmVwZW5kcyBhIHNlcXVlbmNlIG9mIHZhbHVlcyB0byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggYW4gb3B0aW9uYWwgc2NoZWR1bGVyIGFuZCBhbiBhcmd1bWVudCBsaXN0IG9mIHZhbHVlcyB0byBwcmVwZW5kLlxuICAgKiAgQGV4YW1wbGVcbiAgICogIHZhciByZXMgPSBzb3VyY2Uuc3RhcnRXaXRoKDEsIDIsIDMpO1xuICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5zdGFydFdpdGgoUnguU2NoZWR1bGVyLnRpbWVvdXQsIDEsIDIsIDMpO1xuICAgKiBAcGFyYW0ge0FyZ3VtZW50c30gYXJncyBUaGUgc3BlY2lmaWVkIHZhbHVlcyB0byBwcmVwZW5kIHRvIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaGUgc291cmNlIHNlcXVlbmNlIHByZXBlbmRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWVzLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnN0YXJ0V2l0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmFsdWVzLCBzY2hlZHVsZXIsIHN0YXJ0ID0gMDtcbiAgICBpZiAoISFhcmd1bWVudHMubGVuZ3RoICYmIGlzU2NoZWR1bGVyKGFyZ3VtZW50c1swXSkpIHtcbiAgICAgIHNjaGVkdWxlciA9IGFyZ3VtZW50c1swXTtcbiAgICAgIHN0YXJ0ID0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2NoZWR1bGVyID0gaW1tZWRpYXRlU2NoZWR1bGVyO1xuICAgIH1cbiAgICBmb3IodmFyIGFyZ3MgPSBbXSwgaSA9IHN0YXJ0LCBsZW4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7IH1cbiAgICByZXR1cm4gZW51bWVyYWJsZU9mKFtvYnNlcnZhYmxlRnJvbUFycmF5KGFyZ3MsIHNjaGVkdWxlciksIHRoaXNdKS5jb25jYXQoKTtcbiAgfTtcblxuICB2YXIgVGFrZUxhc3RPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGFrZUxhc3RPYnNlcnZlciwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUYWtlTGFzdE9ic2VydmVyKG8sIGMpIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fYyA9IGM7XG4gICAgICB0aGlzLl9xID0gW107XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUYWtlTGFzdE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMuX3EucHVzaCh4KTtcbiAgICAgIHRoaXMuX3EubGVuZ3RoID4gdGhpcy5fYyAmJiB0aGlzLl9xLnNoaWZ0KCk7XG4gICAgfTtcblxuICAgIFRha2VMYXN0T2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgVGFrZUxhc3RPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgd2hpbGUgKHRoaXMuX3EubGVuZ3RoID4gMCkgeyB0aGlzLl9vLm9uTmV4dCh0aGlzLl9xLnNoaWZ0KCkpOyB9XG4gICAgICB0aGlzLl9vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBUYWtlTGFzdE9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIFJldHVybnMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGNvbnRpZ3VvdXMgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiAgVGhpcyBvcGVyYXRvciBhY2N1bXVsYXRlcyBhIGJ1ZmZlciB3aXRoIGEgbGVuZ3RoIGVub3VnaCB0byBzdG9yZSBlbGVtZW50cyBjb3VudCBlbGVtZW50cy4gVXBvbiBjb21wbGV0aW9uIG9mXG4gICAqICB0aGUgc291cmNlIHNlcXVlbmNlLCB0aGlzIGJ1ZmZlciBpcyBkcmFpbmVkIG9uIHRoZSByZXN1bHQgc2VxdWVuY2UuIFRoaXMgY2F1c2VzIHRoZSBlbGVtZW50cyB0byBiZSBkZWxheWVkLlxuICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgTnVtYmVyIG9mIGVsZW1lbnRzIHRvIHRha2UgZnJvbSB0aGUgZW5kIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGNvbnRhaW5pbmcgdGhlIHNwZWNpZmllZCBudW1iZXIgb2YgZWxlbWVudHMgZnJvbSB0aGUgZW5kIG9mIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8udGFrZUxhc3QgPSBmdW5jdGlvbiAoY291bnQpIHtcbiAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG4gICAgdmFyIHNvdXJjZSA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gc291cmNlLnN1YnNjcmliZShuZXcgVGFrZUxhc3RPYnNlcnZlcihvLCBjb3VudCkpO1xuICAgIH0sIHNvdXJjZSk7XG4gIH07XG5cbm9ic2VydmFibGVQcm90by5mbGF0TWFwQ29uY2F0ID0gb2JzZXJ2YWJsZVByb3RvLmNvbmNhdE1hcCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5tZXJnZSgxKTtcbn07XG4gIHZhciBNYXBPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhNYXBPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgZnVuY3Rpb24gTWFwT2JzZXJ2YWJsZShzb3VyY2UsIHNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuc2VsZWN0b3IgPSBiaW5kQ2FsbGJhY2soc2VsZWN0b3IsIHRoaXNBcmcsIDMpO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5uZXJNYXAoc2VsZWN0b3IsIHNlbGYpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoeCwgaSwgbykgeyByZXR1cm4gc2VsZWN0b3IuY2FsbCh0aGlzLCBzZWxmLnNlbGVjdG9yKHgsIGksIG8pLCBpLCBvKTsgfVxuICAgIH1cblxuICAgIE1hcE9ic2VydmFibGUucHJvdG90eXBlLmludGVybmFsTWFwID0gZnVuY3Rpb24gKHNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgICByZXR1cm4gbmV3IE1hcE9ic2VydmFibGUodGhpcy5zb3VyY2UsIGlubmVyTWFwKHNlbGVjdG9yLCB0aGlzKSwgdGhpc0FyZyk7XG4gICAgfTtcblxuICAgIE1hcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnNlbGVjdG9yLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIGluaGVyaXRzKElubmVyT2JzZXJ2ZXIsIEFic3RyYWN0T2JzZXJ2ZXIpO1xuICAgIGZ1bmN0aW9uIElubmVyT2JzZXJ2ZXIobywgc2VsZWN0b3IsIHNvdXJjZSkge1xuICAgICAgdGhpcy5vID0gbztcbiAgICAgIHRoaXMuc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5pID0gMDtcbiAgICAgIEFic3RyYWN0T2JzZXJ2ZXIuY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oeCkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMuc2VsZWN0b3IpKHgsIHRoaXMuaSsrLCB0aGlzLnNvdXJjZSk7XG4gICAgICBpZiAocmVzdWx0ID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5vLm9uRXJyb3IocmVzdWx0LmUpOyB9XG4gICAgICB0aGlzLm8ub25OZXh0KHJlc3VsdCk7XG4gICAgfTtcblxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLm8ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIE1hcE9ic2VydmFibGU7XG5cbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqIFByb2plY3RzIGVhY2ggZWxlbWVudCBvZiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIGludG8gYSBuZXcgZm9ybSBieSBpbmNvcnBvcmF0aW5nIHRoZSBlbGVtZW50J3MgaW5kZXguXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gc2VsZWN0b3IgQSB0cmFuc2Zvcm0gZnVuY3Rpb24gdG8gYXBwbHkgdG8gZWFjaCBzb3VyY2UgZWxlbWVudDsgdGhlIHNlY29uZCBwYXJhbWV0ZXIgb2YgdGhlIGZ1bmN0aW9uIHJlcHJlc2VudHMgdGhlIGluZGV4IG9mIHRoZSBzb3VyY2UgZWxlbWVudC5cbiAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aG9zZSBlbGVtZW50cyBhcmUgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgdHJhbnNmb3JtIGZ1bmN0aW9uIG9uIGVhY2ggZWxlbWVudCBvZiBzb3VyY2UuXG4gICovXG4gIG9ic2VydmFibGVQcm90by5tYXAgPSBvYnNlcnZhYmxlUHJvdG8uc2VsZWN0ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCB0aGlzQXJnKSB7XG4gICAgdmFyIHNlbGVjdG9yRm4gPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICdmdW5jdGlvbicgPyBzZWxlY3RvciA6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNlbGVjdG9yOyB9O1xuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgTWFwT2JzZXJ2YWJsZSA/XG4gICAgICB0aGlzLmludGVybmFsTWFwKHNlbGVjdG9yRm4sIHRoaXNBcmcpIDpcbiAgICAgIG5ldyBNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yRm4sIHRoaXNBcmcpO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsdWNrZXIoYXJncywgbGVuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIG1hcHBlcih4KSB7XG4gICAgICB2YXIgY3VycmVudFByb3AgPSB4O1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB2YXIgcCA9IGN1cnJlbnRQcm9wW2FyZ3NbaV1dO1xuICAgICAgICBpZiAodHlwZW9mIHAgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgY3VycmVudFByb3AgPSBwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBjdXJyZW50UHJvcDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIHRoZSB2YWx1ZSBvZiBhIHNwZWNpZmllZCBuZXN0ZWQgcHJvcGVydHkgZnJvbSBhbGwgZWxlbWVudHMgaW5cbiAgICogdGhlIE9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBwYXJhbSB7QXJndW1lbnRzfSBhcmd1bWVudHMgVGhlIG5lc3RlZCBwcm9wZXJ0aWVzIHRvIHBsdWNrLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gUmV0dXJucyBhIG5ldyBPYnNlcnZhYmxlIHNlcXVlbmNlIG9mIHByb3BlcnR5IHZhbHVlcy5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5wbHVjayA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGlmIChsZW4gPT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdMaXN0IG9mIHByb3BlcnRpZXMgY2Fubm90IGJlIGVtcHR5LicpOyB9XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7IGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07IH1cbiAgICByZXR1cm4gdGhpcy5tYXAocGx1Y2tlcihhcmdzLCBsZW4pKTtcbiAgfTtcblxub2JzZXJ2YWJsZVByb3RvLmZsYXRNYXAgPSBvYnNlcnZhYmxlUHJvdG8uc2VsZWN0TWFueSA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5tZXJnZUFsbCgpO1xufTtcblxuXG4vL1xuLy9SeC5PYnNlcnZhYmxlLnByb3RvdHlwZS5mbGF0TWFwV2l0aE1heENvbmN1cnJlbnQgPSBmdW5jdGlvbihsaW1pdCwgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKSB7XG4vLyAgICByZXR1cm4gbmV3IEZsYXRNYXBPYnNlcnZhYmxlKHRoaXMsIHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykubWVyZ2UobGltaXQpO1xuLy99O1xuLy9cblxuUnguT2JzZXJ2YWJsZS5wcm90b3R5cGUuZmxhdE1hcExhdGVzdCA9IGZ1bmN0aW9uKHNlbGVjdG9yLCByZXN1bHRTZWxlY3RvciwgdGhpc0FyZykge1xuICAgIHJldHVybiBuZXcgRmxhdE1hcE9ic2VydmFibGUodGhpcywgc2VsZWN0b3IsIHJlc3VsdFNlbGVjdG9yLCB0aGlzQXJnKS5zd2l0Y2hMYXRlc3QoKTtcbn07XG4gIHZhciBTa2lwT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhTa2lwT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwT2JzZXJ2YWJsZShzb3VyY2UsIGNvdW50KSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuc2tpcENvdW50ID0gY291bnQ7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG4gICAgXG4gICAgU2tpcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnNraXBDb3VudCkpO1xuICAgIH07XG4gICAgXG4gICAgZnVuY3Rpb24gSW5uZXJPYnNlcnZlcihvLCBjKSB7XG4gICAgICB0aGlzLmMgPSBjO1xuICAgICAgdGhpcy5yID0gYztcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIH1cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbk5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuICAgICAgaWYgKHRoaXMuciA8PSAwKSB7IFxuICAgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yLS07XG4gICAgICB9XG4gICAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkVycm9yID0gZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IHRoaXMuby5vbkVycm9yKGUpOyB9XG4gICAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5vbkNvbXBsZXRlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IHRoaXMuby5vbkNvbXBsZXRlZCgpOyB9XG4gICAgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24oKSB7IHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTsgfTtcbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBTa2lwT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpOyAgXG4gIFxuICAvKipcbiAgICogQnlwYXNzZXMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYW5kIHRoZW4gcmV0dXJucyB0aGUgcmVtYWluaW5nIGVsZW1lbnRzLlxuICAgKiBAcGFyYW0ge051bWJlcn0gY291bnQgVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byBza2lwIGJlZm9yZSByZXR1cm5pbmcgdGhlIHJlbWFpbmluZyBlbGVtZW50cy5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgdGhhdCBvY2N1ciBhZnRlciB0aGUgc3BlY2lmaWVkIGluZGV4IGluIHRoZSBpbnB1dCBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5za2lwID0gZnVuY3Rpb24gKGNvdW50KSB7XG4gICAgaWYgKGNvdW50IDwgMCkgeyB0aHJvdyBuZXcgQXJndW1lbnRPdXRPZlJhbmdlRXJyb3IoKTsgfVxuICAgIHJldHVybiBuZXcgU2tpcE9ic2VydmFibGUodGhpcywgY291bnQpO1xuICB9O1xuICB2YXIgU2tpcFdoaWxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2tpcFdoaWxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTa2lwV2hpbGVPYnNlcnZhYmxlKHNvdXJjZSwgZm4pIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fZm4gPSBmbjtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFNraXBXaGlsZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgU2tpcFdoaWxlT2JzZXJ2ZXIobywgdGhpcykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gU2tpcFdoaWxlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBTa2lwV2hpbGVPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU2tpcFdoaWxlT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBTa2lwV2hpbGVPYnNlcnZlcihvLCBwKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3AgPSBwO1xuICAgICAgdGhpcy5faSA9IDA7XG4gICAgICB0aGlzLl9yID0gZmFsc2U7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBTa2lwV2hpbGVPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICBpZiAoIXRoaXMuX3IpIHtcbiAgICAgICAgdmFyIHJlcyA9IHRyeUNhdGNoKHRoaXMuX3AuX2ZuKSh4LCB0aGlzLl9pKyssIHRoaXMuX3ApO1xuICAgICAgICBpZiAocmVzID09PSBlcnJvck9iaikgeyByZXR1cm4gdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgICAgICB0aGlzLl9yID0gIXJlcztcbiAgICAgIH1cbiAgICAgIHRoaXMuX3IgJiYgdGhpcy5fby5vbk5leHQoeCk7XG4gICAgfTtcbiAgICBTa2lwV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG4gICAgU2tpcFdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fby5vbkNvbXBsZXRlZCgpOyB9O1xuXG4gICAgcmV0dXJuIFNraXBXaGlsZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIEJ5cGFzc2VzIGVsZW1lbnRzIGluIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgbG9uZyBhcyBhIHNwZWNpZmllZCBjb25kaXRpb24gaXMgdHJ1ZSBhbmQgdGhlbiByZXR1cm5zIHRoZSByZW1haW5pbmcgZWxlbWVudHMuXG4gICAqICBUaGUgZWxlbWVudCdzIGluZGV4IGlzIHVzZWQgaW4gdGhlIGxvZ2ljIG9mIHRoZSBwcmVkaWNhdGUgZnVuY3Rpb24uXG4gICAqXG4gICAqICB2YXIgcmVzID0gc291cmNlLnNraXBXaGlsZShmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHZhbHVlIDwgMTA7IH0pO1xuICAgKiAgdmFyIHJlcyA9IHNvdXJjZS5za2lwV2hpbGUoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgeyByZXR1cm4gdmFsdWUgPCAxMCB8fCBpbmRleCA8IDEwOyB9KTtcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIGVsZW1lbnQgZm9yIGEgY29uZGl0aW9uOyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgZnJvbSB0aGUgaW5wdXQgc2VxdWVuY2Ugc3RhcnRpbmcgYXQgdGhlIGZpcnN0IGVsZW1lbnQgaW4gdGhlIGxpbmVhciBzZXJpZXMgdGhhdCBkb2VzIG5vdCBwYXNzIHRoZSB0ZXN0IHNwZWNpZmllZCBieSBwcmVkaWNhdGUuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2tpcFdoaWxlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhpc0FyZykge1xuICAgIHZhciBmbiA9IGJpbmRDYWxsYmFjayhwcmVkaWNhdGUsIHRoaXNBcmcsIDMpO1xuICAgIHJldHVybiBuZXcgU2tpcFdoaWxlT2JzZXJ2YWJsZSh0aGlzLCBmbik7XG4gIH07XG5cbiAgdmFyIFRha2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRha2VPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIFxuICAgIGZ1bmN0aW9uIFRha2VPYnNlcnZhYmxlKHNvdXJjZSwgY291bnQpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy50YWtlQ291bnQgPSBjb3VudDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cbiAgICBcbiAgICBUYWtlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBJbm5lck9ic2VydmVyKG8sIHRoaXMudGFrZUNvdW50KSk7XG4gICAgfTtcbiAgICBcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIGMpIHtcbiAgICAgIHRoaXMubyA9IG87XG4gICAgICB0aGlzLmMgPSBjO1xuICAgICAgdGhpcy5yID0gYztcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgfVxuICAgIElubmVyT2JzZXJ2ZXIucHJvdG90eXBlID0ge1xuICAgICAgb25OZXh0OiBmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIGlmICh0aGlzLnItLSA+IDApIHtcbiAgICAgICAgICB0aGlzLm8ub25OZXh0KHgpO1xuICAgICAgICAgIHRoaXMuciA8PSAwICYmIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycikge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuby5vbkVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkgeyB0aGlzLmlzU3RvcHBlZCA9IHRydWU7IH0sXG4gICAgICBmYWlsOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuby5vbkVycm9yKGUpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBUYWtlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpOyAgXG4gIFxuICAvKipcbiAgICogIFJldHVybnMgYSBzcGVjaWZpZWQgbnVtYmVyIG9mIGNvbnRpZ3VvdXMgZWxlbWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSwgdXNpbmcgdGhlIHNwZWNpZmllZCBzY2hlZHVsZXIgZm9yIHRoZSBlZGdlIGNhc2Ugb2YgdGFrZSgwKS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IGNvdW50IFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gcmV0dXJuLlxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gU2NoZWR1bGVyIHVzZWQgdG8gcHJvZHVjZSBhbiBPbkNvbXBsZXRlZCBtZXNzYWdlIGluIGNhc2UgPHBhcmFtcmVmIG5hbWU9XCJjb3VudCBjb3VudDwvcGFyYW1yZWY+IGlzIHNldCB0byAwLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBzcGVjaWZpZWQgbnVtYmVyIG9mIGVsZW1lbnRzIGZyb20gdGhlIHN0YXJ0IG9mIHRoZSBpbnB1dCBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50YWtlID0gZnVuY3Rpb24gKGNvdW50LCBzY2hlZHVsZXIpIHtcbiAgICBpZiAoY291bnQgPCAwKSB7IHRocm93IG5ldyBBcmd1bWVudE91dE9mUmFuZ2VFcnJvcigpOyB9XG4gICAgaWYgKGNvdW50ID09PSAwKSB7IHJldHVybiBvYnNlcnZhYmxlRW1wdHkoc2NoZWR1bGVyKTsgfVxuICAgIHJldHVybiBuZXcgVGFrZU9ic2VydmFibGUodGhpcywgY291bnQpO1xuICB9O1xuXG4gIHZhciBUYWtlV2hpbGVPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYWtlV2hpbGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFRha2VXaGlsZU9ic2VydmFibGUoc291cmNlLCBmbikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9mbiA9IGZuO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGFrZVdoaWxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBUYWtlV2hpbGVPYnNlcnZlcihvLCB0aGlzKSk7XG4gICAgfTtcblxuICAgIHJldHVybiBUYWtlV2hpbGVPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgdmFyIFRha2VXaGlsZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUYWtlV2hpbGVPYnNlcnZlciwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIFRha2VXaGlsZU9ic2VydmVyKG8sIHApIHtcbiAgICAgIHRoaXMuX28gPSBvO1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9pID0gMDtcbiAgICAgIHRoaXMuX3IgPSB0cnVlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgVGFrZVdoaWxlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgaWYgKHRoaXMuX3IpIHtcbiAgICAgICAgdGhpcy5fciA9IHRyeUNhdGNoKHRoaXMuX3AuX2ZuKSh4LCB0aGlzLl9pKyssIHRoaXMuX3ApO1xuICAgICAgICBpZiAodGhpcy5fciA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIHRoaXMuX28ub25FcnJvcih0aGlzLl9yLmUpOyB9XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5fcikge1xuICAgICAgICB0aGlzLl9vLm9uTmV4dCh4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIFRha2VXaGlsZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7IHRoaXMuX28ub25FcnJvcihlKTsgfTtcbiAgICBUYWtlV2hpbGVPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9vLm9uQ29tcGxldGVkKCk7IH07XG5cbiAgICByZXR1cm4gVGFrZVdoaWxlT2JzZXJ2ZXI7XG4gIH0oQWJzdHJhY3RPYnNlcnZlcikpO1xuXG4gIC8qKlxuICAgKiAgUmV0dXJucyBlbGVtZW50cyBmcm9tIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgbG9uZyBhcyBhIHNwZWNpZmllZCBjb25kaXRpb24gaXMgdHJ1ZS5cbiAgICogIFRoZSBlbGVtZW50J3MgaW5kZXggaXMgdXNlZCBpbiB0aGUgbG9naWMgb2YgdGhlIHByZWRpY2F0ZSBmdW5jdGlvbi5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIGVsZW1lbnQgZm9yIGEgY29uZGl0aW9uOyB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiB0aGUgZnVuY3Rpb24gcmVwcmVzZW50cyB0aGUgaW5kZXggb2YgdGhlIHNvdXJjZSBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgZnJvbSB0aGUgaW5wdXQgc2VxdWVuY2UgdGhhdCBvY2N1ciBiZWZvcmUgdGhlIGVsZW1lbnQgYXQgd2hpY2ggdGhlIHRlc3Qgbm8gbG9uZ2VyIHBhc3Nlcy5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50YWtlV2hpbGUgPSBmdW5jdGlvbiAocHJlZGljYXRlLCB0aGlzQXJnKSB7XG4gICAgdmFyIGZuID0gYmluZENhbGxiYWNrKHByZWRpY2F0ZSwgdGhpc0FyZywgMyk7XG4gICAgcmV0dXJuIG5ldyBUYWtlV2hpbGVPYnNlcnZhYmxlKHRoaXMsIGZuKTtcbiAgfTtcblxuICB2YXIgRmlsdGVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoRmlsdGVyT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcblxuICAgIGZ1bmN0aW9uIEZpbHRlck9ic2VydmFibGUoc291cmNlLCBwcmVkaWNhdGUsIHRoaXNBcmcpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5wcmVkaWNhdGUgPSBiaW5kQ2FsbGJhY2socHJlZGljYXRlLCB0aGlzQXJnLCAzKTtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIEZpbHRlck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgSW5uZXJPYnNlcnZlcihvLCB0aGlzLnByZWRpY2F0ZSwgdGhpcykpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBpbm5lclByZWRpY2F0ZShwcmVkaWNhdGUsIHNlbGYpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbih4LCBpLCBvKSB7IHJldHVybiBzZWxmLnByZWRpY2F0ZSh4LCBpLCBvKSAmJiBwcmVkaWNhdGUuY2FsbCh0aGlzLCB4LCBpLCBvKTsgfVxuICAgIH1cblxuICAgIEZpbHRlck9ic2VydmFibGUucHJvdG90eXBlLmludGVybmFsRmlsdGVyID0gZnVuY3Rpb24ocHJlZGljYXRlLCB0aGlzQXJnKSB7XG4gICAgICByZXR1cm4gbmV3IEZpbHRlck9ic2VydmFibGUodGhpcy5zb3VyY2UsIGlubmVyUHJlZGljYXRlKHByZWRpY2F0ZSwgdGhpcyksIHRoaXNBcmcpO1xuICAgIH07XG5cbiAgICBpbmhlcml0cyhJbm5lck9ic2VydmVyLCBBYnN0cmFjdE9ic2VydmVyKTtcbiAgICBmdW5jdGlvbiBJbm5lck9ic2VydmVyKG8sIHByZWRpY2F0ZSwgc291cmNlKSB7XG4gICAgICB0aGlzLm8gPSBvO1xuICAgICAgdGhpcy5wcmVkaWNhdGUgPSBwcmVkaWNhdGU7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuaSA9IDA7XG4gICAgICBBYnN0cmFjdE9ic2VydmVyLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHgpIHtcbiAgICAgIHZhciBzaG91bGRZaWVsZCA9IHRyeUNhdGNoKHRoaXMucHJlZGljYXRlKSh4LCB0aGlzLmkrKywgdGhpcy5zb3VyY2UpO1xuICAgICAgaWYgKHNob3VsZFlpZWxkID09PSBlcnJvck9iaikge1xuICAgICAgICByZXR1cm4gdGhpcy5vLm9uRXJyb3Ioc2hvdWxkWWllbGQuZSk7XG4gICAgICB9XG4gICAgICBzaG91bGRZaWVsZCAmJiB0aGlzLm8ub25OZXh0KHgpO1xuICAgIH07XG5cbiAgICBJbm5lck9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLm8ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgSW5uZXJPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5vLm9uQ29tcGxldGVkKCk7XG4gICAgfTtcblxuICAgIHJldHVybiBGaWx0ZXJPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZUJhc2UpKTtcblxuICAvKipcbiAgKiAgRmlsdGVycyB0aGUgZWxlbWVudHMgb2YgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBiYXNlZCBvbiBhIHByZWRpY2F0ZSBieSBpbmNvcnBvcmF0aW5nIHRoZSBlbGVtZW50J3MgaW5kZXguXG4gICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIEEgZnVuY3Rpb24gdG8gdGVzdCBlYWNoIHNvdXJjZSBlbGVtZW50IGZvciBhIGNvbmRpdGlvbjsgdGhlIHNlY29uZCBwYXJhbWV0ZXIgb2YgdGhlIGZ1bmN0aW9uIHJlcHJlc2VudHMgdGhlIGluZGV4IG9mIHRoZSBzb3VyY2UgZWxlbWVudC5cbiAgKiBAcGFyYW0ge0FueX0gW3RoaXNBcmddIE9iamVjdCB0byB1c2UgYXMgdGhpcyB3aGVuIGV4ZWN1dGluZyBjYWxsYmFjay5cbiAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIGVsZW1lbnRzIGZyb20gdGhlIGlucHV0IHNlcXVlbmNlIHRoYXQgc2F0aXNmeSB0aGUgY29uZGl0aW9uLlxuICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uZmlsdGVyID0gb2JzZXJ2YWJsZVByb3RvLndoZXJlID0gZnVuY3Rpb24gKHByZWRpY2F0ZSwgdGhpc0FyZykge1xuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgRmlsdGVyT2JzZXJ2YWJsZSA/IHRoaXMuaW50ZXJuYWxGaWx0ZXIocHJlZGljYXRlLCB0aGlzQXJnKSA6XG4gICAgICBuZXcgRmlsdGVyT2JzZXJ2YWJsZSh0aGlzLCBwcmVkaWNhdGUsIHRoaXNBcmcpO1xuICB9O1xuXG5mdW5jdGlvbiBjcmVhdGVDYk9ic2VydmFibGUoZm4sIGN0eCwgc2VsZWN0b3IsIGFyZ3MpIHtcbiAgdmFyIG8gPSBuZXcgQXN5bmNTdWJqZWN0KCk7XG5cbiAgYXJncy5wdXNoKGNyZWF0ZUNiSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSk7XG4gIGZuLmFwcGx5KGN0eCwgYXJncyk7XG5cbiAgcmV0dXJuIG8uYXNPYnNlcnZhYmxlKCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNiSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyICgpIHtcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgcmVzdWx0cyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyByZXN1bHRzW2ldID0gYXJndW1lbnRzW2ldOyB9XG5cbiAgICBpZiAoaXNGdW5jdGlvbihzZWxlY3RvcikpIHtcbiAgICAgIHJlc3VsdHMgPSB0cnlDYXRjaChzZWxlY3RvcikuYXBwbHkoY3R4LCByZXN1bHRzKTtcbiAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cbiAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAocmVzdWx0cy5sZW5ndGggPD0gMSkge1xuICAgICAgICBvLm9uTmV4dChyZXN1bHRzWzBdKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG8ub25OZXh0KHJlc3VsdHMpO1xuICAgICAgfVxuICAgIH1cblxuICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgfTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gRnVuY3Rpb24gd2l0aCBhIGNhbGxiYWNrIGFzIHRoZSBsYXN0IHBhcmFtZXRlciB0byBjb252ZXJ0IHRvIGFuIE9ic2VydmFibGUgc2VxdWVuY2UuXG4gKiBAcGFyYW0ge01peGVkfSBbY3R4XSBUaGUgY29udGV4dCBmb3IgdGhlIGZ1bmMgcGFyYW1ldGVyIHRvIGJlIGV4ZWN1dGVkLiAgSWYgbm90IHNwZWNpZmllZCwgZGVmYXVsdHMgdG8gdW5kZWZpbmVkLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBBIHNlbGVjdG9yIHdoaWNoIHRha2VzIHRoZSBhcmd1bWVudHMgZnJvbSB0aGUgY2FsbGJhY2sgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEEgZnVuY3Rpb24sIHdoZW4gZXhlY3V0ZWQgd2l0aCB0aGUgcmVxdWlyZWQgcGFyYW1ldGVycyBtaW51cyB0aGUgY2FsbGJhY2ssIHByb2R1Y2VzIGFuIE9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCBhIHNpbmdsZSB2YWx1ZSBvZiB0aGUgYXJndW1lbnRzIHRvIHRoZSBjYWxsYmFjayBhcyBhbiBhcnJheS5cbiAqL1xuT2JzZXJ2YWJsZS5mcm9tQ2FsbGJhY2sgPSBmdW5jdGlvbiAoZm4sIGN0eCwgc2VsZWN0b3IpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICB0eXBlb2YgY3R4ID09PSAndW5kZWZpbmVkJyAmJiAoY3R4ID0gdGhpcyk7IFxuXG4gICAgdmFyIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkobGVuKVxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIGNyZWF0ZUNiT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncyk7XG4gIH07XG59O1xuXG5mdW5jdGlvbiBjcmVhdGVOb2RlT2JzZXJ2YWJsZShmbiwgY3R4LCBzZWxlY3RvciwgYXJncykge1xuICB2YXIgbyA9IG5ldyBBc3luY1N1YmplY3QoKTtcblxuICBhcmdzLnB1c2goY3JlYXRlTm9kZUhhbmRsZXIobywgY3R4LCBzZWxlY3RvcikpO1xuICBmbi5hcHBseShjdHgsIGFyZ3MpO1xuXG4gIHJldHVybiBvLmFzT2JzZXJ2YWJsZSgpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVOb2RlSGFuZGxlcihvLCBjdHgsIHNlbGVjdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyICgpIHtcbiAgICB2YXIgZXJyID0gYXJndW1lbnRzWzBdO1xuICAgIGlmIChlcnIpIHsgcmV0dXJuIG8ub25FcnJvcihlcnIpOyB9XG5cbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgcmVzdWx0cyA9IFtdO1xuICAgIGZvcih2YXIgaSA9IDE7IGkgPCBsZW47IGkrKykgeyByZXN1bHRzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTsgfVxuXG4gICAgaWYgKGlzRnVuY3Rpb24oc2VsZWN0b3IpKSB7XG4gICAgICB2YXIgcmVzdWx0cyA9IHRyeUNhdGNoKHNlbGVjdG9yKS5hcHBseShjdHgsIHJlc3VsdHMpO1xuICAgICAgaWYgKHJlc3VsdHMgPT09IGVycm9yT2JqKSB7IHJldHVybiBvLm9uRXJyb3IocmVzdWx0cy5lKTsgfVxuICAgICAgby5vbk5leHQocmVzdWx0cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA8PSAxKSB7XG4gICAgICAgIG8ub25OZXh0KHJlc3VsdHNbMF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgby5vbk5leHQocmVzdWx0cyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgby5vbkNvbXBsZXRlZCgpO1xuICB9O1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEgTm9kZS5qcyBjYWxsYmFjayBzdHlsZSBmdW5jdGlvbiB0byBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLiAgVGhpcyBtdXN0IGJlIGluIGZ1bmN0aW9uIChlcnIsIC4uLikgZm9ybWF0LlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGNhbGxcbiAqIEBwYXJhbSB7TWl4ZWR9IFtjdHhdIFRoZSBjb250ZXh0IGZvciB0aGUgZnVuYyBwYXJhbWV0ZXIgdG8gYmUgZXhlY3V0ZWQuICBJZiBub3Qgc3BlY2lmaWVkLCBkZWZhdWx0cyB0byB1bmRlZmluZWQuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBjYWxsYmFjayBtaW51cyB0aGUgZXJyb3IgdG8gcHJvZHVjZSBhIHNpbmdsZSBpdGVtIHRvIHlpZWxkIG9uIG5leHQuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IEFuIGFzeW5jIGZ1bmN0aW9uIHdoaWNoIHdoZW4gYXBwbGllZCwgcmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHdpdGggdGhlIGNhbGxiYWNrIGFyZ3VtZW50cyBhcyBhbiBhcnJheS5cbiAqL1xuT2JzZXJ2YWJsZS5mcm9tTm9kZUNhbGxiYWNrID0gZnVuY3Rpb24gKGZuLCBjdHgsIHNlbGVjdG9yKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgdHlwZW9mIGN0eCA9PT0gJ3VuZGVmaW5lZCcgJiYgKGN0eCA9IHRoaXMpOyBcbiAgICB2YXIgbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShsZW4pO1xuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgeyBhcmdzW2ldID0gYXJndW1lbnRzW2ldOyB9XG4gICAgcmV0dXJuIGNyZWF0ZU5vZGVPYnNlcnZhYmxlKGZuLCBjdHgsIHNlbGVjdG9yLCBhcmdzKTtcbiAgfTtcbn07XG5cbiAgZnVuY3Rpb24gaXNOb2RlTGlzdChlbCkge1xuICAgIGlmIChyb290LlN0YXRpY05vZGVMaXN0KSB7XG4gICAgICAvLyBJRTggU3BlY2lmaWNcbiAgICAgIC8vIGluc3RhbmNlb2YgaXMgc2xvd2VyIHRoYW4gT2JqZWN0I3RvU3RyaW5nLCBidXQgT2JqZWN0I3RvU3RyaW5nIHdpbGwgbm90IHdvcmsgYXMgaW50ZW5kZWQgaW4gSUU4XG4gICAgICByZXR1cm4gZWwgaW5zdGFuY2VvZiByb290LlN0YXRpY05vZGVMaXN0IHx8IGVsIGluc3RhbmNlb2Ygcm9vdC5Ob2RlTGlzdDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlbCkgPT09ICdbb2JqZWN0IE5vZGVMaXN0XSc7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gTGlzdGVuRGlzcG9zYWJsZShlLCBuLCBmbikge1xuICAgIHRoaXMuX2UgPSBlO1xuICAgIHRoaXMuX24gPSBuO1xuICAgIHRoaXMuX2ZuID0gZm47XG4gICAgdGhpcy5fZS5hZGRFdmVudExpc3RlbmVyKHRoaXMuX24sIHRoaXMuX2ZuLCBmYWxzZSk7XG4gICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gIH1cbiAgTGlzdGVuRGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuaXNEaXNwb3NlZCkge1xuICAgICAgdGhpcy5fZS5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX24sIHRoaXMuX2ZuLCBmYWxzZSk7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgIH1cbiAgfTtcblxuICBmdW5jdGlvbiBjcmVhdGVFdmVudExpc3RlbmVyIChlbCwgZXZlbnROYW1lLCBoYW5kbGVyKSB7XG4gICAgdmFyIGRpc3Bvc2FibGVzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKTtcblxuICAgIC8vIEFzdW1lIE5vZGVMaXN0IG9yIEhUTUxDb2xsZWN0aW9uXG4gICAgdmFyIGVsZW1Ub1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChlbCk7XG4gICAgaWYgKGlzTm9kZUxpc3QoZWwpIHx8IGVsZW1Ub1N0cmluZyA9PT0gJ1tvYmplY3QgSFRNTENvbGxlY3Rpb25dJykge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGVsLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGRpc3Bvc2FibGVzLmFkZChjcmVhdGVFdmVudExpc3RlbmVyKGVsLml0ZW0oaSksIGV2ZW50TmFtZSwgaGFuZGxlcikpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZWwpIHtcbiAgICAgIGRpc3Bvc2FibGVzLmFkZChuZXcgTGlzdGVuRGlzcG9zYWJsZShlbCwgZXZlbnROYW1lLCBoYW5kbGVyKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRpc3Bvc2FibGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbmZpZ3VyYXRpb24gb3B0aW9uIHRvIGRldGVybWluZSB3aGV0aGVyIHRvIHVzZSBuYXRpdmUgZXZlbnRzIG9ubHlcbiAgICovXG4gIFJ4LmNvbmZpZy51c2VOYXRpdmVFdmVudHMgPSBmYWxzZTtcblxuICB2YXIgRXZlbnRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEV2ZW50T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBFdmVudE9ic2VydmFibGUoZWwsIG5hbWUsIGZuKSB7XG4gICAgICB0aGlzLl9lbCA9IGVsO1xuICAgICAgdGhpcy5fbiA9IG5hbWU7XG4gICAgICB0aGlzLl9mbiA9IGZuO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlSGFuZGxlcihvLCBmbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuICAgICAgICB2YXIgcmVzdWx0cyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oZm4pKSB7XG4gICAgICAgICAgcmVzdWx0cyA9IHRyeUNhdGNoKGZuKS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgICAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cbiAgICAgICAgfVxuICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgRXZlbnRPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHJldHVybiBjcmVhdGVFdmVudExpc3RlbmVyKFxuICAgICAgICB0aGlzLl9lbCxcbiAgICAgICAgdGhpcy5fbixcbiAgICAgICAgY3JlYXRlSGFuZGxlcihvLCB0aGlzLl9mbikpO1xuICAgIH07XG5cbiAgICByZXR1cm4gRXZlbnRPYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBieSBhZGRpbmcgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIG1hdGNoaW5nIERPTUVsZW1lbnQgb3IgZWFjaCBpdGVtIGluIHRoZSBOb2RlTGlzdC5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVsZW1lbnQgVGhlIERPTUVsZW1lbnQgb3IgTm9kZUxpc3QgdG8gYXR0YWNoIGEgbGlzdGVuZXIuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgVGhlIGV2ZW50IG5hbWUgdG8gYXR0YWNoIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBldmVudCBoYW5kbGVyIHRvIHByb2R1Y2UgYSBzaW5nbGUgaXRlbSB0byB5aWVsZCBvbiBuZXh0LlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBvZiBldmVudHMgZnJvbSB0aGUgc3BlY2lmaWVkIGVsZW1lbnQgYW5kIHRoZSBzcGVjaWZpZWQgZXZlbnQuXG4gICAqL1xuICBPYnNlcnZhYmxlLmZyb21FdmVudCA9IGZ1bmN0aW9uIChlbGVtZW50LCBldmVudE5hbWUsIHNlbGVjdG9yKSB7XG4gICAgLy8gTm9kZS5qcyBzcGVjaWZpY1xuICAgIGlmIChlbGVtZW50LmFkZExpc3RlbmVyKSB7XG4gICAgICByZXR1cm4gZnJvbUV2ZW50UGF0dGVybihcbiAgICAgICAgZnVuY3Rpb24gKGgpIHsgZWxlbWVudC5hZGRMaXN0ZW5lcihldmVudE5hbWUsIGgpOyB9LFxuICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50LnJlbW92ZUxpc3RlbmVyKGV2ZW50TmFtZSwgaCk7IH0sXG4gICAgICAgIHNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICAvLyBVc2Ugb25seSBpZiBub24tbmF0aXZlIGV2ZW50cyBhcmUgYWxsb3dlZFxuICAgIGlmICghUnguY29uZmlnLnVzZU5hdGl2ZUV2ZW50cykge1xuICAgICAgLy8gSGFuZGxlcyBqcSwgQW5ndWxhci5qcywgWmVwdG8sIE1hcmlvbmV0dGUsIEVtYmVyLmpzXG4gICAgICBpZiAodHlwZW9mIGVsZW1lbnQub24gPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGVsZW1lbnQub2ZmID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiBmcm9tRXZlbnRQYXR0ZXJuKFxuICAgICAgICAgIGZ1bmN0aW9uIChoKSB7IGVsZW1lbnQub24oZXZlbnROYW1lLCBoKTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoaCkgeyBlbGVtZW50Lm9mZihldmVudE5hbWUsIGgpOyB9LFxuICAgICAgICAgIHNlbGVjdG9yKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEV2ZW50T2JzZXJ2YWJsZShlbGVtZW50LCBldmVudE5hbWUsIHNlbGVjdG9yKS5wdWJsaXNoKCkucmVmQ291bnQoKTtcbiAgfTtcblxuICB2YXIgRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhFdmVudFBhdHRlcm5PYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEV2ZW50UGF0dGVybk9ic2VydmFibGUoYWRkLCBkZWwsIGZuKSB7XG4gICAgICB0aGlzLl9hZGQgPSBhZGQ7XG4gICAgICB0aGlzLl9kZWwgPSBkZWw7XG4gICAgICB0aGlzLl9mbiA9IGZuO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY3JlYXRlSGFuZGxlcihvLCBmbikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uIGhhbmRsZXIgKCkge1xuICAgICAgICB2YXIgcmVzdWx0cyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24oZm4pKSB7XG4gICAgICAgICAgcmVzdWx0cyA9IHRyeUNhdGNoKGZuKS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgICAgICAgIGlmIChyZXN1bHRzID09PSBlcnJvck9iaikgeyByZXR1cm4gby5vbkVycm9yKHJlc3VsdHMuZSk7IH1cbiAgICAgICAgfVxuICAgICAgICBvLm9uTmV4dChyZXN1bHRzKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgRXZlbnRQYXR0ZXJuT2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgZm4gPSBjcmVhdGVIYW5kbGVyKG8sIHRoaXMuX2ZuKTtcbiAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHRoaXMuX2FkZChmbik7XG4gICAgICByZXR1cm4gbmV3IEV2ZW50UGF0dGVybkRpc3Bvc2FibGUodGhpcy5fZGVsLCBmbiwgcmV0dXJuVmFsdWUpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBFdmVudFBhdHRlcm5EaXNwb3NhYmxlKGRlbCwgZm4sIHJldCkge1xuICAgICAgdGhpcy5fZGVsID0gZGVsO1xuICAgICAgdGhpcy5fZm4gPSBmbjtcbiAgICAgIHRoaXMuX3JldCA9IHJldDtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIEV2ZW50UGF0dGVybkRpc3Bvc2FibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZighdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICAgIGlzRnVuY3Rpb24odGhpcy5fZGVsKSAmJiB0aGlzLl9kZWwodGhpcy5fZm4sIHRoaXMuX3JldCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiBFdmVudFBhdHRlcm5PYnNlcnZhYmxlO1xuICB9KE9ic2VydmFibGVCYXNlKSk7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBmcm9tIGFuIGV2ZW50IGVtaXR0ZXIgdmlhIGFuIGFkZEhhbmRsZXIvcmVtb3ZlSGFuZGxlciBwYWlyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBhZGRIYW5kbGVyIFRoZSBmdW5jdGlvbiB0byBhZGQgYSBoYW5kbGVyIHRvIHRoZSBlbWl0dGVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVtb3ZlSGFuZGxlcl0gVGhlIG9wdGlvbmFsIGZ1bmN0aW9uIHRvIHJlbW92ZSBhIGhhbmRsZXIgZnJvbSBhbiBlbWl0dGVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIEEgc2VsZWN0b3Igd2hpY2ggdGFrZXMgdGhlIGFyZ3VtZW50cyBmcm9tIHRoZSBldmVudCBoYW5kbGVyIHRvIHByb2R1Y2UgYSBzaW5nbGUgaXRlbSB0byB5aWVsZCBvbiBuZXh0LlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB3cmFwcyBhbiBldmVudCBmcm9tIGFuIGV2ZW50IGVtaXR0ZXJcbiAgICovXG4gIHZhciBmcm9tRXZlbnRQYXR0ZXJuID0gT2JzZXJ2YWJsZS5mcm9tRXZlbnRQYXR0ZXJuID0gZnVuY3Rpb24gKGFkZEhhbmRsZXIsIHJlbW92ZUhhbmRsZXIsIHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIG5ldyBFdmVudFBhdHRlcm5PYnNlcnZhYmxlKGFkZEhhbmRsZXIsIHJlbW92ZUhhbmRsZXIsIHNlbGVjdG9yKS5wdWJsaXNoKCkucmVmQ291bnQoKTtcbiAgfTtcblxuICB2YXIgRnJvbVByb21pc2VPYnNlcnZhYmxlID0gKGZ1bmN0aW9uKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKEZyb21Qcm9taXNlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBGcm9tUHJvbWlzZU9ic2VydmFibGUocCwgcykge1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHNjaGVkdWxlTmV4dChzLCBzdGF0ZSkge1xuICAgICAgdmFyIG8gPSBzdGF0ZVswXSwgZGF0YSA9IHN0YXRlWzFdO1xuICAgICAgby5vbk5leHQoZGF0YSk7XG4gICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVFcnJvcihzLCBzdGF0ZSkge1xuICAgICAgdmFyIG8gPSBzdGF0ZVswXSwgZXJyID0gc3RhdGVbMV07XG4gICAgICBvLm9uRXJyb3IoZXJyKTtcbiAgICB9XG5cbiAgICBGcm9tUHJvbWlzZU9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbihvKSB7XG4gICAgICB2YXIgc2FkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCksIHNlbGYgPSB0aGlzO1xuXG4gICAgICB0aGlzLl9wXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc2VsZi5fcy5zY2hlZHVsZShbbywgZGF0YV0sIHNjaGVkdWxlTmV4dCkpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgc2FkLnNldERpc3Bvc2FibGUoc2VsZi5fcy5zY2hlZHVsZShbbywgZXJyXSwgc2NoZWR1bGVFcnJvcikpO1xuICAgICAgICB9KTtcblxuICAgICAgcmV0dXJuIHNhZDtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEZyb21Qcm9taXNlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAqIENvbnZlcnRzIGEgUHJvbWlzZSB0byBhbiBPYnNlcnZhYmxlIHNlcXVlbmNlXG4gICogQHBhcmFtIHtQcm9taXNlfSBBbiBFUzYgQ29tcGxpYW50IHByb21pc2UuXG4gICogQHJldHVybnMge09ic2VydmFibGV9IEFuIE9ic2VydmFibGUgc2VxdWVuY2Ugd2hpY2ggd3JhcHMgdGhlIGV4aXN0aW5nIHByb21pc2Ugc3VjY2VzcyBhbmQgZmFpbHVyZS5cbiAgKi9cbiAgdmFyIG9ic2VydmFibGVGcm9tUHJvbWlzZSA9IE9ic2VydmFibGUuZnJvbVByb21pc2UgPSBmdW5jdGlvbiAocHJvbWlzZSwgc2NoZWR1bGVyKSB7XG4gICAgc2NoZWR1bGVyIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IEZyb21Qcm9taXNlT2JzZXJ2YWJsZShwcm9taXNlLCBzY2hlZHVsZXIpO1xuICB9O1xuXG4gIC8qXG4gICAqIENvbnZlcnRzIGFuIGV4aXN0aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgdG8gYW4gRVM2IENvbXBhdGlibGUgUHJvbWlzZVxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcHJvbWlzZSA9IFJ4Lk9ic2VydmFibGUucmV0dXJuKDQyKS50b1Byb21pc2UoUlNWUC5Qcm9taXNlKTtcbiAgICpcbiAgICogLy8gV2l0aCBjb25maWdcbiAgICogUnguY29uZmlnLlByb21pc2UgPSBSU1ZQLlByb21pc2U7XG4gICAqIHZhciBwcm9taXNlID0gUnguT2JzZXJ2YWJsZS5yZXR1cm4oNDIpLnRvUHJvbWlzZSgpO1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJvbWlzZUN0b3JdIFRoZSBjb25zdHJ1Y3RvciBvZiB0aGUgcHJvbWlzZS4gSWYgbm90IHByb3ZpZGVkLCBpdCBsb29rcyBmb3IgaXQgaW4gUnguY29uZmlnLlByb21pc2UuXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfSBBbiBFUzYgY29tcGF0aWJsZSBwcm9taXNlIHdpdGggdGhlIGxhc3QgdmFsdWUgZnJvbSB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50b1Byb21pc2UgPSBmdW5jdGlvbiAocHJvbWlzZUN0b3IpIHtcbiAgICBwcm9taXNlQ3RvciB8fCAocHJvbWlzZUN0b3IgPSBSeC5jb25maWcuUHJvbWlzZSk7XG4gICAgaWYgKCFwcm9taXNlQ3RvcikgeyB0aHJvdyBuZXcgTm90U3VwcG9ydGVkRXJyb3IoJ1Byb21pc2UgdHlwZSBub3QgcHJvdmlkZWQgbm9yIGluIFJ4LmNvbmZpZy5Qcm9taXNlJyk7IH1cbiAgICB2YXIgc291cmNlID0gdGhpcztcbiAgICByZXR1cm4gbmV3IHByb21pc2VDdG9yKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIC8vIE5vIGNhbmNlbGxhdGlvbiBjYW4gYmUgZG9uZVxuICAgICAgdmFyIHZhbHVlO1xuICAgICAgc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAodikge1xuICAgICAgICB2YWx1ZSA9IHY7XG4gICAgICB9LCByZWplY3QsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogSW52b2tlcyB0aGUgYXN5bmNocm9ub3VzIGZ1bmN0aW9uLCBzdXJmYWNpbmcgdGhlIHJlc3VsdCB0aHJvdWdoIGFuIG9ic2VydmFibGUgc2VxdWVuY2UuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmN0aW9uQXN5bmMgQXN5bmNocm9ub3VzIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYSBQcm9taXNlIHRvIHJ1bi5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgZXhwb3NpbmcgdGhlIGZ1bmN0aW9uJ3MgcmVzdWx0IHZhbHVlLCBvciBhbiBleGNlcHRpb24uXG4gICAqL1xuICBPYnNlcnZhYmxlLnN0YXJ0QXN5bmMgPSBmdW5jdGlvbiAoZnVuY3Rpb25Bc3luYykge1xuICAgIHZhciBwcm9taXNlID0gdHJ5Q2F0Y2goZnVuY3Rpb25Bc3luYykoKTtcbiAgICBpZiAocHJvbWlzZSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG9ic2VydmFibGVUaHJvdyhwcm9taXNlLmUpOyB9XG4gICAgcmV0dXJuIG9ic2VydmFibGVGcm9tUHJvbWlzZShwcm9taXNlKTtcbiAgfTtcblxuICB2YXIgTXVsdGljYXN0T2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoTXVsdGljYXN0T2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBNdWx0aWNhc3RPYnNlcnZhYmxlKHNvdXJjZSwgZm4xLCBmbjIpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fZm4xID0gZm4xO1xuICAgICAgdGhpcy5fZm4yID0gZm4yO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgTXVsdGljYXN0T2JzZXJ2YWJsZS5wcm90b3R5cGUuc3Vic2NyaWJlQ29yZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgY29ubmVjdGFibGUgPSB0aGlzLnNvdXJjZS5tdWx0aWNhc3QodGhpcy5fZm4xKCkpO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHRoaXMuX2ZuMihjb25uZWN0YWJsZSkuc3Vic2NyaWJlKG8pLCBjb25uZWN0YWJsZS5jb25uZWN0KCkpO1xuICAgIH07XG5cbiAgICByZXR1cm4gTXVsdGljYXN0T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIC8qKlxuICAgKiBNdWx0aWNhc3RzIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugbm90aWZpY2F0aW9ucyB0aHJvdWdoIGFuIGluc3RhbnRpYXRlZCBzdWJqZWN0IGludG8gYWxsIHVzZXMgb2YgdGhlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLiBFYWNoXG4gICAqIHN1YnNjcmlwdGlvbiB0byB0aGUgcmVzdWx0aW5nIHNlcXVlbmNlIGNhdXNlcyBhIHNlcGFyYXRlIG11bHRpY2FzdCBpbnZvY2F0aW9uLCBleHBvc2luZyB0aGUgc2VxdWVuY2UgcmVzdWx0aW5nIGZyb20gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uJ3NcbiAgICogaW52b2NhdGlvbi4gRm9yIHNwZWNpYWxpemF0aW9ucyB3aXRoIGZpeGVkIHN1YmplY3QgdHlwZXMsIHNlZSBQdWJsaXNoLCBQdWJsaXNoTGFzdCwgYW5kIFJlcGxheS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogMSAtIHJlcyA9IHNvdXJjZS5tdWx0aWNhc3Qob2JzZXJ2YWJsZSk7XG4gICAqIDIgLSByZXMgPSBzb3VyY2UubXVsdGljYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBTdWJqZWN0KCk7IH0sIGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbnxTdWJqZWN0fSBzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3JcbiAgICogRmFjdG9yeSBmdW5jdGlvbiB0byBjcmVhdGUgYW4gaW50ZXJtZWRpYXRlIHN1YmplY3QgdGhyb3VnaCB3aGljaCB0aGUgc291cmNlIHNlcXVlbmNlJ3MgZWxlbWVudHMgd2lsbCBiZSBtdWx0aWNhc3QgdG8gdGhlIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKiBPcjpcbiAgICogU3ViamVjdCB0byBwdXNoIHNvdXJjZSBlbGVtZW50cyBpbnRvLlxuICAgKlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbc2VsZWN0b3JdIE9wdGlvbmFsIHNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBzdWJqZWN0IHRvIHRoZSBwb2xpY2llcyBlbmZvcmNlZCBieSB0aGUgY3JlYXRlZCBzdWJqZWN0LiBTcGVjaWZpZWQgb25seSBpZiA8cGFyYW1yZWYgbmFtZT1cInN1YmplY3RPclN1YmplY3RTZWxlY3RvclwiIGlzIGEgZmFjdG9yeSBmdW5jdGlvbi5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBjb250YWlucyB0aGUgZWxlbWVudHMgb2YgYSBzZXF1ZW5jZSBwcm9kdWNlZCBieSBtdWx0aWNhc3RpbmcgdGhlIHNvdXJjZSBzZXF1ZW5jZSB3aXRoaW4gYSBzZWxlY3RvciBmdW5jdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5tdWx0aWNhc3QgPSBmdW5jdGlvbiAoc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yLCBzZWxlY3Rvcikge1xuICAgIHJldHVybiBpc0Z1bmN0aW9uKHN1YmplY3RPclN1YmplY3RTZWxlY3RvcikgP1xuICAgICAgbmV3IE11bHRpY2FzdE9ic2VydmFibGUodGhpcywgc3ViamVjdE9yU3ViamVjdFNlbGVjdG9yLCBzZWxlY3RvcikgOlxuICAgICAgbmV3IENvbm5lY3RhYmxlT2JzZXJ2YWJsZSh0aGlzLCBzdWJqZWN0T3JTdWJqZWN0U2VsZWN0b3IpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBpcyB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSBzZWxlY3RvciBvbiBhIGNvbm5lY3RhYmxlIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgTXVsdGljYXN0IHVzaW5nIGEgcmVndWxhciBTdWJqZWN0LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcmVzcmVzID0gc291cmNlLnB1Ymxpc2goKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3NlbGVjdG9yXSBTZWxlY3RvciBmdW5jdGlvbiB3aGljaCBjYW4gdXNlIHRoZSBtdWx0aWNhc3RlZCBzb3VyY2Ugc2VxdWVuY2UgYXMgbWFueSB0aW1lcyBhcyBuZWVkZWQsIHdpdGhvdXQgY2F1c2luZyBtdWx0aXBsZSBzdWJzY3JpcHRpb25zIHRvIHRoZSBzb3VyY2Ugc2VxdWVuY2UuIFN1YnNjcmliZXJzIHRvIHRoZSBnaXZlbiBzb3VyY2Ugd2lsbCByZWNlaXZlIGFsbCBub3RpZmljYXRpb25zIG9mIHRoZSBzb3VyY2UgZnJvbSB0aGUgdGltZSBvZiB0aGUgc3Vic2NyaXB0aW9uIG9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2ggPSBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcbiAgICByZXR1cm4gc2VsZWN0b3IgJiYgaXNGdW5jdGlvbihzZWxlY3RvcikgP1xuICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFN1YmplY3QoKTsgfSwgc2VsZWN0b3IpIDpcbiAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBTdWJqZWN0KCkpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgcHVibGlzaCB3aGljaCBjcmVhdGVzIGEgc3Vic2NyaXB0aW9uIHdoZW4gdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgZ29lcyBmcm9tIHplcm8gdG8gb25lLCB0aGVuIHNoYXJlcyB0aGF0IHN1YnNjcmlwdGlvbiB3aXRoIGFsbCBzdWJzZXF1ZW50IG9ic2VydmVycyB1bnRpbCB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyByZXR1cm5zIHRvIHplcm8sIGF0IHdoaWNoIHBvaW50IHRoZSBzdWJzY3JpcHRpb24gaXMgZGlzcG9zZWQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2hhcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMucHVibGlzaCgpLnJlZkNvdW50KCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgY29udGFpbmluZyBvbmx5IHRoZSBsYXN0IG5vdGlmaWNhdGlvbi5cbiAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIEFzeW5jU3ViamVjdC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoTGFzdCgpO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hMYXN0KGZ1bmN0aW9uICh4KSB7IHJldHVybiB4OyB9KTtcbiAgICpcbiAgICogQHBhcmFtIHNlbGVjdG9yIFtPcHRpb25hbF0gU2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgb25seSByZWNlaXZlIHRoZSBsYXN0IG5vdGlmaWNhdGlvbiBvZiB0aGUgc291cmNlLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2hMYXN0ID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgcmV0dXJuIHNlbGVjdG9yICYmIGlzRnVuY3Rpb24oc2VsZWN0b3IpID9cbiAgICAgIHRoaXMubXVsdGljYXN0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBBc3luY1N1YmplY3QoKTsgfSwgc2VsZWN0b3IpIDpcbiAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBBc3luY1N1YmplY3QoKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGlzIHRoZSByZXN1bHQgb2YgaW52b2tpbmcgdGhlIHNlbGVjdG9yIG9uIGEgY29ubmVjdGFibGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHNoYXJlcyBhIHNpbmdsZSBzdWJzY3JpcHRpb24gdG8gdGhlIHVuZGVybHlpbmcgc2VxdWVuY2UgYW5kIHN0YXJ0cyB3aXRoIGluaXRpYWxWYWx1ZS5cbiAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIE11bHRpY2FzdCB1c2luZyBhIEJlaGF2aW9yU3ViamVjdC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5wdWJsaXNoVmFsdWUoNDIpO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnB1Ymxpc2hWYWx1ZShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC5zZWxlY3QoZnVuY3Rpb24gKHkpIHsgcmV0dXJuIHkgKiB5OyB9KSB9LCA0Mik7XG4gICAqXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtzZWxlY3Rvcl0gT3B0aW9uYWwgc2VsZWN0b3IgZnVuY3Rpb24gd2hpY2ggY2FuIHVzZSB0aGUgbXVsdGljYXN0ZWQgc291cmNlIHNlcXVlbmNlIGFzIG1hbnkgdGltZXMgYXMgbmVlZGVkLCB3aXRob3V0IGNhdXNpbmcgbXVsdGlwbGUgc3Vic2NyaXB0aW9ucyB0byB0aGUgc291cmNlIHNlcXVlbmNlLiBTdWJzY3JpYmVycyB0byB0aGUgZ2l2ZW4gc291cmNlIHdpbGwgcmVjZWl2ZSBpbW1lZGlhdGVseSByZWNlaXZlIHRoZSBpbml0aWFsIHZhbHVlLCBmb2xsb3dlZCBieSBhbGwgbm90aWZpY2F0aW9ucyBvZiB0aGUgc291cmNlIGZyb20gdGhlIHRpbWUgb2YgdGhlIHN1YnNjcmlwdGlvbiBvbi5cbiAgICogQHBhcmFtIHtNaXhlZH0gaW5pdGlhbFZhbHVlIEluaXRpYWwgdmFsdWUgcmVjZWl2ZWQgYnkgb2JzZXJ2ZXJzIHVwb24gc3Vic2NyaXB0aW9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlIHdpdGhpbiBhIHNlbGVjdG9yIGZ1bmN0aW9uLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnB1Ymxpc2hWYWx1ZSA9IGZ1bmN0aW9uIChpbml0aWFsVmFsdWVPclNlbGVjdG9yLCBpbml0aWFsVmFsdWUpIHtcbiAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PT0gMiA/XG4gICAgICB0aGlzLm11bHRpY2FzdChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgQmVoYXZpb3JTdWJqZWN0KGluaXRpYWxWYWx1ZSk7XG4gICAgICB9LCBpbml0aWFsVmFsdWVPclNlbGVjdG9yKSA6XG4gICAgICB0aGlzLm11bHRpY2FzdChuZXcgQmVoYXZpb3JTdWJqZWN0KGluaXRpYWxWYWx1ZU9yU2VsZWN0b3IpKTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSBhbmQgc3RhcnRzIHdpdGggYW4gaW5pdGlhbFZhbHVlLlxuICAgKiBUaGlzIG9wZXJhdG9yIGlzIGEgc3BlY2lhbGl6YXRpb24gb2YgcHVibGlzaFZhbHVlIHdoaWNoIGNyZWF0ZXMgYSBzdWJzY3JpcHRpb24gd2hlbiB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyBnb2VzIGZyb20gemVybyB0byBvbmUsIHRoZW4gc2hhcmVzIHRoYXQgc3Vic2NyaXB0aW9uIHdpdGggYWxsIHN1YnNlcXVlbnQgb2JzZXJ2ZXJzIHVudGlsIHRoZSBudW1iZXIgb2Ygb2JzZXJ2ZXJzIHJldHVybnMgdG8gemVybywgYXQgd2hpY2ggcG9pbnQgdGhlIHN1YnNjcmlwdGlvbiBpcyBkaXNwb3NlZC5cbiAgICogQHBhcmFtIHtNaXhlZH0gaW5pdGlhbFZhbHVlIEluaXRpYWwgdmFsdWUgcmVjZWl2ZWQgYnkgb2JzZXJ2ZXJzIHVwb24gc3Vic2NyaXB0aW9uLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IGNvbnRhaW5zIHRoZSBlbGVtZW50cyBvZiBhIHNlcXVlbmNlIHByb2R1Y2VkIGJ5IG11bHRpY2FzdGluZyB0aGUgc291cmNlIHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNoYXJlVmFsdWUgPSBmdW5jdGlvbiAoaW5pdGlhbFZhbHVlKSB7XG4gICAgcmV0dXJuIHRoaXMucHVibGlzaFZhbHVlKGluaXRpYWxWYWx1ZSkucmVmQ291bnQoKTtcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJucyBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgaXMgdGhlIHJlc3VsdCBvZiBpbnZva2luZyB0aGUgc2VsZWN0b3Igb24gYSBjb25uZWN0YWJsZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgc2hhcmVzIGEgc2luZ2xlIHN1YnNjcmlwdGlvbiB0byB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZSByZXBsYXlpbmcgbm90aWZpY2F0aW9ucyBzdWJqZWN0IHRvIGEgbWF4aW11bSB0aW1lIGxlbmd0aCBmb3IgdGhlIHJlcGxheSBidWZmZXIuXG4gICAqIFRoaXMgb3BlcmF0b3IgaXMgYSBzcGVjaWFsaXphdGlvbiBvZiBNdWx0aWNhc3QgdXNpbmcgYSBSZXBsYXlTdWJqZWN0LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShudWxsLCAzKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5yZXBsYXkobnVsbCwgMywgNTAwKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5yZXBsYXkobnVsbCwgMywgNTAwLCBzY2hlZHVsZXIpO1xuICAgKiB2YXIgcmVzID0gc291cmNlLnJlcGxheShmdW5jdGlvbiAoeCkgeyByZXR1cm4geC50YWtlKDYpLnJlcGVhdCgpOyB9LCAzLCA1MDAsIHNjaGVkdWxlcik7XG4gICAqXG4gICAqIEBwYXJhbSBzZWxlY3RvciBbT3B0aW9uYWxdIFNlbGVjdG9yIGZ1bmN0aW9uIHdoaWNoIGNhbiB1c2UgdGhlIG11bHRpY2FzdGVkIHNvdXJjZSBzZXF1ZW5jZSBhcyBtYW55IHRpbWVzIGFzIG5lZWRlZCwgd2l0aG91dCBjYXVzaW5nIG11bHRpcGxlIHN1YnNjcmlwdGlvbnMgdG8gdGhlIHNvdXJjZSBzZXF1ZW5jZS4gU3Vic2NyaWJlcnMgdG8gdGhlIGdpdmVuIHNvdXJjZSB3aWxsIHJlY2VpdmUgYWxsIHRoZSBub3RpZmljYXRpb25zIG9mIHRoZSBzb3VyY2Ugc3ViamVjdCB0byB0aGUgc3BlY2lmaWVkIHJlcGxheSBidWZmZXIgdHJpbW1pbmcgcG9saWN5LlxuICAgKiBAcGFyYW0gYnVmZmVyU2l6ZSBbT3B0aW9uYWxdIE1heGltdW0gZWxlbWVudCBjb3VudCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICogQHBhcmFtIHdpbmRvd1NpemUgW09wdGlvbmFsXSBNYXhpbXVtIHRpbWUgbGVuZ3RoIG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuICAgKiBAcGFyYW0gc2NoZWR1bGVyIFtPcHRpb25hbF0gU2NoZWR1bGVyIHdoZXJlIGNvbm5lY3RlZCBvYnNlcnZlcnMgd2l0aGluIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2Ugd2l0aGluIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucmVwbGF5ID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBidWZmZXJTaXplLCB3aW5kb3dTaXplLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gc2VsZWN0b3IgJiYgaXNGdW5jdGlvbihzZWxlY3RvcikgP1xuICAgICAgdGhpcy5tdWx0aWNhc3QoZnVuY3Rpb24gKCkgeyByZXR1cm4gbmV3IFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKTsgfSwgc2VsZWN0b3IpIDpcbiAgICAgIHRoaXMubXVsdGljYXN0KG5ldyBSZXBsYXlTdWJqZWN0KGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBzaGFyZXMgYSBzaW5nbGUgc3Vic2NyaXB0aW9uIHRvIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlIHJlcGxheWluZyBub3RpZmljYXRpb25zIHN1YmplY3QgdG8gYSBtYXhpbXVtIHRpbWUgbGVuZ3RoIGZvciB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICogVGhpcyBvcGVyYXRvciBpcyBhIHNwZWNpYWxpemF0aW9uIG9mIHJlcGxheSB3aGljaCBjcmVhdGVzIGEgc3Vic2NyaXB0aW9uIHdoZW4gdGhlIG51bWJlciBvZiBvYnNlcnZlcnMgZ29lcyBmcm9tIHplcm8gdG8gb25lLCB0aGVuIHNoYXJlcyB0aGF0IHN1YnNjcmlwdGlvbiB3aXRoIGFsbCBzdWJzZXF1ZW50IG9ic2VydmVycyB1bnRpbCB0aGUgbnVtYmVyIG9mIG9ic2VydmVycyByZXR1cm5zIHRvIHplcm8sIGF0IHdoaWNoIHBvaW50IHRoZSBzdWJzY3JpcHRpb24gaXMgZGlzcG9zZWQuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciByZXMgPSBzb3VyY2Uuc2hhcmVSZXBsYXkoMyk7XG4gICAqIHZhciByZXMgPSBzb3VyY2Uuc2hhcmVSZXBsYXkoMywgNTAwKTtcbiAgICogdmFyIHJlcyA9IHNvdXJjZS5zaGFyZVJlcGxheSgzLCA1MDAsIHNjaGVkdWxlcik7XG4gICAqXG5cbiAgICogQHBhcmFtIGJ1ZmZlclNpemUgW09wdGlvbmFsXSBNYXhpbXVtIGVsZW1lbnQgY291bnQgb2YgdGhlIHJlcGxheSBidWZmZXIuXG4gICAqIEBwYXJhbSB3aW5kb3cgW09wdGlvbmFsXSBNYXhpbXVtIHRpbWUgbGVuZ3RoIG9mIHRoZSByZXBsYXkgYnVmZmVyLlxuICAgKiBAcGFyYW0gc2NoZWR1bGVyIFtPcHRpb25hbF0gU2NoZWR1bGVyIHdoZXJlIGNvbm5lY3RlZCBvYnNlcnZlcnMgd2l0aGluIHRoZSBzZWxlY3RvciBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgb24uXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBvYnNlcnZhYmxlIHNlcXVlbmNlIHRoYXQgY29udGFpbnMgdGhlIGVsZW1lbnRzIG9mIGEgc2VxdWVuY2UgcHJvZHVjZWQgYnkgbXVsdGljYXN0aW5nIHRoZSBzb3VyY2Ugc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uc2hhcmVSZXBsYXkgPSBmdW5jdGlvbiAoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSB7XG4gICAgcmV0dXJuIHRoaXMucmVwbGF5KG51bGwsIGJ1ZmZlclNpemUsIHdpbmRvd1NpemUsIHNjaGVkdWxlcikucmVmQ291bnQoKTtcbiAgfTtcblxuICB2YXIgUmVmQ291bnRPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhSZWZDb3VudE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUmVmQ291bnRPYnNlcnZhYmxlKHNvdXJjZSkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9jb3VudCA9IDA7XG4gICAgICB0aGlzLl9jb25uZWN0YWJsZVN1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBSZWZDb3VudE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHNob3VsZENvbm5lY3QgPSArK3RoaXMuX2NvdW50ID09PSAxLCBzdWJzY3JpcHRpb24gPSB0aGlzLnNvdXJjZS5zdWJzY3JpYmUobyk7XG4gICAgICBzaG91bGRDb25uZWN0ICYmICh0aGlzLl9jb25uZWN0YWJsZVN1YnNjcmlwdGlvbiA9IHRoaXMuc291cmNlLmNvbm5lY3QoKSk7XG4gICAgICByZXR1cm4gbmV3IFJlZkNvdW50RGlzcG9zYWJsZSh0aGlzLCBzdWJzY3JpcHRpb24pO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBSZWZDb3VudERpc3Bvc2FibGUocCwgcykge1xuICAgICAgdGhpcy5fcCA9IHA7XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIFJlZkNvdW50RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX3MuZGlzcG9zZSgpO1xuICAgICAgICAtLXRoaXMuX3AuX2NvdW50ID09PSAwICYmIHRoaXMuX3AuX2Nvbm5lY3RhYmxlU3Vic2NyaXB0aW9uLmRpc3Bvc2UoKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIFJlZkNvdW50T2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBDb25uZWN0YWJsZU9ic2VydmFibGUgPSBSeC5Db25uZWN0YWJsZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENvbm5lY3RhYmxlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBDb25uZWN0YWJsZU9ic2VydmFibGUoc291cmNlLCBzdWJqZWN0KSB7XG4gICAgICB0aGlzLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRoaXMuX2hhc1N1YnNjcmlwdGlvbiAgPSBmYWxzZTtcbiAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbiA9IG51bGw7XG4gICAgICB0aGlzLl9zb3VyY2VPYnNlcnZhYmxlID0gc291cmNlLmFzT2JzZXJ2YWJsZSgpO1xuICAgICAgdGhpcy5fc3ViamVjdCA9IHN1YmplY3Q7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBDb25uZWN0RGlzcG9zYWJsZShwYXJlbnQpIHtcbiAgICAgIHRoaXMuX3AgPSBwYXJlbnQ7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBDb25uZWN0RGlzcG9zYWJsZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICghdGhpcy5pc0Rpc3Bvc2VkKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX3AuX2hhc1N1YnNjcmlwdGlvbiA9IGZhbHNlO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBDb25uZWN0YWJsZU9ic2VydmFibGUucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoIXRoaXMuX2hhc1N1YnNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLl9oYXNTdWJzY3JpcHRpb24gPSB0cnVlO1xuICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb24gPSBuZXcgQmluYXJ5RGlzcG9zYWJsZShcbiAgICAgICAgICB0aGlzLl9zb3VyY2VPYnNlcnZhYmxlLnN1YnNjcmliZSh0aGlzLl9zdWJqZWN0KSxcbiAgICAgICAgICBuZXcgQ29ubmVjdERpc3Bvc2FibGUodGhpcylcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl9zdWJzY3JpcHRpb247XG4gICAgfTtcblxuICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3ViamVjdC5zdWJzY3JpYmUobyk7XG4gICAgfTtcblxuICAgIENvbm5lY3RhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVmQ291bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3IFJlZkNvdW50T2JzZXJ2YWJsZSh0aGlzKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENvbm5lY3RhYmxlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgdmFyIFRpbWVyT2JzZXJ2YWJsZSA9IChmdW5jdGlvbihfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhUaW1lck9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGltZXJPYnNlcnZhYmxlKGR0LCBzKSB7XG4gICAgICB0aGlzLl9kdCA9IGR0O1xuICAgICAgdGhpcy5fcyA9IHM7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUaW1lck9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuX3Muc2NoZWR1bGVGdXR1cmUobywgdGhpcy5fZHQsIHNjaGVkdWxlTWV0aG9kKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gc2NoZWR1bGVNZXRob2Qocywgbykge1xuICAgICAgby5vbk5leHQoMCk7XG4gICAgICBvLm9uQ29tcGxldGVkKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFRpbWVyT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIGZ1bmN0aW9uIF9vYnNlcnZhYmxlVGltZXIoZHVlVGltZSwgc2NoZWR1bGVyKSB7XG4gICAgcmV0dXJuIG5ldyBUaW1lck9ic2VydmFibGUoZHVlVGltZSwgc2NoZWR1bGVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9ic2VydmFibGVUaW1lckRhdGVBbmRQZXJpb2QoZHVlVGltZSwgcGVyaW9kLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICB2YXIgZCA9IGR1ZVRpbWUsIHAgPSBub3JtYWxpemVUaW1lKHBlcmlvZCk7XG4gICAgICByZXR1cm4gc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlKDAsIGQsIGZ1bmN0aW9uIChjb3VudCwgc2VsZikge1xuICAgICAgICBpZiAocCA+IDApIHtcbiAgICAgICAgICB2YXIgbm93ID0gc2NoZWR1bGVyLm5vdygpO1xuICAgICAgICAgIGQgPSBuZXcgRGF0ZShkLmdldFRpbWUoKSArIHApO1xuICAgICAgICAgIGQuZ2V0VGltZSgpIDw9IG5vdyAmJiAoZCA9IG5ldyBEYXRlKG5vdyArIHApKTtcbiAgICAgICAgfVxuICAgICAgICBvYnNlcnZlci5vbk5leHQoY291bnQpO1xuICAgICAgICBzZWxmKGNvdW50ICsgMSwgbmV3IERhdGUoZCkpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZChkdWVUaW1lLCBwZXJpb2QsIHNjaGVkdWxlcikge1xuICAgIHJldHVybiBkdWVUaW1lID09PSBwZXJpb2QgP1xuICAgICAgbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG9ic2VydmVyKSB7XG4gICAgICAgIHJldHVybiBzY2hlZHVsZXIuc2NoZWR1bGVQZXJpb2RpYygwLCBwZXJpb2QsIGZ1bmN0aW9uIChjb3VudCkge1xuICAgICAgICAgIG9ic2VydmVyLm9uTmV4dChjb3VudCk7XG4gICAgICAgICAgcmV0dXJuIGNvdW50ICsgMTtcbiAgICAgICAgfSk7XG4gICAgICB9KSA6XG4gICAgICBvYnNlcnZhYmxlRGVmZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZChuZXcgRGF0ZShzY2hlZHVsZXIubm93KCkgKyBkdWVUaW1lKSwgcGVyaW9kLCBzY2hlZHVsZXIpO1xuICAgICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZWFjaCBwZXJpb2QuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqICAxIC0gcmVzID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDAwKTtcbiAgICogIDIgLSByZXMgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMDAsIFJ4LlNjaGVkdWxlci50aW1lb3V0KTtcbiAgICpcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHBlcmlvZCBQZXJpb2QgZm9yIHByb2R1Y2luZyB0aGUgdmFsdWVzIGluIHRoZSByZXN1bHRpbmcgc2VxdWVuY2UgKHNwZWNpZmllZCBhcyBhbiBpbnRlZ2VyIGRlbm90aW5nIG1pbGxpc2Vjb25kcykuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSBTY2hlZHVsZXIgdG8gcnVuIHRoZSB0aW1lciBvbi4gSWYgbm90IHNwZWNpZmllZCwgUnguU2NoZWR1bGVyLnRpbWVvdXQgaXMgdXNlZC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2UgdGhhdCBwcm9kdWNlcyBhIHZhbHVlIGFmdGVyIGVhY2ggcGVyaW9kLlxuICAgKi9cbiAgdmFyIG9ic2VydmFibGVpbnRlcnZhbCA9IE9ic2VydmFibGUuaW50ZXJ2YWwgPSBmdW5jdGlvbiAocGVyaW9kLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyVGltZVNwYW5BbmRQZXJpb2QocGVyaW9kLCBwZXJpb2QsIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgPyBzY2hlZHVsZXIgOiBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgfTtcblxuICAvKipcbiAgICogIFJldHVybnMgYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZHVlVGltZSBoYXMgZWxhcHNlZCBhbmQgdGhlbiBhZnRlciBlYWNoIHBlcmlvZC5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IGR1ZVRpbWUgQWJzb2x1dGUgKHNwZWNpZmllZCBhcyBhIERhdGUgb2JqZWN0KSBvciByZWxhdGl2ZSB0aW1lIChzcGVjaWZpZWQgYXMgYW4gaW50ZWdlciBkZW5vdGluZyBtaWxsaXNlY29uZHMpIGF0IHdoaWNoIHRvIHByb2R1Y2UgdGhlIGZpcnN0IHZhbHVlLlxuICAgKiBAcGFyYW0ge01peGVkfSBbcGVyaW9kT3JTY2hlZHVsZXJdICBQZXJpb2QgdG8gcHJvZHVjZSBzdWJzZXF1ZW50IHZhbHVlcyAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSwgb3IgdGhlIHNjaGVkdWxlciB0byBydW4gdGhlIHRpbWVyIG9uLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgcmVzdWx0aW5nIHRpbWVyIGlzIG5vdCByZWN1cnJpbmcuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHRvIHJ1biB0aGUgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB0aW1lb3V0IHNjaGVkdWxlciBpcyB1c2VkLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSB0aGF0IHByb2R1Y2VzIGEgdmFsdWUgYWZ0ZXIgZHVlIHRpbWUgaGFzIGVsYXBzZWQgYW5kIHRoZW4gZWFjaCBwZXJpb2QuXG4gICAqL1xuICB2YXIgb2JzZXJ2YWJsZVRpbWVyID0gT2JzZXJ2YWJsZS50aW1lciA9IGZ1bmN0aW9uIChkdWVUaW1lLCBwZXJpb2RPclNjaGVkdWxlciwgc2NoZWR1bGVyKSB7XG4gICAgdmFyIHBlcmlvZDtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICBpZiAocGVyaW9kT3JTY2hlZHVsZXIgIT0gbnVsbCAmJiB0eXBlb2YgcGVyaW9kT3JTY2hlZHVsZXIgPT09ICdudW1iZXInKSB7XG4gICAgICBwZXJpb2QgPSBwZXJpb2RPclNjaGVkdWxlcjtcbiAgICB9IGVsc2UgaWYgKGlzU2NoZWR1bGVyKHBlcmlvZE9yU2NoZWR1bGVyKSkge1xuICAgICAgc2NoZWR1bGVyID0gcGVyaW9kT3JTY2hlZHVsZXI7XG4gICAgfVxuICAgIGlmICgoZHVlVGltZSBpbnN0YW5jZW9mIERhdGUgfHwgdHlwZW9mIGR1ZVRpbWUgPT09ICdudW1iZXInKSAmJiBwZXJpb2QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIF9vYnNlcnZhYmxlVGltZXIoZHVlVGltZSwgc2NoZWR1bGVyKTtcbiAgICB9XG4gICAgaWYgKGR1ZVRpbWUgaW5zdGFuY2VvZiBEYXRlICYmIHBlcmlvZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gb2JzZXJ2YWJsZVRpbWVyRGF0ZUFuZFBlcmlvZChkdWVUaW1lLmdldFRpbWUoKSwgcGVyaW9kT3JTY2hlZHVsZXIsIHNjaGVkdWxlcik7XG4gICAgfVxuICAgIHJldHVybiBvYnNlcnZhYmxlVGltZXJUaW1lU3BhbkFuZFBlcmlvZChkdWVUaW1lLCBwZXJpb2QsIHNjaGVkdWxlcik7XG4gIH07XG5cbiAgZnVuY3Rpb24gb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUoc291cmNlLCBkdWVUaW1lLCBzY2hlZHVsZXIpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBhY3RpdmUgPSBmYWxzZSxcbiAgICAgICAgY2FuY2VsYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG4gICAgICAgIGV4Y2VwdGlvbiA9IG51bGwsXG4gICAgICAgIHEgPSBbXSxcbiAgICAgICAgcnVubmluZyA9IGZhbHNlLFxuICAgICAgICBzdWJzY3JpcHRpb247XG4gICAgICBzdWJzY3JpcHRpb24gPSBzb3VyY2UubWF0ZXJpYWxpemUoKS50aW1lc3RhbXAoc2NoZWR1bGVyKS5zdWJzY3JpYmUoZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICB2YXIgZCwgc2hvdWxkUnVuO1xuICAgICAgICBpZiAobm90aWZpY2F0aW9uLnZhbHVlLmtpbmQgPT09ICdFJykge1xuICAgICAgICAgIHEgPSBbXTtcbiAgICAgICAgICBxLnB1c2gobm90aWZpY2F0aW9uKTtcbiAgICAgICAgICBleGNlcHRpb24gPSBub3RpZmljYXRpb24udmFsdWUuZXJyb3I7XG4gICAgICAgICAgc2hvdWxkUnVuID0gIXJ1bm5pbmc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcS5wdXNoKHsgdmFsdWU6IG5vdGlmaWNhdGlvbi52YWx1ZSwgdGltZXN0YW1wOiBub3RpZmljYXRpb24udGltZXN0YW1wICsgZHVlVGltZSB9KTtcbiAgICAgICAgICBzaG91bGRSdW4gPSAhYWN0aXZlO1xuICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNob3VsZFJ1bikge1xuICAgICAgICAgIGlmIChleGNlcHRpb24gIT09IG51bGwpIHtcbiAgICAgICAgICAgIG8ub25FcnJvcihleGNlcHRpb24pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgICAgICAgICBjYW5jZWxhYmxlLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICAgICAgICBkLnNldERpc3Bvc2FibGUoc2NoZWR1bGVyLnNjaGVkdWxlUmVjdXJzaXZlRnV0dXJlKG51bGwsIGR1ZVRpbWUsIGZ1bmN0aW9uIChfLCBzZWxmKSB7XG4gICAgICAgICAgICAgIHZhciBlLCByZWN1cnNlRHVlVGltZSwgcmVzdWx0LCBzaG91bGRSZWN1cnNlO1xuICAgICAgICAgICAgICBpZiAoZXhjZXB0aW9uICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAocS5sZW5ndGggPiAwICYmIHFbMF0udGltZXN0YW1wIC0gc2NoZWR1bGVyLm5vdygpIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHEuc2hpZnQoKS52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgcmVzdWx0LmFjY2VwdChvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gd2hpbGUgKHJlc3VsdCAhPT0gbnVsbCk7XG4gICAgICAgICAgICAgIHNob3VsZFJlY3Vyc2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgcmVjdXJzZUR1ZVRpbWUgPSAwO1xuICAgICAgICAgICAgICBpZiAocS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgc2hvdWxkUmVjdXJzZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVjdXJzZUR1ZVRpbWUgPSBNYXRoLm1heCgwLCBxWzBdLnRpbWVzdGFtcCAtIHNjaGVkdWxlci5ub3coKSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgZSA9IGV4Y2VwdGlvbjtcbiAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICBpZiAoZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG8ub25FcnJvcihlKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChzaG91bGRSZWN1cnNlKSB7XG4gICAgICAgICAgICAgICAgc2VsZihudWxsLCByZWN1cnNlRHVlVGltZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKHN1YnNjcmlwdGlvbiwgY2FuY2VsYWJsZSk7XG4gICAgfSwgc291cmNlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9ic2VydmFibGVEZWxheUFic29sdXRlKHNvdXJjZSwgZHVlVGltZSwgc2NoZWR1bGVyKSB7XG4gICAgcmV0dXJuIG9ic2VydmFibGVEZWZlcihmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUoc291cmNlLCBkdWVUaW1lIC0gc2NoZWR1bGVyLm5vdygpLCBzY2hlZHVsZXIpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gZGVsYXlXaXRoU2VsZWN0b3Ioc291cmNlLCBzdWJzY3JpcHRpb25EZWxheSwgZGVsYXlEdXJhdGlvblNlbGVjdG9yKSB7XG4gICAgdmFyIHN1YkRlbGF5LCBzZWxlY3RvcjtcbiAgICBpZiAoaXNGdW5jdGlvbihzdWJzY3JpcHRpb25EZWxheSkpIHtcbiAgICAgIHNlbGVjdG9yID0gc3Vic2NyaXB0aW9uRGVsYXk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1YkRlbGF5ID0gc3Vic2NyaXB0aW9uRGVsYXk7XG4gICAgICBzZWxlY3RvciA9IGRlbGF5RHVyYXRpb25TZWxlY3RvcjtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgZGVsYXlzID0gbmV3IENvbXBvc2l0ZURpc3Bvc2FibGUoKSwgYXRFbmQgPSBmYWxzZSwgc3Vic2NyaXB0aW9uID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcblxuICAgICAgZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoXG4gICAgICAgICAgZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIHZhciBkZWxheSA9IHRyeUNhdGNoKHNlbGVjdG9yKSh4KTtcbiAgICAgICAgICAgIGlmIChkZWxheSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihkZWxheS5lKTsgfVxuICAgICAgICAgICAgdmFyIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgICAgIGRlbGF5cy5hZGQoZCk7XG4gICAgICAgICAgICBkLnNldERpc3Bvc2FibGUoZGVsYXkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgby5vbk5leHQoeCk7XG4gICAgICAgICAgICAgICAgZGVsYXlzLnJlbW92ZShkKTtcbiAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG8ub25OZXh0KHgpO1xuICAgICAgICAgICAgICAgIGRlbGF5cy5yZW1vdmUoZCk7XG4gICAgICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBhdEVuZCA9IHRydWU7XG4gICAgICAgICAgICBzdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGRvbmUgKCkge1xuICAgICAgICBhdEVuZCAmJiBkZWxheXMubGVuZ3RoID09PSAwICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFzdWJEZWxheSkge1xuICAgICAgICBzdGFydCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoc3ViRGVsYXkuc3Vic2NyaWJlKHN0YXJ0LCBmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIHN0YXJ0KSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGRlbGF5cyk7XG4gICAgfSwgdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogIFRpbWUgc2hpZnRzIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIGJ5IGR1ZVRpbWUuXG4gICAqICBUaGUgcmVsYXRpdmUgdGltZSBpbnRlcnZhbHMgYmV0d2VlbiB0aGUgdmFsdWVzIGFyZSBwcmVzZXJ2ZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBkdWVUaW1lIEFic29sdXRlIChzcGVjaWZpZWQgYXMgYSBEYXRlIG9iamVjdCkgb3IgcmVsYXRpdmUgdGltZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSBieSB3aGljaCB0byBzaGlmdCB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZS5cbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0byBydW4gdGhlIGRlbGF5IHRpbWVycyBvbi4gSWYgbm90IHNwZWNpZmllZCwgdGhlIHRpbWVvdXQgc2NoZWR1bGVyIGlzIHVzZWQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBUaW1lLXNoaWZ0ZWQgc2VxdWVuY2UuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8uZGVsYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGZpcnN0QXJnID0gYXJndW1lbnRzWzBdO1xuICAgIGlmICh0eXBlb2YgZmlyc3RBcmcgPT09ICdudW1iZXInIHx8IGZpcnN0QXJnIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgdmFyIGR1ZVRpbWUgPSBmaXJzdEFyZywgc2NoZWR1bGVyID0gYXJndW1lbnRzWzFdO1xuICAgICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG4gICAgICByZXR1cm4gZHVlVGltZSBpbnN0YW5jZW9mIERhdGUgP1xuICAgICAgICBvYnNlcnZhYmxlRGVsYXlBYnNvbHV0ZSh0aGlzLCBkdWVUaW1lLCBzY2hlZHVsZXIpIDpcbiAgICAgICAgb2JzZXJ2YWJsZURlbGF5UmVsYXRpdmUodGhpcywgZHVlVGltZSwgc2NoZWR1bGVyKTtcbiAgICB9IGVsc2UgaWYgKE9ic2VydmFibGUuaXNPYnNlcnZhYmxlKGZpcnN0QXJnKSB8fCBpc0Z1bmN0aW9uKGZpcnN0QXJnKSkge1xuICAgICAgcmV0dXJuIGRlbGF5V2l0aFNlbGVjdG9yKHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgYXJndW1lbnRzJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBEZWJvdW5jZU9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKERlYm91bmNlT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBEZWJvdW5jZU9ic2VydmFibGUoc291cmNlLCBkdCwgcykge1xuICAgICAgaXNTY2hlZHVsZXIocykgfHwgKHMgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5fZHQgPSBkdDtcbiAgICAgIHRoaXMuX3MgPSBzO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgRGVib3VuY2VPYnNlcnZhYmxlLnByb3RvdHlwZS5zdWJzY3JpYmVDb3JlID0gZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBjYW5jZWxhYmxlID0gbmV3IFNlcmlhbERpc3Bvc2FibGUoKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShcbiAgICAgICAgdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG5ldyBEZWJvdW5jZU9ic2VydmVyKG8sIHRoaXMuc291cmNlLCB0aGlzLl9kdCwgdGhpcy5fcywgY2FuY2VsYWJsZSkpLFxuICAgICAgICBjYW5jZWxhYmxlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIERlYm91bmNlT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBEZWJvdW5jZU9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhEZWJvdW5jZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIERlYm91bmNlT2JzZXJ2ZXIob2JzZXJ2ZXIsIHNvdXJjZSwgZHVlVGltZSwgc2NoZWR1bGVyLCBjYW5jZWxhYmxlKSB7XG4gICAgICB0aGlzLl9vID0gb2JzZXJ2ZXI7XG4gICAgICB0aGlzLl9zID0gc291cmNlO1xuICAgICAgdGhpcy5fZCA9IGR1ZVRpbWU7XG4gICAgICB0aGlzLl9zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG4gICAgICB0aGlzLl9jID0gY2FuY2VsYWJsZTtcbiAgICAgIHRoaXMuX3YgPSBudWxsO1xuICAgICAgdGhpcy5faHYgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2lkID0gMDtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIERlYm91bmNlT2JzZXJ2ZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgdGhpcy5faHYgPSB0cnVlO1xuICAgICAgdGhpcy5fdiA9IHg7XG4gICAgICB2YXIgY3VycmVudElkID0gKyt0aGlzLl9pZCwgZCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgdGhpcy5fYy5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgZC5zZXREaXNwb3NhYmxlKHRoaXMuX3NjaGVkdWxlci5zY2hlZHVsZUZ1dHVyZSh0aGlzLCB0aGlzLl9kLCBmdW5jdGlvbiAoXywgc2VsZikge1xuICAgICAgICBzZWxmLl9odiAmJiBzZWxmLl9pZCA9PT0gY3VycmVudElkICYmIHNlbGYuX28ub25OZXh0KHgpO1xuICAgICAgICBzZWxmLl9odiA9IGZhbHNlO1xuICAgICAgfSkpO1xuICAgIH07XG5cbiAgICBEZWJvdW5jZU9ic2VydmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9jLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICAgIHRoaXMuX2h2ID0gZmFsc2U7XG4gICAgICB0aGlzLl9pZCsrO1xuICAgIH07XG5cbiAgICBEZWJvdW5jZU9ic2VydmVyLnByb3RvdHlwZS5jb21wbGV0ZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9jLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMuX2h2ICYmIHRoaXMuX28ub25OZXh0KHRoaXMuX3YpO1xuICAgICAgdGhpcy5fby5vbkNvbXBsZXRlZCgpO1xuICAgICAgdGhpcy5faHYgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2lkKys7XG4gICAgfTtcblxuICAgIHJldHVybiBEZWJvdW5jZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICBmdW5jdGlvbiBkZWJvdW5jZVdpdGhTZWxlY3Rvcihzb3VyY2UsIGR1cmF0aW9uU2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciB2YWx1ZSwgaGFzVmFsdWUgPSBmYWxzZSwgY2FuY2VsYWJsZSA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksIGlkID0gMDtcbiAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgICBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgIHZhciB0aHJvdHRsZSA9IHRyeUNhdGNoKGR1cmF0aW9uU2VsZWN0b3IpKHgpO1xuICAgICAgICAgIGlmICh0aHJvdHRsZSA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcih0aHJvdHRsZS5lKTsgfVxuXG4gICAgICAgICAgaXNQcm9taXNlKHRocm90dGxlKSAmJiAodGhyb3R0bGUgPSBvYnNlcnZhYmxlRnJvbVByb21pc2UodGhyb3R0bGUpKTtcblxuICAgICAgICAgIGhhc1ZhbHVlID0gdHJ1ZTtcbiAgICAgICAgICB2YWx1ZSA9IHg7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgICB2YXIgY3VycmVudGlkID0gaWQsIGQgPSBuZXcgU2luZ2xlQXNzaWdubWVudERpc3Bvc2FibGUoKTtcbiAgICAgICAgICBjYW5jZWxhYmxlLnNldERpc3Bvc2FibGUoZCk7XG4gICAgICAgICAgZC5zZXREaXNwb3NhYmxlKHRocm90dGxlLnN1YnNjcmliZShcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgaGFzVmFsdWUgJiYgaWQgPT09IGN1cnJlbnRpZCAmJiBvLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgICAgIGQuZGlzcG9zZSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgaGFzVmFsdWUgJiYgaWQgPT09IGN1cnJlbnRpZCAmJiBvLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgICAgIGQuZGlzcG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICkpO1xuICAgICAgICB9LFxuICAgICAgICBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGNhbmNlbGFibGUuZGlzcG9zZSgpO1xuICAgICAgICAgIG8ub25FcnJvcihlKTtcbiAgICAgICAgICBoYXNWYWx1ZSA9IGZhbHNlO1xuICAgICAgICAgIGlkKys7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjYW5jZWxhYmxlLmRpc3Bvc2UoKTtcbiAgICAgICAgICBoYXNWYWx1ZSAmJiBvLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIGNhbmNlbGFibGUpO1xuICAgIH0sIHNvdXJjZSk7XG4gIH1cblxuICBvYnNlcnZhYmxlUHJvdG8uZGVib3VuY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24gKGFyZ3VtZW50c1swXSkpIHtcbiAgICAgIHJldHVybiBkZWJvdW5jZVdpdGhTZWxlY3Rvcih0aGlzLCBhcmd1bWVudHNbMF0pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50c1swXSA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiBuZXcgRGVib3VuY2VPYnNlcnZhYmxlKHRoaXMsIGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50cycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgVGltZXN0YW1wT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGltZXN0YW1wT2JzZXJ2YWJsZSwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBUaW1lc3RhbXBPYnNlcnZhYmxlKHNvdXJjZSwgcykge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRpbWVzdGFtcE9ic2VydmFibGUucHJvdG90eXBlLnN1YnNjcmliZUNvcmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgcmV0dXJuIHRoaXMuc291cmNlLnN1YnNjcmliZShuZXcgVGltZXN0YW1wT2JzZXJ2ZXIobywgdGhpcy5fcykpO1xuICAgIH07XG5cbiAgICByZXR1cm4gVGltZXN0YW1wT2JzZXJ2YWJsZTtcbiAgfShPYnNlcnZhYmxlQmFzZSkpO1xuXG4gIHZhciBUaW1lc3RhbXBPYnNlcnZlciA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoVGltZXN0YW1wT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gVGltZXN0YW1wT2JzZXJ2ZXIobywgcykge1xuICAgICAgdGhpcy5fbyA9IG87XG4gICAgICB0aGlzLl9zID0gcztcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgIH1cblxuICAgIFRpbWVzdGFtcE9ic2VydmVyLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgIHRoaXMuX28ub25OZXh0KHsgdmFsdWU6IHgsIHRpbWVzdGFtcDogdGhpcy5fcy5ub3coKSB9KTtcbiAgICB9O1xuXG4gICAgVGltZXN0YW1wT2JzZXJ2ZXIucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIHRoaXMuX28ub25FcnJvcihlKTtcbiAgICB9O1xuXG4gICAgVGltZXN0YW1wT2JzZXJ2ZXIucHJvdG90eXBlLmNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuX28ub25Db21wbGV0ZWQoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRpbWVzdGFtcE9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICAvKipcbiAgICogIFJlY29yZHMgdGhlIHRpbWVzdGFtcCBmb3IgZWFjaCB2YWx1ZSBpbiBhbiBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAgMSAtIHJlcyA9IHNvdXJjZS50aW1lc3RhbXAoKTsgLy8gcHJvZHVjZXMgeyB2YWx1ZTogeCwgdGltZXN0YW1wOiB0cyB9XG4gICAqICAyIC0gcmVzID0gc291cmNlLnRpbWVzdGFtcChSeC5TY2hlZHVsZXIuZGVmYXVsdCk7XG4gICAqXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHVzZWQgdG8gY29tcHV0ZSB0aW1lc3RhbXBzLiBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgZGVmYXVsdCBzY2hlZHVsZXIgaXMgdXNlZC5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IEFuIG9ic2VydmFibGUgc2VxdWVuY2Ugd2l0aCB0aW1lc3RhbXAgaW5mb3JtYXRpb24gb24gdmFsdWVzLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnRpbWVzdGFtcCA9IGZ1bmN0aW9uIChzY2hlZHVsZXIpIHtcbiAgICBpc1NjaGVkdWxlcihzY2hlZHVsZXIpIHx8IChzY2hlZHVsZXIgPSBkZWZhdWx0U2NoZWR1bGVyKTtcbiAgICByZXR1cm4gbmV3IFRpbWVzdGFtcE9ic2VydmFibGUodGhpcywgc2NoZWR1bGVyKTtcbiAgfTtcblxuICBmdW5jdGlvbiBzYW1wbGVPYnNlcnZhYmxlKHNvdXJjZSwgc2FtcGxlcikge1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGF0RW5kID0gZmFsc2UsIHZhbHVlLCBoYXNWYWx1ZSA9IGZhbHNlO1xuXG4gICAgICBmdW5jdGlvbiBzYW1wbGVTdWJzY3JpYmUoKSB7XG4gICAgICAgIGlmIChoYXNWYWx1ZSkge1xuICAgICAgICAgIGhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgby5vbk5leHQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGF0RW5kICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH1cblxuICAgICAgdmFyIHNvdXJjZVN1YnNjcmlwdGlvbiA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpO1xuICAgICAgc291cmNlU3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShcbiAgICAgICAgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgaGFzVmFsdWUgPSB0cnVlO1xuICAgICAgICAgIHZhbHVlID0gbmV3VmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGZ1bmN0aW9uIChlKSB7IG8ub25FcnJvcihlKTsgfSxcbiAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGF0RW5kID0gdHJ1ZTtcbiAgICAgICAgICBzb3VyY2VTdWJzY3JpcHRpb24uZGlzcG9zZSgpO1xuICAgICAgICB9XG4gICAgICApKTtcblxuICAgICAgcmV0dXJuIG5ldyBCaW5hcnlEaXNwb3NhYmxlKFxuICAgICAgICBzb3VyY2VTdWJzY3JpcHRpb24sXG4gICAgICAgIHNhbXBsZXIuc3Vic2NyaWJlKHNhbXBsZVN1YnNjcmliZSwgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LCBzYW1wbGVTdWJzY3JpYmUpXG4gICAgICApO1xuICAgIH0sIHNvdXJjZSk7XG4gIH1cblxuICAvKipcbiAgICogIFNhbXBsZXMgdGhlIG9ic2VydmFibGUgc2VxdWVuY2UgYXQgZWFjaCBpbnRlcnZhbC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogIDEgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKHNhbXBsZU9ic2VydmFibGUpOyAvLyBTYW1wbGVyIHRpY2sgc2VxdWVuY2VcbiAgICogIDIgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKDUwMDApOyAvLyA1IHNlY29uZHNcbiAgICogIDIgLSByZXMgPSBzb3VyY2Uuc2FtcGxlKDUwMDAsIFJ4LlNjaGVkdWxlci50aW1lb3V0KTsgLy8gNSBzZWNvbmRzXG4gICAqXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGludGVydmFsT3JTYW1wbGVyIEludGVydmFsIGF0IHdoaWNoIHRvIHNhbXBsZSAoc3BlY2lmaWVkIGFzIGFuIGludGVnZXIgZGVub3RpbmcgbWlsbGlzZWNvbmRzKSBvciBTYW1wbGVyIE9ic2VydmFibGUuXG4gICAqIEBwYXJhbSB7U2NoZWR1bGVyfSBbc2NoZWR1bGVyXSAgU2NoZWR1bGVyIHRvIHJ1biB0aGUgc2FtcGxpbmcgdGltZXIgb24uIElmIG5vdCBzcGVjaWZpZWQsIHRoZSB0aW1lb3V0IHNjaGVkdWxlciBpcyB1c2VkLlxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gU2FtcGxlZCBvYnNlcnZhYmxlIHNlcXVlbmNlLlxuICAgKi9cbiAgb2JzZXJ2YWJsZVByb3RvLnNhbXBsZSA9IG9ic2VydmFibGVQcm90by50aHJvdHRsZUxhdGVzdCA9IGZ1bmN0aW9uIChpbnRlcnZhbE9yU2FtcGxlciwgc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG4gICAgcmV0dXJuIHR5cGVvZiBpbnRlcnZhbE9yU2FtcGxlciA9PT0gJ251bWJlcicgP1xuICAgICAgc2FtcGxlT2JzZXJ2YWJsZSh0aGlzLCBvYnNlcnZhYmxlaW50ZXJ2YWwoaW50ZXJ2YWxPclNhbXBsZXIsIHNjaGVkdWxlcikpIDpcbiAgICAgIHNhbXBsZU9ic2VydmFibGUodGhpcywgaW50ZXJ2YWxPclNhbXBsZXIpO1xuICB9O1xuXG4gIHZhciBUaW1lb3V0RXJyb3IgPSBSeC5UaW1lb3V0RXJyb3IgPSBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZSB8fCAnVGltZW91dCBoYXMgb2NjdXJyZWQnO1xuICAgIHRoaXMubmFtZSA9ICdUaW1lb3V0RXJyb3InO1xuICAgIEVycm9yLmNhbGwodGhpcyk7XG4gIH07XG4gIFRpbWVvdXRFcnJvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSk7XG5cbiAgZnVuY3Rpb24gdGltZW91dFdpdGhTZWxlY3Rvcihzb3VyY2UsIGZpcnN0VGltZW91dCwgdGltZW91dER1cmF0aW9uU2VsZWN0b3IsIG90aGVyKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24oZmlyc3RUaW1lb3V0KSkge1xuICAgICAgb3RoZXIgPSB0aW1lb3V0RHVyYXRpb25TZWxlY3RvcjtcbiAgICAgIHRpbWVvdXREdXJhdGlvblNlbGVjdG9yID0gZmlyc3RUaW1lb3V0O1xuICAgICAgZmlyc3RUaW1lb3V0ID0gb2JzZXJ2YWJsZU5ldmVyKCk7XG4gICAgfVxuICAgIG90aGVyIHx8IChvdGhlciA9IG9ic2VydmFibGVUaHJvdyhuZXcgVGltZW91dEVycm9yKCkpKTtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLFxuICAgICAgICB0aW1lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCksXG4gICAgICAgIG9yaWdpbmFsID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cbiAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG9yaWdpbmFsKTtcblxuICAgICAgdmFyIGlkID0gMCwgc3dpdGNoZWQgPSBmYWxzZTtcblxuICAgICAgZnVuY3Rpb24gc2V0VGltZXIodGltZW91dCkge1xuICAgICAgICB2YXIgbXlJZCA9IGlkLCBkID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG5cbiAgICAgICAgZnVuY3Rpb24gdGltZXJXaW5zKCkge1xuICAgICAgICAgIHN3aXRjaGVkID0gKG15SWQgPT09IGlkKTtcbiAgICAgICAgICByZXR1cm4gc3dpdGNoZWQ7XG4gICAgICAgIH1cblxuICAgICAgICB0aW1lci5zZXREaXNwb3NhYmxlKGQpO1xuICAgICAgICBkLnNldERpc3Bvc2FibGUodGltZW91dC5zdWJzY3JpYmUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRpbWVyV2lucygpICYmIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG90aGVyLnN1YnNjcmliZShvKSk7XG4gICAgICAgICAgZC5kaXNwb3NlKCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgdGltZXJXaW5zKCkgJiYgby5vbkVycm9yKGUpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGltZXJXaW5zKCkgJiYgc3Vic2NyaXB0aW9uLnNldERpc3Bvc2FibGUob3RoZXIuc3Vic2NyaWJlKG8pKTtcbiAgICAgICAgfSkpO1xuICAgICAgfTtcblxuICAgICAgc2V0VGltZXIoZmlyc3RUaW1lb3V0KTtcblxuICAgICAgZnVuY3Rpb24gb1dpbnMoKSB7XG4gICAgICAgIHZhciByZXMgPSAhc3dpdGNoZWQ7XG4gICAgICAgIGlmIChyZXMpIHsgaWQrKzsgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgfVxuXG4gICAgICBvcmlnaW5hbC5zZXREaXNwb3NhYmxlKHNvdXJjZS5zdWJzY3JpYmUoZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgaWYgKG9XaW5zKCkpIHtcbiAgICAgICAgICBvLm9uTmV4dCh4KTtcbiAgICAgICAgICB2YXIgdGltZW91dCA9IHRyeUNhdGNoKHRpbWVvdXREdXJhdGlvblNlbGVjdG9yKSh4KTtcbiAgICAgICAgICBpZiAodGltZW91dCA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcih0aW1lb3V0LmUpOyB9XG4gICAgICAgICAgc2V0VGltZXIoaXNQcm9taXNlKHRpbWVvdXQpID8gb2JzZXJ2YWJsZUZyb21Qcm9taXNlKHRpbWVvdXQpIDogdGltZW91dCk7XG4gICAgICAgIH1cbiAgICAgIH0sIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIG9XaW5zKCkgJiYgby5vbkVycm9yKGUpO1xuICAgICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBvV2lucygpICYmIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgIH0pKTtcbiAgICAgIHJldHVybiBuZXcgQmluYXJ5RGlzcG9zYWJsZShzdWJzY3JpcHRpb24sIHRpbWVyKTtcbiAgICB9LCBzb3VyY2UpO1xuICB9XG5cbiAgZnVuY3Rpb24gdGltZW91dChzb3VyY2UsIGR1ZVRpbWUsIG90aGVyLCBzY2hlZHVsZXIpIHtcbiAgICBpZiAoaXNTY2hlZHVsZXIob3RoZXIpKSB7XG4gICAgICBzY2hlZHVsZXIgPSBvdGhlcjtcbiAgICAgIG90aGVyID0gb2JzZXJ2YWJsZVRocm93KG5ldyBUaW1lb3V0RXJyb3IoKSk7XG4gICAgfVxuICAgIGlmIChvdGhlciBpbnN0YW5jZW9mIEVycm9yKSB7IG90aGVyID0gb2JzZXJ2YWJsZVRocm93KG90aGVyKTsgfVxuICAgIGlzU2NoZWR1bGVyKHNjaGVkdWxlcikgfHwgKHNjaGVkdWxlciA9IGRlZmF1bHRTY2hlZHVsZXIpO1xuXG4gICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNPYnNlcnZhYmxlKGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgaWQgPSAwLFxuICAgICAgICBvcmlnaW5hbCA9IG5ldyBTaW5nbGVBc3NpZ25tZW50RGlzcG9zYWJsZSgpLFxuICAgICAgICBzdWJzY3JpcHRpb24gPSBuZXcgU2VyaWFsRGlzcG9zYWJsZSgpLFxuICAgICAgICBzd2l0Y2hlZCA9IGZhbHNlLFxuICAgICAgICB0aW1lciA9IG5ldyBTZXJpYWxEaXNwb3NhYmxlKCk7XG5cbiAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG9yaWdpbmFsKTtcblxuICAgICAgZnVuY3Rpb24gY3JlYXRlVGltZXIoKSB7XG4gICAgICAgIHZhciBteUlkID0gaWQ7XG4gICAgICAgIHRpbWVyLnNldERpc3Bvc2FibGUoc2NoZWR1bGVyLnNjaGVkdWxlRnV0dXJlKG51bGwsIGR1ZVRpbWUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBzd2l0Y2hlZCA9IGlkID09PSBteUlkO1xuICAgICAgICAgIGlmIChzd2l0Y2hlZCkge1xuICAgICAgICAgICAgaXNQcm9taXNlKG90aGVyKSAmJiAob3RoZXIgPSBvYnNlcnZhYmxlRnJvbVByb21pc2Uob3RoZXIpKTtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5zZXREaXNwb3NhYmxlKG90aGVyLnN1YnNjcmliZShvKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICB9XG5cbiAgICAgIGNyZWF0ZVRpbWVyKCk7XG5cbiAgICAgIG9yaWdpbmFsLnNldERpc3Bvc2FibGUoc291cmNlLnN1YnNjcmliZShmdW5jdGlvbiAoeCkge1xuICAgICAgICBpZiAoIXN3aXRjaGVkKSB7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgICBvLm9uTmV4dCh4KTtcbiAgICAgICAgICBjcmVhdGVUaW1lcigpO1xuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBpZiAoIXN3aXRjaGVkKSB7XG4gICAgICAgICAgaWQrKztcbiAgICAgICAgICBvLm9uRXJyb3IoZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCFzd2l0Y2hlZCkge1xuICAgICAgICAgIGlkKys7XG4gICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG4gICAgICB9KSk7XG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoc3Vic2NyaXB0aW9uLCB0aW1lcik7XG4gICAgfSwgc291cmNlKTtcbiAgfVxuXG4gIG9ic2VydmFibGVQcm90by50aW1lb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBmaXJzdEFyZyA9IGFyZ3VtZW50c1swXTtcbiAgICBpZiAoZmlyc3RBcmcgaW5zdGFuY2VvZiBEYXRlIHx8IHR5cGVvZiBmaXJzdEFyZyA9PT0gJ251bWJlcicpIHtcbiAgICAgIHJldHVybiB0aW1lb3V0KHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7XG4gICAgfSBlbHNlIGlmIChPYnNlcnZhYmxlLmlzT2JzZXJ2YWJsZShmaXJzdEFyZykgfHwgaXNGdW5jdGlvbihmaXJzdEFyZykpIHtcbiAgICAgIHJldHVybiB0aW1lb3V0V2l0aFNlbGVjdG9yKHRoaXMsIGZpcnN0QXJnLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBhcmd1bWVudHMnKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4gT2JzZXJ2YWJsZSB0aGF0IGVtaXRzIG9ubHkgdGhlIGZpcnN0IGl0ZW0gZW1pdHRlZCBieSB0aGUgc291cmNlIE9ic2VydmFibGUgZHVyaW5nIHNlcXVlbnRpYWwgdGltZSB3aW5kb3dzIG9mIGEgc3BlY2lmaWVkIGR1cmF0aW9uLlxuICAgKiBAcGFyYW0ge051bWJlcn0gd2luZG93RHVyYXRpb24gdGltZSB0byB3YWl0IGJlZm9yZSBlbWl0dGluZyBhbm90aGVyIGl0ZW0gYWZ0ZXIgZW1pdHRpbmcgdGhlIGxhc3QgaXRlbVxuICAgKiBAcGFyYW0ge1NjaGVkdWxlcn0gW3NjaGVkdWxlcl0gdGhlIFNjaGVkdWxlciB0byB1c2UgaW50ZXJuYWxseSB0byBtYW5hZ2UgdGhlIHRpbWVycyB0aGF0IGhhbmRsZSB0aW1lb3V0IGZvciBlYWNoIGl0ZW0uIElmIG5vdCBwcm92aWRlZCwgZGVmYXVsdHMgdG8gU2NoZWR1bGVyLnRpbWVvdXQuXG4gICAqIEByZXR1cm5zIHtPYnNlcnZhYmxlfSBBbiBPYnNlcnZhYmxlIHRoYXQgcGVyZm9ybXMgdGhlIHRocm90dGxlIG9wZXJhdGlvbi5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by50aHJvdHRsZSA9IGZ1bmN0aW9uICh3aW5kb3dEdXJhdGlvbiwgc2NoZWR1bGVyKSB7XG4gICAgaXNTY2hlZHVsZXIoc2NoZWR1bGVyKSB8fCAoc2NoZWR1bGVyID0gZGVmYXVsdFNjaGVkdWxlcik7XG4gICAgdmFyIGR1cmF0aW9uID0gK3dpbmRvd0R1cmF0aW9uIHx8IDA7XG4gICAgaWYgKGR1cmF0aW9uIDw9IDApIHsgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ3dpbmRvd0R1cmF0aW9uIGNhbm5vdCBiZSBsZXNzIG9yIGVxdWFsIHplcm8uJyk7IH1cbiAgICB2YXIgc291cmNlID0gdGhpcztcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBsYXN0T25OZXh0ID0gMDtcbiAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgICBmdW5jdGlvbiAoeCkge1xuICAgICAgICAgIHZhciBub3cgPSBzY2hlZHVsZXIubm93KCk7XG4gICAgICAgICAgaWYgKGxhc3RPbk5leHQgPT09IDAgfHwgbm93IC0gbGFzdE9uTmV4dCA+PSBkdXJhdGlvbikge1xuICAgICAgICAgICAgbGFzdE9uTmV4dCA9IG5vdztcbiAgICAgICAgICAgIG8ub25OZXh0KHgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxmdW5jdGlvbiAoZSkgeyBvLm9uRXJyb3IoZSk7IH0sIGZ1bmN0aW9uICgpIHsgby5vbkNvbXBsZXRlZCgpOyB9XG4gICAgICApO1xuICAgIH0sIHNvdXJjZSk7XG4gIH07XG5cbiAgdmFyIFBhdXNhYmxlT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoUGF1c2FibGVPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFBhdXNhYmxlT2JzZXJ2YWJsZShzb3VyY2UsIHBhdXNlcikge1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2U7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIgPSBuZXcgU3ViamVjdCgpO1xuXG4gICAgICBpZiAocGF1c2VyICYmIHBhdXNlci5zdWJzY3JpYmUpIHtcbiAgICAgICAgdGhpcy5wYXVzZXIgPSB0aGlzLmNvbnRyb2xsZXIubWVyZ2UocGF1c2VyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyO1xuICAgICAgfVxuXG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBQYXVzYWJsZU9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIGNvbm4gPSB0aGlzLnNvdXJjZS5wdWJsaXNoKCksXG4gICAgICAgIHN1YnNjcmlwdGlvbiA9IGNvbm4uc3Vic2NyaWJlKG8pLFxuICAgICAgICBjb25uZWN0aW9uID0gZGlzcG9zYWJsZUVtcHR5O1xuXG4gICAgICB2YXIgcGF1c2FibGUgPSB0aGlzLnBhdXNlci5kaXN0aW5jdFVudGlsQ2hhbmdlZCgpLnN1YnNjcmliZShmdW5jdGlvbiAoYikge1xuICAgICAgICBpZiAoYikge1xuICAgICAgICAgIGNvbm5lY3Rpb24gPSBjb25uLmNvbm5lY3QoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25uZWN0aW9uLmRpc3Bvc2UoKTtcbiAgICAgICAgICBjb25uZWN0aW9uID0gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIG5ldyBOQXJ5RGlzcG9zYWJsZShbc3Vic2NyaXB0aW9uLCBjb25uZWN0aW9uLCBwYXVzYWJsZV0pO1xuICAgIH07XG5cbiAgICBQYXVzYWJsZU9ic2VydmFibGUucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dChmYWxzZSk7XG4gICAgfTtcblxuICAgIFBhdXNhYmxlT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5jb250cm9sbGVyLm9uTmV4dCh0cnVlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFBhdXNhYmxlT2JzZXJ2YWJsZTtcblxuICB9KE9ic2VydmFibGUpKTtcblxuICAvKipcbiAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgYmFzZWQgdXBvbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB5aWVsZHMgdHJ1ZS9mYWxzZS5cbiAgICogQGV4YW1wbGVcbiAgICogdmFyIHBhdXNlciA9IG5ldyBSeC5TdWJqZWN0KCk7XG4gICAqIHZhciBzb3VyY2UgPSBSeC5PYnNlcnZhYmxlLmludGVydmFsKDEwMCkucGF1c2FibGUocGF1c2VyKTtcbiAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBwYXVzZXIgVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdXNlZCB0byBwYXVzZSB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIGlzIHBhdXNlZCBiYXNlZCB1cG9uIHRoZSBwYXVzZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucGF1c2FibGUgPSBmdW5jdGlvbiAocGF1c2VyKSB7XG4gICAgcmV0dXJuIG5ldyBQYXVzYWJsZU9ic2VydmFibGUodGhpcywgcGF1c2VyKTtcbiAgfTtcblxuICBmdW5jdGlvbiBjb21iaW5lTGF0ZXN0U291cmNlKHNvdXJjZSwgc3ViamVjdCwgcmVzdWx0U2VsZWN0b3IpIHtcbiAgICByZXR1cm4gbmV3IEFub255bW91c09ic2VydmFibGUoZnVuY3Rpb24gKG8pIHtcbiAgICAgIHZhciBoYXNWYWx1ZSA9IFtmYWxzZSwgZmFsc2VdLFxuICAgICAgICBoYXNWYWx1ZUFsbCA9IGZhbHNlLFxuICAgICAgICBpc0RvbmUgPSBmYWxzZSxcbiAgICAgICAgdmFsdWVzID0gbmV3IEFycmF5KDIpLFxuICAgICAgICBlcnI7XG5cbiAgICAgIGZ1bmN0aW9uIG5leHQoeCwgaSkge1xuICAgICAgICB2YWx1ZXNbaV0gPSB4O1xuICAgICAgICBoYXNWYWx1ZVtpXSA9IHRydWU7XG4gICAgICAgIGlmIChoYXNWYWx1ZUFsbCB8fCAoaGFzVmFsdWVBbGwgPSBoYXNWYWx1ZS5ldmVyeShpZGVudGl0eSkpKSB7XG4gICAgICAgICAgaWYgKGVycikgeyByZXR1cm4gby5vbkVycm9yKGVycik7IH1cbiAgICAgICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2gocmVzdWx0U2VsZWN0b3IpLmFwcGx5KG51bGwsIHZhbHVlcyk7XG4gICAgICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgcmV0dXJuIG8ub25FcnJvcihyZXMuZSk7IH1cbiAgICAgICAgICBvLm9uTmV4dChyZXMpO1xuICAgICAgICB9XG4gICAgICAgIGlzRG9uZSAmJiB2YWx1ZXNbMV0gJiYgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3IEJpbmFyeURpc3Bvc2FibGUoXG4gICAgICAgIHNvdXJjZS5zdWJzY3JpYmUoXG4gICAgICAgICAgZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgICAgIG5leHQoeCwgMCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlc1sxXSkge1xuICAgICAgICAgICAgICBvLm9uRXJyb3IoZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBlcnIgPSBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaXNEb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhbHVlc1sxXSAmJiBvLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgfSksXG4gICAgICAgIHN1YmplY3Quc3Vic2NyaWJlKFxuICAgICAgICAgIGZ1bmN0aW9uICh4KSB7XG4gICAgICAgICAgICBuZXh0KHgsIDEpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZnVuY3Rpb24gKGUpIHsgby5vbkVycm9yKGUpOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlzRG9uZSA9IHRydWU7XG4gICAgICAgICAgICBuZXh0KHRydWUsIDEpO1xuICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfSwgc291cmNlKTtcbiAgfVxuXG4gIHZhciBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUoc291cmNlLCBwYXVzZXIpIHtcbiAgICAgIHRoaXMuc291cmNlID0gc291cmNlO1xuICAgICAgdGhpcy5jb250cm9sbGVyID0gbmV3IFN1YmplY3QoKTtcblxuICAgICAgaWYgKHBhdXNlciAmJiBwYXVzZXIuc3Vic2NyaWJlKSB7XG4gICAgICAgIHRoaXMucGF1c2VyID0gdGhpcy5jb250cm9sbGVyLm1lcmdlKHBhdXNlcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnBhdXNlciA9IHRoaXMuY29udHJvbGxlcjtcbiAgICAgIH1cblxuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUucHJvdG90eXBlLl9zdWJzY3JpYmUgPSBmdW5jdGlvbiAobykge1xuICAgICAgdmFyIHEgPSBbXSwgcHJldmlvdXNTaG91bGRGaXJlO1xuXG4gICAgICBmdW5jdGlvbiBkcmFpblF1ZXVlKCkgeyB3aGlsZSAocS5sZW5ndGggPiAwKSB7IG8ub25OZXh0KHEuc2hpZnQoKSk7IH0gfVxuXG4gICAgICB2YXIgc3Vic2NyaXB0aW9uID1cbiAgICAgICAgY29tYmluZUxhdGVzdFNvdXJjZShcbiAgICAgICAgICB0aGlzLnNvdXJjZSxcbiAgICAgICAgICB0aGlzLnBhdXNlci5zdGFydFdpdGgoZmFsc2UpLmRpc3RpbmN0VW50aWxDaGFuZ2VkKCksXG4gICAgICAgICAgZnVuY3Rpb24gKGRhdGEsIHNob3VsZEZpcmUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGRhdGE6IGRhdGEsIHNob3VsZEZpcmU6IHNob3VsZEZpcmUgfTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICBmdW5jdGlvbiAocmVzdWx0cykge1xuICAgICAgICAgICAgICBpZiAocHJldmlvdXNTaG91bGRGaXJlICE9PSB1bmRlZmluZWQgJiYgcmVzdWx0cy5zaG91bGRGaXJlICE9PSBwcmV2aW91c1Nob3VsZEZpcmUpIHtcbiAgICAgICAgICAgICAgICBwcmV2aW91c1Nob3VsZEZpcmUgPSByZXN1bHRzLnNob3VsZEZpcmU7XG4gICAgICAgICAgICAgICAgLy8gY2hhbmdlIGluIHNob3VsZEZpcmVcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5zaG91bGRGaXJlKSB7IGRyYWluUXVldWUoKTsgfVxuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzU2hvdWxkRmlyZSA9IHJlc3VsdHMuc2hvdWxkRmlyZTtcbiAgICAgICAgICAgICAgICAvLyBuZXcgZGF0YVxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLnNob3VsZEZpcmUpIHtcbiAgICAgICAgICAgICAgICAgIG8ub25OZXh0KHJlc3VsdHMuZGF0YSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIHEucHVzaChyZXN1bHRzLmRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgICAgICAgICAgICBvLm9uRXJyb3IoZXJyKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIGRyYWluUXVldWUoKTtcbiAgICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICByZXR1cm4gc3Vic2NyaXB0aW9uOyAgICAgIFxuICAgIH07XG5cbiAgICBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLmNvbnRyb2xsZXIub25OZXh0KGZhbHNlKTtcbiAgICB9O1xuXG4gICAgUGF1c2FibGVCdWZmZXJlZE9ic2VydmFibGUucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIHRoaXMuY29udHJvbGxlci5vbk5leHQodHJ1ZSk7XG4gICAgfTtcblxuICAgIHJldHVybiBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZTtcblxuICB9KE9ic2VydmFibGUpKTtcblxuICAvKipcbiAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIG9ic2VydmFibGUgc2VxdWVuY2UgYmFzZWQgdXBvbiB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aGljaCB5aWVsZHMgdHJ1ZS9mYWxzZSxcbiAgICogYW5kIHlpZWxkcyB0aGUgdmFsdWVzIHRoYXQgd2VyZSBidWZmZXJlZCB3aGlsZSBwYXVzZWQuXG4gICAqIEBleGFtcGxlXG4gICAqIHZhciBwYXVzZXIgPSBuZXcgUnguU3ViamVjdCgpO1xuICAgKiB2YXIgc291cmNlID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDApLnBhdXNhYmxlQnVmZmVyZWQocGF1c2VyKTtcbiAgICogQHBhcmFtIHtPYnNlcnZhYmxlfSBwYXVzZXIgVGhlIG9ic2VydmFibGUgc2VxdWVuY2UgdXNlZCB0byBwYXVzZSB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIGlzIHBhdXNlZCBiYXNlZCB1cG9uIHRoZSBwYXVzZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8ucGF1c2FibGVCdWZmZXJlZCA9IGZ1bmN0aW9uIChzdWJqZWN0KSB7XG4gICAgcmV0dXJuIG5ldyBQYXVzYWJsZUJ1ZmZlcmVkT2JzZXJ2YWJsZSh0aGlzLCBzdWJqZWN0KTtcbiAgfTtcblxuICB2YXIgQ29udHJvbGxlZE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKENvbnRyb2xsZWRPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIENvbnRyb2xsZWRPYnNlcnZhYmxlIChzb3VyY2UsIGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5zdWJqZWN0ID0gbmV3IENvbnRyb2xsZWRTdWJqZWN0KGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpO1xuICAgICAgdGhpcy5zb3VyY2UgPSBzb3VyY2UubXVsdGljYXN0KHRoaXMuc3ViamVjdCkucmVmQ291bnQoKTtcbiAgICB9XG5cbiAgICBDb250cm9sbGVkT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICByZXR1cm4gdGhpcy5zb3VyY2Uuc3Vic2NyaWJlKG8pO1xuICAgIH07XG5cbiAgICBDb250cm9sbGVkT2JzZXJ2YWJsZS5wcm90b3R5cGUucmVxdWVzdCA9IGZ1bmN0aW9uIChudW1iZXJPZkl0ZW1zKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdWJqZWN0LnJlcXVlc3QobnVtYmVyT2ZJdGVtcyA9PSBudWxsID8gLTEgOiBudW1iZXJPZkl0ZW1zKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIENvbnRyb2xsZWRPYnNlcnZhYmxlO1xuXG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIHZhciBDb250cm9sbGVkU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQ29udHJvbGxlZFN1YmplY3QsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gQ29udHJvbGxlZFN1YmplY3QoZW5hYmxlUXVldWUsIHNjaGVkdWxlcikge1xuICAgICAgZW5hYmxlUXVldWUgPT0gbnVsbCAmJiAoZW5hYmxlUXVldWUgPSB0cnVlKTtcblxuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLnN1YmplY3QgPSBuZXcgU3ViamVjdCgpO1xuICAgICAgdGhpcy5lbmFibGVRdWV1ZSA9IGVuYWJsZVF1ZXVlO1xuICAgICAgdGhpcy5xdWV1ZSA9IGVuYWJsZVF1ZXVlID8gW10gOiBudWxsO1xuICAgICAgdGhpcy5yZXF1ZXN0ZWRDb3VudCA9IDA7XG4gICAgICB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUgPSBudWxsO1xuICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICB0aGlzLmhhc0ZhaWxlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5oYXNDb21wbGV0ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuc2NoZWR1bGVyID0gc2NoZWR1bGVyIHx8IGN1cnJlbnRUaHJlYWRTY2hlZHVsZXI7XG4gICAgfVxuXG4gICAgYWRkUHJvcGVydGllcyhDb250cm9sbGVkU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLCB7XG4gICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJqZWN0LnN1YnNjcmliZShvKTtcbiAgICAgIH0sXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IHRydWU7XG4gICAgICAgIGlmICghdGhpcy5lbmFibGVRdWV1ZSB8fCB0aGlzLnF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgIHRoaXMuc3ViamVjdC5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZS5wdXNoKE5vdGlmaWNhdGlvbi5jcmVhdGVPbkNvbXBsZXRlZCgpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICB0aGlzLmhhc0ZhaWxlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgaWYgKCF0aGlzLmVuYWJsZVF1ZXVlIHx8IHRoaXMucXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5zdWJqZWN0Lm9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5xdWV1ZS5wdXNoKE5vdGlmaWNhdGlvbi5jcmVhdGVPbkVycm9yKGVycm9yKSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5yZXF1ZXN0ZWRDb3VudCA8PSAwKSB7XG4gICAgICAgICAgdGhpcy5lbmFibGVRdWV1ZSAmJiB0aGlzLnF1ZXVlLnB1c2goTm90aWZpY2F0aW9uLmNyZWF0ZU9uTmV4dCh2YWx1ZSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICh0aGlzLnJlcXVlc3RlZENvdW50LS0gPT09IDApICYmIHRoaXMuZGlzcG9zZUN1cnJlbnRSZXF1ZXN0KCk7XG4gICAgICAgICAgdGhpcy5zdWJqZWN0Lm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBfcHJvY2Vzc1JlcXVlc3Q6IGZ1bmN0aW9uIChudW1iZXJPZkl0ZW1zKSB7XG4gICAgICAgIGlmICh0aGlzLmVuYWJsZVF1ZXVlKSB7XG4gICAgICAgICAgd2hpbGUgKHRoaXMucXVldWUubGVuZ3RoID4gMCAmJiAobnVtYmVyT2ZJdGVtcyA+IDAgfHwgdGhpcy5xdWV1ZVswXS5raW5kICE9PSAnTicpKSB7XG4gICAgICAgICAgICB2YXIgZmlyc3QgPSB0aGlzLnF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgICAgICBmaXJzdC5hY2NlcHQodGhpcy5zdWJqZWN0KTtcbiAgICAgICAgICAgIGlmIChmaXJzdC5raW5kID09PSAnTicpIHtcbiAgICAgICAgICAgICAgbnVtYmVyT2ZJdGVtcy0tO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgdGhpcy5xdWV1ZSA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBudW1iZXJPZkl0ZW1zO1xuICAgICAgfSxcbiAgICAgIHJlcXVlc3Q6IGZ1bmN0aW9uIChudW1iZXIpIHtcbiAgICAgICAgdGhpcy5kaXNwb3NlQ3VycmVudFJlcXVlc3QoKTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSA9IHRoaXMuc2NoZWR1bGVyLnNjaGVkdWxlKG51bWJlcixcbiAgICAgICAgZnVuY3Rpb24ocywgaSkge1xuICAgICAgICAgIHZhciByZW1haW5pbmcgPSBzZWxmLl9wcm9jZXNzUmVxdWVzdChpKTtcbiAgICAgICAgICB2YXIgc3RvcHBlZCA9IHNlbGYuaGFzQ29tcGxldGVkIHx8IHNlbGYuaGFzRmFpbGVkO1xuICAgICAgICAgIGlmICghc3RvcHBlZCAmJiByZW1haW5pbmcgPiAwKSB7XG4gICAgICAgICAgICBzZWxmLnJlcXVlc3RlZENvdW50ID0gcmVtYWluaW5nO1xuXG4gICAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUNyZWF0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIHNlbGYucmVxdWVzdGVkQ291bnQgPSAwO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIC8vIFNjaGVkdWxlZCBpdGVtIGlzIHN0aWxsIGluIHByb2dyZXNzLiBSZXR1cm4gYSBuZXdcbiAgICAgICAgICAgICAgLy8gZGlzcG9zYWJsZSB0byBhbGxvdyB0aGUgcmVxdWVzdCB0byBiZSBpbnRlcnJ1cHRlZFxuICAgICAgICAgICAgICAvLyB2aWEgZGlzcG9zZS5cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGU7XG4gICAgICB9LFxuICAgICAgZGlzcG9zZUN1cnJlbnRSZXF1ZXN0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUpIHtcbiAgICAgICAgICB0aGlzLnJlcXVlc3RlZERpc3Bvc2FibGUuZGlzcG9zZSgpO1xuICAgICAgICAgIHRoaXMucmVxdWVzdGVkRGlzcG9zYWJsZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBDb250cm9sbGVkU3ViamVjdDtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgLyoqXG4gICAqIEF0dGFjaGVzIGEgY29udHJvbGxlciB0byB0aGUgb2JzZXJ2YWJsZSBzZXF1ZW5jZSB3aXRoIHRoZSBhYmlsaXR5IHRvIHF1ZXVlLlxuICAgKiBAZXhhbXBsZVxuICAgKiB2YXIgc291cmNlID0gUnguT2JzZXJ2YWJsZS5pbnRlcnZhbCgxMDApLmNvbnRyb2xsZWQoKTtcbiAgICogc291cmNlLnJlcXVlc3QoMyk7IC8vIFJlYWRzIDMgdmFsdWVzXG4gICAqIEBwYXJhbSB7Ym9vbH0gZW5hYmxlUXVldWUgdHJ1dGh5IHZhbHVlIHRvIGRldGVybWluZSBpZiB2YWx1ZXMgc2hvdWxkIGJlIHF1ZXVlZCBwZW5kaW5nIHRoZSBuZXh0IHJlcXVlc3RcbiAgICogQHBhcmFtIHtTY2hlZHVsZXJ9IHNjaGVkdWxlciBkZXRlcm1pbmVzIGhvdyB0aGUgcmVxdWVzdHMgd2lsbCBiZSBzY2hlZHVsZWRcbiAgICogQHJldHVybnMge09ic2VydmFibGV9IFRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlIHdoaWNoIG9ubHkgcHJvcGFnYXRlcyB2YWx1ZXMgb24gcmVxdWVzdC5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5jb250cm9sbGVkID0gZnVuY3Rpb24gKGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpIHtcblxuICAgIGlmIChlbmFibGVRdWV1ZSAmJiBpc1NjaGVkdWxlcihlbmFibGVRdWV1ZSkpIHtcbiAgICAgIHNjaGVkdWxlciA9IGVuYWJsZVF1ZXVlO1xuICAgICAgZW5hYmxlUXVldWUgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChlbmFibGVRdWV1ZSA9PSBudWxsKSB7ICBlbmFibGVRdWV1ZSA9IHRydWU7IH1cbiAgICByZXR1cm4gbmV3IENvbnRyb2xsZWRPYnNlcnZhYmxlKHRoaXMsIGVuYWJsZVF1ZXVlLCBzY2hlZHVsZXIpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQaXBlcyB0aGUgZXhpc3RpbmcgT2JzZXJ2YWJsZSBzZXF1ZW5jZSBpbnRvIGEgTm9kZS5qcyBTdHJlYW0uXG4gICAqIEBwYXJhbSB7U3RyZWFtfSBkZXN0IFRoZSBkZXN0aW5hdGlvbiBOb2RlLmpzIHN0cmVhbS5cbiAgICogQHJldHVybnMge1N0cmVhbX0gVGhlIGRlc3RpbmF0aW9uIHN0cmVhbS5cbiAgICovXG4gIG9ic2VydmFibGVQcm90by5waXBlID0gZnVuY3Rpb24gKGRlc3QpIHtcbiAgICB2YXIgc291cmNlID0gdGhpcy5wYXVzYWJsZUJ1ZmZlcmVkKCk7XG5cbiAgICBmdW5jdGlvbiBvbkRyYWluKCkge1xuICAgICAgc291cmNlLnJlc3VtZSgpO1xuICAgIH1cblxuICAgIGRlc3QuYWRkTGlzdGVuZXIoJ2RyYWluJywgb25EcmFpbik7XG5cbiAgICBzb3VyY2Uuc3Vic2NyaWJlKFxuICAgICAgZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgIWRlc3Qud3JpdGUoU3RyaW5nKHgpKSAmJiBzb3VyY2UucGF1c2UoKTtcbiAgICAgIH0sXG4gICAgICBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGRlc3QuZW1pdCgnZXJyb3InLCBlcnIpO1xuICAgICAgfSxcbiAgICAgIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gSGFjayBjaGVjayBiZWNhdXNlIFNURElPIGlzIG5vdCBjbG9zYWJsZVxuICAgICAgICAhZGVzdC5faXNTdGRpbyAmJiBkZXN0LmVuZCgpO1xuICAgICAgICBkZXN0LnJlbW92ZUxpc3RlbmVyKCdkcmFpbicsIG9uRHJhaW4pO1xuICAgICAgfSk7XG5cbiAgICBzb3VyY2UucmVzdW1lKCk7XG5cbiAgICByZXR1cm4gZGVzdDtcbiAgfTtcblxuICB2YXIgVHJhbnNkdWNlT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuICAgIGluaGVyaXRzKFRyYW5zZHVjZU9ic2VydmVyLCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIFRyYW5zZHVjZU9ic2VydmVyKG8sIHhmb3JtKSB7XG4gICAgICB0aGlzLl9vID0gbztcbiAgICAgIHRoaXMuX3hmb3JtID0geGZvcm07XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICB2YXIgcmVzID0gdHJ5Q2F0Y2godGhpcy5feGZvcm1bJ0BAdHJhbnNkdWNlci9zdGVwJ10pLmNhbGwodGhpcy5feGZvcm0sIHRoaXMuX28sIHgpO1xuICAgICAgaWYgKHJlcyA9PT0gZXJyb3JPYmopIHsgdGhpcy5fby5vbkVycm9yKHJlcy5lKTsgfVxuICAgIH07XG5cbiAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAoZSkgeyB0aGlzLl9vLm9uRXJyb3IoZSk7IH07XG5cbiAgICBUcmFuc2R1Y2VPYnNlcnZlci5wcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5feGZvcm1bJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSh0aGlzLl9vKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFRyYW5zZHVjZU9ic2VydmVyO1xuICB9KEFic3RyYWN0T2JzZXJ2ZXIpKTtcblxuICBmdW5jdGlvbiB0cmFuc2Zvcm1Gb3JPYnNlcnZlcihvKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICdAQHRyYW5zZHVjZXIvaW5pdCc6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gbztcbiAgICAgIH0sXG4gICAgICAnQEB0cmFuc2R1Y2VyL3N0ZXAnOiBmdW5jdGlvbihvYnMsIGlucHV0KSB7XG4gICAgICAgIHJldHVybiBvYnMub25OZXh0KGlucHV0KTtcbiAgICAgIH0sXG4gICAgICAnQEB0cmFuc2R1Y2VyL3Jlc3VsdCc6IGZ1bmN0aW9uKG9icykge1xuICAgICAgICByZXR1cm4gb2JzLm9uQ29tcGxldGVkKCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyBhIHRyYW5zZHVjZXIgdG8gdHJhbnNmb3JtIHRoZSBvYnNlcnZhYmxlIHNlcXVlbmNlXG4gICAqIEBwYXJhbSB7VHJhbnNkdWNlcn0gdHJhbnNkdWNlciBBIHRyYW5zZHVjZXIgdG8gZXhlY3V0ZVxuICAgKiBAcmV0dXJucyB7T2JzZXJ2YWJsZX0gQW4gT2JzZXJ2YWJsZSBzZXF1ZW5jZSBjb250YWluaW5nIHRoZSByZXN1bHRzIGZyb20gdGhlIHRyYW5zZHVjZXIuXG4gICAqL1xuICBvYnNlcnZhYmxlUHJvdG8udHJhbnNkdWNlID0gZnVuY3Rpb24odHJhbnNkdWNlcikge1xuICAgIHZhciBzb3VyY2UgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgQW5vbnltb3VzT2JzZXJ2YWJsZShmdW5jdGlvbihvKSB7XG4gICAgICB2YXIgeGZvcm0gPSB0cmFuc2R1Y2VyKHRyYW5zZm9ybUZvck9ic2VydmVyKG8pKTtcbiAgICAgIHJldHVybiBzb3VyY2Uuc3Vic2NyaWJlKG5ldyBUcmFuc2R1Y2VPYnNlcnZlcihvLCB4Zm9ybSkpO1xuICAgIH0sIHNvdXJjZSk7XG4gIH07XG5cbiAgdmFyIEFub255bW91c09ic2VydmFibGUgPSBSeC5Bbm9ueW1vdXNPYnNlcnZhYmxlID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBbm9ueW1vdXNPYnNlcnZhYmxlLCBfX3N1cGVyX18pO1xuXG4gICAgLy8gRml4IHN1YnNjcmliZXIgdG8gY2hlY2sgZm9yIHVuZGVmaW5lZCBvciBmdW5jdGlvbiByZXR1cm5lZCB0byBkZWNvcmF0ZSBhcyBEaXNwb3NhYmxlXG4gICAgZnVuY3Rpb24gZml4U3Vic2NyaWJlcihzdWJzY3JpYmVyKSB7XG4gICAgICByZXR1cm4gc3Vic2NyaWJlciAmJiBpc0Z1bmN0aW9uKHN1YnNjcmliZXIuZGlzcG9zZSkgPyBzdWJzY3JpYmVyIDpcbiAgICAgICAgaXNGdW5jdGlvbihzdWJzY3JpYmVyKSA/IGRpc3Bvc2FibGVDcmVhdGUoc3Vic2NyaWJlcikgOiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0RGlzcG9zYWJsZShzLCBzdGF0ZSkge1xuICAgICAgdmFyIGFkbyA9IHN0YXRlWzBdLCBzZWxmID0gc3RhdGVbMV07XG4gICAgICB2YXIgc3ViID0gdHJ5Q2F0Y2goc2VsZi5fX3N1YnNjcmliZSkuY2FsbChzZWxmLCBhZG8pO1xuICAgICAgaWYgKHN1YiA9PT0gZXJyb3JPYmogJiYgIWFkby5mYWlsKGVycm9yT2JqLmUpKSB7IHRocm93ZXIoZXJyb3JPYmouZSk7IH1cbiAgICAgIGFkby5zZXREaXNwb3NhYmxlKGZpeFN1YnNjcmliZXIoc3ViKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQW5vbnltb3VzT2JzZXJ2YWJsZShzdWJzY3JpYmUsIHBhcmVudCkge1xuICAgICAgdGhpcy5zb3VyY2UgPSBwYXJlbnQ7XG4gICAgICB0aGlzLl9fc3Vic2NyaWJlID0gc3Vic2NyaWJlO1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgQW5vbnltb3VzT2JzZXJ2YWJsZS5wcm90b3R5cGUuX3N1YnNjcmliZSA9IGZ1bmN0aW9uIChvKSB7XG4gICAgICB2YXIgYWRvID0gbmV3IEF1dG9EZXRhY2hPYnNlcnZlcihvKSwgc3RhdGUgPSBbYWRvLCB0aGlzXTtcblxuICAgICAgaWYgKGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGVSZXF1aXJlZCgpKSB7XG4gICAgICAgIGN1cnJlbnRUaHJlYWRTY2hlZHVsZXIuc2NoZWR1bGUoc3RhdGUsIHNldERpc3Bvc2FibGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2V0RGlzcG9zYWJsZShudWxsLCBzdGF0ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYWRvO1xuICAgIH07XG5cbiAgICByZXR1cm4gQW5vbnltb3VzT2JzZXJ2YWJsZTtcblxuICB9KE9ic2VydmFibGUpKTtcblxuICB2YXIgQXV0b0RldGFjaE9ic2VydmVyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBdXRvRGV0YWNoT2JzZXJ2ZXIsIF9fc3VwZXJfXyk7XG5cbiAgICBmdW5jdGlvbiBBdXRvRGV0YWNoT2JzZXJ2ZXIob2JzZXJ2ZXIpIHtcbiAgICAgIF9fc3VwZXJfXy5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5vYnNlcnZlciA9IG9ic2VydmVyO1xuICAgICAgdGhpcy5tID0gbmV3IFNpbmdsZUFzc2lnbm1lbnREaXNwb3NhYmxlKCk7XG4gICAgfVxuXG4gICAgdmFyIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZSA9IEF1dG9EZXRhY2hPYnNlcnZlci5wcm90b3R5cGU7XG5cbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25OZXh0KS5jYWxsKHRoaXMub2JzZXJ2ZXIsIHZhbHVlKTtcbiAgICAgIGlmIChyZXN1bHQgPT09IGVycm9yT2JqKSB7XG4gICAgICAgIHRoaXMuZGlzcG9zZSgpO1xuICAgICAgICB0aHJvd2VyKHJlc3VsdC5lKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgQXV0b0RldGFjaE9ic2VydmVyUHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25FcnJvcikuY2FsbCh0aGlzLm9ic2VydmVyLCBlcnIpO1xuICAgICAgdGhpcy5kaXNwb3NlKCk7XG4gICAgICByZXN1bHQgPT09IGVycm9yT2JqICYmIHRocm93ZXIocmVzdWx0LmUpO1xuICAgIH07XG5cbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuY29tcGxldGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRyeUNhdGNoKHRoaXMub2JzZXJ2ZXIub25Db21wbGV0ZWQpLmNhbGwodGhpcy5vYnNlcnZlcik7XG4gICAgICB0aGlzLmRpc3Bvc2UoKTtcbiAgICAgIHJlc3VsdCA9PT0gZXJyb3JPYmogJiYgdGhyb3dlcihyZXN1bHQuZSk7XG4gICAgfTtcblxuICAgIEF1dG9EZXRhY2hPYnNlcnZlclByb3RvdHlwZS5zZXREaXNwb3NhYmxlID0gZnVuY3Rpb24gKHZhbHVlKSB7IHRoaXMubS5zZXREaXNwb3NhYmxlKHZhbHVlKTsgfTtcbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuZ2V0RGlzcG9zYWJsZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMubS5nZXREaXNwb3NhYmxlKCk7IH07XG5cbiAgICBBdXRvRGV0YWNoT2JzZXJ2ZXJQcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIF9fc3VwZXJfXy5wcm90b3R5cGUuZGlzcG9zZS5jYWxsKHRoaXMpO1xuICAgICAgdGhpcy5tLmRpc3Bvc2UoKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIEF1dG9EZXRhY2hPYnNlcnZlcjtcbiAgfShBYnN0cmFjdE9ic2VydmVyKSk7XG5cbiAgdmFyIElubmVyU3Vic2NyaXB0aW9uID0gZnVuY3Rpb24gKHMsIG8pIHtcbiAgICB0aGlzLl9zID0gcztcbiAgICB0aGlzLl9vID0gbztcbiAgfTtcblxuICBJbm5lclN1YnNjcmlwdGlvbi5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuX3MuaXNEaXNwb3NlZCAmJiB0aGlzLl9vICE9PSBudWxsKSB7XG4gICAgICB2YXIgaWR4ID0gdGhpcy5fcy5vYnNlcnZlcnMuaW5kZXhPZih0aGlzLl9vKTtcbiAgICAgIHRoaXMuX3Mub2JzZXJ2ZXJzLnNwbGljZShpZHgsIDEpO1xuICAgICAgdGhpcy5fbyA9IG51bGw7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiAgUmVwcmVzZW50cyBhbiBvYmplY3QgdGhhdCBpcyBib3RoIGFuIG9ic2VydmFibGUgc2VxdWVuY2UgYXMgd2VsbCBhcyBhbiBvYnNlcnZlci5cbiAgICogIEVhY2ggbm90aWZpY2F0aW9uIGlzIGJyb2FkY2FzdGVkIHRvIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycy5cbiAgICovXG4gIHZhciBTdWJqZWN0ID0gUnguU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoU3ViamVjdCwgX19zdXBlcl9fKTtcbiAgICBmdW5jdGlvbiBTdWJqZWN0KCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgIH1cblxuICAgIGFkZFByb3BlcnRpZXMoU3ViamVjdC5wcm90b3R5cGUsIE9ic2VydmVyLnByb3RvdHlwZSwge1xuICAgICAgX3N1YnNjcmliZTogZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMub2JzZXJ2ZXJzLnB1c2gobyk7XG4gICAgICAgICAgcmV0dXJuIG5ldyBJbm5lclN1YnNjcmlwdGlvbih0aGlzLCBvKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuICAgICAgICAgIG8ub25FcnJvcih0aGlzLmVycm9yKTtcbiAgICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgICB9XG4gICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgcmV0dXJuIGRpc3Bvc2FibGVFbXB0eTtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cbiAgICAgICAqIEByZXR1cm5zIHtCb29sZWFufSBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKi9cbiAgICAgIGhhc09ic2VydmVyczogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5vYnNlcnZlcnMubGVuZ3RoID4gMDsgfSxcbiAgICAgIC8qKlxuICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuICAgICAgICovXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgb3NbaV0ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIFRoZSBleGNlcHRpb24gdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuICAgICAgICovXG4gICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3I7XG4gICAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGFycml2YWwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIG9zW2ldLm9uTmV4dCh2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBVbnN1YnNjcmliZSBhbGwgb2JzZXJ2ZXJzIGFuZCByZWxlYXNlIHJlc291cmNlcy5cbiAgICAgICAqL1xuICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm9ic2VydmVycyA9IG51bGw7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc3ViamVjdCBmcm9tIHRoZSBzcGVjaWZpZWQgb2JzZXJ2ZXIgYW5kIG9ic2VydmFibGUuXG4gICAgICogQHBhcmFtIHtPYnNlcnZlcn0gb2JzZXJ2ZXIgVGhlIG9ic2VydmVyIHVzZWQgdG8gc2VuZCBtZXNzYWdlcyB0byB0aGUgc3ViamVjdC5cbiAgICAgKiBAcGFyYW0ge09ic2VydmFibGV9IG9ic2VydmFibGUgVGhlIG9ic2VydmFibGUgdXNlZCB0byBzdWJzY3JpYmUgdG8gbWVzc2FnZXMgc2VudCBmcm9tIHRoZSBzdWJqZWN0LlxuICAgICAqIEByZXR1cm5zIHtTdWJqZWN0fSBTdWJqZWN0IGltcGxlbWVudGVkIHVzaW5nIHRoZSBnaXZlbiBvYnNlcnZlciBhbmQgb2JzZXJ2YWJsZS5cbiAgICAgKi9cbiAgICBTdWJqZWN0LmNyZWF0ZSA9IGZ1bmN0aW9uIChvYnNlcnZlciwgb2JzZXJ2YWJsZSkge1xuICAgICAgcmV0dXJuIG5ldyBBbm9ueW1vdXNTdWJqZWN0KG9ic2VydmVyLCBvYnNlcnZhYmxlKTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIFN1YmplY3Q7XG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIC8qKlxuICAgKiAgUmVwcmVzZW50cyB0aGUgcmVzdWx0IG9mIGFuIGFzeW5jaHJvbm91cyBvcGVyYXRpb24uXG4gICAqICBUaGUgbGFzdCB2YWx1ZSBiZWZvcmUgdGhlIE9uQ29tcGxldGVkIG5vdGlmaWNhdGlvbiwgb3IgdGhlIGVycm9yIHJlY2VpdmVkIHRocm91Z2ggT25FcnJvciwgaXMgc2VudCB0byBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMuXG4gICAqL1xuICB2YXIgQXN5bmNTdWJqZWN0ID0gUnguQXN5bmNTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBc3luY1N1YmplY3QsIF9fc3VwZXJfXyk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc3ViamVjdCB0aGF0IGNhbiBvbmx5IHJlY2VpdmUgb25lIHZhbHVlIGFuZCB0aGF0IHZhbHVlIGlzIGNhY2hlZCBmb3IgYWxsIGZ1dHVyZSBvYnNlcnZhdGlvbnMuXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgZnVuY3Rpb24gQXN5bmNTdWJqZWN0KCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLmlzRGlzcG9zZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNTdG9wcGVkID0gZmFsc2U7XG4gICAgICB0aGlzLmhhc1ZhbHVlID0gZmFsc2U7XG4gICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgIH1cblxuICAgIGFkZFByb3BlcnRpZXMoQXN5bmNTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG4gICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuXG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG8pO1xuICAgICAgICAgIHJldHVybiBuZXcgSW5uZXJTdWJzY3JpcHRpb24odGhpcywgbyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuICAgICAgICAgIG8ub25FcnJvcih0aGlzLmVycm9yKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmhhc1ZhbHVlKSB7XG4gICAgICAgICAgby5vbk5leHQodGhpcy52YWx1ZSk7XG4gICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkaXNwb3NhYmxlRW1wdHk7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuICAgICAgICovXG4gICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UsIGFsc28gY2F1c2luZyB0aGUgbGFzdCByZWNlaXZlZCB2YWx1ZSB0byBiZSBzZW50IG91dCAoaWYgYW55KS5cbiAgICAgICAqL1xuICAgICAgb25Db21wbGV0ZWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGksIGxlbjtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLmlzU3RvcHBlZCkge1xuICAgICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgICB2YXIgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoO1xuXG4gICAgICAgICAgaWYgKHRoaXMuaGFzVmFsdWUpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICB2YXIgbyA9IG9zW2ldO1xuICAgICAgICAgICAgICBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgICAgby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgICAgb3NbaV0ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVycm9yLlxuICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIEVycm9yIHRvIHNlbmQgdG8gYWxsIG9ic2VydmVycy5cbiAgICAgICAqL1xuICAgICAgb25FcnJvcjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICghdGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgdGhpcy5lcnJvciA9IGVycm9yO1xuXG4gICAgICAgICAgZm9yICh2YXIgaSA9IDAsIG9zID0gY2xvbmVBcnJheSh0aGlzLm9ic2VydmVycyksIGxlbiA9IG9zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBTZW5kcyBhIHZhbHVlIHRvIHRoZSBzdWJqZWN0LiBUaGUgbGFzdCB2YWx1ZSByZWNlaXZlZCBiZWZvcmUgc3VjY2Vzc2Z1bCB0ZXJtaW5hdGlvbiB3aWxsIGJlIHNlbnQgdG8gYWxsIHN1YnNjcmliZWQgYW5kIGZ1dHVyZSBvYnNlcnZlcnMuXG4gICAgICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc3RvcmUgaW4gdGhlIHN1YmplY3QuXG4gICAgICAgKi9cbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmhhc1ZhbHVlID0gdHJ1ZTtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuICAgICAgICovXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcbiAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIEFzeW5jU3ViamVjdDtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgdmFyIEFub255bW91c1N1YmplY3QgPSBSeC5Bbm9ueW1vdXNTdWJqZWN0ID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhBbm9ueW1vdXNTdWJqZWN0LCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEFub255bW91c1N1YmplY3Qob2JzZXJ2ZXIsIG9ic2VydmFibGUpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSBvYnNlcnZlcjtcbiAgICAgIHRoaXMub2JzZXJ2YWJsZSA9IG9ic2VydmFibGU7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBhZGRQcm9wZXJ0aWVzKEFub255bW91c1N1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcbiAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9ic2VydmFibGUuc3Vic2NyaWJlKG8pO1xuICAgICAgfSxcbiAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIub25Db21wbGV0ZWQoKTtcbiAgICAgIH0sXG4gICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlci5vbkVycm9yKGVycm9yKTtcbiAgICAgIH0sXG4gICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm9ic2VydmVyLm9uTmV4dCh2YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gQW5vbnltb3VzU3ViamVjdDtcbiAgfShPYnNlcnZhYmxlKSk7XG5cbiAgLyoqXG4gICAqICBSZXByZXNlbnRzIGEgdmFsdWUgdGhhdCBjaGFuZ2VzIG92ZXIgdGltZS5cbiAgICogIE9ic2VydmVycyBjYW4gc3Vic2NyaWJlIHRvIHRoZSBzdWJqZWN0IHRvIHJlY2VpdmUgdGhlIGxhc3QgKG9yIGluaXRpYWwpIHZhbHVlIGFuZCBhbGwgc3Vic2VxdWVudCBub3RpZmljYXRpb25zLlxuICAgKi9cbiAgdmFyIEJlaGF2aW9yU3ViamVjdCA9IFJ4LkJlaGF2aW9yU3ViamVjdCA9IChmdW5jdGlvbiAoX19zdXBlcl9fKSB7XG4gICAgaW5oZXJpdHMoQmVoYXZpb3JTdWJqZWN0LCBfX3N1cGVyX18pO1xuICAgIGZ1bmN0aW9uIEJlaGF2aW9yU3ViamVjdCh2YWx1ZSkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgdGhpcy5pc0Rpc3Bvc2VkID0gZmFsc2U7XG4gICAgICB0aGlzLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgIH1cblxuICAgIGFkZFByb3BlcnRpZXMoQmVoYXZpb3JTdWJqZWN0LnByb3RvdHlwZSwgT2JzZXJ2ZXIucHJvdG90eXBlLCB7XG4gICAgICBfc3Vic2NyaWJlOiBmdW5jdGlvbiAobykge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAoIXRoaXMuaXNTdG9wcGVkKSB7XG4gICAgICAgICAgdGhpcy5vYnNlcnZlcnMucHVzaChvKTtcbiAgICAgICAgICBvLm9uTmV4dCh0aGlzLnZhbHVlKTtcbiAgICAgICAgICByZXR1cm4gbmV3IElubmVyU3Vic2NyaXB0aW9uKHRoaXMsIG8pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG4gICAgICAgICAgby5vbkVycm9yKHRoaXMuZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG8ub25Db21wbGV0ZWQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGlzcG9zYWJsZUVtcHR5O1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogR2V0cyB0aGUgY3VycmVudCB2YWx1ZSBvciB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuICAgICAgICogVmFsdWUgaXMgZnJvemVuIGFmdGVyIG9uQ29tcGxldGVkIGlzIGNhbGxlZC5cbiAgICAgICAqIEFmdGVyIG9uRXJyb3IgaXMgY2FsbGVkIGFsd2F5cyB0aHJvd3MgdGhlIHNwZWNpZmllZCBleGNlcHRpb24uXG4gICAgICAgKiBBbiBleGNlcHRpb24gaXMgYWx3YXlzIHRocm93biBhZnRlciBkaXNwb3NlIGlzIGNhbGxlZC5cbiAgICAgICAqIEByZXR1cm5zIHtNaXhlZH0gVGhlIGluaXRpYWwgdmFsdWUgcGFzc2VkIHRvIHRoZSBjb25zdHJ1Y3RvciB1bnRpbCBvbk5leHQgaXMgY2FsbGVkOyBhZnRlciB3aGljaCwgdGhlIGxhc3QgdmFsdWUgcGFzc2VkIHRvIG9uTmV4dC5cbiAgICAgICAqL1xuICAgICAgZ2V0VmFsdWU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICAgIGlmICh0aGlzLmhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgIHRocm93IHRoaXMuZXJyb3I7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aGlzLnZhbHVlO1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuICAgICAgICogQHJldHVybnMge0Jvb2xlYW59IEluZGljYXRlcyB3aGV0aGVyIHRoZSBzdWJqZWN0IGhhcyBvYnNlcnZlcnMgc3Vic2NyaWJlZCB0byBpdC5cbiAgICAgICAqL1xuICAgICAgaGFzT2JzZXJ2ZXJzOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm9ic2VydmVycy5sZW5ndGggPiAwOyB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGVuZCBvZiB0aGUgc2VxdWVuY2UuXG4gICAgICAgKi9cbiAgICAgIG9uQ29tcGxldGVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBvc1tpXS5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIE5vdGlmaWVzIGFsbCBzdWJzY3JpYmVkIG9ic2VydmVycyBhYm91dCB0aGUgZXhjZXB0aW9uLlxuICAgICAgICogQHBhcmFtIHtNaXhlZH0gZXJyb3IgVGhlIGV4Y2VwdGlvbiB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBvc1tpXS5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA9IDA7XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGFycml2YWwgb2YgdGhlIHNwZWNpZmllZCBlbGVtZW50IGluIHRoZSBzZXF1ZW5jZS5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZW5kIHRvIGFsbCBvYnNlcnZlcnMuXG4gICAgICAgKi9cbiAgICAgIG9uTmV4dDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLmlzU3RvcHBlZCkgeyByZXR1cm47IH1cbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICBvc1tpXS5vbk5leHQodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBVbnN1YnNjcmliZSBhbGwgb2JzZXJ2ZXJzIGFuZCByZWxlYXNlIHJlc291cmNlcy5cbiAgICAgICAqL1xuICAgICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlzRGlzcG9zZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLm9ic2VydmVycyA9IG51bGw7XG4gICAgICAgIHRoaXMudmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLmVycm9yID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBCZWhhdmlvclN1YmplY3Q7XG4gIH0oT2JzZXJ2YWJsZSkpO1xuXG4gIC8qKlxuICAgKiBSZXByZXNlbnRzIGFuIG9iamVjdCB0aGF0IGlzIGJvdGggYW4gb2JzZXJ2YWJsZSBzZXF1ZW5jZSBhcyB3ZWxsIGFzIGFuIG9ic2VydmVyLlxuICAgKiBFYWNoIG5vdGlmaWNhdGlvbiBpcyBicm9hZGNhc3RlZCB0byBhbGwgc3Vic2NyaWJlZCBhbmQgZnV0dXJlIG9ic2VydmVycywgc3ViamVjdCB0byBidWZmZXIgdHJpbW1pbmcgcG9saWNpZXMuXG4gICAqL1xuICB2YXIgUmVwbGF5U3ViamVjdCA9IFJ4LlJlcGxheVN1YmplY3QgPSAoZnVuY3Rpb24gKF9fc3VwZXJfXykge1xuXG4gICAgdmFyIG1heFNhZmVJbnRlZ2VyID0gTWF0aC5wb3coMiwgNTMpIC0gMTtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVJlbW92YWJsZURpc3Bvc2FibGUoc3ViamVjdCwgb2JzZXJ2ZXIpIHtcbiAgICAgIHJldHVybiBkaXNwb3NhYmxlQ3JlYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgb2JzZXJ2ZXIuZGlzcG9zZSgpO1xuICAgICAgICAhc3ViamVjdC5pc0Rpc3Bvc2VkICYmIHN1YmplY3Qub2JzZXJ2ZXJzLnNwbGljZShzdWJqZWN0Lm9ic2VydmVycy5pbmRleE9mKG9ic2VydmVyKSwgMSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpbmhlcml0cyhSZXBsYXlTdWJqZWN0LCBfX3N1cGVyX18pO1xuXG4gICAgLyoqXG4gICAgICogIEluaXRpYWxpemVzIGEgbmV3IGluc3RhbmNlIG9mIHRoZSBSZXBsYXlTdWJqZWN0IGNsYXNzIHdpdGggdGhlIHNwZWNpZmllZCBidWZmZXIgc2l6ZSwgd2luZG93IHNpemUgYW5kIHNjaGVkdWxlci5cbiAgICAgKiAgQHBhcmFtIHtOdW1iZXJ9IFtidWZmZXJTaXplXSBNYXhpbXVtIGVsZW1lbnQgY291bnQgb2YgdGhlIHJlcGxheSBidWZmZXIuXG4gICAgICogIEBwYXJhbSB7TnVtYmVyfSBbd2luZG93U2l6ZV0gTWF4aW11bSB0aW1lIGxlbmd0aCBvZiB0aGUgcmVwbGF5IGJ1ZmZlci5cbiAgICAgKiAgQHBhcmFtIHtTY2hlZHVsZXJ9IFtzY2hlZHVsZXJdIFNjaGVkdWxlciB0aGUgb2JzZXJ2ZXJzIGFyZSBpbnZva2VkIG9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFJlcGxheVN1YmplY3QoYnVmZmVyU2l6ZSwgd2luZG93U2l6ZSwgc2NoZWR1bGVyKSB7XG4gICAgICB0aGlzLmJ1ZmZlclNpemUgPSBidWZmZXJTaXplID09IG51bGwgPyBtYXhTYWZlSW50ZWdlciA6IGJ1ZmZlclNpemU7XG4gICAgICB0aGlzLndpbmRvd1NpemUgPSB3aW5kb3dTaXplID09IG51bGwgPyBtYXhTYWZlSW50ZWdlciA6IHdpbmRvd1NpemU7XG4gICAgICB0aGlzLnNjaGVkdWxlciA9IHNjaGVkdWxlciB8fCBjdXJyZW50VGhyZWFkU2NoZWR1bGVyO1xuICAgICAgdGhpcy5xID0gW107XG4gICAgICB0aGlzLm9ic2VydmVycyA9IFtdO1xuICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5oYXNFcnJvciA9IGZhbHNlO1xuICAgICAgdGhpcy5lcnJvciA9IG51bGw7XG4gICAgICBfX3N1cGVyX18uY2FsbCh0aGlzKTtcbiAgICB9XG5cbiAgICBhZGRQcm9wZXJ0aWVzKFJlcGxheVN1YmplY3QucHJvdG90eXBlLCBPYnNlcnZlci5wcm90b3R5cGUsIHtcbiAgICAgIF9zdWJzY3JpYmU6IGZ1bmN0aW9uIChvKSB7XG4gICAgICAgIGNoZWNrRGlzcG9zZWQodGhpcyk7XG4gICAgICAgIHZhciBzbyA9IG5ldyBTY2hlZHVsZWRPYnNlcnZlcih0aGlzLnNjaGVkdWxlciwgbyksIHN1YnNjcmlwdGlvbiA9IGNyZWF0ZVJlbW92YWJsZURpc3Bvc2FibGUodGhpcywgc28pO1xuXG4gICAgICAgIHRoaXMuX3RyaW0odGhpcy5zY2hlZHVsZXIubm93KCkpO1xuICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKHNvKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5xLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgc28ub25OZXh0KHRoaXMucVtpXS52YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oYXNFcnJvcikge1xuICAgICAgICAgIHNvLm9uRXJyb3IodGhpcy5lcnJvcik7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1N0b3BwZWQpIHtcbiAgICAgICAgICBzby5vbkNvbXBsZXRlZCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc28uZW5zdXJlQWN0aXZlKCk7XG4gICAgICAgIHJldHVybiBzdWJzY3JpcHRpb247XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgc3ViamVjdCBoYXMgb2JzZXJ2ZXJzIHN1YnNjcmliZWQgdG8gaXQuXG4gICAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHN1YmplY3QgaGFzIG9ic2VydmVycyBzdWJzY3JpYmVkIHRvIGl0LlxuICAgICAgICovXG4gICAgICBoYXNPYnNlcnZlcnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG4gICAgICB9LFxuICAgICAgX3RyaW06IGZ1bmN0aW9uIChub3cpIHtcbiAgICAgICAgd2hpbGUgKHRoaXMucS5sZW5ndGggPiB0aGlzLmJ1ZmZlclNpemUpIHtcbiAgICAgICAgICB0aGlzLnEuc2hpZnQoKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAodGhpcy5xLmxlbmd0aCA+IDAgJiYgKG5vdyAtIHRoaXMucVswXS5pbnRlcnZhbCkgPiB0aGlzLndpbmRvd1NpemUpIHtcbiAgICAgICAgICB0aGlzLnEuc2hpZnQoKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBhcnJpdmFsIG9mIHRoZSBzcGVjaWZpZWQgZWxlbWVudCBpbiB0aGUgc2VxdWVuY2UuXG4gICAgICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuICAgICAgICovXG4gICAgICBvbk5leHQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIHZhciBub3cgPSB0aGlzLnNjaGVkdWxlci5ub3coKTtcbiAgICAgICAgdGhpcy5xLnB1c2goeyBpbnRlcnZhbDogbm93LCB2YWx1ZTogdmFsdWUgfSk7XG4gICAgICAgIHRoaXMuX3RyaW0obm93KTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBvc1tpXTtcbiAgICAgICAgICBvYnNlcnZlci5vbk5leHQodmFsdWUpO1xuICAgICAgICAgIG9ic2VydmVyLmVuc3VyZUFjdGl2ZSgpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLyoqXG4gICAgICAgKiBOb3RpZmllcyBhbGwgc3Vic2NyaWJlZCBvYnNlcnZlcnMgYWJvdXQgdGhlIGV4Y2VwdGlvbi5cbiAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IGVycm9yIFRoZSBleGNlcHRpb24gdG8gc2VuZCB0byBhbGwgb2JzZXJ2ZXJzLlxuICAgICAgICovXG4gICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgY2hlY2tEaXNwb3NlZCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMuaXNTdG9wcGVkKSB7IHJldHVybjsgfVxuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICAgICAgdGhpcy5oYXNFcnJvciA9IHRydWU7XG4gICAgICAgIHZhciBub3cgPSB0aGlzLnNjaGVkdWxlci5ub3coKTtcbiAgICAgICAgdGhpcy5fdHJpbShub3cpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgb3MgPSBjbG9uZUFycmF5KHRoaXMub2JzZXJ2ZXJzKSwgbGVuID0gb3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSBvc1tpXTtcbiAgICAgICAgICBvYnNlcnZlci5vbkVycm9yKGVycm9yKTtcbiAgICAgICAgICBvYnNlcnZlci5lbnN1cmVBY3RpdmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9ic2VydmVycy5sZW5ndGggPSAwO1xuICAgICAgfSxcbiAgICAgIC8qKlxuICAgICAgICogTm90aWZpZXMgYWxsIHN1YnNjcmliZWQgb2JzZXJ2ZXJzIGFib3V0IHRoZSBlbmQgb2YgdGhlIHNlcXVlbmNlLlxuICAgICAgICovXG4gICAgICBvbkNvbXBsZXRlZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjaGVja0Rpc3Bvc2VkKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5pc1N0b3BwZWQpIHsgcmV0dXJuOyB9XG4gICAgICAgIHRoaXMuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdmFyIG5vdyA9IHRoaXMuc2NoZWR1bGVyLm5vdygpO1xuICAgICAgICB0aGlzLl90cmltKG5vdyk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBvcyA9IGNsb25lQXJyYXkodGhpcy5vYnNlcnZlcnMpLCBsZW4gPSBvcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgIHZhciBvYnNlcnZlciA9IG9zW2ldO1xuICAgICAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgb2JzZXJ2ZXIuZW5zdXJlQWN0aXZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vYnNlcnZlcnMubGVuZ3RoID0gMDtcbiAgICAgIH0sXG4gICAgICAvKipcbiAgICAgICAqIFVuc3Vic2NyaWJlIGFsbCBvYnNlcnZlcnMgYW5kIHJlbGVhc2UgcmVzb3VyY2VzLlxuICAgICAgICovXG4gICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuaXNEaXNwb3NlZCA9IHRydWU7XG4gICAgICAgIHRoaXMub2JzZXJ2ZXJzID0gbnVsbDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBSZXBsYXlTdWJqZWN0O1xuICB9KE9ic2VydmFibGUpKTtcblxuICAvKipcbiAgKiBVc2VkIHRvIHBhdXNlIGFuZCByZXN1bWUgc3RyZWFtcy5cbiAgKi9cbiAgUnguUGF1c2VyID0gKGZ1bmN0aW9uIChfX3N1cGVyX18pIHtcbiAgICBpbmhlcml0cyhQYXVzZXIsIF9fc3VwZXJfXyk7XG4gICAgZnVuY3Rpb24gUGF1c2VyKCkge1xuICAgICAgX19zdXBlcl9fLmNhbGwodGhpcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGF1c2VzIHRoZSB1bmRlcmx5aW5nIHNlcXVlbmNlLlxuICAgICAqL1xuICAgIFBhdXNlci5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiAoKSB7IHRoaXMub25OZXh0KGZhbHNlKTsgfTtcblxuICAgIC8qKlxuICAgICogUmVzdW1lcyB0aGUgdW5kZXJseWluZyBzZXF1ZW5jZS5cbiAgICAqL1xuICAgIFBhdXNlci5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gKCkgeyB0aGlzLm9uTmV4dCh0cnVlKTsgfTtcblxuICAgIHJldHVybiBQYXVzZXI7XG4gIH0oU3ViamVjdCkpO1xuXG4gIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGRlZmluZS5hbWQgPT0gJ29iamVjdCcgJiYgZGVmaW5lLmFtZCkge1xuICAgIHJvb3QuUnggPSBSeDtcblxuICAgIGRlZmluZShmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBSeDtcbiAgICB9KTtcbiAgfSBlbHNlIGlmIChmcmVlRXhwb3J0cyAmJiBmcmVlTW9kdWxlKSB7XG4gICAgLy8gaW4gTm9kZS5qcyBvciBSaW5nb0pTXG4gICAgaWYgKG1vZHVsZUV4cG9ydHMpIHtcbiAgICAgIChmcmVlTW9kdWxlLmV4cG9ydHMgPSBSeCkuUnggPSBSeDtcbiAgICB9IGVsc2Uge1xuICAgICAgZnJlZUV4cG9ydHMuUnggPSBSeDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gaW4gYSBicm93c2VyIG9yIFJoaW5vXG4gICAgcm9vdC5SeCA9IFJ4O1xuICB9XG5cbiAgLy8gQWxsIGNvZGUgYmVmb3JlIHRoaXMgcG9pbnQgd2lsbCBiZSBmaWx0ZXJlZCBmcm9tIHN0YWNrIHRyYWNlcy5cbiAgdmFyIHJFbmRpbmdMaW5lID0gY2FwdHVyZUxpbmUoKTtcblxufS5jYWxsKHRoaXMpKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2NsaW1iLXNvY2lhbC9+L3J4LWxpdGUvcngubGl0ZS5qc1xuICoqIG1vZHVsZSBpZCA9IDE4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9saWIvY3NzLWJhc2UuanNcIikoKTtcbi8vIGltcG9ydHNcblxuXG4vLyBtb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcIi5jbGltYl9fd2FsbHt3aWR0aDoxMDAlO3BhZGRpbmc6MDttYXJnaW46MDstd2Via2l0LWp1c3RpZnktY29udGVudDpjZW50ZXI7LW1zLWZsZXgtcGFjazpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjstd2Via2l0LWZsZXgtZGlyZWN0aW9uOnJvdzstbXMtZmxleC1kaXJlY3Rpb246cm93O2ZsZXgtZGlyZWN0aW9uOnJvdzstd2Via2l0LWZsZXgtd3JhcDp3cmFwOy1tcy1mbGV4LXdyYXA6d3JhcDtmbGV4LXdyYXA6d3JhcDtmb250LXNpemU6MTAwJX0uY2xpbWJfX3RpbGUsLmNsaW1iX193YWxse2Rpc3BsYXk6LXdlYmtpdC1mbGV4O2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4fS5jbGltYl9fdGlsZXstd2Via2l0LWZsZXgtc2hyaW5rOjA7LW1zLWZsZXgtbmVnYXRpdmU6MDtmbGV4LXNocmluazowO2hlaWdodDo0MjVweDtib3gtc2l6aW5nOmJvcmRlci1ib3g7LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmQ7LW1zLWZsZXgtcGFjazplbmQ7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kOy13ZWJraXQtZmxleC1kaXJlY3Rpb246Y29sdW1uOy1tcy1mbGV4LWRpcmVjdGlvbjpjb2x1bW47ZmxleC1kaXJlY3Rpb246Y29sdW1uO21hcmdpbi1ib3R0b206MjBweDtvdmVyZmxvdzpoaWRkZW47dGV4dC1hbGlnbjpsZWZ0O2JvcmRlci1yYWRpdXM6N3B4O2JhY2tncm91bmQtY29sb3I6I2Y2ZjZmNjstd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVuO2JhY2tmYWNlLXZpc2liaWxpdHk6aGlkZGVuOy13ZWJraXQtcGVyc3BlY3RpdmU6MTAwMHB4O3BlcnNwZWN0aXZlOjEwMDBweH0uY2xpbWJfX3RpbGVfX2NvbnRlbnR7ei1pbmRleDoxO3BhZGRpbmc6MjZweDtiYWNrZ3JvdW5kLWNvbG9yOiNmNmY2ZjZ9LmNsaW1iX190aWxlLS1oYXMtbm8taW1hZ2UgLmNsaW1iX190aWxlX19jb250ZW50e2hlaWdodDoxMDAlO2Rpc3BsYXk6LXdlYmtpdC1mbGV4O2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4Oy13ZWJraXQtZmxleC1kaXJlY3Rpb246Y29sdW1uOy1tcy1mbGV4LWRpcmVjdGlvbjpjb2x1bW47ZmxleC1kaXJlY3Rpb246Y29sdW1uOy13ZWJraXQtanVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47LW1zLWZsZXgtcGFjazpqdXN0aWZ5O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2JveC1zaXppbmc6Ym9yZGVyLWJveH0uY2xpbWJfX2ltYWdle2Rpc3BsYXk6YmxvY2s7bWF4LXdpZHRoOjEwMCU7ei1pbmRleDo1fS5jbGltYl9fdGlsZSAuY2xpbWJfX2ltYWdle3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2JvcmRlci10b3AtbGVmdC1yYWRpdXM6N3B4O2JvcmRlci10b3AtcmlnaHQtcmFkaXVzOjdweH0uY2xpbWItc2xpZGVzaG93IC5jbGltYl9faW1hZ2V7Ym94LXNoYWRvdzowIDAgMTRweCAwIHJnYmEoMCwwLDAsLjc1KTtib3JkZXItcmFkaXVzOjdweH0uY2xpbWJfX21lc3NhZ2V7ei1pbmRleDoxfS5jbGltYl9fbWVzc2FnZT5he3doaXRlLXNwYWNlOm5vd3JhcDtvdmVyZmxvdzpoaWRkZW47dGV4dC1vdmVyZmxvdzplbGxpcHNpczttYXgtd2lkdGg6MjYwcHg7ZGlzcGxheTppbmxpbmUtYmxvY2s7dmVydGljYWwtYWxpZ246Ym90dG9tfS5jbGltYi10aWxlIC5jbGltYl9fbWVzc2FnZXttYXJnaW4tYm90dG9tOjI0cHh9LmNsaW1iX190aWxlLS1oYXMtbm8taW1hZ2UgLmNsaW1iX19tZXNzYWdle2ZvbnQtc2l6ZToxODUlfS5jbGltYi1zbGlkZXNob3dfX3NsaWRlLS1oYXMtbm8taW1hZ2UgLmNsaW1iX19tZXNzYWdle2ZvbnQtc2l6ZToyMjAlfS5jbGltYl9fYXV0aG9ye2Rpc3BsYXk6aW5saW5lLWJsb2NrO21hcmdpbjotMTBweH0uY2xpbWJfX2F1dGhvciBpbWd7Ym9yZGVyLXJhZGl1czoyNXB4fS5jbGltYl9fYXV0aG9yIC5jbGltYl9fdGlsZV9fYXV0aG9yX191c2VybmFtZXtkaXNwbGF5OmlubGluZS1ibG9jazttYXJnaW46MCAwIDAgMTBweDtsaW5lLWhlaWdodDozNHB4O3ZlcnRpY2FsLWFsaWduOnRvcH0uY2xpbWItc29jaWFsLWJhZGdle3Bvc2l0aW9uOmZpeGVkO2JvdHRvbToyMHB4O3JpZ2h0OjIwcHg7ei1pbmRleDo5O2JhY2tncm91bmQtY29sb3I6I2E5Y2FlMjt3aWR0aDoyMDBweDtoZWlnaHQ6NjZweDtib3JkZXItcmFkaXVzOjVweH0uY2xpbWItc29jaWFsLWJhZGdlPnNwYW57cG9zaXRpb246YWJzb2x1dGUhaW1wb3J0YW50O3RvcDotOTk5OXB4IWltcG9ydGFudDtsZWZ0Oi05OTk5cHghaW1wb3J0YW50fS5jbGltYi1zbGlkZXNob3d7aGVpZ2h0OjEwMHZoO3dpZHRoOjEwMHZ3O2ZvbnQtc2l6ZToxNjAlfS5jbGltYl9fc2xpZGVzaG93X19jb250YWluZXJ7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtwb3NpdGlvbjpyZWxhdGl2ZX0uY2xpbWItc2xpZGVzaG93X19zbGlkZXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO2Rpc3BsYXk6LXdlYmtpdC1mbGV4O2Rpc3BsYXk6LW1zLWZsZXhib3g7ZGlzcGxheTpmbGV4Oy13ZWJraXQtYWxpZ24taXRlbXM6Y2VudGVyOy1tcy1mbGV4LWFsaWduOmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7LXdlYmtpdC1mbGV4LWRpcmVjdGlvbjpyb3c7LW1zLWZsZXgtZGlyZWN0aW9uOnJvdztmbGV4LWRpcmVjdGlvbjpyb3c7LXdlYmtpdC1qdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOy1tcy1mbGV4LXBhY2s6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXJ9LmNsaW1iLXNsaWRlc2hvd19fcGFuZWwsLmNsaW1iLXNsaWRlc2hvd19fc2xpZGV7LXdlYmtpdC1iYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbjtiYWNrZmFjZS12aXNpYmlsaXR5OmhpZGRlbjstd2Via2l0LXBlcnNwZWN0aXZlOjEwMDBweDtwZXJzcGVjdGl2ZToxMDAwcHh9LmNsaW1iLXNsaWRlc2hvd19fcGFuZWx7Ym94LXNpemluZzpib3JkZXItYm94O2Rpc3BsYXk6aW5saW5lLWJsb2NrO3Bvc2l0aW9uOnJlbGF0aXZlO3BhZGRpbmc6MzBweCAxNXB4IDVweDt3aWR0aDo1MCU7Ym9yZGVyLXJhZGl1czozcHg7YmFja2dyb3VuZC1jb2xvcjojZjZmNmY2fS5jbGltYi1zbGlkZXNob3dfX3NsaWRlLS1oYXMtbm8taW1hZ2UgLmNsaW1iLXNsaWRlc2hvd19fcGFuZWx7cGFkZGluZzozMHB4O2JvcmRlci1yYWRpdXM6N3B4O2JveC1zaGFkb3c6MCAwIDE0cHggMCByZ2JhKDAsMCwwLC43NSl9XCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vY3NzLWxvYWRlciEuL34vYXV0b3ByZWZpeGVyLWxvYWRlcj9icm93c2Vycz1sYXN0IDIgdmVyc2lvbiEuL34vc2Fzcy1sb2FkZXIhLi9zcmMvc3R5bGUvbWFpbi5zY3NzXG4gKiogbW9kdWxlIGlkID0gMTlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8qXHJcblx0TUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcclxuXHRBdXRob3IgVG9iaWFzIEtvcHBlcnMgQHNva3JhXHJcbiovXHJcbi8vIGNzcyBiYXNlIGNvZGUsIGluamVjdGVkIGJ5IHRoZSBjc3MtbG9hZGVyXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIGxpc3QgPSBbXTtcclxuXHJcblx0Ly8gcmV0dXJuIHRoZSBsaXN0IG9mIG1vZHVsZXMgYXMgY3NzIHN0cmluZ1xyXG5cdGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcclxuXHRcdHZhciByZXN1bHQgPSBbXTtcclxuXHRcdGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBpdGVtID0gdGhpc1tpXTtcclxuXHRcdFx0aWYoaXRlbVsyXSkge1xyXG5cdFx0XHRcdHJlc3VsdC5wdXNoKFwiQG1lZGlhIFwiICsgaXRlbVsyXSArIFwie1wiICsgaXRlbVsxXSArIFwifVwiKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRyZXN1bHQucHVzaChpdGVtWzFdKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHJlc3VsdC5qb2luKFwiXCIpO1xyXG5cdH07XHJcblxyXG5cdC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XHJcblx0bGlzdC5pID0gZnVuY3Rpb24obW9kdWxlcywgbWVkaWFRdWVyeSkge1xyXG5cdFx0aWYodHlwZW9mIG1vZHVsZXMgPT09IFwic3RyaW5nXCIpXHJcblx0XHRcdG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsIFwiXCJdXTtcclxuXHRcdHZhciBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzID0ge307XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaWQgPSB0aGlzW2ldWzBdO1xyXG5cdFx0XHRpZih0eXBlb2YgaWQgPT09IFwibnVtYmVyXCIpXHJcblx0XHRcdFx0YWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0Zm9yKGkgPSAwOyBpIDwgbW9kdWxlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHR2YXIgaXRlbSA9IG1vZHVsZXNbaV07XHJcblx0XHRcdC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcclxuXHRcdFx0Ly8gdGhpcyBpbXBsZW1lbnRhdGlvbiBpcyBub3QgMTAwJSBwZXJmZWN0IGZvciB3ZWlyZCBtZWRpYSBxdWVyeSBjb21iaW5hdGlvbnNcclxuXHRcdFx0Ly8gIHdoZW4gYSBtb2R1bGUgaXMgaW1wb3J0ZWQgbXVsdGlwbGUgdGltZXMgd2l0aCBkaWZmZXJlbnQgbWVkaWEgcXVlcmllcy5cclxuXHRcdFx0Ly8gIEkgaG9wZSB0aGlzIHdpbGwgbmV2ZXIgb2NjdXIgKEhleSB0aGlzIHdheSB3ZSBoYXZlIHNtYWxsZXIgYnVuZGxlcylcclxuXHRcdFx0aWYodHlwZW9mIGl0ZW1bMF0gIT09IFwibnVtYmVyXCIgfHwgIWFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaXRlbVswXV0pIHtcclxuXHRcdFx0XHRpZihtZWRpYVF1ZXJ5ICYmICFpdGVtWzJdKSB7XHJcblx0XHRcdFx0XHRpdGVtWzJdID0gbWVkaWFRdWVyeTtcclxuXHRcdFx0XHR9IGVsc2UgaWYobWVkaWFRdWVyeSkge1xyXG5cdFx0XHRcdFx0aXRlbVsyXSA9IFwiKFwiICsgaXRlbVsyXSArIFwiKSBhbmQgKFwiICsgbWVkaWFRdWVyeSArIFwiKVwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRsaXN0LnB1c2goaXRlbSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9O1xyXG5cdHJldHVybiBsaXN0O1xyXG59O1xyXG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9jc3MtbG9hZGVyL2xpYi9jc3MtYmFzZS5qc1xuICoqIG1vZHVsZSBpZCA9IDIwXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFsnZXhwb3J0cycsICdtb2R1bGUnXSwgZmFjdG9yeSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgZmFjdG9yeShleHBvcnRzLCBtb2R1bGUpO1xuICB9IGVsc2Uge1xuICAgIHZhciBtb2QgPSB7XG4gICAgICBleHBvcnRzOiB7fVxuICAgIH07XG4gICAgZmFjdG9yeShtb2QuZXhwb3J0cywgbW9kKTtcbiAgICBnbG9iYWwuZmV0Y2hKc29ucCA9IG1vZC5leHBvcnRzO1xuICB9XG59KSh0aGlzLCBmdW5jdGlvbiAoZXhwb3J0cywgbW9kdWxlKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgdGltZW91dDogNTAwMCxcbiAgICBqc29ucENhbGxiYWNrOiAnY2FsbGJhY2snXG4gIH07XG5cbiAgZnVuY3Rpb24gZ2VuZXJhdGVDYWxsYmFja0Z1bmN0aW9uKCkge1xuICAgIHJldHVybiAnanNvbnBfJyArIERhdGUubm93KCkgKyAnXycgKyBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDEwMDAwMCk7XG4gIH1cblxuICAvLyBLbm93biBpc3N1ZTogV2lsbCB0aHJvdyAnVW5jYXVnaHQgUmVmZXJlbmNlRXJyb3I6IGNhbGxiYWNrXyoqKiBpcyBub3QgZGVmaW5lZCcgZXJyb3IgaWYgcmVxdWVzdCB0aW1lb3V0XG4gIGZ1bmN0aW9uIGNsZWFyRnVuY3Rpb24oZnVuY3Rpb25OYW1lKSB7XG4gICAgLy8gSUU4IHRocm93cyBhbiBleGNlcHRpb24gd2hlbiB5b3UgdHJ5IHRvIGRlbGV0ZSBhIHByb3BlcnR5IG9uIHdpbmRvd1xuICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9hLzE4MjQyMjgvNzUxMDg5XG4gICAgdHJ5IHtcbiAgICAgIGRlbGV0ZSB3aW5kb3dbZnVuY3Rpb25OYW1lXTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB3aW5kb3dbZnVuY3Rpb25OYW1lXSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZW1vdmVTY3JpcHQoc2NyaXB0SWQpIHtcbiAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoc2NyaXB0SWQpO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICB9XG5cbiAgdmFyIGZldGNoSnNvbnAgPSBmdW5jdGlvbiBmZXRjaEpzb25wKHVybCkge1xuICAgIHZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07XG5cbiAgICB2YXIgdGltZW91dCA9IG9wdGlvbnMudGltZW91dCAhPSBudWxsID8gb3B0aW9ucy50aW1lb3V0IDogZGVmYXVsdE9wdGlvbnMudGltZW91dDtcbiAgICB2YXIganNvbnBDYWxsYmFjayA9IG9wdGlvbnMuanNvbnBDYWxsYmFjayAhPSBudWxsID8gb3B0aW9ucy5qc29ucENhbGxiYWNrIDogZGVmYXVsdE9wdGlvbnMuanNvbnBDYWxsYmFjaztcblxuICAgIHZhciB0aW1lb3V0SWQgPSB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIGNhbGxiYWNrRnVuY3Rpb24gPSBnZW5lcmF0ZUNhbGxiYWNrRnVuY3Rpb24oKTtcblxuICAgICAgd2luZG93W2NhbGxiYWNrRnVuY3Rpb25dID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgIG9rOiB0cnVlLFxuICAgICAgICAgIC8vIGtlZXAgY29uc2lzdGVudCB3aXRoIGZldGNoIEFQSVxuICAgICAgICAgIGpzb246IGZ1bmN0aW9uIGpzb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aW1lb3V0SWQpIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuXG4gICAgICAgIHJlbW92ZVNjcmlwdChqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbik7XG5cbiAgICAgICAgY2xlYXJGdW5jdGlvbihjYWxsYmFja0Z1bmN0aW9uKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIENoZWNrIGlmIHRoZSB1c2VyIHNldCB0aGVpciBvd24gcGFyYW1zLCBhbmQgaWYgbm90IGFkZCBhID8gdG8gc3RhcnQgYSBsaXN0IG9mIHBhcmFtc1xuICAgICAgdXJsICs9IHVybC5pbmRleE9mKCc/JykgPT09IC0xID8gJz8nIDogJyYnO1xuXG4gICAgICB2YXIganNvbnBTY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgIGpzb25wU2NyaXB0LnNldEF0dHJpYnV0ZShcInNyY1wiLCB1cmwgKyBqc29ucENhbGxiYWNrICsgJz0nICsgY2FsbGJhY2tGdW5jdGlvbik7XG4gICAgICBqc29ucFNjcmlwdC5pZCA9IGpzb25wQ2FsbGJhY2sgKyAnXycgKyBjYWxsYmFja0Z1bmN0aW9uO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJoZWFkXCIpWzBdLmFwcGVuZENoaWxkKGpzb25wU2NyaXB0KTtcblxuICAgICAgdGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0pTT05QIHJlcXVlc3QgdG8gJyArIHVybCArICcgdGltZWQgb3V0JykpO1xuXG4gICAgICAgIGNsZWFyRnVuY3Rpb24oY2FsbGJhY2tGdW5jdGlvbik7XG4gICAgICAgIHJlbW92ZVNjcmlwdChqc29ucENhbGxiYWNrICsgJ18nICsgY2FsbGJhY2tGdW5jdGlvbik7XG4gICAgICB9LCB0aW1lb3V0KTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBleHBvcnQgYXMgZ2xvYmFsIGZ1bmN0aW9uXG4gIC8qXG4gIGxldCBsb2NhbDtcbiAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWwgPSBnbG9iYWw7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWwgPSBzZWxmO1xuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICBsb2NhbCA9IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb2x5ZmlsbCBmYWlsZWQgYmVjYXVzZSBnbG9iYWwgb2JqZWN0IGlzIHVuYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKTtcbiAgICB9XG4gIH1cbiAgXG4gIGxvY2FsLmZldGNoSnNvbnAgPSBmZXRjaEpzb25wO1xuICAqL1xuXG4gIG1vZHVsZS5leHBvcnRzID0gZmV0Y2hKc29ucDtcbn0pO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L2ZldGNoLWpzb25wL2J1aWxkL2ZldGNoLWpzb25wLmpzXG4gKiogbW9kdWxlIGlkID0gMjFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbJ2RlZmF1bHQnXSA9IGNvbmZpZ0FuaW1hdGlvbjtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3BlcmZvcm1hbmNlTm93ID0gcmVxdWlyZSgncGVyZm9ybWFuY2Utbm93Jyk7XG5cbnZhciBfcGVyZm9ybWFuY2VOb3cyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGVyZm9ybWFuY2VOb3cpO1xuXG52YXIgX3JhZiA9IHJlcXVpcmUoJ3JhZicpO1xuXG52YXIgX3JhZjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yYWYpO1xuXG5mdW5jdGlvbiBjb25maWdBbmltYXRpb24oKSB7XG4gIHZhciBjb25maWcgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1swXTtcbiAgdmFyIF9jb25maWckdGltZVN0ZXAgPSBjb25maWcudGltZVN0ZXA7XG4gIHZhciB0aW1lU3RlcCA9IF9jb25maWckdGltZVN0ZXAgPT09IHVuZGVmaW5lZCA/IDEgLyA2MCAqIDEwMDAgOiBfY29uZmlnJHRpbWVTdGVwO1xuICB2YXIgX2NvbmZpZyR0aW1lU2NhbGUgPSBjb25maWcudGltZVNjYWxlO1xuICB2YXIgdGltZVNjYWxlID0gX2NvbmZpZyR0aW1lU2NhbGUgPT09IHVuZGVmaW5lZCA/IDEgOiBfY29uZmlnJHRpbWVTY2FsZTtcbiAgdmFyIF9jb25maWckbWF4U3RlcHMgPSBjb25maWcubWF4U3RlcHM7XG4gIHZhciBtYXhTdGVwcyA9IF9jb25maWckbWF4U3RlcHMgPT09IHVuZGVmaW5lZCA/IDEwIDogX2NvbmZpZyRtYXhTdGVwcztcbiAgdmFyIF9jb25maWckcmFmID0gY29uZmlnLnJhZjtcbiAgdmFyIHJhZiA9IF9jb25maWckcmFmID09PSB1bmRlZmluZWQgPyBfcmFmMlsnZGVmYXVsdCddIDogX2NvbmZpZyRyYWY7XG4gIHZhciBfY29uZmlnJG5vdyA9IGNvbmZpZy5ub3c7XG4gIHZhciBub3cgPSBfY29uZmlnJG5vdyA9PT0gdW5kZWZpbmVkID8gX3BlcmZvcm1hbmNlTm93MlsnZGVmYXVsdCddIDogX2NvbmZpZyRub3c7XG5cbiAgdmFyIGFuaW1SdW5uaW5nID0gW107XG4gIHZhciBydW5uaW5nID0gZmFsc2U7XG4gIHZhciBwcmV2VGltZSA9IDA7XG4gIHZhciBhY2N1bXVsYXRlZFRpbWUgPSAwO1xuXG4gIGZ1bmN0aW9uIGxvb3AoKSB7XG4gICAgdmFyIGN1cnJlbnRUaW1lID0gbm93KCk7XG4gICAgdmFyIGZyYW1lVGltZSA9IGN1cnJlbnRUaW1lIC0gcHJldlRpbWU7IC8vIGRlbHRhXG5cbiAgICBwcmV2VGltZSA9IGN1cnJlbnRUaW1lO1xuICAgIGFjY3VtdWxhdGVkVGltZSArPSBmcmFtZVRpbWUgKiB0aW1lU2NhbGU7XG5cbiAgICBpZiAoYWNjdW11bGF0ZWRUaW1lID4gdGltZVN0ZXAgKiBtYXhTdGVwcykge1xuICAgICAgYWNjdW11bGF0ZWRUaW1lID0gMDtcbiAgICB9XG5cbiAgICB2YXIgZnJhbWVOdW1iZXIgPSBNYXRoLmNlaWwoYWNjdW11bGF0ZWRUaW1lIC8gdGltZVN0ZXApO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbVJ1bm5pbmcubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciBfYW5pbVJ1bm5pbmckaSA9IGFuaW1SdW5uaW5nW2ldO1xuICAgICAgdmFyIGFjdGl2ZSA9IF9hbmltUnVubmluZyRpLmFjdGl2ZTtcbiAgICAgIHZhciBhbmltYXRpb25TdGVwID0gX2FuaW1SdW5uaW5nJGkuYW5pbWF0aW9uU3RlcDtcbiAgICAgIHZhciBwcmV2UHJldlN0YXRlID0gX2FuaW1SdW5uaW5nJGkucHJldlN0YXRlO1xuICAgICAgdmFyIHByZXZOZXh0U3RhdGUgPSBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGU7XG5cbiAgICAgIGlmICghYWN0aXZlKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICAvLyBTZWVtcyBsaWtlIGJlY2F1c2UgdGhlIFRTIHNldHMgZGVzdFZhbHMgYXMgZW50ZXJWYWxzIGZvciB0aGUgZmlyc3RcbiAgICAgIC8vIHRpY2ssIHdlIG1pZ2h0IHJlbmRlciB0aGF0IHZhbHVlIHR3aWNlLiBXZSByZW5kZXIgaXQgb25jZSwgY3VyclZhbHVlIGlzXG4gICAgICAvLyBlbnRlclZhbCBhbmQgZGVzdFZhbCBpcyBlbnRlclZhbC4gVGhlIG5leHQgdGljayBpcyBmYXN0ZXIgdGhhbiAxNm1zLFxuICAgICAgLy8gc28gYWNjdW11bGF0ZWRUaW1lICh3aGljaCB3b3VsZCBiZSBhYm91dCAtMTZtcyBmcm9tIHRoZSBwcmV2aW91cyB0aWNrKVxuICAgICAgLy8gaXMgbmVnYXRpdmUgKC0xNm1zICsgYW55IG51bWJlciBsZXNzIHRoYW4gMTZtcyA8IDApLiBTbyB3ZSBqdXN0IHJlbmRlclxuICAgICAgLy8gcGFydCB3YXlzIHRvd2FyZHMgdGhlIG5leHRTdGF0ZSwgYnV0IHRoYXQncyBlbnRlclZhbCBzdGlsbC4gV2UgcmVuZGVyXG4gICAgICAvLyBzYXkgNzUlIGJldHdlZW4gY3VyclZhbHVlICg9PT0gZW50ZXJWYWwpIGFuZCBkZXN0VmFsdWUgKD09PSBlbnRlclZhbCkuXG4gICAgICAvLyBTbyB3ZSByZW5kZXIgdGhlIHNhbWUgdmFsdWUgYSBzZWNvbmQgdGltZS5cbiAgICAgIC8vIFRoZSBzb2x1dGlvbiBiZWxvdyBpcyB0byByZWNhbGN1bGF0ZSB0aGUgZGVzdGluYXRpb24gc3RhdGUgZXZlbiB3aGVuXG4gICAgICAvLyB5b3UncmUgbW92aW5nIHBhcnRpYWxseSB0b3dhcmRzIGl0LlxuICAgICAgaWYgKGFjY3VtdWxhdGVkVGltZSA8PSAwKSB7XG4gICAgICAgIGFuaW1SdW5uaW5nW2ldLm5leHRTdGF0ZSA9IGFuaW1hdGlvblN0ZXAodGltZVN0ZXAgLyAxMDAwLCBwcmV2UHJldlN0YXRlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZnJhbWVOdW1iZXI7IGorKykge1xuICAgICAgICAgIGFuaW1SdW5uaW5nW2ldLm5leHRTdGF0ZSA9IGFuaW1hdGlvblN0ZXAodGltZVN0ZXAgLyAxMDAwLCBwcmV2TmV4dFN0YXRlKTtcbiAgICAgICAgICB2YXIgX3JlZiA9IFtwcmV2TmV4dFN0YXRlLCBhbmltUnVubmluZ1tpXS5uZXh0U3RhdGVdO1xuICAgICAgICAgIGFuaW1SdW5uaW5nW2ldLnByZXZTdGF0ZSA9IF9yZWZbMF07XG4gICAgICAgICAgcHJldk5leHRTdGF0ZSA9IF9yZWZbMV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBhY2N1bXVsYXRlZFRpbWUgPSBhY2N1bXVsYXRlZFRpbWUgLSBmcmFtZU51bWJlciAqIHRpbWVTdGVwO1xuXG4gICAgLy8gUmVuZGVyIGFuZCBmaWx0ZXIgaW4gb25lIGl0ZXJhdGlvbi5cbiAgICB2YXIgYWxwaGEgPSAxICsgYWNjdW11bGF0ZWRUaW1lIC8gdGltZVN0ZXA7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbmltUnVubmluZy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIF9hbmltUnVubmluZyRpMiA9IGFuaW1SdW5uaW5nW2ldO1xuICAgICAgdmFyIGFuaW1hdGlvblJlbmRlciA9IF9hbmltUnVubmluZyRpMi5hbmltYXRpb25SZW5kZXI7XG4gICAgICB2YXIgbmV4dFN0YXRlID0gX2FuaW1SdW5uaW5nJGkyLm5leHRTdGF0ZTtcbiAgICAgIHZhciBwcmV2U3RhdGUgPSBfYW5pbVJ1bm5pbmckaTIucHJldlN0YXRlO1xuXG4gICAgICAvLyBNaWdodCBtdXRhdGUgYW5pbVJ1bm5pbmcuLi4uLi4uLlxuICAgICAgYW5pbWF0aW9uUmVuZGVyKGFscGhhLCBuZXh0U3RhdGUsIHByZXZTdGF0ZSk7XG4gICAgfVxuXG4gICAgYW5pbVJ1bm5pbmcgPSBhbmltUnVubmluZy5maWx0ZXIoZnVuY3Rpb24gKF9yZWYyKSB7XG4gICAgICB2YXIgYWN0aXZlID0gX3JlZjIuYWN0aXZlO1xuICAgICAgcmV0dXJuIGFjdGl2ZTtcbiAgICB9KTtcblxuICAgIGlmIChhbmltUnVubmluZy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmFmKGxvb3ApO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgIGlmICghcnVubmluZykge1xuICAgICAgcnVubmluZyA9IHRydWU7XG4gICAgICBwcmV2VGltZSA9IG5vdygpO1xuICAgICAgYWNjdW11bGF0ZWRUaW1lID0gMDtcbiAgICAgIHJhZihsb29wKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24gc3RhcnRBbmltYXRpb24oc3RhdGUsIGFuaW1hdGlvblN0ZXAsIGFuaW1hdGlvblJlbmRlcikge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbVJ1bm5pbmcubGVuZ3RoOyBpKyspIHtcbiAgICAgIHZhciB2YWwgPSBhbmltUnVubmluZ1tpXTtcbiAgICAgIGlmICh2YWwuYW5pbWF0aW9uU3RlcCA9PT0gYW5pbWF0aW9uU3RlcCkge1xuICAgICAgICB2YWwuYWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgdmFsLnByZXZTdGF0ZSA9IHN0YXRlO1xuICAgICAgICBzdGFydCgpO1xuICAgICAgICByZXR1cm4gdmFsLnN0b3A7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIG5ld0FuaW0gPSB7XG4gICAgICBhbmltYXRpb25TdGVwOiBhbmltYXRpb25TdGVwLFxuICAgICAgYW5pbWF0aW9uUmVuZGVyOiBhbmltYXRpb25SZW5kZXIsXG4gICAgICBwcmV2U3RhdGU6IHN0YXRlLFxuICAgICAgbmV4dFN0YXRlOiBzdGF0ZSxcbiAgICAgIGFjdGl2ZTogdHJ1ZVxuICAgIH07XG5cbiAgICBuZXdBbmltLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gbmV3QW5pbS5hY3RpdmUgPSBmYWxzZTtcbiAgICB9O1xuICAgIGFuaW1SdW5uaW5nLnB1c2gobmV3QW5pbSk7XG5cbiAgICBzdGFydCgpO1xuXG4gICAgcmV0dXJuIG5ld0FuaW0uc3RvcDtcbiAgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9hbmltYXRpb25Mb29wLmpzXG4gKiogbW9kdWxlIGlkID0gMjJcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIid1c2Ugc3RyaWN0JztcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcblxudmFyIF9leHRlbmRzID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07IGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzb3VyY2UsIGtleSkpIHsgdGFyZ2V0W2tleV0gPSBzb3VyY2Vba2V5XTsgfSB9IH0gcmV0dXJuIHRhcmdldDsgfTtcblxuZXhwb3J0c1snZGVmYXVsdCddID0gY29tcG9uZW50cztcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX25vVmVsb2NpdHkgPSByZXF1aXJlKCcuL25vVmVsb2NpdHknKTtcblxudmFyIF9ub1ZlbG9jaXR5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX25vVmVsb2NpdHkpO1xuXG52YXIgX2hhc1JlYWNoZWRTdHlsZSA9IHJlcXVpcmUoJy4vaGFzUmVhY2hlZFN0eWxlJyk7XG5cbnZhciBfaGFzUmVhY2hlZFN0eWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhc1JlYWNoZWRTdHlsZSk7XG5cbnZhciBfbWVyZ2VEaWZmID0gcmVxdWlyZSgnLi9tZXJnZURpZmYnKTtcblxudmFyIF9tZXJnZURpZmYyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVyZ2VEaWZmKTtcblxudmFyIF9hbmltYXRpb25Mb29wID0gcmVxdWlyZSgnLi9hbmltYXRpb25Mb29wJyk7XG5cbnZhciBfYW5pbWF0aW9uTG9vcDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hbmltYXRpb25Mb29wKTtcblxudmFyIF96ZXJvID0gcmVxdWlyZSgnLi96ZXJvJyk7XG5cbnZhciBfemVybzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF96ZXJvKTtcblxudmFyIF91cGRhdGVUcmVlID0gcmVxdWlyZSgnLi91cGRhdGVUcmVlJyk7XG5cbnZhciBfZGVwcmVjYXRlZFNwcmluZ3MyID0gcmVxdWlyZSgnLi9kZXByZWNhdGVkU3ByaW5ncycpO1xuXG52YXIgX2RlcHJlY2F0ZWRTcHJpbmdzMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlcHJlY2F0ZWRTcHJpbmdzMik7XG5cbnZhciBfc3RyaXBTdHlsZSA9IHJlcXVpcmUoJy4vc3RyaXBTdHlsZScpO1xuXG52YXIgX3N0cmlwU3R5bGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3RyaXBTdHlsZSk7XG5cbnZhciBzdGFydEFuaW1hdGlvbiA9IF9hbmltYXRpb25Mb29wMlsnZGVmYXVsdCddKCk7XG5cbmZ1bmN0aW9uIG1hcE9iamVjdChmLCBvYmopIHtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgaWYgKCFvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHJldFtrZXldID0gZihvYmpba2V5XSwga2V5KTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiBldmVyeU9iaihmLCBvYmopIHtcbiAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgIGlmICghb2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoIWYob2JqW2tleV0sIGtleSkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGNvbXBvbmVudHMoUmVhY3QpIHtcbiAgdmFyIFByb3BUeXBlcyA9IFJlYWN0LlByb3BUeXBlcztcblxuICB2YXIgTW90aW9uID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICAgIGRpc3BsYXlOYW1lOiAnTW90aW9uJyxcblxuICAgIHByb3BUeXBlczoge1xuICAgICAgLy8gVE9PRDogd2FybiBhZ2FpbnN0IHB1dHRpbmcgYSBjb25maWcgaW4gaGVyZVxuICAgICAgZGVmYXVsdFZhbHVlOiBmdW5jdGlvbiBkZWZhdWx0VmFsdWUocHJvcCwgcHJvcE5hbWUpIHtcbiAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignU3ByaW5nXFwncyBgZGVmYXVsdFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBkZWZhdWx0U3R5bGVgLiAnICsgJ0l0cyBmb3JtYXQgcmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgY2hhbmdlcyBhcyB3ZWxsLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZW5kVmFsdWU6IGZ1bmN0aW9uIGVuZFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1NwcmluZ1xcJ3MgYGVuZFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBzdHlsZWAuIEl0cyBmb3JtYXQgJyArICdyZWNlaXZlZCBhIGZldyAoZWFzeSB0byB1cGRhdGUhKSBjaGFuZ2VzIGFzIHdlbGwuJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkZWZhdWx0U3R5bGU6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgICBzdHlsZTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgICAgY2hpbGRyZW46IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWRcbiAgICB9LFxuXG4gICAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgICB2YXIgX3Byb3BzID0gdGhpcy5wcm9wcztcbiAgICAgIHZhciBkZWZhdWx0U3R5bGUgPSBfcHJvcHMuZGVmYXVsdFN0eWxlO1xuICAgICAgdmFyIHN0eWxlID0gX3Byb3BzLnN0eWxlO1xuXG4gICAgICB2YXIgY3VycmVudFN0eWxlID0gZGVmYXVsdFN0eWxlIHx8IHN0eWxlO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY3VycmVudFN0eWxlOiBjdXJyZW50U3R5bGUsXG4gICAgICAgIGN1cnJlbnRWZWxvY2l0eTogbWFwT2JqZWN0KF96ZXJvMlsnZGVmYXVsdCddLCBjdXJyZW50U3R5bGUpXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMoKSB7XG4gICAgICB0aGlzLnN0YXJ0QW5pbWF0aW5nKCk7XG4gICAgfSxcblxuICAgIGFuaW1hdGlvblN0ZXA6IGZ1bmN0aW9uIGFuaW1hdGlvblN0ZXAodGltZXN0ZXAsIHN0YXRlKSB7XG4gICAgICB2YXIgY3VycmVudFN0eWxlID0gc3RhdGUuY3VycmVudFN0eWxlO1xuICAgICAgdmFyIGN1cnJlbnRWZWxvY2l0eSA9IHN0YXRlLmN1cnJlbnRWZWxvY2l0eTtcbiAgICAgIHZhciBzdHlsZSA9IHRoaXMucHJvcHMuc3R5bGU7XG5cbiAgICAgIHZhciBuZXdDdXJyZW50U3R5bGUgPSBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50U3R5bGUodGltZXN0ZXAsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXR5LCBzdHlsZSk7XG4gICAgICB2YXIgbmV3Q3VycmVudFZlbG9jaXR5ID0gX3VwZGF0ZVRyZWUudXBkYXRlQ3VycmVudFZlbG9jaXR5KHRpbWVzdGVwLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpO1xuXG4gICAgICAvLyBUT09EOiB0aGlzIGlzbid0IG5lY2Vzc2FyeSBhbnltb3JlLiBJdCB3YXMgdXNlZCBvbmx5IGFnYWluc3QgZW5kVmFsdWUgZnVuY1xuICAgICAgaWYgKF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKGN1cnJlbnRWZWxvY2l0eSwgbmV3Q3VycmVudFN0eWxlKSAmJiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXShuZXdDdXJyZW50VmVsb2NpdHksIG5ld0N1cnJlbnRTdHlsZSkpIHtcbiAgICAgICAgLy8gY2hlY2sgZXhwbGFuYXRpb24gaW4gYE1vdGlvbi5hbmltYXRpb25SZW5kZXJgXG4gICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpOyAvLyBOYXN0eSBzaWRlIGVmZmVjdHMuLi4uXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGN1cnJlbnRTdHlsZTogbmV3Q3VycmVudFN0eWxlLFxuICAgICAgICBjdXJyZW50VmVsb2NpdHk6IG5ld0N1cnJlbnRWZWxvY2l0eVxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgc3RvcEFuaW1hdGlvbjogbnVsbCxcblxuICAgIC8vIHVzZWQgaW4gYW5pbWF0aW9uUmVuZGVyXG4gICAgaGFzVW5tb3VudGVkOiBmYWxzZSxcblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuICAgICAgdGhpcy5oYXNVbm1vdW50ZWQgPSB0cnVlO1xuICAgIH0sXG5cbiAgICBzdGFydEFuaW1hdGluZzogZnVuY3Rpb24gc3RhcnRBbmltYXRpbmcoKSB7XG4gICAgICAvLyBJcyBzbWFydCBlbm91Z2ggdG8gbm90IHN0YXJ0IGl0IHR3aWNlXG4gICAgICB0aGlzLnN0b3BBbmltYXRpb24gPSBzdGFydEFuaW1hdGlvbih0aGlzLnN0YXRlLCB0aGlzLmFuaW1hdGlvblN0ZXAsIHRoaXMuYW5pbWF0aW9uUmVuZGVyKTtcbiAgICB9LFxuXG4gICAgYW5pbWF0aW9uUmVuZGVyOiBmdW5jdGlvbiBhbmltYXRpb25SZW5kZXIoYWxwaGEsIG5leHRTdGF0ZSwgcHJldlN0YXRlKSB7XG4gICAgICAvLyBgdGhpcy5oYXNVbm1vdW50ZWRgIG1pZ2h0IGJlIHRydWUgaW4gdGhlIGZvbGxvd2luZyBjb25kaXRpb246XG4gICAgICAvLyB1c2VyIGRvZXMgc29tZSBjaGVja3MgaW4gYHN0eWxlYCBhbmQgY2FsbHMgYW4gb3duZXIgaGFuZGxlclxuICAgICAgLy8gb3duZXIgc2V0cyBzdGF0ZSBpbiB0aGUgY2FsbGJhY2ssIHRyaWdnZXJpbmcgYSByZS1yZW5kZXJcbiAgICAgIC8vIHVubW91bnRzIE1vdGlvblxuICAgICAgaWYgKCF0aGlzLmhhc1VubW91bnRlZCkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBjdXJyZW50U3R5bGU6IF91cGRhdGVUcmVlLmludGVycG9sYXRlVmFsdWUoYWxwaGEsIG5leHRTdGF0ZS5jdXJyZW50U3R5bGUsIHByZXZTdGF0ZS5jdXJyZW50U3R5bGUpLFxuICAgICAgICAgIGN1cnJlbnRWZWxvY2l0eTogbmV4dFN0YXRlLmN1cnJlbnRWZWxvY2l0eVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgc3RyaXBwZWRTdHlsZSA9IF9zdHJpcFN0eWxlMlsnZGVmYXVsdCddKHRoaXMuc3RhdGUuY3VycmVudFN0eWxlKTtcbiAgICAgIHZhciByZW5kZXJlZENoaWxkcmVuID0gdGhpcy5wcm9wcy5jaGlsZHJlbihzdHJpcHBlZFN0eWxlKTtcbiAgICAgIHJldHVybiByZW5kZXJlZENoaWxkcmVuICYmIFJlYWN0LkNoaWxkcmVuLm9ubHkocmVuZGVyZWRDaGlsZHJlbik7XG4gICAgfVxuICB9KTtcblxuICB2YXIgU3RhZ2dlcmVkTW90aW9uID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICAgIGRpc3BsYXlOYW1lOiAnU3RhZ2dlcmVkTW90aW9uJyxcblxuICAgIHByb3BUeXBlczoge1xuICAgICAgZGVmYXVsdFN0eWxlOiBmdW5jdGlvbiBkZWZhdWx0U3R5bGUocHJvcCwgcHJvcE5hbWUpIHtcbiAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignWW91IGZvcmdvdCB0aGUgXCJzXCIgZm9yIGBTdGFnZ2VyZWRNb3Rpb25gXFwncyBgZGVmYXVsdFN0eWxlc2AuJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzdHlsZTogZnVuY3Rpb24gc3R5bGUocHJvcCwgcHJvcE5hbWUpIHtcbiAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignWW91IGZvcmdvdCB0aGUgXCJzXCIgZm9yIGBTdGFnZ2VyZWRNb3Rpb25gXFwncyBgc3R5bGVzYC4nKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIFRPT0Q6IHdhcm4gYWdhaW5zdCBwdXR0aW5nIGNvbmZpZ3MgaW4gaGVyZVxuICAgICAgZGVmYXVsdFN0eWxlczogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLm9iamVjdCksXG4gICAgICBzdHlsZXM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxuICAgIH0sXG5cbiAgICBnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uIGdldEluaXRpYWxTdGF0ZSgpIHtcbiAgICAgIHZhciBfcHJvcHMyID0gdGhpcy5wcm9wcztcbiAgICAgIHZhciBzdHlsZXMgPSBfcHJvcHMyLnN0eWxlcztcbiAgICAgIHZhciBkZWZhdWx0U3R5bGVzID0gX3Byb3BzMi5kZWZhdWx0U3R5bGVzO1xuXG4gICAgICB2YXIgY3VycmVudFN0eWxlcyA9IGRlZmF1bHRTdHlsZXMgPyBkZWZhdWx0U3R5bGVzIDogc3R5bGVzKCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjdXJyZW50U3R5bGVzOiBjdXJyZW50U3R5bGVzLFxuICAgICAgICBjdXJyZW50VmVsb2NpdGllczogY3VycmVudFN0eWxlcy5tYXAoZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICByZXR1cm4gbWFwT2JqZWN0KF96ZXJvMlsnZGVmYXVsdCddLCBzKTtcbiAgICAgICAgfSlcbiAgICAgIH07XG4gICAgfSxcblxuICAgIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcygpIHtcbiAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcbiAgICB9LFxuXG4gICAgYW5pbWF0aW9uU3RlcDogZnVuY3Rpb24gYW5pbWF0aW9uU3RlcCh0aW1lc3RlcCwgc3RhdGUpIHtcbiAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gc3RhdGUuY3VycmVudFN0eWxlcztcbiAgICAgIHZhciBjdXJyZW50VmVsb2NpdGllcyA9IHN0YXRlLmN1cnJlbnRWZWxvY2l0aWVzO1xuXG4gICAgICB2YXIgc3R5bGVzID0gdGhpcy5wcm9wcy5zdHlsZXMoY3VycmVudFN0eWxlcy5tYXAoX3N0cmlwU3R5bGUyWydkZWZhdWx0J10pKTtcblxuICAgICAgdmFyIG5ld0N1cnJlbnRTdHlsZXMgPSBjdXJyZW50U3R5bGVzLm1hcChmdW5jdGlvbiAoY3VycmVudFN0eWxlLCBpKSB7XG4gICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50U3R5bGUodGltZXN0ZXAsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXRpZXNbaV0sIHN0eWxlc1tpXSk7XG4gICAgICB9KTtcbiAgICAgIHZhciBuZXdDdXJyZW50VmVsb2NpdGllcyA9IGN1cnJlbnRTdHlsZXMubWFwKGZ1bmN0aW9uIChjdXJyZW50U3R5bGUsIGkpIHtcbiAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRWZWxvY2l0eSh0aW1lc3RlcCwgY3VycmVudFN0eWxlLCBjdXJyZW50VmVsb2NpdGllc1tpXSwgc3R5bGVzW2ldKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUT0RPOiBpcyB0aGlzIHJpZ2h0P1xuICAgICAgaWYgKGN1cnJlbnRWZWxvY2l0aWVzLmV2ZXJ5KGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBjdXJyZW50U3R5bGVzW2tdKTtcbiAgICAgIH0pICYmIG5ld0N1cnJlbnRWZWxvY2l0aWVzLmV2ZXJ5KGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBuZXdDdXJyZW50U3R5bGVzW2tdKTtcbiAgICAgIH0pKSB7XG4gICAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBjdXJyZW50U3R5bGVzOiBuZXdDdXJyZW50U3R5bGVzLFxuICAgICAgICBjdXJyZW50VmVsb2NpdGllczogbmV3Q3VycmVudFZlbG9jaXRpZXNcbiAgICAgIH07XG4gICAgfSxcblxuICAgIHN0b3BBbmltYXRpb246IG51bGwsXG5cbiAgICAvLyB1c2VkIGluIGFuaW1hdGlvblJlbmRlclxuICAgIGhhc1VubW91bnRlZDogZmFsc2UsXG5cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICB0aGlzLnN0b3BBbmltYXRpb24oKTtcbiAgICAgIHRoaXMuaGFzVW5tb3VudGVkID0gdHJ1ZTtcbiAgICB9LFxuXG4gICAgc3RhcnRBbmltYXRpbmc6IGZ1bmN0aW9uIHN0YXJ0QW5pbWF0aW5nKCkge1xuICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uID0gc3RhcnRBbmltYXRpb24odGhpcy5zdGF0ZSwgdGhpcy5hbmltYXRpb25TdGVwLCB0aGlzLmFuaW1hdGlvblJlbmRlcik7XG4gICAgfSxcblxuICAgIGFuaW1hdGlvblJlbmRlcjogZnVuY3Rpb24gYW5pbWF0aW9uUmVuZGVyKGFscGhhLCBuZXh0U3RhdGUsIHByZXZTdGF0ZSkge1xuICAgICAgLy8gU2VlIGNvbW1lbnQgaW4gTW90aW9uLlxuICAgICAgaWYgKCF0aGlzLmhhc1VubW91bnRlZCkge1xuICAgICAgICB2YXIgY3VycmVudFN0eWxlcyA9IG5leHRTdGF0ZS5jdXJyZW50U3R5bGVzLm1hcChmdW5jdGlvbiAoc3R5bGUsIGkpIHtcbiAgICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUuaW50ZXJwb2xhdGVWYWx1ZShhbHBoYSwgc3R5bGUsIHByZXZTdGF0ZS5jdXJyZW50U3R5bGVzW2ldKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIGN1cnJlbnRTdHlsZXM6IGN1cnJlbnRTdHlsZXMsXG4gICAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5leHRTdGF0ZS5jdXJyZW50VmVsb2NpdGllc1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgc3RyaXBwZWRTdHlsZSA9IHRoaXMuc3RhdGUuY3VycmVudFN0eWxlcy5tYXAoX3N0cmlwU3R5bGUyWydkZWZhdWx0J10pO1xuICAgICAgdmFyIHJlbmRlcmVkQ2hpbGRyZW4gPSB0aGlzLnByb3BzLmNoaWxkcmVuKHN0cmlwcGVkU3R5bGUpO1xuICAgICAgcmV0dXJuIHJlbmRlcmVkQ2hpbGRyZW4gJiYgUmVhY3QuQ2hpbGRyZW4ub25seShyZW5kZXJlZENoaWxkcmVuKTtcbiAgICB9XG4gIH0pO1xuXG4gIHZhciBUcmFuc2l0aW9uTW90aW9uID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuICAgIGRpc3BsYXlOYW1lOiAnVHJhbnNpdGlvbk1vdGlvbicsXG5cbiAgICBwcm9wVHlwZXM6IHtcbiAgICAgIGRlZmF1bHRWYWx1ZTogZnVuY3Rpb24gZGVmYXVsdFZhbHVlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1RyYW5zaXRpb25TcHJpbmdcXCdzIGBkZWZhdWx0VmFsdWVgIGhhcyBiZWVuIGNoYW5nZWQgdG8gJyArICdgZGVmYXVsdFN0eWxlc2AuIEl0cyBmb3JtYXQgcmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgJyArICdjaGFuZ2VzIGFzIHdlbGwuJyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBlbmRWYWx1ZTogZnVuY3Rpb24gZW5kVmFsdWUocHJvcCwgcHJvcE5hbWUpIHtcbiAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignVHJhbnNpdGlvblNwcmluZ1xcJ3MgYGVuZFZhbHVlYCBoYXMgYmVlbiBjaGFuZ2VkIHRvIGBzdHlsZXNgLiAnICsgJ0l0cyBmb3JtYXQgcmVjZWl2ZWQgYSBmZXcgKGVhc3kgdG8gdXBkYXRlISkgY2hhbmdlcyBhcyB3ZWxsLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZGVmYXVsdFN0eWxlOiBmdW5jdGlvbiBkZWZhdWx0U3R5bGUocHJvcCwgcHJvcE5hbWUpIHtcbiAgICAgICAgaWYgKHByb3BbcHJvcE5hbWVdKSB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignWW91IGZvcmdvdCB0aGUgXCJzXCIgZm9yIGBUcmFuc2l0aW9uTW90aW9uYFxcJ3MgYGRlZmF1bHRTdHlsZXNgLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc3R5bGU6IGZ1bmN0aW9uIHN0eWxlKHByb3AsIHByb3BOYW1lKSB7XG4gICAgICAgIGlmIChwcm9wW3Byb3BOYW1lXSkge1xuICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1lvdSBmb3Jnb3QgdGhlIFwic1wiIGZvciBgVHJhbnNpdGlvbk1vdGlvbmBcXCdzIGBzdHlsZXNgLicpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgLy8gVE9PRDogd2FybiBhZ2FpbnN0IHB1dHRpbmcgY29uZmlncyBpbiBoZXJlXG4gICAgICBkZWZhdWx0U3R5bGVzOiBQcm9wVHlwZXMub2JqZWN0T2YoUHJvcFR5cGVzLmFueSksXG4gICAgICBzdHlsZXM6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5mdW5jLCBQcm9wVHlwZXMub2JqZWN0T2YoUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkKV0pLmlzUmVxdWlyZWQsXG4gICAgICB3aWxsTGVhdmU6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5mdW5jXSksXG4gICAgICAvLyBUT09EOiB3YXJuIGFnYWluc3QgcHV0dGluZyBjb25maWdzIGluIGhlcmVcbiAgICAgIHdpbGxFbnRlcjogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmZ1bmNdKSxcbiAgICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkXG4gICAgfSxcblxuICAgIGdldERlZmF1bHRQcm9wczogZnVuY3Rpb24gZ2V0RGVmYXVsdFByb3BzKCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2lsbEVudGVyOiBmdW5jdGlvbiB3aWxsRW50ZXIoa2V5LCB2YWx1ZSkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgd2lsbExlYXZlOiBmdW5jdGlvbiB3aWxsTGVhdmUoKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcblxuICAgIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24gZ2V0SW5pdGlhbFN0YXRlKCkge1xuICAgICAgdmFyIF9wcm9wczMgPSB0aGlzLnByb3BzO1xuICAgICAgdmFyIHN0eWxlcyA9IF9wcm9wczMuc3R5bGVzO1xuICAgICAgdmFyIGRlZmF1bHRTdHlsZXMgPSBfcHJvcHMzLmRlZmF1bHRTdHlsZXM7XG5cbiAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gdW5kZWZpbmVkO1xuICAgICAgaWYgKGRlZmF1bHRTdHlsZXMgPT0gbnVsbCkge1xuICAgICAgICBpZiAodHlwZW9mIHN0eWxlcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGN1cnJlbnRTdHlsZXMgPSBzdHlsZXMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjdXJyZW50U3R5bGVzID0gc3R5bGVzO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjdXJyZW50U3R5bGVzID0gZGVmYXVsdFN0eWxlcztcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGN1cnJlbnRTdHlsZXM6IGN1cnJlbnRTdHlsZXMsXG4gICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzOiBtYXBPYmplY3QoZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICByZXR1cm4gbWFwT2JqZWN0KF96ZXJvMlsnZGVmYXVsdCddLCBzKTtcbiAgICAgICAgfSwgY3VycmVudFN0eWxlcylcbiAgICAgIH07XG4gICAgfSxcblxuICAgIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcbiAgICB9LFxuXG4gICAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24gY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcygpIHtcbiAgICAgIHRoaXMuc3RhcnRBbmltYXRpbmcoKTtcbiAgICB9LFxuXG4gICAgYW5pbWF0aW9uU3RlcDogZnVuY3Rpb24gYW5pbWF0aW9uU3RlcCh0aW1lc3RlcCwgc3RhdGUpIHtcbiAgICAgIHZhciBjdXJyZW50U3R5bGVzID0gc3RhdGUuY3VycmVudFN0eWxlcztcbiAgICAgIHZhciBjdXJyZW50VmVsb2NpdGllcyA9IHN0YXRlLmN1cnJlbnRWZWxvY2l0aWVzO1xuICAgICAgdmFyIF9wcm9wczQgPSB0aGlzLnByb3BzO1xuICAgICAgdmFyIHN0eWxlcyA9IF9wcm9wczQuc3R5bGVzO1xuICAgICAgdmFyIHdpbGxFbnRlciA9IF9wcm9wczQud2lsbEVudGVyO1xuICAgICAgdmFyIHdpbGxMZWF2ZSA9IF9wcm9wczQud2lsbExlYXZlO1xuXG4gICAgICBpZiAodHlwZW9mIHN0eWxlcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBzdHlsZXMgPSBzdHlsZXMoY3VycmVudFN0eWxlcyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFRPRE86IGh1aD9cbiAgICAgIHZhciBtZXJnZWRTdHlsZXMgPSBzdHlsZXM7IC8vIHNldCBtZXJnZWRTdHlsZXMgdG8gc3R5bGVzIGFzIHRoZSBkZWZhdWx0XG4gICAgICB2YXIgaGFzTmV3S2V5ID0gZmFsc2U7XG5cbiAgICAgIG1lcmdlZFN0eWxlcyA9IF9tZXJnZURpZmYyWydkZWZhdWx0J10oY3VycmVudFN0eWxlcywgc3R5bGVzLFxuICAgICAgLy8gVE9ETzogc3RvcCBhbGxvY2F0aW5nIGxpa2UgY3JhenkgaW4gdGhpcyB3aG9sZSBjb2RlIHBhdGhcbiAgICAgIGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgdmFyIHJlcyA9IHdpbGxMZWF2ZShrZXksIGN1cnJlbnRTdHlsZXNba2V5XSwgc3R5bGVzLCBjdXJyZW50U3R5bGVzLCBjdXJyZW50VmVsb2NpdGllcyk7XG4gICAgICAgIGlmIChyZXMgPT0gbnVsbCkge1xuICAgICAgICAgIC8vIEZvciBsZWdhY3kgcmVhc29uLiBXZSB3b24ndCBhbGxvdyByZXR1cm5pbmcgbnVsbCBzb29uXG4gICAgICAgICAgLy8gVE9ETzogcmVtb3ZlLCBhZnRlciBuZXh0IHJlbGVhc2VcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXShjdXJyZW50VmVsb2NpdGllc1trZXldLCBjdXJyZW50U3R5bGVzW2tleV0pICYmIF9oYXNSZWFjaGVkU3R5bGUyWydkZWZhdWx0J10oY3VycmVudFN0eWxlc1trZXldLCByZXMpKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH0pO1xuXG4gICAgICBPYmplY3Qua2V5cyhtZXJnZWRTdHlsZXMpLmZpbHRlcihmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiAhY3VycmVudFN0eWxlcy5oYXNPd25Qcm9wZXJ0eShrZXkpO1xuICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHZhciBfZXh0ZW5kczIsIF9leHRlbmRzMztcblxuICAgICAgICBoYXNOZXdLZXkgPSB0cnVlO1xuICAgICAgICB2YXIgZW50ZXJTdHlsZSA9IHdpbGxFbnRlcihrZXksIG1lcmdlZFN0eWxlc1trZXldLCBzdHlsZXMsIGN1cnJlbnRTdHlsZXMsIGN1cnJlbnRWZWxvY2l0aWVzKTtcblxuICAgICAgICAvLyBXZSBjYW4gbXV0YXRlIHRoaXMgaGVyZSBiZWNhdXNlIG1lcmdlRGlmZiByZXR1cm5zIGEgbmV3IE9ialxuICAgICAgICBtZXJnZWRTdHlsZXNba2V5XSA9IGVudGVyU3R5bGU7XG5cbiAgICAgICAgY3VycmVudFN0eWxlcyA9IF9leHRlbmRzKHt9LCBjdXJyZW50U3R5bGVzLCAoX2V4dGVuZHMyID0ge30sIF9leHRlbmRzMltrZXldID0gZW50ZXJTdHlsZSwgX2V4dGVuZHMyKSk7XG4gICAgICAgIGN1cnJlbnRWZWxvY2l0aWVzID0gX2V4dGVuZHMoe30sIGN1cnJlbnRWZWxvY2l0aWVzLCAoX2V4dGVuZHMzID0ge30sIF9leHRlbmRzM1trZXldID0gbWFwT2JqZWN0KF96ZXJvMlsnZGVmYXVsdCddLCBlbnRlclN0eWxlKSwgX2V4dGVuZHMzKSk7XG4gICAgICB9KTtcblxuICAgICAgdmFyIG5ld0N1cnJlbnRTdHlsZXMgPSBtYXBPYmplY3QoZnVuY3Rpb24gKG1lcmdlZFN0eWxlLCBrZXkpIHtcbiAgICAgICAgcmV0dXJuIF91cGRhdGVUcmVlLnVwZGF0ZUN1cnJlbnRTdHlsZSh0aW1lc3RlcCwgY3VycmVudFN0eWxlc1trZXldLCBjdXJyZW50VmVsb2NpdGllc1trZXldLCBtZXJnZWRTdHlsZSk7XG4gICAgICB9LCBtZXJnZWRTdHlsZXMpO1xuICAgICAgdmFyIG5ld0N1cnJlbnRWZWxvY2l0aWVzID0gbWFwT2JqZWN0KGZ1bmN0aW9uIChtZXJnZWRTdHlsZSwga2V5KSB7XG4gICAgICAgIHJldHVybiBfdXBkYXRlVHJlZS51cGRhdGVDdXJyZW50VmVsb2NpdHkodGltZXN0ZXAsIGN1cnJlbnRTdHlsZXNba2V5XSwgY3VycmVudFZlbG9jaXRpZXNba2V5XSwgbWVyZ2VkU3R5bGUpO1xuICAgICAgfSwgbWVyZ2VkU3R5bGVzKTtcblxuICAgICAgaWYgKCFoYXNOZXdLZXkgJiYgZXZlcnlPYmooZnVuY3Rpb24gKHYsIGspIHtcbiAgICAgICAgcmV0dXJuIF9ub1ZlbG9jaXR5MlsnZGVmYXVsdCddKHYsIGN1cnJlbnRTdHlsZXNba10pO1xuICAgICAgfSwgY3VycmVudFZlbG9jaXRpZXMpICYmIGV2ZXJ5T2JqKGZ1bmN0aW9uICh2LCBrKSB7XG4gICAgICAgIHJldHVybiBfbm9WZWxvY2l0eTJbJ2RlZmF1bHQnXSh2LCBuZXdDdXJyZW50U3R5bGVzW2tdKTtcbiAgICAgIH0sIG5ld0N1cnJlbnRWZWxvY2l0aWVzKSkge1xuICAgICAgICAvLyBjaGVjayBleHBsYW5hdGlvbiBpbiBgTW90aW9uLmFuaW1hdGlvblJlbmRlcmBcbiAgICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7IC8vIE5hc3R5IHNpZGUgZWZmZWN0cy4uLi5cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY3VycmVudFN0eWxlczogbmV3Q3VycmVudFN0eWxlcyxcbiAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5ld0N1cnJlbnRWZWxvY2l0aWVzXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBzdG9wQW5pbWF0aW9uOiBudWxsLFxuXG4gICAgLy8gdXNlZCBpbiBhbmltYXRpb25SZW5kZXJcbiAgICBoYXNVbm1vdW50ZWQ6IGZhbHNlLFxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgdGhpcy5zdG9wQW5pbWF0aW9uKCk7XG4gICAgICB0aGlzLmhhc1VubW91bnRlZCA9IHRydWU7XG4gICAgfSxcblxuICAgIHN0YXJ0QW5pbWF0aW5nOiBmdW5jdGlvbiBzdGFydEFuaW1hdGluZygpIHtcbiAgICAgIHRoaXMuc3RvcEFuaW1hdGlvbiA9IHN0YXJ0QW5pbWF0aW9uKHRoaXMuc3RhdGUsIHRoaXMuYW5pbWF0aW9uU3RlcCwgdGhpcy5hbmltYXRpb25SZW5kZXIpO1xuICAgIH0sXG5cbiAgICBhbmltYXRpb25SZW5kZXI6IGZ1bmN0aW9uIGFuaW1hdGlvblJlbmRlcihhbHBoYSwgbmV4dFN0YXRlLCBwcmV2U3RhdGUpIHtcbiAgICAgIC8vIFNlZSBjb21tZW50IGluIE1vdGlvbi5cbiAgICAgIGlmICghdGhpcy5oYXNVbm1vdW50ZWQpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRTdHlsZXMgPSBtYXBPYmplY3QoZnVuY3Rpb24gKHN0eWxlLCBrZXkpIHtcbiAgICAgICAgICByZXR1cm4gX3VwZGF0ZVRyZWUuaW50ZXJwb2xhdGVWYWx1ZShhbHBoYSwgc3R5bGUsIHByZXZTdGF0ZS5jdXJyZW50U3R5bGVzW2tleV0pO1xuICAgICAgICB9LCBuZXh0U3RhdGUuY3VycmVudFN0eWxlcyk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIGN1cnJlbnRTdHlsZXM6IGN1cnJlbnRTdHlsZXMsXG4gICAgICAgICAgY3VycmVudFZlbG9jaXRpZXM6IG5leHRTdGF0ZS5jdXJyZW50VmVsb2NpdGllc1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB2YXIgc3RyaXBwZWRTdHlsZSA9IG1hcE9iamVjdChfc3RyaXBTdHlsZTJbJ2RlZmF1bHQnXSwgdGhpcy5zdGF0ZS5jdXJyZW50U3R5bGVzKTtcbiAgICAgIHZhciByZW5kZXJlZENoaWxkcmVuID0gdGhpcy5wcm9wcy5jaGlsZHJlbihzdHJpcHBlZFN0eWxlKTtcbiAgICAgIHJldHVybiByZW5kZXJlZENoaWxkcmVuICYmIFJlYWN0LkNoaWxkcmVuLm9ubHkocmVuZGVyZWRDaGlsZHJlbik7XG4gICAgfVxuICB9KTtcblxuICB2YXIgX2RlcHJlY2F0ZWRTcHJpbmdzID0gX2RlcHJlY2F0ZWRTcHJpbmdzM1snZGVmYXVsdCddKFJlYWN0KTtcblxuICB2YXIgU3ByaW5nID0gX2RlcHJlY2F0ZWRTcHJpbmdzLlNwcmluZztcbiAgdmFyIFRyYW5zaXRpb25TcHJpbmcgPSBfZGVwcmVjYXRlZFNwcmluZ3MuVHJhbnNpdGlvblNwcmluZztcblxuICByZXR1cm4geyBTcHJpbmc6IFNwcmluZywgVHJhbnNpdGlvblNwcmluZzogVHJhbnNpdGlvblNwcmluZywgTW90aW9uOiBNb3Rpb24sIFN0YWdnZXJlZE1vdGlvbjogU3RhZ2dlcmVkTW90aW9uLCBUcmFuc2l0aW9uTW90aW9uOiBUcmFuc2l0aW9uTW90aW9uIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvY29tcG9uZW50cy5qc1xuICoqIG1vZHVsZSBpZCA9IDIzXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzWydkZWZhdWx0J10gPSBkZXByZWNhdGVkU3ByaW5ncztcbnZhciBoYXNXYXJuZWRGb3JTcHJpbmcgPSB7fTtcbnZhciBoYXNXYXJuZWRGb3JUcmFuc2l0aW9uU3ByaW5nID0ge307XG5cbmZ1bmN0aW9uIGRlcHJlY2F0ZWRTcHJpbmdzKFJlYWN0KSB7XG4gIHZhciBTcHJpbmcgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gICAgZGlzcGxheU5hbWU6ICdTcHJpbmcnLFxuXG4gICAgY29tcG9uZW50V2lsbE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgICAgdmFyIG93bmVyTmFtZSA9IHRoaXMuX3JlYWN0SW50ZXJuYWxJbnN0YW5jZS5fY3VycmVudEVsZW1lbnQuX293bmVyICYmIHRoaXMuX3JlYWN0SW50ZXJuYWxJbnN0YW5jZS5fY3VycmVudEVsZW1lbnQuX293bmVyLmdldE5hbWUoKTtcbiAgICAgICAgaWYgKCFoYXNXYXJuZWRGb3JTcHJpbmdbb3duZXJOYW1lXSkge1xuICAgICAgICAgIGhhc1dhcm5lZEZvclNwcmluZ1tvd25lck5hbWVdID0gdHJ1ZTtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdTcHJpbmcgKHVzZWQgaW4gJXNyZW5kZXIpIGhhcyBub3cgYmVlbiByZW5hbWVkIHRvIE1vdGlvbi4gJyArICdQbGVhc2Ugc2VlIHRoZSByZWxlYXNlIG5vdGUgZm9yIHRoZSB1cGdyYWRlIHBhdGguIFRoYW5rIHlvdSEnLCBvd25lck5hbWUgPyBvd25lck5hbWUgKyAnXFwncyAnIDogJ1JlYWN0LicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9KTtcblxuICB2YXIgVHJhbnNpdGlvblNwcmluZyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgICBkaXNwbGF5TmFtZTogJ1RyYW5zaXRpb25TcHJpbmcnLFxuXG4gICAgY29tcG9uZW50V2lsbE1vdW50OiBmdW5jdGlvbiBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgICAgdmFyIG93bmVyTmFtZSA9IHRoaXMuX3JlYWN0SW50ZXJuYWxJbnN0YW5jZS5fY3VycmVudEVsZW1lbnQuX293bmVyICYmIHRoaXMuX3JlYWN0SW50ZXJuYWxJbnN0YW5jZS5fY3VycmVudEVsZW1lbnQuX293bmVyLmdldE5hbWUoKTtcbiAgICAgICAgaWYgKCFoYXNXYXJuZWRGb3JUcmFuc2l0aW9uU3ByaW5nW293bmVyTmFtZV0pIHtcbiAgICAgICAgICBoYXNXYXJuZWRGb3JUcmFuc2l0aW9uU3ByaW5nW293bmVyTmFtZV0gPSB0cnVlO1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RyYW5zaXRpb25TcHJpbmcgKHVzZWQgaW4gJXNyZW5kZXIpIGhhcyBub3cgYmVlbiByZW5hbWVkIHRvICcgKyAnVHJhbnNpdGlvbk1vdGlvbi4gUGxlYXNlIHNlZSB0aGUgcmVsZWFzZSBub3RlIGZvciB0aGUgdXBncmFkZSAnICsgJ3BhdGguIFRoYW5rIHlvdSEnLCBvd25lck5hbWUgPyBvd25lck5hbWUgKyAnXFwncyAnIDogJ1JlYWN0LicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4geyBTcHJpbmc6IFNwcmluZywgVHJhbnNpdGlvblNwcmluZzogVHJhbnNpdGlvblNwcmluZyB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL2RlcHJlY2F0ZWRTcHJpbmdzLmpzXG4gKiogbW9kdWxlIGlkID0gMjRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBoYXNSZWFjaGVkU3R5bGU7XG5cbmZ1bmN0aW9uIGhhc1JlYWNoZWRTdHlsZShjdXJyZW50U3R5bGUsIHN0eWxlKSB7XG4gIGZvciAodmFyIGtleSBpbiBzdHlsZSkge1xuICAgIGlmICghc3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHZhciBjdXJyZW50VmFsdWUgPSBjdXJyZW50U3R5bGVba2V5XTtcbiAgICB2YXIgZGVzdFZhbHVlID0gc3R5bGVba2V5XTtcbiAgICBpZiAoIWRlc3RWYWx1ZS5jb25maWcpIHtcbiAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWdcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoY3VycmVudFZhbHVlLmNvbmZpZyAmJiBjdXJyZW50VmFsdWUudmFsICE9PSBkZXN0VmFsdWUudmFsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICghY3VycmVudFZhbHVlLmNvbmZpZyAmJiBjdXJyZW50VmFsdWUgIT09IGRlc3RWYWx1ZS52YWwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL2hhc1JlYWNoZWRTdHlsZS5qc1xuICoqIG1vZHVsZSBpZCA9IDI1XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyB0aGlzIGZ1bmN0aW9uIGlzIGFsbG9jYXRpb24tbGVzcyB0aGFua3MgdG8gYmFiZWwsIHdoaWNoIHRyYW5zZm9ybXMgdGhlIHRhaWxcbi8vIGNhbGxzIGludG8gbG9vcHNcblwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBtZXJnZURpZmY7XG5mdW5jdGlvbiBtZXJnZURpZmZBcnIoX3gsIF94MiwgX3gzLCBfeDQsIF94NSwgX3g2LCBfeDcpIHtcbiAgdmFyIF9hZ2FpbiA9IHRydWU7XG5cbiAgX2Z1bmN0aW9uOiB3aGlsZSAoX2FnYWluKSB7XG4gICAgdmFyIGFyckEgPSBfeCxcbiAgICAgICAgYXJyQiA9IF94MixcbiAgICAgICAgY29sbEIgPSBfeDMsXG4gICAgICAgIGluZGV4QSA9IF94NCxcbiAgICAgICAgaW5kZXhCID0gX3g1LFxuICAgICAgICBvblJlbW92ZSA9IF94NixcbiAgICAgICAgYWNjdW0gPSBfeDc7XG4gICAgZW5kQSA9IGVuZEIgPSBrZXlBID0ga2V5QiA9IGZpbGwgPSBmaWxsID0gdW5kZWZpbmVkO1xuICAgIF9hZ2FpbiA9IGZhbHNlO1xuXG4gICAgdmFyIGVuZEEgPSBpbmRleEEgPT09IGFyckEubGVuZ3RoO1xuICAgIHZhciBlbmRCID0gaW5kZXhCID09PSBhcnJCLmxlbmd0aDtcbiAgICB2YXIga2V5QSA9IGFyckFbaW5kZXhBXTtcbiAgICB2YXIga2V5QiA9IGFyckJbaW5kZXhCXTtcbiAgICBpZiAoZW5kQSAmJiBlbmRCKSB7XG4gICAgICAvLyByZXR1cm5pbmcgbnVsbCBoZXJlLCBvdGhlcndpc2UgbGludCBjb21wbGFpbnMgdGhhdCB3ZSdyZSBub3QgZXhwZWN0aW5nXG4gICAgICAvLyBhIHJldHVybiB2YWx1ZSBpbiBzdWJzZXF1ZW50IGNhbGxzLiBXZSBrbm93IHdoYXQgd2UncmUgZG9pbmcuXG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAoZW5kQSkge1xuICAgICAgYWNjdW1ba2V5Ql0gPSBjb2xsQltrZXlCXTtcbiAgICAgIF94ID0gYXJyQTtcbiAgICAgIF94MiA9IGFyckI7XG4gICAgICBfeDMgPSBjb2xsQjtcbiAgICAgIF94NCA9IGluZGV4QTtcbiAgICAgIF94NSA9IGluZGV4QiArIDE7XG4gICAgICBfeDYgPSBvblJlbW92ZTtcbiAgICAgIF94NyA9IGFjY3VtO1xuICAgICAgX2FnYWluID0gdHJ1ZTtcbiAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcbiAgICB9XG5cbiAgICBpZiAoZW5kQikge1xuICAgICAgdmFyIGZpbGwgPSBvblJlbW92ZShrZXlBKTtcbiAgICAgIGlmIChmaWxsICE9IG51bGwpIHtcbiAgICAgICAgYWNjdW1ba2V5QV0gPSBmaWxsO1xuICAgICAgfVxuICAgICAgX3ggPSBhcnJBO1xuICAgICAgX3gyID0gYXJyQjtcbiAgICAgIF94MyA9IGNvbGxCO1xuICAgICAgX3g0ID0gaW5kZXhBICsgMTtcbiAgICAgIF94NSA9IGluZGV4QjtcbiAgICAgIF94NiA9IG9uUmVtb3ZlO1xuICAgICAgX3g3ID0gYWNjdW07XG4gICAgICBfYWdhaW4gPSB0cnVlO1xuICAgICAgY29udGludWUgX2Z1bmN0aW9uO1xuICAgIH1cblxuICAgIGlmIChrZXlBID09PSBrZXlCKSB7XG4gICAgICBhY2N1bVtrZXlBXSA9IGNvbGxCW2tleUFdO1xuICAgICAgX3ggPSBhcnJBO1xuICAgICAgX3gyID0gYXJyQjtcbiAgICAgIF94MyA9IGNvbGxCO1xuICAgICAgX3g0ID0gaW5kZXhBICsgMTtcbiAgICAgIF94NSA9IGluZGV4QiArIDE7XG4gICAgICBfeDYgPSBvblJlbW92ZTtcbiAgICAgIF94NyA9IGFjY3VtO1xuICAgICAgX2FnYWluID0gdHJ1ZTtcbiAgICAgIGNvbnRpbnVlIF9mdW5jdGlvbjtcbiAgICB9XG5cbiAgICBpZiAoIWNvbGxCLmhhc093blByb3BlcnR5KGtleUEpKSB7XG4gICAgICB2YXIgZmlsbCA9IG9uUmVtb3ZlKGtleUEpO1xuICAgICAgaWYgKGZpbGwgIT0gbnVsbCkge1xuICAgICAgICBhY2N1bVtrZXlBXSA9IGZpbGw7XG4gICAgICB9XG4gICAgICBfeCA9IGFyckE7XG4gICAgICBfeDIgPSBhcnJCO1xuICAgICAgX3gzID0gY29sbEI7XG4gICAgICBfeDQgPSBpbmRleEEgKyAxO1xuICAgICAgX3g1ID0gaW5kZXhCO1xuICAgICAgX3g2ID0gb25SZW1vdmU7XG4gICAgICBfeDcgPSBhY2N1bTtcbiAgICAgIF9hZ2FpbiA9IHRydWU7XG4gICAgICBjb250aW51ZSBfZnVuY3Rpb247XG4gICAgfVxuXG4gICAgX3ggPSBhcnJBO1xuICAgIF94MiA9IGFyckI7XG4gICAgX3gzID0gY29sbEI7XG4gICAgX3g0ID0gaW5kZXhBICsgMTtcbiAgICBfeDUgPSBpbmRleEI7XG4gICAgX3g2ID0gb25SZW1vdmU7XG4gICAgX3g3ID0gYWNjdW07XG4gICAgX2FnYWluID0gdHJ1ZTtcbiAgICBjb250aW51ZSBfZnVuY3Rpb247XG4gIH1cbn1cblxuZnVuY3Rpb24gbWVyZ2VEaWZmKGEsIGIsIG9uUmVtb3ZlKSB7XG4gIHZhciByZXQgPSB7fTtcbiAgLy8gaWYgYW55b25lIGNhbiBtYWtlIHRoaXMgd29yayB3aXRob3V0IGFsbG9jYXRpbmcgdGhlIGFycmF5cyBoZXJlLCB3ZSdsbFxuICAvLyBnaXZlIHlvdSBhIG1lZGFsXG4gIG1lcmdlRGlmZkFycihPYmplY3Qua2V5cyhhKSwgT2JqZWN0LmtleXMoYiksIGIsIDAsIDAsIG9uUmVtb3ZlLCByZXQpO1xuICByZXR1cm4gcmV0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvbWVyZ2VEaWZmLmpzXG4gKiogbW9kdWxlIGlkID0gMjZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIGN1cnJlbnRTdHlsZSBrZWVwcyB0aGUgaW5mbyBhYm91dCB3aGV0aGVyIGEgcHJvcCBpcyBjb25maWd1cmVkIGFzIGEgc3ByaW5nXG4vLyBvciBpZiBpdCdzIGp1c3QgYSByYW5kb20gcHJvcCB0aGF0IGhhcHBlbnMgdG8gYmUgcHJlc2VudCBvbiB0aGUgc3R5bGVcblwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBub1ZlbG9jaXR5O1xuXG5mdW5jdGlvbiBub1ZlbG9jaXR5KGN1cnJlbnRWZWxvY2l0eSwgY3VycmVudFN0eWxlKSB7XG4gIGZvciAodmFyIGtleSBpbiBjdXJyZW50VmVsb2NpdHkpIHtcbiAgICBpZiAoIWN1cnJlbnRWZWxvY2l0eS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGN1cnJlbnRTdHlsZVtrZXldLmNvbmZpZyAmJiBjdXJyZW50VmVsb2NpdHlba2V5XSAhPT0gMCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL25vVmVsb2NpdHkuanNcbiAqKiBtb2R1bGUgaWQgPSAyN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHJlb3JkZXJLZXlzO1xuXG5mdW5jdGlvbiByZW9yZGVyS2V5cyhvYmosIGYpIHtcbiAgdmFyIG5ld0tleXMgPSBmKE9iamVjdC5rZXlzKG9iaikpO1xuICB2YXIgcmV0ID0ge307XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbmV3S2V5cy5sZW5ndGg7IGkrKykge1xuICAgIHZhciBrZXkgPSBuZXdLZXlzW2ldO1xuICAgIHJldFtrZXldID0gb2JqW2tleV07XG4gIH1cblxuICByZXR1cm4gcmV0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvcmVvcmRlcktleXMuanNcbiAqKiBtb2R1bGUgaWQgPSAyOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiJ3VzZSBzdHJpY3QnO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1snZGVmYXVsdCddID0gc3ByaW5nO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyAnZGVmYXVsdCc6IG9iaiB9OyB9XG5cbnZhciBfcHJlc2V0cyA9IHJlcXVpcmUoJy4vcHJlc2V0cycpO1xuXG52YXIgX3ByZXNldHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJlc2V0cyk7XG5cbi8vIGluc3RlYWQgb2YgZXhwb3Npbmcge3ZhbDogYmxhLCBjb25maWc6IGJsYX0sIHVzZSBhIGhlbHBlclxuXG5mdW5jdGlvbiBzcHJpbmcodmFsKSB7XG4gIHZhciBjb25maWcgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyBfcHJlc2V0czJbJ2RlZmF1bHQnXS5ub1dvYmJsZSA6IGFyZ3VtZW50c1sxXTtcblxuICByZXR1cm4geyB2YWw6IHZhbCwgY29uZmlnOiBjb25maWcgfTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL34vcmVhY3QtbW90aW9uL2xpYi9zcHJpbmcuanNcbiAqKiBtb2R1bGUgaWQgPSAyOVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IHN0ZXBwZXI7XG52YXIgZXJyb3JNYXJnaW4gPSAwLjAwMDE7XG5cbmZ1bmN0aW9uIHN0ZXBwZXIoZnJhbWVSYXRlLCB4LCB2LCBkZXN0WCwgaywgYikge1xuICAvLyBTcHJpbmcgc3RpZmZuZXNzLCBpbiBrZyAvIHNeMlxuXG4gIC8vIGZvciBhbmltYXRpb25zLCBkZXN0WCBpcyByZWFsbHkgc3ByaW5nIGxlbmd0aCAoc3ByaW5nIGF0IHJlc3QpLiBpbml0aWFsXG4gIC8vIHBvc2l0aW9uIGlzIGNvbnNpZGVyZWQgYXMgdGhlIHN0cmV0Y2hlZC9jb21wcmVzc2VkIHBvc2l0aW9uIG9mIGEgc3ByaW5nXG4gIHZhciBGc3ByaW5nID0gLWsgKiAoeCAtIGRlc3RYKTtcblxuICAvLyBEYW1waW5nLCBpbiBrZyAvIHNcbiAgdmFyIEZkYW1wZXIgPSAtYiAqIHY7XG5cbiAgLy8gdXN1YWxseSB3ZSBwdXQgbWFzcyBoZXJlLCBidXQgZm9yIGFuaW1hdGlvbiBwdXJwb3Nlcywgc3BlY2lmeWluZyBtYXNzIGlzIGFcbiAgLy8gYml0IHJlZHVuZGFudC4geW91IGNvdWxkIHNpbXBseSBhZGp1c3QgayBhbmQgYiBhY2NvcmRpbmdseVxuICAvLyBsZXQgYSA9IChGc3ByaW5nICsgRmRhbXBlcikgLyBtYXNzO1xuICB2YXIgYSA9IEZzcHJpbmcgKyBGZGFtcGVyO1xuXG4gIHZhciBuZXdWID0gdiArIGEgKiBmcmFtZVJhdGU7XG4gIHZhciBuZXdYID0geCArIG5ld1YgKiBmcmFtZVJhdGU7XG5cbiAgaWYgKE1hdGguYWJzKG5ld1YgLSB2KSA8IGVycm9yTWFyZ2luICYmIE1hdGguYWJzKG5ld1ggLSB4KSA8IGVycm9yTWFyZ2luKSB7XG4gICAgcmV0dXJuIFtkZXN0WCwgMF07XG4gIH1cblxuICByZXR1cm4gW25ld1gsIG5ld1ZdO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvc3RlcHBlci5qc1xuICoqIG1vZHVsZSBpZCA9IDMwXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyB0dXJuIHt4OiB7dmFsOiAxLCBjb25maWc6IFsxLCAyXX0sIHk6IDJ9IGludG8ge3g6IDEsIHk6IDJ9XG5cInVzZSBzdHJpY3RcIjtcblxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gc3RyaXBTdHlsZTtcblxuZnVuY3Rpb24gc3RyaXBTdHlsZShzdHlsZSkge1xuICB2YXIgcmV0ID0ge307XG4gIGZvciAodmFyIGtleSBpbiBzdHlsZSkge1xuICAgIGlmICghc3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHJldFtrZXldID0gc3R5bGVba2V5XS52YWwgPT0gbnVsbCA/IHN0eWxlW2tleV0gOiBzdHlsZVtrZXldLnZhbDtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbXCJkZWZhdWx0XCJdO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvc3RyaXBTdHlsZS5qc1xuICoqIG1vZHVsZSBpZCA9IDMxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIndXNlIHN0cmljdCc7XG5cbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XG5leHBvcnRzLmludGVycG9sYXRlVmFsdWUgPSBpbnRlcnBvbGF0ZVZhbHVlO1xuZXhwb3J0cy51cGRhdGVDdXJyZW50U3R5bGUgPSB1cGRhdGVDdXJyZW50U3R5bGU7XG5leHBvcnRzLnVwZGF0ZUN1cnJlbnRWZWxvY2l0eSA9IHVwZGF0ZUN1cnJlbnRWZWxvY2l0eTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgJ2RlZmF1bHQnOiBvYmogfTsgfVxuXG52YXIgX3N0ZXBwZXIgPSByZXF1aXJlKCcuL3N0ZXBwZXInKTtcblxudmFyIF9zdGVwcGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3N0ZXBwZXIpO1xuXG4vLyBUT0RPOiByZWZhY3RvciBjb21tb24gbG9naWMgd2l0aCB1cGRhdGVDdXJyVmFsdWUgYW5kIHVwZGF0ZUN1cnJWZWxvY2l0eVxuXG5mdW5jdGlvbiBpbnRlcnBvbGF0ZVZhbHVlKGFscGhhLCBuZXh0U3R5bGUsIHByZXZTdHlsZSkge1xuICAvLyBtaWdodCBiZSB1c2VkIGJ5IGEgVHJhbnNpdGlvbk1vdGlvbiwgd2hlcmUgcHJldlN0eWxlIG1pZ2h0IG5vdCBleGlzdCBhbnltb3JlXG4gIGlmICghcHJldlN0eWxlKSB7XG4gICAgcmV0dXJuIG5leHRTdHlsZTtcbiAgfVxuXG4gIHZhciByZXQgPSB7fTtcbiAgZm9yICh2YXIga2V5IGluIG5leHRTdHlsZSkge1xuICAgIGlmICghbmV4dFN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGlmICghbmV4dFN0eWxlW2tleV0uY29uZmlnKSB7XG4gICAgICByZXRba2V5XSA9IG5leHRTdHlsZVtrZXldO1xuICAgICAgLy8gbm90IGEgc3ByaW5nIGNvbmZpZywgbm90IHNvbWV0aGluZyB3ZSB3YW50IHRvIGludGVycG9sYXRlXG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgdmFyIHByZXZWYWx1ZSA9IHByZXZTdHlsZVtrZXldLmNvbmZpZyA/IHByZXZTdHlsZVtrZXldLnZhbCA6IHByZXZTdHlsZVtrZXldO1xuICAgIHJldFtrZXldID0ge1xuICAgICAgdmFsOiBuZXh0U3R5bGVba2V5XS52YWwgKiBhbHBoYSArIHByZXZWYWx1ZSAqICgxIC0gYWxwaGEpLFxuICAgICAgY29uZmlnOiBuZXh0U3R5bGVba2V5XS5jb25maWdcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIHJldDtcbn1cblxuLy8gVE9ETzogcmVmYWN0b3IgY29tbW9uIGxvZ2ljIHdpdGggdXBkYXRlQ3VycmVudFZlbG9jaXR5XG5cbmZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRTdHlsZShmcmFtZVJhdGUsIGN1cnJlbnRTdHlsZSwgY3VycmVudFZlbG9jaXR5LCBzdHlsZSkge1xuICB2YXIgcmV0ID0ge307XG4gIGZvciAodmFyIGtleSBpbiBzdHlsZSkge1xuICAgIGlmICghc3R5bGUuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmICghc3R5bGVba2V5XS5jb25maWcpIHtcbiAgICAgIHJldFtrZXldID0gc3R5bGVba2V5XTtcbiAgICAgIC8vIG5vdCBhIHNwcmluZyBjb25maWcsIG5vdCBzb21ldGhpbmcgd2Ugd2FudCB0byBpbnRlcnBvbGF0ZVxuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHZhciBfc3R5bGUka2V5JGNvbmZpZyA9IHN0eWxlW2tleV0uY29uZmlnO1xuICAgIHZhciBrID0gX3N0eWxlJGtleSRjb25maWdbMF07XG4gICAgdmFyIGIgPSBfc3R5bGUka2V5JGNvbmZpZ1sxXTtcblxuICAgIHZhciB2YWwgPSBfc3RlcHBlcjJbJ2RlZmF1bHQnXShmcmFtZVJhdGUsXG4gICAgLy8gbWlnaHQgaGF2ZSBiZWVuIGEgbm9uLXNwcmluZ2VkIHByb3AgdGhhdCBqdXN0IGJlY2FtZSBvbmVcbiAgICBjdXJyZW50U3R5bGVba2V5XS52YWwgPT0gbnVsbCA/IGN1cnJlbnRTdHlsZVtrZXldIDogY3VycmVudFN0eWxlW2tleV0udmFsLCBjdXJyZW50VmVsb2NpdHlba2V5XSwgc3R5bGVba2V5XS52YWwsIGssIGIpWzBdO1xuICAgIHJldFtrZXldID0ge1xuICAgICAgdmFsOiB2YWwsXG4gICAgICBjb25maWc6IHN0eWxlW2tleV0uY29uZmlnXG4gICAgfTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuXG5mdW5jdGlvbiB1cGRhdGVDdXJyZW50VmVsb2NpdHkoZnJhbWVSYXRlLCBjdXJyZW50U3R5bGUsIGN1cnJlbnRWZWxvY2l0eSwgc3R5bGUpIHtcbiAgdmFyIHJldCA9IHt9O1xuICBmb3IgKHZhciBrZXkgaW4gc3R5bGUpIHtcbiAgICBpZiAoIXN0eWxlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoIXN0eWxlW2tleV0uY29uZmlnKSB7XG4gICAgICAvLyBub3QgYSBzcHJpbmcgY29uZmlnLCBub3Qgc29tZXRoaW5nIHdlIHdhbnQgdG8gaW50ZXJwb2xhdGVcbiAgICAgIHJldFtrZXldID0gMDtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICB2YXIgX3N0eWxlJGtleSRjb25maWcyID0gc3R5bGVba2V5XS5jb25maWc7XG4gICAgdmFyIGsgPSBfc3R5bGUka2V5JGNvbmZpZzJbMF07XG4gICAgdmFyIGIgPSBfc3R5bGUka2V5JGNvbmZpZzJbMV07XG5cbiAgICB2YXIgdmFsID0gX3N0ZXBwZXIyWydkZWZhdWx0J10oZnJhbWVSYXRlLFxuICAgIC8vIG1pZ2h0IGhhdmUgYmVlbiBhIG5vbi1zcHJpbmdlZCBwcm9wIHRoYXQganVzdCBiZWNhbWUgb25lXG4gICAgY3VycmVudFN0eWxlW2tleV0udmFsID09IG51bGwgPyBjdXJyZW50U3R5bGVba2V5XSA6IGN1cnJlbnRTdHlsZVtrZXldLnZhbCwgY3VycmVudFZlbG9jaXR5W2tleV0sIHN0eWxlW2tleV0udmFsLCBrLCBiKVsxXTtcbiAgICByZXRba2V5XSA9IHZhbDtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9saWIvdXBkYXRlVHJlZS5qc1xuICoqIG1vZHVsZSBpZCA9IDMyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvLyB1c2VkIGJ5IHRoZSB0cmVlLXdhbGtpbmcgdXBkYXRlcyBhbmQgc3ByaW5ncy4gQXZvaWRzIHNvbWUgYWxsb2NhdGlvbnNcblwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSB6ZXJvO1xuXG5mdW5jdGlvbiB6ZXJvKCkge1xuICByZXR1cm4gMDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzW1wiZGVmYXVsdFwiXTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9yZWFjdC1tb3Rpb24vbGliL3plcm8uanNcbiAqKiBtb2R1bGUgaWQgPSAzM1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwidmFyIG5vdyA9IHJlcXVpcmUoJ3BlcmZvcm1hbmNlLW5vdycpXG4gICwgZ2xvYmFsID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgPyB7fSA6IHdpbmRvd1xuICAsIHZlbmRvcnMgPSBbJ21veicsICd3ZWJraXQnXVxuICAsIHN1ZmZpeCA9ICdBbmltYXRpb25GcmFtZSdcbiAgLCByYWYgPSBnbG9iYWxbJ3JlcXVlc3QnICsgc3VmZml4XVxuICAsIGNhZiA9IGdsb2JhbFsnY2FuY2VsJyArIHN1ZmZpeF0gfHwgZ2xvYmFsWydjYW5jZWxSZXF1ZXN0JyArIHN1ZmZpeF1cblxuZm9yKHZhciBpID0gMDsgaSA8IHZlbmRvcnMubGVuZ3RoICYmICFyYWY7IGkrKykge1xuICByYWYgPSBnbG9iYWxbdmVuZG9yc1tpXSArICdSZXF1ZXN0JyArIHN1ZmZpeF1cbiAgY2FmID0gZ2xvYmFsW3ZlbmRvcnNbaV0gKyAnQ2FuY2VsJyArIHN1ZmZpeF1cbiAgICAgIHx8IGdsb2JhbFt2ZW5kb3JzW2ldICsgJ0NhbmNlbFJlcXVlc3QnICsgc3VmZml4XVxufVxuXG4vLyBTb21lIHZlcnNpb25zIG9mIEZGIGhhdmUgckFGIGJ1dCBub3QgY0FGXG5pZighcmFmIHx8ICFjYWYpIHtcbiAgdmFyIGxhc3QgPSAwXG4gICAgLCBpZCA9IDBcbiAgICAsIHF1ZXVlID0gW11cbiAgICAsIGZyYW1lRHVyYXRpb24gPSAxMDAwIC8gNjBcblxuICByYWYgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgIGlmKHF1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdmFyIF9ub3cgPSBub3coKVxuICAgICAgICAsIG5leHQgPSBNYXRoLm1heCgwLCBmcmFtZUR1cmF0aW9uIC0gKF9ub3cgLSBsYXN0KSlcbiAgICAgIGxhc3QgPSBuZXh0ICsgX25vd1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGNwID0gcXVldWUuc2xpY2UoMClcbiAgICAgICAgLy8gQ2xlYXIgcXVldWUgaGVyZSB0byBwcmV2ZW50XG4gICAgICAgIC8vIGNhbGxiYWNrcyBmcm9tIGFwcGVuZGluZyBsaXN0ZW5lcnNcbiAgICAgICAgLy8gdG8gdGhlIGN1cnJlbnQgZnJhbWUncyBxdWV1ZVxuICAgICAgICBxdWV1ZS5sZW5ndGggPSAwXG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBjcC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmKCFjcFtpXS5jYW5jZWxsZWQpIHtcbiAgICAgICAgICAgIHRyeXtcbiAgICAgICAgICAgICAgY3BbaV0uY2FsbGJhY2sobGFzdClcbiAgICAgICAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyB0aHJvdyBlIH0sIDApXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LCBNYXRoLnJvdW5kKG5leHQpKVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKHtcbiAgICAgIGhhbmRsZTogKytpZCxcbiAgICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcbiAgICAgIGNhbmNlbGxlZDogZmFsc2VcbiAgICB9KVxuICAgIHJldHVybiBpZFxuICB9XG5cbiAgY2FmID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgZm9yKHZhciBpID0gMDsgaSA8IHF1ZXVlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZihxdWV1ZVtpXS5oYW5kbGUgPT09IGhhbmRsZSkge1xuICAgICAgICBxdWV1ZVtpXS5jYW5jZWxsZWQgPSB0cnVlXG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZm4pIHtcbiAgLy8gV3JhcCBpbiBhIG5ldyBmdW5jdGlvbiB0byBwcmV2ZW50XG4gIC8vIGBjYW5jZWxgIHBvdGVudGlhbGx5IGJlaW5nIGFzc2lnbmVkXG4gIC8vIHRvIHRoZSBuYXRpdmUgckFGIGZ1bmN0aW9uXG4gIHJldHVybiByYWYuY2FsbChnbG9iYWwsIGZuKVxufVxubW9kdWxlLmV4cG9ydHMuY2FuY2VsID0gZnVuY3Rpb24oKSB7XG4gIGNhZi5hcHBseShnbG9iYWwsIGFyZ3VtZW50cylcbn1cblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9+L3JlYWN0LW1vdGlvbi9+L3JhZi9pbmRleC5qc1xuICoqIG1vZHVsZSBpZCA9IDM0XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvKlxyXG5cdE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXHJcblx0QXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxyXG4qL1xyXG52YXIgc3R5bGVzSW5Eb20gPSB7fSxcclxuXHRtZW1vaXplID0gZnVuY3Rpb24oZm4pIHtcclxuXHRcdHZhciBtZW1vO1xyXG5cdFx0cmV0dXJuIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0aWYgKHR5cGVvZiBtZW1vID09PSBcInVuZGVmaW5lZFwiKSBtZW1vID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuXHRcdFx0cmV0dXJuIG1lbW87XHJcblx0XHR9O1xyXG5cdH0sXHJcblx0aXNPbGRJRSA9IG1lbW9pemUoZnVuY3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gL21zaWUgWzYtOV1cXGIvLnRlc3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKSk7XHJcblx0fSksXHJcblx0Z2V0SGVhZEVsZW1lbnQgPSBtZW1vaXplKGZ1bmN0aW9uICgpIHtcclxuXHRcdHJldHVybiBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXTtcclxuXHR9KSxcclxuXHRzaW5nbGV0b25FbGVtZW50ID0gbnVsbCxcclxuXHRzaW5nbGV0b25Db3VudGVyID0gMDtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24obGlzdCwgb3B0aW9ucykge1xyXG5cdGlmKHR5cGVvZiBERUJVRyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBERUJVRykge1xyXG5cdFx0aWYodHlwZW9mIGRvY3VtZW50ICE9PSBcIm9iamVjdFwiKSB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgc3R5bGUtbG9hZGVyIGNhbm5vdCBiZSB1c2VkIGluIGEgbm9uLWJyb3dzZXIgZW52aXJvbm1lbnRcIik7XHJcblx0fVxyXG5cclxuXHRvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuXHQvLyBGb3JjZSBzaW5nbGUtdGFnIHNvbHV0aW9uIG9uIElFNi05LCB3aGljaCBoYXMgYSBoYXJkIGxpbWl0IG9uIHRoZSAjIG9mIDxzdHlsZT5cclxuXHQvLyB0YWdzIGl0IHdpbGwgYWxsb3cgb24gYSBwYWdlXHJcblx0aWYgKHR5cGVvZiBvcHRpb25zLnNpbmdsZXRvbiA9PT0gXCJ1bmRlZmluZWRcIikgb3B0aW9ucy5zaW5nbGV0b24gPSBpc09sZElFKCk7XHJcblxyXG5cdHZhciBzdHlsZXMgPSBsaXN0VG9TdHlsZXMobGlzdCk7XHJcblx0YWRkU3R5bGVzVG9Eb20oc3R5bGVzLCBvcHRpb25zKTtcclxuXHJcblx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZShuZXdMaXN0KSB7XHJcblx0XHR2YXIgbWF5UmVtb3ZlID0gW107XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgc3R5bGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xyXG5cdFx0XHR2YXIgZG9tU3R5bGUgPSBzdHlsZXNJbkRvbVtpdGVtLmlkXTtcclxuXHRcdFx0ZG9tU3R5bGUucmVmcy0tO1xyXG5cdFx0XHRtYXlSZW1vdmUucHVzaChkb21TdHlsZSk7XHJcblx0XHR9XHJcblx0XHRpZihuZXdMaXN0KSB7XHJcblx0XHRcdHZhciBuZXdTdHlsZXMgPSBsaXN0VG9TdHlsZXMobmV3TGlzdCk7XHJcblx0XHRcdGFkZFN0eWxlc1RvRG9tKG5ld1N0eWxlcywgb3B0aW9ucyk7XHJcblx0XHR9XHJcblx0XHRmb3IodmFyIGkgPSAwOyBpIDwgbWF5UmVtb3ZlLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdHZhciBkb21TdHlsZSA9IG1heVJlbW92ZVtpXTtcclxuXHRcdFx0aWYoZG9tU3R5bGUucmVmcyA9PT0gMCkge1xyXG5cdFx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKylcclxuXHRcdFx0XHRcdGRvbVN0eWxlLnBhcnRzW2pdKCk7XHJcblx0XHRcdFx0ZGVsZXRlIHN0eWxlc0luRG9tW2RvbVN0eWxlLmlkXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFN0eWxlc1RvRG9tKHN0eWxlcywgb3B0aW9ucykge1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBzdHlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdHZhciBpdGVtID0gc3R5bGVzW2ldO1xyXG5cdFx0dmFyIGRvbVN0eWxlID0gc3R5bGVzSW5Eb21baXRlbS5pZF07XHJcblx0XHRpZihkb21TdHlsZSkge1xyXG5cdFx0XHRkb21TdHlsZS5yZWZzKys7XHJcblx0XHRcdGZvcih2YXIgaiA9IDA7IGogPCBkb21TdHlsZS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdGRvbVN0eWxlLnBhcnRzW2pdKGl0ZW0ucGFydHNbal0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZvcig7IGogPCBpdGVtLnBhcnRzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0ZG9tU3R5bGUucGFydHMucHVzaChhZGRTdHlsZShpdGVtLnBhcnRzW2pdLCBvcHRpb25zKSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHZhciBwYXJ0cyA9IFtdO1xyXG5cdFx0XHRmb3IodmFyIGogPSAwOyBqIDwgaXRlbS5wYXJ0cy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdHBhcnRzLnB1c2goYWRkU3R5bGUoaXRlbS5wYXJ0c1tqXSwgb3B0aW9ucykpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHN0eWxlc0luRG9tW2l0ZW0uaWRdID0ge2lkOiBpdGVtLmlkLCByZWZzOiAxLCBwYXJ0czogcGFydHN9O1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gbGlzdFRvU3R5bGVzKGxpc3QpIHtcclxuXHR2YXIgc3R5bGVzID0gW107XHJcblx0dmFyIG5ld1N0eWxlcyA9IHt9O1xyXG5cdGZvcih2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcblx0XHR2YXIgaXRlbSA9IGxpc3RbaV07XHJcblx0XHR2YXIgaWQgPSBpdGVtWzBdO1xyXG5cdFx0dmFyIGNzcyA9IGl0ZW1bMV07XHJcblx0XHR2YXIgbWVkaWEgPSBpdGVtWzJdO1xyXG5cdFx0dmFyIHNvdXJjZU1hcCA9IGl0ZW1bM107XHJcblx0XHR2YXIgcGFydCA9IHtjc3M6IGNzcywgbWVkaWE6IG1lZGlhLCBzb3VyY2VNYXA6IHNvdXJjZU1hcH07XHJcblx0XHRpZighbmV3U3R5bGVzW2lkXSlcclxuXHRcdFx0c3R5bGVzLnB1c2gobmV3U3R5bGVzW2lkXSA9IHtpZDogaWQsIHBhcnRzOiBbcGFydF19KTtcclxuXHRcdGVsc2VcclxuXHRcdFx0bmV3U3R5bGVzW2lkXS5wYXJ0cy5wdXNoKHBhcnQpO1xyXG5cdH1cclxuXHRyZXR1cm4gc3R5bGVzO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVTdHlsZUVsZW1lbnQoKSB7XHJcblx0dmFyIHN0eWxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcclxuXHR2YXIgaGVhZCA9IGdldEhlYWRFbGVtZW50KCk7XHJcblx0c3R5bGVFbGVtZW50LnR5cGUgPSBcInRleHQvY3NzXCI7XHJcblx0aGVhZC5hcHBlbmRDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdHJldHVybiBzdHlsZUVsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUxpbmtFbGVtZW50KCkge1xyXG5cdHZhciBsaW5rRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpO1xyXG5cdHZhciBoZWFkID0gZ2V0SGVhZEVsZW1lbnQoKTtcclxuXHRsaW5rRWxlbWVudC5yZWwgPSBcInN0eWxlc2hlZXRcIjtcclxuXHRoZWFkLmFwcGVuZENoaWxkKGxpbmtFbGVtZW50KTtcclxuXHRyZXR1cm4gbGlua0VsZW1lbnQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFN0eWxlKG9iaiwgb3B0aW9ucykge1xyXG5cdHZhciBzdHlsZUVsZW1lbnQsIHVwZGF0ZSwgcmVtb3ZlO1xyXG5cclxuXHRpZiAob3B0aW9ucy5zaW5nbGV0b24pIHtcclxuXHRcdHZhciBzdHlsZUluZGV4ID0gc2luZ2xldG9uQ291bnRlcisrO1xyXG5cdFx0c3R5bGVFbGVtZW50ID0gc2luZ2xldG9uRWxlbWVudCB8fCAoc2luZ2xldG9uRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudCgpKTtcclxuXHRcdHVwZGF0ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIGZhbHNlKTtcclxuXHRcdHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZUVsZW1lbnQsIHN0eWxlSW5kZXgsIHRydWUpO1xyXG5cdH0gZWxzZSBpZihvYmouc291cmNlTWFwICYmXHJcblx0XHR0eXBlb2YgVVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdHR5cGVvZiBVUkwuY3JlYXRlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdHR5cGVvZiBVUkwucmV2b2tlT2JqZWN0VVJMID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdHR5cGVvZiBCbG9iID09PSBcImZ1bmN0aW9uXCIgJiZcclxuXHRcdHR5cGVvZiBidG9hID09PSBcImZ1bmN0aW9uXCIpIHtcclxuXHRcdHN0eWxlRWxlbWVudCA9IGNyZWF0ZUxpbmtFbGVtZW50KCk7XHJcblx0XHR1cGRhdGUgPSB1cGRhdGVMaW5rLmJpbmQobnVsbCwgc3R5bGVFbGVtZW50KTtcclxuXHRcdHJlbW92ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpO1xyXG5cdFx0XHRpZihzdHlsZUVsZW1lbnQuaHJlZilcclxuXHRcdFx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKHN0eWxlRWxlbWVudC5ocmVmKTtcclxuXHRcdH07XHJcblx0fSBlbHNlIHtcclxuXHRcdHN0eWxlRWxlbWVudCA9IGNyZWF0ZVN0eWxlRWxlbWVudCgpO1xyXG5cdFx0dXBkYXRlID0gYXBwbHlUb1RhZy5iaW5kKG51bGwsIHN0eWxlRWxlbWVudCk7XHJcblx0XHRyZW1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50KTtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHR1cGRhdGUob2JqKTtcclxuXHJcblx0cmV0dXJuIGZ1bmN0aW9uIHVwZGF0ZVN0eWxlKG5ld09iaikge1xyXG5cdFx0aWYobmV3T2JqKSB7XHJcblx0XHRcdGlmKG5ld09iai5jc3MgPT09IG9iai5jc3MgJiYgbmV3T2JqLm1lZGlhID09PSBvYmoubWVkaWEgJiYgbmV3T2JqLnNvdXJjZU1hcCA9PT0gb2JqLnNvdXJjZU1hcClcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdHVwZGF0ZShvYmogPSBuZXdPYmopO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cmVtb3ZlKCk7XHJcblx0XHR9XHJcblx0fTtcclxufVxyXG5cclxudmFyIHJlcGxhY2VUZXh0ID0gKGZ1bmN0aW9uICgpIHtcclxuXHR2YXIgdGV4dFN0b3JlID0gW107XHJcblxyXG5cdHJldHVybiBmdW5jdGlvbiAoaW5kZXgsIHJlcGxhY2VtZW50KSB7XHJcblx0XHR0ZXh0U3RvcmVbaW5kZXhdID0gcmVwbGFjZW1lbnQ7XHJcblx0XHRyZXR1cm4gdGV4dFN0b3JlLmZpbHRlcihCb29sZWFuKS5qb2luKCdcXG4nKTtcclxuXHR9O1xyXG59KSgpO1xyXG5cclxuZnVuY3Rpb24gYXBwbHlUb1NpbmdsZXRvblRhZyhzdHlsZUVsZW1lbnQsIGluZGV4LCByZW1vdmUsIG9iaikge1xyXG5cdHZhciBjc3MgPSByZW1vdmUgPyBcIlwiIDogb2JqLmNzcztcclxuXHJcblx0aWYgKHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0KSB7XHJcblx0XHRzdHlsZUVsZW1lbnQuc3R5bGVTaGVldC5jc3NUZXh0ID0gcmVwbGFjZVRleHQoaW5kZXgsIGNzcyk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHZhciBjc3NOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKTtcclxuXHRcdHZhciBjaGlsZE5vZGVzID0gc3R5bGVFbGVtZW50LmNoaWxkTm9kZXM7XHJcblx0XHRpZiAoY2hpbGROb2Rlc1tpbmRleF0pIHN0eWxlRWxlbWVudC5yZW1vdmVDaGlsZChjaGlsZE5vZGVzW2luZGV4XSk7XHJcblx0XHRpZiAoY2hpbGROb2Rlcy5sZW5ndGgpIHtcclxuXHRcdFx0c3R5bGVFbGVtZW50Lmluc2VydEJlZm9yZShjc3NOb2RlLCBjaGlsZE5vZGVzW2luZGV4XSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoY3NzTm9kZSk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBhcHBseVRvVGFnKHN0eWxlRWxlbWVudCwgb2JqKSB7XHJcblx0dmFyIGNzcyA9IG9iai5jc3M7XHJcblx0dmFyIG1lZGlhID0gb2JqLm1lZGlhO1xyXG5cdHZhciBzb3VyY2VNYXAgPSBvYmouc291cmNlTWFwO1xyXG5cclxuXHRpZihtZWRpYSkge1xyXG5cdFx0c3R5bGVFbGVtZW50LnNldEF0dHJpYnV0ZShcIm1lZGlhXCIsIG1lZGlhKVxyXG5cdH1cclxuXHJcblx0aWYoc3R5bGVFbGVtZW50LnN0eWxlU2hlZXQpIHtcclxuXHRcdHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0LmNzc1RleHQgPSBjc3M7XHJcblx0fSBlbHNlIHtcclxuXHRcdHdoaWxlKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKSB7XHJcblx0XHRcdHN0eWxlRWxlbWVudC5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQuZmlyc3RDaGlsZCk7XHJcblx0XHR9XHJcblx0XHRzdHlsZUVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKSk7XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVMaW5rKGxpbmtFbGVtZW50LCBvYmopIHtcclxuXHR2YXIgY3NzID0gb2JqLmNzcztcclxuXHR2YXIgbWVkaWEgPSBvYmoubWVkaWE7XHJcblx0dmFyIHNvdXJjZU1hcCA9IG9iai5zb3VyY2VNYXA7XHJcblxyXG5cdGlmKHNvdXJjZU1hcCkge1xyXG5cdFx0Ly8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjY2MDM4NzVcclxuXHRcdGNzcyArPSBcIlxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsXCIgKyBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpICsgXCIgKi9cIjtcclxuXHR9XHJcblxyXG5cdHZhciBibG9iID0gbmV3IEJsb2IoW2Nzc10sIHsgdHlwZTogXCJ0ZXh0L2Nzc1wiIH0pO1xyXG5cclxuXHR2YXIgb2xkU3JjID0gbGlua0VsZW1lbnQuaHJlZjtcclxuXHJcblx0bGlua0VsZW1lbnQuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XHJcblxyXG5cdGlmKG9sZFNyYylcclxuXHRcdFVSTC5yZXZva2VPYmplY3RVUkwob2xkU3JjKTtcclxufVxyXG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vfi9zdHlsZS1sb2FkZXIvYWRkU3R5bGVzLmpzXG4gKiogbW9kdWxlIGlkID0gMzVcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2F1dG9wcmVmaXhlci1sb2FkZXIvaW5kZXguanM/YnJvd3NlcnM9bGFzdCAyIHZlcnNpb24hLi8uLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhLi9tYWluLnNjc3NcIik7XG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbi8vIGFkZCB0aGUgc3R5bGVzIHRvIHRoZSBET01cbnZhciB1cGRhdGUgPSByZXF1aXJlKFwiIS4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9hZGRTdHlsZXMuanNcIikoY29udGVudCwge30pO1xuaWYoY29udGVudC5sb2NhbHMpIG1vZHVsZS5leHBvcnRzID0gY29udGVudC5sb2NhbHM7XG4vLyBIb3QgTW9kdWxlIFJlcGxhY2VtZW50XG5pZihtb2R1bGUuaG90KSB7XG5cdC8vIFdoZW4gdGhlIHN0eWxlcyBjaGFuZ2UsIHVwZGF0ZSB0aGUgPHN0eWxlPiB0YWdzXG5cdGlmKCFjb250ZW50LmxvY2Fscykge1xuXHRcdG1vZHVsZS5ob3QuYWNjZXB0KFwiISEuLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2luZGV4LmpzIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2F1dG9wcmVmaXhlci1sb2FkZXIvaW5kZXguanM/YnJvd3NlcnM9bGFzdCAyIHZlcnNpb24hLi8uLi8uLi9ub2RlX21vZHVsZXMvc2Fzcy1sb2FkZXIvaW5kZXguanMhLi9tYWluLnNjc3NcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgbmV3Q29udGVudCA9IHJlcXVpcmUoXCIhIS4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvaW5kZXguanMhLi8uLi8uLi9ub2RlX21vZHVsZXMvYXV0b3ByZWZpeGVyLWxvYWRlci9pbmRleC5qcz9icm93c2Vycz1sYXN0IDIgdmVyc2lvbiEuLy4uLy4uL25vZGVfbW9kdWxlcy9zYXNzLWxvYWRlci9pbmRleC5qcyEuL21haW4uc2Nzc1wiKTtcblx0XHRcdGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuXHRcdFx0dXBkYXRlKG5ld0NvbnRlbnQpO1xuXHRcdH0pO1xuXHR9XG5cdC8vIFdoZW4gdGhlIG1vZHVsZSBpcyBkaXNwb3NlZCwgcmVtb3ZlIHRoZSA8c3R5bGU+IHRhZ3Ncblx0bW9kdWxlLmhvdC5kaXNwb3NlKGZ1bmN0aW9uKCkgeyB1cGRhdGUoKTsgfSk7XG59XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9zdHlsZS9tYWluLnNjc3NcbiAqKiBtb2R1bGUgaWQgPSAzNlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgdmlld0JveD1cXFwiMCAwIDI2ODEgODE0XFxcIiB2ZXJzaW9uPVxcXCIxLjFcXFwiIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgeG1sbnM6eGxpbms9XFxcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcXFwiIHhtbG5zOnNrZXRjaD1cXFwiaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoL25zXFxcIj48dGl0bGU+Q2xpbWIgTG9nbyBCZXRhPC90aXRsZT48ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz48ZGVmcz48L2RlZnM+PGcgaWQ9XFxcIlBhZ2UtMVxcXCIgc3Ryb2tlPVxcXCJub25lXFxcIiBzdHJva2Utd2lkdGg9XFxcIjFcXFwiIGZpbGw9XFxcIm5vbmVcXFwiIGZpbGwtcnVsZT1cXFwiZXZlbm9kZFxcXCIgc2tldGNoOnR5cGU9XFxcIk1TUGFnZVxcXCI+PGcgaWQ9XFxcIkNsaW1iLUxvZ28tQmV0YVxcXCIgc2tldGNoOnR5cGU9XFxcIk1TQXJ0Ym9hcmRHcm91cFxcXCIgZmlsbD1cXFwiIzE5Mzc0RFxcXCI+PGcgaWQ9XFxcImNsaS0tLS1iLnNvY2lhbC0rLVBhdGgtQ29weS0rLVR5cGUtc29tZXRoaW5nLUNvcHktQ29weS1Db3B5LUNvcHktQ29weVxcXCIgc2tldGNoOnR5cGU9XFxcIk1TTGF5ZXJHcm91cFxcXCIgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMjA2LjAwMDAwMCwgMjQ5LjAwMDAwMClcXFwiPjxnIGlkPVxcXCJjbGktLS0tYi5zb2NpYWwtKy1QYXRoLUNvcHlcXFwiIHNrZXRjaDp0eXBlPVxcXCJNU1NoYXBlR3JvdXBcXFwiPjxwYXRoIGQ9XFxcIk03MjMuMzc0MjA3LDE4Ny40NDIyMTEgTDc2Ny4wMjc2NDEsMzM3LjM4MzU3NSBDNzY3LjUxMDg4OSwzNDEuMjY1NTUyIDc3MS44NjAxMjQsMzQ1LjE0NzUyOSA3NzYuMjA5MzU5LDM0NS4xNDc1MjkgTDgzMy4yMzI2NjQsMzQ1LjE0NzUyOSBDODM5LjAzMTY0NCwzNDUuMTQ3NTI5IDg0My4zODA4NzksMzQwLjc4MDMwNSA4NDIuNDE0MzgzLDMzNC40NzIwOTIgTDczOS40ODI0ODUsOC4zODYwMTk4MiBDNzM4Ljk5OTIzNyw0LjAxODc5NTY0IDczNC42NTAwMDIsMC42MjIwNjU3MjggNzMwLjc4NDAxNSwwLjYyMjA2NTcyOCBMNzIzLjA1MjA0MSwwLjYyMjA2NTcyOCBDNzIwLjYzNTgsMC42MjIwNjU3MjggNzE2LjI4NjU2NSwyLjU2MzA1NDI1IDcxNC44MzY4Miw1LjQ3NDUzNzA0IEw2NDMuNTE0MzAyLDIwOS4wMTkwNjIgTDU3Ni40OTQwMDMsMTA1LjQzMTc4OCBDNTczLjcyMTA1OCwxMDEuMTQ1ODk1IDU2Ny4zNDI1MzksOTcuNjcxNDkxOSA1NjIuMjU1Niw5Ny42NzE0OTE5IEw1NTIuMTc5MDMzLDk3LjY3MTQ5MTkgQzU0Ny4wODgzMjYsOTcuNjcxNDkxOSA1NDEuNTI5Mzg0LDEwMS41NTg3NDkgNTM5Ljc3MDA2MSwxMDYuMzM0MTg3IEw0NTQuOTgwMDY4LDMzNi40ODQ4MzMgQzQ1My4yMTc0OSwzNDEuMjY5MTA4IDQ1NS45MjcwODYsMzQ1LjE0NzUyOSA0NjEuMDE0MTAyLDM0NS4xNDc1MjkgTDUyMi4xMzgwNjcsMzQ1LjE0NzUyOSBDNTI3LjIzMzE1LDM0NS4xNDc1MjkgNTMyLjc5MTA1NCwzNDEuMjYxNzMzIDUzNC41NTI3OTcsMzM2LjQ2NjE3MSBMNTcxLjQ3MzE0NCwyMzUuOTY2OTI0IEw2NDIuMTA4NTI4LDM0Ni4xMDc3MTIgQzY0My40ODcxNDEsMzQ4LjI1NzM2MyA2NDYuNjY3MDkyLDM1MCA2NDkuMjEyMzA3LDM1MCBMNjU5Ljk3MTQxMiwzNTAgQzY2Mi41MTYxMDgsMzUwIDY2NS4yODIwNDQsMzQ4LjA0NTA3OCA2NjYuMTQxOTgyLDM0NS42NTM5MTggTDY4My44MjcyNjEsMjk2LjQ3Nzg3MiBMNzIzLjM3NDIwNywxODcuNDQyMjExIFpcXFwiIGlkPVxcXCJQYXRoLUNvcHlcXFwiPjwvcGF0aD48cGF0aCBkPVxcXCJNMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBDMC4xNDUyMTM0NDEsMzA1LjIzNDA0IDQ5LjA4NzIzNzcsMzQ4Ljg0NTc0NSAxMDQuMzI4NzMsMzQ4Ljg0NTc0NSBDMTM5LjIxODA5NCwzNDguODQ1NzQ1IDE2NC40MTU5NjgsMzM1LjI3NzY1OSAxODIuMzQ1MjI0LDMwOC4xNDE0ODcgQzE4NS43MzcyNDYsMzAzLjI5NTc0MiAxODMuMzE0MzczLDI5OC40NDk5OTcgMTc4Ljk1MzIwMywyOTQuNTczNDAxIEwxNDkuODc4NzMzLDI2OS4zNzU1MjcgQzE0Ni45NzEyODYsMjY2Ljk1MjY1NSAxNDIuNjEwMTE2LDI2Ny45MjE4MDQgMTM5LjIxODA5NCwyNzEuMzEzODI1IEMxMzEuNDY0OTAyLDI3OS4wNjcwMTcgMTIzLjIyNzEzNiwyODYuMzM1NjM1IDEwNi4yNjcwMjgsMjg2LjMzNTYzNSBDODQuOTQ1NzUwNSwyODYuMzM1NjM1IDY4LjQ3MDIxNzYsMjY4Ljg5MDk1MyA2OC40NzAyMTc2LDI0Ny4wODUxMDEgQzY4LjQ3MDIxNzYsMjI1Ljc2MzgyMyA4NS45MTQ4OTk1LDIwNy44MzQ1NjYgMTA3LjIzNjE3NywyMDcuODM0NTY2IEMxMTguMzgxMzkxLDIwNy44MzQ1NjYgMTI4LjU1NzQ1NSwyMTMuMTY0ODg2IDEzNS4zNDE0OTgsMjIwLjQzMzUwMyBDMTM3Ljc2NDM3MSwyMjIuODU2Mzc2IDE0My41NzkyNjUsMjIzLjgyNTUyNSAxNDYuMDAyMTM3LDIyMS40MDI2NTIgTDE3NS4wNzY2MDcsMTkzLjc4MTkwNiBDMTc5LjQzNzc3NywxODkuOTA1MzEgMTgwLjg5MTUwMSwxODQuNTc0OTkgMTc3LjQ5OTQ4LDE4MC4yMTM4MiBDMTU5LjA4NTY0OSwxNTcuOTIzMzkzIDEzNS4zNDE0OTgsMTQ1LjMyNDQ1NiAxMDQuODEzMzA1LDE0NS4zMjQ0NTYgQzQ5LjU3MTgxMjIsMTQ1LjMyNDQ1NiAwLjE0NTIxMzQ0MSwxODkuOTA1MzEgMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBMMC4xNDUyMTM0NDEsMjQ3LjA4NTEwMSBaIE0yMTguNjg4MzEyLDMzNC43OTMwODUgQzIxOC42ODgzMTIsMzM5LjYzODgzIDIyMy4wNDk0ODIsMzQ0IDIyNy44OTUyMjcsMzQ0IEwyODEuMTk4NDIyLDM0NCBDMjg2LjA0NDE2NywzNDQgMjkwLjQwNTMzNywzMzkuNjM4ODMgMjkwLjQwNTMzNywzMzQuNzkzMDg1IEwyOTAuNDA1MzM3LDE0LjAwNDc2NzIgQzI5MC40MDUzMzcsOS4xNTkwMjIyNiAyODYuMDQ0MTY3LDQuNzk3ODUxNzkgMjgxLjE5ODQyMiw0Ljc5Nzg1MTc5IEwyMjcuODk1MjI3LDQuNzk3ODUxNzkgQzIyMy4wNDk0ODIsNC43OTc4NTE3OSAyMTguNjg4MzEyLDkuMTU5MDIyMjYgMjE4LjY4ODMxMiwxNC4wMDQ3NjcyIEwyMTguNjg4MzEyLDMzNC43OTMwODUgWiBNMzc4LjExMzMyMSw5MS41MzY2ODY4IEMzOTkuNDM0NTk5LDkxLjUzNjY4NjggNDE2Ljg3OTI4MSw3NC41NzY1Nzk0IDQxNi44NzkyODEsNTMuMjU1MzAxNSBDNDE2Ljg3OTI4MSwzMS45MzQwMjM2IDM5OS40MzQ1OTksMTQuNDg5MzQxNyAzNzguMTEzMzIxLDE0LjQ4OTM0MTcgQzM1Ni43OTIwNDQsMTQuNDg5MzQxNyAzMzkuODMxOTM2LDMxLjkzNDAyMzYgMzM5LjgzMTkzNiw1My4yNTUzMDE1IEMzMzkuODMxOTM2LDc0LjU3NjU3OTQgMzU2Ljc5MjA0NCw5MS41MzY2ODY4IDM3OC4xMTMzMjEsOTEuNTM2Njg2OCBMMzc4LjExMzMyMSw5MS41MzY2ODY4IFogTTM0Mi43MzkzODMsMzM0Ljc5MzA4NSBDMzQyLjczOTM4MywzMzkuNjM4ODMgMzQ3LjEwMDU1NCwzNDQgMzUxLjk0NjI5OSwzNDQgTDQwNS4yNDk0OTMsMzQ0IEM0MTAuMDk1MjM4LDM0NCA0MTQuNDU2NDA5LDMzOS42Mzg4MyA0MTQuNDU2NDA5LDMzNC43OTMwODUgTDQxNC40NTY0MDksMTU5LjM3NzExNiBDNDE0LjQ1NjQwOSwxNTQuMDQ2Nzk3IDQxMC4wOTUyMzgsMTUwLjE3MDIwMSA0MDUuMjQ5NDkzLDE1MC4xNzAyMDEgTDM1MS45NDYyOTksMTUwLjE3MDIwMSBDMzQ3LjEwMDU1NCwxNTAuMTcwMjAxIDM0Mi43MzkzODMsMTU0LjA0Njc5NyAzNDIuNzM5MzgzLDE1OS4zNzcxMTYgTDM0Mi43MzkzODMsMzM0Ljc5MzA4NSBaIE04ODkuMTU0MzEsMzM0Ljc5MzA4NSBDODg5LjE1NDMxLDMzOS42Mzg4MyA4OTMuNTE1NDgxLDM0NCA4OTguMzYxMjI2LDM0NCBMOTIxLjEzNjIyNywzNDQgQzkyNS45ODE5NzIsMzQ0IDkyOS4zNzM5OTQsMzM5LjYzODgzIDkzMS4zMTIyOTIsMzM0LjMwODUxIEw5MzcuMTI3MTg1LDMxOC4zMTc1NTIgQzkzNy4xMjcxODUsMzE4LjMxNzU1MiA5NTkuNDE3NjEyLDM0OC44NDU3NDUgMTAwMi4wNjAxNywzNDguODQ1NzQ1IEMxMDU2LjgxNzA5LDM0OC44NDU3NDUgMTA5OC4wMDU5MiwzMDIuODExMTY4IDEwOTguMDA1OTIsMjQ3LjA4NTEwMSBDMTA5OC4wMDU5MiwxNzguNzYwMDk2IDEwNTMuNDI1MDYsMTQ1LjMyNDQ1NiAxMDAxLjU3NTU5LDE0NS4zMjQ0NTYgQzk4NS4xMDAwNjEsMTQ1LjMyNDQ1NiA5NjcuMTcwODA0LDE1MS4xMzkzNSA5NjEuMzU1OTEsMTU0LjUzMTM3MSBMOTYxLjM1NTkxLDE0LjAwNDc2NzIgQzk2MS4zNTU5MSw5LjE1OTAyMjI2IDk1Ni45OTQ3NCw0Ljc5Nzg1MTc5IDk1Mi4xNDg5OTUsNC43OTc4NTE3OSBMODk4LjM2MTIyNiw0Ljc5Nzg1MTc5IEM4OTMuNTE1NDgxLDQuNzk3ODUxNzkgODg5LjE1NDMxLDkuMTU5MDIyMjYgODg5LjE1NDMxLDE0LjAwNDc2NzIgTDg4OS4xNTQzMSwzMzQuNzkzMDg1IFogTTk1My42MDI3MTgsMjQ2LjYwMDUyNiBDOTUzLjYwMjcxOCwyMjQuNzk0Njc0IDk3MC4wNzgyNTEsMjA3LjgzNDU2NiA5OTIuMzY4Njc4LDIwNy44MzQ1NjYgQzEwMTQuNjU5MTEsMjA3LjgzNDU2NiAxMDMxLjYxOTIxLDIyNC43OTQ2NzQgMTAzMS42MTkyMSwyNDYuNjAwNTI2IEMxMDMxLjYxOTIxLDI2OC44OTA5NTMgMTAxNC42NTkxMSwyODYuMzM1NjM1IDk5Mi4zNjg2NzgsMjg2LjMzNTYzNSBDOTcwLjA3ODI1MSwyODYuMzM1NjM1IDk1My42MDI3MTgsMjY4Ljg5MDk1MyA5NTMuNjAyNzE4LDI0Ni42MDA1MjYgTDk1My42MDI3MTgsMjQ2LjYwMDUyNiBaIE0xMTM0LjI1NjQ1LDMyMS4yMjQ5OTkgQzExMzQuMjU2NDUsMzM2LjI0NjgwOCAxMTQ2Ljg1NTM5LDM0OC44NDU3NDUgMTE2MS44NzcyLDM0OC44NDU3NDUgQzExNzcuMzgzNTgsMzQ4Ljg0NTc0NSAxMTg5LjQ5Nzk1LDMzNi4yNDY4MDggMTE4OS40OTc5NSwzMjEuMjI0OTk5IEMxMTg5LjQ5Nzk1LDMwNS43MTg2MTUgMTE3Ny4zODM1OCwyOTMuNjA0MjUyIDExNjEuODc3MiwyOTMuNjA0MjUyIEMxMTQ2Ljg1NTM5LDI5My42MDQyNTIgMTEzNC4yNTY0NSwzMDUuNzE4NjE1IDExMzQuMjU2NDUsMzIxLjIyNDk5OSBMMTEzNC4yNTY0NSwzMjEuMjI0OTk5IFogTTEyMzYuMDE3MSwzMzIuODU0Nzg3IEMxMjQ1LjcwODU5LDM0MC42MDc5NzkgMTI2OS45MzczMSwzNDguODQ1NzQ1IDEzMDEuOTE5MjMsMzQ4Ljg0NTc0NSBDMTM1Ni42NzYxNSwzNDguODQ1NzQ1IDEzODMuODEyMzIsMzIxLjIyNDk5OSAxMzgzLjgxMjMyLDI4Ny4zMDQ3ODQgQzEzODMuODEyMzIsMjQ4LjUzODgyNCAxMzU2LjY3NjE1LDIzMy4wMzI0NCAxMzE3LjQyNTYxLDIxOS40NjQzNTQgQzEzMDAuOTUwMDgsMjEzLjY0OTQ2IDEyOTUuNjE5NzYsMjA4LjgwMzcxNSAxMjk1LjYxOTc2LDIwMy45NTc5NyBDMTI5NS42MTk3NiwxOTguNjI3NjUxIDEyOTkuOTgwOTMsMTk3LjE3MzkyNyAxMzA2LjI4MDQsMTk3LjE3MzkyNyBDMTMyNS4xNzg4LDE5Ny4xNzM5MjcgMTM0Ny40NjkyMywyMDguMzE5MTQxIDEzNDcuNDY5MjMsMjA4LjMxOTE0MSBDMTM1MS4zNDU4MywyMDkuNzcyODY0IDEzNTYuMTkxNTcsMjA4LjMxOTE0MSAxMzU3LjY0NTMsMjA1LjQxMTY5NCBMMTM3NS41NzQ1NSwxNzIuNDYwNjI4IEMxMzc4LjQ4MiwxNjcuNjE0ODgzIDEzNzUuMDg5OTgsMTYzLjI1MzcxMiAxMzcwLjcyODgxLDE2MC4zNDYyNjUgQzEzNjAuMDY4MTcsMTUzLjU2MjIyMyAxMzM2LjgwODU5LDE0NS4zMjQ0NTYgMTMwNi4yODA0LDE0NS4zMjQ0NTYgQzEyNTMuOTQ2MzUsMTQ1LjMyNDQ1NiAxMjMwLjY4Njc4LDE3MS40OTE0NzkgMTIzMC42ODY3OCwyMDMuOTU3OTcgQzEyMzAuNjg2NzgsMjM0LjAwMTU4OSAxMjQ3LjE2MjMxLDI1NS44MDc0NDEgMTI4NC45NTkxMiwyNjguODkwOTUzIEMxMzA5LjY3MjQyLDI3Ny42MTMyOTQgMTMxMi41Nzk4NywyODQuMzk3MzM3IDEzMTIuNTc5ODcsMjg5LjI0MzA4MiBDMTMxMi41Nzk4NywyOTUuMDU3OTc2IDEzMDguMjE4NywyOTcuOTY1NDIzIDEzMDMuMzcyOTUsMjk3Ljk2NTQyMyBDMTI4Mi41MzYyNSwyOTcuOTY1NDIzIDEyNTkuNzYxMjUsMjg1LjM2NjQ4NiAxMjU5Ljc2MTI1LDI4NS4zNjY0ODYgQzEyNTUuODg0NjUsMjgzLjQyODE4OCAxMjUxLjAzODkxLDI4Ni4zMzU2MzUgMTI0OS41ODUxOCwyODkuMjQzMDgyIEwxMjMyLjYyNTA4LDMyMi42Nzg3MjIgQzEyMzAuMjAyMiwzMjcuMDM5ODkzIDEyMzIuNjI1MDgsMzI5Ljk0NzM0IDEyMzYuMDE3MSwzMzIuODU0Nzg3IEwxMjM2LjAxNzEsMzMyLjg1NDc4NyBaIE0xNDA3LjU1NjQ3LDI0Ni42MDA1MjYgQzE0MDcuNTU2NDcsMzAyLjMyNjU5MyAxNDUzLjEwNjQ3LDM0OC44NDU3NDUgMTUwOC4zNDc5NiwzNDguODQ1NzQ1IEMxNTYzLjU4OTQ2LDM0OC44NDU3NDUgMTYwOS4xMzk0NiwzMDIuMzI2NTkzIDE2MDkuMTM5NDYsMjQ2LjYwMDUyNiBDMTYwOS4xMzk0NiwxOTEuODQzNjA4IDE1NjMuNTg5NDYsMTQ1LjMyNDQ1NiAxNTA4LjM0Nzk2LDE0NS4zMjQ0NTYgQzE0NTMuMTA2NDcsMTQ1LjMyNDQ1NiAxNDA3LjU1NjQ3LDE5MS44NDM2MDggMTQwNy41NTY0NywyNDYuNjAwNTI2IEwxNDA3LjU1NjQ3LDI0Ni42MDA1MjYgWiBNMTQ3MC4wNjY1OCwyNDYuNjAwNTI2IEMxNDcwLjA2NjU4LDIyNS4yNzkyNDggMTQ4Ny4wMjY2OSwyMDcuODM0NTY2IDE1MDguMzQ3OTYsMjA3LjgzNDU2NiBDMTUyOS42NjkyNCwyMDcuODM0NTY2IDE1NDYuNjI5MzUsMjI1LjI3OTI0OCAxNTQ2LjYyOTM1LDI0Ni42MDA1MjYgQzE1NDYuNjI5MzUsMjY4LjQwNjM3OCAxNTI5LjY2OTI0LDI4Ni4zMzU2MzUgMTUwOC4zNDc5NiwyODYuMzM1NjM1IEMxNDg3LjAyNjY5LDI4Ni4zMzU2MzUgMTQ3MC4wNjY1OCwyNjguNDA2Mzc4IDE0NzAuMDY2NTgsMjQ2LjYwMDUyNiBMMTQ3MC4wNjY1OCwyNDYuNjAwNTI2IFogTTE2MzEuNDI5ODksMjQ3LjA4NTEwMSBDMTYzMS40Mjk4OSwzMDUuMjM0MDQgMTY4MC4zNzE5MSwzNDguODQ1NzQ1IDE3MzUuNjEzNCwzNDguODQ1NzQ1IEMxNzcwLjUwMjc3LDM0OC44NDU3NDUgMTc5NS43MDA2NCwzMzUuMjc3NjU5IDE4MTMuNjI5OSwzMDguMTQxNDg3IEMxODE3LjAyMTkyLDMwMy4yOTU3NDIgMTgxNC41OTkwNSwyOTguNDQ5OTk3IDE4MTAuMjM3ODgsMjk0LjU3MzQwMSBMMTc4MS4xNjM0MSwyNjkuMzc1NTI3IEMxNzc4LjI1NTk2LDI2Ni45NTI2NTUgMTc3My44OTQ3OSwyNjcuOTIxODA0IDE3NzAuNTAyNzcsMjcxLjMxMzgyNSBDMTc2Mi43NDk1OCwyNzkuMDY3MDE3IDE3NTQuNTExODEsMjg2LjMzNTYzNSAxNzM3LjU1MTcsMjg2LjMzNTYzNSBDMTcxNi4yMzA0MiwyODYuMzM1NjM1IDE2OTkuNzU0ODksMjY4Ljg5MDk1MyAxNjk5Ljc1NDg5LDI0Ny4wODUxMDEgQzE2OTkuNzU0ODksMjI1Ljc2MzgyMyAxNzE3LjE5OTU3LDIwNy44MzQ1NjYgMTczOC41MjA4NSwyMDcuODM0NTY2IEMxNzQ5LjY2NjA2LDIwNy44MzQ1NjYgMTc1OS44NDIxMywyMTMuMTY0ODg2IDE3NjYuNjI2MTcsMjIwLjQzMzUwMyBDMTc2OS4wNDkwNCwyMjIuODU2Mzc2IDE3NzQuODYzOTQsMjIzLjgyNTUyNSAxNzc3LjI4NjgxLDIyMS40MDI2NTIgTDE4MDYuMzYxMjgsMTkzLjc4MTkwNiBDMTgxMC43MjI0NSwxODkuOTA1MzEgMTgxMi4xNzYxNywxODQuNTc0OTkgMTgwOC43ODQxNSwxODAuMjEzODIgQzE3OTAuMzcwMzIsMTU3LjkyMzM5MyAxNzY2LjYyNjE3LDE0NS4zMjQ0NTYgMTczNi4wOTc5OCwxNDUuMzI0NDU2IEMxNjgwLjg1NjQ5LDE0NS4zMjQ0NTYgMTYzMS40Mjk4OSwxODkuOTA1MzEgMTYzMS40Mjk4OSwyNDcuMDg1MTAxIEwxNjMxLjQyOTg5LDI0Ny4wODUxMDEgWiBNMTg4NS4zNDY5Miw5MS41MzY2ODY4IEMxOTA2LjY2ODIsOTEuNTM2Njg2OCAxOTI0LjExMjg4LDc0LjU3NjU3OTQgMTkyNC4xMTI4OCw1My4yNTUzMDE1IEMxOTI0LjExMjg4LDMxLjkzNDAyMzYgMTkwNi42NjgyLDE0LjQ4OTM0MTcgMTg4NS4zNDY5MiwxNC40ODkzNDE3IEMxODY0LjAyNTY1LDE0LjQ4OTM0MTcgMTg0Ny4wNjU1NCwzMS45MzQwMjM2IDE4NDcuMDY1NTQsNTMuMjU1MzAxNSBDMTg0Ny4wNjU1NCw3NC41NzY1Nzk0IDE4NjQuMDI1NjUsOTEuNTM2Njg2OCAxODg1LjM0NjkyLDkxLjUzNjY4NjggTDE4ODUuMzQ2OTIsOTEuNTM2Njg2OCBaIE0xODQ5Ljk3Mjk5LDMzNC43OTMwODUgQzE4NDkuOTcyOTksMzM5LjYzODgzIDE4NTQuMzM0MTYsMzQ0IDE4NTkuMTc5OSwzNDQgTDE5MTIuNDgzMSwzNDQgQzE5MTcuMzI4ODQsMzQ0IDE5MjEuNjkwMDEsMzM5LjYzODgzIDE5MjEuNjkwMDEsMzM0Ljc5MzA4NSBMMTkyMS42OTAwMSwxNTkuMzc3MTE2IEMxOTIxLjY5MDAxLDE1NC4wNDY3OTcgMTkxNy4zMjg4NCwxNTAuMTcwMjAxIDE5MTIuNDgzMSwxNTAuMTcwMjAxIEwxODU5LjE3OTksMTUwLjE3MDIwMSBDMTg1NC4zMzQxNiwxNTAuMTcwMjAxIDE4NDkuOTcyOTksMTU0LjA0Njc5NyAxODQ5Ljk3Mjk5LDE1OS4zNzcxMTYgTDE4NDkuOTcyOTksMzM0Ljc5MzA4NSBaIE0xOTYwLjk0MDU1LDI4NC44ODE5MTEgQzE5NjAuOTQwNTUsMzIzLjE2MzI5NyAxOTg5LjUzMDQ0LDM0OC44NDU3NDUgMjAyNy44MTE4MywzNDguODQ1NzQ1IEMyMDU4LjM0MDAyLDM0OC44NDU3NDUgMjA3NS4zMDAxMywzMzQuNzkzMDg1IDIwODYuNDQ1MzQsMzI0LjYxNzAyIEwyMDkzLjIyOTM4LDMzNy43MDA1MzIgQzIwOTUuNjUyMjYsMzQzLjAzMDg1MSAyMDk5LjA0NDI4LDM0NCAyMTAxLjk1MTcyLDM0NCBMMjEyMy4yNzMsMzQ0IEMyMTI4LjExODc1LDM0NCAyMTMyLjQ3OTkyLDMzOS42Mzg4MyAyMTMyLjQ3OTkyLDMzNC43OTMwODUgTDIxMzIuNDc5OTIsMjI3LjcwMjEyMSBDMjEzMi40Nzk5MiwxNzAuNTIyMzMgMjExMC42NzQwNywxNDUuMzI0NDU2IDIwNTAuNTg2ODMsMTQ1LjMyNDQ1NiBDMjAyNC40MTk4LDE0NS4zMjQ0NTYgMTk5MC40OTk1OSwxNTEuMTM5MzUgMTk4Ni4xMzg0MiwxNTIuNTkzMDc0IEMxOTgxLjc3NzI1LDE1NC4wNDY3OTcgMTk3Ny40MTYwOCwxNTcuNDM4ODE4IDE5NzguODY5OCwxNjUuNjc2NTg1IEwxOTgzLjIzMDk3LDE5Ni4yMDQ3NzggQzE5ODQuMjAwMTIsMjAzLjQ3MzM5NiAxOTg3LjU5MjE0LDIwOC44MDM3MTUgMTk5NC44NjA3NiwyMDYuMzgwODQzIEMyMDA3LjQ1OTcsMjAyLjUwNDI0NyAyMDMwLjIzNDcsMTk5LjExMjIyNSAyMDQzLjMxODIxLDE5OS4xMTIyMjUgQzIwNjYuNTc3NzksMTk5LjExMjIyNSAyMDY5LjQ4NTIzLDIwOC44MDM3MTUgMjA2OS40ODUyMywyMjcuNzAyMTIxIEMyMDY5LjQ4NTIzLDIyNy43MDIxMjEgMjA1My45Nzg4NSwyMTkuOTQ4OTI5IDIwMzIuMTczLDIxOS45NDg5MjkgQzE5ODguMDc2NzIsMjE5Ljk0ODkyOSAxOTYwLjk0MDU1LDI0Ny41Njk2NzUgMTk2MC45NDA1NSwyODQuODgxOTExIEwxOTYwLjk0MDU1LDI4NC44ODE5MTEgWiBNMjAyMy45MzUyMywyODAuMDM2MTY2IEMyMDIzLjkzNTIzLDI2OC44OTA5NTMgMjAzMy4xNDIxNSwyNTkuNjg0MDM3IDIwNDQuNzcxOTMsMjU5LjY4NDAzNyBDMjA1Ni40MDE3MiwyNTkuNjg0MDM3IDIwNjUuNjA4NjQsMjY4Ljg5MDk1MyAyMDY2LjA5MzIxLDI4MC4wMzYxNjYgQzIwNjYuMDkzMjEsMjkxLjY2NTk1NCAyMDU2LjQwMTcyLDMwMS4zNTc0NDQgMjA0NC43NzE5MywzMDEuMzU3NDQ0IEMyMDMzLjE0MjE1LDMwMS4zNTc0NDQgMjAyMy45MzUyMywyOTEuNjY1OTU0IDIwMjMuOTM1MjMsMjgwLjAzNjE2NiBMMjAyMy45MzUyMywyODAuMDM2MTY2IFogTTIxODEuOTA2NTIsMzM0Ljc5MzA4NSBDMjE4MS45MDY1MiwzMzkuNjM4ODMgMjE4Ni4yNjc2OSwzNDQgMjE5MS4xMTM0MywzNDQgTDIyNDQuNDE2NjMsMzQ0IEMyMjQ5LjI2MjM3LDM0NCAyMjUzLjYyMzU0LDMzOS42Mzg4MyAyMjUzLjYyMzU0LDMzNC43OTMwODUgTDIyNTMuNjIzNTQsMTQuMDA0NzY3MiBDMjI1My42MjM1NCw5LjE1OTAyMjI2IDIyNDkuMjYyMzcsNC43OTc4NTE3OSAyMjQ0LjQxNjYzLDQuNzk3ODUxNzkgTDIxOTEuMTEzNDMsNC43OTc4NTE3OSBDMjE4Ni4yNjc2OSw0Ljc5Nzg1MTc5IDIxODEuOTA2NTIsOS4xNTkwMjIyNiAyMTgxLjkwNjUyLDE0LjAwNDc2NzIgTDIxODEuOTA2NTIsMzM0Ljc5MzA4NSBaXFxcIiBpZD1cXFwiY2xpLS0tLWIuc29jaWFsXFxcIj48L3BhdGg+PC9nPjwvZz48L2c+PC9nPjwvc3ZnPlwiXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL3NyYy9pbWcvY2xpbWJfbG9nby5zdmdcbiAqKiBtb2R1bGUgaWQgPSAzN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtb2R1bGUpIHtcclxuXHRpZighbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xyXG5cdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XHJcblx0XHRtb2R1bGUucGF0aHMgPSBbXTtcclxuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxyXG5cdFx0bW9kdWxlLmNoaWxkcmVuID0gW107XHJcblx0XHRtb2R1bGUud2VicGFja1BvbHlmaWxsID0gMTtcclxuXHR9XHJcblx0cmV0dXJuIG1vZHVsZTtcclxufVxyXG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqICh3ZWJwYWNrKS9idWlsZGluL21vZHVsZS5qc1xuICoqIG1vZHVsZSBpZCA9IDM4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMzlfXztcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIFwiUmVhY3RET01cIlxuICoqIG1vZHVsZSBpZCA9IDM5XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9